(() => {// shared.js
  const __dcg_shared_module__ = () => {
    const __dcg_chunk_exports__ = {};var lO=Object.create;var Wl=Object.defineProperty,cO=Object.defineProperties,pO=Object.getOwnPropertyDescriptor,fO=Object.getOwnPropertyDescriptors,dO=Object.getOwnPropertyNames,Yl=Object.getOwnPropertySymbols,mO=Object.getPrototypeOf,qd=Object.prototype.hasOwnProperty,sT=Object.prototype.propertyIsEnumerable;var HF=Math.pow,iT=(e,t,r)=>t in e?Wl(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,X=(e,t)=>{for(var r in t||(t={}))qd.call(t,r)&&iT(e,r,t[r]);if(Yl)for(var r of Yl(t))sT.call(t,r)&&iT(e,r,t[r]);return e},ue=(e,t)=>cO(e,fO(t));var $F=(e=>typeof require!="undefined"?require:typeof Proxy!="undefined"?new Proxy(e,{get:(t,r)=>(typeof require!="undefined"?require:t)[r]}):e)(function(e){if(typeof require!="undefined")return require.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')});var oT=(e,t)=>{var r={};for(var n in e)qd.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&Yl)for(var n of Yl(e))t.indexOf(n)<0&&sT.call(e,n)&&(r[n]=e[n]);return r};var YF=(e,t)=>()=>(e&&(t=e(e=0)),t);var WF=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),ui=(e,t)=>{for(var r in t)Wl(e,r,{get:t[r],enumerable:!0})},yO=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of dO(t))!qd.call(e,i)&&i!==r&&Wl(e,i,{get:()=>t[i],enumerable:!(n=pO(t,i))||n.enumerable});return e};var XF=(e,t,r)=>(r=e!=null?lO(mO(e)):{},yO(t||!e||!e.__esModule?Wl(r,"default",{value:e,enumerable:!0}):r,e));var ZF=(()=>{for(var e=new Uint8Array(128),t=0;t<64;t++)e[t<26?t+65:t<52?t+71:t<62?t-4:t*4-205]=t;return r=>{for(var n=r.length,i=new Uint8Array((n-(r[n-1]=="=")-(r[n-2]=="="))*3/4|0),s=0,o=0;s<n;){var a=e[r.charCodeAt(s++)],u=e[r.charCodeAt(s++)],l=e[r.charCodeAt(s++)],c=e[r.charCodeAt(s++)];i[o++]=a<<2|u>>4,i[o++]=u<<4|l>>2,i[o++]=l<<6|c}return i}})();var aT=function(){{var e=function(){},t=["log","info","warn","error","assert","dir","clear","profile","profileEnd","time","timeEnd","group","groupCollapsed","groupEnd","trace"],r={},n=function(i){typeof window!="undefined"&&window.console&&window.console[i]?r[i]=function(){Function.prototype.apply.call(window.console[i],window.console,arguments)}:r[i]=e};return t.forEach(n),r}}(),JF=aT,{log:QF,warn:KF,error:eB,assert:tB,dir:rB,clear:nB,profile:iB,profileEnd:sB,time:oB,timeEnd:aB,group:uB,groupCollapsed:lB,groupEnd:cB,trace:pB}=aT;var hc={};ui(hc,{getFrame:()=>iN});function cn(e,t,r){return{input:e,start:t,end:r}}function Ai(e,t){return cn(e,t,t)}function Yr(e,t){if(e.input!==t.input)throw new Error("Programming Error: cannot form a span on different inputs");return cn(e.input,e.start,t.end)}function xr(e){return e.input.slice(e.start,e.end)}var ss=()=>({type:"empty"}),Wr=()=>({type:"unknown"}),Ri=e=>isNaN(e[0])||isNaN(e[1])||e[1]<e[0]?ss():{type:"known",bounds:e},Ma=(e,t)=>{if(t===0)return e>0?Ci():ss();let r=-e/t,n=t<0?[-1/0,r]:[r,1/0];return Ri(n)},Ci=()=>Ri([-1/0,1/0]),Qr=(e,t)=>{if(e.type==="empty"||t.type==="empty")return ss();if(e.type==="unknown"||t.type==="unknown")return Wr();if(e.bounds&&t.bounds){let r=[Math.max(e.bounds[0],t.bounds[0]),Math.min(e.bounds[1],t.bounds[1])];return Ri(r)}return ss()};var Ee={};ui(Ee,{Action:()=>Ze,AngleMarker:()=>de,Any:()=>ft,Arc:()=>ee,Bool:()=>Ie,Circle:()=>ie,DirectedAngleMarker:()=>oe,Distribution:()=>et,EmptyList:()=>Me,ErrorType:()=>li,Line:()=>ne,ListOfAngleMarker:()=>Lt,ListOfAny:()=>Bt,ListOfArc:()=>pr,ListOfBool:()=>Ir,ListOfCircle:()=>cr,ListOfColor:()=>Tr,ListOfDirectedAngleMarker:()=>wt,ListOfDistribution:()=>Qt,ListOfLine:()=>fr,ListOfNumber:()=>Z,ListOfPoint:()=>Be,ListOfPoint3D:()=>Gr,ListOfPolygon:()=>er,ListOfRay:()=>dr,ListOfSegment:()=>$t,ListOfSegment3D:()=>zr,ListOfSphere3D:()=>kr,ListOfTransformation:()=>Vr,ListOfTriangle3D:()=>qr,Number:()=>x,Point:()=>A,Point3D:()=>G,Polygon:()=>Te,RGBColor:()=>tt,Ray:()=>Pe,SeedType:()=>Ve,Segment:()=>pe,Segment3D:()=>tr,Sphere3D:()=>yr,Transformation:()=>Re,Triangle3D:()=>mr,allListTypes:()=>An,assertTypeIsOneOf:()=>Eu,broadcastable:()=>os,broadcastableArg:()=>wo,elementType:()=>ke,hasListType:()=>zn,isGeometryType:()=>Ud,isList:()=>k,isOneOf:()=>Xl,isSubType:()=>Li,isSubTypeOrCoercible:()=>Zl,isTypeOrListOfType:()=>fe,isValidOnLogScales:()=>Mu,listType:()=>fn,maxArity:()=>hO,minArity:()=>gO,prettyPrint:()=>te,repr:()=>pn});function M(e,t){return{key:e,vars:t}}var ft=0,x=1,Ie=2,A=3,et=4,Ze=5,Bt=6,Z=7,Ir=8,Be=9,Qt=10,Me=11,li=12,Ve=13,tt=14,Tr=15,Te=16,er=17,pe=18,$t=19,ie=20,cr=21,ee=22,pr=23,ne=24,fr=25,Pe=26,dr=27,de=28,Lt=29,oe=30,wt=31,Re=32,Vr=33,G=34,Gr=35,tr=36,zr=37,mr=38,qr=39,yr=40,kr=41;function gO(e){return Array.isArray(e)?e.length:e.initial.length}function hO(e){return Array.isArray(e)?e.length:1/0}function wo(e){if(typeof e=="number")return zn(e)?{meta:"union",types:[e,fn(e)]}:e;let t=[];for(let r of e.types){let n=wo(r);typeof n=="number"?t.push(n):t.push(...n.types)}return{meta:"union",types:t}}function os(e){return Array.isArray(e)?e.map(wo):{type:"variadic",initial:e.initial.map(wo),rest:wo(e.rest)}}function pn(e){switch(e){case ft:return"Any";case x:return"Number";case Ie:return"Bool";case A:return"Point";case G:return"Point3D";case et:return"Distribution";case Ze:return"Action";case Bt:return"ListOfAny";case Z:return"ListOfNumber";case Ir:return"ListOfBool";case Be:return"ListOfPoint";case Gr:return"ListOfPoint3D";case Qt:return"ListOfDistribution";case Me:return"EmptyList";case li:return"ErrorType";case Ve:return"SeedType";case tt:return"RGBColor";case Tr:return"ListOfColor";case Te:return"Polygon";case er:return"ListOfPolygon";case pe:return"Segment";case $t:return"ListOfSegment";case ie:return"Circle";case cr:return"ListOfCircle";case ee:return"Arc";case pr:return"ListOfArc";case ne:return"Line";case fr:return"ListOfLine";case Pe:return"Ray";case dr:return"ListOfRay";case de:return"Angle";case Lt:return"ListOfAngle";case oe:return"DirectedAngle";case wt:return"ListOfDirectedAngle";case Re:return"Transformation";case Vr:return"ListOfTransformation";case tr:return"Segment3D";case zr:return"ListOfSegment3D";case mr:return"Triangle3D";case qr:return"ListOfTriangle3D";case yr:return"Sphere3D";case kr:return"ListOfSphere3D";default:let t=e;throw new Error(`Invalid type: ${t}`)}}function te(e){switch(e){case ft:return M("shared-calculator-label-value-type-any");case x:return M("shared-calculator-label-value-type-number");case Ie:return M("shared-calculator-label-value-type-bool");case A:return M("shared-calculator-label-value-type-point");case G:return M("shared-calculator-label-value-type-point3d");case et:return M("shared-calculator-label-value-type-distribution");case Ze:return M("shared-calculator-label-value-type-action");case Bt:return M("shared-calculator-label-value-type-list-of-any");case Z:return M("shared-calculator-label-value-type-list-of-numbers");case Ir:return M("shared-calculator-label-value-type-list-of-bool");case Be:return M("shared-calculator-label-value-type-list-of-points");case Gr:return M("shared-calculator-label-value-type-list-of-3d-points");case Qt:return M("shared-calculator-label-value-type-list-of-distributions");case Me:return M("shared-calculator-label-value-type-empty-list");case li:return M("shared-calculator-label-value-type-error");case Ve:return M("shared-calculator-label-value-type-seed");case tt:return M("shared-calculator-label-value-type-color");case Tr:return M("shared-calculator-label-value-type-list-of-colors");case Te:return M("shared-calculator-label-value-type-polygon");case er:return M("shared-calculator-label-value-type-list-of-polygons");case pe:return M("shared-calculator-label-value-type-segment");case $t:return M("shared-calculator-label-value-type-list-of-segments");case ie:return M("shared-calculator-label-value-type-circle");case cr:return M("shared-calculator-label-value-type-list-of-circles");case ee:return M("shared-calculator-label-value-type-arc");case pr:return M("shared-calculator-label-value-type-list-of-arcs");case ne:return M("shared-calculator-label-value-type-line");case fr:return M("shared-calculator-label-value-type-list-of-lines");case Pe:return M("shared-calculator-label-value-type-ray");case dr:return M("shared-calculator-label-value-type-list-of-rays");case de:return M("shared-calculator-label-value-type-angle");case Lt:return M("shared-calculator-label-value-type-list-of-angles");case oe:return M("shared-calculator-label-value-type-directed-angle");case wt:return M("shared-calculator-label-value-type-list-of-directed-angles");case Re:return M("shared-calculator-label-value-type-transformation");case Vr:return M("shared-calculator-label-value-type-list-of-transformations");case tr:return M("shared-calculator-label-value-type-segment3d");case zr:return M("shared-calculator-label-value-type-list-of-segment3d");case mr:return M("shared-calculator-label-value-type-triangle3d");case qr:return M("shared-calculator-label-value-type-list-of-triangle3d");case yr:return M("shared-calculator-label-value-type-sphere3d");case kr:return M("shared-calculator-label-value-type-list-of-sphere3d");default:let t=e;throw new Error(`Invalid type: ${t}`)}}var An=[Bt,Z,Ir,Be,Gr,Qt,Me,Tr,er,$t,cr,pr,fr,dr,Lt,wt,Vr,zr,qr,kr],dB={[Bt]:ft,[Me]:x,[Z]:x,[Ir]:Ie,[Be]:A,[Gr]:G,[Qt]:et,[Tr]:tt,[er]:Te,[$t]:pe,[cr]:ie,[pr]:ee,[fr]:ne,[dr]:Pe,[Lt]:de,[wt]:oe,[Vr]:Re,[zr]:tr,[qr]:mr,[kr]:yr};function k(e){switch(e){case Bt:case Z:case Ir:case Be:case Gr:case Qt:case Tr:case er:case $t:case cr:case pr:case fr:case dr:case Lt:case wt:case Vr:case zr:case qr:case kr:case Me:return!0;case ft:case x:case Ie:case A:case G:case et:case li:case Ve:case tt:case Ze:case Te:case pe:case ie:case ee:case ne:case Pe:case de:case oe:case Re:case tr:case mr:case yr:return!1;default:throw new Error(`Invalid type: ${e}`)}}function ke(e){switch(e){case Me:case Z:return x;case Ir:return Ie;case Be:return A;case Gr:return G;case Qt:return et;case Tr:return tt;case er:return Te;case zr:return tr;case qr:return mr;case kr:return yr;case Bt:return ft;case $t:return pe;case cr:return ie;case pr:return ee;case fr:return ne;case dr:return Pe;case Lt:return de;case wt:return oe;case Vr:return Re;case ft:case x:case Ie:case A:case G:case et:case li:case Ve:case tt:case Ze:case Te:case pe:case ie:case ee:case ne:case Pe:case de:case oe:case Re:case tr:case mr:case yr:throw new Error("Type "+pn(e)+" does not implement elementType.");default:let t=e;throw new Error(`Invalid type: ${t}`)}}function fn(e){switch(e){case ft:return Bt;case x:return Z;case Ie:return Ir;case A:return Be;case G:return Gr;case et:return Qt;case tt:return Tr;case Te:return er;case pe:return $t;case ie:return cr;case ee:return pr;case ne:return fr;case Pe:return dr;case de:return Lt;case oe:return wt;case Re:return Vr;case tr:return zr;case mr:return qr;case yr:return kr;case Me:case Z:case Ir:case Be:case Gr:case Qt:case Tr:case er:case $t:case cr:case pr:case fr:case dr:case Lt:case wt:case Vr:case zr:case qr:case kr:case Bt:case li:case Ve:case Ze:throw new Error("Type "+pn(e)+" does not implement listType.");default:let t=e;throw new Error(`Invalid type: ${t}`)}}function zn(e){switch(e){case ft:case x:case Ie:case A:case G:case et:case tt:case Te:case pe:case ie:case ee:case ne:case Pe:case de:case oe:case Re:case tr:case mr:case yr:return!0;case Me:case Z:case Ir:case Be:case Gr:case Qt:case Tr:case er:case $t:case cr:case pr:case fr:case dr:case Lt:case wt:case Vr:case zr:case qr:case kr:case Bt:case Ve:case Ze:case li:return!1;default:throw new Error(`Invalid type: ${e}`)}}function Ud(e){switch(e){case A:case Te:case pe:case ie:case ee:case ne:case Pe:case de:case oe:case Re:return!0;default:return!1}}function Mu(e){switch(e){case x:case ft:case Ie:case A:case et:case Ze:case Bt:case Z:case Ir:case Be:case Qt:case Me:case li:case Ve:case tt:case Tr:return!0;case G:case Gr:case tr:case zr:case mr:case qr:case yr:case kr:case Te:case er:case pe:case $t:case ie:case cr:case ee:case pr:case ne:case fr:case Pe:case dr:case de:case Lt:case oe:case wt:case Re:case Vr:return!1;default:let t=e;throw new Error(`Invalid type: ${t}`)}}function Xl(e,t){for(let r of t)if(e===r)return!0;return!1}function Li(e,t){return e===Me&&k(t)||t===Bt&&k(e)||t===ft&&!k(e)?!0:e===t}function Zl(e,t){return Li(e,t)||(e===de||e===oe)&&t===x?!0:(e===Lt||e===wt)&&t===Z}function fe(e,t){return e===t?!0:k(e)?e===Me?!0:ke(e)===t:!1}function Eu(e,t){if(!Xl(e,t))throw new Error(`Programming error: expected one of ${t.map(te)} but found ${e} instead.`)}var Ue=class{constructor(){this.exportPenalty=0;this._dependencies=[],this._dummyDependencies=[],this._updateSymbols=[],this._substitutionSymbols=[],this._scope={definitions:[],dependencies:[],substitutionDependencies:[],isSubstitutionBody:!1,scopes:[]},this._exports=[]}setInputSpan(t){this._inputSpan=t}getInputString(){return this._inputSpan===void 0?"":xr(this._inputSpan)}getInputSpan(){return this._inputSpan}shouldExportAns(){return!1}getAnsVariable(){return this.shouldExportAns()&&this.userData&&this.userData.hasOwnProperty("index")?["ans_"+this.userData.index]:[]}addDependency(t){this._dependencies.indexOf(t)===-1&&this._dependencies.push(t),this._scope.dependencies.indexOf(t)===-1&&this._scope.dependencies.push(t)}addDependencies(t){for(var r=0;r<t.length;r++)this.addDependency(t[r])}addDummyDependency(t){this._dependencies.indexOf(t)===-1&&this._dependencies.push(t),this._dummyDependencies.indexOf(t)===-1&&this._dummyDependencies.push(t)}addDummyDependencies(t){for(var r=0;r<t.length;r++)this.addDummyDependency(t[r])}addUpdateSymbol(t){this._dependencies.indexOf(t)===-1&&this._dependencies.push(t),this._updateSymbols.indexOf(t)===-1&&this._updateSymbols.push(t)}addSubstitutionSymbol(t){this._dummyDependencies.indexOf(t)===-1&&this._dummyDependencies.push(t),this._substitutionSymbols.indexOf(t)===-1&&this._substitutionSymbols.push(t)}addSubstitutionDependencies(t){for(var r=0;r<t.length;r++){var n=t[r];if(this._dependencies.indexOf(n)===-1)throw new Error("Programming error: substitution dependency "+n+" must also be registered as a regular dependency");this._scope.substitutionDependencies.indexOf(n)===-1&&this._scope.substitutionDependencies.push(n)}}mergeDependencies(...t){for(var r=0;r<t.length;r++){var n=t[r],i;for(i=0;i<n._dependencies.length;i++)this._dependencies.indexOf(n._dependencies[i])===-1&&this._dependencies.push(n._dependencies[i]);for(i=0;i<n._updateSymbols.length;i++)this._updateSymbols.indexOf(n._updateSymbols[i])===-1&&this._updateSymbols.push(n._updateSymbols[i]);for(i=0;i<n._substitutionSymbols.length;i++)this._substitutionSymbols.indexOf(n._substitutionSymbols[i])===-1&&this._substitutionSymbols.push(n._substitutionSymbols[i]);for(i=0;i<n._scope.dependencies.length;i++)this._scope.dependencies.indexOf(n._scope.dependencies[i])===-1&&this._scope.dependencies.push(n._scope.dependencies[i]);for(i=0;i<n._scope.substitutionDependencies.length;i++)this._scope.substitutionDependencies.indexOf(n._scope.substitutionDependencies[i])===-1&&this._scope.substitutionDependencies.push(n._scope.substitutionDependencies[i]);this.addDummyDependencies(n.getDummyDependencies()),Array.prototype.push.apply(this._scope.scopes,n._scope.scopes)}}mergeDependenciesInScope(t,r,n){this.addDummyDependencies(t);var i=r.getScope(),s={definitions:t,dependencies:i.dependencies,substitutionDependencies:i.substitutionDependencies,scopes:i.scopes,isSubstitutionBody:!!(n&&n.isSubstitutionBody)};this._scope.scopes.push(s);for(var o=0;o<r._dependencies.length;o++)this._dependencies.indexOf(r._dependencies[o])===-1&&this._dependencies.push(r._dependencies[o]);for(o=0;o<r._updateSymbols.length;o++)this._updateSymbols.indexOf(r._updateSymbols[o])===-1&&this._updateSymbols.push(r._updateSymbols[o]);for(o=0;o<r._substitutionSymbols.length;o++)this._substitutionSymbols.indexOf(r._substitutionSymbols[o])===-1&&this._substitutionSymbols.push(r._substitutionSymbols[o]);this.addDummyDependencies(r.getDummyDependencies())}getDependencies(){return this._dependencies}getDummyDependencies(){return this._dummyDependencies}getUpdateSymbols(){return this._updateSymbols}getSubstitutionSymbols(){return this._substitutionSymbols}getScope(){return this._scope}dependsOn(t){return this._dependencies.indexOf(t)>-1}getExports(){var t=this._exports||[];if(this.userData&&"id"in this.userData){var r=this.userData.id;t=t.concat(["idref_"+r])}return t.concat(this.getAnsVariable())}getLegalExports(t){return this.getExports().filter(function(r){return!t.assignmentForbidden(r)})}exportsSymbol(t){return this._exports.indexOf(t)>-1}exportTo(t,r,n){for(var i=this.getLegalExports(t),s=0;s<i.length;s++){var o=i[s];if(n[o])return;n[o]=r.blocksExport?r:this}}getOperator(){return this.operator||"="}isInequality(){return!1}isShadeBetween(){return!1}getAllIds(){return this.userData?[this.userData.id]:[]}getEvaluationInfo(){return!1}shouldPromoteToSlider(t){return!1}getSliderVariables(t,r){var n=t.sliderVariables(r.getDependencies());return r.valueType===A||r.valueType===Be?n.filter(function(i){return!t.validParametricVariable(i)}):n}getCompiledDerivative(){var t=this.getDependencies(),n=this.takeDerivative(t[0]||"x");return n.getCompiledFunction()}asValue(){}boundDomain(t){return Wr()}getCursorContext(){}polynomialOrder(t){}getPolynomialCoefficients(t){}asTypedValue(){}substitute(t){}getExpressionType(t,r){}tableInfo(t,r){}analyzeFourFunction(t,r,n){}analyzeScientific(t,r,n){}analyzeSingleExpressionScientific(t,r,n){}getGraphMode(t,r){}};var q=class extends Ue{constructor(r,n){if(!Array.isArray(r))throw new TypeError("Argument to expression constructor must be an Array.");super();this.args=r,(!n||!n.skipRegisterDependencies)&&this.registerDependencies()}shouldExportAns(){return!0}registerDependencies(){for(var r=0;r<this.args.length;r++)this.mergeDependencies(this.args[r])}copyWithArgs(r){return new this.constructor(r)}};function ws(e,t=1e6){if(e===1/0)return{n:1/0,d:1};if(e===-1/0)return{n:-1/0,d:1};if(!isFinite(e))return{n:NaN,d:1};let r,n=0,i=1,s=1,o=0,a,u;for(;r=Math.floor(e),a=r*i+n,u=r*o+s,!(u>t||(n=i,s=o,i=a,o=u,e===r));)e=1/(e-r);return{n:i,d:o}}var Mr=Math,_o=Mr.cosh||function(e){return .5*(Math.exp(e)+Math.exp(-e))},va=Mr.sinh&&Mr.sinh(1e-20)!==0?Mr.sinh:function(e){let t=e>0?1:-1;return e=e>0?e:-e,-t*.5*Math.exp(e)*ec(-2*e)},jl=Mr.tanh&&Mr.tanh(1e-20)!==0?Mr.tanh:function(e){let t=e>0?1:-1;e=e>0?e:-e;let r=ec(-2*e);return-t*r/(2+r)},Jl=Mr.acosh||function(e){return e<1?NaN:Math.log(e+$d(e))},Ql=Mr.asinh&&Mr.asinh(1e-20)!==0?Mr.asinh:function(e){let t=e>0?1:-1;return e=e>0?e:-e,1+e*e===1?t*as(e):t*Math.log(e+Hd(e))},Kl=Mr.atanh&&Mr.atanh(1e-20)!==0?Mr.atanh:function(e){return .5*(as(e)-as(-e))},ec=Mr.expm1||function(e){return e+.5*e*e===e?e:Math.exp(e)-1},as=Mr.log1p||function(e){return e-.5*e*e===e?e:Math.log(1+e)},Hd=function(e){let t=e*e;return 1+t===1?1:1+t===t?Math.abs(e):Math.sqrt(t+1)},$d=function(e){let t=e*e;return t<1?NaN:t-1===t?Math.abs(e):Math.sqrt(t-1)},Oa=Mr.sign||function(e){return e===0?0:e>0?1:e<0?-1:NaN},bO=Mr.hypot&&Mr.hypot(1/0,NaN)===1/0,ci=bO?Mr.hypot:function(...e){let t=0,r=0;for(let n of e){let i=Math.abs(n);if(i===1/0)return 1/0;i>t&&(r*=t/i*(t/i),t=i),r+=i===0&&t===0?0:i/t*(i/t)}return t*Math.sqrt(r)},tc=Mr.fround||function(e){let{abs:t,pow:r}=Math;var n=r(2,-52),i=r(2,-23),s=r(2,127)*(2-i),o=r(2,-126),a=function(m){return m+1/n-1/n},u=+e,l=t(u),c=Oa(u),p,f;return l<o?c*a(l/o/i)*o*i:(p=(1+i/n)*l,f=p-(p-l),f>s||f!=f?c*(1/0):c*f)},Sa=2220446049250313e-31;function cT(e,t,r){if(e=Na(e),r>0){let n=Na(t);return e<n&&(e+=2*Math.PI),(e-n)/r}else{let n=Na(t+r);return e<n&&(e+=2*Math.PI),1+(e-n)/r}}function rc(e,t,r){e=Na(e);let n=Na(t),i=Na(t+r);if(r<0){let s=n;n=i,i=s}return n<i?n<=e&&e<=i:n<=e||e<=i}function Na(e){let t=2*Math.PI;return(e%t+t)%t}var pi=ci;function _s(e,t){return e>0==t>0?e+.5*(t-e):.5*(e+t)}function TO(e,t,r,n,i,s){return e*n+t*i+r*s}function wi(e,t,r,n,i,s,o,a,u){let l=pi(o-n,a-i,u-s);return l===0?0:TO((e-n)/l,(t-i)/l,(r-s)/l,(o-n)/l,(a-i)/l,(u-s)/l)}function PO(e,t,r,n,i,s){let o=wi(e,t,0,r,n,0,i,s,0);return o<=0?[r,n]:o>=1?[i,s]:[r+o*(i-r),n+o*(s-n)]}function TB(e,t,r,n,i,s,o,a){let u=wi(e,t,0,r,n,0,i,s,0);return u<=0&&!o?[r,n]:u>=1&&!a?[i,s]:[r+u*(i-r),n+u*(s-n)]}function pT(e,t,r,n,i,s){let o=PO(e,t,r,n,i,s);return pi(e-o[0],t-o[1])}function PB(e,t,r,n,i,s,o){var a=Math.atan2(t-n,e-r);if(rc(a,s,o-s))return[i*Math.cos(a)+r,i*Math.sin(a)+n]}function Kr(e,t,r=1){if(e===t)return!0;if(!isFinite(e)||!isFinite(t))return!1;if(r>50)throw new Error("Within "+(52-r)+" bits isn't really approximate any more");let n=Math.max(Math.max(Math.abs(e),Math.abs(t)),1),i=r===1?.5:Math.pow(.5,r);return n===n+i*Math.abs(t-e)}function IB(e){return Math.round(e-.5)+.5}function Fo(e,t){if(isNaN(e)||isNaN(t))return NaN;if(e=Math.round(e),t=Math.round(t),e<0&&(e=-e),t<0&&(t=-t),t>e){let n=t;t=e,e=n}if(t===0)return e;let r=e%t;for(;r>0;)e=t,t=r,r=e%t;return t}function Bo(e,t){if(!isFinite(e)&&t===0)return NaN;if(e>=0||t===Math.floor(t))return Math.pow(e,t);let r=ws(t,100);return Kr(r.n/r.d,t,2)&&r.d%2===1?(r.n%2===0?1:-1)*Math.pow(-e,t):NaN}function Da(e,t){return{n:e,d:t}}function kt(e){return typeof e=="object"&&typeof e.n=="number"&&typeof e.d=="number"}var vu=Math.pow(2,53)-1;function Vo(e){let t=e.match(/^(-)?(\d*)?(?:\.(\d*))?$/);if(!t)return NaN;let r=t[1],n=t[2],i=t[3];if(!n&&!i)return NaN;let s=!!r;if(i){let o=i.replace(/0+$/,""),a=o.length,u=Math.pow(10,a),l=parseInt(n||"0",10)*u+parseInt(o||"0",10);return l>vu||u>vu?parseFloat(e):he(s?-l:l,u)}else{let o=parseInt(n,10);return o>vu?parseFloat(e):he(s?-o:o,1)}}function V(e){return kt(e)?e.n/e.d:+e}function Rn(e){return kt(e)?!1:isNaN(e)}function he(e,t){if(!isFinite(e)||!isFinite(t)||t===0||Math.floor(e)!==e||Math.floor(t)!==t||Math.abs(e)>vu||Math.abs(t)>vu)return e/t;t<0&&(e=-e,t=-t);let r=Fo(e,t);return Da(e/r,t/r)}function qn(e){return kt(e)?Da(-e.n,e.d):-e}function fT(e){return kt(e)?Da(Math.abs(e.n),Math.abs(e.d)):Math.abs(e)}function Ou(e){return kt(e)?e.n===0?e.d/e.n:Da(e.n<0?-e.d:e.d,Math.abs(e.n)):1/e}function us(e,t){if(!kt(e)||!kt(t))return V(e)+V(t);var r=Fo(e.d,t.d);return he(e.n*(t.d/r)+t.n*(e.d/r),e.d/r*t.d)}function ls(e,t){if(!kt(e)||!kt(t))return V(e)*V(t);var r=Fo(e.n,t.d),n=Fo(t.n,e.d);return he(e.n/r*(t.n/n),e.d/n*(t.d/r))}function _i(e,t){return us(e,qn(t))}function Fi(e,t){return!kt(e)||!kt(t)?V(e)/V(t):ls(e,Ou(t))}function MO(e,t){let r=e,n=t;if(t.n<0&&(n=qn(t),r=Ou(e)),!kt(r)||!kt(n))return Bo(V(e),V(t));if(e=r,t=n,t.d===1)return he(Math.pow(e.n,t.n),Math.pow(e.d,t.n));let i=e.n<0;if(i&&t.d%2!==1)return NaN;let o=(i?-1:1)*Math.round(Math.pow(Math.abs(e.n),1/t.d)),a=Math.round(Math.pow(Math.abs(e.d),1/t.d));return Math.pow(o,t.d)!==e.n||Math.pow(a,t.d)!==e.d?Bo(V(e),V(t)):he(Math.pow(o,t.n),Math.pow(a,t.n))}function Yd(e,t){if(!kt(e)||!kt(t))return Bo(V(e),V(t));let r=MO(e,t);return kt(r)?r:Bo(V(e),V(t))}function dT(e){if(!kt(e))return Math.sqrt(e);let t=Math.round(Math.sqrt(e.n)),r=Math.round(Math.sqrt(e.d));return t*t!==e.n||r*r!==e.d?Math.sqrt(V(e)):he(t,r)}function nc(e,t){return Yd(e,Ou(t))}function mT(e,t){if(!kt(e)||!kt(t)){let r=V(e),n=V(t);return r-n*Math.floor(r/n)}return _i(e,ls(t,Da(Math.floor(V(Fi(e,t))),1)))}function yT(e){let t=Da(0,1);for(let r of e)t=us(t,r);return t}var rr=class extends q{constructor(r){super([]);this.isConstant=!0;typeof r=="number"&&(r=he(r,1)),this._constantValue=r}asValue(){let r=this._constantValue;return typeof r=="boolean"?r:V(r)}asCompilerValue(){return this._constantValue}scalarExprString(){return this.asValue()>0?String(this.asValue()):"("+String(this.asValue())+")"}getEvaluationInfo(){return[{val:this.asValue()}]}isNaN(){let r=this.asValue();return typeof r=="number"&&isNaN(r)}};var Vs={};ui(Vs,{canDisplayAsFraction:()=>aP,formatSymbol:()=>Y,geoParentToLatex:()=>QS,identifierToHTML:()=>KS,identifierToLatex:()=>vr,latexToIdentifier:()=>ps,numericLabel:()=>dc,point:()=>YS,roundDecimal:()=>jS,trimLatex:()=>fs,truncatedHTMLLabel:()=>JS,truncatedLatexLabel:()=>bm,truncatedPlainmathLabel:()=>hm,value:()=>ym});var sc=typeof self=="object"&&self.self===self&&self||typeof global=="object"&&global.global===global&&global||Function("return this")()||{},uc=Array.prototype,rm=Object.prototype,gT=typeof Symbol!="undefined"?Symbol.prototype:null,EO=uc.push,Du=uc.slice,oc=rm.toString,ET=rm.hasOwnProperty,vO=Array.isArray,hT=Object.keys,bT=Object.create,vT=sc.isNaN,OO=sc.isFinite,Wd=function(){};function Ut(e){if(e instanceof Ut)return e;if(!(this instanceof Ut))return new Ut(e);this._wrapped=e}var SO=Ut.VERSION="1.10.2";function Au(e,t,r){if(t===void 0)return e;switch(r==null?3:r){case 1:return function(n){return e.call(t,n)};case 3:return function(n,i,s){return e.call(t,n,i,s)};case 4:return function(n,i,s,o){return e.call(t,n,i,s,o)}}return function(){return e.apply(t,arguments)}}function OT(e,t,r){return e==null?pm:kn(e)?Au(e,t,r):Uo(e)&&!Vi(e)?Nu(e):fm(e)}Ut.iteratee=nm;function nm(e,t){return OT(e,t,1/0)}function Ln(e,t,r){return Ut.iteratee!==nm?Ut.iteratee(e,t):OT(e,t,r)}function Cn(e,t){return t=t==null?e.length-1:+t,function(){for(var r=Math.max(arguments.length-t,0),n=Array(r),i=0;i<r;i++)n[i]=arguments[i+t];switch(t){case 0:return e.call(this,n);case 1:return e.call(this,arguments[0],n);case 2:return e.call(this,arguments[0],arguments[1],n)}var s=Array(t+1);for(i=0;i<t;i++)s[i]=arguments[i];return s[t]=n,e.apply(this,s)}}function ST(e){if(!Uo(e))return{};if(bT)return bT(e);Wd.prototype=e;var t=new Wd;return Wd.prototype=null,t}function NT(e){return function(t){return t==null?void 0:t[e]}}function Ks(e,t){return e!=null&&ET.call(e,t)}function im(e,t){for(var r=t.length,n=0;n<r;n++){if(e==null)return;e=e[t[n]]}return r?e:void 0}var NO=Math.pow(2,53)-1,cs=NT("length");function xn(e){var t=cs(e);return typeof t=="number"&&t>=0&&t<=NO}function Fs(e,t,r){t=Au(t,r);var n,i;if(xn(e))for(n=0,i=e.length;n<i;n++)t(e[n],n,e);else{var s=Dr(e);for(n=0,i=s.length;n<i;n++)t(e[s[n]],s[n],e)}return e}function Go(e,t,r){t=Ln(t,r);for(var n=!xn(e)&&Dr(e),i=(n||e).length,s=Array(i),o=0;o<i;o++){var a=n?n[o]:o;s[o]=t(e[a],a,e)}return s}function DT(e){var t=function(r,n,i,s){var o=!xn(r)&&Dr(r),a=(o||r).length,u=e>0?0:a-1;for(s||(i=r[o?o[u]:u],u+=e);u>=0&&u<a;u+=e){var l=o?o[u]:u;i=n(i,r[l],l,r)}return i};return function(r,n,i,s){var o=arguments.length>=3;return t(r,Au(n,s,4),i,o)}}var Xd=DT(1),xT=DT(-1);function Jd(e,t,r){var n=xn(e)?om:YT,i=n(e,t,r);if(i!==void 0&&i!==-1)return e[i]}function Aa(e,t,r){var n=[];return t=Ln(t,r),Fs(e,function(i,s,o){t(i,s,o)&&n.push(i)}),n}function DO(e,t,r){return Aa(e,um(Ln(t)),r)}function TT(e,t,r){t=Ln(t,r);for(var n=!xn(e)&&Dr(e),i=(n||e).length,s=0;s<i;s++){var o=n?n[s]:s;if(!t(e[o],o,e))return!1}return!0}function PT(e,t,r){t=Ln(t,r);for(var n=!xn(e)&&Dr(e),i=(n||e).length,s=0;s<i;s++){var o=n?n[s]:s;if(t(e[o],o,e))return!0}return!1}function Bi(e,t,r,n){return xn(e)||(e=qo(e)),(typeof r!="number"||n)&&(r=0),VT(e,t,r)>=0}var AO=Cn(function(e,t,r){var n,i;return kn(t)?i=t:Vi(t)&&(n=t.slice(0,-1),t=t[t.length-1]),Go(e,function(s){var o=i;if(!o){if(n&&n.length&&(s=im(s,n)),s==null)return;o=s[t]}return o==null?o:o.apply(s,r)})});function sm(e,t){return Go(e,fm(t))}function RO(e,t){return Aa(e,Nu(t))}function CO(e,t){return Jd(e,Nu(t))}function AT(e,t,r){var n=-1/0,i=-1/0,s,o;if(t==null||typeof t=="number"&&typeof e[0]!="object"&&e!=null){e=xn(e)?e:qo(e);for(var a=0,u=e.length;a<u;a++)s=e[a],s!=null&&s>n&&(n=s)}else t=Ln(t,r),Fs(e,function(l,c,p){o=t(l,c,p),(o>i||o===-1/0&&n===-1/0)&&(n=l,i=o)});return n}function LO(e,t,r){var n=1/0,i=1/0,s,o;if(t==null||typeof t=="number"&&typeof e[0]!="object"&&e!=null){e=xn(e)?e:qo(e);for(var a=0,u=e.length;a<u;a++)s=e[a],s!=null&&s<n&&(n=s)}else t=Ln(t,r),Fs(e,function(l,c,p){o=t(l,c,p),(o<i||o===1/0&&n===1/0)&&(n=l,i=o)});return n}function wO(e){return RT(e,1/0)}function RT(e,t,r){if(t==null||r)return xn(e)||(e=qo(e)),e[em(e.length-1)];var n=xn(e)?ZT(e):qo(e),i=cs(n);t=Math.max(Math.min(t,i),0);for(var s=i-1,o=0;o<t;o++){var a=em(o,s),u=n[o];n[o]=n[a],n[a]=u}return n.slice(0,t)}function _O(e,t,r){var n=0;return t=Ln(t,r),sm(Go(e,function(i,s,o){return{value:i,index:n++,criteria:t(i,s,o)}}).sort(function(i,s){var o=i.criteria,a=s.criteria;if(o!==a){if(o>a||o===void 0)return 1;if(o<a||a===void 0)return-1}return i.index-s.index}),"value")}function lc(e,t){return function(r,n,i){var s=t?[[],[]]:{};return n=Ln(n,i),Fs(r,function(o,a){var u=n(o,a,r);e(s,o,u)}),s}}var FO=lc(function(e,t,r){Ks(e,r)?e[r].push(t):e[r]=[t]}),BO=lc(function(e,t,r){e[r]=t}),VO=lc(function(e,t,r){Ks(e,r)?e[r]++:e[r]=1}),GO=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;function zO(e){return e?Vi(e)?Du.call(e):cm(e)?e.match(GO):xn(e)?Go(e,pm):qo(e):[]}function qO(e){return e==null?0:xn(e)?e.length:Dr(e).length}var kO=lc(function(e,t,r){e[r?0:1].push(t)},!0);function Zd(e,t,r){return e==null||e.length<1?t==null?void 0:[]:t==null||r?e[0]:CT(e,e.length-t)}function CT(e,t,r){return Du.call(e,0,Math.max(0,e.length-(t==null||r?1:t)))}function UO(e,t,r){return e==null||e.length<1?t==null?void 0:[]:t==null||r?e[e.length-1]:ic(e,Math.max(0,e.length-t))}function ic(e,t,r){return Du.call(e,t==null||r?1:t)}function HO(e){return Aa(e,Boolean)}function ko(e,t,r,n){n=n||[];for(var i=n.length,s=0,o=cs(e);s<o;s++){var a=e[s];if(xn(a)&&(Vi(a)||Su(a)))if(t)for(var u=0,l=a.length;u<l;)n[i++]=a[u++];else ko(a,t,r,n),i=n.length;else r||(n[i++]=a)}return n}function $O(e,t){return ko(e,t,!1)}var YO=Cn(function(e,t){return cc(e,t)});function zo(e,t,r,n){eP(t)||(n=r,r=t,t=!1),r!=null&&(r=Ln(r,n));for(var i=[],s=[],o=0,a=cs(e);o<a;o++){var u=e[o],l=r?r(u,o,e):u;t&&!r?((!o||s!==l)&&i.push(u),s=l):r?Bi(s,l)||(s.push(l),i.push(u)):Bi(i,u)||i.push(u)}return i}var WO=Cn(function(e){return zo(ko(e,!0,!0))});function XO(e){for(var t=[],r=arguments.length,n=0,i=cs(e);n<i;n++){var s=e[n];if(!Bi(t,s)){var o;for(o=1;o<r&&Bi(arguments[o],s);o++);o===r&&t.push(s)}}return t}var cc=Cn(function(e,t){return t=ko(t,!0,!0),Aa(e,function(r){return!Bi(t,r)})});function LT(e){for(var t=e&&AT(e,cs).length||0,r=Array(t),n=0;n<t;n++)r[n]=sm(e,n);return r}var ZO=Cn(LT);function jO(e,t){for(var r={},n=0,i=cs(e);n<i;n++)t?r[e[n]]=t[n]:r[e[n][0]]=e[n][1];return r}function wT(e){return function(t,r,n){r=Ln(r,n);for(var i=cs(t),s=e>0?0:i-1;s>=0&&s<i;s+=e)if(r(t[s],s,t))return s;return-1}}var om=wT(1),_T=wT(-1);function FT(e,t,r,n){r=Ln(r,n,1);for(var i=r(t),s=0,o=cs(e);s<o;){var a=Math.floor((s+o)/2);r(e[a])<i?s=a+1:o=a}return s}function BT(e,t,r){return function(n,i,s){var o=0,a=cs(n);if(typeof s=="number")e>0?o=s>=0?s:Math.max(s+a,o):a=s>=0?Math.min(s+1,a):s+a+1;else if(r&&s&&a)return s=r(n,i),n[s]===i?s:-1;if(i!==i)return s=t(Du.call(n,o,a),KT),s>=0?s+o:-1;for(s=e>0?o:a-1;s>=0&&s<a;s+=e)if(n[s]===i)return s;return-1}}var VT=BT(1,om,FT),JO=BT(-1,_T);function QO(e,t,r){t==null&&(t=e||0,e=0),r||(r=t<e?-1:1);for(var n=Math.max(Math.ceil((t-e)/r),0),i=Array(n),s=0;s<n;s++,e+=r)i[s]=e;return i}function KO(e,t){if(t==null||t<1)return[];for(var r=[],n=0,i=e.length;n<i;)r.push(Du.call(e,n,n+=t));return r}function GT(e,t,r,n,i){if(!(n instanceof t))return e.apply(r,i);var s=ST(e.prototype),o=e.apply(s,i);return Uo(o)?o:s}var zT=Cn(function(e,t,r){if(!kn(e))throw new TypeError("Bind must be called on a function");var n=Cn(function(i){return GT(e,n,t,this,r.concat(i))});return n}),Ra=Cn(function(e,t){var r=Ra.placeholder,n=function(){for(var i=0,s=t.length,o=Array(s),a=0;a<s;a++)o[a]=t[a]===r?arguments[i++]:t[a];for(;i<arguments.length;)o.push(arguments[i++]);return GT(e,n,this,this,o)};return n});Ra.placeholder=Ut;var eS=Cn(function(e,t){t=ko(t,!1,!1);var r=t.length;if(r<1)throw new Error("bindAll must be passed function names");for(;r--;){var n=t[r];e[n]=zT(e[n],e)}});function tS(e,t){var r=function(n){var i=r.cache,s=""+(t?t.apply(this,arguments):n);return Ks(i,s)||(i[s]=e.apply(this,arguments)),i[s]};return r.cache={},r}var am=Cn(function(e,t,r){return setTimeout(function(){return e.apply(null,r)},t)}),rS=Ra(am,Ut,1);function nS(e,t,r){var n,i,s,o,a=0;r||(r={});var u=function(){a=r.leading===!1?0:tm(),n=null,o=e.apply(i,s),n||(i=s=null)},l=function(){var c=tm();!a&&r.leading===!1&&(a=c);var p=t-(c-a);return i=this,s=arguments,p<=0||p>t?(n&&(clearTimeout(n),n=null),a=c,o=e.apply(i,s),n||(i=s=null)):!n&&r.trailing!==!1&&(n=setTimeout(u,p)),o};return l.cancel=function(){clearTimeout(n),a=0,n=i=s=null},l}function iS(e,t,r){var n,i,s=function(a,u){n=null,u&&(i=e.apply(a,u))},o=Cn(function(a){if(n&&clearTimeout(n),r){var u=!n;n=setTimeout(s,t),u&&(i=e.apply(this,a))}else n=am(s,t,this,a);return i});return o.cancel=function(){clearTimeout(n),n=null},o}function sS(e,t){return Ra(t,e)}function um(e){return function(){return!e.apply(this,arguments)}}function oS(){var e=arguments,t=e.length-1;return function(){for(var r=t,n=e[t].apply(this,arguments);r--;)n=e[r].call(this,n);return n}}function aS(e,t){return function(){if(--e<1)return t.apply(this,arguments)}}function qT(e,t){var r;return function(){return--e>0&&(r=t.apply(this,arguments)),e<=1&&(t=null),r}}var uS=Ra(qT,2),kT=!{toString:null}.propertyIsEnumerable("toString"),IT=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];function UT(e,t){var r=IT.length,n=e.constructor,i=kn(n)&&n.prototype||rm,s="constructor";for(Ks(e,s)&&!Bi(t,s)&&t.push(s);r--;)s=IT[r],s in e&&e[s]!==i[s]&&!Bi(t,s)&&t.push(s)}function Dr(e){if(!Uo(e))return[];if(hT)return hT(e);var t=[];for(var r in e)Ks(e,r)&&t.push(r);return kT&&UT(e,t),t}function pc(e){if(!Uo(e))return[];var t=[];for(var r in e)t.push(r);return kT&&UT(e,t),t}function qo(e){for(var t=Dr(e),r=t.length,n=Array(r),i=0;i<r;i++)n[i]=e[t[i]];return n}function lS(e,t,r){t=Ln(t,r);for(var n=Dr(e),i=n.length,s={},o=0;o<i;o++){var a=n[o];s[a]=t(e[a],a,e)}return s}function cS(e){for(var t=Dr(e),r=t.length,n=Array(r),i=0;i<r;i++)n[i]=[t[i],e[t[i]]];return n}function HT(e){for(var t={},r=Dr(e),n=0,i=r.length;n<i;n++)t[e[r[n]]]=r[n];return t}function Qd(e){var t=[];for(var r in e)kn(e[r])&&t.push(r);return t.sort()}function lm(e,t){return function(r){var n=arguments.length;if(t&&(r=Object(r)),n<2||r==null)return r;for(var i=1;i<n;i++)for(var s=arguments[i],o=e(s),a=o.length,u=0;u<a;u++){var l=o[u];(!t||r[l]===void 0)&&(r[l]=s[l])}return r}}var $T=lm(pc),ac=lm(Dr);function YT(e,t,r){t=Ln(t,r);for(var n=Dr(e),i,s=0,o=n.length;s<o;s++)if(i=n[s],t(e[i],i,e))return i}function pS(e,t,r){return t in r}var WT=Cn(function(e,t){var r={},n=t[0];if(e==null)return r;kn(n)?(t.length>1&&(n=Au(n,t[1])),t=pc(e)):(n=pS,t=ko(t,!1,!1),e=Object(e));for(var i=0,s=t.length;i<s;i++){var o=t[i],a=e[o];n(a,o,e)&&(r[o]=a)}return r}),fS=Cn(function(e,t){var r=t[0],n;return kn(r)?(r=um(r),t.length>1&&(n=t[1])):(t=Go(ko(t,!1,!1),String),r=function(i,s){return!Bi(t,s)}),WT(e,r,n)}),XT=lm(pc,!0);function dS(e,t){var r=ST(e);return t&&ac(r,t),r}function ZT(e){return Uo(e)?Vi(e)?e.slice():$T({},e):e}function mS(e,t){return t(e),e}function jT(e,t){var r=Dr(t),n=r.length;if(e==null)return!n;for(var i=Object(e),s=0;s<n;s++){var o=r[s];if(t[o]!==i[o]||!(o in i))return!1}return!0}function Kd(e,t,r,n){if(e===t)return e!==0||1/e===1/t;if(e==null||t==null)return!1;if(e!==e)return t!==t;var i=typeof e;return i!=="function"&&i!=="object"&&typeof t!="object"?!1:yS(e,t,r,n)}function yS(e,t,r,n){e instanceof Ut&&(e=e._wrapped),t instanceof Ut&&(t=t._wrapped);var i=oc.call(e);if(i!==oc.call(t))return!1;switch(i){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:+e==0?1/+e===1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object Symbol]":return gT.valueOf.call(e)===gT.valueOf.call(t)}var s=i==="[object Array]";if(!s){if(typeof e!="object"||typeof t!="object")return!1;var o=e.constructor,a=t.constructor;if(o!==a&&!(kn(o)&&o instanceof o&&kn(a)&&a instanceof a)&&"constructor"in e&&"constructor"in t)return!1}r=r||[],n=n||[];for(var u=r.length;u--;)if(r[u]===e)return n[u]===t;if(r.push(e),n.push(t),s){if(u=e.length,u!==t.length)return!1;for(;u--;)if(!Kd(e[u],t[u],r,n))return!1}else{var l=Dr(e),c;if(u=l.length,Dr(t).length!==u)return!1;for(;u--;)if(c=l[u],!(Ks(t,c)&&Kd(e[c],t[c],r,n)))return!1}return r.pop(),n.pop(),!0}function Bs(e,t){return Kd(e,t)}function gS(e){return e==null?!0:xn(e)&&(Vi(e)||cm(e)||Su(e))?e.length===0:Dr(e).length===0}function hS(e){return!!(e&&e.nodeType===1)}function Un(e){return function(t){return oc.call(t)==="[object "+e+"]"}}var Vi=vO||Un("Array");function Uo(e){var t=typeof e;return t==="function"||t==="object"&&!!e}var Su=Un("Arguments"),kn=Un("Function"),cm=Un("String"),JT=Un("Number"),bS=Un("Date"),xS=Un("RegExp"),TS=Un("Error"),QT=Un("Symbol"),PS=Un("Map"),IS=Un("WeakMap"),MS=Un("Set"),ES=Un("WeakSet");(function(){Su(arguments)||(Su=function(e){return Ks(e,"callee")})})();var vS=sc.document&&sc.document.childNodes;typeof/./!="function"&&typeof Int8Array!="object"&&typeof vS!="function"&&(kn=function(e){return typeof e=="function"||!1});function OS(e){return!QT(e)&&OO(e)&&!vT(parseFloat(e))}function KT(e){return JT(e)&&vT(e)}function eP(e){return e===!0||e===!1||oc.call(e)==="[object Boolean]"}function SS(e){return e===null}function NS(e){return e===void 0}function DS(e,t){if(!Vi(t))return Ks(e,t);for(var r=t.length,n=0;n<r;n++){var i=t[n];if(e==null||!ET.call(e,i))return!1;e=e[i]}return!!r}function pm(e){return e}function AS(e){return function(){return e}}function RS(){}function fm(e){return Vi(e)?function(t){return im(t,e)}:NT(e)}function CS(e){return e==null?function(){}:function(t){return Vi(t)?im(e,t):e[t]}}function Nu(e){return e=ac({},e),function(t){return jT(t,e)}}function LS(e,t,r){var n=Array(Math.max(0,e));t=Au(t,r,1);for(var i=0;i<e;i++)n[i]=t(i);return n}function em(e,t){return t==null&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))}var tm=Date.now||function(){return new Date().getTime()},tP={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},wS=HT(tP);function rP(e){var t=function(s){return e[s]},r="(?:"+Dr(e).join("|")+")",n=RegExp(r),i=RegExp(r,"g");return function(s){return s=s==null?"":""+s,n.test(s)?s.replace(i,t):s}}var dm=rP(tP),_S=rP(wS);function FS(e,t,r){Vi(t)||(t=[t]);var n=t.length;if(!n)return kn(r)?r.call(e):r;for(var i=0;i<n;i++){var s=e==null?void 0:e[t[i]];s===void 0&&(s=r,i=n),e=kn(s)?s.call(e):s}return e}var BS=0;function VS(e){var t=++BS+"";return e?e+t:t}var GS=Ut.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},jd=/(.)^/,zS={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},qS=/\\|'|\r|\n|\u2028|\u2029/g,kS=function(e){return"\\"+zS[e]};function US(e,t,r){!t&&r&&(t=r),t=XT({},t,Ut.templateSettings);var n=RegExp([(t.escape||jd).source,(t.interpolate||jd).source,(t.evaluate||jd).source].join("|")+"|$","g"),i=0,s="__p+='";e.replace(n,function(l,c,p,f,m){return s+=e.slice(i,m).replace(qS,kS),i=m+l.length,c?s+=`'+
((__t=(`+c+`))==null?'':_.escape(__t))+
'`:p?s+=`'+
((__t=(`+p+`))==null?'':__t)+
'`:f&&(s+=`';
`+f+`
__p+='`),l}),s+=`';
`,t.variable||(s=`with(obj||{}){
`+s+`}
`),s=`var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};
`+s+`return __p;
`;var o;try{o=new Function(t.variable||"obj","_",s)}catch(l){throw l.source=s,l}var a=function(l){return o.call(this,l,Ut)},u=t.variable||"obj";return a.source="function("+u+`){
`+s+"}",a}function HS(e){var t=Ut(e);return t._chain=!0,t}function mm(e,t){return e._chain?Ut(t).chain():t}function nP(e){return Fs(Qd(e),function(t){var r=Ut[t]=e[t];Ut.prototype[t]=function(){var n=[this._wrapped];return EO.apply(n,arguments),mm(this,r.apply(Ut,n))}}),Ut}Fs(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var t=uc[e];Ut.prototype[e]=function(){var r=this._wrapped;return t.apply(r,arguments),(e==="shift"||e==="splice")&&r.length===0&&delete r[0],mm(this,r)}});Fs(["concat","join","slice"],function(e){var t=uc[e];Ut.prototype[e]=function(){return mm(this,t.apply(this._wrapped,arguments))}});Ut.prototype.value=function(){return this._wrapped};Ut.prototype.valueOf=Ut.prototype.toJSON=Ut.prototype.value;Ut.prototype.toString=function(){return String(this._wrapped)};var $S={default:Ut,VERSION:SO,iteratee:nm,restArguments:Cn,each:Fs,forEach:Fs,map:Go,collect:Go,reduce:Xd,foldl:Xd,inject:Xd,reduceRight:xT,foldr:xT,find:Jd,detect:Jd,filter:Aa,select:Aa,reject:DO,every:TT,all:TT,some:PT,any:PT,contains:Bi,includes:Bi,include:Bi,invoke:AO,pluck:sm,where:RO,findWhere:CO,max:AT,min:LO,shuffle:wO,sample:RT,sortBy:_O,groupBy:FO,indexBy:BO,countBy:VO,toArray:zO,size:qO,partition:kO,first:Zd,head:Zd,take:Zd,initial:CT,last:UO,rest:ic,tail:ic,drop:ic,compact:HO,flatten:$O,without:YO,uniq:zo,unique:zo,union:WO,intersection:XO,difference:cc,unzip:LT,zip:ZO,object:jO,findIndex:om,findLastIndex:_T,sortedIndex:FT,indexOf:VT,lastIndexOf:JO,range:QO,chunk:KO,bind:zT,partial:Ra,bindAll:eS,memoize:tS,delay:am,defer:rS,throttle:nS,debounce:iS,wrap:sS,negate:um,compose:oS,after:aS,before:qT,once:uS,keys:Dr,allKeys:pc,values:qo,mapObject:lS,pairs:cS,invert:HT,functions:Qd,methods:Qd,extend:$T,extendOwn:ac,assign:ac,findKey:YT,pick:WT,omit:fS,defaults:XT,create:dS,clone:ZT,tap:mS,isMatch:jT,isEqual:Bs,isEmpty:gS,isElement:hS,isArray:Vi,isObject:Uo,isArguments:Su,isFunction:kn,isString:cm,isNumber:JT,isDate:bS,isRegExp:xS,isError:TS,isSymbol:QT,isMap:PS,isWeakMap:IS,isSet:MS,isWeakSet:ES,isFinite:OS,isNaN:KT,isBoolean:eP,isNull:SS,isUndefined:NS,has:DS,identity:pm,constant:AS,noop:RS,property:fm,propertyOf:CS,matcher:Nu,matches:Nu,times:LS,random:em,now:tm,escape:dm,unescape:_S,result:FS,uniqueId:VS,templateSettings:GS,template:US,chain:HS,mixin:nP},MT=nP($S);MT._=MT;function ym(e,t=e,r=!1){if(isNaN(e)||!isFinite(e))return{string:"undefined",latex:"undefined",value:e};if(e===0)return{string:"0",latex:"0",value:e};Math.abs(e)>Math.abs(t)&&(t=e);let n=ws(e/Math.PI,24),i,s,o,a,u,l;if(iP(t)&&Kr(n.n/n.d*Math.PI,e,3))return n.n===0?(i="0",a="0"):n.n===1?(i="\u03C0",a="\\pi"):n.n===-1?(i="-\u03C0",a="-\\pi"):(i=n.n.toString()+"\u03C0",a=n.n.toString()+"\\pi"),n.d===1?(s="",u=""):(s="/"+n.d.toString(),u=n.d.toString()),o=i+s,u===""?l=a:a[0]==="-"?l=`-\\frac{${a.slice(1)}}{${u}}`:l=`\\frac{${a}}{${u}}`,{string:o,latex:l,value:n.n/n.d*Math.PI};if(!r&&iP(t)||ZS(t))return o=XS(sP(e.toFixed(fc(t)))),{string:o,latex:o,value:parseFloat(o)};{let p=gm(e.toExponential(fc(t/e))).split("e"),f=p[0]==="1"&&r?"10":p[0]+"\xD710",m=p[1].replace("+","");return o=gm(e.toExponential(fc(t/e))).replace("+",""),l=`${p[0]}\\times10^{${m}}`,{string:o,latex:l,mantissa:f,superscript:m,value:parseFloat(o)}}}function YS(e,t,r,n){let i=ym(e,t),s=ym(n(i.value),r);return[i,s]}var WS=/\.?0+$/;function sP(e){return e.indexOf(".")===-1?e:e.replace(WS,"")}function gm(e){let t=/\.?0+e/;return e.replace(t,"e")}function XS(e){return e==="-0"?"0":e}function iP(e){return e=Math.abs(e),1e-4<e&&e<1e7}function ZS(e){return e=Math.abs(e),.001<e&&e<1e4}function fc(e){return e=Math.abs(e),e=Math.max(e,1e-16),Math.max(3,Math.floor(4.5-Math.log(e)/Math.LN10))}function jS(e){return Math.abs(e)>=1e-20?parseFloat(e.toFixed(fc(e))):e}function oP(e){return 1e6/Math.sqrt(Math.abs(e))}function aP(e){let t=oP(e);if(t<1||t>1e12)return!1;let{n:r,d:n}=ws(e,t);return n===1?!1:e===e+Math.pow(2,-3)*Math.abs(r/n-e)}function dc(e,t){if(t=t||{},isNaN(e)||!isFinite(e))return{type:"undefined"};if(e===0||t.zeroCutoff&&Math.abs(e)<t.zeroCutoff)return{type:"decimal",value:"0"};let r=t.smallCutoff||.001,n=t.bigCutoff||1e6,i=t.digits||10,o=gm(e.toExponential(i-2)).match(/([\d\.\-]+)e\+?([\d\-]+)/);if(!o)return{type:"undefined"};let a=parseInt(o[2],10)>=i;if(aP(e)&&t.displayAsFraction){let l=ws(e,oP(e));return{type:"fraction",numerator:l.n.toString(),denominator:l.d.toString()}}else{if(Math.abs(e)>n||Math.abs(e)<r||a)return{type:"scientific",mantissa:o[1],exponent:o[2]};{let l=sP(e.toPrecision(i));return e!==Number(l)&&t.addEllipses&&(l+="..."),{type:"decimal",value:l}}}}function JS(e,t){let r=dc(e,t);switch(r.type){case"undefined":return"undefined";case"decimal":return r.value;case"scientific":return r.mantissa+"<span class='dcg-cross'>\xD7</span>10<sup>"+r.exponent+"</sup>";case"fraction":return r.denominator==="1"?r.numerator:`${r.numerator}/${r.denominator}`;default:return r}}function hm(e,t){let r=dc(e,t);switch(r.type){case"undefined":return"undefined";case"decimal":return r.value;case"scientific":return r.mantissa+" * 10^"+r.exponent;case"fraction":return r.denominator==="1"?r.numerator:`${r.numerator}/${r.denominator}`;default:return r}}function bm(e,t){let r=dc(e,t);switch(r.type){case"undefined":return"undefined";case"decimal":return r.value;case"scientific":return r.mantissa+"\\times10^{"+r.exponent+"}";case"fraction":return r.denominator==="1"?r.numerator:r.numerator[0]==="-"?`-\\frac{${r.numerator.slice(1)}}{${r.denominator}}`:`\\frac{${r.numerator}}{${r.denominator}}`;default:return r}}function Y(e){e=e.replace("\\","");let t={pi:"\u03C0",tau:"\u03C4",theta:"\u03B8",phi:"\u03D5",div:"\xF7",cdot:"\u22C5",times:"\xD7",lt:"<",gt:">",le:"\u2264",ge:"\u2265",sim:"\u223C",ldots:"\u2026",prime:"\u2032",approx:"\u2248",to:"\u2192","->":"\u2192"};return t.hasOwnProperty(e)?t[e]:e}function QS(e){if(!e)return"";let t=vr(e[0]);return e[1]!==void 0&&(t+="\\left["+e[1]+"\\right]"),t}function vr(e){let t=e.match(/^\$(\d+)$/);if(t)return`\\token{${t[1]}}`;let r=e.split("_"),n="";return r[0].length>1&&(n+="\\"),n+=r[0],r[1]&&(n+="_{"+r[1]+"}"),n}function KS(e){if(!e)return"";let t=e.split("_");t[0]=Y(t[0]);let r=t.map(dm);return r[1]&&(r[1]="<sub>"+r[1]+"</sub>"),r.join("")}function ps(e){let t=e.match(/\\token\{(\d+)\}/);return t?`$${t[1]}`:(e=e.replace(/\\operatorname\{(.*)\}/,"$1"),e.replace(/[{}\\]/g,""))}function fs(e){return e.replace(/^(\\ | |\\space)+/,"").replace(/(\\ | |\\space)+$/,"")}var lt=class extends q{constructor(r){super([]);this._symbol=ps(r),this._errorSymbol=this._symbol,this.addDependency(this._symbol)}setInputSpan(r){super.setInputSpan(r),this._errorSymbol=ps(this.getInputString())}getInputSpan(){return this._inputSpan===void 0?cn(this._symbol,0,this._symbol.length):this._inputSpan}};var pt={};ui(pt,{Action:()=>ut,Add:()=>st,And:()=>Ot,BeginBroadcast:()=>We,BeginIntegral:()=>Ye,BeginLoop:()=>je,BlockVar:()=>qe,BroadcastResult:()=>le,Constant:()=>F,DeferredListAccess:()=>Ge,Distribution:()=>nt,Divide:()=>bt,EndBroadcast:()=>Mt,EndIntegral:()=>dt,EndLoop:()=>It,Equal:()=>Et,Exponent:()=>He,ExtendSeed:()=>St,Greater:()=>vt,GreaterEqual:()=>yt,InboundsListAccess:()=>Je,Less:()=>mt,LessEqual:()=>ct,List:()=>ze,ListAccess:()=>Xe,LoadArg:()=>it,MAX_LEAF_OPCODE:()=>xm,Multiply:()=>rt,NativeFunction:()=>Oe,Negative:()=>xt,Noop:()=>Yt,OrderedPair:()=>ot,OrderedPairAccess:()=>Tt,OrderedTriple:()=>at,OrderedTripleAccess:()=>Pt,Piecewise:()=>Ae,RawExponent:()=>$e,Subtract:()=>ht,SymbolicVar:()=>Or});var Yt=0,F=1,it=2,Or=3,xm=3,st=8,ht=9,rt=10,bt=11,He=12,$e=13,xt=14,ot=15,at=16,Tt=17,Pt=18,je=19,It=20,Ye=21,dt=22,We=23,Mt=24,Et=25,mt=26,vt=27,ct=28,yt=29,Ot=32,Ae=33,Oe=37,ze=38,Xe=39,Ge=40,Je=41,nt=42,St=44,qe=47,le=48,ut=49;function eN(e){switch(e){case"default":case"trig":case"inverseTrig":case"trig2":case"never-broadcast":return[x];case"reducer":return[Z];case"doubleReducer":return[Z,Z];case"parameterizedReducer":return[Z,x];case"color":return[x,x,x]}}function tN(e){switch(e){case"default":case"trig":case"inverseTrig":case"trig2":case"doubleReducer":case"color":case"never-broadcast":return!1;case"reducer":case"parameterizedReducer":return!0}}function rN(e,t,r){return e==="reducer"?1/0:t+r}function C(e,t,r){var l,c,p,f;let n=(l=r==null?void 0:r.tag)!=null?l:"default",i=(c=r==null?void 0:r.argumentTypes)!=null?c:eN(n),s=r!=null&&r.defaultArguments?r.defaultArguments.length:0,o=i.length-s,a=rN(n,o,s),u=(p=r==null?void 0:r.allowDotCall)!=null?p:tN(n);return{module:e,symbol:t,argumentTypes:i,defaultArguments:r==null?void 0:r.defaultArguments,returnType:(f=r==null?void 0:r.returnType)!=null?f:x,tag:n,minArity:o,maxArity:a,allowDotCall:u}}function Mm(e){if(!kt(e))throw new Error("Programming Error: numeric constants should be rational");return{type:1,valueType:x,value:e}}var Ho=Mm(he(0,1)),$o=Mm(he(1,1)),Im=Mm(he(1,2));function eo(e){let t;return e in gr&&(t=gr[e].tag),t==="trig"||t==="trig2"||t==="inverseTrig"?!0:e==="angle"||e==="angles"||e==="directedangle"||e==="directedangles"}var gr={sin:C("BuiltIn","sin",{tag:"trig"}),cos:C("BuiltIn","cos",{tag:"trig"}),tan:C("BuiltIn","tan",{tag:"trig"}),cot:C("BuiltIn","cot",{tag:"trig"}),sec:C("BuiltIn","sec",{tag:"trig"}),csc:C("BuiltIn","csc",{tag:"trig"}),arcsin:C("Math","asin",{tag:"inverseTrig"}),arccos:C("Math","acos",{tag:"inverseTrig"}),arctan:C("Math","atan2",{argumentTypes:[x,x],defaultArguments:[$o],tag:"inverseTrig"}),arccot:C("BuiltIn","acot",{tag:"inverseTrig"}),arcsec:C("BuiltIn","asec",{tag:"inverseTrig"}),arccsc:C("BuiltIn","acsc",{tag:"inverseTrig"}),sinh:C("BuiltIn","sinh"),cosh:C("BuiltIn","cosh"),tanh:C("BuiltIn","tanh"),coth:C("BuiltIn","coth"),sech:C("BuiltIn","sech"),csch:C("BuiltIn","csch"),arcsinh:C("BuiltIn","asinh"),arccosh:C("BuiltIn","acosh"),arctanh:C("BuiltIn","atanh"),arccoth:C("BuiltIn","acoth"),arcsech:C("BuiltIn","asech"),arccsch:C("BuiltIn","acsch"),sqrt:C("Math","sqrt"),rtxsqpone:C("BuiltIn","sqrtxsqp1"),rtxsqmone:C("BuiltIn","sqrtxsqm1"),nthroot:C("BuiltIn","nthroot",{argumentTypes:[x,x]}),hypot:C("BuiltIn","hypot",{argumentTypes:[x,x]}),log:C("BuiltIn","common_log"),logbase:C("BuiltIn","log_base",{argumentTypes:[x,x]}),ln:C("BuiltIn","log"),exp:C("Math","exp"),floor:C("Math","floor"),ceil:C("Math","ceil"),round:C("Math","round"),abs:C("Math","abs"),sign:C("BuiltIn","sign"),mod:C("BuiltIn","mod",{argumentTypes:[x,x]}),nCr:C("BuiltIn","nCr",{argumentTypes:[x,x]}),nPr:C("BuiltIn","nPr",{argumentTypes:[x,x]}),factorial:C("BuiltIn","factorial"),polyGamma:C("BuiltIn","polyGamma",{argumentTypes:[x,x]}),lcm:C("BuiltIn","listLCM",{tag:"reducer"}),gcd:C("BuiltIn","listGCD",{tag:"reducer"}),distance:C("BuiltIn","distance",{argumentTypes:[A,A]}),polygon:C("BuiltIn","polygon",{tag:"reducer",argumentTypes:[Be],returnType:Te}),area:C("BuiltIn","polygonArea",{argumentTypes:[Te]}),perimeter:C("BuiltIn","polygonPerimeter",{argumentTypes:[Te]}),pointDet:C("BuiltIn","pointDet",{argumentTypes:[A,A]}),pointDot:C("BuiltIn","pointDot",{argumentTypes:[A,A]}),pointPerp:C("BuiltIn","pointPerp",{argumentTypes:[A],returnType:A}),segment:C("BuiltIn","segment",{argumentTypes:[A,A],returnType:pe}),line:C("BuiltIn","line",{argumentTypes:[A,A],returnType:ne}),ray:C("BuiltIn","ray",{argumentTypes:[A,A],returnType:Pe}),circle:C("BuiltIn","circle",{argumentTypes:[A,x],returnType:ie}),center:C("BuiltIn","center",{argumentTypes:[ie],returnType:A,allowDotCall:!0}),radius:C("BuiltIn","radius",{argumentTypes:[ie],returnType:x,allowDotCall:!0}),arc:C("BuiltIn","arc",{argumentTypes:[A,A,A],returnType:ee}),arcCenter:C("BuiltIn","arcCenter",{argumentTypes:[ee],returnType:A}),arcOmega:C("BuiltIn","arcOmega",{argumentTypes:[ee],returnType:x}),undirectedAngleMarker:C("BuiltIn","undirectedAngleMarker",{argumentTypes:[oe],returnType:de}),directedAngleMarker:C("BuiltIn","directedAngleMarker",{argumentTypes:[A,x,x,x],returnType:oe}),directedCoterminalAngle:C("BuiltIn","directedCoterminalAngle",{argumentTypes:[oe],returnType:oe}),undirectedCoterminalAngle:C("BuiltIn","undirectedCoterminalAngle",{argumentTypes:[de],returnType:de}),supplement:C("BuiltIn","supplementAngle",{argumentTypes:[oe],returnType:oe}),directedAngleMarkerRawDelta:C("BuiltIn","angleMarkerRawDelta",{argumentTypes:[oe],returnType:x}),undirectedAngleMarkerRawDelta:C("BuiltIn","angleMarkerRawDelta",{argumentTypes:[de],returnType:x}),directedAngleMarkerMultiplier:C("BuiltIn","angleMarkerMultiplier",{argumentTypes:[oe],returnType:x}),undirectedAngleMarkerMultiplier:C("BuiltIn","angleMarkerMultiplier",{argumentTypes:[de],returnType:x}),polygonInteriorUndirectedAngles:C("BuiltIn","polygonInteriorUndirectedAngles",{argumentTypes:[Te,x],returnType:Lt,allowDotCall:!0,tag:"never-broadcast"}),polygonInteriorDirectedAngles:C("BuiltIn","polygonInteriorDirectedAngles",{argumentTypes:[Te,x],returnType:wt,allowDotCall:!0,tag:"never-broadcast"}),vertices:C("BuiltIn","vertices",{argumentTypes:[Te],returnType:Be,allowDotCall:!0,tag:"never-broadcast"}),segments:C("BuiltIn","polygonEdges",{argumentTypes:[Te],returnType:$t,allowDotCall:!0,tag:"never-broadcast"}),scaleTangentSegment:C("BuiltIn","scaleTangentSegment",{argumentTypes:[pe,x],returnType:pe}),scaleTangentLine:C("BuiltIn","scaleTangentLine",{argumentTypes:[ne,x],returnType:ne}),scaleTangentRay:C("BuiltIn","scaleTangentRay",{argumentTypes:[Pe,x],returnType:Pe}),scaleTangentCircle:C("BuiltIn","scaleTangentCircle",{argumentTypes:[ie,x],returnType:ie}),scaleTangentArc:C("BuiltIn","scaleTangentArc",{argumentTypes:[ee,x],returnType:ie}),scaleTangentDirectedAngleMarker:C("BuiltIn","scaleTangentAngle",{argumentTypes:[oe,x],returnType:oe}),scaleTangentUndirectedAngleMarker:C("BuiltIn","scaleTangentAngle",{argumentTypes:[de,x],returnType:de}),addTangentSegment:C("BuiltIn","addTangentSegment",{argumentTypes:[pe,pe],returnType:pe}),addTangentLine:C("BuiltIn","addTangentLine",{argumentTypes:[ne,ne],returnType:ne}),addTangentRay:C("BuiltIn","addTangentRay",{argumentTypes:[Pe,Pe],returnType:Pe}),addTangentCircle:C("BuiltIn","addTangentCircle",{argumentTypes:[ie,ie],returnType:ie}),addTangentArc:C("BuiltIn","addTangentArc",{argumentTypes:[ee,ee],returnType:ee}),addTangentDirectedAngleMarker:C("BuiltIn","addTangentAngle",{argumentTypes:[oe,oe],returnType:oe}),addTangentUndirectedAngleMarker:C("BuiltIn","addTangentAngle",{argumentTypes:[de,de],returnType:de}),segmentGlider:C("BuiltIn","segmentGlider",{argumentTypes:[pe,x],returnType:A}),lineGlider:C("BuiltIn","lineGlider",{argumentTypes:[ne,x],returnType:A}),rayGlider:C("BuiltIn","rayGlider",{argumentTypes:[Pe,x],returnType:A}),circleGlider:C("BuiltIn","circleGlider",{argumentTypes:[ie,x],returnType:A}),arcGlider:C("BuiltIn","arcGlider",{argumentTypes:[ee,x],returnType:A}),polygonGlider:C("BuiltIn","polygonGlider",{argumentTypes:[Te,x],returnType:A}),chooseNonIncidentPoint:C("BuiltIn","chooseNonIncidentPoint",{argumentTypes:[A,A,A],returnType:A}),circleCircleIntersection:C("BuiltIn","circleCircleIntersection",{argumentTypes:[ie,ie,x],returnType:A}),circleArcIntersection:C("BuiltIn","circleArcIntersection",{argumentTypes:[ie,ee,x],returnType:A}),circleLineIntersection:C("BuiltIn","circleLineIntersection",{argumentTypes:[ie,ne,x],returnType:A}),arcCircleIntersection:C("BuiltIn","arcCircleIntersection",{argumentTypes:[ee,ie,x],returnType:A}),arcArcIntersection:C("BuiltIn","arcArcIntersection",{argumentTypes:[ee,ee,x],returnType:A}),arcLineIntersection:C("BuiltIn","arcLineIntersection",{argumentTypes:[ee,ne,x],returnType:A}),lineCircleIntersection:C("BuiltIn","lineCircleIntersection",{argumentTypes:[ne,ie,x],returnType:A}),lineArcIntersection:C("BuiltIn","lineArcIntersection",{argumentTypes:[ne,ee,x],returnType:A}),lineLineIntersection:C("BuiltIn","lineLineIntersection",{argumentTypes:[ne,ne,x],returnType:A}),lineFromSegment:C("BuiltIn","identity",{argumentTypes:[pe],returnType:ne}),lineFromRay:C("BuiltIn","identity",{argumentTypes:[Pe],returnType:ne}),parallel:C("BuiltIn","parallel",{argumentTypes:[ne,A],returnType:ne}),perpendicular:C("BuiltIn","perpendicular",{argumentTypes:[ne,A],returnType:ne}),translation:C("BuiltIn","translation",{argumentTypes:[A],returnType:Re}),dilation:C("BuiltIn","dilation",{argumentTypes:[A,x],returnType:Re}),rotation:C("BuiltIn","rotation",{tag:"trig2",argumentTypes:[A,x],returnType:Re}),reflection:C("BuiltIn","reflection",{argumentTypes:[ne],returnType:Re}),compose:C("BuiltIn","composeTransformation",{argumentTypes:[Re,Re],returnType:Re}),inverse:C("BuiltIn","invertTransformation",{argumentTypes:[Re],returnType:Re}),transformPoint:C("BuiltIn","transformPoint",{argumentTypes:[Re,A],returnType:A}),transformSegment:C("BuiltIn","transformSegment",{argumentTypes:[Re,pe],returnType:pe}),transformLine:C("BuiltIn","transformLine",{argumentTypes:[Re,ne],returnType:ne}),transformRay:C("BuiltIn","transformRay",{argumentTypes:[Re,Pe],returnType:Pe}),transformCircle:C("BuiltIn","transformCircle",{argumentTypes:[Re,ie],returnType:ie}),transformArc:C("BuiltIn","transformArc",{argumentTypes:[Re,ee],returnType:ee}),transformPolygon:C("BuiltIn","transformPolygon",{argumentTypes:[Re,Te],returnType:Te}),transformAngleMarker:C("BuiltIn","transformAngleMarker",{argumentTypes:[Re,de],returnType:de}),transformDirectedAngleMarker:C("BuiltIn","transformAngleMarker",{argumentTypes:[Re,oe],returnType:oe}),distance3d:C("BuiltIn","distance3d",{argumentTypes:[G,G]}),segment3d:C("BuiltIn","segment3d",{argumentTypes:[G,G],returnType:tr}),triangle:C("BuiltIn","triangle",{argumentTypes:[G,G,G],returnType:mr}),sphere:C("BuiltIn","sphere",{argumentTypes:[G,x],returnType:yr}),mean:C("BuiltIn","mean",{tag:"reducer"}),total:C("BuiltIn","total",{tag:"reducer"}),stdev:C("BuiltIn","stdev",{tag:"reducer"}),stdevp:C("BuiltIn","stdevp",{tag:"reducer"}),mad:C("BuiltIn","mad",{tag:"reducer"}),count:C("BuiltIn","listLength",{tag:"reducer",argumentTypes:[Bt]}),min:C("BuiltIn","listMin",{tag:"reducer"}),max:C("BuiltIn","listMax",{tag:"reducer"}),argmin:C("BuiltIn","argMin",{tag:"reducer"}),argmax:C("BuiltIn","argMax",{tag:"reducer"}),median:C("BuiltIn","median",{tag:"reducer"}),var:C("BuiltIn","variance",{tag:"reducer"}),varp:C("BuiltIn","varp",{tag:"reducer"}),cov:C("BuiltIn","cov",{tag:"doubleReducer"}),covp:C("BuiltIn","covp",{tag:"doubleReducer"}),corr:C("BuiltIn","corr",{tag:"doubleReducer"}),spearman:C("BuiltIn","spearman",{tag:"doubleReducer"}),quantile:C("BuiltIn","quantile",{tag:"parameterizedReducer"}),quartile:C("BuiltIn","quartile",{tag:"parameterizedReducer"}),upperQuantileIndex:C("BuiltIn","upperQuantileIndex",{tag:"parameterizedReducer"}),lowerQuantileIndex:C("BuiltIn","lowerQuantileIndex",{tag:"parameterizedReducer"}),quartileIndex:C("BuiltIn","quartileIndex",{tag:"parameterizedReducer"}),upperQuartileIndex:C("BuiltIn","upperQuartileIndex",{tag:"parameterizedReducer"}),lowerQuartileIndex:C("BuiltIn","lowerQuartileIndex",{tag:"parameterizedReducer"}),normalcdf:C("BuiltIn","normalcdf",{argumentTypes:[x,x,x,x],defaultArguments:[Ho,$o]}),normalpdf:C("BuiltIn","normalpdf",{argumentTypes:[x,x,x],defaultArguments:[Ho,$o]}),binomcdf:C("BuiltIn","binomcdf",{argumentTypes:[x,x,x,x],defaultArguments:[Im]}),binompdf:C("BuiltIn","binompdf",{argumentTypes:[x,x,x],defaultArguments:[Im]}),poissoncdf:C("BuiltIn","poissoncdf",{argumentTypes:[x,x,x]}),poissonpdf:C("BuiltIn","poissonpdf",{argumentTypes:[x,x,x]}),uniformcdf:C("BuiltIn","uniformcdf",{argumentTypes:[x,x,x,x],defaultArguments:[Ho,$o]}),uniformpdf:C("BuiltIn","uniformpdf",{argumentTypes:[x,x,x],defaultArguments:[Ho,$o]}),invT:C("BuiltIn","invT",{argumentTypes:[x,x]}),invPoisson:C("BuiltIn","invPoisson",{argumentTypes:[x,x]}),invBinom:C("BuiltIn","invBinom",{argumentTypes:[x,x,x]}),invUniform:C("BuiltIn","invUniform",{argumentTypes:[x,x,x]}),tpdf:C("BuiltIn","tpdf",{argumentTypes:[x,x]}),tcdf:C("BuiltIn","tcdf",{argumentTypes:[x,x,x]}),erf:C("BuiltIn","erf"),invNorm:C("BuiltIn","invNorm"),tscore:C("BuiltIn","tscore",{tag:"parameterizedReducer",defaultArguments:[Ho]}),normalSample:C("BuiltIn","normalSample",{argumentTypes:[Ve,x,x]}),uniformSample:C("BuiltIn","uniformSample",{argumentTypes:[Ve,x,x]}),tSample:C("BuiltIn","tSample",{argumentTypes:[Ve,x]}),poissonSample:C("BuiltIn","poissonSample",{argumentTypes:[Ve,x]}),binomSample:C("BuiltIn","binomSample",{argumentTypes:[Ve,x,x]}),rgb:C("BuiltIn","rgb",{returnType:tt,tag:"color"}),hsv:C("BuiltIn","hsv",{returnType:tt,tag:"color"}),validateRangeLength:C("BuiltIn","validateRangeLength",{returnType:x,argumentTypes:[Z,Z,x,x],tag:"never-broadcast"}),validateSampleCount:C("BuiltIn","validateSampleCount",{returnType:x,argumentTypes:[x]}),select:C("BuiltIn","select",{argumentTypes:[Bt,Ir],returnType:e=>e[0],tag:"never-broadcast"}),shuffle:C("BuiltIn","shuffle",{argumentTypes:[Ve,Bt],returnType:e=>e[1],tag:"never-broadcast"}),sortPerm:C("BuiltIn","sortPerm",{argumentTypes:[Z],returnType:Z,tag:"never-broadcast"}),elementsAt:C("BuiltIn","elementsAt",{argumentTypes:[Bt,Z],returnType:e=>e[0],tag:"never-broadcast"}),uniquePerm:C("BuiltIn","uniquePerm",{argumentTypes:[Bt],returnType:Z,tag:"never-broadcast"})};function De(e,t){var m,d,y,g;let r=t==null?void 0:t.defaultArguments,n=1/0,i=0,s=(m=r==null?void 0:r.length)!=null?m:0;t!=null&&t.noBroadcast||(e=e.map(os));for(let h of e){let P=(Array.isArray(h)?h.length:h.initial.length)-s;P<n&&(n=P);let T=Array.isArray(h)?h.length:1/0;T>i&&(i=T)}let o=(d=t==null?void 0:t.fallthroughUnlessDistribution)!=null?d:!1,a=(y=t==null?void 0:t.allowDotCall)!=null?y:!1,u=(g=t==null?void 0:t.isSeeded)!=null?g:!1,l=t==null?void 0:t.minArityExampleArgs,c=t==null?void 0:t.maxArityExampleArgs,p=t==null?void 0:t.dotMinArityExampleArgs,f=t==null?void 0:t.dotMaxArityExampleArgs;return{minArity:n,argumentTypes:e,maxArity:i,defaultArguments:r,fallthroughUnlessDistribution:o,minArityExampleArgs:l,maxArityExampleArgs:c,dotMinArityExampleArgs:p,dotMaxArityExampleArgs:f,allowDotCall:a,isSeeded:u}}function Gi(){return De([{type:"variadic",initial:[],rest:ft}],{})}var mc={meta:"union",types:[pe,ie,ne,Pe,ee]},Tm={meta:"union",types:[pe,ne,Pe]},Cu={meta:"union",types:[A,pe,ie,ne,Pe,ee,Te,de,oe]},Pm={meta:"union",types:[...An.filter(e=>e!==Qt),et]},zi={midpoint:De([[A,A],[G,G],[pe]],{allowDotCall:!0}),segment:De([[A,A],[G,G]]),distance:De([[A,A],[G,G]]),glider:De([[{meta:"union",types:[pe,ie,ne,Pe,ee,Te]},x]]),circle:De([[A,pe],[A,A]],{}),center:De([[ie],[ee]],{allowDotCall:!0}),radius:De([[ie],[ee]],{allowDotCall:!0}),intersection:De([[mc,mc]]),strictintersection:De([[mc,mc]]),parallel:De([[Tm,A]]),perpendicular:De([[Tm,A]]),length:De([[{meta:"union",types:An}],os([pe]),os([ee]),{type:"variadic",initial:[ft],rest:ft}],{allowDotCall:!0,noBroadcast:!0}),translate:De([[Cu,A,A]]),dilate:De([[Cu,A,x]]),rotate:De([[Cu,A,x]]),reflect:De([[Cu,Tm]]),apply:De([[Re,Cu]]),points:De([]),lines:De([]),circles:De([]),arcs:De([]),polygons:De([]),rays:De([]),angle:De([[A,A,A]]),directedangle:De([[A,A,A]]),angles:De([[Te]],{allowDotCall:!0}),directedangles:De([[Te]],{allowDotCall:!0}),coterminal:De([[de],[oe]]),round:De([[x],[x,x]]),sort:De([[{meta:"union",types:An}],[{meta:"union",types:An},Z]],{minArityExampleArgs:"([3,2,1])",maxArityExampleArgs:"([1,2,3],[3,2,1])",dotMaxArityExampleArgs:"([3,4])",allowDotCall:!0}),shuffle:De([[Ve,{meta:"union",types:An}],[Ve,{meta:"union",types:An},x]],{minArityExampleArgs:"([1,2,3])",maxArityExampleArgs:"([1,2,3],2)",dotMaxArityExampleArgs:"(2)",allowDotCall:!0,isSeeded:!0,noBroadcast:!0}),join:De([{type:"variadic",initial:[{meta:"union",types:An},{meta:"union",types:An}],rest:{meta:"union",types:An}}],{minArityExampleArgs:"([1,2],[3,4])",dotMinArityExampleArgs:"([3,4])",allowDotCall:!0}),unique:De([[{meta:"union",types:An}]],{minArityExampleArgs:"([1,2,3])",maxArityExampleArgs:"([1,2,3])",allowDotCall:!0}),normaldist:De([[x,x]],{defaultArguments:[Ho,$o]}),tdist:De([[x]]),binomialdist:De([[x,x]],{defaultArguments:[Im]}),poissondist:De([[x]]),uniformdist:De([[x,x]],{defaultArguments:[Ho,$o]}),pdf:De([[et,x]],{allowDotCall:!0}),cdf:De([[et,x],[et,x,x]],{allowDotCall:!0}),mean:De([[et]],{fallthroughUnlessDistribution:!0,allowDotCall:!0}),median:De([[et]],{fallthroughUnlessDistribution:!0,allowDotCall:!0}),stdev:De([[et]],{fallthroughUnlessDistribution:!0,allowDotCall:!0}),var:De([[et]],{fallthroughUnlessDistribution:!0,allowDotCall:!0}),quantile:De([[et,x]],{fallthroughUnlessDistribution:!0,allowDotCall:!0,minArityExampleArgs:"([1,2,3], 1)",maxArityExampleArgs:"([1,2,3], 1)",dotMinArityExampleArgs:"(x)",dotMaxArityExampleArgs:"(x)"}),random:De([[Ve],[Ve,x],[Ve,x,x],[Ve,Pm],[Ve,Pm,x],[Ve,Pm,x,x]],{allowDotCall:!0,isSeeded:!0,noBroadcast:!0}),polygon:De([[Z,Z],[Be],{type:"variadic",initial:[],rest:A}],{noBroadcast:!0}),histogram:Gi(),dotplot:Gi(),boxplot:Gi(),ttest:Gi(),ittest:Gi(),stats:Gi(),det:Gi(),inv:Gi(),transpose:Gi(),rref:Gi(),trace:Gi()};var Ar=class extends q{constructor(r,n){super(n,{skipRegisterDependencies:!0});typeof r=="string"&&(r=new lt(r)),this._identifier=r,this._symbol=r._symbol,this._errorSymbol=r._errorSymbol==="logbase"?"log":r._errorSymbol,this.registerDependencies()}registerDependencies(){this.addDependency(this._symbol),super.registerDependencies(),eo(this._symbol)&&this.addDependency("trigAngleMultiplier")}copyWithArgs(r){return new this.constructor(new lt(this._symbol),r)}};var ds=class extends q{};var yc={pi:new rr(Math.PI),tau:new rr(2*Math.PI),e:new rr(Math.E),trigAngleMultiplier:new rr(he(1,1)),infty:new rr(1/0),identityTransformation:new Ar("translation",[new ds([new rr(0),new rr(0)])])};var gc=class extends Ue{constructor(){super(...arguments);this.isFunction=!0}},ms,Se={};for(ms in yc)yc.hasOwnProperty(ms)&&(Se[ms]=yc[ms]);for(ms in gr)gr.hasOwnProperty(ms)&&(Se[ms]=new gc);for(ms in zi)zi.hasOwnProperty(ms)&&(Se[ms]=new gc);function iN(e){var t={};return e.additionalFunctions&&e.additionalFunctions.indexOf("sqrt")!==-1&&(t.sqrt=Se.sqrt),e.width&&(t.width=e.width),e.height&&(t.height=e.height),t}var Em={};ui(Em,{getFrame:()=>sN});var uP=["pi","e","trigAngleMultiplier"],lP=["sqrt","nthroot","abs","ln","sin","cos","tan","log","arcsin","arccos","arctan","mean","round","stdev","stdevp","nCr","nPr","exp","factorial"];function cP(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(!t.hasOwnProperty(n))throw new Error("Programming Error: key '"+n+`' does not exist in table. Must be one of:
`+Object.keys(t).join(`
`))}}cP(uP,Se);cP(lP,Se);function sN(e){var t={};return uP.forEach(function(r){t[r]=Se[r]}),lP.forEach(function(r){e.replaceRoundWithReciprocal&&r==="round"||(t[r]=Se[r])}),e.trigAngleMultiplier&&(t.trigAngleMultiplier=e.trigAngleMultiplier),e.width&&(t.width=e.width),e.height&&(t.height=e.height),t}var vm={};ui(vm,{getFrame:()=>oN});var pP=["pi","e","trigAngleMultiplier"],fP=["sqrt","nthroot","abs","ln","sin","cos","tan","log","arcsin","arccos","arctan","exp","factorial"];function dP(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(!t.hasOwnProperty(n))throw new Error("Programming Error: key '"+n+`' does not exist in table. Must be one of:
`+Object.keys(t).join(`
`))}}dP(pP,Se);dP(fP,Se);function oN(e){var t={};return pP.forEach(function(r){t[r]=Se[r]}),fP.forEach(function(r){t[r]=Se[r]}),e.trigAngleMultiplier&&(t.trigAngleMultiplier=e.trigAngleMultiplier),e.width&&(t.width=e.width),e.height&&(t.height=e.height),t}var Lu={};ui(Lu,{getFrame:()=>lN});var mP={count:!0,segment:!0,line:!0,ray:!0,circle:!0,arc:!0,glider:!0,parallel:!0,perpendicular:!0,center:!0,radius:!0,area:!0,perimeter:!0,angles:!0,angle:!0,directedangles:!0,directedangle:!0,coterminal:!0,supplement:!0,vertices:!0,segments:!0,intersection:!0,translate:!0,dilate:!0,rotate:!0,reflect:!0,construction:!0,points:!0,lines:!0,circles:!0,arcs:!0,polygons:!0,rays:!0};var yP={segment:!0,triangle:!0,sphere:!0};var gP=["csc","sec","cot","arccsc","arcsec","arccot","csch","sech","coth","arccsch","arcsech","arccoth","mad","cov","covp","distance","midpoint"],hP=["erf","ttest","tscore","ittest","normaldist","tdist","poissondist","binomialdist","pdf","cdf","random","histogram","dotplot","boxplot"],aN=["distance","midpoint"],uN=["det","inv","transpose","rref","trace"],bP=Object.keys(mP).filter(function(e){return e!=="construction"});function Om(e,t){for(var r=0;r<e.length;r++){var n=e[r];if(!t.hasOwnProperty(n))throw new Error("Programming Error: key '"+n+`' does not exist in table. Must be one of:
`+Object.keys(t).join(`
`))}}Om(gP,Se);Om(hP,Se);Om(bP,Se);function lN(e){var t={},r;for(r in Se){if(!Se.hasOwnProperty(r)||e.restrictedFunctions===!0&&gP.indexOf(r)!==-1&&!(e.forceEnableGeometryFunctions===!0&&aN.indexOf(r)!==-1)||e.distributions===!1&&hP.indexOf(r)!==-1)continue;let n=bP.indexOf(r)!==-1,i=r in yP;if(n&&i){if(!(e.isGeometryCalculator||e.is3DCalculator))continue}else if(n){if(!e.isGeometryCalculator)continue}else if(i&&!e.is3DCalculator)continue;uN.indexOf(r)===-1&&(t[r]=Se[r])}return e.trigAngleMultiplier&&(t.trigAngleMultiplier=e.trigAngleMultiplier),e.globalRandomSeed&&(t.globalRandomSeed=e.globalRandomSeed),e.initialEvaluation&&(t.initialEvaluation=e.initialEvaluation),e.globalEventCount&&(t.globalEventCount=e.globalEventCount),e.width&&(t.width=e.width),e.height&&(t.height=e.height),t}var Z1={};ui(Z1,{parse:()=>xi});function xP(e){let t=function(...i){return new e(...i)};t.prototype=e.prototype;var r=Object.getOwnPropertyNames(e);for(var n of r){let i=e[n];if(typeof i=="function")try{t[n]=i}catch(s){}}return t}var S=class extends Ue{constructor(r){super();this.isError=!0;this._msg=r,this.blocksExport=!0}evaluateOnce(r){return this._msg}getError(){return this._msg}setDependencies(r){return this.addDependencies(r),this}setActionValue(r){this.actionValue=r}allowExport(){return this.blocksExport=!1,this}setCursorContext(r){this.cursorContext=r}getCursorContext(){return this.cursorContext}};var bc=class extends rr{constructor(){super(...arguments);this.is_mixed_number=!0}};var xc=class extends lt{};function cN(e){for(var t=1/0,r=0;r<e.length;r++)(e[r].isList||e[r].isBroadcast)&&(t=Math.min(t,e[r].length));return t}var Sm=class extends q{constructor(r){super(r);this.isList=!0;this.length=r.length}asValue(){for(var r=[],n=0;n<this.args.length;n++)r.push(this.args[n].asValue());return r}asCompilerValue(){for(var r=[],n=0;n<this.args.length;n++)r.push(this.args[n].asCompilerValue());return r}getEvaluationInfo(){if(this.args.every(function(r){return r.isConstant}))return[{val:this.args.map(function(r){return r.asValue()})}]}},ys=Sm;ys.eachArgs=function(r,n){var i=cN(r);if(!isFinite(i)){n(r);return}for(var s=0;s<i;s++){for(var o=[],a=0;a<r.length;a++)o.push(r[a].isList||k(r[a].valueType)?r[a].elementAt(s):r[a]);n(o,s)}},ys.wrap=function(r){return r.isList||k(r.valueType)?r:new Sm([r])};var Tc=class extends q{constructor(r){super(r);this.beginning=r[0],this.end=r[1]}isHalfEmpty(){return this.end&&this.end.args&&this.end.args.length===0}};var Ca=class extends q{constructor(r){super(r);this.list=r[0],this.index=r[1]}};var Gs=class extends q{registerDependencies(){if(super.registerDependencies(),this.args[1].type==="Identifier"){var t=this.args[1]._symbol;eo(t)&&this.addDependency("trigAngleMultiplier")}}};var Pc=class extends q{constructor(t){var r=t.map(function(n){return new lt("\\idref_{"+n+"}")});super(r),this._exports.push("construction")}};var Ic=class extends ds{constructor(r,n,i){super(r);this.isTypedConstant=!0;this.isMovablePoint=!0;this.moveStrategy=n,this.defaultDragMode=i,this.valueType=A}asValue(){return[+this.args[0].asValue(),+this.args[1].asValue()]}asTypedValue(){return{valueType:this.valueType,value:this.asValue()}}asCompilerValue(){return[this.args[0].asCompilerValue(),this.args[1].asCompilerValue()]}};var La=class extends q{constructor(r,n){super(n);this.symbol=r}copyWithArgs(r){return new La(this.symbol,r)}};var Mc=class extends q{};var Ec=class extends q{};var fi=class extends q{};var en={"<":{inclusive:!1,direction:-1},"!=":{inclusive:!1,direction:0},">":{inclusive:!1,direction:1},"<=":{inclusive:!0,direction:-1},"=":{inclusive:!0,direction:0},">=":{inclusive:!0,direction:1}};function Yo(e,t){switch(t){case-1:return e?"<=":"<";case 0:return e?"=":"!=";case 1:return e?">=":">";default:throw"Programming error.  Comparators must have a direction of -1, 0, or 1"}}var di=class extends q{constructor(r){super(r);this._difference=en[this.operator].direction===-1?new fi([r[1],r[0]]):new fi([r[0],r[1]])}static create(r){class n extends di{}return n.prototype.operator=r,n}asComparator(){return this}isInequality(){return en[this.operator].direction!==0}};var gs={"<":di.create("<"),">":di.create(">"),"<=":di.create("<="),">=":di.create(">="),"=":di.create("=")};var Oc=class extends Ue{constructor(r){super();let[n,i,s,o,a]=r;this.args=r,this._symbol=s._symbol,this._operators=[i,o],this._expressions=[n,a];var u=Yo(en[i].inclusive&&en[r[3]].inclusive,en[r[1]].direction);this._indicator=new gs[u]([r[0],r[4]]),this.addDependency(this._symbol),this.mergeDependencies(this._expressions[0],this._expressions[1])}isInequality(){return!0}isShadeBetween(){return!0}};var to=class extends q{constructor(r){super(r,{skipRegisterDependencies:!0});this._index=r[0],this.registerDependencies()}registerDependencies(){let r=this._index._symbol;this.addDummyDependency(r),this.mergeDependencies(this.args[1]),this.mergeDependencies(this.args[2]),this.mergeDependenciesInScope([r],this.args[3])}};var Sc=class extends to{constructor(){super(...arguments);this.in_place_operator="+=";this.starting_value=0}evaluateConstant(r){var n=1+Math.round(r[1])-Math.round(r[0]);return n<=0?this.starting_value:n*r[2]}update(r,n){return r+n}};var Nc=class extends to{constructor(){super(...arguments);this.in_place_operator="*=";this.starting_value=1}evaluateConstant(r){var n=1+Math.round(r[1])-Math.round(r[0]);return n<=0?this.starting_value:Math.pow(r[2],n)}update(r,n){return r*n}};var Dc=class extends q{constructor(r){super(r,{skipRegisterDependencies:!0});this._differential=r[0],this.registerDependencies()}registerDependencies(){this.mergeDependencies(this.args[1]),this.mergeDependencies(this.args[2]),this.mergeDependenciesInScope([this._differential._symbol],this.args[3])}};var Ac=class extends q{constructor(t){super(t),this._symbol=t[0]._symbol}};var Rc=class extends q{constructor(r,n,i){super([r,n].concat(i),{skipRegisterDependencies:!0});this._index=r,this._body=n,this._inputLists=i,this.registerDependencies()}registerDependencies(){for(var r=[],n=0;n<this._inputLists.length;n++){var i=this._inputLists[n],s=i._symbol;this.addDummyDependency(s),r.push(s),this.mergeDependencies(i.args[1])}this.addDummyDependency(this._index._symbol),r.push(this._index._symbol),this.mergeDependenciesInScope(r,this._body)}};var wa=class extends Ar{constructor(r,n){super(r,n);this.seed=n[0]}};var Cc=class extends q{registerDependencies(){if(super.registerDependencies(),this.args[0].type==="Identifier"){var t=this.args[0]._symbol;eo(t)&&this.addDependency("trigAngleMultiplier")}}};var Lc=class extends q{registerDependencies(){if(this.addDependency("factorial"),super.registerDependencies(),this.args[0].type==="Identifier"){var t=this.args[0]._symbol;eo(t)&&this.addDependency("trigAngleMultiplier")}}};var wc=class extends q{constructor(r,n){super(n);this.order=r}copyWithArgs(r){return new this.constructor(this.order,r)}};var hs=class extends q{static empty(){return new hs([new rr(!0),new rr(he(1,1)),new rr(NaN)])}};var _c=class extends q{constructor(r,n){super(n);r instanceof lt?this._symbol=r._symbol:this._symbol=new lt(r)._symbol,this.addDependency(this._symbol)}};var Fc=class extends q{constructor(r){super(r,{skipRegisterDependencies:!0});this._symbol=r[0]._symbol,this._expression=r[1],this.registerDependencies()}registerDependencies(){this.addUpdateSymbol(this._symbol),this.mergeDependencies(this._expression)}};var Bc=class extends q{constructor(r,n){super([r].concat(n),{skipRegisterDependencies:!0});this._body=r,this._assignments=n,this.registerDependencies()}registerDependencies(){for(var r=[],n=0;n<this._assignments.length;n++){var i=this._assignments[n],s=i._symbol;this.addSubstitutionSymbol(s),r.push(s);var o=i.args[1];this.mergeDependencies(o),this.addSubstitutionDependencies(o.getDependencies())}this.mergeDependenciesInScope(r,this._body,{isSubstitutionBody:!0})}};var Vc=class extends q{constructor(t){super(t),this._symbol="histogram"}};var Gc=class extends q{constructor(t){super(t),this._symbol="dotplot"}};var zc=class extends q{constructor(t){super(t),this._symbol="boxplot"}};var qc=class extends q{constructor(t){super(t),this._symbol="ttest"}};var kc=class extends q{constructor(t){super(t),this._symbol="ittest"}};var Uc=class extends q{constructor(t){super(t),this._symbol="stats"}};var bs=class extends Ue{constructor(r,n){super();this.mergeDependencies(r,n),this._lhs=r,this._rhs=n,this._difference=new fi([this._lhs,this._rhs])}asComparator(){return new gs["="]([this._lhs,this._rhs])}};var zs=class extends Ue{constructor(r,n){super();r instanceof lt?this._symbol=r._symbol:this._symbol=r,this.mergeDependencies(n),this._expression=n,this._exports=this.computeExports()}shouldExportAns(){return!0}computeExports(){for(var r=this._symbol,n=this.getDependencies(),i=0;i<n.length;i++)if(n[i]===r)return[];return[r]}isEquation(r){return r.getDependencies().indexOf(this._symbol)!==-1}asEquation(){var r=new bs(new lt(this._symbol),this._expression);return r.userData=this.userData,r.metaData=this.metaData,r}shouldPromoteToSlider(r){if(!this._expression.isConstant||this._expression.is_mixed_number)return!1;let n=this._expression.asValue();return typeof n!="number"||!isFinite(n)?!1:r.isValidSlider(this._symbol)}};var Hc=class extends Ue{constructor(r,n){super();this._symbols=r.args.map(i=>i._symbol),this._expression=n,this._concatenatedSymbol=this._symbols.join(""),this.mergeDependencies(n)}asEquation(){let r=new bs(new ds(this._symbols.map(n=>new lt(n))),this._expression);return r.userData=this.userData,r.metaData=this.metaData,r}};var nr={};ui(nr,{actionMergeFreeVariable:()=>fy,addArgumentsToDefinition:()=>Uu,addTypeError:()=>Am,adjacentNumbers:()=>Dy,andTypeError:()=>zm,ansUndefined:()=>Hg,assignmentsUnsupported:()=>Zu,badImplicitCall:()=>ap,badIntegralBoundDependency:()=>qg,badListComprehensionInputDependency:()=>Zg,badLogExponent:()=>Xy,badProductBoundDependency:()=>Rg,badSampleSize:()=>Ug,badSumBoundDependency:()=>Ag,badSymbolContext:()=>Wu,badTrigExponent:()=>Wy,badTupleDimensions:()=>Ny,binaryOperatorMissingOperand:()=>qu,blankExpression:()=>Qy,boxplotBreadthInvalid:()=>Py,boxplotOffsetInvalid:()=>Ty,cannotRedefine:()=>Ga,cannotSubscript:()=>Ky,cdfMaxInvalid:()=>pg,cdfMaxLessThanMin:()=>fg,cdfMinInvalid:()=>cg,cdfRequiresArguments:()=>Iy,cdfTooManyArguments:()=>My,clickableObjectAlreadyAssigned:()=>xN,clickableObjectAssignmentNotDefined:()=>bN,clickableObjectAssignmentNotIdentifier:()=>TN,clickableObjectInvalidExpression:()=>PN,colonMissingCondition:()=>Jy,colorArity:()=>sp,combineTypeError:()=>Bu,comparatorTypeError:()=>Gm,complicatedDoubleInequality:()=>xp,complicatedPolarImplicit:()=>bg,constantUnsupported:()=>Ko,cycle:()=>mp,deeplyNested:()=>gy,derivativeMissingBody:()=>Vg,derivativeTypeError:()=>ey,derivativeVariableTypeError:()=>ty,differentialWithSuperscript:()=>wg,distributionAsFunction:()=>Ip,divideTypeError:()=>Fm,domainMaxInvalid:()=>gp,domainMaxLessThanMin:()=>lg,domainMinInvalid:()=>yp,dotLHSTypeError:()=>Hm,duplicateUpdateRules:()=>ly,emptyParen:()=>Hy,emptyPipe:()=>Yy,emptyRadical:()=>ky,emptyRadicalIndex:()=>Uy,emptySquareBracket:()=>$y,emptySubscript:()=>up,emptySuperscript:()=>By,equationRequired:()=>Tp,equationsUnsupported:()=>qs,eventHandlerTypeError:()=>_u,exponentTypeError:()=>Bm,featureUnavailable:()=>na,fractionEmpty:()=>Fy,fractionMissingDenominator:()=>_y,fractionMissingNumerator:()=>wy,fractionsUnavailable:()=>Op,functionDefinitionsUnsupported:()=>ju,functionFreeVariable:()=>dN,functionNotDefined:()=>fp,functionTypeError:()=>Vt,functionUnsupported:()=>Hn,geometryLengthTypeError:()=>Xc,gpuLongProduct:()=>by,gpuLongSum:()=>hy,gpuMaxListSize:()=>Ba,gpuUnsupportedFunction:()=>Gu,gpuUnsupportedIntegral:()=>tp,gpuVariableListLength:()=>Zo,gpuVariableProduct:()=>ep,gpuVariableSum:()=>Kc,heterogeneousList:()=>Fu,identifierAsFunction:()=>Ry,illegalBinWidth:()=>Yu,illegalDotCall:()=>wu,implicitsDisabled:()=>hg,incorrectProductLowerBound:()=>Dg,incorrectSumLowerBound:()=>Ng,indexTypeError:()=>Fa,inequalitiesDisabled:()=>hp,inequalitiesUnsupported:()=>ea,inequalityChainTooLong:()=>pp,integralArgumentTypeError:()=>Km,integralLowerBoundTypeError:()=>Jm,integralMissingBody:()=>Bg,integralMissingBound:()=>Cg,integralMissingDifferential:()=>Lg,integralUpperBoundTypeError:()=>Qm,invalidDependentFirstTableColumn:()=>fN,invalidDoubleInequalityVariables:()=>bp,invalidFirstTableColumn:()=>Pg,invalidHalfEmptyRange:()=>vg,invalidImplicitVariables:()=>Qo,invalidInequalityVariables:()=>yg,invalidLHS:()=>dg,invalidOperatorName:()=>Gy,invalidRegressionParameter:()=>Ig,invalidSubscript:()=>Vy,invalidTableEntry:()=>qa,invalidTableHeader:()=>Tg,listComprehensionIncorrectInput:()=>Wg,listComprehensionInputListTypeError:()=>Yg,listTypeError:()=>Xo,logScaleBoxPlot:()=>yy,logScaleDotPlot:()=>my,logScaleHistogram:()=>dy,logScaleTypeError:()=>Vu,logbaseUnsupported:()=>$g,malformedList:()=>Sy,malformedPoint:()=>Oy,matrixAddDimensions:()=>MN,matrixAssignment:()=>IN,matrixElementTypeError:()=>NN,matrixFractionalPower:()=>ON,matrixInvalidVariable:()=>DN,matrixMultiplyDimensions:()=>vN,matrixPowerDimensions:()=>SN,matrixSubtractDimensions:()=>EN,maxListSize:()=>zu,methodRequiresList:()=>mi,mismatchedBraces:()=>Gg,mismatchedDoubleInequality:()=>xg,multiplyDefined:()=>za,multiplyDefinedByTables:()=>eg,multiplyTypeError:()=>Cm,multiplyTypeError2D:()=>wm,multiplyTypeError3D:()=>_m,multiplyTypeErrorCross:()=>Lm,negativeTypeError:()=>Vm,nonArithmeticRange:()=>$u,nonListDoubleReducer:()=>Hu,nonListParameterizedReducer:()=>Eg,nonSquareDeterminant:()=>mN,nonSquareInverse:()=>gN,nonSquareTrace:()=>yN,optimizationError:()=>Mg,orderedPairAccessTypeError:()=>km,parameterAlreadyDefined:()=>dp,parseError:()=>Ce,pdfWrongArity:()=>np,percentMissingOf:()=>kg,piecewiseBranchTypeError:()=>ny,piecewiseConditionTypeError:()=>ry,piecewiseMissingCondition:()=>Zy,piecewisePartMissingCondition:()=>jy,pointTypeError:()=>qm,pointsUnsupported:()=>ra,polygonTwoNumbersError:()=>xy,primeWithoutParen:()=>cp,primedFunctionArity:()=>Jo,productArgumentTypeError:()=>jm,productInfiniteBoundError:()=>jc,productLowerBoundTypeError:()=>Xm,productMissingBody:()=>Fg,productMissingBound:()=>Sg,productUpperBoundTypeError:()=>Zm,randomArity:()=>jo,randomFromBroadcastDistribution:()=>Ey,regressionTypeError:()=>oy,regressionsUnsupported:()=>ta,selfReferentialFunction:()=>ku,shadowedIndex:()=>tg,shadowedIntegrationVariable:()=>zg,shadowedListComprehensionInput:()=>Xg,singleVariableImplicitEquationsDisabled:()=>gg,singularInverse:()=>hN,sliderLimitReferencesExport:()=>ig,sliderMaxInvalid:()=>og,sliderMaxLessThanMin:()=>ag,sliderMinInvalid:()=>sg,sliderStepInvalid:()=>ug,substitutionAmbiguousComma:()=>Qu,substitutionBodyAction:()=>RN,substitutionBodyDependsOnLocalVariable:()=>rh,substitutionBodyDependsOnRegression:()=>eh,substitutionDuplicateSymbol:()=>nh,substitutionFunctionLHS:()=>Ap,substitutionIllegalLHS:()=>Dp,substitutionInvalidAssignments:()=>Kg,substitutionLocalLHS:()=>Np,substitutionNested:()=>Rp,substitutionTypeError:()=>AN,substitutionUndefinedRHS:()=>th,subtractTypeError:()=>Rm,sumArgumentTypeError:()=>Wm,sumInfiniteBoundError:()=>Zc,sumLowerBoundTypeError:()=>$m,sumMissingBody:()=>_g,sumMissingBound:()=>Og,sumUpperBoundTypeError:()=>Ym,superscriptWithPrime:()=>qy,tableCycleWithoutGlobalDefinition:()=>rg,tableEntryTypeError:()=>sy,tableHeaderTypeError:()=>iy,tdistWrongArity:()=>ip,tickerMinStepNonNegativeNumber:()=>ng,todoError:()=>pN,tokenWithSubscript:()=>Ay,tooManyArguments:()=>rp,tooManyVariables:()=>Ct,transformationDefinitionTypeError:()=>Wc,transformationTypeError:()=>Um,ttestListTooShort:()=>ka,unaryOperatorMissingLeft:()=>Cy,unaryOperatorMissingRight:()=>Ly,unexpectedForKeyword:()=>Sp,unexpectedInequality:()=>Dm,unexpectedPrime:()=>lp,unexpectedSubscript:()=>zy,unexpectedSymbol:()=>dn,unplottablePolarFunction:()=>mg,unrecognizedSymbol:()=>Yc,updateRuleFunctionLHS:()=>Jc,updateRuleIllegalLHS:()=>py,updateRuleLocalLHS:()=>Qc,updateRuleNonIdentifierLHS:()=>uy,updateRuleTypeError:()=>ay,updateRuleUndefinedLHS:()=>cy,variableAsFunction:()=>Pp,variableLengthDistributionList:()=>Ju,variableLengthProductBodyDependsOnIndex:()=>Qg,variableLengthSumBodyDependsOnIndex:()=>Jg,variableLengthTopLevelList:()=>jg,variableSeed:()=>Mp,variableUnsupported:()=>vp,variablesUnsupported:()=>Xu,writeIntegral:()=>Ep,wrongArity:()=>mn,wrongDoubleReducerArity:()=>Va,wrongParameterizedReducerArity:()=>op,zeroArgReducer:()=>vy});function Ce(){return new S(M("shared-calculator-error-parse-error"))}function pN(e){return new S(M("shared-calculator-error-todo-error",{msg:e}))}function Yc(e){return e=Y(e),new S(M("shared-calculator-error-unrecognized-symbol",{symbol:e}))}function Dm(){return new S(M("shared-calculator-error-unexpected-inequality"))}function dn(e){return e=Y(e),new S(M("shared-calculator-error-unexpected-symbol",{symbol:e}))}function Am(e){return new S(M("shared-calculator-error-add-type-error",{symbol1:e[0],symbol2:e[1]})).allowExport()}function Rm(e){return new S(M("shared-calculator-error-subtract-type-error",{symbol1:e[0],symbol2:e[1]})).allowExport()}function Cm(e){return new S(M("shared-calculator-error-multiply-type-error",{symbol1:e[0],symbol2:e[1]})).allowExport()}function Lm(e){return new S(M("shared-calculator-error-multiply-type-error-cross",{symbol1:e[0],symbol2:e[1]})).allowExport()}function wm(e){return new S(M("shared-calculator-error-multiply-type-error-2d",{symbol1:e[0],symbol2:e[1]})).allowExport()}function _m(e){return new S(M("shared-calculator-error-multiply-type-error-3d",{symbol1:e[0],symbol2:e[1]})).allowExport()}function Fm(e){return new S(M("shared-calculator-error-divide-type-error",{symbol1:e[0],symbol2:e[1]})).allowExport()}function Bm(e){return new S(M("shared-calculator-error-exponent-type-error",{symbol1:e[0],symbol2:e[1]})).allowExport()}function Vm(e){return new S(M("shared-calculator-error-negative-type-error",{symbol:e[0]})).allowExport()}function Gm(e){return new S(M("shared-calculator-error-comparator-type-error",{symbol1:e[0],symbol2:e[1]})).allowExport()}function zm(e){return new S(M("shared-calculator-error-and-type-error",{symbol:"and",symbol1:e[0],symbol2:e[1]})).allowExport()}function Xo(e){return new S(M("shared-calculator-error-list-type-error",{symbol1:e[0]})).allowExport()}function qm(e){return new S(M("shared-calculator-error-point-type-error",{symbol1:e,symbol2:te(A)})).allowExport()}function Fa(e){return new S(M("shared-calculator-error-index-type-error",{symbol1:e[0],symbol2:e[1]})).allowExport()}function km(e){return new S(M("shared-calculator-error-ordered-pair-access-type-error",{symbol:e[0]})).allowExport()}function Vt(e,t){switch(t.length){case 1:return new S(M("shared-calculator-error-function-type-error-1",{fn:Y(e),arg:t[0]})).allowExport();case 2:return new S(M("shared-calculator-error-function-type-error-2",{fn:Y(e),arg1:t[0],arg2:t[1]})).allowExport();default:return new S(M("shared-calculator-error-function-type-error-many",{fn:Y(e)})).allowExport()}}var Nm={translate:"translation",rotate:"rotation",dilate:"dilation",reflect:"reflection"};function Wc(e,t,r){let n=[],i=r[0];if(!Array.isArray(i))return Vt(e,t);for(let o=1;o<i.length;o++){let a=i[o];typeof a=="number"?n.push(te(a)):n.push(te(a.types[0]))}let s="";switch(n.length){case 1:s=M("shared-calculator-error-transformation-definition-expected-types-1",{arg:n[0]});break;case 2:s=M("shared-calculator-error-transformation-definition-expected-types-2",{arg1:n[0],arg2:n[1]});break}switch(t.length){case 1:return new S(M("shared-calculator-error-transformation-definition-type-error-1",{fn:Y(Nm[e]),arg:t[0],expectedTypeMessage:s}));case 2:return new S(M("shared-calculator-error-transformation-definition-type-error-2",{fn:Y(Nm[e]),arg1:t[0],arg2:t[1],expectedTypeMessage:s}));default:return new S(M("shared-calculator-error-transformation-definition-type-error-many",{fn:Y(Nm[e])}))}}function Um(e,t){switch(t.length){case 1:return new S(M("shared-calculator-error-transformation-type-error-1",{fn:Y(e),arg:t[0]})).allowExport();case 2:return new S(M("shared-calculator-error-transformation-type-error-2",{fn:Y(e),arg1:t[0],arg2:t[1]})).allowExport();default:return new S(M("shared-calculator-error-transformation-type-error-many",{fn:Y(e)})).allowExport()}}function Xc(e,t){let r=Y(e),n=Y("count");return new S(M("shared-calculator-error-geometry-length-type-error",{fn:r,alternativeFn:n,arg:t})).allowExport()}function wu(e){return new S(M("shared-calculator-error-illegal-dot-call",{symbol:Y(e)}))}function Hm(e,t){return new S(M("shared-calculator-error-dot-lhs-type-error",{symbol:Y(e),type:t})).allowExport()}function $m(e){return new S(M("shared-calculator-error-sum-lower-bound-type-error",{symbol:e[0]})).allowExport()}function Ym(e){return new S(M("shared-calculator-error-sum-upper-bound-type-error",{symbol:e[0]})).allowExport()}function Zc(){return new S(M("shared-calculator-error-sum-infinite-bound-type-error"))}function Wm(e){return new S(M("shared-calculator-error-sum-argument-type-error",{symbol:e[0]})).allowExport()}function Xm(e){return new S(M("shared-calculator-error-product-lower-bound-type-error",{symbol:e[0]})).allowExport()}function Zm(e){return new S(M("shared-calculator-error-product-upper-bound-type-error",{symbol:e[0]})).allowExport()}function jc(){return new S(M("shared-calculator-error-product-infinite-bound-type-error"))}function jm(e){return new S(M("shared-calculator-error-product-argument-type-error",{symbol:e[0]})).allowExport()}function Jm(e){return new S(M("shared-calculator-error-integral-lower-bound-type-error",{symbol:e[0]})).allowExport()}function Qm(e){return new S(M("shared-calculator-error-integral-upper-bound-type-error",{symbol:e[0]})).allowExport()}function Km(e){return new S(M("shared-calculator-error-integral-argument-type-error",{symbol:e[0]})).allowExport()}function ey(e){return new S(M("shared-calculator-error-derivative-type-error",{symbol:e[0]})).allowExport()}function ty(e,t){return new S(M("shared-calculator-error-derivative-variable-type-error",{symbol1:Y(e),symbol2:t[0]}))}function ry(e){return new S(M("shared-calculator-error-piecewise-condition-type-error",{symbol1:te(Ie),symbol2:e[0]})).allowExport()}function ny(e){return new S(M("shared-calculator-error-piecewise-branch-type-error",{symbol1:e[0],symbol2:e[1]})).allowExport()}function iy(e){return new S(M("shared-calculator-error-table-header-type-error",{symbol:e[0]}))}function sy(e){return new S(M("shared-calculator-error-table-entry-type-error",{symbol:e[0]}))}function oy(e){return new S(M("shared-calculator-error-regression-type-error",{symbol1:e[0],symbol2:e[1]}))}function ay(e){return new S(M("shared-calculator-error-update-rule-type-error",{symbol:e}))}function uy(){return new S(M("shared-calculator-error-update-rule-non-identifier-lhs",{arrow:"\u2192",example:"a"}))}function ly(e){return new S(M("shared-calculator-error-duplicate-update-rules",{symbol:Y(e)}))}function cy(e){return new S(M("shared-calculator-error-update-rule-undefined-lhs",{symbol:Y(e)}))}function py(e){return new S(M("shared-calculator-error-update-rule-illegal-lhs",{symbol:Y(e)}))}function Jc(e){return new S(M("shared-calculator-error-update-rule-function-lhs",{symbol:Y(e)}))}function Qc(e){return new S(M("shared-calculator-error-update-rule-local-lhs",{symbol:Y(e)}))}function fy(e){let t=e.filter(r=>r.scope==="free").map(r=>r.symbol);return new S(M("shared-calculator-error-action-merge-free-variable",{symbol:Y(t[0]||"")})).setDependencies(t).allowExport()}function _u(e){return new S(M("shared-calculator-error-event-handler-type-error",{example:"a\u2192a+1"}))}function Fu(){return new S(M("shared-calculator-error-heterogeneous-list")).allowExport()}function Bu(e){return new S(M("shared-calculator-error-combine-type-error",{symbol1:e[0],symbol2:e[1]})).allowExport()}function Vu(e){return new S(M("shared-calculator-error-log-scale-type-error",{symbol:e})).allowExport()}function dy(){return new S(M("shared-calculator-error-log-scale-histogram"))}function my(){return new S(M("shared-calculator-error-log-scale-dot-plot"))}function yy(){return new S(M("shared-calculator-error-log-scale-box-plot"))}function gy(){return new S(M("shared-calculator-error-deeply-nested")).allowExport()}function Zo(e){return new S(M("shared-calculator-error-gpu-variable-list-length",{symbol:Y(e.filter(t=>t.symbol!=="globalRandomSeed")[0].symbol)}))}function Kc(e){return new S(M("shared-calculator-error-gpu-variable-sum",{symbol:Y(e[0].symbol)}))}function ep(e){return new S(M("shared-calculator-error-gpu-variable-product",{symbol:Y(e[0].symbol)}))}function Gu(e){return new S(M("shared-calculator-error-gpu-function-unsupported",{symbol:Y(e)}))}function tp(){return new S(M("shared-calculator-error-gpu-integral-unsupported"))}function hy(){return new S(M("shared-calculator-error-gpu-long-sum",{maxTermCount:1e3 .toLocaleString()}))}function by(){return new S(M("shared-calculator-error-gpu-long-product",{maxTermCount:1e3 .toLocaleString()}))}function Ba(){return new S(M("shared-calculator-error-gpu-max-list-size",{maxListSize:100 .toLocaleString()}))}function zu(){return new S(M("shared-calculator-error-max-list-size",{maxListSize:1e4 .toLocaleString()})).allowExport()}function xy(){return new S(M("shared-calculator-error-two-numbers-error"))}function Ty(){return new S(M("shared-calculator-error-boxplot-offset-invalid"))}function Py(){return new S(M("shared-calculator-error-boxplot-breadth-invalid"))}function rp(e,t){return new S(M("shared-calculator-error-too-many-arguments",{symbol:e,max:t}))}function np(){var e=M("shared-calculator-error-pdf-wrong-arity-recommendation"),t=M("shared-calculator-error-pdf-wrong-arity",{recommendation:e});return new S(t)}function Iy(){var e=M("shared-calculator-error-cdf-wrong-arity-recommendation"),t=M("shared-calculator-error-cdf-wrong-arity",{recommendation:e});return new S(t)}function My(){var e=M("shared-calculator-error-cdf-too-many-arguments-recommendation"),t=M("shared-calculator-error-cdf-too-many-arguments",{recommendation:e});return new S(t)}function ip(){return new S(M("shared-calculator-error-tdist-wrong-arity"))}function jo(){return new S(M("shared-calculator-error-random-arity"))}function Ey(){return new S(M("shared-calculator-error-random-from-broadcast-distribution"))}function sp(e){var t=e==="rgb"?[150,30,100]:[180,.5,.5],r=M("shared-calculator-error-color-arity-recommendation",{recommendation:Y(e)+"("+t.join(", ")+")"}),n=M("shared-calculator-error-color-arity",{symbol:e,recommendation:r});return new S(n)}function mn(e,t,r,n){e=Y(e);var i,s;if(t===1)n||(n=e+"(x)"),s=M("shared-calculator-error-wrong-arity-supplement",{recommendation:n}),r>1?i=M("shared-calculator-error-wrong-arity-single-arg-too-many",{dependency:e,supplement:s}):i=M("shared-calculator-error-wrong-arity-single-arg-too-few",{dependency:e,supplement:s});else{var o=[];if(!n){for(var a=0;a<t;a++)o[a]=a+1;n=Y(e)+"("+o.join(", ")+")"}s=M("shared-calculator-error-wrong-arity-supplement",{recommendation:n}),i=M("shared-calculator-error-wrong-arity-many-arg",{dependency:e,assignment_arity:t,supplement:s})}return new S(i)}function op(e){return new S(M("shared-calculator-error-wrong-two-arg-arity",{symbol:Y(e),recommendation:Y(e)+"([1,2,3], 1)"}))}function Va(e){return new S(M("shared-calculator-error-wrong-two-arg-arity",{symbol:Y(e),recommendation:Y(e)+"([1,2,3], [3,2,1])"}))}function Jo(){return new S(M("shared-calculator-error-primed-function-arity"))}function vy(e){return new S(M("shared-calculator-error-zero-arg-reducer",{symbol:Y(e)}))}function Oy(){return new S(M("shared-calculator-error-malformed-point"))}function Sy(){return new S(M("shared-calculator-error-malformed-list"))}function Ny(e){return new S(M("shared-calculator-error-bad-tuple-dimensions",{symbol:e}))}function ap(e){return e=Y(e),new S(M("shared-calculator-error-bad-implicit-call",{symbol:e}))}function Dy(e,t){return new S(M("shared-calculator-error-adjacent-numbers",{left:e,right:t}))}function Ay(){return new S(M("shared-calculator-error-token-with-subscript"))}function Ry(e){return e=Y(e),new S(M("shared-calculator-error-identifier-as-function",{symbol:e}))}function qu(e){return e=Y(e),e==="%"&&(e="% of"),new S(M("shared-calculator-error-binary-operator-missing-operand",{symbol:e}))}function Cy(e){return e=Y(e),new S(M("shared-calculator-error-unary-operator-missing-left",{symbol:e}))}function Ly(e){return e=Y(e),new S(M("shared-calculator-error-unary-operator-missing-right",{symbol:e}))}function wy(){return new S(M("shared-calculator-error-fraction-missing-numerator"))}function _y(){return new S(M("shared-calculator-error-fraction-missing-denominator"))}function Fy(){return new S(M("shared-calculator-error-fraction-empty"))}function up(){return new S(M("shared-calculator-error-empty-subscript"))}function By(){return new S(M("shared-calculator-error-empty-superscript"))}function Vy(e){return e=Y(e),new S(M("shared-calculator-error-invalid-subscript",{symbol:e}))}function Gy(){return new S(M("shared-calculator-error-invalid-operator-name"))}function zy(){return new S(M("shared-calculator-error-unexpected-subscript"))}function qy(){return new S(M("shared-calculator-error-superscript-with-prime"))}function lp(){return new S(M("shared-calculator-error-unexpected-prime"))}function cp(){return new S(M("shared-calculator-error-prime-without-paren"))}function ky(){return new S(M("shared-calculator-error-empty-radical"))}function Uy(){return new S(M("shared-calculator-error-empty-radical-index"))}function Hy(){return new S(M("shared-calculator-error-empty-paren"))}function $y(){return new S(M("shared-calculator-error-empty-square-bracket"))}function Yy(){return new S(M("shared-calculator-error-empty-pipe"))}function Wy(e){var t=e+"^2",r=e+"^-1";return new S(M("shared-calculator-error-bad-trig-exponent",{form1:t,form2:r}))}function Xy(e){var t=e+"^2";return new S(M("shared-calculator-error-bad-log-exponent",{form:t}))}function pp(){return new S(M("shared-calculator-error-inequality-chain-too-long"))}function Zy(){return new S(M("shared-calculator-error-piecewise-missing-condition"))}function jy(){return new S(M("shared-calculator-error-piecewise-part-missing-condition"))}function Jy(){return new S(M("shared-calculator-error-colon-missing-condition"))}function Qy(){return new S(M("shared-calculator-error-blank-expression"))}function fp(e){return e=Y(e),new S(M("shared-calculator-error-function-not-defined",{dependency:e}))}function dp(e){return e=Y(e),new S(M("shared-calculator-error-parameter-already-defined",{dependency:e}))}function Ga(e,t){return e=Y(e),t===void 0?new S(M("shared-calculator-error-cannot-redefine",{symbol:e})):new S(M("shared-calculator-error-cannot-redefine-root",{symbol:e,symbolRoot:t}))}function Ky(e){return e=Y(e),new S(M("shared-calculator-error-cannot-subscript",{symbol:e}))}function za(e){return e=Y(e),new S(M("shared-calculator-error-multiply-defined",{dependency:e}))}function eg(e){let t=za(e);return t.isMultiplyDefinedByTables=!0,t}function tg(e){return e=Y(e),new S(M("shared-calculator-error-shadowed-index",{symbol:e}))}function mp(e){e=e.map(Y);var t=e.pop()||"";return new S(M("shared-calculator-error-dependency-cycle",{symbols:e.join("', '"),lastSymbol:t}))}function rg(e){let t=mp(e);return t.isTableCycleWithoutGlobalDefinition=!0,t}function ku(e){return new S(M("shared-calculator-error-self-referential-function",{symbol:Y(e)}))}function ng(){return new S(M("shared-calculator-error-ticker-min-step-nonnegative"))}function ig(e){return new S(M("shared-calculator-error-slider-limit-references-export",{symbol:Y(e)}))}function sg(){return new S(M("shared-calculator-error-slider-min-invalid"))}function og(){return new S(M("shared-calculator-error-slider-max-invalid"))}function ag(){return new S(M("shared-calculator-error-slider-max-less-than-min"))}function ug(){return new S(M("shared-calculator-error-slider-step-invalid"))}function yp(){return new S(M("shared-calculator-error-domain-min-invalid"))}function gp(){return new S(M("shared-calculator-error-domain-max-invalid"))}function lg(){return new S(M("shared-calculator-error-domain-max-less-than-min"))}function cg(){return new S(M("shared-calculator-error-cdf-min-invalid"))}function pg(){return new S(M("shared-calculator-error-cdf-max-invalid"))}function fg(){return new S(M("shared-calculator-error-cdf-max-less-than-min"))}function Ct(e){if(e=e.map(Y),e.length===0)return new S(M("shared-calculator-error-too-many-variables-no-symbols"));var t=e.pop()||"";return e.length>0?new S(M("shared-calculator-error-too-many-variables-many-symbols",{variables:e.join("', '"),lastVariable:t})):new S(M("shared-calculator-error-too-many-variables-one-symbol",{variable:t}))}function Uu(e,t,r){e=e.map(Y),t=Y(t),r=r.map(Y);var n=t+"("+r.join(",")+","+e.join(",")+")",i=e.pop()||"",s={symbols:e.join("', '"),lastSymbol:i,newSignature:n};return e.length?new S(M("shared-calculator-error-add-arguments-to-definition-many",s)):new S(M("shared-calculator-error-add-arguments-to-definition-one",s))}function dg(e){return e=Y(e),new S(M("shared-calculator-error-invalid-lhs",{symbol:e}))}function mg(){return new S(M("shared-calculator-error-unplottable-polar-function"))}function yg(){return new S(M("shared-calculator-error-invalid-inequality-variables"))}function Qo(){return new S(M("shared-calculator-error-invalid-implicit-variables"))}function gg(){return new S(M("shared-calculator-error-single-variable-implicit-equations-disabled"))}function hg(){return new S(M("shared-calculator-error-implicits-disabled"))}function hp(){return new S(M("shared-calculator-error-inequalities-disabled"))}function bg(){return new S(M("shared-calculator-error-complicated-polar-implicit"))}function bp(){return new S(M("shared-calculator-error-invalid-double-inequality-variables"))}function xg(){return new S(M("shared-calculator-error-mismatched-double-inequality",{example:"1 < y < 2"}))}function xp(){return new S(M("shared-calculator-error-complicated-double-inequality"))}function Tp(e){return e?(e=Y(e),new S(M("shared-calculator-error-equation-required-symbol",{lhs:e+"="}))):new S(M("shared-calculator-error-equation-required"))}function Pp(e){return e=Y(e),new S(M("shared-calculator-error-variable-as-function",{dependency:e}))}function Ip(e){return e=Y(e),new S(M("shared-calculator-error-distribution-as-function",{symbol:e}))}function Tg(e){return new S(M("shared-calculator-error-invalid-table-header",{supplement:e}))}function qa(e){return new S(M("shared-calculator-error-invalid-table-entry",{supplement:e}))}function Pg(){return new S(M("shared-calculator-error-invalid-first-table-column",{most:"'y', 'r',",last:"'\u03B8'"}))}function fN(){return new S(M("shared-calculator-error-invalid-dependent-first-table-column"))}function Ig(e){return new S(M("shared-calculator-error-invalid-regression-parameter",{symbol:Y(e)}))}function Mg(){return new S(M("shared-calculator-error-optimization-error"))}function Hu(e){return new S(M("shared-calculator-error-non-list-double-reducer",{symbol:Y(e),recommendation:Y(e)+"([1,2,3], [3,2,1])"})).allowExport()}function Eg(e){return new S(M("shared-calculator-error-non-list-parameterized-reducer",{symbol:Y(e),recommendation:Y(e)+"([1,2,3], 1)"})).allowExport()}function mi(e){return new S(M("shared-calculator-error-method-requires-list",{symbol:Y(e),recommendation:Y(e)+"([1,2,3])"})).allowExport()}function dN(e,t){return new S(M("shared-calculator-error-variable-function-free-variable",{functionSymbol:e,variableSymbol:t})).allowExport()}function $u(){return new S(M("shared-calculator-error-non-arithmetic-range")).allowExport()}function vg(){return new S(M("shared-calculator-error-invalid-half-empty-range"))}function Og(){return new S(M("shared-calculator-error-sum-missing-bound"))}function Sg(){return new S(M("shared-calculator-error-product-missing-bound"))}function Ng(){return new S(M("shared-calculator-error-incorrect-sum-lower-bound"))}function Dg(){return new S(M("shared-calculator-error-incorrect-product-lower-bound"))}function Ag(e){return new S(M("shared-calculator-error-bad-sum-bound-dependency",{symbol:Y(e)}))}function Rg(e){return new S(M("shared-calculator-error-bad-product-bound-dependency",{symbol:Y(e)}))}function Cg(){return new S(M("shared-calculator-error-integral-missing-bound"))}function Lg(){return new S(M("shared-calculator-error-integral-missing-differential"))}function wg(){return new S(M("shared-calculator-error-differential-with-superscript"))}function _g(){return new S(M("shared-calculator-error-sum-missing-body"))}function Fg(){return new S(M("shared-calculator-error-product-missing-body"))}function Bg(){return new S(M("shared-calculator-error-integral-missing-body"))}function Vg(){return new S(M("shared-calculator-error-derivative-missing-body"))}function Gg(e,t){return e=Y(e),t=Y(t),new S(M("shared-calculator-error-mismatched-braces",{symbol1:e,symbol2:t}))}function zg(e){return new S(M("shared-calculator-error-shadowed-integration-variable",{symbol:Y(e)}))}function qg(e){return new S(M("shared-calculator-error-bad-integral-bound-dependency",{symbol:Y(e)}))}function kg(){return new S(M("shared-calculator-error-percent-missing-of"))}function Yu(e){return e=Y(e),new S(M("shared-calculator-error-illegal-bin-width",{symbol:e}))}function ka(e){return e=Y(e),new S(M("shared-calculator-error-ttest-list-too-short",{symbol:e}))}function Ug(){return new S(M("shared-calculator-error-bad-sample-size"))}function Mp(e){return new S(M("shared-calculator-error-variable-seed",{symbol:Y(e[0].symbol)})).setDependencies(e.filter(t=>t.scope==="free").map(t=>t.symbol)).allowExport()}function Wu(e){return new S(M("shared-calculator-error-bad-symbol-context",{symbol:Y(e)}))}function Ep(){return new S(M("shared-calculator-error-write-integral",{command:"integral",symbol:"\u222B"}))}function Hg(){return new S(M("shared-calculator-error-ans-undefined"))}function Xu(e){return new S(M("shared-calculator-error-variables-unsupported",{variable:Y(e)}))}function Hn(e){return new S(M("shared-calculator-error-function-unsupported",{symbol:Y(e)}))}function $g(){return new S(M("shared-calculator-error-logbase-unsupported"))}function Ko(e){return new S(M("shared-calculator-error-constant-unsupported",{symbol:Y(e)}))}function vp(e){return new S(M("shared-calculator-error-variable-unsupported",{symbol:Y(e)}))}function Zu(){return new S(M("shared-calculator-error-assignments-unsupported"))}function ju(){return new S(M("shared-calculator-error-function-definition-unsupported"))}function qs(){return new S(M("shared-calculator-error-equations-unsupported"))}function ea(){return new S(M("shared-calculator-error-inequalities-unsupported"))}function ta(){return new S(M("shared-calculator-error-regressions-unsupported"))}function ra(){return new S(M("shared-calculator-error-points-unsupported"))}function na(){return new S(M("shared-calculator-error-feature-unavailable"))}function Op(){return new S(M("basic-calculator-error-fractions-unavailable"))}function mN(){return new S(M("shared-calculator-error-non-square-determinant"))}function yN(){return new S(M("shared-calculator-error-non-square-trace"))}function gN(){return new S(M("shared-calculator-error-non-square-inverse"))}function hN(){return new S(M("shared-calculator-error-non-singular-inverse"))}function bN(e){return new S(M("shared-calculator-error-clickable-object-assignment-not-defined",{symbol:e}))}function xN(e){return new S(M("shared-calculator-error-multiply-defined",{dependency:e}))}function TN(){return new S(M("shared-calculator-error-clickable-object-assignment-not-identifier"))}function PN(){return new S(M("shared-calculator-error-clickable-object-invalid-expression"))}function IN(){return new S(M("shared-calculator-error-matrix-assignment"))}function MN(){return new S(M("shared-calculator-error-matrix-add-dimensions"))}function EN(){return new S(M("shared-calculator-error-matrix-subtract-dimensions"))}function vN(){return new S(M("shared-calculator-error-matrix-multiply-dimensions"))}function ON(){return new S(M("shared-calculator-error-matrix-fractional-power"))}function SN(){return new S(M("shared-calculator-error-matrix-power-dimensions"))}function NN(e){return new S(M("shared-calculator-error-matrix-element-type-error",{arg:e[0]}))}function DN(e){return new S(M("shared-calculator-error-matrix-invalid-variable",{symbol:Y(e)}))}function Yg(e,t){return new S(M("shared-calculator-error-list-comprehension-input-type-error",{identifier:e,actual:t}))}function Wg(){return new S(M("shared-calculator-error-incorrect-list-comprehension-input"))}function Sp(){return new S(M("shared-calculator-error-unexpected-for-keyword"))}function Xg(e){return e=Y(e),new S(M("shared-calculator-error-shadowed-list-comprehension-input",{symbol:e}))}function Zg(e){return e=Y(e),new S(M("shared-calculator-error-bad-list-comprehension-input-dependency",{symbol:e}))}function jg(e){let t=e.filter(r=>r.scope==="free").map(r=>r.symbol);return new S(M("shared-calculator-error-variable-length-top-level-list",{symbol:Y(t[0]||"")})).setDependencies(t).allowExport()}function Ju(e){return new S(M("shared-calculator-error-variable-length-distribution-list",{symbol:e[0].symbol})).setDependencies(e.filter(t=>t.scope==="free").map(t=>t.symbol))}function Jg(e){return new S(M("shared-calculator-error-variable-length-sum-body-depends-on-index",{symbol:e}))}function Qg(e){return new S(M("shared-calculator-error-variable-length-product-body-depends-on-index",{symbol:e}))}function AN(e,t){return new S(M("shared-calculator-error-substitution-type-error",{actual:te(e),expected:te(t)}))}function Kg(){return new S(M("shared-calculator-error-substitution-invalid-assignments"))}function Np(e){return new S(M("shared-calculator-error-substitution-local-lhs",{symbol:e}))}function Dp(e){return new S(M("shared-calculator-error-substitution-illegal-lhs",{symbol:e}))}function Ap(e){return new S(M("shared-calculator-error-substitution-function-lhs",{symbol:e}))}function eh(e){return new S(M("shared-calculator-error-substitution-body-regression-parameter-dependency",{symbol:e}))}function th(e){let t=e.filter(r=>r.scope==="free").map(r=>r.symbol);return new S(M("shared-calculator-error-substitution-undefined-rhs",{symbol:t[0]})).setDependencies(t)}function rh(e){return new S(M("shared-calculator-error-substitution-body-local-variable-dependency",{symbol:e}))}function RN(){return new S(M("shared-calculator-error-substitution-body-action"))}function Rp(){return new S(M("shared-calculator-error-substitution-nested"))}function Qu(){return new S(M("shared-calculator-error-substitution-ambiguous-comma"))}function nh(e){return new S(M("shared-calculator-error-substitution-duplicate-assignment",{symbol:e}))}var ks=class extends Ue{constructor(r,n,i){super();this.isFunction=!0;this._symbol=r._symbol,this._argSymbols=n.map(function(s){return s._symbol}),this._exports=[this._symbol],this._expression=i,this.mergeDependenciesInScope(this._argSymbols,this._expression)}getConcreteInvocationTree(r,n,i,s){if(i.length!==this._argSymbols.length)throw mn(s,this._argSymbols.length,i.length);for(var o=Object.create(n),a=0;a<this._argSymbols.length;a++)o[this._argSymbols[a]]=i[a];return this._expression.getConcreteTree(r,o)}getSliderVariables(r,n){var i=this._argSymbols;return super.getSliderVariables(r,n).filter(function(s){return i.indexOf(s)===-1})}asEquation(){var r=this._argSymbols.map(function(i){return new lt(i)}),n=new bs(new Ar(new lt(this._symbol),r),this._expression);return n.userData=this.userData,n.metaData=this.metaData,n}};var Cp=class extends Ue{constructor(r,n){super();this.isRegression=!0;this._lhs=r,this.isLhsSimple=r instanceof lt,this._logLhs=new Ar("ln",[r]),this._rhs=n,this._difference=new fi([r,n]),this._logDifference=new fi([new Ar("ln",[r]),new Ar("ln",[n])]),this.mergeDependencies(r,n)}exportTo(r,n,i){if(!n.isError){for(var s in n.parameters)n.parameters.hasOwnProperty(s)&&(r.assignmentForbidden(s)||(i[s]=i[s]?za(s):n.parameters[s]));r.assignmentForbidden(n.residualVariable)||(i[n.residualVariable]=n.residuals)}}getSliderVariables(){return[]}};var Lp=class extends Ue{constructor(r,n){super();this.isImage=!0;this.center=r.center,this.radianAngle=r.radianAngle,this.width=r.width,this.height=r.height,this.opacity=r.opacity,this.moveStrategy=n,this.mergeDependencies(this.center,this.radianAngle,this.width,this.height,this.opacity)}};var wp=class extends Ue{constructor(r){super();this.handler=r.handler,this.minStep=r.minStep,this.mergeDependencies(this.handler),this.mergeDependencies(this.minStep)}};var _p=class extends zs{constructor(r,n){super(new lt(r._symbol),r._expression);this.isSlider=!0;this.setInputSpan(r._inputSpan),this.sliderAssignment=r,this.sliderMin=n.sliderMin,this.sliderMax=n.sliderMax,this.sliderSoftMin=n.sliderSoftMin,this.sliderSoftMax=n.sliderSoftMax,this.sliderStep=n.sliderStep,this.sliderIsPlayingOnce=n.sliderIsPlayingOnce,this.sliderMin&&this.mergeDependencies(this.sliderMin),this.sliderMax&&this.mergeDependencies(this.sliderMax),this.sliderStep&&this.mergeDependencies(this.sliderStep)}shouldPromoteToSlider(r){return!1}asAssignment(){return new zs(this._symbol,this._expression)}};var Fp=class extends q{constructor(r){let n=new rr(r);super([n]);this._constantNode=n}asValue(){return this._constantNode.asValue()}asCompilerValue(){return this._constantNode.asCompilerValue()}};var Bp=class extends Ue{constructor(r){super();this.exportPenalty=1;this.isTable=!0;this.columns=r,this._exports=[],this.mergeDependencies.apply(this,r);for(var n=0;n<r.length;n++)Array.prototype.push.apply(this._exports,r[n].getExports())}exportTo(r,n,i){for(var s=0;s<this.columns.length;s++){var o=this.columns[s].getExports();if(o.length){var a=o[0];r.assignmentForbidden(a)||i[a]||(n.isError?i[a]=n:this.columns[s].exportTo(r,n.columns[s],i))}}}getAllIds(){return this.columns.map(function(r){return r.header.userData.id})}};function CN(e){return e.isConstant?new rr(e.asCompilerValue()):new rr(NaN)}var ia=class extends Ue{constructor(r,n){super();this.header=r,this.values=n,this.isIndependent=!1,this.registerDependencies(),this._exports=this.computeExports()}registerDependencies(){this.mergeDependencies(this.header),this.mergeDependencies.apply(this,this.values)}computeExports(){return this.header instanceof lt?[this.header._symbol]:[]}_exportSymbolsTo(r,n,i){if(r.length){var s=r[0];if(n.isError)i[s]=n;else try{i[s]=new ys(n.values.map(CN))}catch(o){if(o instanceof Ue)i[s]=o;else throw o}}}exportTo(r,n,i){var s=this.getLegalExports(r);this._exportSymbolsTo(s,n,i)}exportToLocal(r,n){this._exportSymbolsTo(this.getExports(),r,n)}};var Vp=class extends Ue{constructor(r,n,i,s){super();this._symbol=r,this._expression=n,this.otherVariableSolutionData=i,this.mergeDependencies(n),this.branchMultiplier=s}};var Gp=class extends Ue{constructor(r,n,i,s,o){super();this.parameters=r,this.residuals=n,this.statistics=i,this.model=s,this.isModelValid=o.isModelValid,this.residualVariable=o.residualVariable,this.residualSuggestionId=o.residualSuggestionId,this.shouldSuggestLogMode=o.shouldSuggestLogMode,this.isLinear=o.isLinear,this.parameterWarning=o.parameterWarning,this._exports=[this.residualVariable];for(var a in r)r.hasOwnProperty(a)&&this._exports.push(a);this.mergeDependencies(s)}getCompiledFunction(){return this.model.getCompiledFunction.apply(this.model,arguments)}getCompiledDerivative(){return this.model.getCompiledDerivative.apply(this.model,arguments)}};var zp=class extends q{constructor(r){typeof r!="string"&&(r=""+r);super([]);this.isString=!0;this._stringValue=r}asValue(){return this._stringValue}};var qp=class extends q{constructor(r,n){super(n);this.seed=n[0],this.userSeed=n[1],this.tag=r}asValue(){return this.seed.asValue()+"::"+this.tag+this.userSeed.asValue()}copyWithArgs(r){return new this.constructor(this.tag,r)}};function sa(e){return typeof e!="object"||!e?!1:e.type==="Action"}function Nt(e,t){let r=e.getInstruction(t);switch(r.type){case 1:return qi(r.value);default:throw new Error(`Unexpected opcode ${r.type}.`)}}function qi(e){if(Array.isArray(e))return e.map(qi);switch(typeof e){case"boolean":case"number":case"string":return e;case"object":if(sa(e)){let t={};for(let r in e.updateRules){let n=e.updateRules[r];t[r]={value:qi(n.value),valueType:n.valueType}}return{type:"Action",updateRules:t}}else return V(e);default:throw new Error("Unexpected value: "+e)}}function TP(e){switch(e){case Ie:case x:case A:case G:case tr:case mr:case yr:case Ze:case tt:case Te:case pe:case ie:case ee:case ne:case Pe:case de:case oe:case Re:return!0;case ft:case et:case Bt:case Z:case Ir:case Be:case Gr:case zr:case qr:case kr:case Qt:case Me:case li:case Ve:case Tr:case er:case $t:case cr:case pr:case fr:case dr:case Lt:case wt:case Vr:return!1;default:let t=e;throw new Error(`Unexpected valueType: ${t}`)}}function $n(e){switch(e){case x:return NaN;case A:return[NaN,NaN];case G:return[NaN,NaN,NaN];case tr:return[[NaN,NaN,NaN],[NaN,NaN,NaN]];case mr:return[[NaN,NaN,NaN],[NaN,NaN,NaN],[NaN,NaN,NaN]];case yr:return[[[NaN,NaN,NaN],[NaN,NaN,NaN],[NaN,NaN,NaN]],NaN];case tt:return[NaN,NaN,NaN];case Ze:return{type:"Action",updateRules:{}};case pe:case Pe:case ne:return[[NaN,NaN],[NaN,NaN]];case ie:return[[NaN,NaN],NaN];case ee:return[[NaN,NaN],[NaN,NaN],[NaN,NaN]];case Ie:return!1;case Te:return[];case Re:return[[NaN,NaN],[NaN,NaN],!1];case de:case oe:return[[NaN,NaN],NaN,NaN];default:let t=e;throw new Error(`${t} does not have a NaN type.`)}}function wN(e){for(var t=0;t<this.length;t++)e(this.elementAt(t),t)}function _N(e){for(var t=[],r=0;r<this.length;r++)t.push(e(this.elementAt(r),r));return t}var hr=class extends Ue{constructor(r){super();this.isError=!1;this.eachElement=wN;this.mapElements=_N;if(r.getError())throw new Error("Programming error: IRExpression should not be constructed with an error chunk");if(this._chunk=r,this.valueType=r.getReturnType(),this.addDependencies(r.getLiveArgNames()),this.isList=k(this.valueType),this.isList&&(this.length=this._chunk.getConstantListLength(),this.length===void 0))throw jg(r.getListLengthDependencies());var n=r.isConstant();this.isConstant=n&&(this.valueType===x||this.valueType===Ie),this.isTypedConstant=n,this.isEmptyAction=n&&this.valueType===Ze&&Object.keys(r.asValue().updateRules).length===0}shouldExportAns(){return!0}getCompiledFunction(r){return this._chunk.getCompiledFunction(r)}polynomialOrder(r){return this._chunk.polynomialOrder(r,{allowRestriction:!0,allowClosedBlockReferences:!1})}getPolynomialCoefficients(r){for(var n=this._chunk.getPolynomialCoefficients(r),i=n.chunk,s=n.coefficients,o=[],a=0;a<s.length;a++){var u=i.copy();u.setReturnIndex(s[a]),u.close(),o.push(new hr(u))}return o}takeDerivative(r){var n=this._chunk.copy().takeDerivative(r).close();return new hr(n)}interpretWithParameters(r){let n,i=this._chunk.argNames;if(r.length===i.length)n=r;else{n=[];let s=this.getDependencies();for(let o=0,a=0;o<i.length;o++)s[a]===i[o]?(n.push(r[a]),a+=1):n.push(void 0)}return this._chunk.interpretWithParameters(n)}substituteConstantArguments(r){return new hr(this._chunk.substituteConstantArguments(r))}boundDomain(r){return this._chunk.boundDomain(r)}asValue(){if(this._chunk.isConstant())return this._chunk.asValue();if(this.isList){for(var r=[],n=qi($n(ke(this.valueType))),i=0;i<this.length;i++)r.push(n);return r}else return qi($n(this.valueType))}asTypedValue(){return{valueType:this.valueType,value:this.asValue()}}asCompilerValue(){return this._chunk.asCompilerValue()}isNaN(){return typeof this.asValue()=="number"&&isNaN(this.asValue())}getEvaluationInfo(){return this._chunk.isConstant()&&this.getDependencies().length===0&&(fe(this.valueType,x)||fe(this.valueType,Ie))?[{val:this.asValue()}]:!1}findLinearSubset(r){return this._chunk.findLinearSubset(r)}deriveRegressionRestrictions(){var r=this._chunk.deriveRegressionRestrictions();return r===this._chunk?this:new hr(r)}getCursorContext(){return this._chunk.getCursorContext()}};var kp=class extends q{};var Up=class extends q{};var Hp=class extends q{};var $p=class extends q{};var Yp=class extends q{};var Ua=class extends q{};var Wp=class extends q{};var Xp=class extends q{isInequality(){return this.args[0].isInequality()&&this.args[1].isInequality()}};var Zp=class extends q{};var jp=class extends Ua{};function J(e,t){let r=xP(e);return r.prototype.type=t,r}var b={Base:J(Ue,"Base"),Expression:J(q,"Expression"),Error:J(S,"Error"),Constant:J(rr,"Constant"),MixedNumber:J(bc,"MixedNumber"),Identifier:J(lt,"Identifier"),Ans:J(xc,"Ans"),List:J(ys,"List"),Range:J(Tc,"Range"),ListAccess:J(Ca,"ListAccess"),DotAccess:J(Gs,"DotAccess"),Construction:J(Pc,"Construction"),ParenSeq:J(ds,"ParenSeq"),MovablePoint:J(Ic,"MovablePoint"),NamedCoordinateAccess:J(La,"NamedCoordinateAccess"),BareSeq:J(Mc,"BareSeq"),Norm:J(Ec,"Norm"),BaseComparator:J(di,"BaseComparator"),DoubleInequality:J(Oc,"DoubleInequality"),RepeatedOperator:J(to,"RepeatedOperator"),Sum:J(Sc,"Sum"),Product:J(Nc,"Product"),Integral:J(Dc,"Integral"),AssignmentExpression:J(Ac,"AssignmentExpression"),ListComprehension:J(Rc,"ListComprehension"),FunctionCall:J(Ar,"FunctionCall"),SeededFunctionCall:J(wa,"SeededFunctionCall"),FunctionExponent:J(Cc,"FunctionExponent"),FunctionFactorial:J(Lc,"FunctionFactorial"),Prime:J(wc,"Prime"),Piecewise:J(hs,"Piecewise"),Derivative:J(_c,"Derivative"),UpdateRule:J(Fc,"UpdateRule"),Substitution:J(Bc,"Substitution"),Histogram:J(Vc,"Histogram"),DotPlot:J(Gc,"DotPlot"),BoxPlot:J(zc,"BoxPlot"),TTest:J(qc,"TTest"),IndependentTTest:J(kc,"IndependentTTest"),Stats:J(Uc,"Stats"),Assignment:J(zs,"Assignment"),CoordinateEquation:J(Hc,"CoordinateEquation"),FunctionDefinition:J(ks,"FunctionDefinition"),Equation:J(bs,"Equation"),Regression:J(Cp,"Regression"),Image:J(Lp,"Image"),Ticker:J(wp,"Ticker"),Slider:J(_p,"Slider"),RegressionParameter:J(Fp,"RegressionParameter"),Table:J(Bp,"Table"),TableColumn:J(ia,"TableColumn"),SolvedEquation:J(Vp,"SolvedEquation"),OptimizedRegression:J(Gp,"OptimizedRegression"),Seed:J(zp,"Seed"),ExtendSeed:J(qp,"ExtendSeed"),IRExpression:J(hr,"IRExpression"),Add:J(kp,"Add"),Subtract:J(fi,"Subtract"),Multiply:J(Up,"Multiply"),DotMultiply:J(Hp,"DotMultiply"),CrossMultiply:J($p,"CrossMultiply"),Divide:J(Yp,"Divide"),Exponent:J(Ua,"Exponent"),Negative:J(Wp,"Negative"),And:J(Xp,"And"),PercentOf:J(Zp,"PercentOf"),RawExponent:J(jp,"RawExponent"),Comparator:{"<":J(gs["<"],"Comparator['<']"),">":J(gs[">"],"Comparator['>']"),"<=":J(gs["<="],"Comparator['<=']"),">=":J(gs[">="],"Comparator['>=']"),"=":J(gs["="],"Comparator['=']")}};function ih(e,t){let r=Math.round(1e6*e)/1e6;return Math.abs(r-e)<t?r:e}function hz(e){let t=!0,r=!0,n=!0;return e.hardMin!==void 0&&e.target<e.hardMin&&(t=!1),e.hardMax!==void 0&&e.target>e.hardMax&&(r=!1),e.step&&Jp({target:e.target,step:e.step,hardMin:t?e.hardMin:void 0,hardMax:r?e.hardMax:void 0})!==e.target&&(n=!1),{min:t,max:r,step:n}}function Jp(e){let{target:t,hardMin:r,hardMax:n,step:i}=e,s=1e-10;if(r!==void 0&&n!==void 0&&(s=Math.min(s,Math.abs(n-r)/1e3)),i&&(s=Math.min(s,i/10)),r!==void 0&&(r=ih(r,s)),n!==void 0&&(n=ih(n,s)),e.forceSliderToMax&&n!==void 0&&(t=n),r>n||t<=r)return r;if(t>=n)return n;if(i){let u=r!==void 0?r:0;var o=Math.round((t-u)/i);t=i*o+u}let a=ih(t,s);return(i||r===a||n===a)&&(t=a),t<=r?r:t>=n?n:t}function PP(e){let{storedMax:t,sliderValue:r,hardMin:n,step:i}=e,s=10;if(t>s&&(s=t),r>s&&(s=r),n>s&&(s=n),i){let o=Jp({target:s,hardMin:n,hardMax:void 0,step:i});o>=s?s=o:s=o+i}return s}var oh=b.Constant,BN=b.Identifier;b.Base.prototype.tryGetConcreteTree=function(e,t,r={}){var n;try{n=this.getConcreteTree(e,t,r)}catch(i){i instanceof b.Base?n=i:n=Ce()}return n};b.Base.prototype.getConcreteTree=function(e,t,r={}){var i;var n=this.buildIRExpression(e,t,{selection:(i=this.parseOptions)==null?void 0:i.selection,coerceToNumber:r.coerceToNumber});if(n.isError)throw n;return n};b.DoubleInequality.prototype.getConcreteTree=function(e,t){return new this.constructor([new b.Piecewise([this._indicator,this._expressions[0],new oh(NaN)]).getConcreteTree(e,t),this._operators[0],new BN(this._symbol),this._operators[1],new b.Piecewise([this._indicator,this._expressions[1],new oh(NaN)]).getConcreteTree(e,t)])};b.Error.prototype.getConcreteTree=function(e,t){return this};function Ku(e,t){return e.isError?e:t.indexOf(e.valueType)===-1?Ce():e}b.Image.prototype.getConcreteTree=function(e,t){var r=this.center.tryGetConcreteTree(e,t),n=this.radianAngle.tryGetConcreteTree(e,t),i=this.width.tryGetConcreteTree(e,t),s=this.height.tryGetConcreteTree(e,t),o=this.opacity.tryGetConcreteTree(e,t),a=[A,Be,Me],u=[x,Z,Me];return r=Ku(r,a),n=Ku(n,u),i=Ku(i,u),s=Ku(s,u),o=Ku(o,u),new b.Image({center:r,radianAngle:n,width:i,height:s,opacity:o},this.moveStrategy)};b.Ticker.prototype.getConcreteTree=function(e,t){var r=this.handler.tryGetConcreteTree(e,t);!r.isError&&r.valueType!==Ze&&(r=_u(te(r.valueType)));var n=r.getDependencies().filter(function(i){return!e.validActionVariable(i)});return n.length&&(r=Ct(e.sliderVariables(n)).setDependencies(n)),new b.Ticker({handler:r,minStep:this.minStep.tryGetConcreteTree(e,t)})};function sh(e,t,r){if(!t){r.valids[e]=!0;return}var n=t.getDependencies();if(t.isError)r.errors[e]=!0;else if(n.length>0){r.errors[e]=!0;for(var i=0;i<n.length;i++)n[i]===r.exportedSymbol?r.errors.cycle=!0:r.missingVars.push(n[i])}else r.values[e]=+t.asValue();r.valids[e]=isFinite(r.values[e]),r.valids[e]||(r.values[e]=void 0)}function Qp(e){return e&&e.valueType===Z&&e.length===1&&e.args?e.args[0]:e}b.Slider.prototype.getConcreteTree=function(e,t){var r=this._expression.getConcreteTree(e,t),n=Qp(this.sliderMin&&this.sliderMin.tryGetConcreteTree(e,t)),i=Qp(this.sliderMax&&this.sliderMax.tryGetConcreteTree(e,t)),s=Qp(this.sliderStep&&this.sliderStep.tryGetConcreteTree(e,t)),o={exportedSymbol:this._symbol,errors:{},values:{},valids:{},missingVars:[],errMsg:void 0};if(sh("min",n,o),sh("max",i,o),sh("step",s,o),s&&o.valids.step&&(o.values.step===0?delete o.values.step:o.values.step=Math.abs(o.values.step)),o.errors.cycle?r=ig(o.exportedSymbol):(o.errors.min||!o.valids.min?o.errMsg=sg():o.errors.max||!o.valids.max?o.errMsg=og():(o.errors.step||!o.valids.step)&&(o.errMsg=ug()),o.values.min>o.values.max&&(o.valids.min=!1,o.valids.max=!1,o.errMsg||(o.errMsg=ag()))),r.isConstant){var a=t.initialEvaluation&&t.initialEvaluation.asValue(),u=a&&this.sliderIsPlayingOnce,l=o.values.max,c=+r.asValue(),p=o.values.min,f=o.values.step;if(u&&!isFinite(l)){var m=Qp(this.sliderSoftMax&&this.sliderSoftMax.tryGetConcreteTree(e,t));m&&(l=PP({storedMax:+m.asValue(),sliderValue:c,step:f,hardMin:p}))}var d=Jp({target:c,hardMin:p,hardMax:l,step:f,forceSliderToMax:!!u}),y=Vo(d.toString()),g=isFinite(V(y))?y:d;r=new oh(g).getConcreteTree(e,t)}return r.sliderInfo=o,r};function IP(e,t){if(!t[this._symbol])throw Hn(this._symbol);var r=this.args.map(function(i){return i.getConcreteTree(e,t)});if(r.length>0){if(r.length===1&&r.push(new b.Constant(1).getConcreteTree(e,t)),r[1].getDependencies().length)throw Yu(this._symbol).setDependencies(r[1].getDependencies());if(r[1].valueType!==x)throw Yu(this._symbol);var n=r[1].asValue();if(!isFinite(n)||n<=0)throw Yu(this._symbol)}return this.typeCheck(e,r),new this.constructor(r)}b.Histogram.prototype.getConcreteTree=IP;b.DotPlot.prototype.getConcreteTree=IP;b.BoxPlot.prototype.getConcreteTree=function(e,t){if(!t[this._symbol])throw Hn(this._symbol);var r=this.args.map(function(n){return n.getConcreteTree(e,t)});return this.typeCheck(e,r),r.length===1&&(r[0].valueType===Z||r[0].valueType===Me)?new this.constructor(r):Ce()};function ah(e,t){if(!t[this._symbol])throw Hn(this._symbol);var r=this.args.map(function(n){return n.getConcreteTree(e,t)});return this.typeCheck(e,r),new this.constructor(r)}b.TTest.prototype.getConcreteTree=ah;b.IndependentTTest.prototype.getConcreteTree=ah;b.Stats.prototype.getConcreteTree=ah;b.Table.prototype.getConcreteTree=function(e,t){for(var r=[],n=Object.create(t),i=0;i<this.columns.length;i++){var s=this.columns[i].getConcreteTree(e,n);s.isIndependent&&this.columns[i].exportToLocal(s,n),r.push(s)}return new this.constructor(r)};b.TableColumn.prototype.getConcreteTree=function(e,t){var u;var r=this.header.getConcreteTree(e,t),n,i,s=this.header instanceof b.Identifier&&!t[this.header._symbol];if(s){n=[];for(var o=0;o<this.values.length;o++){if(this.values[o].tableError()){n.push(qa(this.values[o].tableError()));continue}var a=this.values[o].tryGetConcreteTree(e,t);a.isError?n.push(a):a.tableError()?n.push(qa(a.tableError())):a.valueType===x?n.push(a):n.push(sy([te(a.valueType)]))}return i=new this.constructor(r,n),i.isIndependent=!0,i}else return r.isList?n=r.mapElements(function(l){return l}):n=[],!r.isError&&r.valueType!==x&&r.valueType!==Z&&r.valueType!==Me&&(r=iy([te((u=r.valueType)!=null?u:ft)])),i=new this.constructor(r,n),i};function el(e,t,r){return{symbolMap:e,symbolNodeMap:t,maxIndex:r}}function Ha(e,t){return e.symbolMap[t]}function MP(e,t){return e.symbolNodeMap[t]}function wn(e,t,r,n){e.symbolNodeMap[t]=n,e.symbolMap[t]=r,e.maxIndex=Math.max(e.maxIndex,r)}function xs(e){return el(Object.create(e.symbolMap),Object.create(e.symbolNodeMap),e.maxIndex)}var Ui={};ui(Ui,{acosh:()=>Jl,acot:()=>mD,acoth:()=>ID,acsc:()=>yD,acsch:()=>PD,addTangentAngle:()=>_A,addTangentArc:()=>wA,addTangentCircle:()=>LA,addTangentLine:()=>RA,addTangentRay:()=>CA,addTangentSegment:()=>qh,angleMarkerMultiplier:()=>IA,angleMarkerRawDelta:()=>PA,arc:()=>xA,arcArcIntersection:()=>kA,arcCenter:()=>Qa,arcCircleIntersection:()=>qA,arcGlider:()=>AI,arcLineIntersection:()=>_I,arcOmega:()=>Ka,argMax:()=>XD,argMin:()=>WD,asec:()=>gD,asech:()=>TD,asinh:()=>Ql,atanh:()=>Kl,bernoulliTable:()=>oI,binomSample:()=>wD,binomcdf:()=>FD,binompdf:()=>bf,center:()=>hA,chooseNonIncidentPoint:()=>VA,circle:()=>gA,circleArcIntersection:()=>zA,circleCircleIntersection:()=>fl,circleGlider:()=>FA,circleLineIntersection:()=>CI,clamp:()=>Rr,common_log:()=>lD,composeTransformation:()=>tR,corr:()=>Tf,cos:()=>tn,cosh:()=>_o,cot:()=>dD,cotDerivative:()=>aI,coth:()=>xD,cov:()=>jD,covp:()=>EI,csc:()=>fD,csch:()=>bD,dilation:()=>QA,directedAngleMarker:()=>NI,directedCoterminalAngle:()=>DI,distance:()=>ml,distance3d:()=>eA,elementsAt:()=>fR,erf:()=>GD,erfcx:()=>Us,expm1:()=>ec,factorial:()=>ua,gamma:()=>pl,gcd:()=>vh,getArcDetails:()=>Pf,hsv:()=>tA,hypot:()=>ci,identity:()=>yA,invBinom:()=>yI,invNorm:()=>Rh,invPoisson:()=>mI,invT:()=>gI,invUniform:()=>qD,invertTransformation:()=>rR,isDegenerateArc:()=>Gh,itscore:()=>bI,ittest:()=>Lh,lcm:()=>nI,line:()=>dA,lineArcIntersection:()=>wI,lineCircleIntersection:()=>Hh,lineGlider:()=>kh,lineLineIntersection:()=>LI,listGCD:()=>iD,listLCM:()=>sD,listLength:()=>kD,listMax:()=>TI,listMin:()=>xI,lnGamma:()=>aD,log:()=>uD,log1p:()=>as,log_base:()=>lI,lowerQuantileIndex:()=>HD,lowerQuartileIndex:()=>YD,mad:()=>ZD,md5Spyable:()=>eI,mean:()=>Ms,median:()=>II,mod:()=>rI,nCr:()=>io,nPr:()=>cf,normalSample:()=>CD,normalcdf:()=>AD,normalpdf:()=>Sh,nthroot:()=>cD,parallel:()=>YA,perpendicular:()=>WA,pointDet:()=>VI,pointDot:()=>XA,pointPerp:()=>ZA,poissonSample:()=>_D,poissoncdf:()=>BD,poissonpdf:()=>Za,polyGamma:()=>uI,polygon:()=>rA,polygonArea:()=>Bh,polygonEdges:()=>aA,polygonGlider:()=>BA,polygonInteriorDirectedAngles:()=>fA,polygonInteriorUndirectedAngles:()=>pA,polygonPerimeter:()=>uA,pow:()=>tI,quad:()=>KD,quantile:()=>PI,quartile:()=>la,quartileIndex:()=>xf,radius:()=>bA,random:()=>Nh,randomPerm:()=>Dh,rank:()=>Ih,ray:()=>mA,rayGlider:()=>Mh,reflection:()=>eR,rgb:()=>vI,rotation:()=>KA,scaleTangentAngle:()=>AA,scaleTangentArc:()=>DA,scaleTangentCircle:()=>NA,scaleTangentLine:()=>OA,scaleTangentRay:()=>SA,scaleTangentSegment:()=>zh,sec:()=>pD,sech:()=>hD,segment:()=>Vh,segment3d:()=>nA,segmentGlider:()=>Uh,select:()=>pR,shuffle:()=>RD,sign:()=>Oa,sin:()=>Sr,sinh:()=>va,sortPerm:()=>ca,spearman:()=>JD,sphere:()=>sA,sqrtxsqm1:()=>$d,sqrtxsqp1:()=>Hd,stats:()=>wh,stdev:()=>pf,stdevp:()=>QD,supplementAngle:()=>EA,tSample:()=>LD,tan:()=>pI,tanh:()=>jl,tcdf:()=>uf,toFraction:()=>nD,total:()=>MD,tpdf:()=>hf,transformAngleMarker:()=>cR,transformArc:()=>uR,transformCircle:()=>aR,transformLine:()=>sR,transformPoint:()=>Is,transformPolygon:()=>lR,transformRay:()=>oR,transformSegment:()=>Wh,transformation:()=>jA,translation:()=>JA,triangle:()=>iA,tscore:()=>hI,ttest:()=>Ch,undirectedAngleMarker:()=>TA,undirectedCoterminalAngle:()=>MA,uniformSample:()=>so,uniformcdf:()=>VD,uniformpdf:()=>Ah,uniquePerm:()=>dR,upperQuantileIndex:()=>UD,upperQuartileIndex:()=>$D,validateRangeLength:()=>_h,validateSampleCount:()=>Fh,variance:()=>MI,varp:()=>dl,vertices:()=>oA});var vP=function(){"use strict";function e(y,g){var h=(y&65535)+(g&65535),P=(y>>16)+(g>>16)+(h>>16);return P<<16|h&65535}function t(y,g){return y<<g|y>>>32-g}function r(y,g,h,P,T,D){return e(t(e(e(g,y),e(P,D)),T),h)}function n(y,g,h,P,T,D,N){return r(g&h|~g&P,y,g,T,D,N)}function i(y,g,h,P,T,D,N){return r(g&P|h&~P,y,g,T,D,N)}function s(y,g,h,P,T,D,N){return r(g^h^P,y,g,T,D,N)}function o(y,g,h,P,T,D,N){return r(h^(g|~P),y,g,T,D,N)}function a(y,g){y[g>>5]|=128<<g%32,y[(g+64>>>9<<4)+14]=g;var h,P,T,D,N,I=1732584193,O=-271733879,E=-1732584194,v=271733878;for(h=0;h<y.length;h+=16)P=I,T=O,D=E,N=v,I=n(I,O,E,v,y[h],7,-680876936),v=n(v,I,O,E,y[h+1],12,-389564586),E=n(E,v,I,O,y[h+2],17,606105819),O=n(O,E,v,I,y[h+3],22,-1044525330),I=n(I,O,E,v,y[h+4],7,-176418897),v=n(v,I,O,E,y[h+5],12,1200080426),E=n(E,v,I,O,y[h+6],17,-1473231341),O=n(O,E,v,I,y[h+7],22,-45705983),I=n(I,O,E,v,y[h+8],7,1770035416),v=n(v,I,O,E,y[h+9],12,-1958414417),E=n(E,v,I,O,y[h+10],17,-42063),O=n(O,E,v,I,y[h+11],22,-1990404162),I=n(I,O,E,v,y[h+12],7,1804603682),v=n(v,I,O,E,y[h+13],12,-40341101),E=n(E,v,I,O,y[h+14],17,-1502002290),O=n(O,E,v,I,y[h+15],22,1236535329),I=i(I,O,E,v,y[h+1],5,-165796510),v=i(v,I,O,E,y[h+6],9,-1069501632),E=i(E,v,I,O,y[h+11],14,643717713),O=i(O,E,v,I,y[h],20,-373897302),I=i(I,O,E,v,y[h+5],5,-701558691),v=i(v,I,O,E,y[h+10],9,38016083),E=i(E,v,I,O,y[h+15],14,-660478335),O=i(O,E,v,I,y[h+4],20,-405537848),I=i(I,O,E,v,y[h+9],5,568446438),v=i(v,I,O,E,y[h+14],9,-1019803690),E=i(E,v,I,O,y[h+3],14,-187363961),O=i(O,E,v,I,y[h+8],20,1163531501),I=i(I,O,E,v,y[h+13],5,-1444681467),v=i(v,I,O,E,y[h+2],9,-51403784),E=i(E,v,I,O,y[h+7],14,1735328473),O=i(O,E,v,I,y[h+12],20,-1926607734),I=s(I,O,E,v,y[h+5],4,-378558),v=s(v,I,O,E,y[h+8],11,-2022574463),E=s(E,v,I,O,y[h+11],16,1839030562),O=s(O,E,v,I,y[h+14],23,-35309556),I=s(I,O,E,v,y[h+1],4,-1530992060),v=s(v,I,O,E,y[h+4],11,1272893353),E=s(E,v,I,O,y[h+7],16,-155497632),O=s(O,E,v,I,y[h+10],23,-1094730640),I=s(I,O,E,v,y[h+13],4,681279174),v=s(v,I,O,E,y[h],11,-358537222),E=s(E,v,I,O,y[h+3],16,-722521979),O=s(O,E,v,I,y[h+6],23,76029189),I=s(I,O,E,v,y[h+9],4,-640364487),v=s(v,I,O,E,y[h+12],11,-421815835),E=s(E,v,I,O,y[h+15],16,530742520),O=s(O,E,v,I,y[h+2],23,-995338651),I=o(I,O,E,v,y[h],6,-198630844),v=o(v,I,O,E,y[h+7],10,1126891415),E=o(E,v,I,O,y[h+14],15,-1416354905),O=o(O,E,v,I,y[h+5],21,-57434055),I=o(I,O,E,v,y[h+12],6,1700485571),v=o(v,I,O,E,y[h+3],10,-1894986606),E=o(E,v,I,O,y[h+10],15,-1051523),O=o(O,E,v,I,y[h+1],21,-2054922799),I=o(I,O,E,v,y[h+8],6,1873313359),v=o(v,I,O,E,y[h+15],10,-30611744),E=o(E,v,I,O,y[h+6],15,-1560198380),O=o(O,E,v,I,y[h+13],21,1309151649),I=o(I,O,E,v,y[h+4],6,-145523070),v=o(v,I,O,E,y[h+11],10,-1120210379),E=o(E,v,I,O,y[h+2],15,718787259),O=o(O,E,v,I,y[h+9],21,-343485551),I=e(I,P),O=e(O,T),E=e(E,D),v=e(v,N);return[I,O,E,v]}function u(y){var g,h="",P=y.length*32;for(g=0;g<P;g+=8)h+=String.fromCharCode(y[g>>5]>>>g%32&255);return h}function l(y){var g,h=[];for(h[(y.length>>2)-1]=void 0,g=0;g<h.length;g+=1)h[g]=0;var P=y.length*8;for(g=0;g<P;g+=8)h[g>>5]|=(y.charCodeAt(g/8)&255)<<g%32;return h}function c(y){return u(a(l(y),y.length*8))}function p(y){var g="0123456789abcdef",h="",P,T;for(T=0;T<y.length;T+=1)P=y.charCodeAt(T),h+=g.charAt(P>>>4&15)+g.charAt(P&15);return h}function f(y){return unescape(encodeURIComponent(y))}function m(y){return c(f(y))}function d(y){return p(m(y))}return d}();var nf={};ui(nf,{color:()=>tf,hsl:()=>rf,rgb:()=>oa});function ch(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function LP(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function nl(){}var tl=.7,ef=1/tl,$a="\\s*([+-]?\\d+)\\s*",rl="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ps="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",VN=/^#([0-9a-f]{3,8})$/,GN=new RegExp("^rgb\\("+[$a,$a,$a]+"\\)$"),zN=new RegExp("^rgb\\("+[Ps,Ps,Ps]+"\\)$"),qN=new RegExp("^rgba\\("+[$a,$a,$a,rl]+"\\)$"),kN=new RegExp("^rgba\\("+[Ps,Ps,Ps,rl]+"\\)$"),UN=new RegExp("^hsl\\("+[rl,Ps,Ps]+"\\)$"),HN=new RegExp("^hsla\\("+[rl,Ps,Ps,rl]+"\\)$"),OP={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};ch(nl,tf,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:SP,formatHex:SP,formatHsl:$N,formatRgb:NP,toString:NP});function SP(){return this.rgb().formatHex()}function $N(){return wP(this).formatHsl()}function NP(){return this.rgb().formatRgb()}function tf(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=VN.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?DP(t):r===3?new Yn(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?Kp(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?Kp(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=GN.exec(e))?new Yn(t[1],t[2],t[3],1):(t=zN.exec(e))?new Yn(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=qN.exec(e))?Kp(t[1],t[2],t[3],t[4]):(t=kN.exec(e))?Kp(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=UN.exec(e))?CP(t[1],t[2]/100,t[3]/100,1):(t=HN.exec(e))?CP(t[1],t[2]/100,t[3]/100,t[4]):OP.hasOwnProperty(e)?DP(OP[e]):e==="transparent"?new Yn(NaN,NaN,NaN,0):null}function DP(e){return new Yn(e>>16&255,e>>8&255,e&255,1)}function Kp(e,t,r,n){return n<=0&&(e=t=r=NaN),new Yn(e,t,r,n)}function YN(e){return e instanceof nl||(e=tf(e)),e?(e=e.rgb(),new Yn(e.r,e.g,e.b,e.opacity)):new Yn}function oa(e,t,r,n){return arguments.length===1?YN(e):new Yn(e,t,r,n==null?1:n)}function Yn(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}ch(Yn,oa,LP(nl,{brighter:function(e){return e=e==null?ef:Math.pow(ef,e),new Yn(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?tl:Math.pow(tl,e),new Yn(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:AP,formatHex:AP,formatRgb:RP,toString:RP}));function AP(){return"#"+uh(this.r)+uh(this.g)+uh(this.b)}function RP(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function uh(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function CP(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Ts(e,t,r,n)}function wP(e){if(e instanceof Ts)return new Ts(e.h,e.s,e.l,e.opacity);if(e instanceof nl||(e=tf(e)),!e)return new Ts;if(e instanceof Ts)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,i=Math.min(t,r,n),s=Math.max(t,r,n),o=NaN,a=s-i,u=(s+i)/2;return a?(t===s?o=(r-n)/a+(r<n)*6:r===s?o=(n-t)/a+2:o=(t-r)/a+4,a/=u<.5?s+i:2-s-i,o*=60):a=u>0&&u<1?0:o,new Ts(o,a,u,e.opacity)}function rf(e,t,r,n){return arguments.length===1?wP(e):new Ts(e,t,r,n==null?1:n)}function Ts(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}ch(Ts,rf,LP(nl,{brighter:function(e){return e=e==null?ef:Math.pow(ef,e),new Ts(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?tl:Math.pow(tl,e),new Ts(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,i=2*r-n;return new Yn(lh(e>=240?e-240:e+120,i,n),lh(e,i,n),lh(e<120?e+240:e-120,i,n),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function lh(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}function Zn(e,t){let r;e>t&&(r=e,e=t,t=r);let n=e>0,i=t>0,s=Math.abs(e)>.01,o=Math.abs(t)>.01;if(s||o)return _s(e,t);if(e===0)return t*Math.abs(t);if(t===0)return e*Math.abs(e);if(n!==i)return 0;let a=n?Math.sqrt(e*t):-Math.sqrt(e*t);return a>=e&&t>=a?a:_s(e,t)}function mh(e,t,r,n,i){if(!(isNaN(t)||isNaN(n)||t<0==n<0))for(;;){let s=Zn(e,r),o=i(s);if(!isFinite(o))return;if(s===e||s===r)return Math.abs(t)<=Math.abs(n)?[e,t]:[r,n];if(o===0)return il(e,t,s,o,r,n,i);t<0!=o<0?(r=s,n=o):(e=s,t=o)}}function zP(e,t,r,n,i){if(!(ph(t)||ph(n))&&fh(t,n))for(;;){let s=Zn(e,r),o=i(s);if(ph(o))return;if(s===e||s===r)return s;if(fh(t,o))r=s,n=o;else if(fh(o,n))e=s,t=o;else return}}function ph(e){for(let t of e)if(isNaN(t))return!0;return!1}function fh(e,t){for(let r=0;r<e.length;r++)if(!WN(e[r],t[r]))return!1;return!0}function WN(e,t){return e<=0&&t>=0||e>=0&&t<=0}function il(e,t,r,n,i,s,o){let a;if(!isFinite(n))return;isFinite(t)||(a=Wn(e,t,r,n,o),a!==void 0&&(e=a,t=o(e))),isFinite(s)||(a=Wn(r,n,i,s,o),a!==void 0&&(i=a,s=o(a)));let u,l;t===n?u=[e,t]:u=_P(e,t,r,n,o,n),s===n?l=[i,s]:l=_P(r,n,i,s,o,n);let c;return u&&l&&(c=Zn(u[0],l[0])),c!==void 0?[c,o(c)]:void 0}function Wn(e,t,r,n,i){if(isFinite(t)!==isFinite(n))for(;;){let s=Zn(e,r),o=i(s);if(s===e||s===r)return isFinite(t)?e:r;isFinite(o)!==isFinite(t)?(r=s,n=o):(e=s,t=o)}}function _P(e,t,r,n,i,s){if(t===s!=(n===s))for(;;){let o=Zn(e,r),a=i(o);if(o===e||o===r)return t===s?[e,t]:[r,n];a===s!=(t===s)?(r=o,n=a):(e=o,t=a)}}function qP(e,t,r,n,i,s,o){if(e<r&&r<i&&isFinite(t)&&isFinite(n)&&isFinite(s)&&t!==n&&n!==s&&n>t==n>s)for(;;){let a=Zn(e,r),u=o(a),l=Zn(r,i),c=o(l);if(!isFinite(u)||!isFinite(c))return;if(a===e||a===r||l===r||l===i)return u>n==n>t?[a,u]:c>n==n>t?[l,c]:[r,n];if(u===n||c===n)return il(e,t,r,n,i,s,o);n>t&&u>t&&u>n||n<t&&u<t&&u<n?(i=r,s=n,r=a,n=u):n>t&&c>n&&c>s||n<t&&c<n&&c<s?(e=r,t=n,r=l,n=c):(e=a,t=u,i=l,s=c)}}function Xn([e,t],[r,n]){return(r-e)*(r-e)+(n-t)*(n-t)}function FP(e,t,r,n,i,s){let o=s(e),a=s(t),u=s(r),l=Xn(o,n),c=Xn(a,n),p=Xn(u,n);if(!(t<=e||r<=t)&&!(!isFinite(l)||!isFinite(c)||!isFinite(p))&&!(c>=l||c>=p))for(;;){if(Math.abs(u[0]-o[0])<i&&Math.abs(u[1]-o[1])<i)return[e,r];let f=Zn(e,t),m=s(f),d=Xn(m,n),y=Zn(t,r),g=s(y),h=Xn(g,n);if(!isFinite(d)||!isFinite(h))return;if(f===e||f===t||y===t||y===r)return d<c&&d<h?[f,f]:h<d&&h<c?[y,y]:[t,t];if((d===c||h===c)&&(t=.5*(f+t),a=s(t),c=Xn(a,n),d===c||h===c))return[e,r];d<c&&d<h?([r,t]=[t,f],[u,a]=[a,m],[p,c]=[c,d]):h<d&&h<c?([e,t]=[t,y],[o,a]=[a,g],[l,c]=[c,h]):([e,r]=[f,y],[o,u]=[m,g],[l,p]=[d,h])}}function BP(e,t,r){return t===void 0&&(t=-1/0),r===void 0&&(r=1/0),Math.min(r,Math.max(t,e))}function dh(e,t,r,n,i,s){let o;if(n!==void 0&&i!==void 0){let p=.5*(n+i);o=r+.01*(r<p?i-n:n-i)}else o=Math.abs(r)>1?r*1.00001:r+1e-5;let a=e(r),u=e(o),l=Xn(a,t),c=Xn(u,t);if(!(!isFinite(l)||!isFinite(c))){if(l===c)return[r,o];for(c>l&&([r,o]=[o,r],[a,u]=[u,a],[l,c]=[c,l]);isFinite(r)&&isFinite(o)&&r!==o;){if(i!==void 0&&o>i)return[i,i];if(n!==void 0&&o<n)return[n,n];let p=r+3*(o-r),f=e(p),m=Xn(f,t);if(!isFinite(m))return[r,o];if(m===c)return[r,o];if(m>c){let d=o>r?FP(r,o,p,t,s,e):FP(p,o,r,t,s,e);return d&&[BP(d[0],n,i),BP(d[1],n,i)]}[r,l,o,c]=[o,c,p,m]}return[r,o]}}function VP(e,t,r,n){return r?n?Math.min(Xn(e(n[0]),t),Xn(e(n[1]),t))<Math.min(Xn(e(r[0]),t),Xn(e(r[1]),t)):!1:!0}function Tz(e,t,r,n,i,s){let o=dh(e,t,r,n,i,s);if(n!==void 0){let a=dh(e,t,n,n,i,s);VP(e,t,o,a)&&(o=a)}if(i!==void 0){let a=dh(e,t,i,n,i,s);VP(e,t,o,a)&&(o=a)}return o}function GP(e,t,r,n,i,s,o,a){let u=Math.abs(n-t),l=Math.abs(s-n),c=Math.abs(a-s);return u>l&&u>c?[e,r]:c>l&&c>u?[i,o]:[r,i]}function Ya(e,t,r,n,i,s,o,a=0){if(!((r-e)*(i-r)<=0)&&!(!isFinite(e)||!isFinite(r)||!isFinite(i))&&!(!isFinite(t)||!isFinite(s))){if(!isFinite(n)){let u=Wn(e,t,r,n,o),l=Wn(r,n,i,s,o);return u===void 0||l===void 0?void 0:[u,l]}if(!(Math.abs(n-((i-r)*t+(r-e)*s)/(i-e))<a))for(;;){let u=Zn(e,r),l=o(u),c=Zn(r,i),p=o(c),f=Math.abs(l-_s(t,n)),m=Math.abs(n-_s(l,p)),d=Math.abs(p-_s(n,s));if(f<=a&&m<=a&&d<=a)return;if(!isFinite(l)){let y=Wn(e,t,u,l,o),g=Wn(u,l,i,s,o);return y===void 0||g===void 0?void 0:[y,g]}if(!isFinite(p)){let y=Wn(e,t,c,p,o),g=Wn(c,p,i,s,o);return y===void 0||g===void 0?void 0:[y,g]}if((u===e||u===r)&&(c===r||c===i))return Math.abs(n-t)>Math.abs(s-n)?[e,r]:[r,i];if(u===e||u===r)return GP(e,t,r,n,c,p,i,s);if(c===r||c===i)return GP(e,t,u,l,r,n,i,s);f>d&&f>=m?(i=r,s=n,r=u,n=l):d>f&&d>=m?(e=r,t=n,r=c,n=p):(e=u,t=l,i=c,s=p)}}}var ZN=Ya,sf=Wn,jN=3.154019550531224,kP=Math.pow(2,-13),ro=kP*kP,UP=ro*ro,yh=ro,hh=32,ki=[],no=[];function JN(e,t){for(var r=hh;r>0;r--){var n=jN/hh*r,i=va(n),s=_o(Math.PI/2*i),o=1/(Math.exp(Math.PI/2*i)*s),a=_o(n)/(s*s);e.push(o),t.push(a)}}JN(ki,no);var YP=0;for(of=0;of<no.length;of++)YP+=no[of];var of,af=1/(1+2*YP);function yn(e,t,r){return .5*(t*(2-r)+e*r)}function QN(e,t,r){var n=.5*(t+r),i=ZN(t,e(t),n,e(n),r,e(r),e);return i?.5*(i[0]+i[1]):n}function sl(e,t,r,n,i){return{x1:e,x2:t,value:r,error:n,minerror:i}}function HP(e,t,r){var n=Math.abs(e(yn(t,r,ro))),i=Math.abs(e(yn(t,r,2*ro))),s=Math.abs(e(yn(t,r,4*ro)));return n<ro||i<ro?!1:n>1.95*i&&i>1.95*s}function gh(e,t,r){var n=yn(r,t,ki[0]),i=yn(t,r,ki[0]),s=e(n),o=e(i),a=yn(t,r,1),u=e(a),l,c;if(isFinite(u)&&!isFinite(s)){if(l=sf(n,s,a,u,e),Math.abs((l-t)/(r-t))>yh)return sl(t,r,NaN,NaN,NaN);t=l,s=e(t)}if(isFinite(u)&&!isFinite(o)){if(c=sf(a,u,i,o,e),Math.abs((c-r)/(r-t))>yh)return sl(t,r,NaN,NaN,NaN);r=c,o=e(r)}if(isFinite(s)&&isFinite(o)&&!isFinite(u)){if(l=sf(n,s,a,u,e),c=sf(a,u,i,o,e),Math.abs((c-l)/(r-t))>yh)return sl(t,r,NaN,NaN,NaN);u=.5*(l+c)}if(HP(e,t,r)||HP(e,r,t))return sl(t,r,NaN,NaN,NaN);for(var p=u,f=0,m=0,d=0,y=0,g=0,h=0,P=0;P<hh;P+=4)g=e(yn(t,r,ki[P])),h=e(yn(r,t,ki[P])),y=Math.max(y,Math.abs(g),Math.abs(h)),f+=no[P]*(g+h),g=e(yn(t,r,ki[P+1])),h=e(yn(r,t,ki[P+1])),y=Math.max(y,Math.abs(g),Math.abs(h)),d+=no[P+1]*(g+h),g=e(yn(t,r,ki[P+2])),h=e(yn(r,t,ki[P+2])),y=Math.max(y,Math.abs(g),Math.abs(h)),m+=no[P+2]*(g+h),g=e(yn(t,r,ki[P+3])),h=e(yn(r,t,ki[P+3])),y=Math.max(y,Math.abs(g),Math.abs(h)),d+=no[P+3]*(g+h);var T=p+f,D=T+m,N=D+d,I=Math.abs(m-T),O=Math.abs(d-D),E=af*(r-t)*N,v=af*Math.abs(r-t)*y*no[0],_;return I===0?_=af*Math.abs(r-t)*O:_=af*Math.abs(r-t)*O*(O/I)*(O/I),_=Math.max(_,v),sl(t,r,E,_,v)}function $P(e){for(var t=-1/0,r=-1/0,n=-1,i=0,s=0;s<e.length;s++){var o=e[s];i+=o.value,o.error>t&&(t=o.error,n=s),o.minerror>r&&(r=o.minerror)}return{maxerror:t,maxminerror:r,maxindex:n,totalvalue:i}}function ol(e,t,r,n=32){if(isNaN(t)||isNaN(r))return NaN;var i=1;if(t>r){var s=t;t=r,r=s,i=-1}if(t===1/0&&r===1/0)return NaN;if(t===-1/0&&r===-1/0)return NaN;if(t===-1/0&&r===1/0)return i*ol(function(f){return e(f/((1+f)*(1-f)))*(1+f*f)/((1+f)*(1+f)*(1-f)*(1-f))},-1,1,n);if(t===-1/0)return i*ol(function(f){return-e(r-f/(1-f))/((1-f)*(1-f))},1,0,n);if(r===1/0)return i*ol(function(f){return e(t+f/(1-f))/((1-f)*(1-f))},0,1,n);for(var o=[gh(e,t,r)],a=$P(o),u=1;u<n&&!(Math.abs(a.maxerror/a.totalvalue)<=32*UP||a.maxerror<=32*UP||a.maxerror<=32*a.maxminerror||!isFinite(a.maxerror)||!isFinite(a.maxminerror));u++){var l=o[o.length-1];o[o.length-1]=o[a.maxindex],o[a.maxindex]=l;var c=o.pop(),p=QN(e,yn(c.x2,c.x1,.125),yn(c.x1,c.x2,.125));o.push(gh(e,c.x1,p)),o.push(gh(e,p,c.x2)),a=$P(o)}return!isFinite(a.maxerror)||!isFinite(a.maxminerror)?NaN:Math.abs(a.totalvalue)<=10*a.maxminerror?0:i*a.totalvalue}var al=class{constructor(t){this.comparator=t;this._data=[]}size(){return this._data.length}queue(t){let r=this._data.length;for(this._data.push(t);r>0;){let n=r-1>>>1;if(this.comparator(this._data[r],this._data[n])<0){let i=this._data[n];this._data[n]=this._data[r],this._data[r]=i,r=n}else break}}dequeue(){let t=this._data[0],r=this._data.pop();if(this._data.length>0&&r!==void 0){this._data[0]=r;let n=0,i=this._data.length-1;for(;;){let s=(n<<1)+1,o=s+1,a=n;if(s<=i&&this.comparator(this._data[s],this._data[a])<0&&(a=s),o<=i&&this.comparator(this._data[o],this._data[a])<0&&(a=o),a!==n){let u=this._data[a];this._data[a]=this._data[n],this._data[n]=u,n=a}else break}}return t}peek(){return this._data[0]}clear(){this._data.length=0}};function eD(e,t){let r=e.start[1]-e.end[1],n=e.end[0]-e.start[0],i=t.start[1]-t.end[1],s=t.end[0]-t.start[0],o=r*e.end[0]+n*e.end[1],a=i*t.end[0]+s*t.end[1],u=r*s-i*n;if(u!==0)return(r*a-i*o)/u}function tD(e,t,r){if(r.xSlope>=t.xSlope)return;if(t.scanlineX===r.scanlineX)return e;let n=t.start[1]>t.end[1]?t.start:t.end,i=r.start[1]>r.end[1]?r.start:r.end,s=n[1];if(i[1]<n[1]){if(s=i[1],bh(s,t)<i[0])return}else if(n[1]<i[1]){let a=bh(s,r);if(n[0]<a)return}else if(n[0]<i[0])return;let o=eD(t,r);if(o!==void 0)return Math.max(Math.min(o,s),e)}function bh(e,t){let r=t.end[0],n=t.start[0],i=t.end[1],s=t.start[1];if(i===e)return r;if(s===e)return n;{let o=(e-i)/(s-i),a=(1-o)*r+o*n;if(r<n){if(a<=r)return r;if(n<=a)return n}else{if(a<=n)return n;if(r<=a)return r}return a}}function xh(e){let t=0,r=0,n=!1,i=0;for(let{scanlineX:s,isClockwise:o}of e)o?i+=1:i-=1,i!==0&&!n?(n=!0,r=s):i===0&&n&&(n=!1,t+=s-r);return t}var ul=class{constructor(t){this.scanlineY=-1/0;let r=1;this.activeEdges=[],this.events=new al(function(n,i){return n.y-i.y}),this.scanlineY=-1/0,this.polygonLength=t.length-1;for(let n=t.length-1;n>=1;n--){let i=t[n],s=t[n-1],o={id:r++,index:n-1,end:i,start:s,scanlineX:0,xSlope:1/0,isClockwise:s[1]>i[1],skipIntersectionWith:{}};s[1]>i[1]?(this.events.queue({type:"+",y:i[1],edge:o}),this.events.queue({type:"-",y:s[1],edge:o}),o.xSlope=(s[0]-i[0])/(s[1]-i[1]),o.scanlineX=i[0]):i[1]>s[1]?(this.events.queue({type:"+",y:s[1],edge:o}),this.events.queue({type:"-",y:i[1],edge:o}),o.xSlope=(i[0]-s[0])/(i[1]-s[1]),o.scanlineX=s[0]):this.events.queue({type:"h",y:s[1],edge:o})}}nextScanline(){var s;let t,r=this.events.peek();if(!r)return;if(r.y<=this.scanlineY)throw new Error("Programming error: expected next event to begin a new scanline");this.scanlineY=r.y,this.updateActiveEdgeScanlineIntersections();let n=xh(this.activeEdges),i=[];for(;t=this.events.dequeue();)if(t.type==="x"?this.swapActiveEdges(t):t.type==="+"?this.insertActiveEdge(t):t.type==="-"&&this.removeActiveEdge(t),i.push(t),((s=this.events.peek())==null?void 0:s.y)!==this.scanlineY)return{y:this.scanlineY,activeEdges:this.activeEdges,lengthBeforeProcessingEvents:n,events:i}}updateActiveEdgeScanlineIntersections(){let t=-1/0;for(let r of this.activeEdges){let n=bh(this.scanlineY,r);n<t?n=t:t=n,r.scanlineX=n}}insertActiveEdge(t){let r=this.activeEdges,n=t.edge,i=t.y,{xSlope:s,scanlineX:o}=n;for(var a=0;a<r.length;a++){let u=r[a];if(o<u.scanlineX||o===u.scanlineX&&s<=u.xSlope)break}r.splice(a,0,n),this.checkIntersection(i,r[a-1],n),this.checkIntersection(i,n,r[a+1])}checkIntersection(t,r,n){if(!r||!n||r.index===(n.index+1)%this.polygonLength||n.index===(r.index+1)%this.polygonLength)return;if(r.id<n.id){if(r.skipIntersectionWith[n.id])return}else if(n.skipIntersectionWith[r.id])return;let i=tD(t,r,n);if(i===void 0)return;r.id<n.id?r.skipIntersectionWith[n.id]=!0:n.skipIntersectionWith[r.id]=!0;let s={type:"x",y:i,edge1:r,edge2:n};this.events.queue(s)}removeActiveEdge(t){let r=this.activeEdges,n=t.edge,i=t.y,s=r.indexOf(n);r.splice(s,1),this.checkIntersection(i,r[s-1],r[s])}swapActiveEdges(t){let r=this.activeEdges,n=t.edge1,i=t.edge2,s=t.y,o=r.indexOf(n),a=o+1;o===-1||r[a]!==i?n.id<i.id?delete n.skipIntersectionWith[i.id]:delete i.skipIntersectionWith[n.id]:(r[o]=i,r[a]=n,this.checkIntersection(s,r[o-1],i),this.checkIntersection(s,n,r[a+1]))}static debugEvent(t){let r=`y=${t.y} `;return r+=t.type==="x"?`[x ${t.edge1.index}/${t.edge2.index}]`:`[${t.type} ${t.edge.index}] (${t.edge.end})-(${t.edge.start})`,r}debugState(){return`y=${this.scanlineY}
${this.activeEdges.map(t=>`[${t.index}] ${t.scanlineX}`)}`}};function rD(e){let t=e.slice(0,2),r=e.slice(-2);return t[0]!==r[0]||t[1]!==r[1]?[...e,...t]:e}function vz(e,t){if(!e)return!1;let r=rD(e),[n,i]=t,s=0;for(var o=r.length-1;o>=3;o-=2){let a=r[o-3],u=r[o-2],l=r[o-1],c=r[o];u>i!=c>i&&n<(l-a)*(i-u)/(c-u)+a&&(u>c?s+=1:u<c&&(s-=1))}return s!==0}function XP(e){if(e.length<4||e[0][0]!==e[e.length-1][0]||e[0][1]!==e[e.length-1][1])return 0;let t=new ul(e),r,n=0,i;for(;i=t.nextScanline();){let s=i.lengthBeforeProcessingEvents;r&&(n+=.5*(i.y-r.y)*(s+r.length)),r={y:i.y,length:xh(i.activeEdges)}}return n}function ZP(e){if(!e.length)return[];if(e[0][0]!==e[e.length-1][0]||e[0][1]!==e[e.length-1][1])throw new Error("Programming error: expected last point to be a duplicate of the first point.");for(let f=0;f<e.length-1;f++)if(e[f][0]===e[f+1][0]&&e[f][1]===e[f+1][1])throw new Error(`Programming error: unexpected duplicate point at ${f+1}`);let t=new ul(e),r=e.slice(0,-1).map(()=>0),n;for(;n=t.nextScanline();)for(let f of n.events){let m={};if(f.type==="h"){let d=f.edge;m[d.index]={xMin:Math.min(d.end[0],d.start[0]),xMax:Math.max(d.end[0],d.start[0]),dx:d.end[0]-d.start[0]}}else if(f.type==="x"){let d=f.edge1,y=f.edge2,g=WP([d.start,d.end],[y.start,y.end]),h=g>0?-1:g<0?1:0;r[d.index]+=h,r[y.index]-=h}for(let d of n.activeEdges){let y=d.end[1]-d.start[1];for(let g in m){let{xMin:h,xMax:P,dx:T}=m[g];if(h<d.scanlineX&&d.scanlineX<P){let D=T*y,N=D>0?-1:D<0?1:0;r[g]+=N,r[d.index]-=N}}}}let i=e.slice(0,-1).map(()=>0),s=e[0][1],o=0;for(let f=1;f<e.length;f++)e[f][1]<s&&(s=e[f][1],o=f);let a=e.length-1,u=o>0?o-1:a-1,l=(o+1)%a,p=WP([e[u],e[o]],[e[o],e[l]])>0?1:0;i[o]=p>0?-1:1;for(let f=0;f<a-1;f++){let m=(o+f)%a;p+=r[m],i[(m+1)%a]=p>0?-1:1}return i}function WP(e,t){let r=e[1][0]-e[0][0],n=e[1][1]-e[0][1],i=t[1][0]-t[0][0],s=t[1][1]-t[0][1];return r*s-n*i}var eI={spy:vP},nD=ws,vh=Fo,tI=Bo;function Rr(e,t,r){return Math.max(t,Math.min(r,e))}function rI(e,t){let r=e%t;return e*t<0&&r!==0?r+t:r}function nI(e,t){e=Math.round(e),t=Math.round(t);let r=vh(e,t);return Math.abs(e/r*t)}function iD(e){if(e.length===0)return NaN;let t=e[0];for(let r=1;r<e.length;r++)t=vh(t,e[r]);return t}function sD(e){if(e.length===0)return NaN;let t=e[0];for(let r=1;r<e.length;r++)t=nI(t,e[r]);return t}function io(e,t){if(isNaN(e))return e;if(isNaN(t))return t;if(!isFinite(e)&&!isFinite(t))return NaN;if(t===0||e===t)return 1;if(e===0)return yi(t);let r=isFinite(e)&&e===Math.round(e),n=isFinite(t)&&t===Math.round(t);if(e<0&&t<0&&e-t<0)return r&&n?0:yi(e-t)*yi(t)/(yi(e)*io(-e,-t));if(e<0&&t>0&&e-t<0)return r&&n?Math.pow(-1,t)*io(t-e-1,t):yi(e-t)/yi(e)*io(-(e-t),t);if(e<0&&t<0&&e-t>0)return r&&n?Math.pow(-1,e-t)*io(-t-1,e-t):yi(t)/yi(e)*io(-t,-e);if(e>0&&t<0&&e-t>0){let a=Math.abs(e)>Math.abs(t)?-t:e;return yi(t)/io(e-t,a)}if(e>0&&t>0&&e-t<0)return yi(e-t)/io(t,e);if(e<0||t<0||e-t<0||e<15&&t<15&&e-t<15)return cf(e,t)/ua(t);let i=_n(e)-_n(t)-_n(e-t)-(e-t)*as(-t/e),s=Math.sqrt(e/(2*Math.PI*t*(e-t)))*Math.pow(e/t,t)*Math.exp(i);return r&&n&&e>0&&t>0&&e-t>0?Math.round(s):s}function cf(e,t){if(isNaN(e))return e;if(isNaN(t))return t;if(!isFinite(e)&&!isFinite(t))return NaN;if(t===0)return 1;if(e===0)return 1/ua(-t);let r=isFinite(e)&&e===Math.round(e),n=isFinite(t)&&t===Math.round(t);if(e<0&&e-t<0)return r&&n?Math.pow(-1,t)*cf(t-e-1,t):yi(e-t)/yi(e)*cf(-(e-t),t);if(e<0||e-t<0||e<15&&e-t<15)return ua(e)/ua(e-t);let i=_n(e)-_n(e-t)-(e-t)*as(-t/e),s=Math.sqrt(e/(e-t))*Math.pow(e/Math.E,t)*Math.exp(i);return r&&n&&e>0&&t>0&&e-t>0?Math.round(s):s}function ua(e){return pl(e+1)}function pl(e){if(e===-1/0)return NaN;let t=Math.round(e)===e;if(e<0)return t?1/0:Math.PI/(fI(e)*pl(1-e));if(e>170)return 1/0;let r;return e<15?r=iI(e):e<120?r=oD(e):r=Math.exp(sI(e)),t?Math.round(r):r}function iI(e){let t=4.077131788261185,r=7.024675027156382,n=6.657107767450176,i=3.766266976716022,s=1.2792371666711133,o=.24304596436338005,a=.020049769312165774,u=4.154347453162709,l=7.270007565107539,c=6.97805297331391,p=3.989651532924167,f=1.367176195613119,m=.26175627691546965,d=.021742722739397567,y=1+e*(t+e*(r+e*(n+e*(i+e*(s+e*(o+e*a)))))),g=1+e*(u+e*(l+e*(c+e*(p+e*(f+e*(m+e*d))))));return Math.E*Math.pow((1+e)/Math.E,1+e)/(e*Math.sqrt(1+e))*(y/g)}function oD(e){let t=e-1;return Math.pow(t,t)*Math.exp(Oh(t)-t)*Math.sqrt(2*Math.PI*t)}function sI(e){let t=e-1;return t*(Math.log(t)-1)+.5*Math.log(2*Math.PI*t)+Oh(t)}function aD(e){return e<0?NaN:e<15?Math.log(iI(e)):sI(e)}var oI=[1/6,-1/30,1/42,-1/30,5/66,-691/2730,7/6,-3617/510,43867/798,-174611/330,854513/138,-236364091/2730,8553103/6,-23749461029/870];function aI(e,t){if(e!==Math.floor(e))return NaN;if(e<0)return NaN;if(e===0)return 1/pI(t);let r=Sr(t);if(e===1)return-1/(r*r);let n=tn(t);if(e===2)return 2*n/(r*r*r);let i=[0,2],s=[];for(let a=3;a<=e;a++){s=[];for(let u=0;u<a;u++){let l=0,c=0;u>0&&(l=(a-u+1)*i[u-1]),u+2<a&&(c=(u+1)*i[u+1]),s.push(-(l+c))}i=s}let o=0;for(let a=e-1;a>=0;a--)o=s[a]+n*o;return o/Math.pow(r,e+1)}function uI(e,t){if(e<0)return NaN;if(e!==Math.floor(e))return NaN;let r=e%2===0?-1:1;if(t<0)return-r*uI(e,1-t)-Math.pow(Math.PI,e+1)*aI(e,Math.PI*t);let n=ua(e),i=0,s=Math.pow(t,-(e+1));for(;t<10;)i+=s,t++,s=Math.pow(t,-(e+1));i+=e===0?-Math.log(t):s*t/e,i+=.5*s;let o=oI,a=e+1,u=2,l=s*t*a/u,c=1/(t*t);for(let p=1;p<=14;p++)l*=c,i+=l*o[p-1],a++,u++,l*=a/u,a++,u++,l*=a/u;return n*r*i}function uD(e){let t=Math.log(e);return Math.exp(Math.round(t))===e?Math.round(t):t}function lI(e,t){if(t===0)return NaN;let r;return t===Math.E?r=Math.log(e):t===2&&Math.log2?r=Math.log2(e):t===10&&Math.log10?r=Math.log10(e):r=Math.log(e)/Math.log(t),Math.pow(t,Math.round(r))===e?Math.round(r):r}function lD(e){return lI(e,10)}function cD(e,t){return tI(e,1/t)}var cI=1/Math.PI;function yf(e){return e>1e12?!1:Math.round(cI*e)*Math.PI===e}function gf(e){if(e>1e12)return!1;let t=Math.round(2*cI*e);return t%2===1&&t*Math.PI===2*e}function Sr(e){return yf(Math.abs(e))?0:Math.sin(e)}function tn(e){return gf(Math.abs(e))?0:Math.cos(e)}function pI(e){let t=Math.abs(e);return yf(t)?0:gf(t)?1/0:Math.tan(e)}function pD(e){return gf(Math.abs(e))?1/0:1/Math.cos(e)}function fD(e){return yf(Math.abs(e))?1/0:1/Math.sin(e)}function dD(e){let t=Math.abs(e);return yf(t)?1/0:gf(t)?0:1/Math.tan(e)}function mD(e){return e>0?Math.atan(1/e):Math.PI/2-Math.atan(e)}function yD(e){return Math.asin(1/e)}function gD(e){return Math.acos(1/e)}function hD(e){return 1/_o(e)}function bD(e){return 1/va(e)}function xD(e){return 1/jl(e)}function TD(e){return Jl(1/e)}function PD(e){return Ql(1/e)}function ID(e){return Kl(1/e)}function fI(e){if(e===0||isNaN(e))return e;if(!isFinite(e))return NaN;if(e===Math.floor(e))return e>0?0:-0;let t=Math.round(2*e),r=-.5*t+e,n=t&2?-1:1,i=t&1?Math.cos(Math.PI*r):Math.sin(Math.PI*r);return n*i}function yi(e){return e===1/0||e===-1/0?0:e===0?1:fI(e)/(Math.PI*e)}function Ms(e){let t=0;for(let r=0;r<e.length;r++)t+=e[r];return t/e.length}function MD(e){let t=0;for(let r=0;r<e.length;r++)t+=e[r];return t}function Ph(e){return e>50?Math.exp(.5*((1-e)*as(-1/(e-1))-1)+_n(.5*(e-1))-_n(.5*(e-2)))*Math.sqrt((1-1/e)/(2*Math.PI)):pl((e+1)/2)/(pl(e/2)*Math.sqrt(e*Math.PI))}function Xa(e,t,r=e-t){if(Math.abs(r)<.1*(e+t)){let n=r/(e+t),i=r*r/(e+t),s=2*e*n;for(let o=1;o<10;o++){s*=n*n;let a=i+s/(2*o+1);if(a==i)return a;i=a}}return e*Math.log(e/t)+t-e}var ED=[0,.08106146679532726,.0413406959554093,.02767792568499834,.020790672103765093,.016644691189821193,.013876128823070748,.01189670994589177,.010411265261972096,.009255462182712733,.00833056343336287,.007573675487951841,.00694284010720953,.006408994188004207,.0059513701127588475,.005554733551962801];function _n(e){return e>15?Oh(e):e<0?NaN:e===Math.floor(e)?ED[e]:Math.log(ua(e)/(Math.pow(e,e)*Math.exp(-e)*Math.sqrt(2*Math.PI*e)))}function Oh(e){let t=.08333333333333333,r=.002777777777777778,n=.0007936507936507937,i=.0005952380952380953,s=.0008417508417508417,o=e*e;return(t-(r-(n-(i-s/o)/o)/o)/o)/e}function hf(e,t){return t<=0?NaN:Ph(t)*Math.pow(1+e*e/t,-((t+1)/2))}function aa(e,t){if(t>0)return 1-aa(e,-t);if(t===-1/0)return 0;if(t===0)return .5;if(e>=40&&t>-1)return .5+Ph(e)*vD(e,t);if(t/e<-1e3){let n=t*t;return Ph(e)*Math.pow(e,.5*(e-1))*Math.pow(Math.abs(t),-e)*(1-e*e*(e+1)*(1/(2+e)+e*(e+3)/(4*(4+e)*n))/(2*n))}let r=Math.sqrt(t*t+e);return OD((t+r)/(2*r),e/2,e/2)}function vD(e,t){let r=t*t/e,n=t,i=n;for(let s=1;s<=15;s++)n*=-(2*s-1)/(2*s+1)*(.5*(e+1)+s-1)/s*r,i+=n;return i}function uf(e,t,r){return r<=0?NaN:e===-1/0?aa(r,t):e>0&&t>0?aa(r,-e)-aa(r,-t):aa(r,t)-aa(r,e)}function OD(e,t,r){if(e<0||e>1)throw new RangeError("First argument must be between 0 and 1.");if(t===1&&r===1)return e;if(e===0)return 0;if(e===1)return 1;if(t===0)return 1;if(r===0)return 0;{let n=_n(t+r)-_n(t)-_n(r)-Xa(t,(t+r)*e)-Xa(r,(t+r)*(1-e),(t+r)*e-t),i=Math.exp(n)*Math.sqrt(t*r/(2*Math.PI*(t+r)));return e<(t+1)/(t+r+2)?i*jP(e,t,r)/t:1-i*jP(1-e,r,t)/r}}function jP(e,t,r){let n=Math.pow(2,-52),i=1e-300,s=t+r,o=t+1,a=t-1,u=1,l=1-s*e/o;Math.abs(l)<i&&(l=i),l=1/l;let c=l;for(let p=1;p<=100;p++){let f=2*p,m=p*(r-p)*e/((a+f)*(t+f));l=1+m*l,Math.abs(l)<i&&(l=i),u=1+m/u,Math.abs(u)<i&&(u=i),l=1/l,c*=l*u,m=-(t+p)*(s+p)*e/((t+f)*(o+f)),l=1+m*l,Math.abs(l)<i&&(l=i),u=1+m/u,Math.abs(u)<i&&(u=i),l=1/l;let d=l*u;if(c*=d,Math.abs(d-1)<=n)return c}return c}function SD(e,t){let r=Math.pow(2,-52),n=1e-300,i=1,s=e,o=i/s,a=i/n,u=1/s,l=2,c=0,p=s,f=-(e-1),m=0;do f-=1,p+=1,u=u*f*t+p,u===0&&(u=n),a=p+f*t/a,a===0&&(a=n),u=1/u,c=a*u,o=o*c,m+=1,p+=1,u=u*m*t+p,u===0&&(u=n),a=p+m*t/a,a===0&&(a=n),u=1/u,c=a*u,o*=c,l+=2;while(l<100&&Math.abs(c-1)>r);return o}function ND(e,t){let r=Math.pow(2,-52),n=1e-300,i=1,s=t+1-e,o=i/s,a=i/n,u=1/s,l=2,c=0,p=s;do{let f=-(l-1)*(l-e-1);p+=2,u=u*f+p,u===0&&(u=n),a=p+f/a,a===0&&(a=n),u=1/u,c=a*u,o*=c,l+=1}while(l<100&&Math.abs(c-1)>r);return o}function DD(e,t){let r=t/e,n=Oa(t-e)*Math.sqrt(2*Xa(1,r)),i=[1,-.3333333333333333,.08333333333333333,-.014814814814814815,.0011574074074074073,.0003527336860670194,-.0001787551440329218,3919263178522438e-20,-2185448510679992e-21,-185406221071516e-20,8296711340953087e-22,-17665952736826078e-23,6707853543401498e-24,10261809784240309e-24,-4382036018453353e-24,914769958223679e-24,-25514193994946248e-27,-5830772132550426e-26,24361948020667415e-27,-50276692801141755e-28,11004392031956135e-29,3371763262400985e-28,-1392388722418162e-28,28534893807047445e-30,-5139111834242572e-31,-19752288294349442e-31,8099521156704561e-31],s=i.length-2,o=0,a=0,u=0,l=0;for(;s>=0;s--)u=(s+2)*o/e+i[s+1],l=n*l+u,o=a,a=u;if(l=e/(e+o)*l,t<e){let c=Math.exp(-.5*e*n*n)*(.5*Us(-n*Math.sqrt(e/2))-l/Math.sqrt(2*Math.PI*e));return isFinite(c)?1-c:1}else{let c=Math.exp(-.5*e*n*n)*(.5*Us(n*Math.sqrt(e/2))+l/Math.sqrt(2*Math.PI*e));return isFinite(c)?c:0}}function JP(e,t,r){return(e-t)/(Math.SQRT2*Math.abs(r))}function ll(e){return e<0?.5*Math.exp(-e*e)*Us(-e):1-.5*Math.exp(-e*e)*Us(e)}function AD(e,t,r,n){let i=JP(t,r,n);if(e===-1/0)return ll(i);let s=JP(e,r,n);return e>0&&t>0?ll(-s)-ll(-i):ll(i)-ll(s)}function Sh(e,t,r){return 1/Math.sqrt(2*Math.PI*r*r)*Math.exp(-(e-t)*(e-t)/(2*r*r))}function Nh(e){let t=eI.spy(e),r=parseInt(t.slice(0,8),16)&2097151,n=parseInt(t.slice(8,16),16);return(r*4294967296+n)/9007199254740992}function dI(e,t){for(let r=t.length-1;r>0;r--){let n=e+"::sc"+r,i=Math.floor(Nh(n)*(r+1)),s=t[r];t[r]=t[i],t[i]=s}}function RD(e,t){let r=t.slice();return dI(e,r),r}function Dh(e,t){let r=[];for(let n=0;n<t;n++)r.push(n);return dI(e,r),r}function so(e,t,r){return Nh(e)*(r-t)+t}function CD(e,t,r){let n=0,i,s,o,a;do i=e+"::sc"+n,n+=1,s=so(i,0,1)*2-1,i=e+"::sc"+n,n+=1,o=so(i,0,1)*2-1,a=s*s+o*o;while(a>=1||a===0);let u=Math.sqrt(-2*Math.log(a)/a);return t+r*s*u}function LD(e,t){if(t<=0)return NaN;let r=0,n,i,s,o;do n=e+"::sc"+r,r+=1,i=so(n,0,1)*2-1,n=e+"::sc"+r,r+=1,s=so(n,0,1)*2-1,o=i*i+s*s;while(o>1);let a=i*i/o,u=t*(Math.pow(o,-2/t)-1);return n=e+"::sc"+r,r+=1,(so(n,0,1)<.5?-1:1)*Math.sqrt(a*u)}function wD(e,t,r){return t=Rr(Math.round(t),0,1/0),t===1/0?NaN:(r=Rr(r,0,1),yI(so(e,0,1),t,r))}function _D(e,t){return t<0?NaN:mI(so(e,0,1),t)}function lf(e,t,r){return e>=t?1:e<0?0:e<Math.floor((t+1)*r)?QP(e,t,r):1-QP(t-e-1,t,1-r)}function QP(e,t,r){let n=(1-r)/r,i=bf(e,t,r),s=i;for(;e>0&&(i*=e/(t-e+1)*n,s+i!==s);e--)s+=i;return s}function FD(e,t,r,n){return r=Rr(Math.round(r),0,1/0),r===1/0?NaN:(n=Rr(n,0,1),t<0?0:(e=Math.ceil(e),t=Math.floor(t),e===-1/0?lf(t,r,n):lf(t,r,n)-lf(e-1,r,n)))}function bf(e,t,r){if(e=Math.round(e),t=Rr(Math.round(t),0,1/0),t===1/0)return NaN;if(r=Rr(r,0,1),e<0||e>t)return 0;if(r===0)return e===0?1:0;if(r===1)return e===t?1:0;if(e===0)return Math.exp(t*as(-r));if(e===t)return Math.pow(r,t);let n=_n(t)-_n(e)-_n(t-e)-Xa(e,t*r)-Xa(t-e,t*(1-r),t*r-e);return Math.exp(n)*Math.sqrt(t/(2*Math.PI*e*(t-e)))}function Za(e,t){return t<0?NaN:(e=Math.round(e),e<0?0:t===0?e===0?1:0:e===0?Math.exp(-t):Math.exp(-_n(e)-Xa(e,t))/Math.sqrt(2*Math.PI*e))}function cl(e,t){if(isNaN(e)||isNaN(t))return NaN;if(e===1/0)return 1;if(e=Math.floor(e),e<0)return 0;if(t===0)return 1;if(e+1>12&&2.35*(e+1)>t&&.3*(e+1)<t)return DD(e+1,t);if(e+1>=t){let r=SD(e+1,t);return isFinite(r)?1-t*Za(e,t)*r:1}else{let r=ND(e+1,t);return isFinite(r)?t*Za(e,t)*r:0}}function BD(e,t,r){return r<0?NaN:(e=Math.ceil(e),t=Math.floor(t),t<0?0:e===-1/0?cl(t,r):cl(t,r)-cl(e-1,r))}function Ah(e,t,r){return r<=t?NaN:e<t||e>r?0:1/(r-t)}function KP(e,t,r){return r<=t?NaN:e<t?0:e>r?1:(e-t)/(r-t)}function VD(e,t,r,n){return KP(t,r,n)-KP(e,r,n)}function GD(e){let t=-e*e;return t<-750?e>=0?1:-1:e>=.065?1-Math.exp(t)*Us(e):e<=-.065?Math.exp(t)*Us(-e)-1:e*(1.1283791670955126+t*(.37612638903183754+t*(.11283791670955126+t*(.026866170645131252+t*.005223977625442188))))}function Us(e){let t=.9999999999999999,r=2.224574423459406,n=2.444115549920689,i=1.7057986861852539,s=.8257463703357973,o=.28647031042892007,a=.07124513844341643,u=.012296749268608364,l=.001347817214557592,c=7263959403471071e-20,p=1,f=3.352953590554884,m=5.227518529742423,d=5.003720878235473,y=3.266590890998987,g=1.5255421920765353,h=.5185887413188858,P=.12747319185915415,T=.02185979575963238,D=.0023889438122503674,N=.00012875032817508128;if(e<0)return e<-6.1?2*Math.exp(e*e):2*Math.exp(e*e)-Us(-e);if(e>50){let I=.5641895835477563,O=e*e;return e>5e7?I/e:I*(O*(O+4.5)+2)/(e*(O*(O+5)+3.75))}else{let I=t+e*(r+e*(n+e*(i+e*(s+e*(o+e*(a+e*(u+e*(l+e*c)))))))),O=p+e*(f+e*(m+e*(d+e*(y+e*(g+e*(h+e*(P+e*(T+e*(D+e*N)))))))));return I/O}}function Rh(e){let t=-39.6968302866538,r=220.946098424521,n=-275.928510446969,i=138.357751867269,s=-30.6647980661472,o=2.50662827745924,a=-54.4760987982241,u=161.585836858041,l=-155.698979859887,c=66.8013118877197,p=-13.2806815528857,f=-.00778489400243029,m=-.322396458041136,d=-2.40075827716184,y=-2.54973253934373,g=4.37466414146497,h=2.93816398269878,P=.00778469570904146,T=.32246712907004,D=2.445134137143,N=3.75440866190742,I=.02425,O,E,v;return e>.5?-Rh(1-e):e===.5?0:e<0?NaN:e===0?-1/0:(e<I?(O=Math.sqrt(-2*Math.log(e)),v=(((((f*O+m)*O+d)*O+y)*O+g)*O+h)/((((P*O+T)*O+D)*O+N)*O+1)):(O=e-.5,E=O*O,v=(((((t*E+r)*E+n)*E+i)*E+s)*E+o)*O/(((((a*E+u)*E+l)*E+c)*E+p)*E+1)),v-Math.sqrt(2*Math.PI)*(.5*Us(-v/Math.SQRT2)-Math.exp(.5*v*v)*e))}function mI(e,t){if(t<0||e<0||e>1)return NaN;if(t===0||e===0)return 0;if(e===1)return 1/0;let r=-1,n=Math.ceil(t);for(;cl(n,t)<e;)n=2*n;let i=Math.floor(r+(n-r)/2);for(;r<i&&i<n;)cl(i,t)<e?r=i:n=i,i=Math.floor(r+(n-r)/2);return n}function yI(e,t,r){if(t!==Math.round(t))return NaN;if(r<0||r>1)return NaN;if(e<0||e>1)return NaN;if(e===0)return 0;if(e===1)return t;if(t===0)return 0;if(r===1)return t;if(r===0)return 0;let n=-1,i=t,s=Math.floor(n+(i-n)/2);for(;n<s&&s<i;)lf(s,t,r)<e?n=s:i=s,s=Math.floor(n+(i-n)/2);return i}function gI(e,t){if(isNaN(t)||t<=0||e<0||e>1)return NaN;if(e===0)return-1/0;if(e===1)return 1/0;if(t===1||t===2||t===4)return Th(t,e);let r,n;if(e===.5)return 0;if(e>.5)r=t>1?Rh(e):Th(1,e),n=t>1?Th(1,e):Math.pow(hf(0,t)*Math.pow(t,(t-1)/2)/(1-e),1/t);else return-gI(1-e,t);return zD(t,e,r,n)}function Th(e,t){let r=4*t*(1-t);switch(e){case 1:return Math.tan(Math.PI*(t-.5));case 2:return 2*(t-.5)*Math.sqrt(2/r);case 4:let n=Math.cos(Math.acos(Math.sqrt(r))/3)/Math.sqrt(r);return Oa(t-.5)*2*Math.sqrt(n-1);default:throw new Error("_invTSimple() must be called with 1, 2, or 4 df.")}}function zD(e,t,r,n){if(!isFinite(r)||!isFinite(n))return NaN;let i=r,s=n;for(;;){let o=Zn(i,s),a=aa(e,o);if(o===i||o===s)return a>t?i:s;a<t?i=o:s=o}}function qD(e,t,r){return e<0||e>1||r<=t?NaN:e===0?t:e===1?r:t+e*(r-t)}function hI(e,t){let r=pf(e);return(Ms(e)-t)*Math.sqrt(e.length)/r}function bI(e,t){let r=e.length,n=Ms(e),i=pf(e),s=t.length,o=Ms(t),a=pf(t),u=Math.sqrt(((r-1)*i*i+(s-1)*a*a)/(r+s-2));return(n-o)/(u*Math.sqrt(1/r+1/s))}function Wa(e,t,r){return r<0?uf(-1/0,e,t):r>0?uf(-1/0,-e,t):2*uf(-1/0,-Math.abs(e),t)}function Ch(e,t){arguments.length===1&&(t=0);let r=hI(e,t),n=e.length-1;return{lessThan:Wa(r,n,-1),greaterThan:Wa(r,n,1),notEqual:Wa(r,n,0)}}function Lh(e,t){let r=bI(e,t),n=e.length+t.length-2;return{lessThan:Wa(r,n,-1),greaterThan:Wa(r,n,1),notEqual:Wa(r,n,0)}}function wh(e){return{min:xI(e),q1:la(e,1),median:II(e),q3:la(e,3),max:TI(e)}}function kD(e){return e.length}function xI(e){if(e.length<1)return NaN;let t=e[0];if(isNaN(t))return NaN;for(let r=1;r<e.length;r++){if(isNaN(e[r]))return NaN;e[r]<t&&(t=e[r])}return t}function TI(e){if(e.length<1)return NaN;let t=e[0];if(isNaN(t))return NaN;for(let r=1;r<e.length;r++){if(isNaN(e[r]))return NaN;e[r]>=t&&(t=e[r])}return t}function PI(e,t){if(!isFinite(t)||t<0||t>1)return NaN;if(e.some(isNaN))return NaN;if(e.length===0)return NaN;let r=e.length,n=ca(e),i=t*(r-1);return Math.floor(i)===i?e[n[i]]:(Math.ceil(i)-i)*e[n[Math.floor(i)]]+(i-Math.floor(i))*e[n[Math.ceil(i)]]}function la(e,t){if(!isFinite(t)||t<0||t>4)return NaN;if(e.some(isNaN))return NaN;let r=ca(e),n=xf(e,t),i=Math.floor(n),s=Math.ceil(n);return(e[r[i]]+e[r[s]])/2}function ca(e){let t=e.length,r=[];for(let n=0;n<t;n++)r.push(n);return r.sort(function(n,i){return V(_i(e[n],e[i]))}),r}function xf(e,t){t=Math.round(t);let r=e.length,n=r%2===1,i;return r===1?0:(t===0&&(i=0),t===2&&(i=(r-1)/2),t===4&&(i=r-1),t===1&&(i=n?(r+1)/4-1:(r+2)/4-1),t===3&&(i=n?(3*r+3)/4-1:(3*r+2)/4-1),i===void 0?NaN:i)}function UD(e,t){return ca(e)[Math.ceil(t*(e.length-1))]+1}function HD(e,t){return ca(e)[Math.floor(t*(e.length-1))]+1}function $D(e,t){return ca(e)[Math.ceil(xf(e,t))]+1}function YD(e,t){return ca(e)[Math.floor(xf(e,t))]+1}function II(e){return PI(e,.5)}function WD(e){if(e.length<1)return 0;let t=e[0];if(isNaN(t))return 0;let r=0;for(let n=1;n<e.length;n++){if(isNaN(e[n]))return 0;e[n]<t&&(r=n,t=e[n])}return r+1}function XD(e){if(e.length<1)return 0;let t=e[0];if(isNaN(t))return 0;let r=0;for(let n=1;n<e.length;n++)if(e[n]>=t){if(isNaN(e[n]))return 0;r=n,t=e[n]}return r+1}function dl(e){let t=Ms(e),r=0;for(let n=0;n<e.length;n++){let i=e[n]-t;r+=i*i}return r/e.length}function ZD(e){let t=Ms(e),r=0;for(let n=0;n<e.length;n++)r+=Math.abs(e[n]-t);return r/e.length}function MI(e){let t=e.length;return dl(e)*t/(t-1)}function EI(e,t){let r=Math.min(e.length,t.length);e.length!==r&&(e=e.slice(0,r)),t.length!==r&&(t=t.slice(0,r));let n=Ms(e),i=Ms(t),s=0;for(let o=0;o<r;o++)s+=(e[o]-n)*(t[o]-i);return s/r}function jD(e,t){let r=Math.min(e.length,t.length);return EI(e,t)*r/(r-1)}function Tf(e,t){let r=Math.min(e.length,t.length);e.length!==r&&(e=e.slice(0,r)),t.length!==r&&(t=t.slice(0,r));let n=Ms(e),i=Ms(t),s=0,o=0,a=0;for(let u=0;u<r;u++){let l=e[u]-n,c=t[u]-i;s+=l*l,o+=c*c,a+=l*c}return a/Math.sqrt(s*o)}function _h(e,t,r,n){let i=e[0];for(let o=2;o<e.length;o++){let a=V(Fi(_i(e[o],i),r));if(!Kr(a,o,10))return 0}let s=V(n);for(let o=0;o<t.length-1;o++){let a=V(Fi(_i(t[o],i),r));if(!Kr(a,s-t.length+o,10))return 0}return!isFinite(s)||s<e.length||s<t.length?0:s}function Fh(e){return e<0||!isFinite(e)?0:e}function Ih(e){let t=e.length;if(t===0)return[];let r=[],n=[];for(let a=0;a<t;a++)n.push([e[a],a]);n.sort(function(a,u){let l=a[0],c=u[0];return l===1/0&&c===1/0||l===-1/0&&c===-1/0?0:l-c});let i=0,s=1,o=1;for(;i<t;){let a=i;for(;a<t-1&&n[a][0]===n[a+1][0];)a+=1;o=a-i+1;let u;for(a=0;a<o;a++)u=n[i+a][1],r[u]=isNaN(e[u])?NaN:s+.5*(o-1);s+=o,i+=o}return r}function JD(e,t){let r=Math.min(e.length,t.length);return e.length!==r&&(e=e.slice(0,r)),t.length!==r&&(t=t.slice(0,r)),Tf(Ih(e),Ih(t))}function pf(e){return Math.sqrt(MI(e))}function QD(e){return Math.sqrt(dl(e))}var KD=ol;function ml(e,t){return ci(t[0]-e[0],t[1]-e[1])}function eA(e,t){return ci(t[0]-e[0],ci(t[1]-e[1],t[2]-e[2]))}function vI(e,t,r){return[Rr(Math.round(e),0,255),Rr(Math.round(t),0,255),Rr(Math.round(r),0,255)]}function tA(e,t,r){e=Rr(e,0,360),t=Rr(t,0,1),r=Rr(r,0,1);let n=r*(1-t/2);n===0||n===1?t=0:t=(r-n)/Math.min(n,1-n);let{r:i,g:s,b:o}=rf(e,t,n).rgb();return vI(i,s,o)}function rA(e){return e}function nA(e,t){return[e,t]}function iA(e,t,r){return[e,t,r]}function sA(e,t){return[e,t]}function oA(e){return e}function aA(e){let t=[];if(e.length===0)return[];for(let r=0;r<e.length-1;r++)t.push([e[r],e[r+1]]);return t.push([e[e.length-1],e[0]]),t}function Bh(e){if(e.length==0)return 0;let t=[...e,e[0]];return XP(t)}function uA(e){let t=0;for(let r=0;r<e.length-1;r++){let[n,i]=e[r],[s,o]=e[r+1];t+=pi(s-n,o-i)}if(e.length>1){let[r,n]=e[e.length-1],[i,s]=e[0];t+=pi(i-r,s-n)}return t}function lA(e){let t=!1;for(let r=0;r<e.length;r++){let n=(r+1)%e.length;e[r][0]===e[n][0]&&e[r][1]===e[n][1]&&(t=!0)}return t?e.filter((r,n)=>{let i=e[n===0?e.length-1:n-1];return r[0]!==i[0]||r[1]!==i[1]}):e}function cA(e){let[t,r,n,i]=e;return[t,n>=0?r:r+n,n>=0?n:-n,i]}function OI(e,t,r){if(e.length===0)return[];e=lA(e);let n=ZP([...e,e[0]]),i=[];for(let s=0;s<e.length;s++){let o=e[s>0?s-1:e.length-1],a=e[s],u=e[s<e.length-1?s+1:0],l=n[s]===1,c=vA(o,a,u,l?"counterclockwise":"clockwise",r);i.push(t?c:cA(c))}return i}function pA(e,t){return OI(e,!1,t)}function fA(e,t){return OI(e,!0,t)}function Vh(e,t){return[e,t]}var dA=Vh,mA=Vh;function yA(e){return e}function gA(e,t){return[e,t]}function hA(e){return e[0]}function bA(e){return e[1]}function xA(e,t,r){return[e,t,r]}function Qa([e,t,r]){let[n,i]=e,[s,o]=t,[a,u]=r,l=s*s+o*o,c=(n*n+i*i-l)/2,p=(l-a*a-u*u)/2,f=(n-s)*(o-u)-(s-a)*(i-o);f=1/f;let m=(c*(o-u)-p*(i-o))*f,d=((n-s)*p-(s-a)*c)*f;return[m,d]}function Ka(e){let[[t,r],[n,i],[s,o]]=e,a=n-t,u=i-r,l=s-n,c=o-i;return 2*Math.atan2(a*c-l*u,a*l+u*c)}function Gh(e){let t=Math.abs(Ka(e));return t<1e-9||t>2*Math.PI-1e-9}function SI(e){return Math.abs(e)===Math.PI?Math.PI:rI(e+Math.PI,2*Math.PI)-Math.PI}function NI(e,t,r,n){return[e,SI(t),r,n]}function TA([e,t,r,n]){return[e,t,r,n]}function PA(e){return e[2]}function IA(e){return e[3]}function DI(e){let[t,r,n,i]=e,s=Math.PI*2,o=n===0?s:n>0?n-s:n+s;return[t,r,o,i]}function MA(e){let[t,r,n,i]=DI(e);return[t,r,n,i]}function EA(e){let[t,r,n,i]=e,s=n>=0?Math.PI-n:-Math.PI-n;return[t,SI(r+n),s,i]}function vA(e,t,r,n,i){let s=e[0]-t[0],o=e[1]-t[1],a=r[0]-t[0],u=r[1]-t[1],l=Math.atan2(o,s),c=Math.atan2(s*u-o*a,s*a+o*u),p=2*Math.PI;return n==="clockwise"?c-=c<0?0:p:n==="counterclockwise"&&(c+=c<0?p:0),NI(t,l,c,i)}function zh(e,t){let[[r,n],[i,s]]=e;return[[t*r,t*n],[t*i,t*s]]}var OA=zh,SA=zh;function NA(e,t){let[[r,n],i]=e;return[[t*r,t*n],t*i]}function DA(e,t){let[[r,n],[i,s],[o,a]]=e;return[[t*r,t*n],[t*i,t*s],[t*o,t*a]]}function AA(e,t){let[[r,n],i,s,o]=e;return[[t*r,t*n],t*i,t*s,o]}function qh(e,t){let[[r,n],[i,s]]=e,[[o,a],[u,l]]=t;return[[r+o,n+a],[i+u,s+l]]}var RA=qh,CA=qh;function LA(e,t){let[[r,n],i]=e,[[s,o],a]=t;return[[r+s,n+o],i+a]}function wA(e,t){let[[r,n],[i,s],[o,a]]=e,[[u,l],[c,p],[f,m]]=t;return[[r+u,n+l],[i+c,s+p],[o+f,a+m]]}function _A(e,t){let[[r,n],i,s,o]=e,[[a,u],l,c]=t;return[[r+a,n+u],i+l,s+c,o]}function kh(e,t){let[[r,n],[i,s]]=e;return[(1-t)*r+t*i,(1-t)*n+t*s]}function Uh(e,t){return kh(e,Rr(t,0,1))}function Mh(e,t){return kh(e,Rr(t,0,1/0))}function FA(e,t){let[[r,n],i]=e,s=Math.min(1,Math.max(0,t));return[r+i*Math.cos(2*Math.PI*s),n+i*Math.sin(2*Math.PI*s)]}function AI(e,t){let r=Pf(e);if(!r)return[NaN,NaN];if(r.type==="segment")return Uh([e[0],e[2]],t);if(r.type==="rays")return t<=0?Mh([r.start1,r.end1],-t):t>=1?Mh([r.start2,r.end2],t-1):[NaN,NaN];t=Math.min(1,Math.max(0,t));let n=Qa(e),i=Ka(e),s=Math.atan2(e[0][1]-n[1],e[0][0]-n[0]),o=ml(n,e[0]),a=s+t*i;return[n[0]+o*Math.cos(a),n[1]+o*Math.sin(a)]}function BA(e,t){if(isNaN(t))return[NaN,NaN];if(t<0||t>=e.length)return e[0];let r=Math.floor(t);return Uh([e[r],e[(r+1)%e.length]],t-r)}function Pf(e){let[t,r,n]=e,[[i,s],[o,a],[u,l]]=[t,r,n];if(isNaN(i)||isNaN(s)||isNaN(o)||isNaN(a)||isNaN(u)||isNaN(l))return;let c=Qa([t,r,n]),p=ml(c,t);if(isFinite(p)&&!Gh([t,r,n])){let f=Math.atan2(t[1]-c[1],t[0]-c[0]),m=f+Ka([t,r,n]);return{type:"arc",center:c,radius:p,startAngle:f,endAngle:m}}else{let f=wi(o,a,0,i,s,0,u,l,0);return f<0||f>1?{type:"rays",start1:[i,s],end1:[i+(i-u),s+(s-l)],start2:[u,l],end2:[u+(u-i),l+(l-s)]}:{type:"segment",start:[i,s],end:[u,l]}}}function VA(e,t,r){let[i,s]=[t,r].map(u=>ml(e,u));if(isNaN(i))return s>1e-9?r:t;if(isNaN(s))return i>1e-9?t:r;let[o,a]=i>s?[i,t]:[s,r];return o>1e-9?a:e}function fl(e,t){let[[r,n],i]=e,[[s,o],a]=t,u=ci(s-r,o-n),l=i+a,c=i-a,p=u*u,f=Math.sqrt((u+l)*(-u+l)*(u-c)*(u+c))/4,m=i*i,d=a*a;return[(s+r)/2+(s-r)*(m-d)/(2*p)+-2*(o-n)*f/p,(o+n)/2+(o-n)*(m-d)/(2*p)+2*(s-r)*f/p]}function RI(e,t,r){let[[n,i],s]=e,[[o,a],[u,l]]=t,c=o-n,p=u-n,f=a-i,m=l-i,d=p-c,y=m-f,g=d*d+y*y,h=c*m-p*f,P=s*s*g-h*h;if(P<0)return[NaN,NaN];let T=Math.sqrt(P);return T<0?[NaN,NaN]:[n+(h*y+r*d*T)/g,i+(-h*d+r*y*T)/g]}function GA(e,t){let[[r,n],[i,s]]=e,[[o,a],[u,l]]=t,c=s-n,p=r-i,f=l-a,m=o-u,d=c*r+p*n,y=f*o+m*a,g=c*m-f*p;return g===0?[NaN,NaN]:[(m*d-p*y)/g,(c*y-f*d)/g]}function Hh(e,t,r=0){let n=RI(t,e,-1);return Ja(n,e,r,!0)?n:[NaN,NaN]}function CI(e,t,r=0){let n=RI(e,t,1);return Ja(n,t,r,!1)?n:[NaN,NaN]}function LI(e,t,r=0){let n=GA(e,t);return!Ja(n,e,r,!0)||!Ja(n,t,r,!1)?[NaN,NaN]:n}function zA(e,t,r=0){let n=FI(t,e,r,-1);return ja(n,t,r,!1)?n:[NaN,NaN]}function wI(e,t,r=0){let n=BI(t,e,r,-1);return!Ja(n,e,r,!0)||!ja(n,t,r,!1)?[NaN,NaN]:n}function qA(e,t,r=0){let n=FI(e,t,r,1);return ja(n,e,r,!0)?n:[NaN,NaN]}function _I(e,t,r=0){let n=BI(e,t,r,1);return!ja(n,e,r,!0)||!Ja(n,t,r,!1)?[NaN,NaN]:n}function kA(e,t,r=0){let n=UA(e,t,r);return!ja(n,e,r,!0)||!ja(n,t,r,!1)?[NaN,NaN]:n}function UA(e,t,r){let n=df(e);if(mf(n))return wI(n,t,r);let i=df(t);return mf(i)?_I(e,i,r):$h(()=>fl(n,i),()=>fl(i,n),s=>Yh(-1,ff(e,s),ff(t,s)))}function FI(e,t,r,n){let i=df(e);return mf(i)?Hh(i,t,r):$h(()=>fl(i,t),()=>fl(t,i),s=>Yh(n,ff(e,s),HA(t,s)))}function BI(e,t,r,n){let i=df(e);return mf(i)?LI(i,t,r):$h(()=>CI(i,t,r),()=>Hh(t,i,r),s=>Yh(n,ff(e,s),$A(t)))}function $h(e,t,r){let n=e();if(r(n))return n;let i=t();return r(i)?i:[NaN,NaN]}function Yh(e,t,r){return e*VI(t,r)>0}function ff(e,[t,r]){let[n,i]=Qa(e);return Ka(e)>0?[i-r,t-n]:[r-i,n-t]}function HA([[e,t]],[r,n]){return[t-n,r-e]}function $A([[e,t],[r,n]]){return[r-e,n-t]}function df(e){let t=Qa(e),r=ml(t,AI(e,0));return isFinite(r)&&!Gh(e)?[t,r]:[e[0],e[2]]}function mf(e){return Array.isArray(e[1])}function ja([e,t],r,n,i){let[s,o]=Qa(r);return(i?(n&3)===0:(n&12)===0)||rc(Math.atan2(t-o,e-s),Math.atan2(r[0][1]-o,r[0][0]-s),Ka(r))}function Ja([e,t],[[r,n],[i,s]],o,a){let u=wi(e,t,0,r,n,0,i,s,0),[l,c]=a?[(o&1)===0,(o&2)===0]:[(o&4)===0,(o&8)===0];return!isNaN(u)&&(u>=0||l)&&(u<=1||c)}function YA(e,t){let[[r,n],[i,s]]=e,[o,a]=t;return[[o,a],[o+(i-r),a+(s-n)]]}function WA(e,t){let[[r,n],[i,s]]=e,[o,a]=t;return[[o,a],[o+(s-n),a-(i-r)]]}function VI(e,t){let[r,n]=e,[i,s]=t;return r*s-i*n}function XA(e,t){let[r,n]=e,[i,s]=t;return r*i+n*s}function ZA(e){let[t,r]=e;return[-r,t]}function jA(e,t,r){return[e,t,r]}function JA(e){return[[1,0],e,!1]}function QA(e,t){let[r,n]=e;return[[t,0],[(1-t)*r,(1-t)*n],!1]}function KA(e,t){let[r,n]=e,i=Math.cos(t),s=Math.sin(t);return[[i,s],[r*(1-i)+n*s,n*(1-i)-r*s],!1]}function eR(e){let[[t,r],[n,i]]=e,s=n-t,o=i-r,a=s*s+o*o;return[[(s*s-o*o)/a,2*s*o/a],[(1-(s*s-o*o)/a)*t-2*s*o/a*r,(1+(s*s-o*o)/a)*r-2*s*o/a*t],!0]}function tR(e,t){let[[r,n],[i,s],o]=e,[[a,u],[l,c],p]=t;return o&&(u=-u,c=-c,p=!p),[[a*r-u*n,a*n+u*r],[i+r*l-n*c,s+r*c+n*l],p]}function rR(e){let[[t,r],[n,i],s]=e,o=t*t+r*r,a=t/o,u=-r/o,l=-(t/o*n+r/o*i),c=-(t/o*i-r/o*n);return s&&(u=-u,c=-c),[[a,u],[l,c],s]}function Is(e,t){let[[r,n],[i,s],o]=e,[a,u]=t;return o&&(u=-u),[r*a-n*u+i,r*u+n*a+s]}function nR(e,t){let[r,n,i]=e;return Is([r,[0,0],i],t)}function iR(e,t){let[r,n,i]=e;return i?-t:t}function Wh(e,t){let[r,n]=t;return[Is(e,r),Is(e,n)]}var sR=Wh,oR=Wh;function aR(e,t){let[r,n]=t,[[i,s]]=e;return[Is(e,r),ci(i,s)*n]}function uR(e,t){let[r,n,i]=t;return[Is(e,r),Is(e,n),Is(e,i)]}function lR(e,t){let r=[];for(let n of t)r.push(Is(e,n));return r}function cR(e,t){let[r,n,i]=t,s=Is(e,r),[o,a]=nR(e,[Math.cos(n),Math.sin(n)]),u=Math.atan2(a,o),l=iR(e,i);return[s,u,l]}function pR(e,t){let r=[];for(let n=0;n<e.length;n++)t[n]&&r.push(e[n]);return r}function fR(e,t){let r=[];for(let n of t)r.push(e[n]);return r}function dR(e){let t=[],r={};for(let n=0;n<e.length;n++){let i=e[n],s=Eh(i);r.hasOwnProperty(s)||(r[s]=!0,t.push(n))}return t}function Eh(e){if(Array.isArray(e))return`[${e.map(Eh).join(",")}]`;switch(typeof e){case"string":return e;case"boolean":case"number":return e.toString();case"object":if(mR(e)){let r=[];for(let n in e.updateRules)r.push(`"${n}": ${Eh(e.updateRules[n].value)}`);return`{${r.join(",")}}`}else return V(e).toString();default:return e}}function mR(e){return typeof e!="object"||!e?!1:e.type==="Action"}function rn(e){if(!Hi(e))throw new Error("Programming error: expected an array but found "+typeof e)}function Hi(e){return Array.isArray(e)}function GI(e){if(Hi(e))for(let{compiled:t}of e)t&&Xh(t)}function _z(e){if(Hi(e))for(let{compiled:t}of e)t&&yR(t)}function Xh(e){delete e.fn}function yR(e){e.fn=Zh(e.args,e.source,e.constants)}function Zh(e,t,r){let i="return (function("+e.join(",")+'){"use strict"; '+t+"})";return new Function("BuiltIn","ErrorMsg","_C",i)(Ui,nr,r)}function me(e){return e.type<=3}function zI(e){return!me(e)}function gn(e){switch(e.type){case 21:case 23:case 19:return!0;default:return!1}}function Cr(e){switch(e.type){case 20:case 22:case 24:return!0;default:return!1}}function kI(e){let t="",r=(e.instructionsLength()-1).toString().length,n=0,i=!1;for(let s=0;s<e.instructionsLength();s++){let o=e.getInstruction(s),a=e.comments[s]||"",u=o.type===0&&o.removedInstructionForDebuggingOnly;if((Cr(o)||u&&Cr(u))&&(n-=1),o.type===0&&!u)i||(t+=`${qI(s,r)}: ${Qh(2*n)}...
`),i=!0;else{i=!1;let l=u?" [X]":"    ";t+=`${qI(s,r)}:${l} ${Qh(2*n)}${pa(e,s)}${a?`		# ${a}`:""}
`}(gn(o)||u&&gn(u))&&(n+=1)}return t}function pa(e,t){let r=e.getInstruction(t);switch(r.type===0&&r.removedInstructionForDebuggingOnly&&(r=r.removedInstructionForDebuggingOnly),r.type){case 0:return Fn(r.type);case 2:return`${Fn(r.type)} ${pn(r.valueType)} ${e.argNames[t]}`;case 3:return`${Fn(r.type)} ${pn(r.valueType)}`;case 1:return`${Fn(r.type)} ${pn(r.valueType)} ${Jh(r.value)}`;case 37:case 42:return`${Fn(r.type)} ${pn(r.valueType)} ${r.symbol} ${r.args.join(" ")}`;case 44:return`${Fn(r.type)} ${pn(r.valueType)} ${r.tag} ${r.args.join(" ")}`;case 48:return`${Fn(r.type)} ${pn(r.valueType)} ${r.args.join(" ")}${r.isConstantBroadcast?" (constant)":""}`;case 8:case 9:case 10:case 11:case 13:case 12:case 14:case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 23:case 24:case 25:case 26:case 27:case 28:case 29:case 32:case 33:case 38:case 39:case 40:case 41:case 47:case 49:return`${Fn(r.type)} ${pn(r.valueType)} ${r.args.join(" ")}`;default:let n=r;throw new Error(`Unexpected opcode ${n.type}`)}}function Fn(e){switch(e){case 0:return"Noop";case 1:return"Constant";case 8:return"Add";case 9:return"Subtract";case 10:return"Multiply";case 11:return"Divide";case 12:return"Exponent";case 13:return"RawExponent";case 14:return"Negative";case 15:return"OrderedPair";case 17:return"OrderedPairAccess";case 16:return"OrderedTriple";case 18:return"OrderedTripleAccess";case 19:return"BeginLoop";case 20:return"EndLoop";case 21:return"BeginIntegral";case 22:return"EndIntegral";case 23:return"BeginBroadcast";case 24:return"EndBroadcast";case 25:return"Equal";case 26:return"Less";case 27:return"Greater";case 28:return"LessEqual";case 29:return"GreaterEqual";case 32:return"And";case 33:return"Piecewise";case 38:return"List";case 39:return"ListAccess";case 40:return"DeferredListAccess";case 41:return"InboundsListAccess";case 37:return"NativeFunction";case 42:return"Distribution";case 2:return"LoadArg";case 47:return"BlockVar";case 48:return"BroadcastResult";case 3:return"SymbolicVar";case 44:return"ExtendSeed";case 49:return"Action";default:let t=e;throw new Error(`Unexpected opcode ${t.type}`)}}function Jh(e){if(Array.isArray(e))return`[${e.map(Jh).join(",")}]`;switch(typeof e){case"string":return e;case"boolean":case"number":return e.toString();case"object":if(sa(e)){let t=[];for(let r in e.updateRules)t.push(`"${r}": ${Jh(e.updateRules[r].value)}`);return`{${t.join(", ")}}`}else return`${e.n}/${e.d}`;default:throw new Error("Unexpected value: "+e)}}function qI(e,t){let r=e.toString();return Qh(t-r.length)+r}function Qh(e){let t="";for(let r=0;r<e;r++)t+=" ";return t}function At(e){return e.type===1}function UI(e){if(!At(e))throw new Error(`Programming error: expected constant instruction but found ${Fn(e.type)} instead.`)}function gR(e){return e.type===48&&e.isConstantBroadcast}function oo(e){return At(e)||gR(e)}function Mf(e,t,r){let n=e.getInstruction(r);if(!me(n)){for(let o of n.args)if(!oo(e.getInstruction(o)))return!0}if(t<r)return!oo(e.getInstruction(t));let i=[!0];for(let o=r+1;o<=t;o++)i.push(!1);let s=[t];for(;s.length;){let o=s.pop();if(i[o-r])continue;i[o-r]=!0;let a=e.getInstruction(o);if(!me(a))for(let u of a.args)if(u<r){if(!oo(e.getInstruction(u)))return!0}else i[u-r]||s.push(u)}return!1}function Kh(e,t,r){if(k(t)){let n=[];for(let i=0;i<r.length;i++)n.push(Kh(e,ke(t),r[i]));return e.ConstantOfType(t,n)}switch(t){case x:return e.Constant(r);case Ie:return e.ConstantOfType(t,r);case A:return e.ConstantOfType(t,r);case G:return e.ConstantOfType(t,r);case tt:return e.ConstantOfType(t,r);default:throw new Error("Cannot reconstitute value of a "+te(t)+".")}}function $i(e,t,r){let n=Wt(e,t);if(n===void 0)throw new Error(`${r}
Non-constant instruction: "${pa(e,Ur(e,t))}"`);return n}function Wt(e,t){let r=eu(e,t);if(!(r<0))return r}function eu(e,t,r){var o;let n=r&&r[t];if(n)return n;let i=e.getInstruction(t),s;switch(i.type){case 38:s=i.args.length;break;case 1:s=i.value.length;break;case 48:{s=(o=i.constantLength)!=null?o:-1;break}}return s===void 0&&(r=r||{},s=hR(e,i,r)),r&&(r[t]=s),s}function hR(e,t,r){switch(t.type){case 33:{let n=eu(e,t.args[1],r),i=eu(e,t.args[2],r);return n===i?n:-1}case 37:switch(t.symbol){case"elementsAt":return eu(e,t.args[1],r);case"sortPerm":return eu(e,t.args[0],r);case"shuffle":return eu(e,t.args[1],r);default:return-1}default:{if(k(t.valueType))return-1;throw new Error(`Programming Error: cannot find the list length of ${Fn(t.type)} ${te(t.valueType)}.`)}}}function Ur(e,t){let r=e.getInstruction(t);if(!k(r.valueType))throw new Error(`Programming Error: cannot find the list length of ${e.printInstruction(t)}`);switch(r.type){case 38:return e.Constant(r.args.length);case 1:return e.Constant(r.value.length);case 48:{let n=e.getInstruction(r.args[0]);return e.getInstruction(n.args[0]).args[0]}case 37:switch(r.symbol){case"elementsAt":return Ur(e,r.args[1]);case"sortPerm":return Ur(e,r.args[0]);case"shuffle":return Ur(e,r.args[1])}}return e.SyntheticNativeFunction("count",[t])}function yl(e,t){let r=[];for(let o of t)k(e.getInstruction(o).valueType)&&r.push(o);if(r.length===0)return;if(r.length===1)return Ur(e,r[0]);let n=[];for(let o of r)n.push(Wt(e,o));let i,s=1/0;for(let o=0;o<n.length;o++){let a=r[o],u=n[o];if(u===void 0)return e.SyntheticNativeFunction("min",[e.List(r.map(l=>Ur(e,l)))]);u<s&&(i=a,s=u)}return i!==void 0?Ur(e,i):e.Constant(s)}function HI(e,t){if(k(e)){let r=ke(e);for(let n=0;n<t.length;n++)if(jn(r,t[n]))return!0;return!1}return jn(e,t)}function jn(e,t){switch(e){case x:return Rn(t);case A:{let[r,n]=t;return Rn(r)||Rn(n)}case G:{let[r,n,i]=t;return Rn(r)||Rn(n)||Rn(i)}case tt:{let[r,n,i]=t;return Rn(r)||Rn(n)||Rn(i)}case Te:{for(let r of t)if(jn(A,r))return!0;return!1}case pe:case ne:case Pe:{let[r,n]=t;return jn(A,r)||jn(A,n)}case ie:{let[r,n]=t;return jn(A,r)||jn(x,n)}case ee:{let[r,n,i]=t;return jn(A,r)||jn(A,n)||jn(A,i)}case de:case oe:{let[r,n,i]=t;return jn(A,r)||jn(x,n)||jn(x,i)}case Ze:return Object.keys(t.updateRules).length===0;case Ie:return!1;default:throw new Error("Type cannot contain a NaN value: "+te(e)+".")}}function eb(e,t){return us(e,t)}function tb(e,t){return _i(e,t)}function rb(e,t){return ls(e,t)}function nb(e,t){return Fi(e,t)}function gl(e,t){return V(e)===Math.E?Math.exp(V(t)):Yd(e,t)}var bR=gl;function ib(e){return qn(e)}function xR(e,t){return[e,t]}function TR(e,t){return e[V(t)-1]}function PR(e,t,r){return[e,t,r]}function IR(e,t){return e[V(t)-1]}function sb(e,t){return V(e)===V(t)}function ob(e,t){return V(e)<V(t)}function ab(e,t){return V(e)>V(t)}function ub(e,t){return V(e)<=V(t)}function lb(e,t){return V(e)>=V(t)}function $I(e,t){return e&&t}function MR(e,t,r){let n=Math.floor(V(r))-1;return!isFinite(n)||n<0||n>=t.length?$n(e):t[n]}function cb(e,t,r){return kt(r)&&(r=V(r)),`${t}::${e}${r}`}function pb(e,t){switch(e){case"mod":return mT(t[0],t[1]);case"abs":return fT(t[0]);case"sqrt":return dT(t[0]);case"nthroot":return nc(t[0],t[1]);case"total":return yT(t[0]);case"count":return t[0].length;case"validateRangeLength":{let r=t[0],n=t[1],i=t[2],s=t[3],o=_h(r,n,i,s);if(o===0)throw $u();return o}case"validateSampleCount":{let r=qi(t[0]),n=Fh(r);if(n===0&&r!==0)throw Ug();return n}case"select":case"elementsAt":case"uniquePerm":case"sortPerm":{let r=gr[e];return Ui[r.symbol].apply(null,t)}default:{let r=gr[e];return(r.module==="Math"?Math:Ui)[r.symbol].apply(null,qi(t))}}}function Ef(e,t){let r=Array(t+1);return Ne(e,t,r)}function YI(e,t,r){let n=Array(t+1);for(let i=0;i<r.length;i++)n[i]=r[i];return Ne(e,t,n)}function WI(e,t,r){let n=Array(t+1);return vf(e,t,r,n)}function XI(e,t,r){let n=Array(t+1),i=[];for(let s of r)i.push(vf(e,t,s,n));return i}function ZI(e,t,r){if(t.constantLength)return t.constantLength;let n=t.args[0],s=e.getInstruction(n).args[0],o=e.getInstruction(s);return V(Ne(e,o.args[0],r))}function vf(e,t,r,n){let i=e.getInstruction(t),s=ZI(e,i,n);if(!isFinite(r)||r<0||r>=s)return $n(ke(i.valueType));let o=i.args[0],a=t-o,u=e.getInstruction(o),l=u.args[0],c=u.args[a];n[l]=r+1;let p=Ne(e,c,n);for(let f=l;f<=o;f++)n[f]=void 0;return p}function ER(e,t,r){let n=e.getInstruction(t),i=ZI(e,n,r),s=[];for(let o=i-1;o>=0;o--)s[o]=vf(e,t,o,r);return s}function jI(e,t,r){let n=Ne(e,t.args[1],r),i=t.args[0],s=e.getInstruction(i);if(s.type===48)return vf(e,i,V(n)-1,r);if(s.type===33){let o=Ne(e,s.args[0],r);return jI(e,ue(X({},t),{args:[o?s.args[1]:s.args[2],t.args[1]]}),r)}else{let o=Ne(e,t.args[0],r);return MR(t.valueType,o,n)}}function Ne(e,t,r){let n=r[t];if(n!==void 0)return n;let i=vR(e,t,r);return typeof i=="number"&&i===Math.floor(i)&&(i=he(i,1)),r[t]=i,i}function vR(e,t,r){let n=e.getInstruction(t);switch(n.type){case 1:return n.value;case 8:return eb(Ne(e,n.args[0],r),Ne(e,n.args[1],r));case 9:return tb(Ne(e,n.args[0],r),Ne(e,n.args[1],r));case 10:return rb(Ne(e,n.args[0],r),Ne(e,n.args[1],r));case 11:return nb(Ne(e,n.args[0],r),Ne(e,n.args[1],r));case 12:return gl(Ne(e,n.args[0],r),Ne(e,n.args[1],r));case 13:return bR(Ne(e,n.args[0],r),Ne(e,n.args[1],r));case 14:return ib(Ne(e,n.args[0],r));case 15:return xR(Ne(e,n.args[0],r),Ne(e,n.args[1],r));case 16:return PR(Ne(e,n.args[0],r),Ne(e,n.args[1],r),Ne(e,n.args[2],r));case 17:return TR(Ne(e,n.args[0],r),Ne(e,n.args[1],r));case 18:return IR(Ne(e,n.args[0],r),Ne(e,n.args[1],r));case 25:return sb(Ne(e,n.args[0],r),Ne(e,n.args[1],r));case 26:return ob(Ne(e,n.args[0],r),Ne(e,n.args[1],r));case 27:return ab(Ne(e,n.args[0],r),Ne(e,n.args[1],r));case 28:return ub(Ne(e,n.args[0],r),Ne(e,n.args[1],r));case 29:return lb(Ne(e,n.args[0],r),Ne(e,n.args[1],r));case 32:return Ne(e,n.args[0],r)&&Ne(e,n.args[1],r);case 44:return cb(n.tag,Ne(e,n.args[0],r),Ne(e,n.args[1],r));case 33:return Ne(e,n.args[0],r)?Ne(e,n.args[1],r):Ne(e,n.args[2],r);case 37:{let s=[];for(let o of n.args)s.push(Ne(e,o,r));return pb(n.symbol,s)}case 38:{let s=[];for(let o of n.args)s.push(Ne(e,o,r));return s}case 39:case 40:case 41:return jI(e,n,r);case 48:return ER(e,t,r);case 47:{let s=n.args[0],o=e.getInstruction(s).args[0],a=t-s,l=e.getInstruction(s).args[a],c=[];c[l]=!0;for(let m=l;m>=o;m--){if(!c[m])continue;let d=e.getInstruction(m);if(!me(d))for(let y of d.args)y<o?Ne(e,y,r):c[y]=!0}let p=e.copy();p.truncate(o);for(let m=0;m<o;m++){let d=r[m],y=e.getInstruction(m);if(d!==void 0){let g=y.valueType;p.replaceInstructionWithConstant(m,{type:1,valueType:g,value:d})}}p.reopenAllBlocks();let f=[];for(let m=o;m<t;m++){let d=e.getInstruction(m);if(me(d))f.push(p.copyInstruction(d));else{let y=[];for(let g of d.args)y.push(g<o?g:f[g-o]);d.type===40?f.push(p.InboundsListAccess(y)):f.push(p.copyInstructionWithArgs(d,y))}}return p.Noop(),p.replaceInstructionWithBlockVar(p.getReturnIndex(),{type:47,valueType:n.valueType,args:[s<o?s:f[s-o]]}),p.close().getCompiledFunction().fn()}case 19:case 20:case 21:case 22:case 23:case 24:case 42:case 0:case 2:case 3:case 49:throw new Error(`Programming Error: cannot interpret opcode ${n.type}`);default:let i=n;throw new Error(`Programming Error: unexpected opcode ${i.type}`)}}function Xr(e,t){let r=[],n=[];for(let i=0;i<t;i++)n.push(!1);n.push(!0);for(let i=t;i>=0;i--){if(!n[i])continue;let s=e.getInstruction(i);if(s.type===2)r.push({symbol:e.argNames[i],scope:"free"});else if(gn(s))switch(s.type){case 21:r.push({symbol:s.callData.indexSymbol,scope:"integral"});break;case 19:r.push({symbol:s.callData.indexSymbol,scope:s.callData.type});break;case 23:if(s.listComprehensionCallData)for(let a of s.listComprehensionCallData.inputListSymbols)r.push({symbol:a,scope:"comprehension"});break;default:let o=s;throw new Error(`Programming Error: unexpected loop instruction ${o.type}`)}else s.type===3&&s.symbol&&r.push({symbol:s.symbol,scope:"symbolic-var"});if(!me(s))for(let o of s.args)n[o]=!0}return r.reverse()}function Nr(e,t){let r=e.getInstruction(t);if(r.type!==48)return t;if(r.isConstantBroadcast)return JI(e,t,r);let n=r.args[0],i=e.getInstruction(n),s=i.args[0],o=!1;for(let l=s+1;l<n;l++){let c=e.getInstruction(l);if(c.type===40&&c.args[1]===s){o=!0;break}}if(!o)return t;let a=[];for(let l=s;l<=n+i.args.length-1;l++){let c=e.getInstruction(l);if(me(c))a.push(e.copyInstruction(c));else{let p=[];for(let f of c.args)p.push(f>=s?a[f-s]:f);c.type===40?a.push(e.InboundsListAccess(p)):a.push(e.copyInstructionWithArgs(c,p))}}let u=e.getInstruction(e.getReturnIndex());return u.type===48&&u.isConstantBroadcast?JI(e,e.getReturnIndex(),u):e.getReturnIndex()}function JI(e,t,r){if(r.valueType===Qt){let i=Wt(e,t);if(i==null)throw Ju(Xr(e,t));let s=[];for(let o=0;o<i;o++){let a=e.InboundsListAccess([t,e.Constant(o+1)]);s.push(a)}return e.List(s)}let n=Ef(e,t);return t===e.getReturnIndex()&&e.popInstruction(),e.ConstantOfType(r.valueType,n)}function hl(e,t,r){let n=e.getInstruction(t);if(k(n.valueType)){let i=Wt(e,t);if(r=Math.floor(r),isNaN(r)||r<0||i!==void 0&&r>=i){let s=ke(n.valueType);return e.NanOfType(s)}return n.type===38?n.args[r]:n.type===1&&k(n.valueType)?e.ConstantOfType(ke(n.valueType),n.value[r]):n.type===48&&n.isConstantBroadcast?e.ConstantOfType(ke(n.valueType),WI(e,t,r)):i!==void 0?e.InboundsListAccess([t,e.Constant(r+1)]):e.ListAccess([t,e.Constant(r+1)])}else{if(n.valueType===A)return isNaN(r)||r<0||r>2?e.Constant(NaN):n.type===15?n.args[r]:n.type===1?e.Constant(n.value[r]):e.OrderedPairAccess([t,e.Constant(r+1)]);if(n.valueType===G)return isNaN(r)||r<0||r>3?e.Constant(NaN):n.type===16?n.args[r]:n.type===1?e.Constant(n.value[r]):e.OrderedTripleAccess([t,e.Constant(r+1)]);throw new Error(`Cannot access elements of ${te(n.valueType)}`)}}function Of(e,t,r){let n=e.getInstruction(t);if(r.length===0)return e.ConstantOfType(n.valueType,[]);if(n.type===1&&k(n.valueType)){let i=[],s=ke(n.valueType);for(let o of r){let a=Math.floor(o);isNaN(a)||a<0||a>=$i(e,t,"Programming error: expected Constant list instruction to have constant length.")?i.push($n(s)):i.push(n.value[a])}return e.ConstantOfType(n.valueType,i)}else if(n.type===38){let i=[];for(let s of r){let o=Math.floor(s);if(isNaN(o)||o<0||o>=$i(e,t,"Programming error: expected List instruction to have constant length.")){let a=ke(n.valueType);i.push(e.NanOfType(a))}else i.push(n.args[o])}return e.List(i)}else{if(n.type===48&&n.isConstantBroadcast)return e.ConstantOfType(n.valueType,XI(e,t,r));{let i=[],s=!0,o=Wt(e,t);for(let u of r){let l=Math.floor(u);i.push(e.Constant(l+1)),(isNaN(l)||l<0||o===void 0||l>=o)&&(s=!1)}let a=[t,e.List(i)];return s?e.InboundsListAccess(a):e.ListAccess(a)}}}function KI(e){if(e.instructionsLength()-1!==e.getReturnIndex())throw new Error("Programming Error: only the final instruction in a chunk can be constant collapsed");let t=e.getInstruction(e.getReturnIndex());if(me(t))return e.getReturnIndex();switch(t.type){case 8:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.Constant(eb(n.value,i.value))):n.type===1&&V(n.value)===0?(e.popInstruction(),t.args[1]):i.type===1&&V(i.value)===0?(e.popInstruction(),t.args[0]):e.getReturnIndex()}case 9:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.Constant(tb(n.value,i.value))):n.type===1&&V(n.value)===0?(e.popInstruction(),e.Negative([t.args[1]])):i.type===1&&V(i.value)===0?(e.popInstruction(),t.args[0]):e.getReturnIndex()}case 10:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.Constant(rb(n.value,i.value))):n.type===1&&V(n.value)===1?(e.popInstruction(),t.args[1]):i.type===1&&V(i.value)===1?(e.popInstruction(),t.args[0]):e.getReturnIndex()}case 11:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.Constant(nb(n.value,i.value))):i.type===1&&V(i.value)===1?(e.popInstruction(),t.args[0]):e.getReturnIndex()}case 12:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);if(n.type===1&&i.type===1)return e.popInstruction(),e.Constant(gl(n.value,i.value));if(n.type===1&&n.valueType===x){let s=V(n.value);if(s===Math.E)return e.popInstruction(),e.SyntheticNativeFunction("exp",[t.args[1]]);if(s>0)return e.popInstruction(),e.RawExponent(t.args)}if(i.type===1&&i.valueType===x){let s=V(i.value);if(s===1)return e.popInstruction(),t.args[0];if(s===Math.floor(s))return e.popInstruction(),e.RawExponent(t.args);if(kt(i.value)){let{n:o,d:a}=i.value;if(a%2===1){e.popInstruction();let u=e.RawExponent([e.SyntheticNativeFunction("abs",[t.args[0]]),t.args[1]]);return o%2===0?u:e.Multiply([e.SyntheticNativeFunction("sign",[t.args[0]]),u])}}}return e.getReturnIndex()}case 13:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.Constant(gl(n.value,i.value))):i.type===1&&V(i.value)===1?(e.popInstruction(),t.args[0]):e.getReturnIndex()}case 14:{let n=e.getInstruction(t.args[0]);return n.type===1?(e.popInstruction(),e.Constant(ib(n.value))):e.getReturnIndex()}case 25:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.ConstantOfType(Ie,sb(n.value,i.value))):e.getReturnIndex()}case 26:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.ConstantOfType(Ie,ob(n.value,i.value))):e.getReturnIndex()}case 27:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.ConstantOfType(Ie,ab(n.value,i.value))):e.getReturnIndex()}case 28:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.ConstantOfType(Ie,ub(n.value,i.value))):e.getReturnIndex()}case 29:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.ConstantOfType(Ie,lb(n.value,i.value))):e.getReturnIndex()}case 32:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&i.type===1?(e.popInstruction(),e.ConstantOfType(Ie,$I(n.value,i.value))):e.getReturnIndex()}case 33:{let n=e.getInstruction(t.args[0]);return n.type===1?(e.popInstruction(),n.value?t.args[1]:t.args[2]):e.getReturnIndex()}case 17:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===15&&i.type===1?(e.popInstruction(),n.args[V(i.value)-1]):n.type===1&&n.valueType===A&&i.type===1?(e.popInstruction(),e.Constant(n.value[V(i.value)-1])):e.getReturnIndex()}case 18:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===16&&i.type===1?(e.popInstruction(),n.args[V(i.value)-1]):n.type===1&&n.valueType===G&&i.type===1?(e.popInstruction(),e.Constant(n.value[V(i.value)-1])):e.getReturnIndex()}case 38:{if(SR(e,t.args)){e.popInstruction();let n=[];for(let i of t.args)n.push(e.getInstruction(i).value);return e.ConstantOfType(t.valueType,n)}return e.getReturnIndex()}case 39:case 41:{let n=t.args[0],i=e.getInstruction(n),s=e.getInstruction(t.args[1]);if(i.type===33&&s.type===1){let o=t.type===39?e.ListAccess([i.args[1],t.args[1]]):e.InboundsListAccess([i.args[1],t.args[1]]),a=t.type===39?e.ListAccess([i.args[2],t.args[1]]):e.InboundsListAccess([i.args[2],t.args[1]]);return e.Piecewise([i.args[0],o,a])}if(i.type===48){if(s.type===1&&i.isConstantBroadcast&&i.valueType!==Qt)return e.ConstantOfType(t.valueType,Ef(e,e.getReturnIndex()));e.popInstruction();let o=i.args[0],a=n-o,u=e.getInstruction(o),l=u.args[0],c,p;if(t.type===41)c=t.args[1];else{let m=Wt(e,n);if(s.type===1&&s.valueType===x&&m!==void 0){let d=V(s.value),y=Math.floor(d);if(y<1||y>m)return e.NanOfType(t.valueType);c=d===y?t.args[1]:e.Constant(y)}else{let d=e.Constant(1),g=e.getInstruction(l).args[0],h=e.SyntheticNativeFunction("floor",[t.args[1]]),P=e.GreaterEqual([h,d]),T=e.LessEqual([h,g]);c=e.Piecewise([P,e.Piecewise([T,h,g]),d]),p={one:d,lengthIndex:g,roundedIndex:h,greaterEqualIndex:P,lessEqualIndex:T}}}if(u.args[a]<l)return u.args[a];let f=[c];for(let m=l+1;m<=u.args[a];m++){let d=e.getInstruction(m);if(me(d))f.push(e.copyInstruction(d));else{let y=[];for(let g of d.args)y.push(g>=l?f[g-l]:g);d.type===40?f.push(e.InboundsListAccess(y)):f.push(e.copyInstructionWithArgs(d,y))}}if(p){let{greaterEqualIndex:m,lessEqualIndex:d,lengthIndex:y,one:g}=p,h=ke(i.valueType),P=e.NanOfType(h),T=f[f.length-1],D=e.And([e.And([m,d]),e.GreaterEqual([y,g])]);return e.Piecewise([D,T,P])}else return f[f.length-1]}else if(s.type===1&&s.valueType===x)if(i.type===38){e.popInstruction();let o=Math.floor(V(s.value))-1;return isNaN(o)||o<0||o>=i.args.length?e.NanOfType(t.valueType):i.args[o]}else if(i.type===1){e.popInstruction();let o=Math.floor(V(s.value))-1;return isNaN(o)||o<0||o>=i.value.length?e.NanOfType(t.valueType):e.ConstantOfType(ke(i.valueType),i.value[o])}else return e.getReturnIndex();else return e.getReturnIndex()}case 47:{let n=e.getInstruction(t.args[0]);if(!Cr(n)||Mf(e,e.getReturnIndex(),n.args[0]))return e.getReturnIndex();let i=e.copy();i.close();let s=i.getCompiledFunction().fn();return e.popInstruction(),Kh(e,t.valueType,s)}case 37:switch(t.symbol){case"nthroot":{let n=QI(e,t.args);if(n!==void 0)return e.Constant(nc(n[0],n[1]));{let i=e.getInstruction(t.args[1]);if(i.type===1&&i.valueType===x)return e.Exponent([t.args[0],e.Constant(Ou(i.value))])}return e.getReturnIndex()}case"count":{let n=Wt(e,t.args[0]);return n!==void 0?(e.popInstruction(),e.Constant(n)):e.getReturnIndex()}case"select":if(At(e.getInstruction(t.args[1]))){e.popInstruction();let n=Nt(e,t.args[1]),i=[];for(let s=0;s<n.length;s++)n[s]&&i.push(s);return Of(e,t.args[0],i)}else return e.getReturnIndex();case"shuffle":{let n=t.args[0],i=t.args[1],s=Wt(e,i);if(s!==void 0&&At(e.getInstruction(n))){e.popInstruction();let o=Dh(Nt(e,n),s);return Of(e,i,o)}else return e.getReturnIndex()}case"elementsAt":{let n=t.args[0],i=t.args[1];if(At(e.getInstruction(i))){e.popInstruction();let s=Nt(e,i);return Of(e,n,s)}return e.getReturnIndex()}default:{let n=QI(e,t.args);return n===void 0?e.getReturnIndex():(e.popInstruction(),e.ConstantOfType(t.valueType,pb(t.symbol,n)))}}case 44:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return At(n)&&At(i)?e.ConstantOfType(Ve,cb(t.tag,Nt(e,t.args[0]),Nt(e,t.args[1]))):e.getReturnIndex()}case 15:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]);return n.type===1&&n.valueType===x&&i.type===1&&i.valueType===x?e.ConstantOfType(A,[n.value,i.value]):e.getReturnIndex()}case 16:{let n=e.getInstruction(t.args[0]),i=e.getInstruction(t.args[1]),s=e.getInstruction(t.args[2]);return n.type===1&&n.valueType===x&&i.type===1&&i.valueType===x&&s.type===1&&s.valueType===x?e.ConstantOfType(G,[n.value,i.value,s.value]):e.getReturnIndex()}case 48:{let n=Wt(e,e.getReturnIndex());return n!==void 0&&n===0?(e.popInstruction(),e.ConstantOfType(t.valueType,[])):e.getReturnIndex()}case 49:{for(let i of t.args)if(!oo(e.getInstruction(i)))return e.getReturnIndex();e.popInstruction();let n={};for(let i=0;i<t.symbols.length;i++){let s=t.symbols[i],o=e.getInstruction(t.args[i]);if(o.type===48&&(o=e.getInstruction(Nr(e,t.args[i]))),o.type!==1)throw new Error("Expected instruction to be constant");let{valueType:a,value:u}=o;HI(a,u)||(n[s]={value:u,valueType:a})}return e.ConstantOfType(Ze,{type:"Action",updateRules:n})}case 20:case 22:case 23:case 24:case 40:case 42:case 21:case 19:return e.getReturnIndex();default:let r=t;throw new Error(`Unexpected opcode ${r.type}`)}}function SR(e,t){for(let r of t){let n=e.getInstruction(r);if(!At(n))return!1}return!0}function QI(e,t){let r=[];for(let n of t){let i=e.getInstruction(n);if(At(i))r.push(i.value);else return}return r}function Rt(e,t,r){switch(t){case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 17:case 18:case 21:case 19:case 23:return x;case 25:case 26:case 27:case 28:case 29:case 32:return Ie;case 33:{let i=e.getInstruction(r[1]).valueType,s=e.getInstruction(r[2]).valueType;return i===Me&&k(s)?s:(i===de||i===oe)&&s===x?x:(i===Lt||i===wt)&&s===Z?Z:i}case 15:return A;case 16:return G;case 38:{if(r.length===0)return Me;let i=e.getInstruction(r[0]).valueType;if(i===de||i===oe){let s=!1,o=!0;for(let a of r){let u=e.getInstruction(a).valueType;if(u===x&&(s=!0),u!==x&&u!==de&&u!==oe){o=!1;break}}s&&o&&(i=x)}return zn(i)?fn(i):Bt}case 39:case 40:case 41:{let i=e.getInstruction(r[0]).valueType;return k(i)?ke(i):ft}case 44:return Ve;case 49:return Ze;case 1:case 2:case 37:case 42:case 47:case 48:case 3:case 0:case 24:case 22:case 20:return ft;default:let n=t;throw new Error(`Unexpected opcode ${n}`)}}var fa=Yi([[x,x]]),e0={Negative:Yi([[x],[A],[G]]),Add:Yi([[x,x],[A,A],[G,G]]),Subtract:Yi([[x,x],[A,A],[G,G]]),Multiply:Yi([[x,x],[A,x],[x,A],[G,x],[x,G]]),DotMultiply:Yi([[x,x],[A,x],[x,A],[G,G]]),CrossMultiply:Yi([[x,x],[A,x],[x,A],[G,G]]),Divide:Yi([[x,x],[A,x],[G,x]]),Exponent:fa,"Comparator['=']":fa,"Comparator['>']":fa,"Comparator['<']":fa,"Comparator['>=']":fa,PercentOf:fa,"Comparator['<=']":fa,And:Yi([[Ie,Ie]]),NamedCoordinateAccess:Yi([[A],[G]]),Norm:Yi([[A],[G]]),ListAccess:[[{meta:"union",types:An},x]]};function Tn(e,t){let r=[];for(let n of t)r.push(te(e.getInstruction(n).valueType));return r}function hn(e,t){let r=[];for(let n of t){let i=e.getInstruction(n).valueType,s=k(i)?ke(i):i;r.push(te(s))}return r}function U(e,t,r){return fe(e.getInstruction(t).valueType,r)}function Sf(e,t){return Array.isArray(e)?t>e.length-1?void 0:e[t]:t<e.initial.length?e.initial[t]:e.rest}function n0(e,t){let r=e.getInstruction(t);if(me(r))return;let n=fb(e,r).expectedTypes;if(r.type===49){for(let a of r.args){let u=e.getInstruction(a).valueType;if(!fe(u,x)&&!fe(u,A)&&!fe(u,G)&&!fe(u,tt)&&!fe(u,Te)&&!fe(u,pe)&&!fe(u,ne)&&!fe(u,Pe)&&!fe(u,ie)&&!fe(u,ee)&&!fe(u,de)&&!fe(u,oe))throw ay(te(u))}let o={};for(let a of r.symbols){if(o[a])throw ly(a);o[a]=!0}return}let i=[];for(let o=0;o<r.args.length;o++){let a=e.getInstruction(r.args[o]).valueType,u=Sf(n,o);(u===void 0||!db(a,u))&&i.push(r.args[o])}if(i.length===0)return;let s=Tn(e,r.args);switch(r.type){case 8:throw Am(s);case 9:throw Rm(s);case 10:throw Cm(s);case 11:throw Fm(s);case 12:case 13:throw Bm(s);case 14:throw Vm(s);case 25:case 26:case 27:case 28:case 29:throw Gm(s);case 32:throw zm(s);case 33:throw e.getInstruction(r.args[0]).valueType!==Ie?ry(s):ny([te(e.getInstruction(r.args[1]).valueType),te(e.getInstruction(r.args[2]).valueType)]);case 15:case 16:throw qm(te(e.getInstruction(i[0]).valueType));case 17:case 18:throw km(s);case 21:{let o=e.getInstruction(r.args[0]).valueType,a=e.getInstruction(r.args[1]).valueType;if(o!==x)throw Jm([te(o)]);if(a!==x)throw Qm([te(a)]);return}case 22:{let o=e.getInstruction(r.args[1]).valueType;throw Km([te(o)])}case 38:{if(r.args.length===0)return;let o=e.getInstruction(r.args[0]).valueType;if(!zn(o))throw Xo([te(o)]);for(let a of r.args){let u=e.getInstruction(a).valueType;if(!zn(u))throw Xo([te(u)]);if(u!==o)throw Fu()}return}case 39:case 40:case 41:throw Fa(s);case 37:{let o=r.args,a=r.symbol,u=gr[a],l=r.callData.errorSymbol;if(u.tag==="doubleReducer"){if(!k(e.getInstruction(o[0]).valueType)||!k(e.getInstruction(o[1]).valueType))throw Hu(l)}else if(u.tag==="parameterizedReducer"&&!k(e.getInstruction(o[0]).valueType))throw Eg(l);throw Vt(l,Tn(e,o))}case 44:{if(e.getInstruction(r.args[0]).valueType!==Ve||e.getInstruction(r.args[1]).valueType!==Ve&&e.getInstruction(r.args[1]).valueType!==x)throw Ce();return}case 42:throw Vt(r.symbol,s);case 48:case 47:case 23:case 24:case 19:case 20:throw Ce();default:{let o=r;throw new Error(`Unexpected opcode: ${o.type}`)}}}function fb(e,t,r=!1){switch(t.type){case 8:case 9:case 10:case 11:return r&&t.args.length>0&&e.getInstruction(t.args[0]).valueType===A?{expectedTypes:[A,A]}:{expectedTypes:[x,x]};case 12:case 13:case 25:case 26:case 27:case 28:case 29:return{expectedTypes:[x,x]};case 14:return{expectedTypes:[x]};case 32:return{expectedTypes:[Ie,Ie]};case 33:return{expectedTypes:[Ie,t.valueType,t.valueType]};case 15:case 16:return{expectedTypes:t.args.map(()=>x)};case 17:return{expectedTypes:[A,x]};case 18:return{expectedTypes:[G,x]};case 21:return{expectedTypes:[x,x]};case 22:return{expectedTypes:[x,x]};case 38:{let n=t.valueType,i=ke(n);return{expectedTypes:{type:"variadic",initial:[],rest:i}}}case 39:case 40:case 41:return{expectedTypes:[Bt,x]};case 37:{let n=t.symbol,i=gr[n],s=i.argumentTypes;if(i.tag==="reducer"&&!NR(e,t.args)&&Array.isArray(s)&&typeof s[0]=="number"&&k(s[0]))return{isReducerWithNoListArgs:!0,expectedTypes:{type:"variadic",initial:[],rest:ke(s[0])}};if(Array.isArray(s))return{expectedTypes:s};{let{initial:o,rest:a}=s,u=t.args.length-o.length,l=[...o];for(let c=0;c<u;c++)l.push(a);return{expectedTypes:l}}}case 44:return e.getInstruction(t.args[0]).valueType===Ve&&e.getInstruction(t.args[1]).valueType!==Ve?{expectedTypes:[Ve,x]}:{expectedTypes:t.args.map(n=>e.getInstruction(n).valueType)};case 47:return{expectedTypes:t.args.map(n=>e.getInstruction(n).valueType)};case 23:return{expectedTypes:[x]};case 19:return{expectedTypes:t.args.map(()=>x)};case 24:case 20:{let n=[x];for(let i=1;i<t.args.length;i++)n.push(e.getInstruction(t.args[i]).valueType);return{expectedTypes:n}}case 42:return{expectedTypes:t.args.map(()=>x)};case 48:case 49:return{expectedTypes:t.args.map(n=>e.getInstruction(n).valueType)};default:{let n=t;throw new Error(`Unexpected opcode: ${n.type}`)}}}function Nf(e){let t;if(e in zi)t=zi[e].argumentTypes;else if(e in gr){let r=gr[e];switch(r.tag){case"reducer":{t=[r.argumentTypes],Array.isArray(r.argumentTypes)&&typeof r.argumentTypes[0]=="number"&&k(r.argumentTypes[0])&&t.push({type:"variadic",initial:[],rest:ke(r.argumentTypes[0])});break}case"parameterizedReducer":{t=[r.argumentTypes],Array.isArray(r.argumentTypes)&&r.argumentTypes.length===2&&t.push([r.argumentTypes[0],wo(r.argumentTypes[1])]);break}case"doubleReducer":case"never-broadcast":{t=[r.argumentTypes];break}default:{t=[os(r.argumentTypes)];break}}}else return;return t}function i0(e,t,r){let n=[];for(let i of r)n.push(i===void 0?void 0:e.getInstruction(i).valueType);if(t instanceof ys){let i=r.filter(o=>o!==void 0);if(i.length===0)return;let s=Rt(e,38,i);return k(s)?[{type:"variadic",initial:[],rest:ke(s)}]:void 0}else if(t instanceof Ar||t instanceof wa||t instanceof Gs){let i=t instanceof Gs?t.args[1]._symbol:t._symbol;if(!i)return;let s=Nf(i);return s?t0(s,n):void 0}else if(t instanceof hs){let[i,s,o]=r;if(i!==void 0&&s!==void 0&&o!==void 0){let a=Rt(e,33,[i,s,o]);return[os([Ie,a,a])]}else{let a=s;if(!a&&o!==void 0){let u=e.getInstruction(o);At(u)&&u.valueType==x&&Rn(u.value)||(a=o)}if(a!==void 0){let u=e.getInstruction(a).valueType;return[os([Ie,u,u])]}}}else if(t.type in e0&&n.some(i=>i!==void 0)){let i=e0[t.type];return i?t0(i,n):void 0}}function t0(e,t){let r=[];for(let n of e)Array.isArray(n)&&n.length<t.length||t.every((i,s)=>{if(i===void 0)return!0;let o=Sf(n,s);return o===void 0?!1:DR(i,o)})&&r.push(n);return r}function NR(e,t){for(let r of t)if(k(e.getInstruction(r).valueType))return!0;return!1}function db(e,t){return typeof t=="number"?Li(e,t):t.types.some(r=>Li(e,r))}function DR(e,t){return typeof t=="number"?Zl(e,t):t.types.some(r=>Zl(e,r))}function Df(e,t){let r=[];for(let n of e)if(Array.isArray(n)){if(t>=n.length)continue;r.push(...r0(n[t]))}else r.push(...r0(t<n.initial.length?n.initial[t]:n.rest));return r}function r0(e){return typeof e=="number"?[e]:e.types}function Yi(e){return e.map(os)}function Af(e){let t=[];for(let r=0;r<e.instructionsLength();r++){t.push(0);let n=e.getInstruction(r);if(!me(n))if(Cr(n)&&n.type!==22)for(let i of n.args)t[i]=1/0;else for(let i of n.args)t[i]+=1}return t}var bl=mb([Ht("sin","isinf(x) || isnan(x) ? NaN : dcg_isPiMultiple(abs(x)) ? 0.0 : sin(x)"),Ht("cos","isinf(x) || isnan(x) ? NaN : dcg_isOddHalfPiMultiple(abs(x)) ? 0.0 : cos(x)"),Hs("tan",gt`float a=abs(x);
    return isinf(x) || isnan(x) ? NaN
      : dcg_isPiMultiple(a) ? 0.0
      : dcg_isOddHalfPiMultiple(a) ? Infinity
      : tan(x);`),Hs("cot",gt`float a=abs(x);
      return isinf(x) || isnan(x) ? NaN
        : dcg_isPiMultiple(a) ? Infinity
        : dcg_isOddHalfPiMultiple(a) ? 0.0
        : 1.0 / tan(x);`),Ht("sec","isinf(x) || isnan(x) ? NaN : dcg_isOddHalfPiMultiple(abs(x)) ? Infinity: 1.0 / cos(x)"),Ht("csc","isinf(x) || isnan(x) ? NaN : dcg_isPiMultiple(abs(x)) ? Infinity: 1.0 / sin(x)"),Hs("arcsin",gt`if (isinf(x) || isnan(x)) { return NaN; }
    if (x == 1.0) { return dcg_PI/2.0; }
    if (x == -1.0) { return -dcg_PI/2.0; }
    float y0 = asin(x);
    return y0 + (x - sin(y0)) / cos(y0);`),Hs("arccos",gt`if (isinf(x) || isnan(x)) { return NaN; }
    if (x == 1.0) { return 0.0; }
    if (x == -1.0) { return dcg_PI; }
    float y0 = acos(x);
    return y0 + (cos(y0) - x) / sin(y0);`),Ht("arctan","isnan(x) ? NaN : atan(x)"),Rf("arctan","isnan(x) || isnan(y) ? NaN : atan(x, y)"),Ht("arccot","isnan(x) ? NaN : dcg_PI/2.0 - atan(x)"),Ht("arcsec","isnan(x) ? NaN : dcg_arccos(1.0/x)"),Ht("arccsc","isnan(x) ? NaN : dcg_arcsin(1.0/x)"),Ht("sinh","isinf(x) ? x : isnan(x) ? NaN : sinh(x)"),Ht("cosh","isinf(x) ? Infinity : isnan(x) ? NaN : cosh(x)"),Ht("tanh","abs(x) > 10.0 ? sign(x) : isnan(x) ? NaN : tanh(x)"),Ht("coth","abs(x) > 10.0 ? sign(x) : isnan(x) ? NaN : x == 0.0 ? Infinity : abs(x) < 0.03 ? 1.0/x + x/3.0 : 1.0/tanh(x)"),Ht("sech","isinf(x) ? 0.0 : isnan(x) ? NaN : 1.0/cosh(x)"),Ht("csch","isinf(x) ? 0.0 : isnan(x) ? NaN : x == 0.0 ? Infinity : abs(x) < 0.03 ? 1.0/x - x/6.0 : 1.0/sinh(x)"),Hs("arcsinh",gt`float a=abs(x);
      return isnan(x) ? NaN : sign(x) * (
        1.0 + x * x == 1.0
          ? dcg_log1p(a)
          : log(a + dcg_rtxsqpone(a))
      );`),Ht("arccosh","x < 1.0 || isnan(x) ? NaN : log(x + dcg_rtxsqmone(x))"),Hs("arctanh",gt`if (isnan(x) || abs(x) > 1.0) { return NaN; }
      if (x == 1.0) { return Infinity; }
      if (x == -1.0) { return -Infinity; }
      float y0 = 0.5*(dcg_log1p(x) - dcg_log1p(-x));
      float c = cosh(y0);
      return y0 + (x - tanh(y0)) * c * c;`),Ht("arccoth","abs(x) >= 1.0 ? dcg_arctanh(1.0/x) : NaN"),Ht("arcsech","0.0 < x && x <= 1.0 ? dcg_arccosh(1.0/x) : x == 0.0 ? Infinity : NaN"),Ht("arccsch","isinf(x) ? 0.0 : isnan(x) ? NaN : dcg_arcsinh(1.0/x)"),Ht("sqrt","x >= 0.0 ? sqrt(x) : NaN"),Ht("rtxsqpone","dcg_hypot(x, 1.0)"),Hs("rtxsqmone","float t = x*x; return isnan(x) ? NaN : t - 1.0 == t ? abs(x) : sqrt(t - 1.0);"),Rf("nthroot","isnan(x) || isnan(y) ? NaN : pow(x, 1.0/y)"),p0("hypot",gt`if (isnan(x) || isnan(y)) return NaN;
      if (isinf(x) || isinf(y)) return Infinity;
      x = abs(x);
      y = abs(y);
      float m = max(x,y);
      x /= m;
      y /= m;
      return m == 0.0 ? 0.0 : sqrt(x*x + y*y) * m;`),Ht("log","x > 0.0 ? log(x)*0.4342944819 : x == 0.0 ? -Infinity : NaN"),Rf("logbase","y > 0.0 ? (x > 0.0 ? log(x)/log(y) : x == 0.0 && !isinf(y) ? -Infinity : NaN) : NaN"),Ht("ln","x > 0.0 ? log(x) : x == 0.0 ? -Infinity : NaN"),Ht("exp","isnan(x) ? NaN : exp(x)"),Ht("floor","isnan(x) ? NaN : floor(x)"),Ht("ceil","isnan(x) ? NaN : ceil(x)"),Ht("round","isnan(x) ? NaN : floor(0.5 + x)"),Ht("abs","isnan(x) ? NaN : abs(x)"),Ht("sign","isnan(x) ? NaN : sign(x)"),Rf("mod","isnan(x) || isnan(y) ? NaN : mod(x, y)"),tu("distance","float","vec2 a, vec2 b","vec2 d = a-b; return dcg_hypot(d.x, d.y);"),tu("distance3d","float","vec3 a, vec3 b","vec3 d = a-b; return dcg_hypot(dcg_hypot(d.x, d.y), d.z);"),tu("hsv","vec3","float h, float s, float v",gt`if (isnan(h) || isnan(s) || isnan(v)) {discard;}
      vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);
      vec3 p = abs(fract(h / 360.0 + K.xyz) * 6.0 - K.www);
      return vec3(v * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), s));`),tu("rgb","vec3","float r, float g, float b",gt`if (isnan(r) || isnan(g) || isnan(b)) {discard;}
    return vec3(r / 255.0, g / 255.0, b / 255.0);`),Hs("erf",`float t = abs(x);
      float n = x*x;
      float r = -n;
      return sign(x) * (
        r < -750.0
          ? 1.0
          : t >= 0.065
          ? 1.0 - exp(r) * (
            t > 50000000.0
              ? r / t
              : t > 50.0
              ? (r * (n * (n + 4.5) + 2.0)) / (t * (n * (n + 5.0) + 3.75))
              : ((0.9999999999999999+t*(2.224574423459406+t*(2.444115549920689+
                t*(1.7057986861852539+t*(0.8257463703357973+
                  t*(0.28647031042892007+t*(0.07124513844341643+
                    t*(0.012296749268608364+t*(0.001347817214557592+
                      0.00007263959403471071*t))))))))
                )/(1.0+t*(3.352953590554884+t*(5.227518529742423+
                  t*(5.003720878235473+t*(3.266590890998987+
                    t*(1.5255421920765353+t*(0.5185887413188858+
                      t*(0.12747319185915415+t*(0.02185979575963238+
                        t*(0.0023889438122503674+0.00012875032817508128*t
                ))))))))))
              )
          )
          : t*(1.1283791670955126+r*(0.37612638903183754+
              r*(0.11283791670955126+r*(0.026866170645131252+
                0.005223977625442188*r))))
      );`)]);function mb(e){let t={};for(let[r,n]of e)t[r]=n;return t}function tu(e,t,r,n){return[e,`${t} dcg_${e}(${r}){ ${n} }`]}function Hs(e,t){return tu(e,"float","float x",t)}function Ht(e,t){return Hs(e,`return ${t};`)}function p0(e,t){return tu(e,"float","float x, float y",t)}function Rf(e,t){return p0(e,`return ${t};`)}function Pn(e,t,r=()=>"float"){return[e,n=>`${r(n)} dcg_${e}(float[${n}] L) { ${t(n)} }`]}function Cf(e,t,r=()=>"float"){return[e,(n,i)=>{let s=Math.min(n,i),o=r(s),a=t(s);return`${o} dcg_${e}(float[${n}] X, float[${i}] Y) { ${a} }`}]}var Lf=mb([Pn("lcm",e=>gt`float g = abs(dcg_round(L[0]));
      if (isinf(g)) return Infinity;
      if (isnan(g)) return NaN;
      for (int i=1; i<${e}; i++) {
        float v = abs(dcg_round(L[i]));
        if (isinf(v)) return Infinity;
        if (isnan(v)) return NaN;
        g *= dcg_round(v / dcg_gcd2(g, v));
      }
      return g;`),Pn("gcd",e=>gt`float g = abs(dcg_round(L[0]));
      if (isnan(g)) return NaN;
      for (int i=1; i<${e}; i++) {
        float x = L[i];
        if (isnan(x)) return NaN;
        g = dcg_gcd2(g, abs(dcg_round(x)));
      }
      return g;`),Pn("mean",e=>gt`float m = L[0];
      for (int i=1; i<${e}; i++) { m += L[i]; }
      return m / ${e}.0;`),Pn("total",e=>gt`float tot = L[0];
      for (int i=1; i<${e}; i++) { tot += L[i]; }
      return tot;`),Pn("stdev",e=>o0(e,e-1)),Pn("stdevp",e=>o0(e,e)),Pn("mad",e=>gt`float mean = dcg_mean(L);
      float tot = 0.0;
      for (int i=0; i<${e}; i++) {
        tot += abs(L[i] - mean);
      }
      return tot / ${e}.0;`),Pn("min",e=>a0(e,"min")),Pn("max",e=>a0(e,"max")),Pn("argmin",e=>u0(e,"<")),Pn("argmax",e=>u0(e,">=")),Pn("median",e=>e%2===1?`return L[int(dcg_sortPerm(L)[${(e-1)/2}])-1];`:gt`float[${e}] perm = dcg_sortPerm(L);
          return 0.5*(L[int(perm[${e/2}])-1]+L[int(perm[${e/2-1}])-1]);`),Pn("varp",e=>s0(e,e)),Pn("var",e=>s0(e,e-1)),Pn("sortPerm",e=>{if(e>100)throw Ba();return gt`int[${e}] perm;
        int[${e}] nextPerm;
        for (int i=0; i<${e}; i++)
          perm[i] = i;
        float lastMin = -Infinity;
        int lastIndex = -1;
        for (int i=0; i<${e}; i++) {
          float currMin = Infinity;
          int currIndex = -1;
          int j;
          for (j=0; j<${e}; j++) {
            float e = L[j];
            if (
              (e > lastMin || (e == lastMin && j > lastIndex))
              && e < currMin
            ) {
              currMin = e;
              currIndex = j;
            }
          }
          perm[i] = currIndex;
          lastMin = currMin;
          lastIndex = currIndex;
        }
        float[${e}] permFloat;
        for (int i=0; i<${e}; i++)
          permFloat[i] = float(perm[i] + 1);
        return permFloat;`},e=>`float[${e}]`)]);function s0(e,t){return t===0?"return NaN;":gt`float mean = dcg_mean(L);
    float tot = 0.0;
    for (int i=0; i<${e}; i++) {
      float delta = L[i] - mean;
      tot += delta * delta;
    }
    return tot / ${t}.0;`}function o0(e,t){return t===0?"return NaN;":gt`float mean = dcg_mean(L);
    float tot = 0.0;
    for (int i=0; i<${e}; i++) {
      float delta = L[i] - mean;
      tot = dcg_hypot(tot, delta);
    }
    return tot / ${wf(Math.sqrt(t))};`}function a0(e,t){return gt`float m = L[0];
    if (isnan(m)) return NaN;
    for (int i=1; i<${e}; i++) {
      float x = L[i];
      if (isnan(x)) return NaN;
      m = ${t}(m, x);
    }
    return m;`}function u0(e,t){return gt`if (isnan(L[0])) return 0.0;
    int arg = 0;
    float best = L[0];
    for (int i=1; i<${e}; i++) {
      float e = L[i];
      if (isnan(e)) return 0.0;
      if (e ${t} best) {
        arg = i;
        best = e;
      }
    }
    return float(arg + 1);`}var f0={median:["sortPerm"],stdev:["mean"],stdevp:["mean"],mad:["mean"],var:["mean"],varp:["mean"]},yb=mb([Cf("elementsAt",e=>`float[${e}] outList;
      for (int i=0; i<${e}; i++) {
        outList[i] = X[int(Y[i])-1];
      }
      return outList;`,e=>`float[${e}]`),Cf("cov",e=>l0(e,e-1)),Cf("covp",e=>l0(e,e)),Cf("corr",e=>gt`${d0(e)}
      float t1 = 0.0;
      float t2 = 0.0;
      float tc = 0.0;
      for (int i=0; i<${e}; i++) {
        float d1 = X[i] - m1;
        float d2 = Y[i] - m2;
        t1 = dcg_hypot(t1, d1);
        t2 = dcg_hypot(t2, d2);
        tc += d1 * d2;
      }
      return tc / (t1 * t2);`)]);function l0(e,t){return gt`${d0(e)}
    float tot = 0.0;
    for (int i=0; i<${e}; i++) {
      tot += (X[i] - m1) * (Y[i] - m2);
    }
    return tot / ${t}.0;`}function d0(e){return gt`float m1 = X[0];
    for (int i=1; i<${e}; i++) { m1 += X[i]; }
    m1 /= ${e}.0;
    float m2 = Y[0];
    for (int i=1; i<${e}; i++) { m2 += Y[i]; }
    m2 /= ${e}.0;`}var AR=[gt`float dcg_rawpow(float x, float y) {
    if (isnan(x) || isnan(y)) return NaN;
    if (x > 0.0) return pow(x, y);
    else if (x == 0.0) {
      if (y > 0.0) return 0.0;
      if (y == 0.0) return 1.0;
      if (y < 0.0) return Infinity;
    } else {
      float m = mod(y, 2.0);
      if (m == 1.0) return -pow(-x, y);
      else return pow(-x, y);
    }
  }`,gt`float dcg_pow(float x, float y) {
    if (isnan(x) || isnan(y)) return NaN;
    if (isinf(y)) {
      float a = abs(x);
      if (a == 1.0) return NaN;
      if (y > 0.0) {
        return a > 1.0 ? Infinity : 0.0;
      } else {
        return a < 1.0 ? Infinity : 0.0;
      }
    }
    if (x > 0.0) return pow(x,y);
    else if (x == 0.0) {
      if (y > 0.0) return 0.0;
      if (y == 0.0) return 1.0;
      if (y < 0.0) return Infinity;
    } else {
      float m = mod(y, 2.0);
      if (m == 0.0) return pow(-x, y);
      else if (m == 1.0) return -pow(-x, y);
      else {${""}
        vec2 a0 = vec2(0.0, 1.0);
        vec2 a1 = vec2(1.0, 0.0);
        float approx = y;
        for (int i=0; i<12; i+=1) {
          float whole = floor(approx);
          vec2 a = whole * a1 + a0;
          if (a.y > 100.0) break;
          a0 = a1; a1 = a;
          if (approx == whole) break;
          approx = 1.0 / (approx - whole);
        }${""}
        float r = a1.x / a1.y;
        float m = max(max(abs(y), abs(r)), 1.0);
        if (abs(mod(a1.y, 2.0) - 1.0) < 0.01 && abs((r - y)/y) < 0.00001) {
          return (mod(a1.x, 2.0) == 0.0 ? 1.0 : -1.0) * pow(-x, y);
        } else {
          return NaN;
        }
      }
    }
  }`,gt`float dcg_add(float x, float y) {
    return isnan(x) || isnan(y) ? NaN
      : isinf(x) && isinf(y) && x != y ? NaN
      : x + y;
  }`,gt`float dcg_sub(float x, float y) {
    return isnan(x) || isnan(y) ? NaN
      : isinf(x) && isinf(y) && x != -y ? NaN
      : x - y;
  }`,gt`float dcg_mul(float x, float y) {
    return isnan(x) || isnan(y) ? NaN
      : isinf(x) && y == 0.0 ? NaN
      : x == 0.0 && isinf(y) ? NaN
      : x * y;
  }`,gt`float dcg_div(float x, float y) {
    return isnan(x) || isnan(y) ? NaN
      : x == 0.0 && y == 0.0 ? NaN
      : x / y;
  }`,gt`float dcg_gcd2(float u, float v) {
    if (isinf(u)) return v;
    if (isinf(v)) return u;
    for (int i=0; i<95; i++) {
      if (v == 0.0) break;
      u = mod(u, v);
      if (u == 0.0) break;
      v = mod(v, u);
    }
    return u+v;
  }`,gt`float dcg_log1p(float x) {
    return x - 0.5 * x * x == x ? x : log(1.0 + x);
  }`,gt`bool dcg_isPiMultiple(float absx) {
    if (absx > 1.0e5) return false;
    return floor(0.5 + dcg_PI_INV * absx) * dcg_PI == absx;
  }`,gt`bool dcg_isOddHalfPiMultiple(float absx) {
    if (absx > 1.0e5) return false;
    float n = floor(0.5 + 2.0 * dcg_PI_INV * absx);
    return mod(n, 2.0) == 1.0 && n * dcg_PI == 2.0 * absx;
  }`].join(`
`),c0=["factorial","round","hypot","rtxsqpone","rtxsqmone"],RR=c0.map(e=>bl[e]).join(`
`)+Object.keys(bl).filter(e=>c0.indexOf(e)===-1).map(e=>bl[e]).join(`
`),Jq=gt`uniform float NaN;
    uniform float Infinity;
    float dcg_const_bust = 1.0;
    #define dcg_PI 3.141592653589793
    #define dcg_PI_INV 0.3183098861837907
    ${AR}\n`+RR;function gt(e,...t){let r=e[0];for(let n=0;n<t.length;n++)r+=t[n],r+=e[n+1];return CR(r)}function CR(e){let t=e.split(`
`);if(/^\s/.test(t[0][0]))throw new Error("Programming error: Expected un-indented first line");if(t.length<=1)return e;let r=Math.min(...t.slice(1).map(n=>n.match(/^\s*/)[0].length));return t[0]+`
`+t.slice(1).map(n=>n.slice(r)).join(`
`)}function In(e){return`_${e}`}function ye(e,t){let r=t[e];return r!==void 0?r:In(e)}function m0(e){return g0(e,!1)}function y0(e){return g0(e,!0)}function g0(e,t){let r=Af(e),n=[],i=[],s=b0(e,e.argNames.length,e.instructionsLength()-1,r,t),o=0;for(;o<e.instructionsLength();){let a=e.getInstruction(o),{source:u,nextIdx:l}=h0(e,a,o,r,n,i,t);s+=u,o=l}return s+=`return ${ye(e.getReturnIndex(),n)};`,{source:s,constants:i,shaderFunctions:t?_R(e):""}}function h0(e,t,r,n,i,s,o){let a=r+1;switch(t.type){case 0:case 47:case 48:case 22:case 49:return{source:"",nextIdx:a};case 21:if(o)throw tp();return{source:wR(e,t,r,n,i,s),nextIdx:t.endIndex};case 2:return i[r]=e.argNames[r],{source:"",nextIdx:a};case 23:return{source:FR(e,t,r,i,o),nextIdx:a};case 24:return{source:BR(e,t,r,i,o),nextIdx:a};case 19:return{source:VR(e,t,r,i,o),nextIdx:a};case 20:return{source:GR(e,t,r,i),nextIdx:a};default:{let u=zR(e,t,i,s,o);return n[r]<=1?(i[r]=`(${u})`,{source:"",nextIdx:a}):{source:`${In(r)}=${u};
`,nextIdx:a}}}}function LR(e,t,r,n,i,s){let{endIndex:o}=t,a=!1,u=`function(${In(r)}) {
`;u+=b0(e,r+1,o-1,n,a);let l=r+1;for(;l<o;){let p=e.getInstruction(l),{source:f,nextIdx:m}=h0(e,p,l,n,i,s,a);u+=f,l=m}let c=e.getInstruction(o);return u+=`return ${ye(c.args[1],i)};
}`,u}function wR(e,t,r,n,i,s){let o="BuiltIn.quad(";o+=LR(e,t,r,n,i,s),o+=`,${ye(t.args[0],i)},${ye(t.args[1],i)})`;let{endIndex:a}=t;return n[a+1]<=1?(i[a+1]=o,""):`${In(a+1)}=${o};`}function _R(e){var o;let t=e.argNames.length,r=e.instructionsLength()-1,n={},i={};for(let a=t;a<=r;a++){let u=e.getInstruction(a);if(u.type===33)k(u.valueType)&&(n[P0(e,a)]=!0);else if(u.type===37){let l;if((l=Lf[u.symbol])!==void 0){let c=u.args[0],p=Wt(e,c);if(p===void 0)throw Zo(Xr(e,c));for(let f of(o=f0[u.symbol])!=null?o:[])i[Lf[f](p)]=!0;i[l(p)]=!0}else if((l=yb[u.symbol])!==void 0){let c=u.args[0],p=u.args[1],f=Wt(e,c),m=Wt(e,p);if(f===void 0)throw Zo(Xr(e,c));if(m===void 0)throw Zo(Xr(e,p));i[l(f,m)]=!0}}}let s="";for(let a in n)s+=`${a} dcg_ternary(bool x, ${a} y, ${a} z) { if (x) return y; return z; }`;return s+Object.keys(i).join(`
`)}function b0(e,t,r,n,i){let s="",o=!1;for(let a=t;a<=r;a++){let u=e.getInstruction(a);if(!(u.type===0||u.type===24||u.type===20)){if(u.type===21){if(i)throw tp();let{endIndex:l}=u;a=n[l+1]<=1?l+1:l;continue}n[a]<=1&&!gn(u)&&!Cr(u)&&u.type!==47&&u.type!==48||(i?(o&&(s+=";"),s+=P0(e,a)+" "+In(a)):(s+=o?",":"var ",s+=In(a)),o=!0)}}return o&&(s+=`;
`),s}function FR(e,t,r,n,i){let s=In(r),o=e.getInstruction(t.endIndex),a=ye(t.args[0],n),u="";for(let c=1;c<o.args.length;c++){let p=t.endIndex+c;if(e.getInstruction(p).type!==48)continue;let m=In(p);i||(u+=`${m}=[];
`)}return i||(u+=`if(${a}>${1e4}) throw ErrorMsg.maxListSize();
`),u+=`for(${s}=1${i?".0":""};${s}<=${a};${s}++){
`,u}function BR(e,t,r,n,i){let s="";for(let o=1;o<t.args.length;o++){let a=r+o;if(a>=e.instructionsLength()||e.getInstruction(a).type!==48)continue;let u=In(r+o),l=ye(t.args[o],n);if(i){let c=ye(t.args[0],n);s+=`${u}[int(${c})-1]=${l};
`}else s+=`${u}.push(${l});
`}return s+=`}
`,s}function VR(e,t,r,n,i){let s=In(r);if(i){let l=e.getInstruction(t.args[0]),c=e.getInstruction(t.args[1]),p=t.callData.type==="sum";if(l.type!==1){let d=Xr(e,t.args[0]);throw p?Kc(d):ep(d)}if(c.type!==1){let d=Xr(e,t.args[1]);throw p?Kc(d):ep(d)}if(l.valueType!==x||c.valueType!==x)throw new Error("Programming error: non-number in summation bounds");let f=V(l.value),m=V(c.value);if(!isFinite(m-f)||m-f>=1e3)throw p?hy():by()}let o=`${ye(t.args[0],n)}`,a=`${ye(t.args[1],n)}`,u=`if(${o}>${a}){
`;for(let l=2;l<t.args.length;l++){let c=t.endIndex+l-1;if(c>=e.instructionsLength()||e.getInstruction(c).type!==47)continue;let p=In(c);u+=`${p}=${ye(t.args[l],n)};
`}if(!i){u+=`}else if(!isFinite(${a}-${o})){
`;for(let l=2;l<t.args.length;l++){let c=t.endIndex+l-1;if(c>=e.instructionsLength())continue;let p=e.getInstruction(c);if(p.type!==47)continue;let f=In(c);u+=`${f}=${gb($n(p.valueType),i,t.valueType)};
`}}u+=`}else{
`;for(let l=2;l<t.args.length;l++){let c=r+l-1;if(e.getInstruction(c).type!==47)continue;let p=In(c);u+=`${p}=${ye(t.args[l],n)};
`}return u+=`for(${s}=${o};${s}<=${a};${s}++){
`,u}function GR(e,t,r,n){let i="";for(let s=1;s<t.args.length;s++){let o=t.args[0]+s;if(e.getInstruction(o).type!==47)continue;let a=In(o);i+=`${a}=${ye(t.args[s],n)};
`}i+=`}
`;for(let s=1;s<t.args.length;s++){let o=r+s;if(o>=e.instructionsLength()||e.getInstruction(o).type!==47)continue;let a=In(o);i+=`${a}=${ye(t.args[s],n)};
`}return i+=`}
`,i}function zR(e,t,r,n,i){switch(t.type){case 1:return i||t.valueType===x||t.valueType===Ie||t.valueType===A||t.valueType===G?gb(t.value,i,t.valueType):(n.push(qi(t.value)),`_C[${n.length-1}]`);case 8:{let l=ye(t.args[0],r),c=ye(t.args[1],r);return i?`dcg_add(${l},${c})`:`${l}+${c}`}case 9:{let l=ye(t.args[0],r),c=ye(t.args[1],r);return i?`dcg_sub(${l},${c})`:`${l}-${c}`}case 10:{let l=ye(t.args[0],r),c=ye(t.args[1],r);return i?`dcg_mul(${l},${c})`:`${l}*${c}`}case 11:{let l=ye(t.args[0],r),c=ye(t.args[1],r);return i?`dcg_div(${l},${c})`:`${l}/${c}`}case 12:return`${i?"dcg_":"BuiltIn."}pow(${ye(t.args[0],r)},${ye(t.args[1],r)})`;case 13:return`${i?"dcg_rawpow":"Math.pow"}(${ye(t.args[0],r)},${ye(t.args[1],r)})`;case 14:return`-${ye(t.args[0],r)}`;case 25:return ye(t.args[0],r)+(i?"==":"===")+ye(t.args[1],r);case 26:return`${ye(t.args[0],r)}<${ye(t.args[1],r)}`;case 27:return`${ye(t.args[0],r)}>${ye(t.args[1],r)}`;case 28:return`${ye(t.args[0],r)}<=${ye(t.args[1],r)}`;case 29:return`${ye(t.args[0],r)}>=${ye(t.args[1],r)}`;case 32:return`${ye(t.args[0],r)}&&${ye(t.args[1],r)}`;case 33:let s=ye(t.args[0],r),o=ye(t.args[1],r),a=ye(t.args[2],r);return i&&k(t.valueType)?`dcg_ternary(${s},${o},${a})`:`${s}?${o}:${a}`;case 15:return(i?"vec2(":"[")+ye(t.args[0],r)+","+ye(t.args[1],r)+(i?")":"]");case 16:return(i?"vec3(":"[")+ye(t.args[0],r)+","+ye(t.args[1],r)+","+ye(t.args[2],r)+(i?")":"]");case 17:case 18:{let l=ye(t.args[0],r),c=ye(t.args[1],r);return i?`${l}.${c==="(1.0)"?"x":c==="(2.0)"?"y":"z"}`:`${l}[${c}-1]`}case 38:return(i?_f(t.valueType)+`[${t.args.length}](`:"[")+t.args.map(l=>ye(l,r)).join(",")+(i?")":"]");case 40:case 42:case 3:throw new Error(`Programming Error: expect ${Fn(t.type)} to be removed before emitting code.`);case 39:{let l=ye(t.args[0],r),c=ye(t.args[1],r),p=i?"int":"Math.floor",f=i?Wt(e,t.args[0]):`${l}.length`;if(f===void 0)throw Zo(Xr(e,t.args[0]));let m=t.valueType;return`(${p}(${c})>=1&&${p}(${c})<=${f})?${l}[${p}(${c})-1]:${gb($n(m),i,m)}`}case 41:{let l=ye(t.args[0],r),c=ye(t.args[1],r);return i?`${l}[int(${c})-1]`:`${l}[${c}-1]`}case 37:{let l=t.args.map(c=>ye(c,r)).join(",");if(i){if(!bl[t.symbol]&&!Lf[t.symbol]&&!yb[t.symbol])throw Gu(t.symbol);return`dcg_${t.symbol}(${l})`}else{let c=gr[t.symbol];return`${c.module}.${c.symbol}(${l})`}}case 44:{if(i)throw Gu("random");return`${ye(t.args[0],r)}+'::${t.tag}'+${ye(t.args[1],r)}`}case 2:case 0:case 21:case 22:case 19:case 20:case 23:case 24:case 47:case 48:case 49:throw new Error(`Unexpected opcode ${t.type}`);default:let u=t;throw new Error(`Unexpected opcode ${u.type}`)}}function gb(e,t,r){return t?T0(e,r):x0(e)}function x0(e){if(Array.isArray(e))return`[${e.map(x0).join(",")}]`;switch(typeof e){case"boolean":case"number":return e.toString();case"string":return`${JSON.stringify(e)}`;case"object":if(sa(e))throw new Error("Action values cannot be compiled");return V(e).toString();default:throw new Error("Unexpected value: "+e)}}function T0(e,t){if(Array.isArray(e)){if(e.length>100)throw Ba();let r=k(t)?`[${e.length}]`:"",n=k(t)?ke(t):t,i="dcg_const_bust*"+e.map(s=>T0(s,n)).join(",");return _f(t)+r+"("+i+")"}switch(typeof e){case"boolean":return e.toString();case"number":return wf(e);case"string":throw Gu("random");case"object":if(sa(e))throw new Error("Action values cannot be compiled");return wf(V(e));default:throw new Error("Unexpected value: "+e)}}function wf(e){let t=e.toString();return/^-?\d+$/.test(t)?t+".0":t}function _f(e){switch(k(e)?ke(e):e){case Ie:return"bool";case x:return"float";case A:return"vec2";case tt:case G:return"vec3";default:throw new Error("Unexpected type: "+pn(e))}}function P0(e,t){let r=e.getInstruction(t);if(k(r.valueType)){let n=Wt(e,t);if(n===void 0)throw Zo(Xr(e,t));if(n>100)throw Ba();return`${_f(r.valueType)}[${n}]`}else return _f(r.valueType)}function I0(e){let t=[];for(let r=0;r<e.instructionsLength();r++)t.push(!1);t[e.getReturnIndex()]=!0;for(let r=e.instructionsLength()-1;r>=0;r--){if(!t[r]){e.replaceInstructionWithNoop(r);continue}let n=e.getInstruction(r);if(!me(n))for(let i of n.args)t[i]=!0}}function gi(e,t){return e.pushLeafInstruction(t)}function Xt(e,t,r){switch(t.type){case 8:return e.Add(r);case 9:return e.Subtract(r);case 10:return e.Multiply(r);case 11:return e.Divide(r);case 12:return e.Exponent(r);case 13:return e.RawExponent(r);case 14:return e.Negative(r);case 25:return e.Equal(r);case 26:return e.Less(r);case 27:return e.Greater(r);case 28:return e.LessEqual(r);case 29:return e.GreaterEqual(r);case 32:return e.And(r);case 33:return e.Piecewise(r);case 47:return e.BlockVar(t.valueType,r);case 48:return e.BroadcastResult(t.valueType,r);case 15:return e.OrderedPair(r);case 16:return e.OrderedTriple(r);case 17:return e.OrderedPairAccess(r);case 18:return e.OrderedTripleAccess(r);case 37:return e.NativeFunction(t.symbol,t.callData,r);case 42:return e.Distribution(t.symbol,r);case 21:return e.BeginIntegral(t.callData,r);case 22:return e.EndIntegral(r);case 23:return e.BeginBroadcast(r);case 24:return e.EndBroadcast(r);case 19:return e.BeginLoop(t.callData,r);case 20:return e.EndLoop(r);case 38:return e.List(r);case 39:return e.ListAccess(r);case 40:return e.DeferredListAccess(r);case 41:return e.InboundsListAccess(r);case 44:return e.ExtendSeed(t.tag,r);case 49:return e.Action(t.symbols,r);default:let n=t;throw new Error(`Unexpected opcode ${n.type}`)}}function M0(e){if(e.instructionsLength()-1!==e.getReturnIndex())throw new Error("Programming Error: only the final instruction in a chunk can be converted to broadcast");let t=e.getInstruction(e.getReturnIndex());if(me(t))return e.getReturnIndex();switch(t.type){case 8:case 9:case 10:case 11:case 12:case 13:case 25:case 26:case 27:case 28:case 29:case 32:case 15:case 16:case 14:case 33:case 17:case 18:return ru(e,t);case 42:return Nr(e,ru(e,t));case 37:{let n=gr[t.symbol];switch(n.tag){case"default":case"trig":case"trig2":case"inverseTrig":case"color":return ru(e,t);case"never-broadcast":{let i=[],s=!1;for(let o of t.args){let a=Nr(e,o);a!==o?(s=!0,i.push(a)):i.push(o)}return s?e.copyInstructionWithArgs(t,i):e.getReturnIndex()}case"reducer":if(qR(e,t.args))if(t.args.length===1){let i=t.args[0],s=Nr(e,i);return s!==i?e.copyInstructionWithArgs(t,[s]):e.getReturnIndex()}else return ru(e,t);else return e.getReturnIndex();case"doubleReducer":{if(t.args.length!==2)throw new Error("Programming error: double reducers must have two arguments");let i=Nr(e,t.args[0]),s=Nr(e,t.args[1]);return i!==t.args[0]||s!==t.args[1]?e.copyInstructionWithArgs(t,[i,s]):e.getReturnIndex()}case"parameterizedReducer":{if(t.args.length!==2)throw new Error("Programming error: double reducers must have two arguments");let i=Nr(e,t.args[0]);return i===t.args[0]?ru(e,t,[!1,!0]):e.copyInstructionWithArgs(t,[i,t.args[1]])}default:{let i=n.tag;throw new Error(`Programming Error: unexpected tag ${i}`)}}}case 39:case 40:case 41:return ru(e,t,[!1,!0]);case 21:case 22:case 19:case 20:return e.getReturnIndex();case 38:case 47:case 23:case 24:case 48:case 44:case 49:return e.getReturnIndex();default:let r=t;throw new Error(`Unexpected opcode ${r.type}`)}}function qR(e,t){for(let r of t)if(k(e.getInstruction(r).valueType))return!0;return!1}function ru(e,t,r){let n=t.args,i=!1,s=[];for(let m=0;m<n.length;m++){if(r&&!r[m])continue;let d=n[m],y=e.getInstruction(d).valueType;k(y)&&s.indexOf(d)===-1&&s.push(d),y===Me&&(i=!0)}if(s.length===0)return e.getReturnIndex();if(t.type===33&&s.indexOf(t.args[0])==-1&&s.indexOf(t.args[1])>=0&&s.indexOf(t.args[2])>=0){let m=Nr(e,t.args[1]),d=Nr(e,t.args[2]);return m!==t.args[1]||d!==t.args[2]?Xt(e,t,[t.args[0],m,d]):e.getReturnIndex()}e.popInstruction();let o=yl(e,s);if(o===void 0)throw new Error("Programming Error: expected minListLength to be defined for "+s.length+" lists");let a=o;if(At(e.getInstruction(a))&&Nt(e,a)===0&&i)return e.ConstantOfType(Me,[]);let u=e.BeginBroadcast([a]),l=[];for(let m of s)l.push(ao(e,m,u));let c=[];for(let m=0;m<n.length;m++){let d=n[m];if(r&&!r[m])c.push(d);else{let y=s.indexOf(d);c.push(y===-1?d:l[y])}}let p=e.copyInstructionWithArgs(t,c),f=e.EndBroadcast([u,p]);return e.BroadcastResult(fn(e.getInstruction(p).valueType),[f])}function ao(e,t,r){return e.getInstruction(t).type==48?e.DeferredListAccess([t,r]):e.InboundsListAccess([t,r])}function E0(e){let t=[];t.push("digraph {");for(let r=0;r<e.instructionsLength();r++)e.getInstruction(r).type!==0&&t.push(`${r} [label="${r}: ${pa(e,r)}"];`);for(let r=0;r<e.instructionsLength();r++){let n=e.getInstruction(r);if(zI(n))for(let i of n.args)t.push(`${r} -> ${i};`)}return t.push("}"),t.join(`
`)}function nu(e,t){let r=[];for(let n=0;n<e.instructionsLength();n++)r.push(!1);r[t]=!0;for(let n=0;n<=1;n++){let i=!1;for(let s=t+1;s<e.instructionsLength();s++){let o=e.getInstruction(s);if(me(o)||r[s])continue;let a=!1;for(let u of o.args)if(r[u]){a=!0;break}r[s]=a,a&&Cr(o)&&!r[o.args[0]]&&(r[o.args[0]]=!0,i=!0)}if(!i)break}return r}function v0(e,t,r){let n=e.argNames.indexOf(t);if(n===-1)return 0;let i=Mn(e,n,r);return Kt(i,e.getReturnIndex())}function Mn(e,t,{allowRestriction:r,allowClosedBlockReferences:n}){return{chunk:e,argIndex:t,orderTable:[],mask:nu(e,t),allowRestriction:r,allowClosedBlockReferences:n}}function Kt(e,t){let r=e.orderTable[t];if(r!==void 0)return r;let n=kR(e,t);return e.orderTable[t]=n,n}function kR(e,t){let{chunk:r,mask:n,argIndex:i,allowRestriction:s,allowClosedBlockReferences:o}=e;if(!o&&r.isInClosedBlock(t))return 1/0;if(t===i)return 1;let a=r.getInstruction(t);if(gn(a)||Cr(a))return 1/0;switch(a.type){case 8:case 9:case 26:case 28:case 27:case 29:{let[l,c]=a.args;return Math.max(Kt(e,l),Kt(e,c))}case 10:{let[l,c]=a.args;return Kt(e,l)+Kt(e,c)}case 14:return Kt(e,a.args[0]);case 11:{let[l,c]=a.args;return Kt(e,c)>0?1/0:Kt(e,l)}case 12:case 13:{let[l,c]=a.args,p=r.getInstruction(c);if(Kt(e,l)===0&&Kt(e,c)===0)return 0;if(p.type===1){let f=V(p.value);return f===Math.round(f)&&f>0?Kt(e,l)*f:1/0}else return 1/0}case 33:{if(!n[t])return 0;let l=r.getInstruction(a.args[2]);return s&&l.type===1&&isNaN(V(l.value))?Kt(e,a.args[1]):1/0}case 2:case 0:case 1:case 25:case 32:case 15:case 17:case 16:case 18:case 38:case 39:case 40:case 41:case 37:case 42:case 48:case 47:case 3:case 44:case 49:return n[t]?1/0:0;default:let u=a;throw new Error(`Unexpected opcode ${u.type}`)}}function O0(e,t){let r=e.argNames.indexOf(t),n=hi(Mn(e,r,{allowRestriction:!0,allowClosedBlockReferences:!1}));if(Kt(n.orderCtx,e.getReturnIndex())>2)throw new Error("Programming Error: cannot compute polynomial coefficients for polynomials of order greater than 2");let i=or(n,e.getReturnIndex()),s=!1;for(let o=0;o<e.instructionsLength();o++)e.getInstruction(o).type===33&&n.mask[o]&&(s=!0);return{chunk:n.newChunk,coefficients:i,mappedArgIndex:n.valueMap[r],mappedReturnIndex:n.valueMap[e.getReturnIndex()],isRestrictedPolynomial:s}}function hi(e){let{chunk:t,argIndex:r}=e;if(t.isInClosedBlock(r))throw new Error("Programming Error: cannot find polynomial coefficients of an instruction in a closed block");let n,i;r>=0&&r<t.argNames.length?(n=t.argNames.slice(),i=t.argTypes.slice(),n.splice(r,1),i.splice(r,1)):(n=t.argNames,i=t.argTypes);let s=new Es({argNames:n,argTypes:i}),o=[];for(let p=0;p<t.instructionsLength();p++){let f=t.getInstruction(p);if(f.type===2)p<r||r<0?o.push(p):p===r?o.push(s.SymbolicVar(t.argTypes[p])):o.push(p-1);else if(me(f))o.push(gi(s,f));else{let m=[];for(let d of f.args)m.push(o[d]);o.push(Xt(s,f,m))}}let a=[],u=s.Constant(0),l=s.Constant(1),c=s.Constant(NaN);return{chunk:t,newChunk:s,orderCtx:e,coefficientTable:a,mask:e.mask,valueMap:o,argIndex:r,zero:u,one:l,nan:c}}function or(e,t){let{newChunk:r,orderCtx:n,coefficientTable:i,mask:s,valueMap:o,argIndex:a,zero:u,one:l,nan:c}=e,p=i[t];if(p!==void 0)return p;let f;for(s[t]?t===a?f=[u,l]:Kt(n,t)>2?f=[c]:f=UR(e,t):f=[o[t]];f.length>1;){let m=r.getInstruction(f[f.length-1]);if(m.type===1&&V(m.value)===0)f.pop();else break}if(f.length===0)throw new Error("Programming Error: coefficients cannot be empty");return i[t]=f,f}function UR(e,t){let r=e.chunk.getInstruction(t),{newChunk:n}=e;switch(r.type){case 8:{let[s,o]=r.args,a=or(e,s),u=or(e,o),l=a.length-1,c=u.length-1,p=[];for(let f=0;f<=Math.max(l,c);f++)l>=f&&c>=f?p.push(n.Add([a[f],u[f]])):p.push(l>c?a[f]:u[f]);return p}case 9:case 26:case 28:case 27:case 29:{let[s,o]=r.args;(r.type===26||r.type==28)&&([s,o]=[o,s]);let a=or(e,s),u=or(e,o),l=a.length-1,c=u.length-1,p=[];for(let f=0;f<=Math.max(l,c);f++)l>=f&&c>=f?p.push(n.Subtract([a[f],u[f]])):p.push(l>c?a[f]:n.Negative([u[f]]));return p}case 14:{let s=r.args[0],o=or(e,s),a=[];for(let u=0;u<o.length;u++)a.push(n.Negative([o[u]]));return a}case 10:{let[s,o]=r.args,a=or(e,s),u=or(e,o),l=a.length-1,c=u.length-1,p=[];for(let f=0;f<=l;f++)for(let m=0;m<=c;m++){if(f+m>2)continue;let d=n.Multiply([a[f],u[m]]),y=p[f+m];y===void 0?p[f+m]=d:p[f+m]=n.Add([y,d])}return p}case 11:{let[s,o]=r.args,a=or(e,s),u=or(e,o),l=[];for(let c=0;c<a.length;c++)l.push(n.Divide([a[c],u[0]]));return l}case 12:case 13:{let[s,o]=r.args,a=or(e,s),u=or(e,o);if(a.length-1===0)return[n.RawExponent([a[0],u[0]])];let c=n.getInstruction(u[0]);switch(V(c.value)){case 0:return[n.Constant(0)];case 1:return a;case 2:return[n.Multiply([a[0],a[0]]),n.Multiply([n.Constant(2),n.Multiply([a[0],a[1]])]),n.Multiply([a[1],a[1]])]}}case 33:return or(e,r.args[1]);case 0:case 23:case 2:case 1:case 25:case 32:case 15:case 17:case 16:case 18:case 38:case 39:case 40:case 41:case 37:case 42:case 21:case 22:case 19:case 20:case 24:case 48:case 47:case 3:case 44:case 49:throw new Error(`Cannot find polynomial coefficients of opcode ${r.type} that depends on symbol.`);default:let i=r;throw new Error(`Unexpected opcode ${i.type}`)}}function S0(e){if(e.instructionsLength()-1!==e.getReturnIndex())throw new Error("Programming Error: only the final instruction in a chunk can be converted to broadcast");let t=e.getInstruction(e.getReturnIndex());if(me(t))return e.getReturnIndex();switch(t.type){case 8:if(uo(e,t.args[0])&&uo(e,t.args[1])){let n=e.Constant(1),i=e.Constant(2);return e.OrderedPair([e.Add([e.OrderedPairAccess([t.args[0],n]),e.OrderedPairAccess([t.args[1],n])]),e.Add([e.OrderedPairAccess([t.args[0],i]),e.OrderedPairAccess([t.args[1],i])])])}else if(lo(e,t.args[0])&&lo(e,t.args[1])){let n=e.Constant(1),i=e.Constant(2),s=e.Constant(3);return e.OrderedTriple([e.Add([e.OrderedTripleAccess([t.args[0],n]),e.OrderedTripleAccess([t.args[1],n])]),e.Add([e.OrderedTripleAccess([t.args[0],i]),e.OrderedTripleAccess([t.args[1],i])]),e.Add([e.OrderedTripleAccess([t.args[0],s]),e.OrderedTripleAccess([t.args[1],s])])])}else return e.getReturnIndex();case 9:if(uo(e,t.args[0])&&uo(e,t.args[1])){let n=e.Constant(1),i=e.Constant(2);return e.OrderedPair([e.Subtract([e.OrderedPairAccess([t.args[0],n]),e.OrderedPairAccess([t.args[1],n])]),e.Subtract([e.OrderedPairAccess([t.args[0],i]),e.OrderedPairAccess([t.args[1],i])])])}else if(lo(e,t.args[0])&&lo(e,t.args[1])){let n=e.Constant(1),i=e.Constant(2),s=e.Constant(3);return e.OrderedTriple([e.Subtract([e.OrderedTripleAccess([t.args[0],n]),e.OrderedTripleAccess([t.args[1],n])]),e.Subtract([e.OrderedTripleAccess([t.args[0],i]),e.OrderedTripleAccess([t.args[1],i])]),e.Subtract([e.OrderedTripleAccess([t.args[0],s]),e.OrderedTripleAccess([t.args[1],s])])])}else return e.getReturnIndex();case 14:if(uo(e,t.args[0])){let n=e.Constant(1),i=e.Constant(2);return e.OrderedPair([e.Negative([e.OrderedPairAccess([t.args[0],n])]),e.Negative([e.OrderedPairAccess([t.args[0],i])])])}else if(lo(e,t.args[0])){let n=e.Constant(1),i=e.Constant(2),s=e.Constant(3);return e.OrderedTriple([e.Negative([e.OrderedTripleAccess([t.args[0],n])]),e.Negative([e.OrderedTripleAccess([t.args[0],i])]),e.Negative([e.OrderedTripleAccess([t.args[0],s])])])}else return e.getReturnIndex();case 10:if(uo(e,t.args[0])&&iu(e,t.args[1])){let n=e.Constant(1),i=e.Constant(2);return e.OrderedPair([e.Multiply([e.OrderedPairAccess([t.args[0],n]),t.args[1]]),e.Multiply([e.OrderedPairAccess([t.args[0],i]),t.args[1]])])}else if(iu(e,t.args[0])&&uo(e,t.args[1])){let n=e.Constant(1),i=e.Constant(2);return e.OrderedPair([e.Multiply([t.args[0],e.OrderedPairAccess([t.args[1],n])]),e.Multiply([t.args[0],e.OrderedPairAccess([t.args[1],i])])])}else if(lo(e,t.args[0])&&iu(e,t.args[1])){let n=e.Constant(1),i=e.Constant(2),s=e.Constant(3);return e.OrderedTriple([e.Multiply([e.OrderedTripleAccess([t.args[0],n]),t.args[1]]),e.Multiply([e.OrderedTripleAccess([t.args[0],i]),t.args[1]]),e.Multiply([e.OrderedTripleAccess([t.args[0],s]),t.args[1]])])}else if(iu(e,t.args[0])&&lo(e,t.args[1])){let n=e.Constant(1),i=e.Constant(2),s=e.Constant(3);return e.OrderedTriple([e.Multiply([t.args[0],e.OrderedTripleAccess([t.args[1],n])]),e.Multiply([t.args[0],e.OrderedTripleAccess([t.args[1],i])]),e.Multiply([t.args[0],e.OrderedTripleAccess([t.args[1],s])])])}else return e.getReturnIndex();case 11:if(uo(e,t.args[0])&&iu(e,t.args[1])){let n=e.Constant(1),i=e.Constant(2);return e.OrderedPair([e.Divide([e.OrderedPairAccess([t.args[0],n]),t.args[1]]),e.Divide([e.OrderedPairAccess([t.args[0],i]),t.args[1]])])}else if(lo(e,t.args[0])&&iu(e,t.args[1])){let n=e.Constant(1),i=e.Constant(2),s=e.Constant(3);return e.OrderedTriple([e.Divide([e.OrderedTripleAccess([t.args[0],n]),t.args[1]]),e.Divide([e.OrderedTripleAccess([t.args[0],i]),t.args[1]]),e.Divide([e.OrderedTripleAccess([t.args[0],s]),t.args[1]])])}else return e.getReturnIndex();case 12:case 13:case 25:case 26:case 27:case 28:case 29:case 32:case 15:case 16:case 33:case 17:case 18:case 37:case 42:case 39:case 40:case 41:case 21:case 22:case 19:case 20:case 38:case 47:case 23:case 24:case 48:case 44:case 49:return e.getReturnIndex();default:let r=t;throw new Error(`Unexpected opcode ${r.type}`)}}function uo(e,t){return e.getInstruction(t).valueType===A}function lo(e,t){return e.getInstruction(t).valueType===G}function iu(e,t){return e.getInstruction(t).valueType===x}var HR=["Sum","Product","Integral","List","Derivative","Piecewise","Exponent","PercentOf","FunctionDefinition","UpdateRule","Substitution"],Ff={isGeometryEnabled(){return!1},is3dProduct(){return!1},isBeta3d(){return!1},areAllScalesLinear(){return!0},assignmentForbidden(e){return!0},substitutionForbidden(e){return!0},graphingEnabled(){return!1},isValidSlider(e){return!1},sliderVariables(e){return[]},ansEnabled(){return!1},disabledFeatures(){return HR},dimensionVarsEnabled(){return!1}};function N0(e){return 48<=e&&e<=57}function $R(e){return 97<=e&&e<=122}function YR(e){return 65<=e&&e<=90}function Bf(e){return $R(e)||YR(e)}function Vf(e){return e===92}function hb(e){return e===39}function D0(e){if(9<=e&&e<=13||8192<=e&&e<=8202)return!0;switch(e){case 32:case 160:case 5760:case 8232:case 8233:case 8239:case 8287:case 12288:case 65279:return!0;default:return!1}}function po(e,t){return Yr(e.token.span,t.prevSpan)}function co(e,t,r){return{type:e,span:t,val:r}}function WR(e,t,r,n){return{input:e,prevSpan:t,pos:r,token:n}}function A0(e){return R0(e,0,Ai(e,0))}function R0(e,t,r){for(;D0(e.charCodeAt(t));)t+=1;let n=jR(e,t);return WR(e,r,t,n)}function Wi(e){return R0(e.input,e.token.span.end,e.token.span)}function En(e){return e.token}function vs(e,t){if(En(e).type!==t)throw`Parse Error: expected ${t}.`;return Wi(e)}function C0(e,t){return En(e).type===t}function Gf(e){return e.pos>=e.input.length}var XR={"\\left":"Left","\\right":"Right","\\sqrt":"Sqrt","\\frac":"Frac","\\operatorname":"OperatorName","\\token":"Token"},ZR={"[":"[","]":"]","{":"{","}":"}","^":"^",_:"_"};function jR(e,t){let r=t;if(t>=e.length)return co("End",Ai(e,t),"");let n=e.charCodeAt(t);if(N0(n)){let i=cn(e,r,t+1);return co("Digit",i,e.charAt(r))}else if(Bf(n)){let i=cn(e,r,t+1);return co("Letter",i,e.charAt(r))}else if(Vf(n))if(t+=1,Bf(e.charCodeAt(t))){for(;Bf(e.charCodeAt(t));)t+=1;let i=cn(e,r,t),s=xr(i),o=XR[s]||"Cmd";return co(o,i,s)}else{t+=1;let i=cn(e,r,t),s=xr(i);return co("EscapedSymbol",i,s)}else if(hb(n)){for(t+=1;hb(e.charCodeAt(t));)t+=1;if(e.charAt(t)==="^"){t+=1;let i=cn(e,r,t),s=xr(i);return co("Primes^",i,s)}else{let i=cn(e,r,t),s=xr(i);return co("Primes",i,s)}}else{let i=cn(e,r,t+1),s=e.charAt(r),o=ZR[s]||"Symbol";return co(o,i,s)}}function bb(e,t){return{type:"Group",span:e,args:t}}function L0(e,t,r){return{type:"Sqrt",span:e,optArg:t,arg:r}}function w0(e,t,r){return{type:"Frac",span:e,num:t,den:r}}function _0(e,t,r,n){return{type:"SupSub",span:e,sup:t,sub:r,nprimes:n}}function F0(e,t,r,n){return{type:"LeftRight",span:e,left:t,right:r,arg:n}}function B0(e,t){return{type:"OperatorName",span:e,arg:t}}function V0(e,t){return{type:"TokenNode",span:e,arg:t}}function G0(e,t){return{type:"Symbol",span:e,val:t}}function z0(e){switch(e){case"Frac":return 2;case"^":case"_":case"Primes^":case"Left":case"Sqrt":case"OperatorName":case"Token":return 1;default:return 0}}function q0(e){let{state:t,tree:r}=zf(A0(e),!1);if(!Gf(t))throw`Parse error: unexpected ${xr(En(t).span)}.`;return r}function bi(e,t){return{state:e,tree:t}}function zf(e,t){let r=e,n=[];e:for(;!Gf(e);){let s=En(e);switch(s.type){case"Cmd":case"EscapedSymbol":case"Letter":case"Digit":case"Symbol":case"[":case"{":case"^":case"_":case"Primes":case"Primes^":case"Left":case"Frac":case"Sqrt":case"OperatorName":case"Token":case"]":{if(s.type==="]"&&t)break e;let a;if({state:e,tree:a}=k0(e),a.type==="Group")for(let u of a.args)n.push(u);else n.push(a);break}case"}":case"Right":case"End":break e;default:throw`Unexpected token type ${s.type}.`}}let i=po(r,e);return bi(e,bb(i,n))}function k0(e){let t=En(e);switch(t.type){case"Cmd":case"EscapedSymbol":case"Letter":case"Digit":case"Symbol":return e=Wi(e),bi(e,t);case"[":case"]":return e=Wi(e),bi(e,G0(t.span,t.val));case"{":{e=Wi(e);let n;return{state:e,tree:n}=zf(e,!1),e=vs(e,"}"),bi(e,n)}case"^":case"_":case"Primes":case"Primes^":return nC(e);case"Left":return rC(e);case"Frac":return tC(e);case"Sqrt":return eC(e);case"OperatorName":return QR(e);case"Token":return KR(e);case"}":case"Right":throw`Parse Error: unexpected ${t.val}.`;case"End":throw"Parse Error: unexpected end.";default:throw`Unexpected token type ${t.type}.`}}function QR(e){let t=e,r=En(e);e=vs(e,"OperatorName");let n;({state:e,tree:n}=fo(e,r));let i=po(t,e);return bi(e,B0(i,n))}function KR(e){let t=e,r=En(e);e=vs(e,"Token");let n;({state:e,tree:n}=fo(e,r));let i=po(t,e);return bi(e,V0(i,n))}function eC(e){let t=e,r=En(e);e=vs(e,"Sqrt");let n;C0(e,"[")&&({state:e,tree:n}=iC(e));let i;({state:e,tree:i}=fo(e,r));let s=po(t,e);return bi(e,L0(s,n,i))}function tC(e){let t=e,r=En(e);e=vs(e,"Frac");let n;({state:e,tree:n}=fo(e,r));let i;({state:e,tree:i}=fo(e,r));let s=po(t,e);return bi(e,w0(s,n,i))}function rC(e){let t=e;e=vs(e,"Left");let r=En(e);e=Wi(e);let n;({state:e,tree:n}=zf(e,!1)),e=vs(e,"Right");let i=En(e);e=Wi(e);let s=po(t,e);return bi(e,F0(s,r,i,n))}function nC(e){let t=e,r,n,i=0;e:for(;!Gf(e);){let o=En(e);switch(o.type){case"^":if(e=Wi(e),r)throw"Parse Error: double superscript.";({state:e,tree:r}=fo(e,o));break;case"_":if(e=Wi(e),n)throw"Parse Error: double subscript.";({state:e,tree:n}=fo(e,o));break;case"Primes":if(e=Wi(e),i>0)throw"Parse Error: double primes.";i=o.val.length;break;case"Primes^":if(e=Wi(e),i>0)throw"Parse Error: double primes.";if(r)throw"Parse Error: double superscript";i=o.val.length-1,{state:e,tree:r}=fo(e,o);break;default:break e}}let s=po(t,e);return bi(e,_0(s,r,n,i))}function fo(e,t){let r=z0(t.type),n;if(r<=0)throw new Error("Programming Error: greediness must be greater than 0.");let i=z0(En(e).type);if(i>0&&i<=r){let s=xr(t.span);throw`Parse Error: can't use ${xr(En(e).span)} as argument of ${s}. Use {}.`}return{state:e,tree:n}=k0(e),n.type!=="Group"&&(n=bb(n.span,[n])),bi(e,n)}function iC(e){e=vs(e,"[");let t;return{state:e,tree:t}=zf(e,!0),e=vs(e,"]"),bi(e,t)}var sC={mcd:"gcd",gcf:"gcd",mcm:"lcm",signum:"sign",sgn:"sign",stdDevP:"stdevp",stddevp:"stdevp",stdDev:"stdev",stddev:"stdev",variance:"var",TTest:"ttest",TScore:"tscore",IndependentTTest:"ittest",iTTest:"ittest",inverseCdf:"quantile",inversecdf:"quantile",arsinh:"arcsinh",arcosh:"arccosh",artanh:"arctanh",arcsch:"arccsch",arsech:"arcsech",arcoth:"arccoth"};function U0(e){let t=0;for(;Vf(e.charCodeAt(t));)t+=1;return t>0&&(e=e.slice(t)),sC[e]||e}function H0(e,t){return{type:"Equals",span:e,args:t}}function xl(e,t,r){return{type:"Inequality",span:e,symbol:t,args:r}}function $0(e,t,r){return{type:"TrailingInequalityPiece",span:e,symbol:t,args:r}}function Y0(e,t,r){return{type:"InequalityChain",span:e,first:t,chain:r}}function W0(e,t){return{type:"Tilde",span:e,args:t}}function X0(e,t){return{type:"Pos",span:e,args:t}}function Z0(e,t){return{type:"Neg",span:e,args:t}}function j0(e,t){return{type:"Add",span:e,args:t}}function J0(e,t){return{type:"Sub",span:e,args:t}}function Q0(e,t){return{type:"Mul",span:e,args:t}}function K0(e,t){return{type:"DotMul",span:e,args:t}}function eM(e,t){return{type:"CrossMul",span:e,args:t}}function tM(e,t){return{type:"Div",span:e,args:t}}function rM(e,t){return{type:"Bang",span:e,args:t}}function Tl(e,t){return{type:"Call",span:e,args:t}}function xb(e,t){return{type:"ImplicitCall",span:e,args:t}}function nM(e,t){return{type:"Index",span:e,args:t}}function Tb(e,t){return{type:"Paren",span:e,args:t}}function Pb(e,t){return{type:"List",span:e,args:t}}function iM(e,t){return{type:"Pipes",span:e,args:t}}function Ib(e,t){return{type:"Subscript",span:e,args:t}}function qf(e,t){return{type:"Superscript",span:e,args:t}}function Pl(e,t,r){return{type:"Prime",span:e,nprimes:t,args:r}}function kf(e,t){return{type:"Seq",span:e,args:t}}function sM(e,t){return{type:"Sqrt",span:e,args:t}}function oM(e,t){return{type:"Nthroot",span:e,args:t}}function aM(e,t){return{type:"Frac",span:e,args:t}}function uM(e,t){return{type:"Derivative",span:e,args:t}}function lM(e,t){return{type:"Integral",span:e,args:t}}function cM(e,t){return{type:"EmptyIntegral",span:e,args:t}}function pM(e,t){return{type:"Sum",span:e,args:t}}function fM(e,t){return{type:"Product",span:e,args:t}}function dM(e,t){return{type:"Piecewise",span:e,args:t}}function mM(e){return{type:"EmptyPiecewise",span:e}}function yM(e){return{type:"EmptyRangeEnd",span:e}}function gM(e,t){return{type:"Colon",span:e,args:t}}function Mb(e,t){return{type:"Ellipsis",span:e,args:t}}function hM(e,t){return{type:"For",span:e,args:t}}function bM(e,t){return{type:"With",span:e,args:t}}function xM(e,t){return{type:"Dot",span:e,args:t}}function TM(e,t){return{type:"PercentOf",span:e,args:t}}function PM(e,t){return{type:"RightArrow",span:e,args:t}}function Eb(e,t){return{type:"Juxt",span:e,args:t}}function IM(e,t){return{type:"Letter",span:e,val:t}}function Uf(e,t){return{type:"Decimal",span:e,val:t}}function da(e,t){return{type:"Cmd",span:e,val:U0(t)}}function MM(e,t){return{type:"Alphanumeric",span:e,val:t}}function EM(e,t,r,n){return{type:"MixedNumber",span:e,whole:t,num:r,den:n}}function Hr(e){if(e.type==="Subscript"){if(e.args[1].type!=="Alphanumeric")return!1;e=e.args[0]}switch(e.type){case"Cmd":return!0;case"Letter":return!0;default:return!1}}function vM(e){return e.type!=="Superscript"?!1:Hr(e.args[0])}function OM(e,t){if(e.type!=="Letter"||e.val!=="d"||t.type!=="Juxt")return!1;let[r,n]=t.args;return r.type!=="Letter"||r.val!=="d"?!1:Hr(n)}function Lr(e){return e.type==="Seq"?e.args:[e]}function se(e,t){return{type:"Err",span:e,error:t}}function vb(){return{type:"UnexpectedParseError"}}function SM(){return{type:"EmptyInput"}}function NM(){return{type:"EmptyGroup"}}function Ob(){return{type:"EmptySubscript"}}function DM(){return{type:"EmptySuperscript"}}function Sb(){return{type:"EmptyRadical"}}function AM(){return{type:"EmptySquareBracket"}}function RM(){return{type:"EmptyPipe"}}function CM(){return{type:"EmptyRadicalIndex"}}function Nb(){return{type:"UnexpectedEnd"}}function mo(e){return{type:"BinaryOperatorMissingRight",val:e}}function LM(e){return{type:"BinaryOperatorMissingLeft",val:e}}function Db(e){return{type:"UnaryOperatorMissingRight",val:e}}function Ab(e){return{type:"UnaryOperatorMissingLeft",val:e}}function wM(e,t){return{type:"MissingCloseDelimiter",open:e,close:t}}function Il(e,t){return{type:"UnexpectedCloseDelimiter",open:e,close:t}}function _M(){return{type:"UnexpectedDifferential"}}function FM(e){return{type:"UnrecognizedSymbol",val:e}}function BM(e){return{type:"InvalidSubscript",val:e}}function VM(e){return{type:"UnexpectedSubscript",base:e}}function Rb(e){return{type:"FunctionMissingArgument",val:e}}function GM(){return{type:"PercentMissingOf"}}function Cb(){return{type:"PrimeWithoutParen"}}function zM(){return{type:"SuperscriptWithPrime"}}function Hf(){return{type:"UnexpectedPrime"}}function qM(){return{type:"SumMissingBound"}}function kM(){return{type:"ProductMissingBound"}}function Lb(){return{type:"MissingBound"}}function UM(){return{type:"IntegralMissingBound"}}function HM(){return{type:"SumMissingBody"}}function $M(){return{type:"ProductMissingBody"}}function YM(){return{type:"IntegralMissingBody"}}function WM(){return{type:"DerivativeMissingBody"}}function XM(){return{type:"IntegralMissingDifferential"}}function ZM(){return{type:"DifferentialWithSuperscript"}}function jM(){return{type:"FractionMissingNumerator"}}function JM(){return{type:"FractionMissingDenominator"}}function QM(){return{type:"FractionEmpty"}}function wb(e){return{type:"AdjacentNumbers",args:e}}function KM(){return{type:"UnexpectedFor"}}function eE(){return{type:"TokenWithSubscript"}}var uC={"+":!0,"-":!0,"*":!0,"\\cdot":!0,"\\times":!0,"/":!0,"!":!0,"(":!0,")":!0,"\\{":!0,"\\}":!0,"(|":!0,"|)":!0,"[":!0,"]":!0,",":!0,"...":!0,":":!0,"=":!0,">":!0,"<":!0,">=":!0,"<=":!0,"->":!0,"~":!0,"%":!0,".":!0,for:!0,with:!0,Letter:!0,Decimal:!0,Cmd:!0,TokenNode:!0,Differential:!0,End:!0,Trig:!0,Ln:!0,Log:!0,Int:!0,Sum:!0,Prod:!0,Err:!0},yo={"\\lt":"<","\\gt":">","\\le":"<=","\\ge":">=","\\leq":"<=","\\geq":">=","\\ldots":"...","\\sim":"~","\\to":"->","\\cdot":"\\cdot","\\times":"\\times","\\div":"/","\\ln":"Ln","\\log":"Log","\\int":"Int","\\sum":"Sum","\\prod":"Prod","\\backslash":"Err","\\for":"for","\\with":"with"},lC=["sin","cos","tan","cot","sec","csc"];for(let e of lC)yo["\\"+e]="Trig",yo["\\"+e+"h"]="Trig",yo["\\arc"+e]="Trig",yo["\\arc"+e+"h"]="Trig",yo["\\ar"+e+"h"]="Trig";var _b={"+":"+","-":"-","*":"*","/":"/","!":"!","(":"(",")":")","[":"[","]":"]",",":",","...":"...",":":":","=":"=",">=":">=","<=":"<=",">":">","<":"<","~":"~",".":"."},tE={"\\{":"\\{","\\}":"\\}","\\%":"%"},rE={"|":"(|","\\{":"\\{","[":"[","(":"("},nE={"|":"|)","\\}":"\\}","]":"]",")":")"},iE=Object.keys(uC);function sE(e,t,r,n,i,s,o,a){return{opts:e,input:t,prevSpan:r,startIndex:n,endIndex:i,token:s,mode:o,parent:a}}function K(e,t){return Yr(e.token.span,t.prevSpan)}function ir(e,t){return Yr(e,t.prevSpan)}function Bb(e){return Ai(e.token.span.input,e.token.span.start)}function cC(e,t){return{type:"Differential",span:e,val:t}}function nn(e,t,r){return{type:e,span:t,val:r}}function $s(e,t){let r=Ai(e.span.input,e.span.start);return Vb(t,e,0,r,void 0,void 0)}function Vb(e,t,r,n,i,s){let o=t.args;if(r>o.length&&s)return oE(s,n);r=Ml(o,r);let{token:a,endIndex:u}=aE(t,r,i);if(a.type==="End"&&s){let l=s.input.args[s.startIndex];if(l.type==="LeftRight"){let c=l.right,p=nE[c.val]||"Err",f=nn(p,c.span,c.val);return sE(e,t,n,r,u,f,i,s)}}else a.type==="Int"?i=pC(i):a.type==="Differential"&&(i=fC(i));return sE(e,t,n,r,u,a,i,s)}function ce(e){let t=e.input.args[e.startIndex],r=e.token.span;return t&&t.type==="LeftRight"?Vb(e.opts,t.arg,0,r,e.mode,e):oE(e,r)}function oE(e,t){let{input:r,endIndex:n,mode:i,parent:s}=e;return Vb(e.opts,r,n+1,t,i,s)}function wr(e){return e.token}function pC(e){return{type:"integral",parent:e}}function fC(e){if(!e||e.type!=="integral")throw new Error("Programming Error: expected lexer to be in integral mode.");return e.parent}function _r(e,t){return wr(e).type===t}function Wf(e){return e.startIndex>=e.input.args.length}function Gb(e,t){return t.token.span.start>e.token.span.start}function Pr(e,t){return{token:t,endIndex:e}}function aE(e,t,r){let n=e.args;if(t>=n.length){let o=Ai(e.span.input,e.span.end);return Pr(t,nn("End",o,""))}let i=e.args[t];switch(i.type){case"Sqrt":case"Frac":case"SupSub":return Pr(t,i);case"Letter":{if(!r||r.type!=="integral"||i.val!="d")return Pr(t,i);let{endIndex:c,token:p}=aE(e,t+1,r);if(p.type==="Letter"||p.type==="Cmd"){let f=cC(Yr(i.span,p.span),p.val);return Pr(c,f)}else return Pr(t,i)}case"LeftRight":{let c=i.left,p=rE[c.val]||"Err";var s=Yr(i.span,c.span);return Pr(t,nn(p,s,c.val))}case"OperatorName":let o=[];for(let c of i.arg.args){if(c.type!=="Letter")return Pr(t,nn("Err",i.span,xr(i.arg.span)));o.push(c.val)}let a="\\"+o.join(""),u=yo[a]||"Cmd";return Pr(t,nn(u,i.span,a));case"TokenNode":{let c="$";if(i.arg.args.length===0)return Pr(t,nn("Err",i.span,xr(i.arg.span)));for(let p of i.arg.args){if(p.type!=="Digit")return Pr(t,nn("Err",i.span,xr(i.arg.span)));c+=p.val}return Pr(t,nn("TokenNode",i.span,c))}case"Cmd":{let c=yo[i.val]||"Cmd";return Pr(t,nn(c,i.span,i.val))}case"EscapedSymbol":{let c=tE[i.val]||"Err";return Pr(t,nn(c,i.span,i.val))}case"Symbol":return dC(e,t,i);case"Digit":return uE(e,t);default:throw`Unexpected atom ${i.type}.`}}function dC(e,t,r){switch(r.val){case".":return mC(e,t);case"-":{let i=e.args[t+1];if(i&&$f(i,">")){let s=nn("->",Yr(r.span,i.span),"->");return Pr(t+1,s)}break}case"<":{let i=e.args[t+1];if(i&&$f(i,"=")){let s=nn("<=",Yr(r.span,i.span),"<=");return Pr(t+1,s)}break}case">":{let i=e.args[t+1];if(i&&$f(i,"=")){let s=nn(">=",Yr(r.span,i.span),">=");return Pr(t+1,s)}break}}let n=_b[r.val]||"Err";return Pr(t,nn(n,r.span,r.val))}function mC(e,t){let r=e.args[t];if(r.type!=="Symbol"||r.val!==".")throw new Error("Programming Error: expected '.'");if(t+2<e.args.length&&Yf(e.args[t+1])&&Yf(e.args[t+2])){let s=Yr(r.span,e.args[t+2].span);return Pr(t+2,nn("...",s,xr(s)))}let n=Ml(e.args,t+1);if(n<e.args.length&&e.args[n].type==="Digit")return uE(e,t);let i=_b[r.val]||"Err";return Pr(t,nn(i,r.span,r.val))}function uE(e,t){let r=yC(e,t);if(r)return r;let n=e.args,i=e.args[t].span,s=[],o=!1,a=!1;for(;t<n.length;t++){let l=Ml(n,t);if(l>=n.length)break;let c=n[l];if(c.type==="Digit")t=l,o=!0,s.push(c.val);else if(!a&&Yf(c)){if(l+1<n.length&&Yf(e.args[l+1]))break;t=l,a=!0,s.push(".")}else break}if(!o)throw new Error("Programming Error: decimals must have at least one digit.");let u=Yr(i,e.args[t-1].span);return Pr(t-1,nn("Decimal",u,s.join("")))}function yC(e,t){let r=e.args,n=r[t].span,i=[];for(;t<r.length;t++){let l=Ml(r,t);if(l>=r.length)break;let c=r[l];if(c.type!=="Digit")break;t=l,i.push(c.val)}if(t=Ml(r,t),t>=r.length)return;let s=r[t];if(s.type!=="Frac")return;let o=[],a=[];for(let l of s.num.args)if(!Fb(l)){if(l.type!=="Digit")return;o.push(l.val)}for(let l of s.den.args)if(!Fb(l)){if(l.type!=="Digit")return;a.push(l.val)}let u=Yr(n,s.span);return Pr(t,EM(u,i.join(""),o.join(""),a.join("")))}function Fb(e){switch(e.type){case"Sqrt":case"Frac":case"SupSub":case"LeftRight":case"OperatorName":case"TokenNode":case"Symbol":case"Letter":case"Digit":return!1;case"Cmd":return e.val==="\\space";case"EscapedSymbol":return e.val==="\\ "||e.val==="\\:"||e.val==="\\,"||e.val==="\\;";default:throw`Unexpected atom ${e.type}.`}}function Ml(e,t){for(;t<e.length&&Fb(e[t]);)t+=1;return t}function Yf(e){return $f(e,".")}function $f(e,t){return e.type==="Symbol"&&e.val===t}function su(e){return{type:"initial",tokenType:e}}function El(e){return{type:"l",tokenType:e}}function vl(e){return{type:"r",tokenType:e}}function Qe(e){return{type:"la",tokenType:e}}function ou(e){return{type:"ra",tokenType:e}}function lE(e,t){for(let r of iE)if(t[r]===void 0)throw new Error(`Programming Error: token ${r} must be a assigned a ${e} precedence`)}function ma(e,t,r,n){if(t[r]!==void 0)throw new Error(`Programming Error: duplicate ${e} entry for token ${r}.`);t[r]=n}function cE(e){let t={},r={},n={};for(let a=0;a<e.length;a++){let u=e[a];for(let{type:l,tokenType:c}of u)switch(l){case"initial":ma("initial",t,c,a);break;case"l":ma("left",r,c,a);break;case"r":ma("right",n,c,a);break;case"la":ma("left",r,c,a),ma("right",n,c,a);break;case"ra":ma("left",r,c,a),ma("right",n,c,a-1);break}}lE("left",r),lE("right",n);function i(a){return n[a]}function s(a){return r[a]}function o(a){let u=t[a];return u===void 0?i(a):u}return{rightPrec:i,leftPrec:s,initialPrec:o}}var au={},gC=["sin","cos","tan","cot","sec","csc","sinh","cosh","tanh","coth","sech","csch"];gC.forEach(function(e){au[e]="arc"+e,au["arc"+e]=e});var hC=0;function yE(e,t){return bC(e,t)}function Le(e,t){let r=[];for(let n=0;n<t.length;n++)r.push(Zt(e,t[n]));return r}function bC(e,t){return e.setInput(xC(e,t),t.span)}function gE(e){if(e.type!=="Call")return;let[t,r]=e.args,n=Lr(r);if(Hr(t)&&n.every(Hr))return{base:t,args:n}}function hE(e){return gE(e)!==void 0}function bE(e){return e.type==="Paren"&&e.args[0].type==="Seq"&&e.args[0].args.every(Hr)}function qb(e){return Hr(e)||bE(e)}function xC(e,t){let r=e.nodes;switch(t.type){case"Equals":{let[n,i]=t.args,s=gE(n);if(s){let{base:o,args:a}=s;return r.FunctionDefinition(Zt(e,o),Le(e,a),Zt(e,i))}else if(qb(n)){let o=Zt(e,i);return bE(n)?r.CoordinateEquation(Zt(e,n),o):r.Assignment(Zt(e,n),o)}return r.Equation(Zt(e,n),Zt(e,i))}case"Tilde":{let[n,i]=Le(e,t.args);return r.Regression(n,i)}case"Inequality":return ya(e,t);case"InequalityChain":{if(t.chain.length>1)throw pp();let{first:{symbol:n,args:[i,s]},chain:[{symbol:o,args:[a]}]}=t;return Hr(s)?r.DoubleInequality([Zt(e,i),n,Zt(e,s),o,Zt(e,a)]):ya(e,t)}case"Call":{let[n,i]=t.args;if(n.type==="Cmd")switch(n.val){case"histogram":return r.Histogram(Le(e,Lr(i)));case"dotplot":return r.DotPlot(Le(e,Lr(i)));case"boxplot":return r.BoxPlot(Le(e,Lr(i)));case"ttest":return r.TTest(Le(e,Lr(i)));case"ittest":return r.IndependentTTest(Le(e,Lr(i)));case"stats":return r.Stats(Le(e,Lr(i)));default:return go(e,t)}return go(e,t)}default:return go(e,t)}}function xE(e){if(e.type!=="Paren")return!1;let[t]=e.args;return t.type!=="Seq"?!1:t.args.length===2||t.args.length===3}function Zt(e,t){return e.setInput(go(e,t),t.span)}function go(e,t){let r=e.nodes;switch(t.type){case"Pos":return go(e,t.args[0]);case"Neg":let n=-1,i=t.args[0];for(;;)if(i.type==="Pos"||i.type==="Paren"&&!xE(i))i=i.args[0];else if(i.type==="Neg")i=i.args[0],n*=-1;else break;switch(i.type){case"Decimal":{let o=fE(i);return r.Constant(n===-1?qn(o):o)}case"MixedNumber":{let o=dE(i);return r.MixedNumber(n===-1?qn(o):o)}default:return n===-1?r.Negative([Zt(e,i)]):go(e,i)}case"Add":return r.Add(Le(e,t.args));case"Sub":return r.Subtract(Le(e,t.args));case"Mul":return r.Multiply(Le(e,t.args));case"DotMul":return r.DotMultiply(Le(e,t.args));case"CrossMul":return r.CrossMultiply(Le(e,t.args));case"Div":return r.Divide(Le(e,t.args));case"Bang":{let[o]=t.args;return o.type==="Call"?r.FunctionFactorial(Le(e,o.args)):r.FunctionCall("\\factorial",Le(e,t.args))}case"PercentOf":return r.PercentOf(Le(e,t.args));case"Call":return pE(e,t);case"ImplicitCall":return vC(t),pE(e,t);case"Dot":{let o=t.args[1],[a,u]=Le(e,t.args);if(IE(o)){let l=Ai(o.span.input,o.span.end),c=e.setInput(ME(e),l);u=e.setInput(r.SeededFunctionCall(u,[c]),o.span)}else if(o.type==="Letter")switch(o.val){case"x":case"y":case"z":return r.NamedCoordinateAccess(o.val,[a]);default:break}else if(o.type==="Call"){let l=o.args[0];if(l.type==="Letter")switch(l.val){case"x":case"y":case"z":return r.Multiply([e.setInput(r.NamedCoordinateAccess(l.val,[a]),Yr(t.args[0].span,l.span)),Zt(e,o.args[1])])}}return r.DotAccess([a,u])}case"Prime":{let[o]=t.args;if(o.type==="Call"){let[a,u]=o.args,l=Lr(u).length;if(a.type==="Cmd"&&a.val==="logbase"){if(l!==2)throw Jo()}else if(l!==1)throw Jo();return r.Prime(t.nprimes,Le(e,t.args))}else throw o.type==="ImplicitCall"?cp():lp()}case"Index":{let[o,a]=t.args;if(a.type==="Seq")return r.ListAccess([Zt(e,o),e.setInput(r.List(Le(e,a.args)),void 0)]);if(a.type==="Ellipsis"){let[u,l]=a.args;return r.ListAccess([Zt(e,o),e.setInput(r.Range([e.setInput(r.List(Le(e,Lr(u))),void 0),e.setInput(r.List(l.type==="EmptyRangeEnd"?[]:Le(e,Lr(l))),void 0)]),void 0)])}return PE(a)?r.ListAccess([Zt(e,o),e.setInput(ya(e,a),void 0)]):r.ListAccess(Le(e,t.args))}case"Paren":{let[o]=t.args;if(o.type==="Seq"){if(o.args.length===0)throw Hy();return r.ParenSeq(Le(e,o.args))}else return go(e,o)}case"List":{if(t.args.length===0)return r.List([]);let o=t.args[0];if(o.type==="Ellipsis"){let[a,u]=o.args;return r.Range([e.setInput(r.List(Le(e,Lr(a))),void 0),e.setInput(r.List(Le(e,Lr(u))),void 0)])}else if(o.type==="For"){let[a,u]=o.args,l=e.setInput(r.Identifier(`_comprehensionIndex_${hC++}`),void 0),c=Zt(Xf(e,{prefix:"li",expr:l}),a),p=[];for(let f of Lr(u)){if(!Ol(f))throw Wg();p.push(e.setInput(r.AssignmentExpression(Le(e,f.args)),f.span))}return r.ListComprehension(l,c,p)}return r.List(Le(e,Lr(o)))}case"Pipes":{let[o]=t.args;return r.Norm([Zt(e,o)])}case"Subscript":{let[o,a]=t.args;if(a.val.length===0)throw up();let u;switch(o.type){case"Letter":u=o.val;break;case"Cmd":u=o.val;break;default:throw zy()}return r.Identifier(`${u}_${a.val}`)}case"Superscript":{let[o,a]=t.args;if(o.type==="Call"&&o.args[1].type!=="Seq"&&!OC(o))return r.FunctionExponent(Le(e,[o.args[0],o.args[1],a]));if(o.type==="Dot"){let u=o.args[1],[l,c]=Le(e,o.args),p=Zt(e,a);if(u.type==="Letter")switch(u.val){case"x":case"y":case"z":return r.Exponent([e.setInput(r.NamedCoordinateAccess(u.val,[l]),o.span),p]);default:break}else if(u.type==="Call"){let f=u.args[0];if(f.type==="Letter")switch(f.val){case"x":case"y":case"z":return r.Multiply([e.setInput(r.NamedCoordinateAccess(f.val,[l]),Yr(o.args[0].span,f.span)),e.setInput(r.Exponent([Zt(e,u.args[1]),p]),cn(t.span.input,u.args[0].span.end,a.span.end))]);default:break}}return r.Exponent([e.setInput(r.DotAccess([l,c]),o.span),p])}else return r.Exponent(Le(e,t.args))}case"Sqrt":return r.FunctionCall("sqrt",Le(e,t.args));case"Nthroot":return r.FunctionCall("nthroot",Le(e,[t.args[1],t.args[0]]));case"Frac":return r.Divide(Le(e,t.args));case"Derivative":{let o=Le(e,t.args);if(!Hr(t.args[0]))throw Ce();return r.Derivative(o[0],[o[1]])}case"Integral":{let[o,a,u,l]=t.args,c=Le(e,[o,a,u,l]);return r.Integral(c)}case"EmptyIntegral":{let[o,a,u]=Le(e,t.args),l=e.setInput(r.Constant(he(1,1)),void 0);return r.Integral([o,a,u,l])}case"Sum":{let[o,a,u]=t.args;if(!Ol(a))throw Ng();let l=Le(e,[a.args[0],a.args[1],u]),c=Zt(Xf(e,{prefix:"ro",expr:l[0]}),o);return r.Sum(l.concat(c))}case"Product":{let[o,a,u]=t.args;if(!Ol(a))throw Dg();let l=Le(e,[a.args[0],a.args[1],u]),c=Zt(Xf(e,{prefix:"ro",expr:l[0]}),o);return r.Product(l.concat(c))}case"Juxt":{if(e.writeIntegral){let[o,a]=t.args;if(a.type==="Letter"&&a.val==="t"&&o.type==="Juxt"&&([o,a]=o.args,a.type==="Letter"&&a.val==="n")){if(o.type==="Juxt"){if([o,a]=o.args,a.type==="Letter"&&a.val==="i")throw Ep()}else if(o.type==="Letter"&&o.val==="i")throw Ep()}}return r.Multiply(Le(e,t.args))}case"Letter":return r.Identifier(t.val);case"Cmd":{let o=t.val;switch(o){case"ans":{if(e.currentIndex===void 0)throw Wu("ans");return r.Ans(`ans_{${e.currentIndex-1}}`)}case"approx":throw Yc(o);case"dt":{if(!e.allowDt)throw Wu(o);return r.Identifier(o)}case"index":{if(!e.allowIndex)throw Wu(o);return r.Identifier(o)}default:return r.Identifier(o)}}case"With":{if(e.isSubstitutionRHS)throw Rp();let[o,a]=t.args,u=ue(X({},e),{isSubstitutionRHS:!0});return r.Substitution(Zt(u,o),IC(u,a))}case"Decimal":return r.Constant(fE(t));case"MixedNumber":return r.MixedNumber(dE(t));case"Piecewise":return EC(e,t);case"RightArrow":return MC(e,t);case"Seq":return r.BareSeq(Le(e,t.args));case"EmptyPiecewise":if(!r.Piecewise.empty)throw na();return r.Piecewise.empty();case"Equals":throw dn("=");case"Inequality":case"InequalityChain":throw Dm();case"Tilde":throw dn("~");case"Colon":throw dn(":");case"Ellipsis":throw dn("...");case"For":throw Sp();case"EmptyRangeEnd":throw vg();case"Err":throw SC(t.error);default:throw`Unexpected surface node ${t.type}.`}}function zb(e){return au.hasOwnProperty(e)}function TE(e){return e==="ln"||e==="log"||e==="logbase"}function TC(e){return e.type==="Decimal"&&e.val==="2"}function PC(e){return e.type!=="Neg"?!1:(e=e.args[0],e.type==="Decimal"&&e.val==="1")}function pE(e,t){let r=e.nodes,[n,i]=t.args,s=Zt(e,n),o=Lr(i),a=Le(e,o);if(IE(n)){let u=Ai(i.span.input,i.span.start),l=e.setInput(ME(e),u);return r.SeededFunctionCall(s,[l].concat(a))}if(Hr(n))return r.FunctionCall(s,a);if(n.type==="Superscript"){let[u,l]=n.args;if(u.type==="Cmd"){let c=u.val;if(zb(c)||TE(c)){if(TC(l))return r.Exponent([e.setInput(r.FunctionCall(c,a),void 0),Zt(e,l)]);if(PC(l)&&au[c]!==void 0)return r.FunctionCall(au[c],a);throw zb(c)?Wy(c):Xy(c==="logbase"?"log":c)}}}return r.Multiply([s,Zt(e,i)])}function IC(e,t){let r=e.nodes;if(t.type==="Seq"){let o=!1,a=!1;for(let u=0;u<t.args.length;u++){if(t.args[u].type==="With")throw Qu();Ol(t.args[u])?o=!0:a=!0}if(o&&a)throw Qu()}if(t.type==="With")throw Rp();let n=Lr(t),i=[],s=[];for(let o of n){if(!Ol(o))throw Kg();let a=e.setInput(r.AssignmentExpression(Le(e,o.args)),o.span),u=a._symbol;if(s.indexOf(u)>=0)throw nh(u);s.push(u),i.push(a)}return i}function MC(e,t){let r=e.nodes;if(!Hr(t.args[0]))throw uy();return e=Xf(e,{prefix:"ec",expr:e.setInput(r.Identifier("globalEventCount"),void 0)}),r.UpdateRule(Le(e,t.args))}function EC(e,t){let r=e.nodes,[n]=t.args,i=Lr(n),s,o=[];e:for(s=0;s<i.length;s++){let f=i[s];switch(f.type){case"Colon":{let[m,d]=f.args;if(!PE(m))throw Jy();if(d.type==="With"&&d.args[1].type==="Seq")throw Qu();o.push({condition:e.setInput(ya(e,m),m.span),if_expr:Zt(e,d)});break}case"Equals":case"Inequality":case"InequalityChain":o.push({condition:e.setInput(ya(e,f),f.span),if_expr:e.setInput(r.Constant(he(1,1)),cn("1",0,1))});break;default:break e}}if(s===0)throw Zy();if(s<i.length-1)throw jy();let a,u;s===i.length-1?(a=go(e,i[s]),u=i[s]):a=r.Constant(NaN);let l=a,c=u==null?void 0:u.span,p;for(;o.length;)p=o.pop(),l=r.Piecewise([p.condition,p.if_expr,e.setInput(l,c)]),c=void 0;return l}function PE(e){return e.type==="Equals"||e.type==="Inequality"||e.type==="InequalityChain"}function ya(e,t){let r=e.nodes;switch(t.type){case"Equals":return r.Comparator["="](Le(e,t.args));case"Inequality":return r.Comparator[t.symbol](Le(e,t.args));case"InequalityChain":if(t.chain.length>1)throw pp();let{first:{symbol:n,args:[i,s]},chain:[{symbol:o,args:[a]}]}=t,u=Ai(t.span.input,t.span.start);return r.And([e.setInput(ya(e,xl(u,n,[i,s])),Yr(i.span,s.span)),e.setInput(ya(e,xl(u,o,[s,a])),Yr(s.span,a.span))]);default:throw Ce()}}function vC(e){let[t,r]=e.args;if(t.type==="Superscript"&&(t=t.args[0]),t.type==="Cmd"&&t.val==="logbase"&&r.type==="Seq"&&r.args.length===2){if(!Xi(r.args[0]))throw ap("log")}else if(!Xi(r))throw t.type==="Cmd"?ap(t.val):Ce()}function fE(e){return Vo(e.val)}function dE(e){let t=Vo(e.whole),r=Vo(e.num),n=Vo(e.den);return us(t,Fi(r,n))}function OC(e){if(e.type!=="Call")return!1;let t=e.args[0];for(;t.type==="Superscript"||t.type==="Subscript"||t.type==="Prime";)t=t.args[0];return t.type!=="Cmd"?!1:zb(t.val)||TE(t.val)}function Ol(e){return e.type==="Equals"&&Hr(e.args[0])}function SC(e){switch(e.type){case"UnexpectedParseError":case"MissingBound":case"EmptyGroup":case"UnexpectedDifferential":case"UnexpectedEnd":return Ce();case"InvalidOperatorName":return Gy();case"UnexpectedCloseDelimiter":case"MissingCloseDelimiter":return Gg(e.open,e.close);case"UnrecognizedSymbol":return e.val==="."?dn(e.val):Yc(e.val);case"EmptyInput":return Qy();case"BinaryOperatorMissingRight":case"BinaryOperatorMissingLeft":return qu(e.val==="%"?"% of":e.val);case"UnaryOperatorMissingLeft":return Cy(e.val);case"UnaryOperatorMissingRight":return Ly(e.val);case"UnexpectedSubscript":return Ky(e.base);case"PercentMissingOf":return kg();case"SumMissingBound":return Og();case"ProductMissingBound":return Sg();case"IntegralMissingBound":return Cg();case"SumMissingBody":return _g();case"ProductMissingBody":return Fg();case"IntegralMissingBody":return Bg();case"DerivativeMissingBody":return Vg();case"IntegralMissingDifferential":return Lg();case"DifferentialWithSuperscript":return wg();case"FractionMissingNumerator":return wy();case"FractionMissingDenominator":return _y();case"FractionEmpty":return Fy();case"EmptySuperscript":return By();case"EmptySubscript":return up();case"InvalidSubscript":return Vy(e.val);case"SuperscriptWithPrime":return qy();case"PrimeWithoutParen":return cp();case"UnexpectedPrime":return lp();case"EmptyRadical":return ky();case"EmptyRadicalIndex":return Uy();case"EmptySquareBracket":return $y();case"EmptyPipe":return Yy();case"FunctionMissingArgument":return mn(e.val,1,0);case"AdjacentNumbers":return Dy(mE(e.args[0]),mE(e.args[1]));case"TokenWithSubscript":return Ay();case"UnexpectedFor":return Sp();default:throw`Unexpected surface node ${e.type}.`}}function mE(e){switch(e.type){case"Decimal":return e.val;case"MixedNumber":return`${e.whole} ${e.num}/${e.den}`;default:let t=e;throw new Error(`Unexpected node type ${t.type}`)}}function Xi(e){switch(e.type){case"Letter":case"Decimal":case"MixedNumber":case"Cmd":case"EmptyPiecewise":return!0;case"Neg":{let r=e.args[0];for(;;)if(r.type==="Pos"||r.type==="Paren"&&!xE(r))r=r.args[0];else if(r.type==="Neg")r=r.args[0];else break;return r.type==="Decimal"||r.type==="MixedNumber"}case"Pos":return Xi(e.args[0]);case"Paren":return Xi(e.args[0]);case"Juxt":case"Mul":case"DotMul":case"CrossMul":case"Div":return Xi(e.args[0])&&Xi(e.args[1]);case"Subscript":return Xi(e.args[0]);case"Superscript":case"Frac":case"Add":case"Sub":return Xi(e.args[0])&&Xi(e.args[1]);case"Piecewise":{let[r]=e.args;return r.type==="Equals"||r.type==="Inequality"||r.type==="InequalityChain"}case"Call":{let[r,n]=e.args;return Hr(r)||vM(r)?!1:Xi(r)&&Xi(n)}case"Derivative":case"Sqrt":case"Nthroot":case"Pipes":case"Bang":return!1;case"Equals":case"Inequality":case"InequalityChain":case"Tilde":case"ImplicitCall":case"Index":case"List":case"Seq":case"Integral":case"EmptyIntegral":case"Sum":case"Product":case"Colon":case"Ellipsis":case"For":case"With":case"Dot":case"PercentOf":case"Prime":case"EmptyRangeEnd":case"RightArrow":return!1;default:throw`Unexpected surface node ${e.type}.`}}function IE(e){return e.type!=="Cmd"?!1:e.val==="random"||e.val==="shuffle"}function ME(e){let t=e.nodes.ExtendSeed("",[e.setInput(e.nodes.Identifier("globalRandomSeed"),void 0),e.setInput(e.nodes.Seed(e.nextSeed()),void 0)]);if(!e.seedExtensions)return t;for(let{prefix:r,expr:n}of e.seedExtensions)t=e.nodes.ExtendSeed(r,[e.setInput(t,void 0),n]);return t}function Xf(e,t){let r=e.seedExtensions||[];return ue(X({},e),{seedExtensions:r.concat(t)})}var NC=[[su("("),Qe(")"),su("\\{"),Qe("\\}"),vl("["),Qe("]"),su("(|"),Qe("|)"),Qe("Differential"),Qe("End")],[Qe("for")],[vl("with")],[ou("...")],[Qe(",")],[ou(":")],[vl("->")],[El("with")],[Qe("="),Qe(">"),Qe("<"),Qe(">="),Qe("<="),Qe("~")],[El("->")],[Qe("+"),Qe("-")],[Qe("*"),Qe("\\cdot"),Qe("\\times"),Qe("/"),Qe("Decimal"),Qe("MixedNumber"),Qe("Letter"),Qe("Cmd"),Qe("TokenNode"),Qe("%"),vl("("),Qe("\\{"),Qe("(|"),Qe("Frac"),Qe("Sqrt"),Qe("Trig"),Qe("Ln"),Qe("Log"),ou("Int"),ou("Sum"),ou("Prod")],[su("+"),su("-")],[Qe("!")],[Qe("SupSub")],[El("["),Qe(".")],[El("(")],[Qe("Err")]],{leftPrec:Zf,rightPrec:EE,initialPrec:NE}=cE(NC),vE={trailingComma:!1};function DE(e,t){let r=t?X(X({},vE),t):vE,n=$s(e,r),i=DC(n);return i.type==="Err"&&i.error.type==="EmptyGroup"?se(i.span,SM()):i}function DC(e){return ho(e,{isToplevel:!0})}function ho(e,{isToplevel:t}={isToplevel:!1}){if(Wf(e))return se(K(e,e),NM());let{state:r,tree:n}=ar(e,0,{isToplevel:t});return n.type!=="Err"&&!Wf(r)?Ub(r).tree:n}function w(e,t){return{state:e,tree:t}}function ar(e,t,{isToplevel:r}={isToplevel:!1}){let n=e,i;if({state:n,tree:i}=AC(n),i.type==="Err")return w(n,i);if(!Gb(e,n))throw new Error("Programming Error: parseInitial did not advance state.");for(;!Wf(n);){let s;if(_r(n,"(")&&!LC(i)?s=EE("("):s=Zf(wr(n).type),t>=s)break;let o=n,a=RC(n,i,r)?Zf(",")-1:EE(wr(n).type);if({state:n,tree:i}=CC(n,i,a),i.type==="Err")return w(n,i);if(!Gb(o,n))throw new Error("Programming Error: parseSuccessor did not advance state.")}return w(n,i)}function vn(e){return e.type==="UnexpectedDifferential"||e.type==="UnexpectedCloseDelimiter"||e.type==="UnexpectedEnd"||e.type==="BinaryOperatorMissingLeft"}function AC(e){let t=e,r=wr(e),n=NE(r.type),i;switch(r.type){case"+":{if(e=ce(e),{state:e,tree:i}=ar(e,n),i.type==="Err"){if(!vn(i.error))return w(e,i);let o=K(t,e),a=se(o,Db(r.val));return w(e,a)}return w(e,X0(K(t,e),[i]))}case"-":if(e=ce(e),{state:e,tree:i}=ar(e,n),i.type==="Err"){if(!vn(i.error))return w(e,i);let o=K(t,e),a=se(o,Db(r.val));return w(e,a)}else return w(e,Z0(K(t,e),[i]));case"(":return Sl(e);case"\\{":return e=ce(e),_r(e,"\\}")?(e=ce(e),w(e,mM(K(t,e)))):({state:e,tree:i}=ar(e,n),{state:e,tree:i}=Nl(t,e,i,"\\{","\\}"),i.type==="Err"?w(e,i):w(e,dM(K(t,e),[i])));case"[":return e=ce(e),_r(e,"]")?(e=ce(e),w(e,Pb(K(t,e),[]))):({state:e,tree:i}=ar(e,n),{state:e,tree:i}=Nl(t,e,i,"[","]"),i.type==="Err"?w(e,i):w(e,Pb(K(t,e),[i])));case"(|":{if(e=ce(e),_r(e,"|)")){e=ce(e);let o=K(t,e);return w(e,se(o,RM()))}return{state:e,tree:i}=ar(e,n),{state:e,tree:i}=Nl(t,e,i,"(|","|)"),i.type==="Err"?w(e,i):w(e,iM(K(t,e),[i]))}case"Frac":{if(e.opts.disallowFrac)throw Op();e=ce(e);let o=ho($s(r.num,e.opts)),a=ho($s(r.den,e.opts));if(o.type==="Err"&&o.error.type==="EmptyGroup"&&a.type==="Err"&&a.error.type==="EmptyGroup"){let u=K(t,e),l=se(u,QM());return w(e,l)}if(o.type==="Err"&&o.error.type==="EmptyGroup"){let u=K(t,e),l=se(u,jM());return w(e,l)}if(a.type==="Err"&&a.error.type==="EmptyGroup"){let u=K(t,e),l=se(u,JM());return w(e,l)}if(o.type==="Err")return w(e,o);if(a.type==="Err")return w(e,a);if(OM(o,a)&&a.type==="Juxt"){let u=a.args[1],l;if({state:e,tree:l}=ar(e,Zf("*")-1),l.type==="Err"){if(vn(l.error)){let c=K(t,e);return w(e,se(c,WM()))}return w(e,l)}return w(e,uM(K(t,e),[u,l]))}return w(e,aM(K(t,e),[o,a]))}case"Sqrt":if(e=ce(e),r.optArg){let o=ho($s(r.optArg,e.opts));if(o.type==="Err")return o.error.type==="EmptyGroup"?w(e,se(o.span,CM())):w(e,o);let a=ho($s(r.arg,e.opts));return a.type==="Err"?a.error.type==="EmptyGroup"?w(e,se(a.span,Sb())):w(e,a):w(e,oM(K(t,e),[o,a]))}else{let o=ho($s(r.arg,e.opts));return o.type==="Err"?o.error.type==="EmptyGroup"?w(e,se(o.span,Sb())):w(e,o):w(e,sM(K(t,e),[o]))}case"Trig":case"Ln":{e=ce(e);let o=da(K(t,e),r.val),a=0,u=wr(e);if(u.type==="SupSub"){if(e=ce(e),u.sub){let p=K(t,e),f=se(p,VM(o.val));return w(e,f)}let c=jf(u,e.opts);if(c){if(c.type==="Err")return w(e,c);o=qf(K(t,e),[o,c])}a=u.nprimes}let l=_r(e,"(");if(l){if({state:e,tree:i}=Sl(e),i.type==="Err")return w(e,i);i=Tl(K(t,e),[o,i.args[0]])}else{if({state:e,tree:i}=ar(e,n-1),i.type==="Err")return vn(i.error)?w(e,se(K(t,e),Rb(r.val))):w(e,i);i=xb(K(t,e),[o,i])}if(a>0){let c=K(t,e);if(!l){let p=se(c,Cb());return w(e,p)}i=Pl(c,a,[i])}return w(e,i)}case"Log":{e=ce(e);let o=K(t,e),a=da(o,r.val),u=0,l,c,p=wr(e);if(p.type==="SupSub"&&(e=ce(e),l=AE(p,e.opts),c=jf(p,e.opts),u=p.nprimes),l&&l.type==="Err")return w(e,l);if(c&&c.type==="Err")return w(e,c);let f=_r(e,"(");if(f){if({state:e,tree:i}=Sl(e),i.type==="Err")return w(e,i);i=i.args[0]}else if({state:e,tree:i}=ar(e,n-1),i.type==="Err")return vn(i.error)?w(e,se(K(t,e),Rb(r.val))):w(e,i);let m=l?da(o,"\\logbase"):a,d=l?kf(K(t,e),Lr(i).concat(l)):i;if(c&&(m=qf(K(t,e),[m,c])),f?i=Tl(K(t,e),[m,d]):i=xb(K(t,e),[m,d]),u>0){let y=K(t,e);if(!f){let g=se(y,Cb());return w(e,g)}i=Pl(y,u,[i])}return w(e,i)}case"Int":{e=ce(e);let o=wr(e);e=ce(e);let a=kb(o,t,e);if(a.type==="Err")return a.error.type==="MissingBound"?w(e,se(a.span,UM())):w(e,a);let{sup:u,sub:l}=a,c;if(_r(e,"Differential"))return{state:e,tree:c}=SE(e),c.type==="Err"?w(e,c):w(e,cM(K(t,e),[c,l,u]));if({state:e,tree:i}=ar(e,n),i.type==="Err")return vn(i.error)?w(e,se(i.span,YM())):w(e,i);let p=i;return _r(e,"Differential")?({state:e,tree:c}=SE(e),c.type==="Err"?w(e,c):w(e,lM(K(t,e),[c,l,u,p]))):w(e,se(K(t,e),XM()))}case"Sum":{e=ce(e);let o=wr(e);e=ce(e);let a=kb(o,t,e);if(a.type==="Err")return a.error.type==="MissingBound"?w(e,se(a.span,qM())):w(e,a);let{sup:u,sub:l}=a;return{state:e,tree:i}=ar(e,n),i.type==="Err"?vn(i.error)?w(e,se(i.span,HM())):w(e,i):w(e,pM(K(t,e),[i,l,u]))}case"Prod":{e=ce(e);let o=wr(e);e=ce(e);let a=kb(o,t,e);if(a.type==="Err")return a.error.type==="MissingBound"?w(e,se(a.span,kM())):w(e,a);let{sup:u,sub:l}=a;return{state:e,tree:i}=ar(e,n),i.type==="Err"?vn(i.error)?w(e,se(i.span,$M())):w(e,i):w(e,fM(K(t,e),[i,l,u]))}case"Cmd":return e=ce(e),i=da(K(t,e),r.val),w(e,i);case"TokenNode":{e=ce(e);let o=wr(e);return o.type==="SupSub"&&o.sub?(e=ce(e),w(e,se(K(t,e),eE()))):(i=da(K(t,e),r.val),w(e,i))}case"Letter":return e=ce(e),i=IM(K(t,e),r.val),w(e,i);case"Decimal":{e=ce(e);let o=Uf(K(t,e),r.val),a=e.token;if(a.type==="Decimal"||a.type==="MixedNumber"){let u=e;e=ce(e);let l=K(t,e),c=a.type==="MixedNumber"?a:Uf(K(u,e),a.val);return w(e,se(l,wb([o,c])))}return w(e,o)}case"MixedNumber":{if(e.opts.disallowFrac)throw Op();e=ce(e);let o=e.token;if(o.type==="Decimal"||o.type==="MixedNumber"){let a=e;e=ce(e);let u=K(t,e),l=o.type==="MixedNumber"?o:Uf(K(a,e),o.val);return w(e,se(u,wb([r,l])))}return w(e,r)}case"*":case"\\cdot":case"\\times":case"/":case",":case"=":case">":case"<":case">=":case"<=":case"->":case"~":case":":case"...":case"%":case".":{e=ce(e);let o=K(t,e),a=se(o,LM(r.val));return w(e,a)}case"for":{e=ce(e);let o=K(t,e),a=se(o,KM());return w(e,a)}case"with":{e=ce(e);let o=K(t,e),a=se(o,vb());return w(e,a)}case"!":{e=ce(e);let o=K(t,e),a=se(o,Ab(r.val));return w(e,a)}case"SupSub":{e=ce(e);let o="supsub";r.sub?o="subscript":r.sup?o="superscript":r.nprimes>0&&(o="prime");let a=K(t,e),u=se(a,Ab(o));return w(e,u)}case")":case"\\}":case"]":case"|)":case"Differential":return Ub(e);case"Err":{e=ce(e);let o=K(t,e),a=se(o,FM(r.val));return w(e,a)}case"End":{let o=K(t,e),a=se(o,Nb());return w(e,a)}default:throw`Unexpected token type ${r.type}.`}}function RC(e,t,r){return _r(e,"=")&&r&&(hE(t)||qb(t))}function CC(e,t,r){let n=wr(e),i;switch(n.type){case"+":case"-":case"*":case"\\cdot":case"\\times":case"/":case"=":case"~":case":":case".":case"->":case"for":{if(e=ce(e),{state:e,tree:i}=ar(e,r),i.type==="Err")if(vn(i.error)){let o=ir(t.span,e),a=se(o,mo(n.val));return w(e,a)}else return w(e,i);return w(e,OE(n.type,ir(t.span,e),[t,i]))}case"with":{if(e=ce(e),{state:e,tree:i}=ar(e,r),i.type==="Err")if(vn(i.error)){let o=ir(t.span,e),a=se(o,mo(n.val));return w(e,a)}else return w(e,i);return w(e,OE(n.type,ir(t.span,e),[t,i]))}case"%":{e=ce(e);let o=wr(e);if(o.type!=="Cmd"||o.val!=="of"&&o.val!=="\\of"){let a=se(n.span,GM());return w(e,a)}if(e=ce(e),{state:e,tree:i}=ar(e,r),i.type==="Err")if(vn(i.error)){let a=ir(t.span,e),u=se(a,mo(n.val));return w(e,u)}else return w(e,i);return w(e,TM(ir(t.span,e),[t,i]))}case">=":case"<=":case">":case"<":{let o=n.type;if(e=ce(e),{state:e,tree:i}=ar(e,r),i.type==="Err")if(vn(i.error)){let c=ir(t.span,e),p=se(c,mo(n.val));return w(e,p)}else return w(e,i);let a=xl(ir(t.span,e),o,[t,i]),u=[],l=wr(e).type;for(;l===">="||l==="<="||l===">"||l==="<";){let c=e;if(o=l,e=ce(e),{state:e,tree:i}=ar(e,r),i.type==="Err")if(vn(i.error)){let p=ir(t.span,e),f=se(p,mo(n.val));return w(e,f)}else return w(e,i);u.push($0(K(c,e),o,[i])),l=wr(e).type}return u.length?w(e,Y0(ir(t.span,e),a,u)):w(e,a)}case"!":return e=ce(e),w(e,rM(ir(t.span,e),[t]));case"[":{let o=e;if(e=ce(e),_r(e,"]")){e=ce(e);let a=K(o,e);return w(e,se(a,AM()))}return{state:e,tree:i}=ar(e,r),{state:e,tree:i}=Nl(o,e,i,"[","]"),i.type==="Err"?w(e,i):w(e,nM(ir(t.span,e),[t,i]))}case"Sqrt":case"Frac":case"Letter":case"Cmd":case"TokenNode":case"Trig":case"Ln":case"Log":case"Sum":case"Int":case"Prod":case"Decimal":case"MixedNumber":case"\\{":case"(|":return{state:e,tree:i}=ar(e,r),i.type==="Err"?w(e,i):w(e,Eb(ir(t.span,e),[t,i]));case"(":if(Hr(t)){if({state:e,tree:i}=Sl(e),i.type==="Err")return w(e,i);let o=ir(t.span,e);return w(e,Tl(o,[t,i.args[0]]))}else if(t.type==="Prime"&&Hr(t.args[0])){if({state:e,tree:i}=Sl(e),i.type==="Err")return w(e,i);let o=ir(t.span,e);return w(e,Pl(o,t.nprimes,[Tl(o,[t.args[0],i.args[0]])]))}else return{state:e,tree:i}=ar(e,r),i.type==="Err"?w(e,i):w(e,Eb(ir(t.span,e),[t,i]));case"SupSub":{e=ce(e);let o=RE(n),a=jf(n,e.opts);if(o&&o.type==="Err")return w(e,o);if(a&&a.type==="Err")return w(e,a);if(o&&(t=Ib(ir(t.span,e),[t,o])),a&&(t=qf(ir(t.span,e),[t,a])),n.nprimes>0){let u=ir(t.span,e);if(!Hr(t)){let l=se(u,Hf());return w(e,l)}t=Pl(u,n.nprimes,[t])}return w(e,t)}case",":{let o=[t];for(;_r(e,",")&&(e=ce(e),!(_r(e,"...")||e.opts.trailingComma&&wC(e)));){if({state:e,tree:i}=ar(e,r),i.type==="Err")if(vn(i.error)){let a=ir(t.span,e),u=se(a,mo(n.val));return w(e,u)}else return w(e,i);o.push(i)}return w(e,kf(ir(t.span,e),o))}case"...":{if(e=ce(e),_r(e,",")&&(e=ce(e)),r>=Zf(wr(e).type))return w(e,Mb(ir(t.span,e),[t,yM(Bb(e))]));if({state:e,tree:i}=ar(e,r),i.type==="Err")if(vn(i.error)){let o=ir(t.span,e),a=se(o,mo(n.val));return w(e,a)}else return w(e,i);return w(e,Mb(ir(t.span,e),[t,i]))}case"]":case")":case"\\}":case"|)":case"Differential":return Ub(e);case"Err":return ar(e,r);case"End":{let o=K(e,e),a=se(o,Nb());return w(e,a)}default:throw`Unexpected token type ${n.type}.`}}function LC(e){return!!(Hr(e)||e.type==="Prime"&&Hr(e.args[0]))}function OE(e,t,r){switch(e){case"+":return j0(t,r);case"-":return J0(t,r);case"*":return Q0(t,r);case"\\cdot":return K0(t,r);case"\\times":return eM(t,r);case"/":return tM(t,r);case"=":return H0(t,r);case"~":return W0(t,r);case":":return gM(t,r);case".":return xM(t,r);case"->":return PM(t,r);case"for":return hM(t,r);case"with":return bM(t,r);default:throw`Unexpected token type ${e}.`}}function AE(e,t){if(!e.sub)return;let r=e.sub,n=ho($s(r,t));return n.type==="Err"&&n.error.type==="EmptyGroup"?se(n.span,Ob()):n}function RE(e){if(!e.sub)return;let t=e.sub;if(t.args.length===0)return se(t.span,Ob());let r=[];for(let n of t.args)if(n.type==="Digit"||n.type==="Letter")r.push(n.val);else{let i=n.span;return se(i,BM(xr(i)))}return MM(t.span,r.join(""))}function jf(e,t){if(!e.sup)return;let r=ho($s(e.sup,t));return r.type==="Err"?r.error.type==="EmptyGroup"?se(r.span,DM()):r:e.nprimes>0?se(e.span,zM()):r}function kb(e,t,r){if(e.type!=="SupSub"){let s=K(t,r);return se(s,Lb())}if(e.nprimes>0){let s=K(t,r);return se(s,Hf())}let n=AE(e,r.opts),i=jf(e,r.opts);if(!n||n.type==="Err"&&n.error.type==="EmptySubscript"||!i||i.type==="Err"&&i.error.type==="EmptySuperscript"){let s=K(t,r);return se(s,Lb())}return n.type==="Err"?n:i.type==="Err"?i:{type:"Bounds",sup:i,sub:n}}function Sl(e){let t=e,r=wr(e),n=NE(r.type);if(_r(e,"("))e=ce(e);else throw new Error("Programming Error: expected '(' at start of parseParen.");if(_r(e,")")){let s=kf(Bb(e),[]);e=ce(e);let o=K(t,e);return w(e,Tb(o,[s]))}let i;return{state:e,tree:i}=ar(e,n),{state:e,tree:i}=Nl(t,e,i,"(",")"),i.type==="Err"?w(e,i):w(e,Tb(K(t,e),[i]))}function SE(e){let t=e,r=wr(e);if(r.type!=="Differential")throw new Error("Programming Error: expected differential");e=ce(e);let n=da(r.span,r.val),i=wr(e);if(i.type==="SupSub"){e=ce(e);let s=K(t,e),o=RE(i);if(o){if(o.type==="Err")return w(e,o);n=Ib(s,[n,o])}if(i.sup)return w(e,se(s,ZM()));if(i.nprimes>0)return w(e,se(s,Hf()))}return w(e,n)}function Nl(e,t,r,n,i){if(r.type==="Err"&&r.error.type!=="UnexpectedEnd")return w(t,r);if(r.type==="Err"||!_r(t,i)){let s=K(e,t),o=se(s,wM(n,i));return w(t,o)}return t=ce(t),w(t,r)}function Ub(e){let t=e;switch(wr(e).type){case")":{e=ce(e);let n=K(t,e);return w(e,se(n,Il("(",")")))}case"]":{e=ce(e);let n=K(t,e);return w(e,se(n,Il("[","]")))}case"\\}":{e=ce(e);let n=K(t,e);return w(e,se(n,Il("\\{","\\}")))}case"|)":{e=ce(e);let n=K(t,e);return w(e,se(n,Il("|","|")))}case"Differential":{e=ce(e);let n=K(t,e);return w(e,se(n,_M()))}default:{e=ce(e);let n=K(t,e);return w(e,se(n,vb()))}}}function wC(e){return _r(e,")")||_r(e,"]")||_r(e,"\\}")}function _C(){throw na()}function FC(e,t){return t&&e.setInputSpan(t),e}function xi(e,t={}){let r=typeof e;if(r!=="string")throw new Error(`Type Error: parse can only be called with strings, got ${JSON.stringify(e)} of type ${r}`);let n=b;if(t.disabledFeatures){n=Object.create(n);for(let l of t.disabledFeatures){if(!n[l])throw new Error(`Programming Error: ${l} cannot be disabled because it is not a parsenode.`);n[l]=_C}}let i=t.seedPrefix===void 0?"":t.seedPrefix,s=0,o=()=>{let l=`${i}::vc${s}`;return s+=1,l},a={nodes:n,currentIndex:t.index,setInput:FC,nextSeed:o,allowDt:!!t.allowDt,allowIndex:!!t.allowIndex,writeIntegral:!!t.writeIntegral},u={};t.trailingComma!==void 0&&(u.trailingComma=t.trailingComma),t.disallowFrac&&(u.disallowFrac=!0);try{let l=q0(e),c=DE(l,u),p=yE(a,c);return p.parseOptions=t,p}catch(l){let c;return l instanceof b.Error?c=l:typeof l=="string"?c=new b.Error(l):c=Ce(),c.parseOptions=t,c}}function VC(e,t,r){return{chunk:e,argMap:t,start:r}}function bo(e,t,r,n){let i=VC(e,[t],r);return Dl(i,n)}function Dl(e,t){let{chunk:r,argMap:n,start:i}=e;if(t<i)return t;let s=n[t-i];if(s!==void 0)return s;let o=GC(e,t);e.argMap[t-i]=o;let a=r.getInstruction(t);if(gn(a))switch(a.type){case 23:case 21:break;case 19:{let l=a.args.length-2;for(let c=0;c<l;c++)Dl(e,t+1+c);break}default:let u=a;throw new Error(`Programming Error. Unexpected OpCode: ${u.type}`)}else if(Cr(a)){let u=a.args.length-1;for(let l=0;l<u;l++)Dl(e,t+1+l)}return o}function GC(e,t){let{chunk:r,start:n}=e,i=r.getInstruction(t);if(Cr(i)){let a=i.args[0];for(let u=a;u<=t;u++){let l=r.getInstruction(u);if(!me(l))for(let c of l.args)c<a&&Dl(e,c)}}if(me(i))return gi(r,i);let s=[];for(let a of i.args)s.push(Dl(e,a));let o=e.argMap[t-n];return o!==void 0?o:Xt(r,i,s)}var Gt=Symbol("FRAME_SENTINEL");function uu(e,t){return Hb(e,t).freeDependencies}function Hb(e,t){let r={};return t.type==="FunctionDefinition"&&(t=t._expression),$b(e,t,r)}function CE(e,t,r){let n=[],i=[],s=[],o=[],a=[];for(let u of t.scopes){let l=CE(e,u,r);for(let c of l.freeDependencies)n.indexOf(c)===-1&&t.definitions.indexOf(c)===-1&&n.push(c);for(let c of l.substitutionDependencies)o.indexOf(c)===-1&&t.definitions.indexOf(c)===-1&&o.push(c);for(let c of l.substitutionBodyDependencies)a.indexOf(c)===-1&&t.definitions.indexOf(c)===-1&&a.push(c);for(let c of l.updateSymbols)i.indexOf(c)===-1&&i.push(c);for(let c of l.substitutionSymbols)s.indexOf(c)===-1&&s.push(c)}for(let u of t.dependencies){if(t.definitions.indexOf(u)!==-1)continue;let l=zC(e,u,r),c=t.substitutionDependencies.indexOf(u)!==-1;for(let p of l.freeDependencies)n.indexOf(p)===-1&&t.definitions.indexOf(p)===-1&&n.push(p),c&&o.indexOf(p)===-1&&t.definitions.indexOf(p)===-1&&o.push(p),t.isSubstitutionBody&&a.indexOf(p)===-1&&t.definitions.indexOf(p)===-1&&a.push(p);for(let p of l.substitutionDependencies)o.indexOf(p)===-1&&t.definitions.indexOf(p)===-1&&o.push(p);for(let p of l.updateSymbols)i.indexOf(p)===-1&&i.push(p);for(let p of l.substitutionSymbols)s.indexOf(p)===-1&&s.push(p)}return{freeDependencies:n,updateSymbols:i,substitutionSymbols:s,substitutionDependencies:o,substitutionBodyDependencies:a}}function $b(e,t,r){if(t.type==="Slider"||t.type==="Assignment")return $b(e,t._expression,r);{let{freeDependencies:n,substitutionDependencies:i,updateSymbols:s,substitutionSymbols:o,substitutionBodyDependencies:a}=CE(e,t.getScope(),r),u=t.getUpdateSymbols();if(u.length>0){s=s.slice();for(let c of u)s.indexOf(c)===-1&&s.push(c)}let l=t.getSubstitutionSymbols();if(l.length>0){o=o.slice();for(let c of l)o.indexOf(c)===-1&&o.push(c)}return{freeDependencies:n,updateSymbols:s,substitutionSymbols:o,substitutionDependencies:i,substitutionBodyDependencies:a}}}function zC(e,t,r){if(r[t])return r[t];if(Se[t])return r[t]={freeDependencies:[],updateSymbols:[],substitutionSymbols:[],substitutionDependencies:[],substitutionBodyDependencies:[]},r[t];let n=e[t];if(n===Gt)throw new Error("Programming error: _getSymbolFreeDependencies called with a symbol that is defined in a local scope");return n?(r[t]={freeDependencies:[t],updateSymbols:[],substitutionSymbols:[],substitutionDependencies:[],substitutionBodyDependencies:[]},r[t]=$b(e,n,r),r[t]):(r[t]={freeDependencies:[t],updateSymbols:[],substitutionSymbols:[],substitutionDependencies:[],substitutionBodyDependencies:[]},r[t])}function LE(e,t){for(var r={},n=t.getDependencies().slice();n.length;){var i=n.pop();if(!r.hasOwnProperty(i)){var s=e[i];if(s===Gt)return;r[i]=s,s&&s.getDependencies&&Array.prototype.push.apply(n,s.getDependencies())}}return qC(r)}function qC(e){let t=[];for(let r in e)t.push([r,e[r]]);return t}function Al(e,t,r){let n=e.getInstruction(t);if(!fe(n.valueType,x)&&!fe(n.valueType,A)&&!fe(n.valueType,G))throw ey([te(n.valueType)]);let i=e.getInstruction(r);if(!fe(i.valueType,x)&&i.type!==0)throw Ce();let s=e.Constant(0);if(t<r)return s;let o=e.Constant(1),a=e.Constant(NaN),u=nu(e,r),l=jC(e,t);e.derivativeMaps[r]||(e.derivativeMaps[r]={maxValidReference:e.instructionsLength()-1,map:[]});let{map:c,maxValidReference:p}=e.derivativeMaps[r];for(let y=0;y<c.length;y++){let g=c[y];g!==void 0&&g>p&&(c[y]=void 0)}let f=[],m=!1;for(let y=0;y<r;y++)f[y]=y,c[y]=s;return Yb({chunk:e,derivativeVarIndex:r,forwardMask:u,backwardMask:l,valueMap:f,derivativeMap:c,mustCopy:m,ZERO:s,ONE:o,NAN:a},r,t),e.derivativeMaps[r].maxValidReference=e.instructionsLength()-1,c[t]}function Yb(e,t,r){let{chunk:n,valueMap:i,derivativeMap:s,backwardMask:o}=e;for(let a=t;a<=r;a++){let u=s[a];if(u!==void 0)if(n.getInstruction(u).type===0)s[a]=void 0;else{i[a]=Jf(e,a);continue}if(!o[a]){i[a]=Jf(e,a);continue}let l=n.getInstruction(a);if(gn(l)&&l.endIndex!==-1)switch(l.type){case 21:{a=kC(e,a);continue}case 19:case 23:{a=$C(e,a);continue}}i[a]=Jf(e,a),s[a]=YC(e,a)}return r}function kC(e,t){let{chunk:r,forwardMask:n,valueMap:i,derivativeMap:s,ZERO:o}=e,a=r.getInstruction(t),u=a.endIndex,l=r.getInstruction(u),c=o;if(n[a.args[1]]){let p=i[a.args[1]];c=r.Add([c,r.Multiply([s[a.args[1]],bo(r,p,t,l.args[1])])])}if(n[a.args[0]]){let p=i[a.args[0]];c=r.Subtract([c,r.Multiply([s[a.args[0]],bo(r,p,t,l.args[1])])])}if(UC(r,t,n)){let p=i.slice();p[t]=Xt(r,a,[p[a.args[0]],p[a.args[1]]]),s[t]=o,Yb(ue(X({},e),{valueMap:p,mustCopy:!0}),t+1,u-1);let f=Xt(r,l,[p[l.args[0]],s[l.args[1]]]);s[u]=f,c=r.Add([c,Xt(r,r.getInstruction(u+1),[f])])}else for(let p=t;p<=u;p++)s[p]=o;if(HC(r,t,i)){let p=ue(X({},e),{mustCopy:!0});for(let f=t;f<=u+1;f++)i[f]=Jf(p,f)}else for(let p=t;p<=u+1;p++)i[p]=p;return s[u+1]=c,u+l.args.length-1}function UC(e,t,r){let n=e.getInstruction(t),i=e.getInstruction(n.endIndex);if(i.args[1]<t+1)return r[i.args[1]];for(let s=t+1;s<=i.args[1];s++){let o=e.getInstruction(s);if(!me(o)){for(let a of o.args)if(a<t&&r[a])return!0}}return!1}function HC(e,t,r){let n=e.getInstruction(t);for(let i=t;i<=n.endIndex;i++){let s=e.getInstruction(i);if(!me(s)){for(let o of s.args)if(r[o]!==o)return!0}}return!1}function $C(e,t){let{chunk:r,derivativeMap:n,valueMap:i,ZERO:s}=e,o=r.getInstruction(t),a=o.endIndex,u=r.getInstruction(a),l;if(o.type===23)i[t]=Xt(r,o,[i[o.args[0]]]),n[t]=s,l=t+1;else{let p=[];p.push(i[o.args[0]],i[o.args[1]]);for(let f=2;f<o.args.length;f++)p.push(i[o.args[f]],n[o.args[f]]);i[t]=Xt(r,o,p),n[t]=s;for(let f=2;f<o.args.length;f++)i[t+f-1]=Xt(r,r.getInstruction(t+f-1),[i[t]]),n[t+f-1]=Xt(r,r.getInstruction(t+f-1),[i[t]]);l=t+o.args.length-1}Yb(ue(X({},e),{mustCopy:!0}),l,a-1);let c=[];c.push(i[u.args[0]]);for(let p=1;p<u.args.length;p++)c.push(i[u.args[p]],n[u.args[p]]);i[a]=Xt(r,u,c),n[a]=s;for(let p=1;p<u.args.length;p++)i[a+p]=Xt(r,r.getInstruction(a+p),[i[a]]),n[a+p]=Xt(r,r.getInstruction(a+p),[i[a]]);return a+u.args.length-1}function Jf(e,t){let{chunk:r,valueMap:n,mustCopy:i}=e,s=r.getInstruction(t);if(me(s))return i?gi(r,s):t;{let o=[],a=!1;for(let u of s.args)o.push(n[u]),n[u]!==u&&(a=!0);return a||i?Xt(r,s,o):t}}function YC(e,t){let{chunk:r,derivativeVarIndex:n,forwardMask:i,valueMap:s,derivativeMap:o,ZERO:a,ONE:u,NAN:l}=e,c=r.getInstruction(t);if(t===n)if(k(c.valueType)){let f=Ur(r,t),m=r.BeginBroadcast([f]),d=r.EndBroadcast([m,u]);return r.BroadcastResult(Z,[d])}else return u;if(gn(c)||Cr(c)||c.type===47||c.type===48||c.type===25||c.type===27||c.type===26||c.type===29||c.type===28||c.type===32||c.type===42||c.type===44||c.type===49)return a;if(!i[t]||me(c))return c.valueType!==x?XC(r,[s[t],a]):c.type!==1||isFinite(V(c.value))?a:l;if(c.type===38||c.type===15||c.type===16){let f=[];for(let m of c.args)f.push(o[m]);return Xt(r,c,f)}if(c.type===33)return Xt(r,c,[s[c.args[0]],o[c.args[1]],o[c.args[2]]]);let p=a;for(let f=0;f<c.args.length;f++){if(!i[c.args[f]])continue;let m=o[c.args[f]];if(m===a)continue;let d=WC(e,s[t],f,m);d!==a&&(p=p===a?d:ZC(r,[d,p]))}return p}function WC(e,t,r,n){let{chunk:i,ZERO:s,ONE:o,NAN:a}=e,u=i.getInstruction(t);switch(u.type){case 8:return n;case 9:switch(r){case 0:return n;default:return i.Negative([n])}case 10:switch(r){case 0:return i.Multiply([n,u.args[1]]);default:return i.Multiply([u.args[0],n])}case 11:switch(r){case 0:return i.Divide([n,u.args[1]]);default:return i.Multiply([u.args[0],i.Divide([i.Negative([n]),i.Multiply([u.args[1],u.args[1]])])])}case 14:return i.Negative([n]);case 12:case 13:switch(r){case 0:return i.Multiply([i.Multiply([u.args[1],i.Exponent([u.args[0],i.Subtract([u.args[1],o])])]),n]);default:return i.Multiply([i.Piecewise([i.Equal([u.args[0],s]),i.Piecewise([i.GreaterEqual([u.args[1],s]),s,a]),i.Multiply([i.SyntheticNativeFunction("ln",[u.args[0]]),t])]),n])}case 37:return JC(i,t,_E[u.symbol][r],n);case 39:case 40:case 41:case 17:case 18:switch(r){case 0:return Xt(i,u,[n,u.args[1]]);default:return s}default:{let l=u;throw new Error(`Unimplemented derivative for opcode ${l.type}`)}}}function XC(e,t){switch(e.getInstruction(t[0]).valueType){case pe:return e.SyntheticNativeFunction("scaleTangentSegment",t);case ne:return e.SyntheticNativeFunction("scaleTangentLine",t);case Pe:return e.SyntheticNativeFunction("scaleTangentRay",t);case ie:return e.SyntheticNativeFunction("scaleTangentCircle",t);case ee:return e.SyntheticNativeFunction("scaleTangentArc",t);case de:return e.SyntheticNativeFunction("scaleTangentUndirectedAngleMarker",t);case oe:return e.SyntheticNativeFunction("scaleTangentDirectedAngleMarker",t);default:return e.Multiply(t)}}function ZC(e,t){switch(e.getInstruction(t[0]).valueType){case pe:return e.SyntheticNativeFunction("addTangentSegment",t);case ne:return e.SyntheticNativeFunction("addTangentLine",t);case Pe:return e.SyntheticNativeFunction("addTangentRay",t);case ie:return e.SyntheticNativeFunction("addTangentCircle",t);case ee:return e.SyntheticNativeFunction("addTangentArc",t);case de:return e.SyntheticNativeFunction("addTangentUndirectedAngleMarker",t);case oe:return e.SyntheticNativeFunction("addTangentDirectedAngleMarker",t);default:return e.Add(t)}}function jC(e,t){let r=[];for(let n=0;n<t;n++)r.push(!1);r.push(!0);for(let n=t;n>=0;n--){if(!r[n])continue;let i=e.getInstruction(n);if(!me(i))if(i.type===33)r[i.args[1]]=!0,r[i.args[2]]=!0;else for(let s of i.args)r[s]=!0}return r}function JC(e,t,r,n){let i=Object.create(Se),s=el({},{},-1),a=e.getInstruction(t).args;for(let u=0;u<a.length;u++){let l=QC[u];wn(s,l,a[u]),i[l]=Gt}return wn(s,"x_1",n),i.x_1=Gt,wn(s,"q",t),i.q=Gt,be(On(Ff,i,e,s,void 0,{},void 0),r)}var QC=["x","y","z","u"],wE={exp:["q*x_1"],ln:["\\{x >= 0: x_1/x \\}"],log:["\\{x >= 0: x_1/(x*\\ln(10)) \\}"],sqrt:["x_1/(2*q)"],rtxsqpone:["x*x_1/q"],rtxsqmone:["x*x_1/q"],sin:["\\cos(x)*x_1"],cos:["-\\sin(x)*x_1"],tan:["(1+q^2)*x_1"],arcsin:["x_1/\\sqrt{1 - x^2}"],arccos:["-x_1/\\sqrt{1 - x^2}"],sinh:["\\cosh(x)*x_1"],cosh:["\\sinh(x)*x_1"],tanh:["(\\sech(x))^2*x_1"],arcsinh:["x_1/\\rtxsqpone(x)"],arccosh:["\\{ x > 0: x_1/\\rtxsqmone(x) \\}"],arctanh:["\\{ \\abs(x) < 1: x_1/(1 - x^2) \\}"],csc:["-\\cot(x)*q*x_1"],sec:["\\tan(x)*q*x_1"],cot:["-(1+q^2)*x_1"],arccsc:["-x_1/(\\abs(x)*\\rtxsqmone(x))"],arcsec:["x_1/(\\abs(x)*\\rtxsqmone(x))"],arccot:["-x_1/(1+x^2)"],csch:["-\\coth(x)*q*x_1"],sech:["-\\tanh(x)*q*x_1"],coth:["-(\\csch(x))^2*x_1"],arccsch:["-x_1/(\\abs(x)*\\rtxsqpone(x))"],arcsech:["\\{ x >= 0: -x_1/(x*\\sqrt{1 - x^2}) \\}"],arccoth:["\\{ \\abs(x) > 1 : x_1/(1 - x^2) \\}"],factorial:["q*\\polyGamma(0, x + 1)*x_1"],floor:["\\{ q=x: 0/0, 0*x_1 \\}"],ceil:["\\{ q=x: 0/0, 0*x_1 \\}"],round:["\\{ \\abs(\\mod(x, 1) - 0.5) > 0: 0*x_1 \\}"],abs:["\\{ x=0: 0/0, \\sign(x)*x_1 \\}"],sign:["\\{ x=0: 0/0, 0*x_1 \\}"],distance:["-((y.x-x.x)*x_1.x+(y.y-x.y)*x_1.y)/q","((y.x-x.x)*x_1.x+(y.y-x.y)*x_1.y)/q"],distance3d:["-((y.x-x.x)*x_1.x+(y.y-x.y)*x_1.y+(y.z-x.z)*x_1.z)/q","((y.x-x.x)*x_1.x+(y.y-x.y)*x_1.y+(y.z-x.z)*x_1.z)/q"],segment3d:["\\segment(x_1,(0,0,0))","\\segment((0,0,0),x_1)"],triangle:["\\triangle(x_1,(0,0,0),(0,0,0))","\\triangle((0,0,0),x_1,(0,0,0))","\\triangle((0,0,0),(0,0,0),x_1)"],sphere:["\\sphere(x_1,0)","\\sphere((0,0,0),x_1)"],pointDet:["\\pointDet(x_1,y)","\\pointDet(x,x_1)"],pointDot:["\\pointDot(x_1,y)","\\pointDot(x,x_1)"],pointPerp:["\\pointPerp(x_1)"],segment:["\\segment(x_1,(0,0))","\\segment((0,0),x_1)"],line:["\\line(x_1,(0,0))","\\line((0,0),x_1)"],ray:["\\ray(x_1,(0,0))","\\ray((0,0),x_1)"],circle:["\\circle(x_1,0)","\\circle((0,0),x_1)"],arc:["\\arc(x_1,(0,0),(0,0))","\\arc((0,0),x_1,(0,0))","\\arc((0,0),(0,0),x_1)"],arcCenter:["(0/0,0/0)"],arcOmega:["0/0"],center:["\\center(x_1)"],radius:["\\radius(x_1)"],undirectedAngleMarker:["\\undirectedAngleMarker(x_1)"],directedAngleMarker:["\\directedAngleMarker(x_1,0,0,0)","\\directedAngleMarker((0,0),x_1,0,0)","\\directedAngleMarker((0,0),0,x_1,0)","\\directedAngleMarker((0,0),0,0,x_1)"],directedCoterminalAngle:["\\directedCoterminalAngle(x_1)"],undirectedCoterminalAngle:["\\undirectedCoterminalAngle(x_1)"],supplement:["\\supplement(x_1)"],directedAngleMarkerMultiplier:["\\directedAngleMarkerMultiplier(x_1)"],undirectedAngleMarkerMultiplier:["\\undirectedAngleMarkerMultiplier(x_1)"],directedAngleMarkerRawDelta:["\\directedAngleMarkerRawDelta(x_1)"],undirectedAngleMarkerRawDelta:["\\undirectedAngleMarkerRawDelta(x_1)"],polygonInteriorUndirectedAngles:["\\polygonInteriorUndirectedAngles(x_1)"],polygonInteriorDirectedAngles:["\\polygonInteriorDirectedAngles(x_1)"],lineFromSegment:["x_1"],lineFromRay:["x_1"],segmentGlider:["\\segmentGlider(x_1,y)","\\{0<y<1:(\\segmentGlider(x,1)-\\segmentGlider(x,0))*x_1,(0,0)\\}"],rayGlider:["\\rayGlider(x_1,y)","\\{0<y:(\\rayGlider(x,1)-\\rayGlider(x,0))*x_1,(0,0)\\}"],lineGlider:["\\lineGlider(x_1,y)","(\\lineGlider(x,1)-\\lineGlider(x,0))*x_1"],circleGlider:["\\circleGlider(x_1,y)","2*\\pi*\\pointPerp(q-\\center(x))*x_1"],arcGlider:["(0/0,0/0)","(0/0,0/0)"],polygonGlider:["(0/0,0/0)","(0/0,0/0)"],chooseNonIncidentPoint:["(0/0,0/0)"],circleCircleIntersection:["(\\radius(x)*\\radius(x_1)+\\pointDot(\\center(x_1),(q-\\center(x))))/\\pointDot(\\pointPerp(q-\\center(y)),q-\\center(x))*\\pointPerp(q-\\center(y))","(\\radius(y)*\\radius(x_1)+\\pointDot(\\center(x_1),(q-\\center(y))))/\\pointDot(\\pointPerp(q-\\center(x)),q-\\center(y))*\\pointPerp(q-\\center(x))"],circleArcIntersection:["(0/0,0/0)"],circleLineIntersection:["(\\radius(x)*\\radius(x_1)+\\pointDot(\\center(x_1),(q-\\center(x))))/\\pointDot((\\lineGlider(y,1)-\\lineGlider(y,0)),q-\\center(x))*(\\lineGlider(y,1)-\\lineGlider(y,0))","(\\pointDet(\\lineGlider(x_1,0),\\lineGlider(y,1))+\\pointDet(\\lineGlider(y,0),\\lineGlider(x_1,1))-\\pointDet(q,\\lineGlider(x_1,1)-\\lineGlider(x_1,0)))/(\\pointDet(\\pointPerp(q-\\center(x)),\\lineGlider(y,1)-\\lineGlider(y,0)))*(\\pointPerp(q-\\center(x)))"],arcCircleIntersection:["(0/0,0/0)"],arcArcIntersection:["(0/0,0/0)"],arcLineIntersection:["(0/0,0/0)"],lineCircleIntersection:["(\\pointDet(\\lineGlider(x_1,0),\\lineGlider(x,1))+\\pointDet(\\lineGlider(x,0),\\lineGlider(x_1,1))-\\pointDet(q,\\lineGlider(x_1,1)-\\lineGlider(x_1,0)))/(\\pointDet(\\pointPerp(q-\\center(y)),\\lineGlider(x,1)-\\lineGlider(x,0)))*(\\pointPerp(q-\\center(y)))","(\\radius(y)*\\radius(x_1)+\\pointDot(\\center(x_1),(q-\\center(y))))/\\pointDot((\\lineGlider(x,1)-\\lineGlider(x,0)),q-\\center(y))*(\\lineGlider(x,1)-\\lineGlider(x,0))"],lineArcIntersection:["(0/0,0/0)"],lineLineIntersection:["(\\pointDet(\\lineGlider(x_1,0),\\lineGlider(x,1))+\\pointDet(\\lineGlider(x,0),\\lineGlider(x_1,1))-\\pointDet(q,\\lineGlider(x_1,1)-\\lineGlider(x_1,0)))/(\\pointDet(\\lineGlider(y,1)-\\lineGlider(y,0),\\lineGlider(x,1)-\\lineGlider(x,0)))*(\\lineGlider(y,1)-\\lineGlider(y,0))","(\\pointDet(\\lineGlider(x_1,0),\\lineGlider(y,1))+\\pointDet(\\lineGlider(y,0),\\lineGlider(x_1,1))-\\pointDet(q,\\lineGlider(x_1,1)-\\lineGlider(x_1,0)))/(\\pointDet(\\lineGlider(x,1)-\\lineGlider(x,0),\\lineGlider(y,1)-\\lineGlider(y,0)))*(\\lineGlider(x,1)-\\lineGlider(x,0))"],parallel:["\\parallel(x_1,(0,0))","\\parallel(\\line((0,0),(0,0)),x_1)"],perpendicular:["\\perpendicular(x_1,(0,0))","\\perpendicular(\\line((0,0),(0,0)),x_1)"],scaleTangentSegment:["\\scaleTangentSegment(x_1, y)","\\scaleTangentSegment(x, x_1)"],scaleTangentLine:["\\scaleTangentLine(x_1, y)","\\scaleTangentLine(x, x_1)"],scaleTangentRay:["\\scaleTangentRay(x_1, y)","\\scaleTangentRay(x, x_1)"],scaleTangentCircle:["\\scaleTangentCircle(x_1, y)","\\scaleTangentCircle(x, x_1)"],scaleTangentArc:["\\scaleTangentArc(x_1, y)","\\scaleTangentArc(x, x_1)"],scaleTangentDirectedAngleMarker:["\\scaleTangentDirectedAngleMarker(x_1, y)","\\scaleTangentDirectedAngleMarker(x, x_1)"],scaleTangentUndirectedAngleMarker:["\\scaleTangentUndirectedAngleMarker(x_1, y)","\\scaleTangentUndirectedAngleMarker(x, x_1)"],addTangentSegment:["\\addTangentSegment(x_1, y)","\\addTangentSegment(x, x_1)"],addTangentLine:["\\addTangentLine(x_1, y)","\\addTangentLine(x, x_1)"],addTangentRay:["\\addTangentRay(x_1, y)","\\addTangentRay(x, x_1)"],addTangentCircle:["\\addTangentCircle(x_1, y)","\\addTangentCircle(x, x_1)"],addTangentArc:["\\addTangentArc(x_1, y)","\\addTangentArc(x, x_1)"],addTangentDirectedAngleMarker:["\\addTangentDirectedAngleMarker(x_1, y)","\\addTangentDirectedAngleMarker(x, x_1)"],addTangentUndirectedAngleMarker:["\\addTangentUndirectedAngleMarker(x_1, y)","\\addTangentUndirectedAngleMarker(x, x_1)"],translation:["\\translation(x_1)"],dilation:["\\dilation(x_1, y)","\\dilation(x, x_1)"],reflection:["\\reflection(x_1)"],rotation:["\\rotation((0/0,0/0),0/0]"],compose:["\\reflection(\\line((0/0,0/0),(0/0,0/0)))","\\reflection(\\line((0/0,0/0),(0/0,0/0)))"],inverse:["\\reflection(\\line((0/0,0/0),(0/0,0/0)))"],transformPoint:["(0/0,0/0)","(0/0,0/0)"],transformSegment:["\\segment((0/0,0/0),(0/0,0/0))","\\segment((0/0,0/0),(0/0,0/0))"],transformLine:["\\line((0/0,0/0),(0/0,0/0))","\\line((0/0,0/0),(0/0,0/0))"],transformRay:["\\ray((0/0,0/0),(0/0,0/0))","\\ray((0/0,0/0),(0/0,0/0))"],transformCircle:["\\circle((0/0,0/0),0/0)","\\circle((0/0,0/0),0/0)"],transformArc:["\\arc((0/0,0/0),(0/0,0/0),(0/0,0/0))","\\arc((0/0,0/0),(0/0,0/0),(0/0,0/0))"],transformPolygon:["\\polygon([])","\\polygon([])"],transformAngleMarker:["\\undirectedAngleMarker(directedAngleMarker([0/0,0/0],0/0,0/0,0/0))","\\undirectedangleMarker(directedAngleMarker([0/0,0/0],0/0,0/0,0/0))"],transformDirectedAngleMarker:["\\directedAngleMarker([0/0,0/0],0/0,0/0,0/0)","\\directedangleMarker([0/0,0/0],0/0,0/0,0/0)"],mean:["\\mean(x_1)"],total:["\\total(x_1)"],count:["0"],var:["2*\\cov(x, x_1)"],varp:["2*\\cov(x, x_1)*(\\count(x)-1)/\\count(x)"],stdev:["\\cov(x, x_1)/q"],stdevp:["\\covp(x, x_1)/q"],mad:["\\mean(\\sign(x-\\mean(x))*(x_1 - \\mean(x_1)))"],min:["x_1[\\argmin(x)]"],max:["x_1[\\argmax(x)]"],median:["0.5*(x_1[\\lowerQuantileIndex(x, 0.5)] + x_1[\\upperQuantileIndex(x, 0.5)])"],argmin:["0/0"],argmax:["0/0"],gcd:["0/0"],lcm:["0/0"],erf:["\\frac{2x_1}{\\sqrt{\\pi }}\\exp(-x^2)"],invNorm:["\\frac{x_1}{\\pdf(\\normaldist(0,1),q)}"],logbase:["\\{x > 0: \\frac{x_1}{x*\\ln(y)} \\}","\\frac{-q*x_1}{y*\\ln(y)}"],nthroot:["x^{1/y - 1}/y*x_1","-\\frac{q*\\ln(x)*x_1}{y^2}"],hypot:["x_1*x/q","x_1*y/q"],polyGamma:["0/0","\\polyGamma(1 + x, y)*x_1"],mod:["\\{ q=0: 0/0, x_1 \\}","\\{ \\mod(x/y, 1) > 0: -\\floor(x/y)*x_1 \\}"],cov:["\\cov(x_1, y)","\\cov(x, x_1)"],covp:["\\covp(x_1, y)","\\covp(x, x_1)"],corr:["(\\cov(x_1, y) - (\\cov(x, y)*\\cov(x, x_1)/\\var(x)))/(\\stdevp(x)\\stdevp(y))","(\\cov(x, x_1) - (\\cov(x, y)*\\cov(y, x_1)/\\var(y)))/(\\stdevp(x)\\stdevp(y))"],spearman:["0/0","0/0"],quantile:["\\{ \\floor(y*(\\count(x)-1)) = y*(\\count(x)-1) :   x_1[\\upperQuantileIndex(x, y)],  (\\ceil(y*(\\count(x)-1)) - y*(\\count(x)-1))*x_1[\\lowerQuantileIndex(x, y)] +   (y*(\\count(x)-1) - \\floor(y*(\\count(x)-1)))*x_1[\\upperQuantileIndex(x, y)]\\}","\\{ \\floor(y*(\\count(x)-1)) < y*(\\count(x)-1) :   (\\count(x)-1)*(x[\\upperQuantileIndex(x, y)] - x[\\lowerQuantileIndex(x, y)])*x_1\\}"],quartile:["0.5*(x_1[\\lowerQuartileIndex(x, y)] + x_1[\\upperQuartileIndex(x, y)])","0/0"],tscore:["\\frac{\\sqrt{\\count(x)}(\\stdev(x)*\\mean(x_1)-(\\mean(x)-y)*\\frac{\\cov(x,x_1)}{\\stdev(x)})}{\\stdev(x)^2}","-x_1*\\sqrt{\\count(x)}/\\stdev(x)"],quartileIndex:["0/0","0/0"],upperQuartileIndex:["0/0","0/0"],lowerQuartileIndex:["0/0","0/0"],upperQuantileIndex:["0/0","0/0"],lowerQuantileIndex:["0/0","0/0"],nCr:["q*(\\polyGamma(0, 1 + x) - \\polyGamma(0, 1 + x - y))","q*(\\polyGamma(0, 1 + x - y) - \\polyGamma(0, 1 + y))"],nPr:["q*(\\polyGamma(0, 1 + x) - \\polyGamma(0, 1 + x - y))","q*\\polyGamma(0, 1 + x - y)"],arctan:["x_1*y/(y^2+x^2)","-x_1*x/(y^2+x^2)"],poissonpdf:["0/0","x_1\\frac{\\exp(-y)(\\floor(x)-y)y^{(\\floor(x)-1)}}{(\\floor(x))!}"],invPoisson:["0/0","0/0"],tpdf:["x_1*q*\\frac{-(y+1)*x}{y+x^2}","x_1*\\frac{1}{2}q*(  \\frac{x^2-1}{y + x^2} + \\ln(\\frac{y}{y + x^2}) +   \\polyGamma(0, \\frac{1+y}{2}) - \\polyGamma(0, y/2))"],invT:["x_1/\\pdf(\\tdist(y),q)","0/0"],tcdf:["-x_1*\\pdf(\\tdist(z),x)","x_1*\\pdf(\\tdist(z),y)","0/0"],poissoncdf:["0/0","0/0","x_1\\sum _{n=\\max(0,\\floor(\\min(x,y)))}^{\\floor(\\max(x,y))}\\frac{\\exp(-z)(n-z)z^{(n-1)}}{n!}"],normalpdf:["-x_1*\\frac{x-y}{z^2} q","x_1*\\frac{x-y}{z^2} q","x_1*(\\frac{(x-y-z)*(x-y+z)}{z^3}) q"],binompdf:["0/0","0/0","\\{0<=z<=1: x_1*q*(\\frac{\\round(x)}{z}-\\frac{\\round(y)-\\round(x)}{1-z}), 0 \\}"],invBinom:["0/0","0/0","0/0"],uniformpdf:["0","\\{y<=x: \\frac{x_1}{(z-y)^2}, 0\\}","\\{z>=x: -\\frac{x_1}{(z-y)^2}, 0\\}"],invUniform:["\\{y<=x<=z: x_1*(z-y), 0\\}","\\{y<=x<=z: x_1*(1-x), 0\\}","\\{y<=x<=z: x_1*x, 0\\}"],normalcdf:["-x_1\\pdf(\\normaldist(z,u), x)","x_1\\pdf(\\normaldist(z,u), y)","-x_1*(\\pdf(\\normaldist(z,u), y) - \\pdf(\\normaldist(z,u), x))","x_1*(  \\{\\abs(y)=1/0:0,\\frac{z-y}{u}\\pdf(\\normaldist(z,u),y)\\} -   \\{\\abs(x)=1/0:0,\\frac{z-x}{u}\\pdf(\\normaldist(z,u),x)\\})"],binomcdf:["0/0","0/0","0/0","\\{0<=u<=1: x_1*\\sum _{n=\\max(0,\\round(\\min(x,y)))}^{\\round(\\max(x,y))}(  \\pdf(\\binomialdist(z,u),n)*(\\frac{n}{u}-\\frac{\\round(z)-n}{1-u})), 0 \\}"],uniformcdf:["\\{z>u: 0/0, -x_1\\pdf(\\uniformdist(z,u), x)\\}","\\{z>u: 0/0, x_1\\pdf(\\uniformdist(z,u), y)\\}","\\{z>u: 0/0, x_1*(\\frac{\\{z<x<u:u-x,0\\} + \\{z<y<u:y-u,0\\}}{(u-z)^2})\\}","\\{z>u: 0/0, x_1*(\\frac{\\{z<x<u:x-z,0\\} + \\{z<y<u:z-y,0\\}}{(u-z)^2})\\}"],normalSample:["0/0","0/0","0/0"],uniformSample:["0/0","0/0","0/0"],tSample:["0/0","0/0"],poissonSample:["0/0","0/0"],binomSample:["0/0","0/0","0/0"],rgb:["0/0","0/0","0/0"],hsv:["0/0","0/0","0/0"],polygon:["\\polygon(x_1)"],area:["0/0"],perimeter:["0/0"],vertices:["\\vertices(x_1)"],segments:["\\segments(x_1)"],validateRangeLength:["0","0","0","\\{q \\ge 1: x_1, 0\\}"],validateSampleCount:["\\{x<0:0,1\\}*x_1"],select:["\\select(x_1, y)","0*q"],shuffle:["0*y","\\shuffle(x, x_1)"],sortPerm:["0*x"],elementsAt:["\\elementsAt(x_1, y)","0*q"],uniquePerm:["0*q"]},_E={};for(let e in wE){let t=e,r=wE[t],n=[];for(let i=0;i<r.length;i++){let s=r[i];n.push(xi(s,{}))}_E[t]=n}function FE(e,t){e.map.length=Math.min(e.map.length,t),e.maxValidReference=Math.min(e.maxValidReference,t-1)}function BE(e,t,r){let n=e.argNames.indexOf(t);if(n===-1){let o=e.getInstruction(r);return o.type===1&&o.valueType===x&&isNaN(V(o.value))?ss():Ci()}let i=Mn(e,n,{allowRestriction:!0,allowClosedBlockReferences:!1}),s=KC(i);return ga(s,r)}function KC(e){let{chunk:t,mask:r}=e;return{chunk:t,mask:r,orderCtx:e,domainTable:[]}}function ga(e,t){let{domainTable:r}=e,n=r[t];if(n!==void 0)return n;let i=eL(e,t);return r[t]=i,i}function eL(e,t){let{chunk:r,mask:n,orderCtx:i}=e,s=r.getInstruction(t);if(me(s)){if(s.type===1){if(s.valueType==x){if(isNaN(V(s.value)))return ss()}else if(s.valueType===Z){for(let o of s.value)if(isNaN(V(o)))return Wr()}}return Ci()}switch(s.type){case 32:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 47:case 48:case 15:case 17:case 16:case 18:case 37:case 42:case 21:case 22:case 23:case 24:case 19:case 20:case 39:case 40:case 41:case 44:case 49:{let o=Ci();for(let a of s.args)o=Qr(o,ga(e,a));return o}case 38:{if(!n[t])return Ci();let o=ga(e,s.args[0]);if(o.type!=="known")return Wr();for(let a=1;a<s.args.length;a++){let u=ga(e,s.args[a]);if(u.type!=="known")return Wr();if(u.bounds[0]!==o.bounds[0]||u.bounds[1]!==o.bounds[1])return Wr()}return o}case 25:return n[t]?Wr():Ci();case 33:{let o=r.getInstruction(s.args[2]);return o.type!==1||o.valueType!==x||!isNaN(V(o.value))?Wr():Qr(ga(e,s.args[0]),ga(e,s.args[1]))}case 26:case 27:case 28:case 29:{if(!n[t])return Ci();if(Kt(i,t)>1)return Wr();let o=e.coefficientCtx;o===void 0&&(o=hi(i),e.coefficientCtx=o);let a=o.newChunk,u=or(o,t),[l,c]=u;if(!At(a.getInstruction(l)))return Wr();let p=Nt(a,l);if(isNaN(p))return ss();let f=Ci();for(let m of s.args)f=Qr(f,ga(e,m));if(c===void 0)return s.type===28||s.type===29?p>=0?f:ss():p>0?f:ss();{let m=Nt(a,c);return Qr(f,Ma(p,m))}}}}function GE(e){let t=[],r=[];for(let n=0;n<e.argNames.length;n++){let i=[],s=[];for(let o=0;o<e.argNames.length;o++)i.push(e.argTypes[o]===x),s.push(n===o);r.push(s),t.push(i)}for(let n=e.argNames.length;n<=e.getReturnIndex();n++)r.push(tL(e,r,n)),t.push(rL(e,r,t,n));return t[e.getReturnIndex()]}function tL(e,t,r){let n=e.getInstruction(r),i=nL(e.argNames.length);if(me(n))return i;for(let s of n.args){let o=t[s];for(let a=0;a<o.length;a++)i[a]=i[a]||o[a]}return i}function rL(e,t,r,n){let i=e.getInstruction(n);if(me(i))return VE(e.argNames.length);switch(i.type){case 8:case 9:case 14:case 38:{let a=VE(e.argNames.length);for(let u=0;u<i.args.length;u++){let l=r[i.args[u]];for(let c=0;c<l.length;c++)a[c]=a[c]&&l[c]}return a}case 11:{let a=[],u=r[i.args[0]],l=t[i.args[1]];for(let c=0;c<u.length;c++)a.push(u[c]&&!l[c]);return a}case 10:{let a=r[i.args[0]].slice(),u=r[i.args[1]].slice(),l=t[i.args[0]],c=t[i.args[1]],p=0,f=0;for(let m=0;m<a.length;m++){let d=a[m]&&!c[m],y=u[m]&&!l[m];a[m]=d,u[m]=y,d&&(p+=1),y&&(f+=1)}return p>=f?a:u}case 33:{let a=t[i.args[0]],u=r[i.args[1]],l=r[i.args[2]];for(var s=[],n=0;n<a.length;n++)s.push(!a[n]&&u[n]&&l[n]);return s}case 39:case 40:case 41:{let a=r[i.args[0]],u=t[i.args[1]],l=[];for(var n=0;n<u.length;n++)l.push(a[n]&&!u[n]);return l}case 48:{let a=i.args[0],u=e.getInstruction(a),l=n-a;return r[u.args[l]]}case 15:case 17:case 16:case 18:case 12:case 13:case 26:case 28:case 27:case 29:case 25:case 32:case 37:case 42:case 21:case 22:case 19:case 20:case 23:case 24:case 47:case 44:case 49:{let a=t[n],u=[];for(let l of a)u.push(!l);return u}default:let o=i;throw new Error(`Unexpected opcode ${o.type}`)}}function nL(e){let t=[];for(let r=0;r<e;r++)t.push(!1);return t}function VE(e){let t=[];for(let r=0;r<e;r++)t.push(!0);return t}function qE(e){let t=e.getInstruction(e.getReturnIndex());if(t.type!==48)return e;let r=t.args[0],n=e.getReturnIndex()-r,i=e.getInstruction(r),s=i.args[0],o=i.args[n],a=[],u=[];a.push(s);let l=$i(e,e.getReturnIndex(),"Programming error: cannot optimize regression on non-constant-length list");u.push({min:1,max:l,length:l});let c=!1,p=!1;for(let N=s+1;N<=o;N++){let I=e.getInstruction(N);if(I.type===39||I.type===41||I.type===40){if(I.args[1]!==s)continue;let O=I.args[0];if(e.getInstruction(O).valueType!==Z||!At(e.getInstruction(O)))continue;let E=Nt(e,O),v=oL(E);if(!isFinite(v.min)||!isFinite(v.max))continue;a.push(N),u.push(v)}else zE(I)?c=!0:(I.type===12||I.type===13)&&(p=!0)}if(a.length===0||!p&&!c)return e;let f=[],m=[];for(let N=0;N<e.argNames.length;N++)m.push(N),f.push(Ci());let d=[],y=[];for(let N=0;N<=o;N++)d.push(Wb(e,m,d,N)),y.push(Wb(e,a,y,N));for(let N=0;N<=o;N++){let I=e.getInstruction(N);if(I.type===33){let O=d[N];for(let E=0;E<O.length;E++)O[E]&&(f[E]=Wr())}else if(I.type===12||I.type===13){let O=!1,E=!1;for(let we=0;we<a.length;we++)y[I.args[0]][we]&&(O=!0),y[I.args[1]][we]&&(E=!0);if(O||!E)continue;let v=d[I.args[0]],_=0,z;for(let we=0;we<v.length;we++)v[we]&&(z=we,_+=1);if(_!==1||z===void 0)continue;let R=m[z],H=Mn(e.copy().reopenFinalBlock(),R,{allowRestriction:!1,allowClosedBlockReferences:!1});if(Kt(H,I.args[0])!==1)continue;let W=hi(H),[$,re]=or(W,I.args[0]);if(re===void 0)continue;let j=Nt(W.newChunk,re),ve=Nt(W.newChunk,$);f[z]=Qr(f[z],Ma(ve,j))}}if(c){let N=e.copy().reopenFinalBlock();for(let I=0;I<a.length;I++){let O=Mn(N,a[I],{allowRestriction:!1,allowClosedBlockReferences:!1}),E=hi(O);for(let v=s+1;v<=o;v++){let _=N.getInstruction(v);if(zE(_)){let z=_.args[0];if(Kt(O,z)!==1)continue;let R=or(E,z)[1];if(R===void 0)continue;let H=sL(E.newChunk,R),W,$=0;for(let ge=0;ge<H.length;ge++)H[ge]&&(W=ge,$+=1);if($!==1||W===void 0)continue;let re=Mn(E.newChunk,W,{allowRestriction:!1,allowClosedBlockReferences:!1});if(Kt(re,R)!==1)continue;let j=hi(re),[ve,we]=or(j,R);if(we===void 0||!At(j.newChunk.getInstruction(ve))||!At(j.newChunk.getInstruction(we)))continue;let Dt=Nt(j.newChunk,ve),_e=Nt(j.newChunk,we),Q=(u[I].max-u[I].min)/Math.min(u[I].length-1,31),ae=Math.PI/Q;if(!isFinite(ae)||ae<=0)continue;f[W]=Qr(f[W],Ma(Dt,_e)),f[W]=Qr(f[W],Ma(ae-Dt,-_e))}}}}let g=!1;for(let N of f){if(N.type!=="known")return e;(N.bounds[0]!==-1/0||N.bounds[1]!==1/0)&&(g=!0)}if(!g)return e;let h=e.copy(),P=e.getReturnIndex(),T=h.Constant(1),D=h.Constant(NaN);for(let N=0;N<h.argNames.length;N++)P=iL(h,f[N],P,N,T,D);return h.close(),h}function iL(e,t,r,n,i,s){if(t.type!=="known"||t.bounds[0]===-1/0&&t.bounds[1]===1/0)return r;let o=e.And([e.LessEqual([e.Constant(t.bounds[0]),n]),e.LessEqual([n,e.Constant(t.bounds[1])])]);return e.Multiply([r,e.Piecewise([o,i,s])])}function sL(e,t){let r=[];for(let i=0;i<e.argNames.length;i++)r.push(i);let n=[];for(let i=0;i<=t;i++)n.push(Wb(e,r,n,i));return n[t]}function zE(e){return e.type===37&&(e.symbol==="sin"||e.symbol==="cos")}function oL(e){var t=1/0,r=-1/0,n=e.length;for(let i of e)t=Math.min(t,i),r=Math.max(r,i);return{min:t,max:r,length:n}}function Wb(e,t,r,n){let i=e.getInstruction(n),s=aL(t.length);for(let o=0;o<t.length;o++)if(t[o]===n)return s[o]=!0,s;if(me(i))return s;for(let o of i.args){let a=r[o];for(let u=0;u<a.length;u++)s[u]=s[u]||a[u]}return s}function aL(e){let t=[];for(let r=0;r<e;r++)t.push(!1);return t}function kE(e){let t=e.getInstruction(e.getReturnIndex());if(me(t))return e.getReturnIndex();let r=fb(e,t),n=r.expectedTypes,i=Xb(e,t.args,[n]);if(r.isReducerWithNoListArgs){let s=uL(e,i.didCoerce?i.args:t.args),o=fn(r.expectedTypes.rest);if(Li(s,o)){i.didCoerce||e.popInstruction();let a=e.List(t.args);return e.copyInstructionWithArgs(t,[a])}}else i.didCoerce&&e.copyInstructionWithArgs(t,i.args);return e.getReturnIndex()}function Xb(e,t,r){let n=!1,i=[];for(let s=0;s<t.length;s++){let o=Df(r,s),a=t[s],u=e.getInstruction(a).valueType,l=a;o.every(c=>!Li(u,c))&&fe(o[0],x)&&(l=ha(e,a)),l!==a&&(n=!0),i.push(l)}return n?{didCoerce:n,args:i}:{didCoerce:!1}}function ha(e,t){let r=e.getInstruction(t);return r.valueType===Me?t:fe(r.valueType,de)?HE(e,t):fe(r.valueType,oe)?UE(e,t):t}function uL(e,t){let r=e.getInstruction(t[0]).valueType;if(!zn(r))return Bt;for(let n of t)if(e.getInstruction(n).valueType!==r)return Bt;return fn(r)}function Ti(e){var t=e;if(t&&typeof t.toJSON=="function"&&(t=t.toJSON()),!t||typeof t!="object")return t;if(Array.isArray(t))return t.map(Ti);var r={};for(var n in t)t.hasOwnProperty(n)&&(r[n]=Ti(t[n]));return r}function $E(e,t){let r=[],n=[],i=[];for(let o=0;o<e.argNames.length;o++)t.hasOwnProperty(e.argNames[o])||(r.push(e.argNames[o]),n.push(e.argTypes[o]));let s=new Es({argNames:r,argTypes:n});for(let o=0,a=0;o<e.argNames.length;o++)t.hasOwnProperty(e.argNames[o])?i[o]=s.ConstantOfType(e.argTypes[o],t[e.argNames[o]]):(i[o]=a,a+=1);for(let o=e.argNames.length;o<e.instructionsLength();o++){let a=e.getInstruction(o);if(me(a))i.push(gi(s,a));else{let u=[];for(let l of a.args)u.push(i[l]);i.push(Xt(s,a,u))}}return s}var Es=class{constructor(t){this.derivativeMaps={};if(this.instructions=[],this.blockMask=[],this.comments=[],t.argNames.length!==t.argTypes.length)throw new Error("Programming Error: length of argNames must match length of argTypes");this.argNames=t.argNames,this.argTypes=t.argTypes;for(let r=0;r<this.argTypes.length;r++){let n=this.argTypes[r];this.LoadArg(n)}this.returnIndex=this.Constant(NaN)}setError(t){this.error=t}getError(){return this.error}getReturnIndex(){return this.returnIndex}setReturnIndex(t){if(!(0<=t&&t<this.instructions.length))throw new Error(`Programming Error: out of bounds return index ${t}`);this.returnIndex=t}addComments(t){for(let r in t){let n=this.comments[r]||"";this.comments[r]=n+t[r]}return this}instructionsLength(){return this.instructions.length}getInstruction(t){return this.instructions[t]}popInstruction(){this.truncate(this.instructions.length-1)}truncate(t){this.instructions.length=Math.min(t,this.instructions.length),this.blockMask.length=Math.min(t,this.blockMask.length),this.comments.length=Math.min(t,this.comments.length);for(let r in this.derivativeMaps)FE(this.derivativeMaps[r],t);this.setReturnIndex(this.instructions.length-1)}pushInstructionChecked(t){if(this.instructions.length>=32768)throw gy();this.instructions.push(t),this.setReturnIndex(this.instructions.length-1)}pushLeafInstruction(t){return this.pushInstructionChecked(t),this.getReturnIndex()}pushInstruction(t){return this.checkInstructionArguments(t),this.pushInstructionChecked(t),this.setReturnIndex(M0(this)),this.setReturnIndex(S0(this)),this.setReturnIndex(kE(this)),n0(this,this.getReturnIndex()),this.returnIndex===this.instructions.length-1&&this.setReturnIndex(KI(this)),this.getReturnIndex()}checkInstructionArguments(t){for(let r of t.args)if(this.blockMask[r])throw new Error("Programming Error: cannot reference an instruction in a closed block")}markClosedBlock(t,r){for(let n=t;n<r;n++)this.blockMask[n]=!0}LoadArg(t){return this.pushLeafInstruction({type:2,valueType:t})}BlockVar(t,r){return this.pushInstruction({type:47,valueType:t,args:r})}SymbolicVar(t,r){return this.pushLeafInstruction({type:3,valueType:t,symbol:r})}BroadcastResult(t,r){let n=r[0],i=this.instructions[n],s=i.args[0],o=this.instructions.length-n,a=i.args[o],u=!Mf(this,a,s),c=this.getInstruction(s).args[0],p=this.getInstruction(c);return this.pushInstruction({type:48,valueType:t,args:r,isConstantBroadcast:u,constantLength:At(p)?Nt(this,c):void 0})}Constant(t){return this.ConstantOfType(x,t)}ConstantOfType(t,r){if(typeof r=="number"&&(r=he(r,1)),k(t)&&r.length>1e4)throw zu();return this.pushLeafInstruction({type:1,valueType:t,value:r})}NanOfType(t){if(t===et){let r=this.Constant(NaN);return this.Distribution("uniformdist",[r,r])}else return this.ConstantOfType(t,$n(t))}Add(t){let r=8,n=Rt(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}Subtract(t){let r=9,n=Rt(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}Multiply(t){let r=10,n=Rt(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}Divide(t){let r=11,n=Rt(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}Exponent(t){let r=12,n=Rt(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}RawExponent(t){let r=13,n=Rt(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}Negative(t){let r=14,n=Rt(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}Equal(t){let r=25,n=Rt(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}Less(t){let r=26,n=Rt(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}Greater(t){let r=27,n=Rt(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}LessEqual(t){let r=28,n=Rt(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}GreaterEqual(t){let r=29,n=Rt(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}And(t){let r=32,n=Rt(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}Piecewise(t){let r=33,n=Rt(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}OrderedPair(t){let r=15,n=Rt(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}OrderedPairAccess(t){let r=17,n=Rt(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}OrderedTriple(t){let r=16,n=Rt(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}OrderedTripleAccess(t){let r=18,n=Rt(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}List(t){let r=38,n=Rt(this,r,t);if(t.length>1e4)throw zu();return this.pushInstruction({type:r,valueType:n,args:t})}ListAccess(t){let r=39,n=Rt(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}DeferredListAccess(t){let r=40,n=Rt(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}InboundsListAccess(t){let r=41,n=Rt(this,r,t);return this.pushInstruction({type:r,valueType:n,args:t})}NativeFunction(t,r,n){let i=37,s=gr[t].returnType,o=typeof s=="function"?s(n.map(a=>this.getInstruction(a).valueType)):s;return this.pushInstruction({type:i,valueType:o,args:n,symbol:t,callData:r})}SyntheticNativeFunction(t,r){let n=37,i=gr[t].returnType,s=typeof i=="function"?i(r.map(a=>this.getInstruction(a).valueType)):i,o={errorSymbol:t,providedArity:r.length,isDotCall:!1};return this.pushInstruction({type:n,valueType:s,args:r,symbol:t,callData:o})}Distribution(t,r){let n=42,i=et;return this.pushInstruction({type:n,valueType:i,args:r,symbol:t})}BeginIntegral(t,r){let n=21,i=Rt(this,n,[]);return this.pushInstruction({type:n,valueType:i,args:r,endIndex:-1,callData:t})}EndIntegral(t){let r=22,n=Rt(this,r,t),i=t[0],s=this.getInstruction(i);this.instructions[i]={type:s.type,valueType:s.valueType,args:s.args,endIndex:this.instructionsLength(),callData:s.callData};let o=this.pushInstruction({type:r,valueType:n,args:t});return this.markClosedBlock(i,o),o}BeginBroadcast(t,r){let n=23,i=Rt(this,n,[]),s=this.getInstruction(t[0]);if(At(s)&&Nt(this,t[0])>1e4)throw zu();return this.pushInstruction({type:n,valueType:i,endIndex:-1,args:t,listComprehensionCallData:r})}EndBroadcast(t){let r=24,n=Rt(this,r,t),i=t[0],s=this.getInstruction(i),o={type:s.type,valueType:s.valueType,args:s.args,endIndex:this.instructionsLength()};this.instructions[i]=o;let a=this.pushInstruction({type:r,valueType:n,args:t});return this.markClosedBlock(i,a),a}BeginLoop(t,r){let n=19,i=Rt(this,n,r);return this.pushInstruction({type:n,valueType:i,args:r,endIndex:-1,callData:t})}EndLoop(t){let r=20,n=Rt(this,r,t),i=t[0],s=this.getInstruction(i);this.instructions[i]={type:s.type,valueType:s.valueType,args:s.args,endIndex:this.instructionsLength(),callData:s.callData};let o=this.pushInstruction({type:r,valueType:n,args:t});return this.markClosedBlock(i,o),o}ExtendSeed(t,r){let n=44,i=Ve;return this.pushInstruction({type:n,valueType:i,args:r,tag:t})}Noop(){let t=0,r=ft;return this.pushLeafInstruction({type:t,valueType:r})}Action(t,r){return this.pushInstruction({type:49,valueType:Ze,args:r,symbols:t})}replaceInstructionWithConstant(t,r){this.instructions[t]=r,this.blockMask[t]=void 0}replaceInstructionWithBlockVar(t,r){this.instructions[t]=r}reopenFinalBlock(){let t=this.getInstruction(this.getReturnIndex());if(t.type!==48)return this;let r=t.args[0],i=this.getInstruction(r).args[0];for(let s=i;s<r;s++)this.blockMask[s]=void 0;return this.truncate(r),this}reopenAllBlocks(){this.blockMask=[]}isInClosedBlock(t){return!!this.blockMask[t]}copy(){let t=new Es({argNames:this.argNames,argTypes:this.argTypes});return t.instructions=this.instructions.slice(),t.blockMask=this.blockMask.slice(),t.comments=this.comments.slice(),t.derivativeMaps=Ti(this.derivativeMaps),t.setReturnIndex(this.getReturnIndex()),t}close(){return this.setReturnIndex(Nr(this,this.getReturnIndex())),I0(this),this}copyInstruction(t){return gi(this,t)}copyInstructionWithArgs(t,r){return Xt(this,t,r)}replaceInstructionWithNoop(t){this.instructions[t]={type:0,valueType:ft}}getReturnType(){return this.instructions[this.getReturnIndex()].valueType}isConstant(){return At(this.instructions[this.getReturnIndex()])}asValue(){return Nt(this,this.getReturnIndex())}asCompilerValue(){let t=this.instructions[this.getReturnIndex()];switch(t.type){case 1:return t.value;default:throw new Error(`Unexpected opcode ${t.type}.`)}}getConstantListLength(){return Wt(this,this.getReturnIndex())}getListLengthDependencies(){let t=this.copy(),r=Ur(t,t.getReturnIndex());return Xr(t,r)}elementAt(t){let r=this.copy(),n=r.getReturnIndex();return r.setReturnIndex(hl(r,n,t)),r.close(),r}substituteConstantArguments(t){return $E(this,t)}interpretWithParameters(t){return YI(this,this.getReturnIndex(),t)}getCompiledFunction(t){let r;if(t){r=t.slice();for(let s of this.argNames)r.indexOf(s)===-1&&r.push(s)}else r=this.argNames;let{source:n,constants:i}=m0(this);return{args:r,source:n,constants:i,fn:Zh(r,n,i)}}polynomialOrder(t,r){return v0(this,t,r)}getPolynomialCoefficients(t){return O0(this,t)}takeDerivative(t){let r=this.copy(),n=this.argNames.indexOf(t);return n===-1?(r.Constant(0),r.close(),r):(r.setReturnIndex(Al(r,r.getReturnIndex(),n)),r.close(),r)}deriveRegressionRestrictions(){return qE(this)}boundDomain(t){return BE(this,t,this.getReturnIndex())}findLinearSubset(t){let r=GE(this),n=[];for(let i of t){let s=this.argNames.indexOf(i);if(s===-1)throw new Error("Programming Error: findLinearSubset called with a non-dependency");n.push(r[s])}return n}print(){return kI(this)}printInstruction(t){return pa(this,t)}toDot(){return E0(this)}getLiveArgNames(){let t=[];for(let r=0;r<this.argNames.length;r++)this.instructions[r].type===2&&t.push(this.argNames[r]);return t}getCursorContext(){return this.cursorContext}setCursorContext(t){this.cursorContext=t}};var Os={normaldist:{pdf:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction("normalpdf",r.concat(n.args))},cdf:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction("normalcdf",r.concat(n.args))},mean:function(e,t,r){return e.getInstruction(t).args[0]},median:function(e,t,r){return Os.normaldist.mean(e,t,r)},stdev:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction("abs",[n.args[1]])},var:function(e,t,r){let n=e.getInstruction(t);return e.Multiply([n.args[1],n.args[1]])},quantile:function(e,t,r){let n=e.getInstruction(t);return e.Add([e.Multiply([e.SyntheticNativeFunction("invNorm",r),e.SyntheticNativeFunction("abs",[n.args[1]])]),n.args[0]])},random:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction("normalSample",[r[0],n.args[0],n.args[1]])}},tdist:{pdf:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction("tpdf",r.concat(n.args))},cdf:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction("tcdf",r.concat(n.args))},mean:function(e,t,r){return e.Constant(0)},median:function(e,t,r){return e.Constant(0)},stdev:function(e,t,r){return e.SyntheticNativeFunction("sqrt",[Os.tdist.var(e,t,r)])},var:function(e,t,r){let n=e.getInstruction(t),i=e.Constant(2),s=n.args[0];return e.Piecewise([e.GreaterEqual([s,i]),e.Divide([s,e.Subtract([s,i])]),e.Constant(NaN)])},quantile:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction("invT",[r[0],n.args[0]])},random:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction("tSample",[r[0],n.args[0]])}},poissondist:{pdf:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction("poissonpdf",r.concat(n.args))},cdf:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction("poissoncdf",r.concat(n.args))},mean:function(e,t,r){return e.getInstruction(t).args[0]},median:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction("invPoisson",[e.Constant(.5),n.args[0]])},stdev:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction("sqrt",[n.args[0]])},var:function(e,t,r){return Os.poissondist.mean(e,t,r)},quantile:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction("invPoisson",[r[0],n.args[0]])},random:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction("poissonSample",[r[0],n.args[0]])}},binomialdist:{pdf:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction("binompdf",r.concat(n.args))},cdf:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction("binomcdf",r.concat(n.args))},mean:function(e,t,r){let n=e.getInstruction(t);return e.Multiply([n.args[0],n.args[1]])},median:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction("invBinom",[e.Constant(.5),n.args[0],n.args[1]])},stdev:function(e,t,r){return e.SyntheticNativeFunction("sqrt",[Os.binomialdist.var(e,t,r)])},var:function(e,t,r){let n=e.getInstruction(t),[i,s]=n.args;return e.Multiply([i,e.Multiply([s,e.Subtract([e.Constant(1),s])])])},quantile:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction("invBinom",[r[0],n.args[0],n.args[1]])},random:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction("binomSample",[r[0],n.args[0],n.args[1]])}},uniformdist:{pdf:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction("uniformpdf",r.concat(n.args))},cdf:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction("uniformcdf",r.concat(n.args))},mean:function(e,t,r){let n=e.getInstruction(t);return e.Divide([e.Add([n.args[0],n.args[1]]),e.Constant(2)])},median:function(e,t,r){return Os.uniformdist.mean(e,t,r)},stdev:function(e,t,r){return e.SyntheticNativeFunction("sqrt",[Os.uniformdist.var(e,t,r)])},var:function(e,t,r){let n=e.getInstruction(t),i=e.Subtract([n.args[1],n.args[0]]);return e.Divide([e.Multiply([i,i]),e.Constant(12)])},quantile:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction("invUniform",[r[0],n.args[0],n.args[1]])},random:function(e,t,r){let n=e.getInstruction(t);return e.SyntheticNativeFunction("uniformSample",[r[0],n.args[0],n.args[1]])}}};function YE(e,t,r){let n=r[0],i=e.Constant(0),s=e.Constant(1);if(Wt(e,t)===0)return e.Constant(NaN);let a=Ur(e,t);return e.InboundsListAccess([t,e.Add([e.SyntheticNativeFunction("floor",[e.Multiply([e.SyntheticNativeFunction("uniformSample",[n,i,s]),a])]),s])])}function Qf(e,t,r){if(t===r)return!0;if(t<r)return!1;let n=[!0];for(let s=r+1;s<=t;s++)n.push(!1);let i=[t];for(;i.length;){let s=i.pop();if(n[s-r])continue;n[s-r]=!0;let o=e.getInstruction(s);if(!me(o))for(let a of o.args){if(a===r)return!0;a<r||n[a-r]||i.push(a)}}return!1}var Ys;function WE(e){Ys=e}function XE(){Ys&&(Ys.cacheHits+=1)}function ZE(){Ys&&(Ys.cacheMisses+=1)}function jE(){Ys&&(Ys.cacheWrites+=1)}function JE(){Ys&&(Ys.cacheReads+=1)}var KE={segment:!0,ray:!0,line:!0,circle:!0,arc:!0,polygon:!0,glider:!0,midpoint:!0,intersection:!0,strictintersection:!0,perpendicular:!0,parallel:!0,translate:!0,rotate:!0,dilate:!0,reflect:!0,apply:!0,segments:!0,vertices:!0,angle:!0,angles:!0,directedangle:!0,directedangles:!0,clockwise:!0,counterclockwise:!0,reflex:!0};function lL(e){return e!==void 0&&e in KE}function QE(e){return lL(e)?e==="rotate"||e==="dilate"||e==="translate"||e==="reflect"?!0:!1:!1}function Kf(e){if(e.type==="ListAccess"&&e.list.type==="Identifier"&&e.index.type==="Constant")return[e.list._symbol,e.index.asValue()];if(e.type==="Identifier")return[e._symbol,void 0]}function ed(e){let t={},r=e;if((r instanceof zs||r instanceof ks)&&(t.identifier=r._symbol,r=r._expression),r instanceof Ca&&r.index instanceof rr&&(t.listAccess=r.index.asValue(),r=r.list),t.identifier&&r instanceof lt){let n=r._symbol,i=t.listAccess;t.assignmentRhsReference=[n,i]}if(r instanceof Ar){let n=r._symbol,i=r.args[0]instanceof lt?r.args[0]._symbol:void 0;if(QE(n)&&e instanceof ks&&i&&e._argSymbols.some(s=>s===i))t.tree={symbol:n,parents:r.args.slice(1).map(Kf)};else if(!QE(n)&&KE[n])t.tree={symbol:n,parents:r.args.map(Kf)};else{let s=[r._symbol,void 0];t.tree={symbol:"apply",parents:[s,...r.args.map(Kf)]}}}else if(r instanceof Gs){let n=r.args.map(Kf);n.length===2&&n[1]&&n[1][0]==="segments"&&(t.tree={symbol:"segment",parents:[n[0]]})}return t}function rv(e,t,r,n,i){let s=fe(r,ie)||fe(r,ee),o=fe(i,ie)||fe(i,ee);if(!s&&!o)return;let a=tv(e,t,r),u=tv(e,n,i),l=a.filter(c=>u.some(p=>Zb(c,p))&&!!e.lookup(c[0]));for(let c of a)ev(e,c,n)&&l.every(p=>!Zb(c,p))&&l.push(c);for(let c of u)ev(e,c,t)&&l.every(p=>!Zb(c,p))&&l.push(c);if(l.length===1)return l[0]}function Zb(e,t){return e[0]===t[0]&&e[1]===t[1]}function ev(e,[t,r],n){let i=e.lookup(t),s=i&&e.getGeometryTree(i);return((s==null?void 0:s.symbol)==="glider"||(s==null?void 0:s.symbol)==="intersection"||(s==null?void 0:s.symbol)==="strictintersection"||(s==null?void 0:s.symbol)==="midpoint")&&(s==null?void 0:s.parents.some(o=>o&&e.resolvesTo(o[0],n)&&(r===void 0||o[1]===void 0||o[1]===r)))}function tv(e,t,r){var s;let n=[],i=((s=e.getGeometryTree(t))==null?void 0:s.parents)||[];for(let o=0;o<i.length;o++){let a=i[o];if(fe(r,ie)&&o===0||!a)continue;let u=e.lookup(a[0]);if(!u)continue;let l=e.getValueType(u);fe(l,A)&&n.push(a)}return n}function jb(e,t,r){if(!t)return;let n=nv(t,r._expression);n==="start-to-end"?e.setCursorContext({type:r.type==="Assignment"?"assignment-rhs":"function-definition-body",allowedTypes:[ft]}):n==="empty-list"&&e.setCursorContext({type:"expression-arguments",expressionType:"List",argIndex:0,isLastValidArg:!1,positionWithinArg:"start-to-end",allowedTypesForInsertedArg:[ft]})}function lu(e,t,r,n){let i=cL(e,t,r,n);i&&e.setCursorContext(i)}function nv(e,t){let r=t.getInputSpan();return r?e.start===r.start&&e.end===r.end?"start-to-end":e.start===e.end&&e.start===r.end?"end":e.start===e.end&&e.start===r.start?"start":e.start===e.end&&t.type==="List"&&t.args.length===0?"empty-list":"not-aligned":"not-aligned"}function Jb(e,t){if(!e)return;let r=t.args;if(r){if(r.length===0){let n=t.getInputSpan();if(!n)return;let i=xr(n),s=-1;return t.type==="List"?s=i.indexOf("["):(t.type==="FunctionCall"||t.type==="SeededFunctionCall")&&(s=i.indexOf("(")),s<0?void 0:e.start===n.start+s+1?{argIndex:0,positionWithinArg:"start-to-end"}:void 0}for(let n=0;n<r.length;n++){let i=r[n],s=i.getInputSpan();if((s==null?void 0:s.input)!==e.input)continue;if(e.start<s.start)break;let o=nv(e,i);if(o!=="not-aligned")return{argIndex:n,positionWithinArg:o}}}}function cL(e,t,r,n){if(!t||!r.args)return;let s=Jb(t,r);if(s===void 0)return;let o=s.positionWithinArg==="end"?s.argIndex+1:s.argIndex,a;s.positionWithinArg==="empty-list"||s.positionWithinArg==="start-to-end"?a=[...n.slice(0,o),void 0,...n.slice(o+1)]:r instanceof hs?a=o===1?[n[0],void 0,n[1]]:[n[0],n[1],void 0]:a=[...n.slice(0,o),void 0,...n.slice(o)],a=a.map(c=>{if(!(c===void 0||e.getInstruction(c).type===2))return c});let u=i0(e,r,a),l=u&&Df(u,o);if(s.positionWithinArg==="empty-list"){let c=l==null?void 0:l.filter(k).map(ke);return(c==null?void 0:c.length)===0?void 0:{type:"expression-arguments",expressionType:"List",argIndex:0,isLastValidArg:!1,positionWithinArg:"start-to-end",allowedTypesForInsertedArg:c!=null?c:[ft]}}else{if((l==null?void 0:l.length)===0)return;let c=!1;if(u){let f=0;for(let m of u){let d=Array.isArray(m)?m.length-1:1/0;f=Math.max(f,d)}c=s.positionWithinArg==="end"&&s.argIndex===f-1||s.positionWithinArg==="start-to-end"&&s.argIndex===f}let p={type:"expression-arguments",expressionType:r.type,argIndex:s.argIndex,isLastValidArg:c,positionWithinArg:s.positionWithinArg,allowedTypesForInsertedArg:l!=null?l:[ft]};if(r instanceof Ar&&r._symbol==="polygon"){let f=r.args.filter(m=>!(m instanceof lt&&m._symbol==="cursor"));if(f.length>0){let m=f[0].getInputSpan(),d=f[f.length-1].getInputSpan();p.polygonVertices=m&&d?{firstLatex:xr(m),lastLatex:xr(d),vertexCount:r.args.length}:void 0}}return p}}function iv(e){return e.type==="FunctionDefinition"}function td(e){return e.type==="Identifier"}function Pi(e){return e.type==="Table"}function rd(e){return e.type==="Image"}function Zi(e){return e.type==="Error"}function cu(e){return e.type==="Regression"}function pL(e){let t=el({},{},-1);for(let r=0;r<e.argNames.length;r++)wn(t,e.argNames[r],r);return t}function On(e,t,r,n,i,s,o){return{policy:e,frame:t,chunk:r,scope:n,parentNode:i,substitutionContext:s,selection:o}}function rx(e){let{policy:t,frame:r,argNames:n,argTypes:i,selection:s}=e,o=new Es({argNames:n,argTypes:i}),a=pL(o);return On(t,r,o,a,void 0,{},s)}function fu(e,t){let{policy:r,frame:n,argNames:i,argTypes:s,selection:o}=e,a=Hb(n,t),{freeDependencies:u,updateSymbols:l}=a;if(i||(i=u),!s){s=[];for(let p=0;p<i.length;p++)s.push(x)}let c=rx({policy:r,frame:n,argNames:i,argTypes:s,selection:o});try{be(c,t),e.coerceToNumber&&ha(c.chunk,c.chunk.getReturnIndex()),e.wrapInList&&!k(c.chunk.getReturnType())&&c.chunk.List([c.chunk.getReturnIndex()]),c.chunk.close(),dL(c,t,a),fL(c,t,l)}catch(p){let f=p instanceof S?p:Ce();f.setCursorContext(c.chunk.getCursorContext()),c.chunk.setError(f)}return c.chunk}function fL(e,t,r){if(t.type==="FunctionDefinition")for(let i of r){if(t._argSymbols.indexOf(i)!==-1||t._symbol===i)throw Qc(i);if(t._sybmol===i)throw Jc(i)}let n=[];for(let i of r)e.frame[i]||n.push(i);if(n.length){let i=dv(e,n[0]).setDependencies(e.chunk.argNames.concat(n));throw e.chunk.isConstant()&&e.chunk.getReturnType()===Ze&&i.setActionValue(e.chunk.asValue()),i}}function dL(e,t,{substitutionSymbols:r,substitutionBodyDependencies:n}){if(t.type==="FunctionDefinition"){for(let s of r){if(t._argSymbols.indexOf(s)!==-1||t._symbol===s)throw Np(s);if(t._sybmol===s)throw Ap(s)}for(let s of n)if(t._argSymbols.indexOf(s)!==-1||t._symbol===s)throw rh(s)}let i=[];for(let s of r)e.frame[s]||i.push(s);if(i.length){let s=i[0];if(e.policy.substitutionForbidden(s))throw Dp(s)}}function be(e,t){let r;if(JE(),gL(e,t))XE(),r=e.chunk.copyInstruction(t.__IRCache.instruction);else{ZE();let n=e.chunk.instructionsLength(),{policy:i,frame:s,chunk:o,scope:a,parentNode:u,substitutionContext:l,selection:c}=e,p=On(i,s,o,a,t,l,c);if(r=hL(p,t),!uv(t,u)){let f=o.getInstruction(r);f.type===48&&f.isConstantBroadcast&&(r=Nr(o,r))}r=mL(e,n,r),yL(e,t,r)}return e.chunk.setReturnIndex(r),r}function mL(e,t,r){let{chunk:n,scope:i}=e;if(r<=t)return r;let s=n.getInstruction(r);return At(s)?(n.truncate(Math.max(t,i.maxIndex+1)),gi(n,s)):r}function uv(e,t){if(!t||!e.getScope||!t.getScope)return!1;let r=t.getScope().dependencies,n=e.getScope().dependencies;if(n.length===r.length)return!0;let i=0;for(let o of n)Se[o]||(i+=1);let s=0;for(let o of r)Se[o]||(s+=1);return i===s}function yL(e,t,r){let{frame:n,chunk:i,parentNode:s}=e,o=i.getInstruction(r);if(!At(o)||uv(t,s))return;let a=LE(n,t);a&&(jE(),t.__IRCache={keys:a,instruction:o})}function gL(e,t){let{frame:r,substitutionContext:n}=e;if(!t.__IRCache)return!1;let i=t.__IRCache.keys;for(let[s,o]of i){let a=r[s];if(a!==o||a&&a.type==="RegressionParameter"&&n.body)return!1}return!0}function hL(e,t){let{policy:r,frame:n,chunk:i,scope:s,parentNode:o,substitutionContext:a,selection:u}=e;switch(t.type){case"Constant":{let p=t._constantValue,f=typeof p=="boolean"?Ie:x;return i.ConstantOfType(f,p)}case"RegressionParameter":return i.Constant(t._constantNode._constantValue);case"MixedNumber":return i.Constant(t._constantValue);case"Negative":return i.Negative(Qb(e,t.args));case"Add":return i.Add(sn(e,t.args));case"Subtract":return i.Subtract(sn(e,t.args));case"Multiply":{let p=sn(e,t.args);if(e.policy.is3dProduct()){let f=i.getInstruction(p[0]).valueType,m=i.getInstruction(p[1]).valueType;if(fe(f,G)&&fe(m,G))throw _m([te(f),te(m)]);if(fe(f,A)&&fe(m,A))throw wm([te(f),te(m)])}return i.Multiply(p)}case"DotMultiply":{let[p,f]=sn(e,t.args);if(e.policy.is3dProduct()&&U(i,p,A)&&U(i,f,A)){let m=i.Constant(1),d=i.Constant(2);return i.Add([i.Multiply([i.OrderedPairAccess([p,m]),i.OrderedPairAccess([f,m])]),i.Multiply([i.OrderedPairAccess([p,d]),i.OrderedPairAccess([f,d])])])}else if(e.policy.is3dProduct()&&U(i,p,G)&&U(i,f,G)){let m=i.Constant(1),d=i.Constant(2),y=i.Constant(3);return i.Add([i.Add([i.Multiply([i.OrderedTripleAccess([p,m]),i.OrderedTripleAccess([f,m])]),i.Multiply([i.OrderedTripleAccess([p,d]),i.OrderedTripleAccess([f,d])])]),i.Multiply([i.OrderedTripleAccess([p,y]),i.OrderedTripleAccess([f,y])])])}else return i.Multiply([p,f])}case"CrossMultiply":{let[p,f]=sn(e,t.args);if(e.policy.is3dProduct()&&U(i,p,G)&&U(i,f,G)){let[m,d]=sn(e,t.args),y=i.Constant(1),g=i.Constant(2),h=i.Constant(3),P=i.OrderedTripleAccess([m,y]),T=i.OrderedTripleAccess([m,g]),D=i.OrderedTripleAccess([m,h]),N=i.OrderedTripleAccess([d,y]),I=i.OrderedTripleAccess([d,g]),O=i.OrderedTripleAccess([d,h]);return i.OrderedTriple([i.Subtract([i.Multiply([T,O]),i.Multiply([D,I])]),i.Subtract([i.Multiply([D,N]),i.Multiply([P,O])]),i.Subtract([i.Multiply([P,I]),i.Multiply([T,N])])])}else if(e.policy.is3dProduct()&&(U(i,p,A)&&U(i,f,A)||U(i,p,x)&&U(i,f,G)||U(i,p,G)&&U(i,f,x))){let m=i.getInstruction(p).valueType,d=i.getInstruction(f).valueType;throw Lm([te(m),te(d)])}else return i.Multiply([p,f])}case"Divide":return i.Divide(sn(e,t.args));case"Exponent":return i.Exponent(sn(e,t.args));case"Comparator['=']":return i.Equal(sn(e,t.args));case"Comparator['>']":return i.Greater(sn(e,t.args));case"Comparator['<']":return i.Less(sn(e,t.args));case"Comparator['>=']":return i.GreaterEqual(sn(e,t.args));case"Comparator['<=']":return i.LessEqual(sn(e,t.args));case"And":return i.And(sn(e,t.args));case"PercentOf":return i.Divide([i.Multiply(sn(e,t.args)),i.Constant(100)]);case"ParenSeq":return IL(e,t);case"BareSeq":return ML(e,t);case"NamedCoordinateAccess":{let[p]=Qb(e,t.args),f=t.symbol,m=U(i,p,G),d;switch(f){case"x":d=i.Constant(1);break;case"y":d=i.Constant(2);break;case"z":{if(!m)throw dn(".");d=i.Constant(3);break}default:{let y=f;throw new Error(`Programming Error: unexpected named coordinate: '${y}'.`)}}return m?i.OrderedTripleAccess([p,d]):i.OrderedPairAccess([p,d])}case"Norm":{let p=Qb(e,t.args)[0];if(U(i,p,G)){let f=i.OrderedTripleAccess([p,i.Constant(1)]),m=i.OrderedTripleAccess([p,i.Constant(2)]),d=i.OrderedTripleAccess([p,i.Constant(3)]);return i.SyntheticNativeFunction("sqrt",[i.Add([i.Add([i.Multiply([f,f]),i.Multiply([m,m])]),i.Multiply([d,d])])])}else return i.SyntheticNativeFunction("abs",[p])}case"UpdateRule":{let p=t._symbol;var l=n[p];if(l!==void 0){if(l!==Gt&&l.isError)throw l;if(l===Gt||l.type!=="Assignment"&&l.type!=="Slider")throw dv(e,p)}let f=be(On(r,n,i,s,o,a,u),t.args[1]);return i.Action([p],[f])}case"List":{let p;if(t.getDependencies().length>0)rn(t.args),p=i.List(pu(e,t.args));else if(t.args.length===0)lu(i,u,t,[]),p=i.ConstantOfType(Me,[]);else{let f=i.instructionsLength(),m=[],d,y;rn(t.args);for(let h of t.args){let P=be(e,h),T=i.getInstruction(P);if(d===void 0){if(d=T.valueType,!zn(d))throw Xo([te(d)]);y=fn(d)}else if(T.valueType!==d)throw Fu();if(T.type!==1)throw new Error("Programming error: expected list with no dependencies to constant collapse.");m.push(T.value),i.truncate(f)}let g=Jb(e.selection,t);if(e.selection&&g!==void 0&&y!==void 0&&g.positionWithinArg!=="empty-list"){let h=ke(y);i.setCursorContext({type:"expression-arguments",expressionType:"List",argIndex:g.argIndex,isLastValidArg:!1,positionWithinArg:g.positionWithinArg,allowedTypesForInsertedArg:[h]})}p=i.ConstantOfType(y,m)}return p}case"ListAccess":{let p=be(e,t.args[0]),f=i.getInstruction(p);if(t.args[1].type==="Range"&&t.args[1].args[1].length===0){if(!k(f.valueType))throw Fa([te(f.valueType),te(x)]);let m=Ur(i,p),d=ex(e,be(e,t.args[1].args[0]),i.List([m]),{stepMustBePositive:!0});return i.ListAccess([p,d])}else{let m=be(e,t.args[1]),d=i.getInstruction(m);if(!k(f.valueType))throw Fa([te(f.valueType),te(d.valueType)]);return d.valueType===Ir?i.SyntheticNativeFunction("select",[p,m]):i.ListAccess([p,m])}}case"Range":{let[p,f]=sn(e,t.args);return ex(e,p,f,{stepMustBePositive:!1})}case"ListComprehension":return EL(e,t);case"Piecewise":{let p=bL(e,t.args),f=i.getInstruction(p[0]),m=i.getInstruction(p[1]),d=i.getInstruction(p[2]),y=Li(m.valueType,d.valueType)||Li(d.valueType,m.valueType);if(f.type===1&&f.valueType===Ie&&y){let g=p[f.value?1:2],h=i.getInstruction(g),P=m.valueType!==Me?m.valueType:d.valueType;return h.valueType===Me&&P!==Me?i.ConstantOfType(P,[]):g}if(!y&&At(d)&&d.valueType===x&&Rn(d.value)&&TP(m.valueType)){let g=i.NanOfType(m.valueType);p=[p[0],p[1],g]}return i.Piecewise(p)}case"Ans":case"Identifier":{let p=t._symbol,f=t._errorSymbol;if(t.type==="Ans"&&i.argNames.indexOf(p)!==-1)throw Hg();let m=Ha(s,p),d=n[p];if(m!==void 0&&(s.symbolMap.hasOwnProperty(p)||d===void 0||d===Gt))return m;if(d===void 0)throw Se[p]?Se[p].isFunction?Hn(f):Ko(f):new Error(`Programming Error: reached undefined symbol ${p}`);if(d!==Gt&&Zi(d))throw d;if(d===Gt||d.isFunction)throw Ry(f);if(a.body&&d.type==="RegressionParameter")throw eh(f);let y=On(r,n,i,s,void 0,a,u),g=be(y,d);return wn(s,p,g,d),g}case"FunctionCall":case"SeededFunctionCall":{rn(t.args);let p=pu(e,t.args);return rn(p),nd(e,t._symbol,t._errorSymbol,p,t.args)}case"Substitution":return SL(e,t);case"FunctionExponent":{let p=t.args[0]._symbol,f=n[p];return f!==Gt&&(f!=null&&f.isFunction)?be(e,new b.Exponent([new b.FunctionCall(p,[t.args[1]]),t.args[2]])):be(e,new b.Multiply([t.args[0],new b.Exponent([t.args[1],t.args[2]])]))}case"FunctionFactorial":{let p=t.args[0]._symbol,f=n[p];return f!==Gt&&(f!=null&&f.isFunction)?be(e,new b.FunctionCall("\\factorial",[new b.FunctionCall(p,[t.args[1]])])):be(e,new b.Multiply([t.args[0],new b.FunctionCall("\\factorial",[t.args[1]])]))}case"DotAccess":{let p=t.args[0],f=t.args[1],m=n[f._symbol];if(p.type==="Identifier"&&p._symbol==="construction")return NL(e,f);if((f.type==="Identifier"||f.type==="FunctionCall")&&m!==Gt&&(m!=null&&m.isFunction)){let d=f._symbol,y=f._errorSymbol,g=f.type==="Identifier"?[p]:[p].concat(f.args),h=pu(e,g);return nd(e,d,y,h,g,{dotLHSIndex:h[0]})}else if(f.type==="SeededFunctionCall"){let d=f._symbol,y=f._errorSymbol,g=[f.seed,p].concat(f.args.slice(1)),h=pu(e,g);return nd(e,d,y,h,g,{dotLHSIndex:h[1]})}else throw dn(".")}case"Seed":return i.ConstantOfType(Ve,t._stringValue);case"ExtendSeed":return i.ExtendSeed(t.tag,sn(e,t.args));case"Integral":{let p=t._differential._symbol,f=Ha(s,p);if(n[p]!==void 0||f!==void 0&&i.getInstruction(f).type!==2)throw zg(p);let m=Object.create(n);m[p]=qg(p);let d=xs(s),y=On(r,m,i,d,o,a,u),g=be(y,t.args[1]),h=be(y,t.args[2]),P=i.getInstruction(g),T=i.getInstruction(h),D=i.SymbolicVar(x,p),N=xs(s);wn(N,p,D);let I=Object.create(n);I[p]=Gt;let O=be(On(r,I,i,N,o,a,u),t.args[3]);if(!Qf(i,O,D))return i.Multiply([O,i.Subtract([h,g])]);let E=yl(i,[g,h,O]),v=E!==void 0?i.BeginBroadcast([E]):void 0,_=g;v!==void 0&&k(P.valueType)&&(_=ao(i,g,v));let z=h;v!==void 0&&k(T.valueType)&&(z=ao(i,h,v));let R=i.BeginIntegral({indexSymbol:p},[_,z]),H=bo(i,R,D,O),W=i.getInstruction(H);v!==void 0&&k(W.valueType)&&(H=ao(i,H,v));let $=i.EndIntegral([R,H]),re=i.BlockVar(x,[$]);if(v!==void 0){let j=i.EndBroadcast([v,re]);return i.BroadcastResult(Z,[j])}else return re}case"Sum":case"Product":{let p=t._index._symbol,f=Ha(s,p);if(n[p]!==void 0||f!==void 0&&i.getInstruction(f).type!==2)throw tg(p);let m=t.type==="Sum",d=Object.create(n);d[p]=m?Ag(p):Rg(p);let y=xs(s),g=On(r,d,i,y,o,a,u),h=be(g,t.args[1]);h=ha(g.chunk,h);let P=be(g,t.args[2]);if(P=ha(g.chunk,P),!U(i,h,x)){let ae=hn(i,[h]);throw m?$m(ae):Xm(ae)}if(!U(i,P,x)){let ae=hn(i,[P]);throw m?Ym(ae):Zm(ae)}let T=i.SyntheticNativeFunction("round",[h]),D=i.SyntheticNativeFunction("round",[P]),N=i.getInstruction(T),I=i.getInstruction(D);if(N.type===1&&N.valueType===x&&!isFinite(V(N.value)))throw m?Zc():jc();if(I.type===1&&I.valueType===x&&!isFinite(V(I.value)))throw m?Zc():jc();let O=i.SymbolicVar(x,p),E=xs(s);wn(E,p,O);let v=Object.create(n);v[p]=Gt;let _=be(On(r,v,i,E,o,a,u),t.args[3]);if(!Qf(i,_,O)){let ae=i.Add([i.Subtract([D,T]),i.Constant(1)]);ae=i.SyntheticNativeFunction("max",[ae,i.Constant(0)]);let ge=m?i.Multiply([_,ae]):i.Exponent([_,ae]);return i.Piecewise([i.Less([ae,i.Constant(1/0)]),ge,i.Constant(NaN)])}if(!U(i,_,x)){let ae=hn(i,[_]);throw m?Wm(ae):jm(ae)}let z=yl(i,[T,D,_]);if(z!==void 0&&Qf(i,z,O))throw m?Jg(p):Qg(p);let R=z!==void 0?i.BeginBroadcast([z]):void 0,H=T;R!==void 0&&k(N.valueType)&&(H=ao(i,T,R));let W=D;R!=null&&k(I.valueType)&&(W=ao(i,D,R));let $=i.Constant(m?0:1),re=i.BeginLoop({type:m?"sum":"product",indexSymbol:p},[H,W,$]),j=i.BlockVar(x,[re]),ve=bo(i,re,O,_),we=i.getInstruction(ve);R!==void 0&&k(we.valueType)&&(ve=ao(i,ve,R));let Dt=m?i.Add([j,ve]):i.Multiply([j,ve]),_e=i.EndLoop([re,Dt]),Q=i.BlockVar(x,[_e]);if(R!==void 0){let ae=i.EndBroadcast([R,Q]);return i.BroadcastResult(Z,[ae])}else return Q}case"Derivative":{let p=t._symbol,f=be(e,new b.Identifier(p));if(!U(i,f,x))throw ty(p,hn(i,[f]));let m=i.getInstruction(f),d,y;if((m.type===2||m.type===3)&&m.valueType===x)d=e,y=f;else{let T=xs(s);y=i.SymbolicVar(m.valueType),wn(T,p,y);let D=Object.create(n);D[p]=Gt,d=On(r,D,i,T,o,a,u)}let g=1;for(;t.args[0].type==="Derivative"&&t.args[0]._symbol===t._symbol;)g+=1,t=t.args[0];let P=Nr(i,be(d,t.args[0]));for(let T=0;T<g;T++)P=Al(i,P,y);return y===f?P:bo(i,f,y,P)}case"Prime":{let p=t.args[0];if(!n[p._symbol])throw fp(p._symbol);let f=be(e,p.args[0]),m=i.getInstruction(f),d;(m.type===2||m.type===3)&&m.valueType===x?d=f:d=i.SymbolicVar(m.valueType);let y,g;if(p._symbol==="logbase"){if(p.args.length!==2)throw Jo();y=[d,be(e,p.args[1])],g=[p.args[0],p.args[1]]}else{if(p.args.length!==1)throw Jo();y=[d],g=[p.args[0]]}let P=Nr(i,nd(e,p._symbol,p._errorSymbol,y,g));for(let T=0;T<t.order;T++)P=Al(i,P,d);return d===f?P:bo(i,f,d,P)}case"Slider":return e.chunk.Constant(t.getConcreteTree(r,n).asCompilerValue());case"Assignment":return jb(i,e.selection,t),be(e,t._expression);case"CoordinateEquation":return be(e,t._expression);case"FunctionDefinition":{jb(i,e.selection,t);for(var c=0;c<t._argSymbols.length;c++){if(n[t._argSymbols[c]])throw dp(t._argSymbols[c]);if(t._argSymbols[c]===t._symbol)throw dp(t._argSymbols[c])}return be(e,t._expression)}case"Construction":throw dn("construction");default:throw new Error(`Programming error, unimplemented node type ${t.type}`)}}function Qb(e,t){let r=[be(e,t[0])];return e.parentNode&&lu(e.chunk,e.selection,e.parentNode,r),r}function sn(e,t){let r=[be(e,t[0]),be(e,t[1])];return e.parentNode&&lu(e.chunk,e.selection,e.parentNode,r),r}function bL(e,t){let r=[be(e,t[0]),be(e,t[1]),be(e,t[2])];return e.parentNode&&lu(e.chunk,e.selection,e.parentNode,r),r}function pu(e,t){let r=[];for(let n of t)r.push(be(e,n));return e.parentNode&&lu(e.chunk,e.selection,e.parentNode,r),r}function nd(e,t,r,n,i,s){let{policy:o,frame:a,chunk:u,scope:l,parentNode:c,substitutionContext:p,selection:f}=e,m=Ha(l,t);if(m!==void 0){if(fe(u.getInstruction(m).valueType,Re))return sd(e.chunk,[m,...n],r,!0);if(n.length==1)return u.Multiply([m,n[0]]);throw u.getInstruction(m).type===2?fp(r):u.getInstruction(m).valueType===et?Ip(r):Pp(r)}let d=a[t];if(d!==Gt&&(d!=null&&d.isError))throw d;if(d===void 0||d===Gt||!d.isFunction){if(Se[t]&&Se[t].isFunction)throw t==="logbase"&&a.ln&&a.log?$g():Hn(r);if(d&&d!==Gt){let y=be(e,d);if(u.getInstruction(y).valueType===et)throw Ip(r);if(fe(u.getInstruction(y).valueType,Re))return sd(e.chunk,[y,...n],r,!0)}if(n.length==1)return u.Multiply([be(e,new b.Identifier(t)),n[0]]);throw d?Pp(r):new Error(`Programming Error: reached undefined symbol ${t}`)}if(iv(d)){if(s&&s.dotLHSIndex!==void 0)throw wu(r);if(n.length!==d._argSymbols.length)throw mn(r,d._argSymbols.length,n.length);let y=xs(l),g=Object.create(a);for(let h=0;h<d._argSymbols.length;h++)wn(y,d._argSymbols[h],n[h],i[h]),g[d._argSymbols[h]]=Gt;return be(On(o,g,u,y,c,p,f),d._expression)}else{if(zi.hasOwnProperty(t))return xL(e,t,r,n,i,s);if(gr.hasOwnProperty(t))return cv(e,t,r,n,s);throw Hn(r)}}function lv(e,t,r){let n=e.getInstruction(t).valueType;if(!k(n)&&n!==et&&(n===A||!Ud(n)))throw Hm(r,te(n))}function cv(e,t,r,n,i){let{chunk:s}=e,o=gr[t],a=!!(i&&i.dotLHSIndex!==void 0),u=n.length,{minArity:l,maxArity:c,allowDotCall:p}=o;if(i&&i.dotLHSIndex!==void 0){if(!p)throw wu(r);lv(s,i.dotLHSIndex,"."+r)}if(t==="logbase"&&u!==2)throw mn(r,1,u-1);if(u>c)throw a&&(l-=1,c-=1,u-=1,r="."+r),o.tag==="doubleReducer"?Va(r):o.tag==="parameterizedReducer"?op(r):o.tag==="color"?sp(r):mn(r,c,u);if(u<l)throw a&&(l-=1,c-=1,u-=1,r="."+r),o.tag==="reducer"&&u===0?vy(r):o.tag==="doubleReducer"?Va(r):o.tag==="parameterizedReducer"?op(r):o.tag==="color"?sp(r):mn(r,l,u);let f=pv(s,n,o),m={errorSymbol:r,providedArity:u,isDotCall:a};switch(o.tag){case"default":case"reducer":case"doubleReducer":case"parameterizedReducer":case"color":case"never-broadcast":return s.NativeFunction(t,m,f);case"trig":{let d=be(e,new b.Identifier("trigAngleMultiplier")),y=s.Multiply([f[0],d]);return s.NativeFunction(t,m,[y])}case"trig2":{let d=be(e,new b.Identifier("trigAngleMultiplier")),y=s.Multiply([f[1],d]);return s.NativeFunction(t,m,[f[0],y])}case"inverseTrig":{let d=be(e,new b.Identifier("trigAngleMultiplier")),y=s.NativeFunction(t,m,f);return s.Divide([y,d])}default:{let d=o.tag;throw new Error(`Programming Error: unexpected tag ${d}`)}}}function pv(e,t,{minArity:r,defaultArguments:n}){if(!n||!(t.length-r<n.length))return t;let i=t.slice();for(;i.length-r<n.length;)i.push(e.copyInstruction(n[i.length-r]));return i}function xL(e,t,r,n,i,s){let{chunk:o,policy:a}=e,u=!!(s&&s.dotLHSIndex!==void 0),l=zi[t];if(l.fallthroughUnlessDistribution&&(n.length===0||o.getInstruction(n[0]).valueType===Me||!fe(o.getInstruction(n[0]).valueType,et)))return cv(e,t,r,n,s);let{minArity:c,maxArity:p,allowDotCall:f}=l;if(s&&s.dotLHSIndex!==void 0){if(!f)throw wu(r);lv(o,s.dotLHSIndex,"."+r)}let m=n.length;if(m<c)throw TL(t,r,c,m,{isDotCall:u});if(m>p)throw PL(t,r,p,m,{isDotCall:u});let d;if(t==="cdf")m===2?d=[n[0],o.Constant(-1/0),n[1]]:d=n;else if(t==="random")if(m===1||m<4&&!k(o.getInstruction(n[1]).valueType)&&o.getInstruction(n[1]).valueType!==et){let g=o.Distribution("uniformdist",[o.Constant(0),o.Constant(1)]);d=[n[0],g].concat(n.slice(1))}else d=n;else d=pv(o,n,l);let y=Nf(t);if(y){let g=Xb(o,d,y);g.didCoerce&&(d=g.args)}switch(t){case"length":if(a.isGeometryEnabled()){if(d.length!==1)throw Vt(r,Tn(o,d));let g=d[0];if(o.getInstruction(g).valueType===Me)throw Xc(r,Tn(o,d)[0]);if(U(o,g,pe)){let h=o.Constant(0),P=o.Constant(1);return o.SyntheticNativeFunction("distance",[o.SyntheticNativeFunction("segmentGlider",[g,h]),o.SyntheticNativeFunction("segmentGlider",[d[0],P])])}else if(U(o,g,ee)){let h=o.SyntheticNativeFunction("abs",[o.SyntheticNativeFunction("arcOmega",[d[0]])]),{radius:P,startPoint:T}=tx(o,d[0]),D=o.SyntheticNativeFunction("arcGlider",[d[0],o.Constant(1)]);return o.Piecewise([o.Equal([h,o.Constant(0)]),o.SyntheticNativeFunction("distance",[T,D]),o.Multiply([P,h])])}else throw k(o.getInstruction(g).valueType)?Xc(r,Tn(o,d)[0]):Vt(r,Tn(o,d))}else return o.SyntheticNativeFunction("count",d);case"round":{if(d.length===1)return o.SyntheticNativeFunction("round",d);if(!U(o,d[0],x)||!U(o,d[1],x))throw Vt(r,hn(o,d));let g=o.SyntheticNativeFunction("round",[d[1]]),h=o.RawExponent([o.Constant(10),g]);return o.Divide([o.SyntheticNativeFunction("round",[o.Multiply([d[0],h])]),h])}case"midpoint":if(d.length===1&&U(o,d[0],pe)){let g=o.Constant(he(1,2));return o.SyntheticNativeFunction("segmentGlider",[d[0],g])}else if(d.length===1&&U(o,d[0],ee)){let g=o.Constant(he(1,2));return o.SyntheticNativeFunction("arcGlider",[d[0],g])}else if(d.length===2&&(U(o,d[0],A)&&U(o,d[1],A)||U(o,d[0],G)&&U(o,d[1],G))){let g=o.Constant(he(1,2));return o.Multiply([g,o.Add(d)])}else throw Vt(r,hn(o,d));case"circle":if(d.length===1){if(!U(o,d[0],ee))throw Vt(r,hn(o,d));let{center:g,radius:h}=tx(o,d[0]);return o.SyntheticNativeFunction("circle",[g,h])}else if(U(o,d[1],pe)){let g=o.Constant(0),h=o.Constant(1);return o.SyntheticNativeFunction("circle",[d[0],o.SyntheticNativeFunction("distance",[o.SyntheticNativeFunction("segmentGlider",[d[1],g]),o.SyntheticNativeFunction("segmentGlider",[d[1],h])])])}else return U(o,d[1],A)?o.SyntheticNativeFunction("circle",[d[0],o.SyntheticNativeFunction("distance",d)]):o.SyntheticNativeFunction("circle",d);case"segment":return U(o,d[0],G)&&U(o,d[0],G)?o.SyntheticNativeFunction("segment3d",d):o.SyntheticNativeFunction("segment",d);case"distance":return U(o,d[0],G)&&U(o,d[0],G)?o.SyntheticNativeFunction("distance3d",d):o.SyntheticNativeFunction("distance",d);case"center":{let g=sv(o,d[0]);return o.SyntheticNativeFunction("center",[g])}case"radius":{let g=sv(o,d[0]);return o.SyntheticNativeFunction("radius",[g])}case"glider":{if(!U(o,d[1],x))throw Vt(r,hn(o,d));if(U(o,d[0],pe))return o.SyntheticNativeFunction("segmentGlider",d);if(U(o,d[0],ne))return o.SyntheticNativeFunction("lineGlider",d);if(U(o,d[0],Pe))return o.SyntheticNativeFunction("rayGlider",d);if(U(o,d[0],ie))return o.SyntheticNativeFunction("circleGlider",d);if(U(o,d[0],ee))return o.SyntheticNativeFunction("arcGlider",d);if(U(o,d[0],Te))return o.SyntheticNativeFunction("polygonGlider",d);throw Vt(r,hn(o,d))}case"intersection":case"strictintersection":{let g=0;t==="strictintersection"&&((U(o,d[0],pe)||U(o,d[0],ee))&&(g+=3),(U(o,d[1],pe)||U(o,d[1],ee))&&(g+=12)),U(o,d[0],Pe)&&(g+=1),U(o,d[1],Pe)&&(g+=4);let h=OL(e,i,d);if(!h)return Kb(o,d,r,g);let P=be(e,new b.Identifier(h[0]));return h[1]!==void 0&&(P=o.ListAccess([P,o.Constant(h[1])])),o.SyntheticNativeFunction("chooseNonIncidentPoint",[P,Kb(o,[d[0],d[1]],r,g),Kb(o,[d[1],d[0]],r,g<<2&12|g>>2&3)])}case"parallel":case"perpendicular":{let g=id(o,d[0]),h=[g,d[1]];if(U(o,g,ne)&&U(o,d[1],A))return o.SyntheticNativeFunction(t,h);throw Vt(r,hn(o,d))}case"translate":case"reflect":case"rotate":case"dilate":return vL(e,t,d);case"apply":return sd(o,d,r,!1);case"normaldist":case"tdist":case"poissondist":case"binomialdist":case"uniformdist":return o.Distribution(t,d);case"pdf":case"cdf":case"mean":case"median":case"stdev":case"var":case"quantile":{let g=d[0],h=o.getInstruction(g);if(!fe(h.valueType,et))throw Vt(r,hn(o,n));let P=d.slice(1);for(let T of P)if(!fe(o.getInstruction(T).valueType,x))throw Vt(r,hn(o,n));if(k(h.valueType)){let T=[],D=1/0;for(let I of d){let O=Nr(o,I);T.push(O);let E=o.getInstruction(O);if(k(E.valueType)){let v=Wt(o,O);if(v===void 0)throw Ju(Xr(o,O));D=Math.min(D,v)}}let N=[];for(let I=0;I<D;I++){let O=hl(o,T[0],I),E=o.getInstruction(O);if(E.type!==42)throw Ce();let v=[];for(let _ of T.slice(1))k(o.getInstruction(_).valueType)?v.push(hl(o,_,I)):v.push(_);N.push(Os[E.symbol][t](o,O,v))}return o.List(N)}else{if(h.type!==42)throw Ce();return Os[h.symbol][t](o,g,P)}}case"random":{let g=d[0],h=d[1],P=o.getInstruction(d[0]),T=o.getInstruction(h);if(P.valueType!==Ve)throw Ce();if(T.valueType===Qt)throw Ey();let D;if(k(T.valueType))D=YE;else{if(T.valueType!==et)throw jo();if(T.type!==42)throw Ce();D=Os[T.symbol][t]}if(d.length>2){let N=d[2];if(o.getInstruction(N).valueType!==x)throw jo();if(d.length===4){let R=o.getInstruction(d[3]);if(R.valueType!==x)throw jo();if(!At(R))throw Mp(Xr(o,d[3]));g=o.ExtendSeed("us",[g,d[3]])}let O=o.Constant(1),E=o.SyntheticNativeFunction("round",[o.SyntheticNativeFunction("validateSampleCount",[N])]),v=o.BeginBroadcast([E]);g=o.ExtendSeed("lc",[g,o.Subtract([v,O])]);let _=D(o,h,[g]),z=o.EndBroadcast([v,_]);return o.BroadcastResult(fn(o.getInstruction(_).valueType),[z])}return D(o,h,[g])}case"shuffle":{let g=d[0],h=d[1],P=d[2];if(!k(o.getInstruction(h).valueType)||P!==void 0&&o.getInstruction(P).valueType!==x)throw Vt(r,Tn(o,n.slice(1)));if(P!==void 0){if(!At(o.getInstruction(P)))throw Mp(Xr(o,P));g=o.ExtendSeed("us",[g,P])}return o.SyntheticNativeFunction("shuffle",[g,h])}case"sort":{let g=d.length===2?d[1]:d[0],h=o.getInstruction(g);if(!k(o.getInstruction(d[0]).valueType)||h.valueType!==Z&&h.valueType!==Me)throw Vt(r,Tn(o,n));if(Wt(o,g)===0)return g;let T=o.SyntheticNativeFunction("min",[Ur(o,d[0]),Ur(o,g)]);return g=o.ListAccess([g,ex(e,o.List([o.Constant(1)]),o.List([T]),{stepMustBePositive:!0})]),o.SyntheticNativeFunction("elementsAt",[d[0],o.SyntheticNativeFunction("sortPerm",[g])])}case"join":{let g=[],h=!0;for(let R of d){let H=o.getInstruction(R);oo(H)||(h=!1);let W=H.valueType;if(W!==Me)if(k(W))g.push({isList:!0,index:R,elementType:ke(W)});else if(zn(W))g.push({isList:!1,index:R,elementType:W});else throw Vt(r,Tn(o,n))}if(g.length===0)return o.ConstantOfType(Me,[]);for(let R of g)if(R.elementType!==g[0].elementType)throw Vt(r,Tn(o,n));if(h){let R=[];for(let H of g){let W=o.getInstruction(Nr(o,H.index));UI(W),H.isList?R.push(...W.value):R.push(W.value)}return o.ConstantOfType(fn(g[0].elementType),R)}let P=o.Constant(0),T=o.Constant(1),D={};for(let R of g)R.isList&&D[R.index]===void 0&&(D[R.index]=Ur(o,R.index));let N=o.SyntheticNativeFunction("total",g.map(R=>R.isList?D[R.index]:T)),I=o.BeginBroadcast([N]),O=P,E=[],v=[];for(let R of g){let H=R.isList?o.ListAccess([R.index,o.Subtract([I,O])]):R.index;if(v.push(H),R!==g[g.length-1]){let W=R.isList?D[R.index]:T;O=o.Add([O,W]),E.push(o.LessEqual([I,O]))}}let _=v[v.length-1];for(let R=v.length-2;R>=0;R--)_=o.Piecewise([E[R],v[R],_]);let z=o.EndBroadcast([I,_]);return o.BroadcastResult(fn(g[0].elementType),[z])}case"unique":{let g=d[0],h=o.getInstruction(g);if(!k(h.valueType)||h.valueType===Qt)throw Vt("unique",[te(h.valueType)]);return o.SyntheticNativeFunction("elementsAt",[g,o.SyntheticNativeFunction("uniquePerm",[g])])}case"polygon":{let g=d.map(h=>o.getInstruction(h));if(g.length===0){let h=o.ConstantOfType(Be,[]);return o.SyntheticNativeFunction("polygon",[h])}else if(g.length===2&&fe(g[0].valueType,x)&&fe(g[1].valueType,x)){if(g[0].valueType===x&&g[1].valueType===x)throw xy();let h=o.OrderedPair(d);return o.SyntheticNativeFunction("polygon",[h])}else return o.SyntheticNativeFunction("polygon",d)}case"directedangle":return ov(e,d,r,n);case"angle":return o.SyntheticNativeFunction("undirectedAngleMarker",[ov(e,d,r,n)]);case"angles":return o.SyntheticNativeFunction("polygonInteriorUndirectedAngles",[d[0],be(e,new b.Identifier("trigAngleMultiplier"))]);case"directedangles":return o.SyntheticNativeFunction("polygonInteriorDirectedAngles",[d[0],be(e,new b.Identifier("trigAngleMultiplier"))]);case"coterminal":{if(U(o,d[0],oe))return o.SyntheticNativeFunction("directedCoterminalAngle",d);if(U(o,d[0],de))return o.SyntheticNativeFunction("undirectedCoterminalAngle",d);throw Vt(r,Tn(o,n))}case"histogram":case"dotplot":case"boxplot":case"ttest":case"ittest":case"stats":case"det":case"inv":case"transpose":case"rref":case"trace":case"points":case"lines":case"circles":case"polygons":case"rays":case"arcs":throw dn(r);default:{let g=t;throw new Error(`Programming Error: unexpected compiler function ${g}`)}}}function TL(e,t,r,n,{isDotCall:i}){i&&(r-=1,n-=1,t="."+t);let s=zi[e];s.isSeeded&&(r-=1,n-=1);let o;switch(i&&s.dotMinArityExampleArgs?o=t+s.dotMinArityExampleArgs:s.minArityExampleArgs&&(o=t+s.minArityExampleArgs),e){case"pdf":return i?mn(t,r,n,o):np();case"cdf":return i?mn(t,r,n,o):Iy();case"tdist":return ip();case"random":return jo();case"length":case"round":case"midpoint":case"segment":case"distance":case"circle":case"center":case"radius":case"glider":case"intersection":case"strictintersection":case"parallel":case"perpendicular":case"angle":case"directedangle":case"angles":case"directedangles":case"apply":case"translate":case"reflect":case"dilate":case"rotate":case"normaldist":case"poissondist":case"binomialdist":case"uniformdist":case"mean":case"median":case"stdev":case"var":case"quantile":case"sort":case"shuffle":case"join":case"unique":case"polygon":case"coterminal":return mn(t,r,n,o);case"points":case"lines":case"circles":case"polygons":case"rays":case"arcs":throw dn(t);case"histogram":case"dotplot":case"boxplot":case"ttest":case"ittest":case"stats":case"det":case"inv":case"transpose":case"rref":case"trace":throw Ce();default:let a=e;throw new Error(`Unexpected compiler function ${a}`)}}function PL(e,t,r,n,{isDotCall:i}){i&&(r-=1,n-=1,t="."+t);let s=zi[e];s.isSeeded&&(r-=1,n-=1);let o;switch(i&&s.dotMaxArityExampleArgs?o=t+s.dotMaxArityExampleArgs:s.maxArityExampleArgs&&(o=t+s.maxArityExampleArgs),e){case"pdf":return i?mn(t,r,n,o):np();case"cdf":return i?mn(t,r,n,o):My();case"tdist":return ip();case"random":return jo();case"length":case"round":case"midpoint":case"glider":case"segment":case"distance":case"circle":case"center":case"radius":case"intersection":case"strictintersection":case"parallel":case"perpendicular":case"angle":case"directedangle":case"angles":case"directedangles":case"apply":case"translate":case"reflect":case"dilate":case"rotate":case"normaldist":case"poissondist":case"binomialdist":case"uniformdist":case"mean":case"median":case"stdev":case"var":case"quantile":case"sort":case"shuffle":case"join":case"unique":case"polygon":case"coterminal":return mn(t,r,n,o);case"points":case"lines":case"circles":case"polygons":case"rays":case"arcs":throw dn(t);case"histogram":case"dotplot":case"boxplot":case"ttest":case"ittest":case"stats":case"det":case"inv":case"transpose":case"rref":case"trace":throw Ce();default:let a=e;throw new Error(`Unexpected compiler function ${a}`)}}function IL(e,t){var a,u;let{chunk:r,policy:n}=e;rn(t.args);let i=pu(e,t.args),s=!1,o;for(let l=0;l<i.length;l++){let p=r.getInstruction(i[l]).valueType;if(p===Ze){if(s=!0,o!==void 0)throw Bu([te(o),te(Ze)])}else{if(s)throw Bu([te(Ze),te(p)]);o=p}}if(s)return fv(e,i);{let l=(u=(a=n.dimensions)==null?void 0:a.call(n))!=null?u:2;if(i.length==2)return r.OrderedPair(i);if(i.length==3&&e.policy.is3dProduct())return r.OrderedTriple(i);throw Ny(l)}}function ML(e,t){let{chunk:r}=e;rn(t.args);let n=pu(e,t.args);if(n.length<2)throw dn(",");let i=r.getInstruction(n[0]).valueType;for(let s=1;s<n.length;s++){let o=r.getInstruction(n[s]).valueType;if(i!==o)throw Bu([te(i),te(o)])}if(i===x)throw n.length===2?Oy():Sy();return i===Ze?fv(e,n):r.List(n)}function fv(e,t){let{chunk:r}=e,n=[],i=[];for(let o of t){let a=r.getInstruction(o);switch(a.type){case 49:{Array.prototype.push.apply(n,a.symbols),Array.prototype.push.apply(i,a.args);break}case 1:{let l=a.value.updateRules;for(let c in l)n.push(c),i.push(r.ConstantOfType(l[c].valueType,l[c].value));break}default:{var s=Xr(r,o);throw s.length>0?fy(s):Ce()}}}return r.Action(n,i)}function dv(e,t){var r=e.frame[t];return r===Gt?Qc(t):e.policy.assignmentForbidden(t)?py(t):r&&r.type==="FunctionDefinition"?Jc(t):cy(t).allowExport()}function EL(e,t){let{policy:r,frame:n,chunk:i,scope:s,parentNode:o,substitutionContext:a,selection:u}=e,l=t._body,c=[],p=i.Constant(1),f=Object.create(n);rn(t._inputLists);for(let{_symbol:I}of t._inputLists)f[I]=Zg(I);let m=xs(s);for(let I=t._inputLists.length-1;I>=0;I--){let O=t._inputLists[I],E=O._symbol,v=be(On(r,f,i,m,o,a,u),O.args[1]),_=i.getInstruction(v);if(!k(_.valueType))throw Yg(E,te(_.valueType));let z=Ur(i,v);c.push({symbol:E,assignedList:v,lengthIndex:z}),p=i.Multiply([p,z])}let d=i.Constant(1),y=i.BeginBroadcast([p],{inputListSymbols:c.map(I=>I.symbol)}),g=xs(s);wn(g,t._index._symbol,y);let h=d;for(let I=c.length-1;I>=0;I--){let{symbol:O,assignedList:E,lengthIndex:v}=c[I],_;if(c.length===1)_=y;else{let R=i.SyntheticNativeFunction("floor",[i.Divide([i.Subtract([y,d]),h])]);_=i.Add([i.SyntheticNativeFunction("mod",[R,v]),d]),I>0&&(h=i.Multiply([h,v]))}let z=Ha(g,O);if(n[O]!==void 0||z!==void 0&&i.getInstruction(z).type!==2)throw Xg(O);wn(g,O,i.ListAccess([E,_]))}let P=Object.create(n);for(let I of c)P[I.symbol]=Gt;let T=be(On(r,P,i,g,o,a,u),l),D=i.getInstruction(T);if(!zn(D.valueType))throw Xo([te(D.valueType)]);let N=i.EndBroadcast([y,T]);return i.BroadcastResult(fn(D.valueType),[N])}function ex(e,t,r,n){let{stepMustBePositive:i}=n,{chunk:s}=e;t=ha(s,t),r=ha(s,r);let o=s.getInstruction(t),a=s.getInstruction(r),u=$i(s,t,"Programming error: expected range start list to have constant length."),l=$i(s,r,"Programming error: expected range start list to have constant length.");if(o.valueType!==Z||a.valueType!==Z)throw $u();let c=s.Constant(1),p=s.Constant(0),f=s.ListAccess([t,c]),m=s.ListAccess([t,s.Constant(2)]),d=s.ListAccess([r,s.Constant(l)]),y=s.Subtract([d,f]),g=u>1?s.Subtract([m,f]):s.Piecewise([s.GreaterEqual([y,p]),c,s.Constant(-1)]),h=s.Add([c,s.SyntheticNativeFunction("round",[s.Divide([y,g])])]),P=s.SyntheticNativeFunction("validateRangeLength",[t,r,g,h]);i&&(P=s.Piecewise([s.GreaterEqual([g,p]),P,p]));let T=s.BeginBroadcast([P]),D=s.Add([f,s.Multiply([g,s.Subtract([T,c])])]),N=s.EndBroadcast([T,D]);return s.addComments({[f]:"start",[m]:"second",[d]:"last",[h]:"proposedLength",[g]:"step",[D]:"body"}),s.BroadcastResult(fn(s.getInstruction(D).valueType),[N])}function id(e,t){return U(e,t,pe)?e.SyntheticNativeFunction("lineFromSegment",[t]):U(e,t,Pe)?e.SyntheticNativeFunction("lineFromRay",[t]):t}function sv(e,t){if(U(e,t,ee)){let{center:r,radius:n}=tx(e,t);return e.SyntheticNativeFunction("circle",[r,n])}return t}function tx(e,t){let r=e.SyntheticNativeFunction("arcCenter",[t]),n=e.SyntheticNativeFunction("arcGlider",[t,e.Constant(0)]),i=e.SyntheticNativeFunction("distance",[r,n]);return{center:r,radius:i,startPoint:n}}function ov(e,t,r,n){let{chunk:i}=e;if(t.length===3&&U(i,t[0],A)&&U(i,t[1],A)&&U(i,t[2],A)){let s=i.Constant(1),o=i.Constant(2),a=t[0],u=t[1],l=t[2],c=i.Subtract([a,u]),p=i.Subtract([l,u]),f=i.OrderedPairAccess([c,s]),m=i.OrderedPairAccess([c,o]),d=i.OrderedPairAccess([p,s]),y=i.OrderedPairAccess([p,o]),g=i.SyntheticNativeFunction("arctan",[m,f]),h=i.Subtract([i.Multiply([f,y]),i.Multiply([m,d])]),P=i.Add([i.Multiply([f,d]),i.Multiply([m,y])]),T=i.SyntheticNativeFunction("arctan",[h,P]),D=i.SyntheticNativeFunction("abs",[T]),N=i.Constant(Math.PI),I=i.Constant(Math.PI*2);return T=i.Piecewise([i.Equal([D,N]),N,i.Piecewise([i.Less([D,N]),T,i.Multiply([i.Multiply([i.SyntheticNativeFunction("sign",[T]),i.Constant(-1)]),i.Subtract([I,D])])])]),i.SyntheticNativeFunction("directedAngleMarker",[u,g,T,be(e,new b.Identifier("trigAngleMultiplier"))])}else throw Vt(r,Tn(i,n))}function UE(e,t){return e.Divide([e.SyntheticNativeFunction("directedAngleMarkerRawDelta",[t]),e.SyntheticNativeFunction("directedAngleMarkerMultiplier",[t])])}function HE(e,t){return e.SyntheticNativeFunction("abs",[e.Divide([e.SyntheticNativeFunction("undirectedAngleMarkerRawDelta",[t]),e.SyntheticNativeFunction("undirectedAngleMarkerMultiplier",[t])])])}function vL(e,t,r){let{chunk:n}=e,i=r.slice(1),s=Nf(t);if(!s)throw new Error(`Unexpected transformation type: ${t}`);if(!s.some(a=>{for(let u=1;u<r.length;u++){let l=n.getInstruction(r[u]).valueType,c=Sf(a,u);if(c===void 0||!db(l,c))return!1}return!0}))throw Wc(t,Tn(n,i),s);let o;switch(t){case"translate":{i.length===1&&U(n,i[0],A)?o=n.SyntheticNativeFunction("translation",i):i.length===2&&U(n,i[0],A)&&U(n,i[1],A)?o=n.SyntheticNativeFunction("translation",[n.Subtract([i[1],i[0]])]):i.length===2&&U(n,i[0],x)&&U(n,i[1],x)&&(o=n.SyntheticNativeFunction("translation",[n.OrderedPair(i)]));break}case"reflect":{let a=id(n,i[0]);U(n,a,ne)&&(o=n.SyntheticNativeFunction("reflection",[a]));break}case"rotate":{if(i.length===2){let a=be(e,new b.Identifier("trigAngleMultiplier"));o=n.SyntheticNativeFunction("rotation",[i[0],n.Multiply([i[1],a])])}break}case"dilate":{i.length===2&&(o=n.SyntheticNativeFunction("dilation",[i[0],i[1]]));break}default:{let a=t;throw new Error(`Programming error: exhaustive check failed: ${a}`)}}if(!o)throw Wc(t,Tn(n,i),s);return sd(n,[o,r[0]],t,!0)}function sd(e,t,r,n){if(t.length===2&&U(e,t[0],Re)){if(U(e,t[1],Re))return e.SyntheticNativeFunction("compose",t);if(U(e,t[1],A))return e.SyntheticNativeFunction("transformPoint",t);if(U(e,t[1],pe))return e.SyntheticNativeFunction("transformSegment",t);if(U(e,t[1],ne))return e.SyntheticNativeFunction("transformLine",t);if(U(e,t[1],Pe))return e.SyntheticNativeFunction("transformRay",t);if(U(e,t[1],ie))return e.SyntheticNativeFunction("transformCircle",t);if(U(e,t[1],ee))return e.SyntheticNativeFunction("transformArc",t);if(U(e,t[1],Te))return e.SyntheticNativeFunction("transformPolygon",t);if(U(e,t[1],de))return e.SyntheticNativeFunction("transformAngleMarker",t);if(U(e,t[1],oe))return e.SyntheticNativeFunction("transformDirectedAngleMarker",t)}throw n?Um(r,hn(e,t.slice(1))):Vt(r,hn(e,t))}function Kb(e,t,r,n){let i=id(e,t[0]),s=id(e,t[1]),o=[i,s,e.ConstantOfType(x,n)];if(U(e,i,ie)){if(U(e,s,ie))return e.SyntheticNativeFunction("circleCircleIntersection",o);if(U(e,s,ee))return e.SyntheticNativeFunction("circleArcIntersection",o);if(U(e,s,ne))return e.SyntheticNativeFunction("circleLineIntersection",o)}if(U(e,i,ee)){if(U(e,s,ie))return e.SyntheticNativeFunction("arcCircleIntersection",o);if(U(e,s,ee))return e.SyntheticNativeFunction("arcArcIntersection",o);if(U(e,s,ne))return e.SyntheticNativeFunction("arcLineIntersection",o)}if(U(e,i,ne)){if(U(e,s,ie))return e.SyntheticNativeFunction("lineCircleIntersection",o);if(U(e,s,ee))return e.SyntheticNativeFunction("lineArcIntersection",o);if(U(e,s,ne))return e.SyntheticNativeFunction("lineLineIntersection",o)}throw Vt(r,hn(e,t))}function OL(e,[t,r],[n,i]){let{chunk:s,frame:o}=e,a=s.getInstruction(n).valueType,u=s.getInstruction(i).valueType,l=f=>{let m=o[f];return m&&m!==Gt?m:MP(e.scope,f)},c=td(t)?l(t._symbol):t,p=td(r)?l(r._symbol):r;if(!(!c||!p))return rv({getGeometryTree:f=>ed(f).tree,lookup:l,getValueType:f=>{let m=be(e,f);return s.getInstruction(m).valueType},resolvesTo:(f,m)=>o[f]===m},c,a,p,u)}function SL(e,t){let{policy:r,frame:n,chunk:i,scope:s,parentNode:o,substitutionContext:a,selection:u}=e,l=t._body,c=xs(s),p=Object.create(n);for(let m=0;m<t._assignments.length;m++){let d=t._assignments[m]._symbol,y=t._assignments[m].args[1],g=n[d];if(g){if(g!==Gt&&g.isError)throw g;if(g!==Gt&&g.type==="FunctionDefinition")throw Ap(d);if(g===Gt)throw Np(d);if(r.assignmentForbidden(d))throw Dp(d)}let h=be(e,y),P=Xr(i,h);for(let T of P)if(T.scope==="free")throw th(P).allowExport();wn(c,d,h,y),p[d]=Gt}return be(On(r,p,i,c,o,ue(X({},a),{body:!0}),u),l)}var av={points:Be,lines:fr,segments:$t,polygons:er,circles:cr,arcs:pr,angles:Lt,directedangles:wt,rays:dr};function NL(e,t){let{chunk:r,frame:n}=e,i=n.construction;if(i.isError)throw i;if(i.type!=="Construction")throw Ce();if(!td(t))throw Ce();let s=t._symbol;if(!(s in av))throw dn("construction");let o=av[s];if(i.args.length===0)return r.ConstantOfType(o,[]);let a=ke(o),u=[];for(let l of i.args)try{let c=be(e,l);r.getInstruction(c).valueType===a&&u.push(c)}catch(c){if(c instanceof b.Base)continue;throw c}return r.List(u)}Ue.prototype.buildIRExpression=function(e,t,r){var i;var n=fu({policy:e,frame:t,wrapInList:r&&r.wrapInList,coerceToNumber:r&&r.coerceToNumber,selection:r&&r.selection},this);return(i=n.getError())!=null?i:new hr(n)};S.prototype.buildIRExpression=function(e,t,r){return this};var mv=Xl;function nx(e){for(var t=[],r=0;r<e.length;r++)t.push(te(e[r].valueType));return t}function yv(e,t){var r=t.length,n=t[0];if(r<2)throw mi(this._symbol);if(!mv(n.valueType,[Z,Me]))throw mi(this._symbol);if(r>2)throw rp(this._symbol,2)}b.Histogram.prototype.typeCheck=yv;b.DotPlot.prototype.typeCheck=yv;b.BoxPlot.prototype.typeCheck=function(e,t){var r=t.length,n=t[0];if(r===0)throw mi(this._symbol);if(!mv(n.valueType,[Z,Me]))throw mi(this._symbol);if(r>1)throw mi(this._symbol)};b.TTest.prototype.typeCheck=function(e,t){var r=this._symbol;if(t.length===0)throw mi(r);if(t[0].valueType===Me)throw ka(r);if(t[0].valueType!==Z)throw mi(r);if(t.length>2)throw rp(r,2);if(t[0].length<2)throw ka(r);if(t[1]&&t[1].valueType!==x)throw Vt(r,nx(t))};b.IndependentTTest.prototype.typeCheck=function(e,t){var r=this._symbol;if(t.length!==2)throw Va(r);if(!k(t[0].valueType)||!k(t[1].valueType))throw Hu(r);if(t[0].valueType===Me||t[1].valueType===Me)throw ka("ittest");if(t[0].valueType!==Z||t[1].valueType!==Z)throw Vt(r,nx(t));if(t[0].length<2||t[1].length<2)throw ka("ittest")},b.Stats.prototype.typeCheck=function(e,t){var r=t.length,n=t[0];if(r===0)throw mi(this._symbol);if(n.valueType===Me)throw Vt(this._symbol,nx(t));if(n.valueType!==Z)throw mi(this._symbol);if(r>1)throw mi(this._symbol)};var ba=function(e,t,r){r=r||0;var n=Array(r+1).join("  "),i=n+"  ";return`[
`+i+e.map(function(s){return s.repr(t,r+1)}).join(`,
`+i)+`
`+n+"]"},Fr=function(e,t){return t=t||"",""+t+e};b.Expression.prototype.repr=function(e,t){return Fr(this.type,e)+"("+ba(this.args,e,t)+")"};b.IRExpression.prototype.repr=function(e,t){t=t||0;var r=Array(t+1).join("  "),n=r+"  ",i=this._chunk.print().split(`
`);return i.pop(),Fr(this.type,e)+"(`\n"+n+i.join(`
`+n)+`
`+r+"`)"};b.DoubleInequality.prototype.repr=function(e,t){t=t||0;var r=Array(t+1).join("  "),n=r+"  ";return Fr(this.type,e)+`([
`+n+this.args[0].repr(e,t+1)+`,
`+n+"'"+this.args[1]+`',
`+n+this.args[2].repr(e,t+1)+`,
`+n+"'"+this.args[3]+`',
`+n+this.args[4].repr(e,t+1)+`
`+r+"])"};b.Identifier.prototype.repr=function(e){return Fr(this.type,e)+"('"+this._symbol+"')"};b.Constant.prototype.repr=function(e){return Fr(this.type,e)+"("+this.asValue()+")"};b.ExtendSeed.prototype.repr=function(e,t){return Fr(this.type,e)+"('"+this.tag+"', "+ba(this.args,e,t)+")"};b.Seed.prototype.repr=function(e){return Fr(this.type,e)+"("+this.asValue()+")"};b.FunctionCall.prototype.repr=function(e,t){return Fr(this.type,e)+"('"+this._symbol+"', "+ba(this.args,e,t)+")"};b.Assignment.prototype.repr=function(e,t){return Fr(this.type,e)+"("+new b.Identifier(this._symbol).repr(e,t)+", "+this._expression.repr(e,t)+")"};b.CoordinateEquation.prototype.repr=function(e,t){return this.asEquation().repr(e,t)};b.Regression.prototype.repr=b.Equation.prototype.repr=function(e,t){return Fr(this.type,e)+"("+this._lhs.repr(e,t)+", "+this._rhs.repr(e,t)+")"};b.FunctionDefinition.prototype.repr=function(e,t){return Fr(this.type,e)+"("+new b.Identifier(this._symbol).repr(e,t)+", "+ba(this._argSymbols.map(function(r){return new b.Identifier(r)}),e,t)+", "+this._expression.repr(e,t)+")"};b.Error.prototype.repr=function(e,t){return Fr(this.type,e)+"('"+this._msg+"')"};b.Derivative.prototype.repr=function(e,t){return Fr(this.type,e)+"('"+this._symbol+"', "+ba(this.args,e,t)+")"};b.SolvedEquation.prototype.repr=function(e,t){return Fr(this.type,e)+"('"+this._symbol+"', "+this._expression.repr(e,t)+")"};b.OptimizedRegression.prototype.repr=function(e,t){return Fr(this.type,e)+"("+JSON.stringify(this.parameters)+", "+JSON.stringify(this.residuals)+", "+JSON.stringify(this.statistics)+", "+this.model.repr(e,t+1)+", "+JSON.stringify({isModelValid:this.isModelValid,residualVariable:this.residualVariable,residualSuggestionId:this.residualSuggestionId,shouldSuggestLogMode:this.shouldSuggestLogMode,isLinear:this.isLinear,parameterWarning:this.parameterWarning})+")"};b.Table.prototype.repr=function(e,t){return Fr(this.type,e)+"("+ba(this.columns,e,t)+")"};b.TableColumn.prototype.repr=function(e,t){return Fr(this.type,e)+"("+this.header.repr(e,t)+", "+this.length+", "+ba(this.values,e,t)+")"};b.Image.prototype.repr=function(e,t){var r=Array(t+1).join("  "),n=r+"  ";return Fr(this.type,e)+`({
`+n+"center: "+this.center.repr(e,t+1)+`,
`+n+"radianAngle: "+this.radianAngle.repr(e,t+1)+`,
`+n+"width: "+this.width.repr(e,t+1)+`,
`+n+"height: "+this.height.repr(e,t+1)+`},
`+n+"opacity: "+this.opacity.repr(e,t+1)+`,
`+n+JSON.stringify(this.moveStrategy)+`
`+r+"})"};b.Ticker.prototype.repr=function(e,t){var r=Array(t+1).join("  "),n=r+"  ";return Fr(this.type,e)+`({
`+n+"handler: "+this.handler.repr(e,t+1)+`,
`+n+"minStep: "+this.minStep.repr(e,t+1)+`
`+r+"})"};b.Slider.prototype.repr=function(e,t){var r=Array(t+1).join("  "),n=r+"  ";return Fr(this.type,e)+`({
`+n+"sliderAssignment: "+this.sliderAssignment.repr(e,t+1)+`,
`+n+"sliderMin: "+(this.sliderMin&&this.sliderMin.repr(e,t+1))+`,
`+n+"sliderMax: "+(this.sliderMax&&this.sliderMax.repr(e,t+1))+`,
`+n+"sliderStep: "+(this.sliderStep&&this.sliderStep.repr(e,t+1))+`},
`+r+")"};var od=function(e,t){return e.map(function(r){return r.substitute(t)})};b.Identifier.prototype.substitute=function(e){return e[this._symbol]?e[this._symbol]:this};b.FunctionCall.prototype.substitute=function(e){var t=e[this._symbol];if(t){if(t.type==="Identifier")return new b.FunctionCall(t,od(this.args,e));if(t.type==="Constant")return new b.Multiply([t,this.args.length===1?this.args[0].substitute(e):new b.Constant(NaN)])}return b.Expression.prototype.substitute.call(this,e)};b.Constant.prototype.substitute=function(e){return this};b.Expression.prototype.substitute=function(e){return this.copyWithArgs(od(this.args,e))};b.Derivative.prototype.substitute=function(e){var t=e[this._symbol];if(t){if(t.type==="Identifier")return new b.Derivative(t,od(this.args,e));throw new Error("Cannot substitute for a derivative variable with a non-Identifier")}return new b.Derivative(this._symbol,od(this.args,e))};b.Expression.prototype.simpleFunctionExpression=function(){return this};b.Assignment.prototype.simpleFunctionExpression=function(){return this._expression};b.CoordinateEquation.prototype.simpleFunctionExpression=function(){return this.asEquation().simpleFunctionExpression()};b.FunctionDefinition.prototype.simpleFunctionExpression=function(){return this._expression};b.Equation.prototype.simpleFunctionExpression=function(){return this.asComparator().simpleFunctionExpression()};function ad(e){return e>=24}var ud={normaldist:{type:"distribution",symbol:"normaldist",params:["mean","stdev"],defaults:["0","1"],discrete:!1},tdist:{type:"distribution",symbol:"tdist",params:["dof"],defaults:[void 0],discrete:!1},binomialdist:{type:"distribution",symbol:"binomialdist",params:["trials","probsuccess"],defaults:[void 0,"0.5"],discrete:!0},poissondist:{type:"distribution",symbol:"poissondist",params:["mean"],defaults:[void 0],discrete:!0},uniformdist:{type:"distribution",symbol:"uniformdist",params:["min","max"],defaults:["0","1"],discrete:!1}},DL={Histogram:{type:"visualization",symbol:"histogram",params:["data","binwidth"],defaults:[void 0,"1"]},DotPlot:{type:"visualization",symbol:"dotplot",params:["data","binwidth"],defaults:[void 0,"1"]},BoxPlot:{type:"visualization",symbol:"boxplot",params:["data"],defaults:[void 0]}};function gv(e){let t=xi(e,{trailingComma:!0});return xo(t)}function xo(e){let t=e,r=DL[t.type];if(!r)switch(t.type==="Assignment"&&(t=t._expression),t.type){case"FunctionCall":{r=ud[t._symbol];break}default:return}if(!r)return;let n={},i=r.params,s=t.args;for(let o=0;o<i.length;o++){let a=s[o];n[i[o]]=a&&a.getInputString()||""}return ue(X({},r),{span:t.getInputSpan(),values:n})}function Ns(e){if(typeof e=="string")return e;if(e===void 0)return"";if(isNaN(e))return"\\frac{0}{0}";if(e===1/0)return"\\infty";if(e===-1/0)return"-\\infty";let t=e+"";return t=t.replace(/^1e\+?([-\d]+)/,"10^{$1}"),t=t.replace(/([-\d\.]+)e\+?([-\d]+)/,"$1\\cdot 10^{$2}"),t}function RL(e){let t=e+"";if(/\d+\.?\d*e[\+\-]*\d+/i.test(t)){let n="0",i=String(t).toLowerCase().split("e"),s=parseFloat(i[0]),o=parseInt(i[1],10),a=Math.abs(o),u=Math.abs(s).toString().split(".");if(o<0)t="0."+new Array(a).join(n)+u.join("");else{var r=u[1];r&&(a=a-r.length),t=u.join("")+new Array(a+1).join(n)}s<0&&(t="-"+t)}return t}function E5(e,t=2){var r=RL(e),n=r.indexOf(".");if(n===-1)return r;for(var i,s=n+1;s<r.length;s++)if(i){if(r[s]!==i)break}else if(r[s]==="0"||r[s]==="9")i=r[s];else break;return r.substr(0,Math.max(n+5,s+t))}function ur(e,t){if(k(e)){let r=[];for(let n=0;n<t.length;n++)r.push(ur(ke(e),t[n]));return`\\left[${r.join(",")}\\right]`}switch(e){case x:return Ns(t);case A:{let[r,n]=t;return`\\left(${Ns(r)},${Ns(n)}\\right)`}case G:{let[r,n,i]=t;return`\\left(${Ns(r)},${Ns(n)},${Ns(i)}\\right)`}case tt:return"\\operatorname{rgb}\\left("+[ur(x,t[0]),ur(x,t[1]),ur(x,t[2])].join(",")+"\\right)";case Te:{let r=[];for(let n of t)r.push(ur(A,n));return"\\operatorname{polygon}\\left("+r.join(",")+"\\right)"}case pe:return"\\operatorname{segment}\\left("+[ur(A,t[0]),ur(A,t[1])].join(",")+"\\right)";case ne:return"\\operatorname{line}\\left("+[ur(A,t[0]),ur(A,t[1])].join(",")+"\\right)";case Pe:return"\\operatorname{ray}\\left("+[ur(A,t[0]),ur(A,t[1])].join(",")+"\\right)";case ie:return"\\operatorname{circle}\\left("+[ur(A,t[0]),ur(x,t[1])].join(",")+"\\right)";case ee:return"\\operatorname{arc}\\left("+[ur(A,t[0]),ur(A,t[1]),ur(A,t[2])].join(",")+"\\right)";case de:return"\\operatorname{angle}\\left("+[ur(A,t[0]),ur(x,t[1]),ur(x,t[2])].join(",")+"\\right)";case oe:return"\\operatorname{directedangle}\\left("+[ur(A,t[0]),ur(x,t[1]),ur(x,t[2])].join(",")+"\\right)";default:throw new Error("Cannot serialize a value of type "+te(e)+".")}}function ix(e){let t={};for(let r in e.updateRules)t[r]=sx(e,r);return t}function sx(e,t){let{valueType:r,value:n}=e.updateRules[t];return`${vr(t)}=${ur(r,n)}`}var du=class{constructor({enableGeometry:t,enable3d:r,beta3d:n,scales:i}){this._isGeometry=!1;this._is3dProduct=!1;this._isBeta3d=!1;this._isGeometry=t,this._is3dProduct=r,this._isBeta3d=n,this._scales=i}isGeometryEnabled(){return this._isGeometry}is3dProduct(){return this._is3dProduct}isBeta3d(){return this._isBeta3d}areAllScalesLinear(){return this._scales?this._scales.xAxisScale==="linear"&&this._scales.yAxisScale==="linear":!0}dimensions(){return 2}assignmentForbidden(t){return t==="x"||t==="y"||t==="theta"||this.substitutionForbidden(t)}substitutionForbidden(t){return t==="index"||t==="dt"||t.slice(0,3)==="tmp"||Se.hasOwnProperty(t)}isValidSlider(t){return t==="x"||t==="y"?!0:!(t.slice(0,3)==="ans"||t.slice(0,6)==="idref_"||this.assignmentForbidden(t))}sliderVariables(t){return t.indexOf("theta")!==-1&&(t=t.filter(function(r){return r!=="r"})),t.filter(r=>!(this.assignmentForbidden(r)||r.slice(0,3)==="ans"||r.slice(0,6)==="idref_"||r[0]==="_"))}graphingEnabled(){return!0}ansEnabled(){return!1}dimensionVarsEnabled(){return!0}validRegressionParameter(t){return t!=="x"&&t!=="y"}validLHS(t){return t!=="theta"&&t.slice(0,6)!=="idref_"}unplottablePolarFunction(t,r){return t!=="theta"?!1:r.indexOf("r")!==-1}validDoubleInequalitySymbol(t){return t==="x"||t==="y"}validDoubleInequalityVariables(t){return t.length>2?!1:t.every(this.validDoubleInequalitySymbol)}validExpressionVariables(t){return t.length===1&&t[0]==="x"}validSolvedVariable(t){return t==="x"||t==="y"||t==="r"}validImplicitVariables(t){switch(t.length){case 0:return!0;case 1:return t[0]==="x"||t[0]==="y"||t[0]==="r";case 2:return t[0]==="x"&&t[1]==="y"||t[0]==="y"&&t[1]==="x"||t[0]==="r"&&t[1]==="theta"||t[0]==="theta"&&t[1]==="r";default:return!1}}graphableListVariables(t,r){return t==="x"||t==="y"||t==="r"||r==="x"||r==="y"}validParametricVariable(t){return t==="t"}validParametricVariables(t){return t.length===1&&this.validParametricVariable(t[0])}validInequalityVariables(t){switch(t.length){case 1:return t[0]==="x"||t[0]==="y"||t[0]==="r";case 2:return this.validImplicitVariables(t);default:return!1}}validFirstColumnVariable(t){return t!=="y"&&t!=="r"&&t!=="theta"&&!t.match(/y_(\d+)/)}validActionVariable(t){return t==="dt"||t==="index"}validCoordinateEquationSymbol(t){return!1}complicatedPolarImplicit(t,r){return t==="theta"||t==="r"&&r!==1}constantGraphMode(t,r){return t==="x"?1:t==="r"?6:2}graphMode(t,r,n){let i=r[0];return i==="y"?1:t==="x"?1:t==="r"&&i==="theta"?6:2}tableableAsConstant(t){return!(t==="x"||t==="r"||t==="theta")}implicitIndependent(t){return"x"}implicitDependency(t){return t.length!==1?"y":t[0]==="y"?"x":t[0]==="theta"?"r":"y"}graphableAsConstant(t){return t==="y"||t==="x"||t==="r"}disabledFeatures(){return[]}};function ji(){return new du({enableGeometry:!1,enable3d:!0,beta3d:!1,scales:{xAxisScale:"linear",yAxisScale:"linear"}})}var mu=class{constructor(t){this._isBeta3d=!1;this._isBeta3d=t}isGeometryEnabled(){return!1}is3dProduct(){return!0}isBeta3d(){return this._isBeta3d}areAllScalesLinear(){return!0}dimensions(){return 3}graphingEnabled(){return!0}ansEnabled(){return!1}dimensionVarsEnabled(){return!0}substitutionForbidden(t){return ji().substitutionForbidden(t)}validInequalityVariables(t){return ji().validInequalityVariables(t)}validFirstColumnVariable(t){return ji().validFirstColumnVariable(t)}validActionVariable(t){return ji().validActionVariable(t)}tableableAsConstant(t){return ji().tableableAsConstant(t)}implicitIndependent(t){return ji().implicitIndependent(t)}validRegressionParameter(t){return ji().validRegressionParameter(t)}assignmentForbidden(t){return t==="x"||t==="y"||t==="z"||t==="r"||t==="theta"||t==="phi"||this.substitutionForbidden(t)}sliderVariables(t){return t.filter(r=>!(this.assignmentForbidden(r)||r.slice(0,3)==="ans"||r.slice(0,6)==="idref_"||r[0]==="_"))}isValidSlider(t){return t==="x"||t==="y"||t==="z"?!0:!(t.slice(0,3)==="ans"||t.slice(0,6)==="idref_"||this.assignmentForbidden(t))}validLHS(t){return t!=="phi"&&ji().validLHS(t)}unplottablePolarFunction(t,r){return!1}complicatedPolarImplicit(t,r){return!1}validDoubleInequalitySymbol(t){return!1}validDoubleInequalityVariables(t){return!1}validExpressionVariables(t){return t.every(r=>r==="x"||r==="y")}validSolvedVariable(t){return hv(t)}validImplicitVariables(t){return t.every(hv)}graphableListVariables(t,r){return t==="x"||t==="y"||r==="x"||r==="y"}validParametricVariable(t){return t==="t"||t==="u"||t==="v"}validParametricVariables(t){return t.length===1&&this.validParametricVariable(t[0])||t.length===2&&t.every(ox)}validCoordinateEquationSymbol(t){return this.isBeta3d()?t==="rthetaphi"||t==="rthetaz":!1}constantGraphMode(t,r){var n;switch(t){case"x":return 43;case"y":return 44;case"r":let i=(n=r==null?void 0:r.polarCoordinateSystem)!=null?n:"";return i==="Cylindrical"?45:i==="Spherical"?46:46;case"rthetaz":return this.isBeta3d()?38:10;case"rthetaphi":return this.isBeta3d()?39:10;default:return 30}}graphMode(t,r,n){var s,o;let i=()=>ji().graphMode(t,r,n);if(r.length===0)switch(t){case"z":return 30;case"y":return 44;case"x":return 43;case"r":let a=(s=n==null?void 0:n.polarCoordinateSystem)!=null?s:"";return a==="Cylindrical"?45:a==="Spherical"?46:46;case"rthetaz":return this.isBeta3d()?38:10;case"rthetaphi":return this.isBeta3d()?39:10;default:return i()}switch(t){case"z":return r.every(a=>a=="x"||a=="y")?30:r.every(a=>a=="r"||a=="theta")?33:i();case"y":return r.every(a=>a=="x")?44:r.every(a=>a=="x"||a=="z")?32:i();case"x":return r.every(a=>a=="y")?43:r.every(a=>a=="y"||a=="z")?31:i();case"r":if(r.every(a=>a=="theta")){let a=(o=n==null?void 0:n.polarCoordinateSystem)!=null?o:"";return a==="Cylindrical"?45:a==="Spherical"?46:45}return r.every(a=>a=="theta"||a=="z")?34:r.every(a=>a=="theta"||a=="phi")?35:i();case"rthetaz":return this.isBeta3d()?r.length===1&&r[0]==="t"?25:r.every(ox)?28:10:10;case"rthetaphi":return this.isBeta3d()?r.length===1&&r[0]==="t"?26:r.every(ox)?29:10:10;default:return i()}}implicitDependency(t){if(t.length!==2)return"z";let r=t[0]<t[1]?t[0]+t[1]:t[1]+t[0];return r==="xy"?"z":r==="xz"?"y":r==="yz"?"x":"z"}graphableAsConstant(t){return t==="z"||(t==="rthetaz"||t==="rthetaphi")&&this.isBeta3d()||ji().graphableAsConstant(t)}disabledFeatures(){return[]}policy2d(){return ji()}},hv=e=>e==="x"||e==="y"||e==="z",ox=e=>e==="u"||e==="v";function CL(e){return e.isError?e.getError():e.asValue()===void 0?"":+e.asValue()}function LL(e,t,r){let n=[];for(var i=0;i<t.columns.length;i++){let s=r.columns[i],o=s.isError?[]:s.values.map(CL),a={dependent:!s.isIndependent,discrete:!!s.isIndependent,values:o};s.isError&&(a.error=s.getError()),n.push(a)}return{column_data:n}}function wL(e,t,r){let n={variables:[],errorMap:{},dimensions:{}};if(e.areAllScalesLinear()||(n.errorMap.scale=!0),r.center.isError&&(n.errorMap.center=!0),r.radianAngle.isError&&(n.errorMap.angle=!0),r.width.isError&&(n.errorMap.width=!0),r.height.isError&&(n.errorMap.height=!0),r.opacity.isError&&(n.errorMap.opacity=!0),Object.keys(n.errorMap).length>0)return n.variables=t.getSliderVariables(e,r),n;n.dimensions.x=[],n.dimensions.y=[],n.dimensions.radianAngle=[],n.dimensions.width=[],n.dimensions.height=[],n.dimensions.opacity=[];let i=[r.center,r.radianAngle,r.width,r.height,r.opacity];return i.some(o=>o&&o.valueType&&k(o.valueType))&&(n.is_concrete_list=!0),b.List.eachArgs(i,function(o){let a=o[0].asValue(),u=+o[1].asValue(),l=Math.atan2(Math.sin(u),Math.cos(u));n.dimensions.x.push(+a[0]),n.dimensions.y.push(+a[1]),n.dimensions.radianAngle.push(l),n.dimensions.width.push(+o[2].asValue()),n.dimensions.height.push(+o[3].asValue()),n.dimensions.opacity.push(Math.max(0,Math.min(1,+o[4].asValue())))}),(e.graphingEnabled()?t.getGraphMode(e,r):10)!==10&&(n.is_graphable=!0),r.moveStrategy&&(n.move_strategy=r.moveStrategy),t.center&&(t.center.type==="Identifier"?(n.center_reference_id=t.center.referencedStatementId,n.center_reference_symbol=t.center._symbol):t.center.type==="ParenSeq"&&r.center.valueType===A&&(n.center_is_point_literal=!0)),n}function _L(e,t,r){let n=r.handler,i=r.minStep,s={},o={};for(let p of n.getDependencies())e.validActionVariable(p)||(s[p]=!0);for(let p of i.getDependencies())o[p]=!0;let a;if(Zi(i))a={status:"error",error:i.getError()};else{let p=i.asValue();typeof p=="number"&&!isNaN(p)&&p>=0?a={status:"valid",value:p}:a={status:"error",error:ng().getError()}}let u=Object.keys(s);u.length>0&&(n=Ct(u).setDependencies(n.getDependencies()));let l;n.isError&&!ux(e,n)?l={status:"error",error:n.getError()}:n.isEmptyAction?l={status:"empty"}:l={status:"maybe-valid"};let c={handler:l,minStep:a,variables:[]};return To(c,e,X(X({},s),o)),c}function FL(){return{operator:"=",variables:[]}}function bv(e,t,r,n){var l;if(Pi(r))return LL(e,r,n);if(rd(r))return wL(e,r,n);if(r instanceof b.Ticker)return _L(e,r,n);let i=FL();if(e.is3dProduct()&&(i.graphMode3d=r.getGraphMode(new mu(e.isBeta3d()),n)),(i.graphMode3d===24||i.graphMode3d===25||i.graphMode3d===26)&&n.getDependencies().length===1){let c=n.getDependencies()[0];(c==="t"||c==="u"||c==="v")&&(i.dependency=c)}if((l=r.parseOptions)!=null&&l.selection){let c=n.getCursorContext();if(c)i.cursor_context=ue(X({},c),{selection:r.parseOptions.selection});else if(Zi(n)){let p=VL(e,t,r);p&&(i.cursor_context=ue(X({},p),{selection:r.parseOptions.selection}))}}if(n.isError&&!(r instanceof b.FunctionDefinition&&!n.blocksExport)){i.error=n.getError(),i.variables=r.getSliderVariables(e,n),i.is_single_identifier=r instanceof b.Identifier,n.actionValue&&(i.action_value=ix(n.actionValue));let c=ax(e,t,r,n);return Object.keys(c).length>0&&(i.geometry=ax(e,t,r,n)),i}if(n.valueType===tt&&n.getDependencies().length===0){let c=n.asValue();i.rgb_value=oa(c[0],c[1],c[2]).formatHex()}n.valueType===Ze&&n.getDependencies().length===0&&(i.action_value=ix(n.asValue())),n.moveStrategy&&(i.move_strategy=n.moveStrategy,i.default_drag_mode=n.defaultDragMode),r.isInequality()&&(i.is_inequality=!0),i.operator=r.getOperator(),n instanceof b.SolvedEquation?n._expression.asValue()!==!0&&n._expression.asValue()!==!1&&(i.assignment=n._symbol):r instanceof b.Assignment&&(i.assignment=r._symbol);let s=e.graphingEnabled()?r.getGraphMode(e,n):10;if(s!==10){i.is_graphable=!0,i.expression_type=r.getExpressionType(s,n.valueType),n.isShadeBetween()&&(i.is_shade_between=!0);let c=r.tableInfo(e,n);c&&(i.is_tableable=!0,i.table_info=c)}if(n.valueType!==void 0&&k(n.valueType)&&(i.is_concrete_list=!0,n.valueType===Tr&&n.getDependencies().length===0)){let c=n.asValue();c&&(i.rgb_value=c.map(p=>oa(p[0],p[1],p[2]).formatHex()))}if(i.variables=i.is_graphable?[]:r.getSliderVariables(e,n),i.is_single_identifier=r instanceof b.Identifier,n.isTypedConstant){let c=n.asTypedValue();i.typed_constant_value=c,(c.valueType===x||c.valueType===Ie)&&(i.constant_value=c.value),BL(c.valueType)&&(i.geometry=ax(e,t,r,n))}let o=n.getEvaluationInfo();if(o&&i.operator==="="&&!r.isConstant&&!r.isFunction&&n.valueType!==Ie&&n.valueType!==Ir&&!(r instanceof b.Equation)&&!(r instanceof b.And)&&(i.is_evaluable=!0,i.zero_values=o),n instanceof b.OptimizedRegression){let c=n,p={};for(var a in c.parameters)c.parameters.hasOwnProperty(a)&&(p[vr(a)]=+c.parameters[a].asValue());i.is_regression=!0,i.regression={parameters:p,residualVariable:vr(c.residualVariable),residualSuggestionId:c.residualSuggestionId,shouldSuggestLogMode:c.shouldSuggestLogMode,isLinear:c.isLinear,statistics:c.statistics,parameterWarning:c.parameterWarning}}let u=xo(r);return u&&u.discrete&&(i.is_discrete_distribution=!0),i}function BL(e){switch(e){case A:case Be:case ne:case fr:case pe:case $t:case Pe:case dr:case ie:case cr:case ee:case pr:case Te:case er:case de:case Lt:case oe:case wt:case Re:case Vr:return!0;default:return!1}}function ax(e,t,r,n){let i={};n.valueType!==void 0&&(i.valueType=n.valueType);let{identifier:s,listAccess:o,assignmentRhsReference:a,tree:u}=ed(r);if(s&&(i.identifier=s),o&&(i.listAccess=o),a&&(i.assignmentRhsReference=a),u&&(i.call=u,n.valueType&&fe(n.valueType,Re)&&r instanceof ks)){let c=r._expression;i.transformation_preview_info={type:u.symbol,args:c.args.slice(1).map(p=>p.tryGetConcreteTree(e,t).asTypedValue())}}let l=n.moveStrategy&&n.moveStrategy[0];return l&&"initialValue"in l&&l.initialValue!==void 0&&(i.gliderParameter=l.initialValue),i}function VL(e,t,r){let n=r.parseOptions;if(!(n!=null&&n.selection))return;let{start:i,end:s,input:o}=n.selection;if(o.trim()==="")return{type:"empty",allowedTypes:[ft]};let a="\\cursor",u=o.slice(0,i)+a+" "+o.slice(s),l={input:u,start:i,end:i+a.length},c=xi(u,ue(X({},r.parseOptions),{selection:l}));return c.isError?void 0:fu({policy:e,frame:t,selection:l},c).getCursorContext()}function To(e,t,r){let n=e.variables;if(n&&n.length){let i={};for(let s of n)i[s]=!0;for(let s in r)i[s]=!0;r=i}e.variables=t.sliderVariables(Object.keys(r))}function ux(e,t){if(t.blocksExport)return!1;let r=t.getDependencies();if(r.length===0)return!1;for(let n of r)if(!e.validActionVariable(n))return!1;return!0}var Vn={pointsOfInterest:!0,plotSingleVariableImplicitEquations:!0,plotImplicits:!0,plotInequalities:!0,sliders:!0};var B=class{constructor(t,r,n,i){this.policy=t,this.rawTree=n,this.concreteTree=i,this.evaluationState=bv(t,r,n,i)}exportTo(t,r){this.rawTree.exportTo(t,this.concreteTree,r)}graph(t,r){return this.rawTree.tryGraph(this.policy,this.concreteTree,t,r)}getGraphMode(){return this.rawTree.getGraphMode(this.policy,this.concreteTree)}getGraphInfo(){return this.rawTree.getGraphInfo(this.policy,this.concreteTree)}shouldIntersect(){if(!this.evaluationState.is_graphable||!this.rawTree.userData.shouldGraph||!Vn.pointsOfInterest)return!1;var t=this.getGraphMode();return t===1||t===2}};var GL={X_OR_Y:{points:!1,lines:!0,fill:!1,surfaces:!1},SINGLE_POINT:{points:!0,lines:!1,fill:!1,surfaces:!1},POINT_LIST:{points:!0,lines:!1,fill:!1,surfaces:!1},PARAMETRIC:{points:!1,lines:!0,fill:!1,surfaces:!1},POLAR:{points:!1,lines:!0,fill:!1,surfaces:!1},IMPLICIT:{points:!1,lines:!0,fill:!1,surfaces:!1},POLYGON:{points:!1,lines:!0,fill:!0,surfaces:!1},HISTOGRAM:{points:!1,lines:!0,fill:!0,surfaces:!1},DOTPLOT:{points:!0,lines:!1,fill:!1,surfaces:!1},BOXPLOT:{points:!1,lines:!0,fill:!1,surfaces:!1},TTEST:{points:!1,lines:!1,fill:!1,surfaces:!1},STATS:{points:!1,lines:!1,fill:!1,surfaces:!1},POINT3D:{points:!0,lines:!1,fill:!1,surfaces:!1},CURVE3D_xyz_t:{points:!1,lines:!0,fill:!1,surfaces:!1},SURFACE_xyz_uv:{points:!1,lines:!1,fill:!1,surfaces:!0},SURFACE_z_r\u03B8:{points:!1,lines:!1,fill:!1,surfaces:!0},SURFACE_r_\u03B8z:{points:!1,lines:!1,fill:!1,surfaces:!0},SURFACE_r_\u03B8\u03C6:{points:!1,lines:!1,fill:!1,surfaces:!0},SURFACE_r_\u03B8z_AMBIGUOUS:{points:!1,lines:!0,fill:!1,surfaces:!0},SURFACE_r_\u03B8\u03C6_AMBIGUOUS:{points:!1,lines:!0,fill:!1,surfaces:!0},SURFACE:{points:!1,lines:!1,fill:!1,surfaces:!0},SURFACE_AMBIGUOUS:{points:!1,lines:!0,fill:!0,surfaces:!0},IMPLICIT_SURFACE:{points:!1,lines:!1,fill:!1,surfaces:!0},IMPLICIT_SURFACE_AMBIGUOUS:{points:!1,lines:!0,fill:!1,surfaces:!0}};function xv(e,t){var n,i,s,o,a,u,l,c;if(e===void 0)return{points:!1,lines:!1,fill:!1,surfaces:!1};let r=GL[e];switch(e){case"SINGLE_POINT":return{points:!0,lines:!1,fill:!1,surfaces:!1};case"POINT_LIST":case"DOTPLOT":return{points:(n=t.points)!=null?n:r.points,lines:(i=t.lines)!=null?i:r.lines,fill:!1,surfaces:!1};case"POINT3D":return{points:(s=t.points)!=null?s:r.points,lines:!1,fill:!1,surfaces:!1};case"PARAMETRIC":case"POLYGON":case"X_OR_Y":case"POLAR":case"IMPLICIT":case"HISTOGRAM":case"BOXPLOT":case"TTEST":case"STATS":case"CURVE3D_xyz_t":return{points:!1,lines:(o=t.lines)!=null?o:r.lines,fill:(a=t.fill)!=null?a:r.fill,surfaces:(u=t.surfaces)!=null?u:r.surfaces};case"SURFACE":case"SURFACE_AMBIGUOUS":case"SURFACE_r_\u03B8z":case"SURFACE_r_\u03B8z_AMBIGUOUS":case"SURFACE_z_r\u03B8":case"SURFACE_r_\u03B8\u03C6":case"SURFACE_r_\u03B8\u03C6_AMBIGUOUS":case"SURFACE_xyz_uv":case"IMPLICIT_SURFACE":case"IMPLICIT_SURFACE_AMBIGUOUS":return{points:!1,lines:(l=t.lines)!=null?l:r.lines,fill:!1,surfaces:(c=t.surfaces)!=null?c:r.surfaces};default:return e}}function Tv(e){if(e===void 0)return!1;switch(e){case"SINGLE_POINT":case"POINT_LIST":case"PARAMETRIC":case"POLYGON":case"X_OR_Y":case"POLAR":case"SURFACE":case"SURFACE_AMBIGUOUS":case"SURFACE_r_\u03B8z":case"SURFACE_r_\u03B8z_AMBIGUOUS":case"SURFACE_z_r\u03B8":case"SURFACE_r_\u03B8\u03C6":case"SURFACE_r_\u03B8\u03C6_AMBIGUOUS":case"SURFACE_xyz_uv":case"IMPLICIT_SURFACE":case"IMPLICIT_SURFACE_AMBIGUOUS":case"CURVE3D_xyz_t":case"IMPLICIT":case"POINT3D":return!0;case"HISTOGRAM":case"BOXPLOT":case"DOTPLOT":case"TTEST":case"STATS":return!1;default:return e}}function Pv(e,t){let{mappedArgIndex:r,mappedReturnIndex:n,solutionIndex:i}=t,s=[],o=nu(e,r),a=qL(e,o,n),u=i,l=e.NanOfType(e.getReturnType());for(let c=0;c<n;c++){let p=e.getInstruction(c);if(c===r){s.push(i);continue}if(!o[c]&&!e.isInClosedBlock(c)){s.push(c);continue}if(me(p))s.push(e.copyInstruction(p));else{let f=zL(s,p.args);s.push(e.copyInstructionWithArgs(p,f)),p.type===33&&a[c]&&(u=e.Piecewise([f[0],u,l]))}}return u}function zL(e,t){let r=[];for(let n of t)r.push(e[n]);return r}function qL(e,t,r){let n=[];for(let i=0;i<r;i++)n.push(!1);n[r]=t[r];for(let i=r;i>=0;i--){if(!n[i]||!t[i])continue;let s=e.getInstruction(i);if(s.type===33)n[s.args[1]]=!0;else if(!me(s))for(let o of s.args)n[o]=!0}return n}function Iv(e,t){try{return kL(e,t)}catch(r){return r instanceof b.Base?r:Ce()}}function kL({policy:e,frame:t},r){let n=uu(t,r),i=[];for(let D=0;D<n.length;D++)i.push(x);let s=rx({policy:e,frame:t,argNames:n,argTypes:i,selection:void 0}),{chunk:o}=s,a=be(s,r.args[0]),u=be(s,r.args[1]),l=r.getOperator(),c=l!=="=";switch(l){case"<":o.Less([a,u]);break;case">":o.Greater([a,u]);break;case"<=":o.LessEqual([a,u]);break;case">=":o.GreaterEqual([a,u]);break;case"=":o.Equal([a,u]);break}if(o.setReturnIndex(Nr(o,o.getReturnIndex())),o.isConstant())return new hr(o.close());let f=o.getInstruction(a).type!==2||uu(t,r.args[1]).indexOf(o.argNames[a])!==-1;if(!Vn.plotImplicits&&f)throw hg();en[l].direction===-1?o.Subtract([u,a]):o.Subtract([a,u]),o.close();let m=o.getLiveArgNames();if(m.length===0)throw Ce();if(m.length===1&&!c&&!Vn.plotSingleVariableImplicitEquations)return gg();if(m.length>e.dimensions())return Ct(e.sliderVariables(m)).setDependencies(m);if(c&&!e.validInequalityVariables(m))return yg().setDependencies(m);let{localFrames:d,effectiveOrder:y,variableOfInterest:g}=UL(s,c);if(e.complicatedPolarImplicit(g,y))return bg().setDependencies(m);if(!e.validImplicitVariables(m))return Qo();if(y>2||e.dimensions()==3)return new hr(o.close());let h=[],P=[],T=1;for(let D=0;D<d.length;D++){let N=d[D],I=HL(N,c);T=I.length;for(let E of I){let v=N.chunk.copy();if(v.setReturnIndex(E),N.isRestrictedPolynomial){let{mappedArgIndex:_,mappedReturnIndex:z}=N;v.setReturnIndex(Pv(v,{mappedArgIndex:_,mappedReturnIndex:z,solutionIndex:v.getReturnIndex()}))}v.close(),h.push(new hr(v))}let O=!1;for(let E of N.coefficients){let v=N.chunk.getInstruction(E);v.type===1&&v.value!==0&&(O=!0)}if(o.argNames.length!==2||O)P.push(void 0);else{let E=N.chunk.copy(),v=N.coefficients.slice();E.List(v),E.close();let _=k(o.getReturnType())?o.elementAt(D):o.copy(),R=_.argNames.indexOf(g)===0?1:0,H=_.getReturnIndex();_.Add([R,_.Multiply([_.Constant(0),H])]),P.push({coefficients:E,restriction:_})}}return new b.SolvedEquation(g,new b.List(h),P,T)}function UL(e,t){let r=e.chunk,n=e.policy,i=r.argNames,s=k(r.getReturnType()),o=[];e:for(let a=0;a<i.length;a++){let u=i[a],l=i.length>1&&!n.validSolvedVariable(u);o[a]={localFrames:[],effectiveOrder:0,variableOfInterest:u};let c=!t;if(l){o[a].effectiveOrder=1/0;continue}let p=s?r.getConstantListLength():1;if(p==null)throw new Error("Programming error: cannot solve a variable-length list expression");for(let f=0;f<p;f++){let m=s?r.elementAt(f):r;if(m.polynomialOrder(u,{allowRestriction:c,allowClosedBlockReferences:!1})>2){o[a].effectiveOrder=1/0;continue e}let y=m.getPolynomialCoefficients(u);o[a].localFrames.push(y),o[a].effectiveOrder=Math.max(o[a].effectiveOrder,y.coefficients.length-1)}}return i.length===1?o[0]:(i[0]==="y"&&(o=[o[1],o[0]]),o[0].effectiveOrder===0?o[1]:o[1].effectiveOrder===0?o[0]:o[o[0].effectiveOrder<o[1].effectiveOrder?0:1])}function HL(e,t){return t?YL(e):$L(e)}function $L({chunk:e,coefficients:t}){let[r,n,i]=t,s=e.Constant(he(0,1)),o=e.Constant(NaN);if(i===void 0){n===void 0&&(n=s);let a=e.Negative([e.Divide([r,n])]),u=e.Equal([n,s]);return[e.Piecewise([u,o,a])]}else{let a=e.Constant(he(2,1)),u=e.Multiply([a,i]),l=e.Negative([n]),c=e.Subtract([e.Multiply([n,n]),e.Multiply([a,e.Multiply([u,r])])]),p=e.Equal([i,s]),f=e.getInstruction(c);if(f.type===1&&V(f.value)===0)return[e.Piecewise([p,o,e.Divide([l,u])])];{let m=e.SyntheticNativeFunction("sqrt",[c]),d=e.Less([n,s]),y=e.Greater([n,s]),g=e.Divide([e.Add([l,m]),u]),h=e.Divide([e.Subtract([l,m]),u]),P=e.Negative([e.Divide([r,n])]);return[e.Piecewise([p,e.Piecewise([d,P,o]),h]),e.Piecewise([p,e.Piecewise([y,P,o]),g])]}}}function YL({chunk:e,coefficients:t}){let[r,n,i]=t,s=e.Constant(he(0,1));i===void 0&&(i=s),n===void 0&&(n=s),r===void 0&&(r=s);let o=e.Constant(he(2,1)),a=e.Constant(NaN),u=e.Constant(he(1e305,1)),l=e.Negative([u]),c=e.Multiply([o,i]),p=e.Negative([n]),f=e.Subtract([e.Multiply([n,n]),e.Multiply([o,e.Multiply([c,r])])]),m=e.SyntheticNativeFunction("sqrt",[f]),d=e.Divide([e.Add([p,m]),c]),y=e.Divide([e.Subtract([p,m]),c]),g=e.Negative([e.Divide([r,n])]),h=e.Equal([i,s]),P=e.Greater([i,s]),T=e.Equal([n,s]),D=e.Greater([n,s]),N=e.Less([n,s]),I=e.Greater([r,s]),O=e.Less([f,s]);return[e.Piecewise([h,e.Piecewise([N,g,a]),e.Piecewise([P,y,a])]),e.Piecewise([h,e.Piecewise([T,e.Piecewise([I,l,a]),a]),e.Piecewise([P,e.Piecewise([O,l,a]),d])]),e.Piecewise([h,e.Piecewise([T,e.Piecewise([I,u,a]),a]),e.Piecewise([P,e.Piecewise([O,u,a]),y])]),e.Piecewise([h,e.Piecewise([D,g,a]),e.Piecewise([P,d,a])])]}var L=function(){};L.version="1.2.6";L._myIndexOf=function(t){var r=this.length,n;for(n=0;n<r;++n)if(this[n]===t)return n;return-1};L.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:L._myIndexOf;L.precision=4;L.largeArray=50;L.compile=function(){var e=Array.prototype.slice.call(arguments),t=e.pop();return t="return function ("+e.join(",")+") {"+t+"}",new Function(["numeric"],t)(L)};L._dim=function(t){for(var r=[];typeof t=="object";)r.push(t.length),t=t[0];return r};L.dim=function(t){var r,n;return typeof t=="object"?(r=t[0],typeof r=="object"?(n=r[0],typeof n=="object"?L._dim(t):[t.length,r.length]):[t.length]):[]};L.mapreduce=function(t,r){return L.compile("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+r+`;
if(typeof x === "number") { var xi = x; `+t+`; return accum; }
if(typeof _s === "undefined") _s = numeric.dim(x);
if(typeof _k === "undefined") _k = 0;
var _n = _s[_k];
var i,xi;
if(_k < _s.length-1) {
    for(i=_n-1;i>=0;i--) {
        accum = arguments.callee(x[i],accum,_s,_k+1);
    }    return accum;
}
for(i=_n-1;i>=1;i-=2) { 
    xi = x[i];
    `+t+`;
    xi = x[i-1];
    `+t+`;
}
if(i === 0) {
    xi = x[i];
    `+t+`
}
return accum;`)};L.mapreduce2=function(t,r){return L.compile("x",`var n = x.length;
var i,xi;
`+r+`
for(i=n-1;i!==-1;--i) { 
    xi = x[i];
    `+t+`
}
return accum;`)};L.rep=function(t,r,n){typeof n=="undefined"&&(n=0);var i=t[n],s=Array(i),o;if(n===t.length-1){for(o=i-2;o>=0;o-=2)s[o+1]=r,s[o]=r;return o===-1&&(s[0]=r),s}for(o=i-1;o>=0;o--)s[o]=L.rep(t,r,n+1);return s};L.dotMMsmall=function(t,r){var n,i,s,o,a,u,l,c,p,f,m,d,y,g;for(o=t.length,a=r.length,u=r[0].length,l=Array(o),n=o-1;n>=0;n--){for(c=Array(u),p=t[n],s=u-1;s>=0;s--){for(f=p[a-1]*r[a-1][s],i=a-2;i>=1;i-=2)m=i-1,f+=p[i]*r[i][s]+p[m]*r[m][s];i===0&&(f+=p[0]*r[0][s]),c[s]=f}l[n]=c}return l};L._getCol=function(t,r,n){var i=t.length,s;for(s=i-1;s>0;--s)n[s]=t[s][r],--s,n[s]=t[s][r];s===0&&(n[0]=t[0][r])};L.dotMMbig=function(t,r){var n=L._getCol,i=r.length,s=Array(i),o=t.length,a=r[0].length,u=new Array(o),l,c=L.dotVV,p,f,m,d;for(--i,--o,p=o;p!==-1;--p)u[p]=Array(a);for(--a,p=a;p!==-1;--p)for(n(r,p,s),f=o;f!==-1;--f)d=0,l=t[f],u[f][p]=c(l,s);return u};L.dotMV=function(t,r){var n=t.length,i=r.length,s,o=Array(n),a=L.dotVV;for(s=n-1;s>=0;s--)o[s]=a(t[s],r);return o};L.dotVM=function(t,r){var n,i,s,o,a,u,l,c,p,f,m,d,y,g,h,P,T,D,N;for(o=t.length,a=r[0].length,l=Array(a),s=a-1;s>=0;s--){for(f=t[o-1]*r[o-1][s],i=o-2;i>=1;i-=2)m=i-1,f+=t[i]*r[i][s]+t[m]*r[m][s];i===0&&(f+=t[0]*r[0][s]),l[s]=f}return l};L.dotVV=function(t,r){var n,i=t.length,s,o=t[i-1]*r[i-1];for(n=i-2;n>=1;n-=2)s=n-1,o+=t[n]*r[n]+t[s]*r[s];return n===0&&(o+=t[0]*r[0]),o};L.dot=function(t,r){var n=L.dim;switch(n(t).length*1e3+n(r).length){case 2002:return r.length<10?L.dotMMsmall(t,r):L.dotMMbig(t,r);case 2001:return L.dotMV(t,r);case 1002:return L.dotVM(t,r);case 1001:return L.dotVV(t,r);case 1e3:return L.mulVS(t,r);case 1:return L.mulSV(t,r);case 0:return t*r;default:throw new Error("numeric.dot only works on vectors and matrices")}};L.diag=function(t){var r,n,i,s=t.length,o=Array(s),a;for(r=s-1;r>=0;r--){for(a=Array(s),n=r+2,i=s-1;i>=n;i-=2)a[i]=0,a[i-1]=0;for(i>r&&(a[i]=0),a[r]=t[r],i=r-1;i>=1;i-=2)a[i]=0,a[i-1]=0;i===0&&(a[0]=0),o[r]=a}return o};L.getDiag=function(e){var t=Math.min(e.length,e[0].length),r,n=Array(t);for(r=t-1;r>=1;--r)n[r]=e[r][r],--r,n[r]=e[r][r];return r===0&&(n[0]=e[0][0]),n};L.identity=function(t){return L.diag(L.rep([t],1))};L.pointwise=function(t,r,n){typeof n=="undefined"&&(n="");var i=[],s,o=/\[i\]$/,a,u="",l=!1;for(s=0;s<t.length;s++)o.test(t[s])?(a=t[s].substring(0,t[s].length-3),u=a):a=t[s],a==="ret"&&(l=!0),i.push(a);return i[t.length]="_s",i[t.length+1]="_k",i[t.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+u+`);
if(typeof _k === "undefined") _k = 0;
var _n = _s[_k];
var i`+(l?"":", ret = Array(_n)")+`;
if(_k < _s.length-1) {
    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee(`+t.join(",")+`,_s,_k+1);
    return ret;
}
`+n+`
for(i=_n-1;i!==-1;--i) {
    `+r+`
}
return ret;`,L.compile.apply(null,i)};L.pointwise2=function(t,r,n){typeof n=="undefined"&&(n="");var i=[],s,o=/\[i\]$/,a,u="",l=!1;for(s=0;s<t.length;s++)o.test(t[s])?(a=t[s].substring(0,t[s].length-3),u=a):a=t[s],a==="ret"&&(l=!0),i.push(a);return i[t.length]="var _n = "+u+`.length;
var i`+(l?"":", ret = Array(_n)")+`;
`+n+`
for(i=_n-1;i!==-1;--i) {
`+r+`
}
return ret;`,L.compile.apply(null,i)};L._biforeach=function e(t,r,n,i,s){if(i===n.length-1){s(t,r);return}var o,a=n[i];for(o=a-1;o>=0;o--)e(typeof t=="object"?t[o]:t,typeof r=="object"?r[o]:r,n,i+1,s)};L._biforeach2=function e(t,r,n,i,s){if(i===n.length-1)return s(t,r);var o,a=n[i],u=Array(a);for(o=a-1;o>=0;--o)u[o]=e(typeof t=="object"?t[o]:t,typeof r=="object"?r[o]:r,n,i+1,s);return u};L._foreach=function e(t,r,n,i){if(n===r.length-1){i(t);return}var s,o=r[n];for(s=o-1;s>=0;s--)e(t[s],r,n+1,i)};L._foreach2=function e(t,r,n,i){if(n===r.length-1)return i(t);var s,o=r[n],a=Array(o);for(s=o-1;s>=0;s--)a[s]=e(t[s],r,n+1,i);return a};L.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"};L.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="};L.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"];L.mathfuns2=["atan2","pow","max","min"];L.ops1={neg:"-",not:"!",bnot:"~",clone:""};L.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi);","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]};(function(){var e,t;for(e=0;e<L.mathfuns2.length;++e)t=L.mathfuns2[e],L.ops2[t]=t;for(e in L.ops2)if(L.ops2.hasOwnProperty(e)){t=L.ops2[e];var r,n,i="";L.myIndexOf.call(L.mathfuns2,e)!==-1?(i="var "+t+" = Math."+t+`;
`,r=function(s,o,a){return s+" = "+t+"("+o+","+a+")"},n=function(s,o){return s+" = "+t+"("+s+","+o+")"}):(r=function(s,o,a){return s+" = "+o+" "+t+" "+a},L.opseq.hasOwnProperty(e+"eq")?n=function(s,o){return s+" "+t+"= "+o}:n=function(s,o){return s+" = "+s+" "+t+" "+o}),L[e+"VV"]=L.pointwise2(["x[i]","y[i]"],r("ret[i]","x[i]","y[i]"),i),L[e+"SV"]=L.pointwise2(["x","y[i]"],r("ret[i]","x","y[i]"),i),L[e+"VS"]=L.pointwise2(["x[i]","y"],r("ret[i]","x[i]","y"),i),L[e]=L.compile(`var n = arguments.length, i, x = arguments[0], y;
var VV = numeric.`+e+"VV, VS = numeric."+e+"VS, SV = numeric."+e+`SV;
var dim = numeric.dim;
for(i=1;i!==n;++i) { 
  y = arguments[i];
  if(typeof x === "object") {
      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);
      else x = numeric._biforeach2(x,y,dim(x),0,VS);
  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);
  else `+n("x","y")+`
}
return x;
`),L[t]=L[e],L[e+"eqV"]=L.pointwise2(["ret[i]","x[i]"],n("ret[i]","x[i]"),i),L[e+"eqS"]=L.pointwise2(["ret[i]","x"],n("ret[i]","x"),i),L[e+"eq"]=L.compile(`var n = arguments.length, i, x = arguments[0], y;
var V = numeric.`+e+"eqV, S = numeric."+e+`eqS
var s = numeric.dim(x);
for(i=1;i!==n;++i) { 
  y = arguments[i];
  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);
  else numeric._biforeach(x,y,s,0,S);
}
return x;
`)}for(e=0;e<L.mathfuns2.length;++e)t=L.mathfuns2[e],delete L.ops2[t];for(e=0;e<L.mathfuns.length;++e)t=L.mathfuns[e],L.ops1[t]=t;for(e in L.ops1)L.ops1.hasOwnProperty(e)&&(i="",t=L.ops1[e],L.myIndexOf.call(L.mathfuns,e)!==-1&&Math.hasOwnProperty(t)&&(i="var "+t+" = Math."+t+`;
`),L[e+"eqV"]=L.pointwise2(["ret[i]"],"ret[i] = "+t+"(ret[i]);",i),L[e+"eq"]=L.compile("x",'if(typeof x !== "object") return '+t+`x
var i;
var V = numeric.`+e+`eqV;
var s = numeric.dim(x);
numeric._foreach(x,s,0,V);
return x;
`),L[e+"V"]=L.pointwise2(["x[i]"],"ret[i] = "+t+"(x[i]);",i),L[e]=L.compile("x",'if(typeof x !== "object") return '+t+`(x)
var i;
var V = numeric.`+e+`V;
var s = numeric.dim(x);
return numeric._foreach2(x,s,0,V);
`));for(e=0;e<L.mathfuns.length;++e)t=L.mathfuns[e],delete L.ops1[t];for(e in L.mapreducers)L.mapreducers.hasOwnProperty(e)&&(t=L.mapreducers[e],L[e+"V"]=L.mapreduce2(t[0],t[1]),L[e]=L.compile("x","s","k",t[1]+`if(typeof x !== "object") {    xi = x;
`+t[0]+`
    return accum;
}if(typeof s === "undefined") s = numeric.dim(x);
if(typeof k === "undefined") k = 0;
if(k === s.length-1) return numeric.`+e+`V(x);
var xi;
var n = x.length, i;
for(i=n-1;i!==-1;--i) {
   xi = arguments.callee(x[i]);
`+t[0]+`
}
return accum;
`))})();L.inv=function(y){var r=L.dim(y),n=Math.abs,i=r[0],s=r[1],o=L.clone(y),a,u,l=L.identity(i),c,p,f,m,d,y;for(m=0;m<s;++m){var g=-1,h=-1;for(f=m;f!==i;++f)d=n(o[f][m]),d>h&&(g=f,h=d);for(u=o[g],o[g]=o[m],o[m]=u,p=l[g],l[g]=l[m],l[m]=p,y=u[m],d=m;d!==s;++d)u[d]/=y;for(d=s-1;d!==-1;--d)p[d]/=y;for(f=i-1;f!==-1;--f)if(f!==m){for(a=o[f],c=l[f],y=a[m],d=m+1;d!==s;++d)a[d]-=u[d]*y;for(d=s-1;d>0;--d)c[d]-=p[d]*y,--d,c[d]-=p[d]*y;d===0&&(c[0]-=p[0]*y)}}return l};L.det=function(t){var r=L.dim(t);if(r.length!==2||r[0]!==r[1])throw new Error("numeric: det() only works on square matrices");var n=r[0],i=1,s,o,a,u=L.clone(t),l,c,p,f,m,d,y;for(o=0;o<n-1;o++){for(a=o,s=o+1;s<n;s++)Math.abs(u[s][o])>Math.abs(u[a][o])&&(a=s);for(a!==o&&(f=u[a],u[a]=u[o],u[o]=f,i*=-1),l=u[o],s=o+1;s<n;s++){for(c=u[s],p=c[o]/l[o],a=o+1;a<n-1;a+=2)m=a+1,c[a]-=l[a]*p,c[m]-=l[m]*p;a!==n&&(c[a]-=l[a]*p)}if(l[o]===0)return 0;i*=l[o]}return i*u[o][o]};L.transpose=function(t){var r,n,i=t.length,s=t[0].length,o=Array(s),a,u,l;for(n=0;n<s;n++)o[n]=Array(i);for(r=i-1;r>=1;r-=2){for(u=t[r],a=t[r-1],n=s-1;n>=1;--n)l=o[n],l[r]=u[n],l[r-1]=a[n],--n,l=o[n],l[r]=u[n],l[r-1]=a[n];n===0&&(l=o[0],l[r]=u[0],l[r-1]=a[0])}if(r===0){for(a=t[0],n=s-1;n>=1;--n)o[n][0]=a[n],--n,o[n][0]=a[n];n===0&&(o[0][0]=a[0])}return o};L.negtranspose=function(t){var r,n,i=t.length,s=t[0].length,o=Array(s),a,u,l;for(n=0;n<s;n++)o[n]=Array(i);for(r=i-1;r>=1;r-=2){for(u=t[r],a=t[r-1],n=s-1;n>=1;--n)l=o[n],l[r]=-u[n],l[r-1]=-a[n],--n,l=o[n],l[r]=-u[n],l[r-1]=-a[n];n===0&&(l=o[0],l[r]=-u[0],l[r-1]=-a[0])}if(r===0){for(a=t[0],n=s-1;n>=1;--n)o[n][0]=-a[n],--n,o[n][0]=-a[n];n===0&&(o[0][0]=-a[0])}return o};L.norm2=function(t){return Math.sqrt(L.norm2Squared(t))};L.linspace=function(t,r,n){if(typeof n=="undefined"&&(n=Math.max(Math.round(r-t)+1,1)),n<2)return n===1?[t]:[];var i,s=Array(n);for(n--,i=n;i>=0;i--)s[i]=(i*r+(n-i)*t)/n;return s};L.getBlock=function(t,r,n){var i=L.dim(t);function s(o,a){var u,l=r[a],c=n[a]-l,p=Array(c);if(a===i.length-1){for(u=c;u>=0;u--)p[u]=o[u+l];return p}for(u=c;u>=0;u--)p[u]=s(o[u+l],a+1);return p}return s(t,0)};L.setBlock=function(t,r,n,i){var s=L.dim(t);function o(a,u,l){var c,p=r[l],f=n[l]-p;if(l===s.length-1)for(c=f;c>=0;c--)a[c+p]=u[c];for(c=f;c>=0;c--)o(a[c+p],u[c],l+1)}return o(t,i,0),t};L.getRange=function(t,r,n){var i=r.length,s=n.length,o,a,u=Array(i),l,c;for(o=i-1;o!==-1;--o)for(u[o]=Array(s),l=u[o],c=t[r[o]],a=s-1;a!==-1;--a)l[a]=c[n[a]];return u};L.blockMatrix=function(t){var r=L.dim(t);if(r.length<4)return L.blockMatrix([t]);var n=r[0],i=r[1],s,o,a,u,l;for(s=0,o=0,a=0;a<n;++a)s+=t[a][0].length;for(u=0;u<i;++u)o+=t[0][u][0].length;var c=Array(s);for(a=0;a<s;++a)c[a]=Array(o);var p=0,f,m,d,y,g;for(a=0;a<n;++a){for(f=o,u=i-1;u!==-1;--u)for(l=t[a][u],f-=l[0].length,d=l.length-1;d!==-1;--d)for(g=l[d],m=c[p+d],y=g.length-1;y!==-1;--y)m[f+y]=g[y];p+=t[a][0].length}return c};L.tensor=function(t,r){if(typeof t=="number"||typeof r=="number")return L.mul(t,r);var n=L.dim(t),i=L.dim(r);if(n.length!==1||i.length!==1)throw new Error("numeric: tensor product is only defined for vectors");var s=n[0],o=i[0],a=Array(s),u,l,c,p;for(l=s-1;l>=0;l--){for(u=Array(o),p=t[l],c=o-1;c>=3;--c)u[c]=p*r[c],--c,u[c]=p*r[c],--c,u[c]=p*r[c],--c,u[c]=p*r[c];for(;c>=0;)u[c]=p*r[c],--c;a[l]=u}return a};L.epsilon=2220446049250313e-31;L.LU=function(e,t){t=t||!1;var r=Math.abs,n,i,s,o,a,u,l,c,p,f=e.length,m=f-1,d=new Array(f);for(t||(e=L.clone(e)),s=0;s<f;++s){for(l=s,u=e[s],p=r(u[s]),i=s+1;i<f;++i)o=r(e[i][s]),p<o&&(p=o,l=i);for(d[s]=l,l!=s&&(e[s]=e[l],e[l]=u,u=e[s]),a=u[s],n=s+1;n<f;++n)e[n][s]/=a;for(n=s+1;n<f;++n){for(c=e[n],i=s+1;i<m;++i)c[i]-=c[s]*u[i],++i,c[i]-=c[s]*u[i];i===m&&(c[i]-=c[s]*u[i])}}return{LU:e,P:d}};L.LUsolve=function(t,r){var n,i,s=t.LU,o=s.length,a=L.clone(r),u=t.P,l,c,p,f;for(n=o-1;n!==-1;--n)a[n]=r[n];for(n=0;n<o;++n)for(l=u[n],u[n]!==n&&(f=a[n],a[n]=a[l],a[l]=f),c=s[n],i=0;i<n;++i)a[n]-=a[i]*c[i];for(n=o-1;n>=0;--n){for(c=s[n],i=n+1;i<o;++i)a[n]-=a[i]*c[i];a[n]/=c[n]}return a};L.solve=function(t,r,n){return L.LUsolve(L.LU(t,n),r)};var jt=L;function WL(e,t){let r=e.length,n=t.length,i=0,s=0;for(let a=n-r;a<n;a++)i+=e[a+r-n]*t[a],s+=e[a+r-n]*e[a+r-n];let o=i/s;for(let a=n-r;a<n;a++)t[a]=2*o*e[a+r-n]-t[a]}function XL(e,t,r){let n=e.length,i=t.length,s=0,o=0;for(let u=i-n;u<i;u++)s+=e[u+n-i]*t[u][r],o+=e[u+n-i]*e[u+n-i];let a=s/o;for(let u=i-n;u<i;u++)t[u][r]=2*a*e[u+n-i]-t[u][r]}function ZL(e,t,r,n){let i=Array(e.length-t);if(i.length===1)return i[0]=1,i;if(n===0){i[0]=1;for(let o=1;o<i.length;o++)i[o]=0;return i}let s=e[t][r]<0?-1:1;i[0]=e[t][r]+s*Math.sqrt(n);for(let o=t+1;o<e.length;o++)i[o-t]=e[o][r];return i}function jL(e,t,r){let n=0;for(;t<e.length;t++)n+=e[t][r]*e[t][r];return n}function ld(e,t){if(!t||!t.mutateInput){let s=e;e=Array(e.length);for(let o=0;o<s.length;o++)e[o]=s[o].slice()}let r=Math.min(e.length,e[0].length),n=Array(r),i=[];for(let s=0;s<r;s++){let o=-1/0,a=s;for(let l=s;l<e[s].length;l++){let c=jL(e,s,l);c>o&&(o=c,a=l)}if(n[s]=a,a!==s)for(let l=0;l<e.length;l++){let c=e[l][a];e[l][a]=e[l][s],e[l][s]=c}let u=ZL(e,s,s,o);for(let l=s;l<e[s].length;l++)XL(u,e,l);i.push(u)}return{reflectors:i,r:e,p:n}}function Mv(e,t,r){let{reflectors:n,r:i,p:s}=e,o=t.slice();for(let l=0;l<n.length;l++)WL(n[l],o);for(let l=n.length;l<i[0].length;l++)o[l]=0;o.length=i[0].length;let a=Math.pow(2,-52),u=r.regularize?a*Math.abs(i[0][0])*Math.max(i.length,i[0].length):0;for(let l=n.length-1;l>=0;l--){let c=i[l];if(Math.abs(c[l])<=u)o[l]=0;else{for(let p=l+1;p<n.length;p++)o[l]-=o[p]*c[p];o[l]/=c[l]}}for(let l=s.length-1;l>=0;l--)if(s[l]!==l){let c=o[l];o[l]=o[s[l]],o[s[l]]=c}return o}function JL(e,t,r){let n=Array(e.r[0].length);for(let s=0;s<n.length;s++)n[s]=Array(t[0].length);let i=Array(t.length);for(let s=0;s<t[0].length;s++){for(let a=0;a<t.length;a++)i[a]=t[a][s];let o=Mv(e,i,r);for(let a=0;a<o.length;a++)n[a][s]=o[a]}return n}function xa(e,t,r){return Array.isArray(t[0])?JL(e,t,r):Mv(e,t,r)}function QL(e){let t=e.r,r=Math.min(t.length,t[0].length),n=t[0][0],i=t[r-1][r-1];return n===0?1/0:Math.abs(n/i)}function Ev(e){let t=Math.pow(2,-52);return Math.max(e.r.length,e.r[0].length)*t*QL(e)<1}var KL=Math.pow(2,-52);function pd(e){for(let t of e)for(let r of t)if(!kt(r))return!1;return!0}function ew(e){let t=[];for(let r of e)t.push(r.slice());return t}function Ov(e){let{numRows:t,numCols:r}=cd(e),n=[];for(let i=0;i<r;i++)n.push([]);for(let i=0;i<t;i++)for(let s=0;s<r;s++)n[s].push(e[i][s]);return n}function cd(e){let t=e.length,r=t>0?e[0].length:0;return{numRows:t,numCols:r}}function tw(){throw new Error("Matrix dimension mismatch")}function lx(e,t){let r=cd(e),n=cd(t);r.numCols!==n.numRows&&tw();let i=[];for(let s=0;s<r.numRows;s++){let o=[];for(let a=0;a<n.numCols;a++){let u=he(0,1);for(let l=0;l<e[s].length;l++)u=us(u,ls(e[s][l],t[l][a]));o.push(u)}i.push(o)}return i}function Sv(e){let t=ew(e);return nw(t),t}function rw(e){let t=0;for(let r of e)for(let n of r){let i=Math.abs(V(n));if(!isFinite(i))return NaN;i>t&&(t=i)}return t}function vv(e){for(let t=0;t<e.length;t++)for(let r=0;r<e[t].length;r++)e[t][r]=NaN}function nw(e){let{numRows:t,numCols:r}=cd(e),n=rw(e);if(!isFinite(n))return vv(e),{determinant:NaN,rank:0};let i=Math.max(t,r)*n*KL,s=he(1,1),o=0,a=0;for(;o<t&&a<r;){let u=o,l=Math.abs(V(e[o][a]));for(let p=o+1;p<t;p++){let f=Math.abs(V(e[p][a]));(!isFinite(f)||f>l)&&(l=f,u=p)}if(!isFinite(l))return vv(e),{determinant:NaN,rank:0};if(l===0){s=he(0,1),a+=1;continue}if(!kt(e[u][a])&&l<i){for(let p=o;p<t;p++)e[o][p]=0;s=0,a+=1;continue}if(u!==o){s=qn(s);let p=e[o];e[o]=e[u],e[u]=p}for(let p=0;p<t;p++){if(p===o)continue;let f=Fi(e[p][a],e[o][a]);e[p][a]=he(0,1);for(let m=a+1;m<r;m++)e[p][m]=_i(e[p][m],ls(f,e[o][m]))}let c=e[o][a];s=ls(s,c),e[o][a]=he(1,1);for(let p=a+1;p<r;p++)e[o][p]=Fi(e[o][p],c);o+=1,a+=1}return{rank:o,determinant:o===t&&o===r?s:he(0,1)}}function dd(e,t){let r=[];for(let n=0;n<t;n++)r.push(e);return r}function Io(e,t){let r=Po(e,t),n=0;for(let i of r){let s=i;n+=s*s}return n/r.length}function Po(e,t){return e.apply(void 0,t)}function fd(e,t){let r=[];for(let n of e){let i=n.apply(void 0,t);r.push(i)}return r}function Nv(e,t){let r=[];for(let n=0;n<e.length;n++)t[n]&&r.push(e[n]);return r}function cx(e,t,r){let n=[];for(let i=0,s=0;i<e.length;i++){let o=0;r[i]&&(o=t[s],s+=1),n.push(e[i]+o)}return n}function dx(e,t){let r=t.solution.map(u=>Math.abs(u)<1e-6?0:u),n=t.solution.map(()=>0),i=Io(e,r),s=Po(e,r),o=Po(e,n),a=0;for(let u=0;u<s.length;u++){let l=o[u]*1e-15;a+=Math.abs(s[u]*l)+l*l}return a/=s.length,isFinite(a)||(a=0),isFinite(t.MSE)&&!isFinite(i)?t:i<=t.MSE+a?{solution:r,MSE:i}:t}function mx(e,t){if(!pd(t)||!pd([e]))return;let r=Ov(t),n=lx([e],r)[0],i=lx(t,r);for(let l=0;l<n.length;l++)i[l].push(qn(n[l]));let s=Sv(i);if(!pd(s))return;let o=[],a=n.length,u=0;for(let l of s)for(;u<a;)if(V(l[u])===1){o.push(l[l.length-1]),u++;break}else o.push(he(0,1)),u++;for(;u<a;)o.push(he(0,1)),u++;return o}function yx(e,t){let r=dd(0,t.length),n=fd(t,r),i=ld(jt.transpose(n),{mutateInput:!0});for(var s=0;s<2;s++){let l=Po(e,r),c=jt.neg(xa(i,l,{regularize:!1}));r=jt.add(r,c)}let o=Io(e,r);if(Ev(i))return{solution:r,MSE:o};let a=dd(0,t.length);for(var s=0;s<2;s++){let c=Po(e,a),p=jt.neg(xa(i,c,{regularize:!0}));a=jt.add(a,p)}let u=Io(e,a);return .999*u<=o?{solution:a,MSE:u}:{solution:r,MSE:o}}function px(e,t,r,n){let i=n.maxIterations,s=n.linearSubset||dd(!1,r.length),o=jt.not(s),a=Nv(t,s),u=Nv(t,o),l=2,c=.1,p=r,f=0,m=.001,d;if(jt.any(s)){let h=jt.transpose(fd(a,p)),P=ld(h);d={Jv:h,F:P};let T=Po(e,p),D=jt.neg(xa(P,T,{regularize:!0}));p=cx(p,D,s)}let y=!1,g=Io(e,p);for(;f<i&&!y&&isFinite(g);){let h=Po(e,p),P=fd(u,p),T=jt.transpose(P),D,N;if(d){let{F:E,Jv:v}=d;D=jt.dot(P,jt.sub(h,jt.dot(v,xa(E,h,{regularize:!0})))),N=jt.dot(P,jt.sub(T,jt.dot(v,xa(E,T,{regularize:!0}))))}else D=jt.dot(P,h),N=jt.dot(P,T);let I=p,O=!1;for(;f<i&&!y&&!O;){f+=1;let E=jt.add(N,jt.diag(dd(m,u.length))),v=jt.neg(jt.solve(E,D,!0));I=cx(p,v,o),y=jt.all(jt.eq(I,p));let _;if(d){let R=jt.transpose(fd(a,I)),H=ld(R);_={Jv:R,F:H};let W=Po(e,I),$=jt.neg(xa(H,W,{regularize:!0}));I=cx(I,$,s)}let z=Io(e,I);O=z<g,O?(p=I,g=z,d=_,m*=c):(m=Math.max(m,1e-64),m*=l)}}return{solution:p,MSE:g}}var fx=[18.9,.105,.0113,.089,4.414,.373,.06,.149,1.84,9.26,5,.7,.2,1.13,2.61,1,.007,30,120,1500,4e-4,7.23,-1,-.0081,-.03,-28.6,-1.71,-.4,-6.94,-.777,-500],sw=function(e){let t=e*503%fx.length;return fx[t]},ow=function(e){let t=[];for(let r=0;r<fx.length;r++){let n=[];for(let i=0;i<e;i++)r===0&&e!==1?n[i]=0:r===1&&e!==1?n[i]=1:n[i]=sw(r*e+i);t.push(n)}return t},Dv=function(e,t,r,n,i){let s=[];for(let a of r)s.push({soln:px(e,t,a,i),initialGuess:a});s.sort(function(a,u){return isNaN(a.soln.MSE)?1:isNaN(u.soln.MSE)?-1:a.soln.MSE-u.soln.MSE});let o=[];for(let a=0;a<n;a++)o.push(s[a].initialGuess);return o};function aw(e,t,r,n){if(!t||t.type!=="known")return e;let i=t.bounds;return i[0]===-1/0&&i[1]===1/0?e:i[0]===-1/0?i[1]-Math.exp(-e):i[1]===1/0?i[0]+Math.exp(e):r/(n-1)*i[1]+(n-1-r)/(n-1)*i[0]}var Av=[3,5,7,11,13,17,19];function uw(e,t){let r=[];for(let i=0;i<e.length;i++){let s=e[i],o=[];for(let a=0;a<s.length;a++){var n=Av[a%Av.length]*i%e.length;o.push(aw(s[a],t[a],n,e.length))}r.push(o)}return r}function Rv(e,t,r){r||(r={});let{linearSubset:n,bounds:i,preferredInitialGuess:s}=r,o=ow(t.length);i&&(o=uw(o,i));let a=Dv(e,t,o,5,{maxIterations:3,linearSubset:n}),u=Dv(e,t,a,1,{maxIterations:60,linearSubset:n}),l=px(e,t,u[0],{maxIterations:250,linearSubset:n});if(!s)return l;let c=px(e,t,s,{maxIterations:100,linearSubset:n});return isFinite(c.MSE)&&(c.MSE<l.MSE||Kr(c.MSE,l.MSE,8))?c:l}function gx(e){return{chunk:e,isLazy:!0}}function Cv(e){return e.slice()}function yd(e){if(!e.isLazy)return e;let t=e.chunk.copy();return t.reopenFinalBlock(),{chunk:t,forwardParameterMap:Cv,reverseParameterMap:Cv,isLazy:!1,valueMap:mw(e.chunk.instructionsLength()),replacementMask:yu(e.chunk.argNames.length)}}function Lv(e){let{chunk:t,forwardParameterMap:r,reverseParameterMap:n,isLazy:i,valueMap:s,replacementMask:o,didShiftScale:a}=e;return{chunk:t.copy(),forwardParameterMap:r,reverseParameterMap:n,isLazy:i,valueMap:s.slice(),replacementMask:o.slice(),didShiftScale:a}}function lw(e){var t=1/0,r=-1/0,n=e.length;for(let i of e)t=Math.min(t,i),r=Math.max(r,i);return{min:t,max:r,length:n}}function Fv(e){let t=e.getInstruction(e.getReturnIndex());if(t.type!==48)return;let r=t.args[0],n=e.getReturnIndex()-r,i=e.getInstruction(r);if(i.args.length!==2)return;let s=i.args[0],o=i.args[n],a=[],u=[];a.push(s),u.push({min:1,max:$i(e,e.getReturnIndex(),"Programming error: cannot optimize regression on non-constant-length list"),length:$i(e,e.getReturnIndex(),"Programming error: cannot optimize regression on non-constant-length list")});let l=!1,c=!1;for(let g=s+1;g<=o;g++){let h=e.getInstruction(g);if(h.type===39||h.type===41||h.type===40){if(h.args[1]!==s)continue;let P=h.args[0];if(e.getInstruction(P).valueType!==Z||!At(e.getInstruction(P)))continue;let T=Nt(e,P),D=lw(T);if(!isFinite(D.min)||!isFinite(D.max))continue;a.push(g),u.push(D)}else if(h.type===37)h.symbol==="exp"?c=!0:_v(h)&&(l=!0);else if(h.type===12||h.type===13)c=!0;else if(gn(h)||Cr(h))return}if(a.length===0||!c&&!l)return;let p=[];for(let g=0;g<=o;g++){let h=a.indexOf(g);if(h!==-1){let P=yu(a.length);P[h]=!0,p.push(P)}else p.push(md(e,p,a.length,g))}let f=[];for(let g=0;g<=e.getReturnIndex();g++)if(e.getInstruction(g).type===2){let P=yu(e.argNames.length);P[g]=!0,f.push(P)}else f.push(md(e,f,e.argNames.length,g));let m={listAccessDependencyTable:p,listAccesses:a,listStatisticsTable:u},d;for(let g=s+1;g<=e.getReturnIndex();g++){let h=e.getInstruction(g);switch(h.type){case 37:{if(h.symbol==="exp"){let $=h.args[0],re=hx(m,$);if(re===void 0){Ws(e,f,d,g);break}let{listStatistics:j,listAccessIndex:ve}=re,we=Rl(gx(e),g,$,ve,j);we?d=[we]:Ws(e,f,d,g)}break}case 12:case 13:{let[$,re]=h.args,j=hx(m,re);if(j===void 0||wv(m,$)){Ws(e,f,d,g);break}let{listStatistics:ve,listAccessIndex:we}=j,Dt=pw(gx(e),g,we,ve);Dt?d=[Dt]:Ws(e,f,d,g);break}case 10:if(d&&d.length>1){Ws(e,f,d,g);break}let P=d&&d.length>0?d[0]:gx(e),[T,D]=h.args,N=P.isLazy?T:P.valueMap[T],I=P.isLazy?D:P.valueMap[D],O=P.chunk.getInstruction(N),E=P.chunk.getInstruction(I),v,_,z;if(O.type===37)v=T,z=O,_=D;else if(E.type===37)v=D,z=E,_=T;else{Ws(e,f,d,g);break}let R=hx(m,v);if(R===void 0||wv(m,_)){Ws(e,f,d,g);break}let{listAccessIndex:H,listStatistics:W}=R;if(z.symbol==="exp"){let $=fw(P,g,_,v,H,W);if($){d=$;break}}else if(_v(z)){let $=cw(P,g,_,v,H);if($){d=[$];break}}Ws(e,f,d,g);break;default:{Ws(e,f,d,g);break}}}if(d===void 0||d.length===0)return;let y=[];for(let g of d)y.push({chunk:g.chunk.close(),forwardParameterMap:g.forwardParameterMap,reverseParameterMap:g.reverseParameterMap});return y}function Ws(e,t,r,n){if(r===void 0)return;let i=e.getInstruction(n);if(me(i))for(let s of r)s.valueMap[n]=n;else for(let s of r){let{chunk:o,valueMap:a}=s,u=[],l=0;for(let c of i.args){if(a[c]!==c){if(l+=1,l>1){r.length=0;return}}else{let p=t[c];for(let f=0;f<p.length;f++)if(p[f]&&s.replacementMask[f]){r.length=0;return}}u.push(a[c])}a[n]=l>0?Xt(o,i,u):n}}function hx(e,t){let{listAccessDependencyTable:r,listAccesses:n,listStatisticsTable:i}=e,s,o=r[t];for(let a=0;a<o.length;a++)if(o[a]){if(s)return;s={listAccessIndex:n[a],listStatistics:i[a]}}return s}function wv(e,t){let{listAccessDependencyTable:r}=e,n=r[t];for(let i of n)if(i)return!0;return!1}function bx(e,t){let r=[];for(let s=0;s<=t;s++)if(e.getInstruction(s).type===2){let a=yu(e.argNames.length);a[s]=!0,r.push(a)}else r.push(md(e,r,e.argNames.length,s));let n,i=r[t];for(let s=0;s<i.length;s++)if(i[s]){if(n!==void 0)return;n=s}return n}function cw(e,t,r,n,i){let s=e.chunk,o=bx(s,r);if(o===void 0)return;let a=xx(e,r,o);if(a===void 0)return;let u=s.getInstruction(n),l=u.args[0];if(a=Bv(a,l,i),a===void 0)return;let{chunk:c,valueMap:p}=a,f=c.getInstruction(p[l]);if(f.type!==8)return;let m=f.args[1],d=c.getInstruction(f.args[0]);if(d.type!==10)return;let[y,g]=d.args,h=o,P=m,T=y,D=g,N=c.Multiply([T,D]),I=c.SyntheticNativeFunction("cos",[N]),O=c.SyntheticNativeFunction("sin",[N]),E=u.symbol==="sin"?c.Add([c.Multiply([h,O]),c.Multiply([P,I])]):c.Subtract([c.Multiply([h,I]),c.Multiply([P,O])]);p[t]=E;function v(R){let H=a.forwardParameterMap(R),W=H[o],$=H[m],re=W*Math.cos($),j=W*Math.sin($);return H[o]=re,H[m]=j,H}function _(R){let H=R.slice(),W=R[o],$=R[m],re=ci(W,$),j=Math.atan2($,W);return H[o]=re,H[m]=j,a.reverseParameterMap(H)}let z=a.replacementMask.slice();return z[o]=!0,z[y]=!0,z[m]=!0,{chunk:c,forwardParameterMap:v,reverseParameterMap:_,valueMap:p,replacementMask:z,isLazy:!1}}function pw(e,t,r,n){let i=e.chunk,s=i.getInstruction(t),[o,a]=s.args,u=i.getInstruction(o);if(u.type===1&&u.valueType===x&&V(u.value)>0){let P=yd(e),{chunk:T,valueMap:D}=P,N=T.Multiply([T.SyntheticNativeFunction("ln",[D[o]]),D[a]]);return D[a]=N,D[t]=T.SyntheticNativeFunction("exp",[N]),Rl(P,t,a,r,n)||P}let l=bx(i,o);if(l===void 0)return;let c=xx(e,o,l);if(c===void 0)return;let{chunk:p,valueMap:f}=c,m=p.Multiply([f[o],f[a]]);f[a]=m,f[t]=p.SyntheticNativeFunction("exp",[m]);function d(P){let T=c.forwardParameterMap(P),D=T[l],N=Math.log(D);return T[l]=N,T}function y(P){let T=P.slice(),D=T[l],N=Math.exp(D);return T[l]=N,c.reverseParameterMap(T)}let g=c.replacementMask.slice();g[l]=!0;let h={chunk:p,forwardParameterMap:d,reverseParameterMap:y,isLazy:!1,valueMap:f,replacementMask:g};return Rl(h,t,a,r,n)||h}function fw(e,t,r,n,i,s){if(!e.isLazy&&e.didShiftScale)return;let o=e.isLazy?e:Lv(e),a=e.chunk,u=bx(a,r);if(u===void 0)return;let l=xx(e,r,u);if(l===void 0)return;let{chunk:c,valueMap:p}=l,f=c.getInstruction(p[n]).args[0],m=c.Add([f,p[r]]);p[r]=m,p[t]=c.SyntheticNativeFunction("exp",[m]);function d(I){let O=l.forwardParameterMap(I),E=O[u],v=Math.log(E);return O[u]=v,O}function y(I){let O=I.slice(),E=O[u],v=Math.exp(E);return O[u]=v,l.reverseParameterMap(O)}function g(I){let O=l.forwardParameterMap(I),E=O[u],v=Math.log(-E);return O[u]=v,O}function h(I){let O=I.slice(),E=O[u],v=-Math.exp(E);return O[u]=v,l.reverseParameterMap(O)}let P=l.replacementMask.slice();P[u]=!0;let T=yd(o);T.valueMap[t]=T.chunk.Multiply([T.valueMap[r],T.valueMap[n]]);let D={chunk:c,forwardParameterMap:d,reverseParameterMap:y,isLazy:!1,valueMap:p,replacementMask:P},N=Lv(D);return N.forwardParameterMap=g,N.reverseParameterMap=h,D=Rl(D,t,r,i,s)||D,N=Rl(N,t,r,i,s)||N,N.valueMap[t]=N.chunk.Negative([N.valueMap[t]]),[T,D,N]}function Rl(e,t,r,n,i){let s=dw(e,r,n,i);if(s!==void 0)return s.valueMap[t]=s.chunk.SyntheticNativeFunction("exp",[s.valueMap[r]]),s}function dw(e,t,r,n){let i=Bv(e,t,r);if(i===void 0)return;let{chunk:s,valueMap:o}=i,a=s.getInstruction(o[t]);if(a.type!==8)return;let u=a.args[1],l=s.getInstruction(a.args[0]);if(l.type!==10)return;let[c,p]=l.args,{min:f,max:m}=n,d=m-f,y=.5*(m+f),g=s.Divide([s.Subtract([p,s.Constant(y)]),s.Constant(d)]),h=s.Add([s.Multiply([c,g]),u]);o[t]=h;function P(D){let N=i.forwardParameterMap(D),I=N[c],O=N[u],E=I*d,v=O+y*I;return N[c]=E,N[u]=v,N}function T(D){let N=D.slice(),I=D[c],O=D[u],E=I/d,v=O-E*y;return N[c]=E,N[u]=v,i.reverseParameterMap(N)}return{chunk:s,forwardParameterMap:P,reverseParameterMap:T,isLazy:!1,valueMap:o,replacementMask:i.replacementMask,didShiftScale:!0}}function xx(e,t,r){let n=e.chunk,i=Mn(n,r,{allowRestriction:!1,allowClosedBlockReferences:!1});if(Kt(i,t)!==1)return;let s=hi(i),[o,a]=or(s,t);if(a===void 0)return;let u=s.newChunk.getInstruction(o);if(u.type!==1||u.valueType!==x)return;let l=s.newChunk.getInstruction(a);if(l.type!==1||l.valueType!==x)return;let c=yd(e),{chunk:p,valueMap:f}=c,m=V(u.value),d=V(l.value);f[t]=r;function y(P){let T=c.forwardParameterMap(P),D=T[r],N=m+d*D;return T[r]=N,T}function g(P){let T=P.slice(),N=(T[r]-m)/d;return T[r]=N,c.reverseParameterMap(T)}let h=c.replacementMask.slice();return h[r]=!0,{chunk:p,forwardParameterMap:y,reverseParameterMap:g,isLazy:!1,valueMap:f,replacementMask:h}}function Bv(e,t,r){let n=e.chunk,i=e.isLazy?t:e.valueMap[t],s=Mn(n,r,{allowRestriction:!1,allowClosedBlockReferences:!0});if(Kt(s,i)!==1)return;e.isLazy&&(s=Mn(n.copy().reopenFinalBlock(),r,{allowRestriction:!1,allowClosedBlockReferences:!1}));let o=hi(s),[a,u]=or(o,i);if(u===void 0)return;let l=o.newChunk,c=Math.max(u,a),p=[];for(let _e=0;_e<=c;_e++)if(l.getInstruction(_e).type===2){let ae=yu(l.argNames.length);ae[_e]=!0,p.push(ae)}else p.push(md(l,p,l.argNames.length,_e));let f,m;for(let _e=0;_e<n.argNames.length;_e++)if(p[u][_e])if(f===void 0)f=_e;else return;else if(p[a][_e])if(m===void 0)m=_e;else return;if(f===void 0||m===void 0)return;let d=Mn(l,f,{allowRestriction:!1,allowClosedBlockReferences:!1});if(Kt(d,u)!==1)return;let y=Mn(l,m,{allowRestriction:!1,allowClosedBlockReferences:!1});if(Kt(y,a)!==1)return;let g=hi(d),h=hi(y),[P,T]=or(g,u),D=g.newChunk.getInstruction(P);if(D.type!==1||D.valueType!==x)return;let N=g.newChunk.getInstruction(T);if(N.type!==1||N.valueType!==x)return;let I=yd(e),{chunk:O,valueMap:E}=I,v=O.Add([O.Multiply([f,r]),m]);E[t]=v;let _=l.copy();_.List([u,a]);let z=_.close().getCompiledFunction().fn;function R(_e){let Q=I.forwardParameterMap(_e),[ae,ge]=z.apply(null,Q);return Q[f]=ae,Q[m]=ge,Q}let H=V(D.value),W=V(N.value),[$,re]=or(h,a),j=h.newChunk.copy();j.List([$,re]);let ve=j.close().getCompiledFunction().fn;function we(_e){let Q=_e.slice(),ae=_e[f],ge=_e[m],zt=(ae-H)/W,Fe=_e.slice();Fe[f]=zt,Fe.splice(m,1);let[Ft,qt]=ve.apply(null,Fe),$r=(ge-Ft)/qt;return Q[f]=zt,Q[m]=$r,I.reverseParameterMap(Q)}let Dt=I.replacementMask.slice();return Dt[f]=!0,Dt[m]=!0,{chunk:O,forwardParameterMap:R,reverseParameterMap:we,isLazy:!1,valueMap:E,replacementMask:Dt}}function md(e,t,r,n){let i=e.getInstruction(n),s=yu(r);if(me(i))return s;for(let o of i.args){let a=t[o];for(let u=0;u<a.length;u++)s[u]=s[u]||a[u]}return s}function yu(e){let t=[];for(let r=0;r<e;r++)t.push(!1);return t}function mw(e){let t=[];for(let r=0;r<e;r++)t.push(r);return t}function _v(e){return e.type===37&&(e.symbol==="sin"||e.symbol==="cos")}function Ke(e,t){switch(e){case x:case Ie:return new b.Constant(t);case Ve:return new b.Seed(t);case A:return new b.ParenSeq([Ke(x,t[0]),Ke(x,t[1])]);case G:return new b.ParenSeq([Ke(x,t[0]),Ke(x,t[1]),Ke(x,t[2])]);case tr:return new b.FunctionCall("segment",[Ke(G,t[0]),Ke(G,t[1])]);case mr:return new b.FunctionCall("triangle",[Ke(G,t[0]),Ke(G,t[1]),Ke(G,t[2])]);case yr:return new b.FunctionCall("sphere",[Ke(G,t[0]),Ke(x,t[1])]);case tt:return new b.FunctionCall("rgb",[Ke(x,t[0]),Ke(x,t[1]),Ke(x,t[2])]);case Te:return new b.FunctionCall("polygon",[Ke(Be,t)]);case pe:return new b.FunctionCall("segment",[Ke(A,t[0]),Ke(A,t[1])]);case ne:return new b.FunctionCall("line",[Ke(A,t[0]),Ke(A,t[1])]);case Pe:return new b.FunctionCall("ray",[Ke(A,t[0]),Ke(A,t[1])]);case ie:return new b.FunctionCall("circle",[Ke(A,t[0]),Ke(x,t[1])]);case ee:return new b.FunctionCall("arc",[Ke(A,t[0]),Ke(A,t[1]),Ke(A,t[2])]);case de:return new b.FunctionCall("angle",[Ke(A,t[0]),Ke(x,t[1]),Ke(x,t[2])]);case oe:return new b.FunctionCall("directedangle",[Ke(A,t[0]),Ke(x,t[1]),Ke(x,t[2])]);case Me:case Z:case Ir:case Be:case Tr:case er:case $t:case fr:case dr:case Lt:case wt:case cr:case pr:case Gr:case zr:case qr:case kr:{let n=[],i=ke(e);for(let s of t)n.push(Ke(i,s));return new b.List(n)}case ft:case et:case Bt:case Qt:case Ze:case Re:case Vr:case li:throw new Error(`Programming error: cannot create parse node from valueType: ${pn(e)}`);default:let r=e;throw new Error(`Programming error: unexpected valueType: ${pn(r)}`)}}function Hv(e,t){try{return yw(e,t)}catch(r){return r instanceof b.Error?r:Ce()}}function yw(e,t){let{policy:r,frame:n,exportFrame:i,lastExportFrame:s,priorAnalysis:o}=e,a=t._lhs.buildIRExpression(r,n,{coerceToNumber:!0}),u=t._rhs.buildIRExpression(r,n,{coerceToNumber:!0});if(a.isError)throw a;if(u.isError)throw u;if(a.valueType!==x&&a.valueType!==Z||u.valueType!==x&&u.valueType!==Z)throw oy([te(a.valueType),te(u.valueType)]);let l=t._difference.buildIRExpression(r,n,{wrapInList:!0,coerceToNumber:!0});if(l.isError)throw l;for(let N of l.getDependencies())if(!r.validRegressionParameter(N))throw Ig(N);let c=hw(l.getDependencies(),t.userData.regressionParameters,s),{parameters:p,residuals:f,isLinear:m,parameterWarning:d}=Uv(c,l),y={policy:r,frame:n},g=Vv(y,t,p),h=Tw(t,a,g),P;if(t.userData.isLogModeRegression&&(h===an.LOGLIN||h===an.LOGLOG)){let N=t._logDifference.buildIRExpression(r,n,{wrapInList:!0,coerceToNumber:!0});if(N.isError)throw N;let I=t._logLhs.buildIRExpression(r,n,{wrapInList:!0,coerceToNumber:!0});if(I.isError)throw I;({parameters:p,isLinear:m,parameterWarning:d}=Uv(c,N)),g=Vv(y,t,p),f=kv(y,t._difference,p);let O=kv(y,t._logDifference,p);P=qv(t,I,g,O,t.userData.isLogModeRegression,h)}else P=qv(t,a,g,f,t.userData.isLogModeRegression,h);let T=gw(t,i),D=xw(t,T,o);return t.userData.residualVariable=vr(T),new b.OptimizedRegression(p,Ke(Z,f),P,g.substituted,{isModelValid:g.isValid,residualVariable:T,residualSuggestionId:D,shouldSuggestLogMode:h!==an.NONE,isLinear:m,parameterWarning:d})}function gw(e,t){if(e.userData&&e.userData.residualVariable){let s=ps(e.userData.residualVariable);if(!t[s])return s}let r=e.getDependencies().filter(s=>s[0]!=="_"),n;for(let s of r){let o=s.match(/_(.*)/);if(o&&(n="e_"+o[1],!t[n]))return n}let i=1;for(;;){if(n="e_"+i,!t[n])return n;i++}}function Vv({policy:e,frame:t},r,n){let i=r._rhs.getDependencies(),s,o;for(let p of i){if(n.hasOwnProperty(p))continue;let f=t[p];if(!f||(f.type==="Assignment"&&(f=f._expression),!f.buildIRExpression))continue;let m=f.buildIRExpression(e,t,{coerceToNumber:!0});if(!m.isError&&m.valueType===Z){if(s!==void 0){s=void 0,o=void 0;break}m.getDependencies().length===0&&(s=p,o=m)}}let a=Object.create(t);s!==void 0&&(a[s]=void 0);let u=r._rhs.buildIRExpression(e,a,{coerceToNumber:!0}),l=Object.create(a);for(let p in n)l[p]=n[p];let c=r._rhs.buildIRExpression(e,l,{coerceToNumber:!0});return o?{node:u,substituted:c,listNode:o,isValid:!0}:{node:u,substituted:c,listNode:o,isValid:!1}}function hw(e,t,r){let n=[];t||(t={}),r||(r={});for(let i of e){let s=vr(i);r[i]&&isFinite(r[i].asValue())?n.push(+r[i].asValue()):t.hasOwnProperty(s)&&isFinite(+t[s])?n.push(+t[s]):n.push(1)}return n}function Gv(e,t){let r=t.getDependencies(),n=t.getCompiledFunction(r).fn;if(r.length){let i=t.findLinearSubset(r),s=i.every(a=>a),o=[];for(let a of r)o.push(t.takeDerivative(a).getCompiledFunction(r).fn);if(s){let a=r.map(()=>he(0,1)),u=t.interpretWithParameters(a),l=[];for(let m of r)l.push(t.takeDerivative(m).interpretWithParameters(a));let c=mx(u,l);if(c){let m=t.interpretWithParameters(c);return{solution:c,residuals:m,MSE:Px(m),isLinear:s}}let{solution:p,MSE:f}=dx(n,yx(n,o));return{solution:p,residuals:n.apply(void 0,p),MSE:f,isLinear:s}}else{let a=[];for(let p of r)a.push(t.boundDomain(p));let u={linearSubset:i,bounds:a,preferredInitialGuess:e},{solution:l,MSE:c}=dx(n,Rv(n,o,u));return{solution:l,residuals:n.apply(void 0,l),MSE:c,isLinear:s}}}else return{solution:[],residuals:t.interpretWithParameters([]),MSE:Io(n,[]),isLinear:!0}}function zv(e,t){let r={},n=t.getDependencies();for(let i=0;i<n.length;i++){let s=new b.RegressionParameter(e[i]);r[n[i]]=s}return r}function qv(e,t,r,n,i,s){let o=Px(n);if(!isFinite(o))throw Mg();if(t.getDependencies().length>0)return{RMSE:Math.sqrt(o)};let a=k(t.valueType)?dl(t.asValue()):0;if(t.getDependencies().length||!isFinite(a)||a<=0||!e.isLhsSimple)return{RMSE:Math.sqrt(o)};{let u=1-o/a;if(r.isValid){let l=[],c=[],p=i&&(s===an.LINLOG||s===an.LOGLOG);b.List.eachArgs([r.listNode,t],function(m){let d=m[0].isConstant?m[0].asCompilerValue():NaN,y=m[1].isConstant?m[1].asCompilerValue():NaN;l.push(p?Math.log(V(d)):d),c.push(y)});let f=Tf(l.map(m=>V(m)),c.map(m=>V(m)));if(Kr(bw(l,c).MSE,o,8))return{r:f,rsquared:f*f}}return{Rsquared:u}}}function bw(e,t){let r=t,n=[e.map(a=>qn(a)),e.map(()=>he(-1,1))],i=mx(r,n);if(i){let[a,u]=i,l=[];for(let c=0;c<t.length;c++)l.push(_i(t[c],us(ls(a,e[c]),u)));return{solution:i,MSE:Px(l)}}function s(a,u){let l=[];for(let c=0;c<e.length;c++)l.push(V(t[c])-(a*V(e[c])+u));return l}return yx(s,[function(){return e.map(function(a){return-V(a)})},function(){return e.map(function(){return-1})}])}function xw(e,t,r){let n=e._rhs.getDependencies(),i;for(let s in r){if(!r.hasOwnProperty(s))continue;let o=r[s].concreteTree;if(!Pi(o)||!o.columns[0])continue;let a=r[s].rawTree.columns;if(!a||!a.length)continue;let u=a[0].getExports();if(u.length===1&&n.indexOf(u[0])!==-1){for(let l=1;l<a.length;l++)if(a[l].getDependencies().indexOf(t)!==-1)return;i=i||s}}return i||void 0}function Tx(e,t){let r=e.length,n=e[0],i=t[0],s=e[r-1],o=t[r-1];if(!isFinite(n)||!isFinite(s)||!isFinite(i)||!isFinite(o)||o-i===0)return!1;let a=s-n;if(a===0)return!1;for(let u=1;u<r-1;u++){let l=e[u],c=t[u],p=(o*(l-n)+i*(s-l))/a;if(!Kr(c,p,5))return!1}return!0}var an={NONE:0,LOGLIN:1,LOGLOG:2,LINLOG:3};function Tw(e,t,r){if(!e.isLhsSimple||!r.isValid)return an.NONE;let n=r.substituted;if(n.isError||n.valueType!==x)return an.NONE;let i=n.getDependencies();if(i.length!==1||isFinite(r.node.polynomialOrder(i[0])))return an.NONE;let s=n.getCompiledFunction(i).fn,o=r.listNode;if(n.valueType!==x)return an.NONE;let a=o.mapElements(f=>+f.asValue());if(a.length<3)return an.NONE;a.sort(function(f,m){return f-m});let u=a.map(s),l=u.map(Math.log),c=a.map(Math.log),p=!0;return b.List.wrap(t).eachElement(f=>{isFinite(Math.log(+f.asValue()))||(p=!1)}),Tx(a,l)&&p?an.LOGLIN:Tx(c,l)&&p?an.LOGLOG:Tx(c,u)?an.LINLOG:an.NONE}function kv({policy:e,frame:t},r,n){let i=Object.create(t);for(let a in n)n.hasOwnProperty(a)&&(i[a]=n[a]);let s=fu({policy:e,frame:i,wrapInList:!0},r),o=s.getError();if(o)throw o;return s.asCompilerValue()}function Px(e){let t=0;for(let r of e){let n=V(r);t+=n*n}return t/e.length}function Uv(e,t){let r,n,i=t._chunk;if(i&&(n=Fv(i)),!n||n.length===0)return t=t.deriveRegressionRestrictions(),r=Gv(e,t),{parameters:zv(r.solution,t),residuals:r.residuals,isLinear:r.isLinear,parameterWarning:!1};let s=t.getDependencies(),o=t.getCompiledFunction(s).fn,a=1/0,u={},l,c=!1;for(let p of n){let f=new hr(p.chunk);if(f=f.deriveRegressionRestrictions(),r=Gv(p.forwardParameterMap(e),f),r.MSE<a){let m=p.reverseParameterMap(r.solution.map(y=>V(y))),d=Io(o,m);if(u&&(!isFinite(d)||d>=a)){isFinite(d)||(c=!0);continue}a=r.MSE,u=zv(m,t),l=o.apply(void 0,m)}}return{parameters:u,residuals:l,isLinear:!1,parameterWarning:c}}b.Base.prototype.analyze=function(e,t){return Zr(this)?jr(e,t,this):new B(e,t,this,this.tryGetConcreteTree(e,t))};function gd(e,t,r,n){if(n.isError)return new B(e,t,r,n);if(!e.areAllScalesLinear()&&!Mu(n.valueType)){let a=Vu(te(n.valueType));return a.setCursorContext(n.getCursorContext()),new B(e,t,r,a)}var i=n.getDependencies();let s;switch(n.valueType){case et:case Qt:case Me:{s=n;break}case tt:case Tr:case pe:case $t:case ie:case cr:case ee:case pr:case ne:case fr:case Pe:case dr:case de:case Lt:case oe:case wt:case Re:case Vr:case Ze:case Te:case er:case tr:case zr:case mr:case qr:case yr:case kr:i.length?s=Ct(r.getSliderVariables(e,n)).setDependencies(i):s=n;break;case A:case G:case Be:case Gr:if(i.length)if(e.validParametricVariables(i))s=n;else{var o=r.getSliderVariables(e,n);s=Ct(o).setDependencies(o)}else s=n;break;case x:case Z:i.length===0?s=n:i.length<=e.dimensions()-1?e.validExpressionVariables(i)?s=n:s=Tp(e.implicitDependency(i)).setDependencies(i):e.validImplicitVariables(i)?s=Tp().setDependencies(i):s=Ct(r.getSliderVariables(e,n)).setDependencies(i);break;default:s=Ce()}return Zi(s)&&s.setCursorContext(n.getCursorContext()),new B(e,t,r,s)}function Yv(e){return new b.FunctionCall("pdf",[e,new b.Identifier("x")])}b.Identifier.prototype.analyze=function(e,t){let r=this.tryGetConcreteTree(e,t,{coerceToNumber:!0}),n=gd(e,t,this,r);return Zr(this)&&!Mx(n)?jr(e,t,this):n};b.FunctionCall.prototype.analyze=function(e,t,r){var n;ud[this._symbol]&&uu(t,this).length===0?n=Yv(this).tryGetConcreteTree(e,t):n=this.tryGetConcreteTree(e,t);var i=gd(e,t,this,n);if(Zr(this)&&!Mx(i))return jr(e,t,this);var s=this.getMoveStrategy(e,t,n,r,this.userData);if(s){var o=this.getDefaultDragMode(s),a=n.asCompilerValue(),u=[new b.Constant(a[0]),new b.Constant(a[1])];return new B(e,t,this,new b.MovablePoint(u,s,o))}return i};b.Expression.prototype.analyze=function(e,t){var r=gd(e,t,this,this.tryGetConcreteTree(e,t));return Zr(this)&&!Mx(r)?jr(e,t,this):r};b.FunctionDefinition.prototype.analyze=function(e,t){if(Zr(this))return jr(e,t,this);if(Se[this._symbol])return this.asEquation().analyze(e,t);var r=this._symbol.split("_")[0];if(Se[r]&&Se[r].isFunction)return new B(e,t,this,Ga(this._symbol,r));var n=this.tryGetConcreteTree(e,t);if(n instanceof b.Error&&!n.blocksExport&&this._argSymbols.length===1){let u=Object.create(t);u[this._argSymbols[0]]=new lt("identityTransformation");let l=this._expression.tryGetConcreteTree(e,u);if(!(l instanceof b.Error))return new B(e,t,this,l)}if(n.isError)return new B(e,t,this,n);var i=this._argSymbols,s=n.getDependencies();if(s.indexOf(this._symbol)!==-1)return new B(e,t,this,ku(this._symbol));var o=s.filter(function(u){return i.indexOf(u)===-1});if(e.unplottablePolarFunction(this._symbol,s))return new B(e,t,this,mg());if(o.some(function(u){return e.assignmentForbidden(u)}))return new B(e,t,this,Uu(o,this._symbol,i).setDependencies(s));if(o.length){var a=this.getSliderVariables(e,n);return new B(e,t,this,Ct(a).setDependencies(a))}return!e.areAllScalesLinear()&&!Mu(n.valueType)?new B(e,t,this,Vu(te(n.valueType))):new B(e,t,this,n)};b.Assignment.prototype.analyze=function(e,t,r){if(Zr(this))return jr(e,t,this);var n=this._symbol;if(!e.validLHS(n))return new B(e,t,this,dg(n));if(Se[n])return this.asEquation().analyze(e,t);var i;if(this._expression instanceof b.FunctionCall&&ud[this._expression._symbol]&&uu(t,this).length===0)i=Yv(this._expression).tryGetConcreteTree(e,t);else{var s=Object.create(t);s[n]=e.validSolvedVariable(n)?void 0:Qo(),i=this.tryGetConcreteTree(e,s)}if(i.isError)return new B(e,t,this,i);if(!e.areAllScalesLinear()&&!Mu(i.valueType))return new B(e,t,this,Vu(te(i.valueType)));var o=i.getDependencies();if(this.isEquation(i))return this.asEquation().analyze(e,t);var a=i.valueType===tt||i.valueType===Tr;if(o.length>1||a&&o.length){var u=this.getSliderVariables(e,i);return a&&!e.isBeta3d()||u.length?new B(e,t,this,Ct(u).allowExport().setDependencies(u)):new B(e,t,this,i)}var l=this.getMoveStrategy(e,t,i,r,this.userData);if(l){var c=this.getDefaultDragMode(l);return new B(e,t,this,new b.MovablePoint([i.elementAt(0),i.elementAt(1)],l,c))}else return new B(e,t,this,i)};b.CoordinateEquation.prototype.analyze=function(e,t){if(!e.validCoordinateEquationSymbol(this._concatenatedSymbol))return this.asEquation().analyze(e,t);if(Zr(this))return jr(e,t,this);let r=this.tryGetConcreteTree(e,t);return new B(e,t,this,r)};b.Regression.prototype.analyze=function(e,t,r,n,i){if(Zr(this))return jr(e,t,this);var s={policy:e,frame:t,exportFrame:r,lastExportFrame:n,priorAnalysis:i};return new B(e,t,this,Hv(s,this))};function Ix(e,t){var r=this.tryGetConcreteTree(e,t),n=r.getDependencies();return n.length?new B(e,t,this,Ct(this.getSliderVariables(e,r)).setDependencies(n)):new B(e,t,this,this.tryGetConcreteTree(e,t))}b.Histogram.prototype.analyze=function(e,t){return Zr(this)?jr(e,t,this):e.areAllScalesLinear()?Ix.call(this,e,t):new B(e,t,this,dy())};b.DotPlot.prototype.analyze=function(e,t){return Zr(this)?jr(e,t,this):e.areAllScalesLinear()?Ix.call(this,e,t):new B(e,t,this,my())};b.BoxPlot.prototype.analyze=function(e,t){return Zr(this)?jr(e,t,this):e.areAllScalesLinear()?Ix.call(this,e,t):new B(e,t,this,yy())};function Wv(e){return function(t,r){if(Zr(this))return jr(t,r,this);var n=this.tryGetConcreteTree(t,r),i=n.getDependencies();if(i.length)return new B(t,r,this,Ct(this.getSliderVariables(t,n)).setDependencies(i));var s=new B(t,r,this,this.tryGetConcreteTree(t,r));if(!n.isError){s.evaluationState.expression_type="TTEST";var o=n.args.map(function(a){return a.asValue()});s.evaluationState.ttest_results=e.apply(null,o)}return s}}b.TTest.prototype.analyze=Wv(Ch);b.IndependentTTest.prototype.analyze=Wv(Lh);b.Stats.prototype.analyze=function(e,t){if(Zr(this))return jr(e,t,this);var r=this.tryGetConcreteTree(e,t),n=r.getDependencies();if(n.length)return new B(e,t,this,Ct(this.getSliderVariables(e,r)).setDependencies(n));var i=new B(e,t,this,this.tryGetConcreteTree(e,t));if(!r.isError){i.evaluationState.expression_type="STATS";var s=r.args.map(function(o){return o.asValue()});i.evaluationState.stats_results=wh.apply(null,s)}return i};b.Equation.prototype.analyze=b.BaseComparator.prototype.analyze=function(e,t){if(Zr(this))return jr(e,t,this);var r=this.getOperator()!=="=";if(r&&e.dimensions()===3&&(e=e.policy2d()),!Vn.plotInequalities&&r)return new B(e,t,this,hp());var n=Iv({policy:e,frame:t},this.asComparator());if(n.isError)return new B(e,t,this,n);if(n instanceof b.SolvedEquation&&n.getDependencies().length){var i=n.getDependencies().concat(n._symbol);if(!e.validImplicitVariables(i))return new B(e,t,this,Qo().setDependencies(i))}return this.getGraphMode(e,n)===8&&!e.validImplicitVariables(n.getDependencies())?new B(e,t,this,Qo().setDependencies(n.getDependencies())):new B(e,t,this,n)};b.DoubleInequality.prototype.analyze=function(e,t){if(Zr(this))return jr(e,t,this);if(!Vn.plotInequalities)return new B(e,t,this,hp());var r=this.tryGetConcreteTree(e,t);if(r.isError)return new B(e,t,this,r);var n=r.getDependencies();return en[this._operators[0]].direction!==en[this._operators[1]].direction?new B(e,t,this,xg()):e.validDoubleInequalitySymbol(r._symbol)?e.validDoubleInequalityVariables(n)?n.length>2?new B(e,t,this,Ct(this.getSliderVariables(e,r)).setDependencies(n)):r._expressions[0].getDependencies().indexOf(r._symbol)!==-1||r._expressions[1].getDependencies().indexOf(r._symbol)!==-1?new B(e,t,this,xp().setDependencies(n)):new B(e,t,this,r):new B(e,t,this,bp().setDependencies(n)):new B(e,t,this,bp().setDependencies(n))};b.And.prototype.analyze=function(e,t){if(Zr(this))return jr(e,t,this);var r=this.tryGetConcreteTree(e,t);if(r.isError)return new B(e,t,this,r);var n=r.getDependencies();return n.length?e.validDoubleInequalityVariables(n)?new B(e,t,this,xp().setDependencies(n)):new B(e,t,this,Ct(this.getSliderVariables(e,r)).setDependencies(n)):new B(e,t,this,r)};b.ParenSeq.prototype.analyze=function(e,t,r){if(Zr(this))return jr(e,t,this);var n=this.tryGetConcreteTree(e,t);if(n.isError)return new B(e,t,this,n);var i=this.getMoveStrategy(e,t,n,r,this.userData);if(i){var s=this.getDefaultDragMode(i),o=n.asCompilerValue(),a=[new b.Constant(o[0]),new b.Constant(o[1])];return new B(e,t,this,new b.MovablePoint(a,i,s))}return gd(e,t,this,n)};function Pw(e,t){return e.filter(function(r){return!t[r]})}function Iw(e){for(var t={},r=0;r<e.length;r++){var n=e[r];if(n instanceof ia&&n.header instanceof b.Identifier){var i=n.header._symbol;t[i]===void 0&&(t[i]=0),t[i]+=1}}return t}b.Table.prototype.analyze=function(e,t){var r=Object.create(t),n=[],i=Iw(this.columns),s;for(s=0;s<this.columns.length;s++){var o=this.columns[s];if(o instanceof ia&&o.header instanceof b.Identifier){var a=o.header._symbol,u=r[a],l=i[a]>1;u&&u.isError&&(u.isTableCycleWithoutGlobalDefinition||u.isMultiplyDefinedByTables&&!l)&&(r[a]=void 0)}var c=o.analyze(e,r);if(s===0&&c.concreteTree.isIndependent){var p=c.concreteTree.getDependencies()[0];e.validFirstColumnVariable(p)||(c=new B(e,t,o,Pg()))}if(c.concreteTree.isIndependent)c.rawTree.exportToLocal(c.concreteTree,r);else if(!c.concreteTree.isError){var f=c.concreteTree.header.getDependencies(),m=Pw(f,r);m.length&&(c=new B(e,t,o,Ct(m).setDependencies(m)))}n.push(c.concreteTree)}var d=1;for(s=0;s<n.length;s++)n[s].isError||(d=Math.max(n[s].values.length,d));for(s=0;s<n.length;s++)if(!n[s].isError&&n[s].header.isConstant){for(var y=[],g=0;g<d;g++)y.push(n[s].header);n[s]=new b.TableColumn(n[s].header,y)}var h=new b.Table(n),P=new B(e,t,this,h);return P.evaluationState.is_graphable=!0,P};b.TableColumn.prototype.analyze=function(e,t){var r=this.header.tableError();if(r)return new B(e,t,this,Tg(r));var n=this.tryGetConcreteTree(e,t);if(n.isError)return new B(e,t,this,n);if(n.header.isError)return new B(e,t,this,n.header);if(n.values.isError)return new B(e,t,this,n.values);for(var i=0;i<n.values.length;i++)if(!n.values[i].isError){var s=this.values[i]&&this.values[i].tableError();if(s){n.values[i]=qa(s);continue}var o=n.values[i].getDependencies();o.length&&(n.values[i]=Ct(o).setDependencies(o))}return new B(e,t,this,n)};b.Image.prototype.analyze=function(e,t,r){var n=this.tryGetConcreteTree(e,t);if(n.radianAngle.isError||n.center.isError||n.width.isError||n.height.isError||n.opacity.isError)return new B(e,t,this,n);var i=n.center.getDependencies(),s=n.radianAngle.getDependencies(),o=n.width.getDependencies(),a=n.height.getDependencies(),u=n.opacity.getDependencies();return i.length||s.length||o.length||a.length||u.length?new B(e,t,this,new b.Image({center:i.length?Ct(s).setDependencies(i):n.center,radianAngle:s.length?Ct(s).setDependencies(s):n.radianAngle,width:o.length?Ct(o).setDependencies(o):n.width,height:a.length?Ct(a).setDependencies(a):n.height,opacity:u.length?Ct(u).setDependencies(u):n.opacity})):(n.moveStrategy=this.getMoveStrategy(e,t,n,r,this.userData),new B(e,t,this,n))};b.Slider.prototype.analyze=function(e,t){if(Zr(this))return jr(e,t,this);var r=this.tryGetConcreteTree(e,t),n=r.sliderInfo,i;if(n.missingVars.length){var s=zo(n.missingVars);i=new B(e,t,this,Ct(e.sliderVariables(s)).setDependencies(s).allowExport())}else i=new B(e,t,this,r);var o=i.evaluationState;if(Vn.sliders){o.assignment=n.exportedSymbol,o.slider_min_number=n.values.min,o.slider_max_number=n.values.max,o.slider_step_number=n.values.step,o.slider_min_valid=n.valids.min,o.slider_max_valid=n.valids.max,o.slider_step_valid=n.valids.step;var a=o.slider_min_valid&&o.slider_max_valid&&o.slider_step_valid;o.is_slider=!0,o.raw_slider_latex=this.getInputString(),o.is_slidable=a,o.is_animatable=o.is_slidable&&!o.is_graphable,n.errMsg&&(o.error=n.errMsg.getError())}return delete o.is_evaluable,delete o.zero_values,i};function Zr(e){return"latex"in e.userData&&fs(e.userData.latex).slice(-1)==="="}function jr(e,t,r){return new B(e,t,r,qu("="))}function Mx(e){return e.concreteTree.isConstant&&e.concreteTree.valueType===x}b.Base.prototype.analyzeFourFunction=function(e,t){var r=this.tryGetConcreteTree(e,t);return r.isError?new B(e,t,this,r):new B(e,t,this,Ce())};b.Expression.prototype.analyzeFourFunction=function(e,t){var r=this.tryGetConcreteTree(e,t);if(r.isError)return new B(e,t,this,r);var n=r.getDependencies();if(n.length>0){var i=n[0],s,o=Se[i];return o?s=o.isFunction?Hn(i):Ko(i):s=Xu(i),new B(e,t,this,s)}return new B(e,t,this,r)};b.Assignment.prototype.analyzeFourFunction=function(e,t){return new B(e,t,this,Zu())};b.FunctionDefinition.prototype.analyzeFourFunction=function(e,t){return new B(e,t,this,ju())};b.Equation.prototype.analyzeFourFunction=function(e,t){return new B(e,t,this,qs())};function Ex(e,t){return new B(e,t,this,ea())}b.And.prototype.analyzeFourFunction=Ex;b.DoubleInequality.prototype.analyzeFourFunction=Ex;b.BaseComparator.prototype.analyzeFourFunction=Ex;b.Regression.prototype.analyzeFourFunction=function(e,t){return new B(e,t,this,ta())};b.ParenSeq.prototype.analyzeFourFunction=function(e,t){return new B(e,t,this,ra())};b.Base.prototype.analyzeScientific=function(e,t){var r=this.tryGetConcreteTree(e,t);return r.isError?new B(e,t,this,r):new B(e,t,this,Ce())};b.Expression.prototype.analyzeScientific=function(e,t){var r=this.tryGetConcreteTree(e,t);if(r.isError)return new B(e,t,this,r);var n=r.getDependencies();return n.length>0?new B(e,t,this,Ct(n)):new B(e,t,this,r)};b.Assignment.prototype.analyzeScientific=function(e,t){var r=this._symbol;if(Se[r])return new B(e,t,this,Ga(r));var n=Object.create(t);n[r]=qs();var i=this.tryGetConcreteTree(e,n);if(i.isError)return new B(e,t,this,i);var s=i.getDependencies();return this.isEquation(i)?new B(e,t,this,qs()):s.length>0?new B(e,t,this,Ct(s)):new B(e,t,this,i)};b.FunctionDefinition.prototype.analyzeScientific=function(e,t){if(Se[this._symbol])return new B(e,t,this,Ga(this._symbol));var r=this.tryGetConcreteTree(e,t);if(r.isError)return new B(e,t,this,r);var n=this._argSymbols,i=r.getDependencies();if(i.indexOf(this._symbol)!==-1)return new B(e,t,this,ku(this._symbol));var s=i.filter(function(o){return n.indexOf(o)===-1});return s.length?new B(e,t,this,Uu(s,this._symbol,n)):new B(e,t,this,r)};b.Equation.prototype.analyzeScientific=function(e,t){return new B(e,t,this,qs())};function vx(e,t){return new B(e,t,this,ea())}b.And.prototype.analyzeScientific=vx;b.DoubleInequality.prototype.analyzeScientific=vx;b.BaseComparator.prototype.analyzeScientific=vx;b.Regression.prototype.analyzeScientific=function(e,t){return new B(e,t,this,ta())};b.ParenSeq.prototype.analyzeScientific=function(e,t){return new B(e,t,this,ra())};b.Base.prototype.analyzeSingleExpressionScientific=function(e,t){var r=this.tryGetConcreteTree(e,t);return r.isError?new B(e,t,this,r):new B(e,t,this,Ce())};b.Expression.prototype.analyzeSingleExpressionScientific=function(e,t){var r=this.tryGetConcreteTree(e,t);if(r.isError)return new B(e,t,this,r);var n=r.getDependencies();if(n.length>0){var i=n[0],s,o=Se[i];return o?s=o.isFunction?Hn(i):Ko(i):s=Xu(i),new B(e,t,this,s)}return new B(e,t,this,r)};b.Assignment.prototype.analyzeSingleExpressionScientific=function(e,t){return new B(e,t,this,Zu())};b.FunctionDefinition.prototype.analyzeSingleExpressionScientific=function(e,t){return new B(e,t,this,ju())};b.Equation.prototype.analyzeSingleExpressionScientific=function(e,t){return new B(e,t,this,qs())};function Ox(e,t){return new B(e,t,this,ea())}b.And.prototype.analyzeSingleExpressionScientific=Ox;b.DoubleInequality.prototype.analyzeSingleExpressionScientific=Ox;b.BaseComparator.prototype.analyzeSingleExpressionScientific=Ox;b.Regression.prototype.analyzeSingleExpressionScientific=function(e,t){return new B(e,t,this,ta())};b.ParenSeq.prototype.analyzeSingleExpressionScientific=function(e,t){return new B(e,t,this,ra())};function Mw(e){return!e||e[0].type==="none"&&e[1].type==="none"?"NONE":e[1].type==="none"?"X":e[0].type==="none"?"Y":"XY"}function Xv(e,t){var r=Mw(t);switch(e){case"NONE":return"NONE";case"AUTO":return r;case"XY":return r;case"X":return r==="X"||r==="XY"?"X":"NONE";case"Y":return r==="Y"||r==="XY"?"Y":"NONE";default:return"NONE"}}b.Base.prototype.getGraphMode=function(e,t){return 10};function Ew(e,t){var r;return e&&e.hasOwnProperty("dragMode")?e.dragMode==="AUTO"?r=t.defaultDragMode:r=e.dragMode:r=t.defaultDragMode,Xv(r,t.moveStrategy)}function Zv(e,t){let r=e.dimensions()===3;if(t.isMovablePoint&&!r&&Ew(this.userData,t)!=="NONE")return 4;var n=t.getDependencies();switch(t.valueType){case Gr:case G:if(r){if(n.length===0)return 37;if(e.validParametricVariables(n))return n.length==1?24:27}return 10;case tr:case zr:return r?42:10;case mr:case qr:return r?40:10;case yr:case kr:return r?41:10;case A:case Be:return n.length===0?3:e.validParametricVariables(n)?5:10;case x:case Z:if(e.dimensions()===2&&n.length===1)return 2;if(e.dimensions()===3){if(n.length===2&&(n.indexOf("x")>-1||n.indexOf("y")>-1))return 30;if(n.length===1&&n[0]==="x")return 44}return 10;case Te:case er:return 16;case ie:case cr:return 20;case ee:case pr:return 21;case pe:case $t:return 17;case ne:case fr:return 18;case Pe:case dr:return 19;case de:case Lt:case oe:case wt:return 23;default:return 10}}b.Expression.prototype.getGraphMode=Zv;function jv(e,t){var r=t._expression.getDependencies();if(r.length>1)return 10;if(t._expression.isList&&t._expression.length===0)return 10;var n=t._symbol;return e.graphMode(n,r)}b.Equation.prototype.getGraphMode=b.BaseComparator.prototype.getGraphMode=function(e,t){var r=t.getDependencies();return e.dimensions()===3&&r.length>0&&this.type==="Equation"?r.indexOf("z")>-1?36:47:t.isConstant?10:t instanceof b.SolvedEquation?r.length===0?e.graphableAsConstant(t._symbol)?e.constantGraphMode(t._symbol):10:jv(e,t):r.length===1||r.length===2?8:10};b.DoubleInequality.prototype.getGraphMode=function(e,t){return e.constantGraphMode(t._symbol)};b.Assignment.prototype.getGraphMode=function(e,t){if(t instanceof b.SolvedEquation)return jv(e,t);if(this.isEquation(t))return this.asEquation().getGraphMode(e,t);var r=t.getDependencies();let n=this._symbol,i=this.userData&&this.userData.polarCoordinateSystem?this.userData.polarCoordinateSystem:"";switch(t.valueType){case x:case Z:case Me:switch(r.length){case 0:return e.graphableAsConstant(n)?e.constantGraphMode(n,{polarCoordinateSystem:i}):10;case 1:return t.valueType===Z&&!e.graphableListVariables(n,r[0])?10:this.isSlider?10:e.graphMode(n,r,{polarCoordinateSystem:i});default:return e.dimensions()===3?e.graphMode(n,r,{polarCoordinateSystem:i}):10}case G:if(e.assignmentForbidden(n)||r.length>0&&!e.validParametricVariables(r))return 10;switch(r.length){case 0:return 37;case 1:return 24;case 2:return 27;default:return 10}default:return Zv.call(this,e,t)}};b.CoordinateEquation.prototype.getGraphMode=function(e,t){var r=t.getDependencies();let n=this._concatenatedSymbol;if(t.valueType!==G)return 10;if(r.length>0&&!e.validParametricVariables(r))return 10;switch(r.length){case 0:switch(n){case"rthetaphi":return 39;case"rthetaz":return 38;default:return 10}case 1:switch(n){case"rthetaphi":return 26;case"rthetaz":return 25;default:return 10}case 2:switch(n){case"rthetaphi":return 29;case"rthetaz":return 28;default:return 10}default:return 10}};b.FunctionDefinition.prototype.getGraphMode=function(e,t){if(this._argSymbols.length!==1)return 10;let r=this.userData&&this.userData.polarCoordinateSystem?this.userData.polarCoordinateSystem:"";var n=e.graphMode(this._symbol,this._argSymbols,{polarCoordinateSystem:r}),i=t.getDependencies();switch(t.valueType){case x:case Z:switch(i.length){case 0:return n;case 1:return i[0]!==this._argSymbols[0]?10:n;default:return 10}break;default:return 10}};b.Regression.prototype.getGraphMode=function(e,t){return this.isLhsSimple?t.isModelValid?t.model.getDependencies().length!==1?10:2:10:10};function Dx(e,t){return t.isError?10:11}b.Histogram.prototype.getGraphMode=Dx;b.DotPlot.prototype.getGraphMode=Dx;b.BoxPlot.prototype.getGraphMode=Dx;b.Image.prototype.getGraphMode=function(e,t){return this.userData.showPoints?this.center.isError||this.radianAngle.isError||this.width.isError||this.height.isError||this.opacity.isError?10:3:10};var Aw={};ui(Aw,{colors:()=>Dw,getDisplayColor:()=>As,invertColor:()=>Ow,isValidHexColor:()=>Td,mutateOpacity:()=>Nw,normalizeColor:()=>Ax,parseHex:()=>Sw,shadeColor:()=>vw});function Ax(e){return Td(e)?(e.match(/^#([A-Fa-f0-9]{3})$/g)&&(e="#"+e[1]+e[1]+e[2]+e[2]+e[3]+e[3]),e.toLowerCase()):e}function Td(e){return typeof e=="string"&&(e.match(/^#([A-Fa-f0-9]{3})$/g)||e.match(/^#([A-Fa-f0-9]{6})$/g))}function vw(e,t){if(e=Ax(e),!Td(e))return e;t>1&&(t=1),t<-1&&(t=-1);var r=parseInt(e.slice(1),16),n=t<0?0:255,i=t<0?t*-1:t,s=r>>16,o=r>>8&255,a=r&255;return"#"+(16777216+(Math.round((n-s)*i)+s)*65536+(Math.round((n-o)*i)+o)*256+(Math.round((n-a)*i)+a)).toString(16).slice(1)}function Ow(e){if(e=Ax(e),!Td(e))return e;let t="0123456789abcdef";return"#"+e.slice(1).split("").map(r=>t[15-t.indexOf(r)]).join("")}function Sw(e){if(e=e.replace(/#/,""),e.length===3)var t=parseInt(e.slice(0,1)+e.slice(0,1),16),r=parseInt(e.slice(1,2)+e.slice(1,2),16),n=parseInt(e.slice(2,3)+e.slice(2,3),16);else if(e.length===6)var t=parseInt(e.slice(0,2),16),r=parseInt(e.slice(2,4),16),n=parseInt(e.slice(4,6),16);else var t=0,r=0,n=0;return{r:t,g:r,b:n}}function Nw(e,t){let r=/(rgba\([\d]+\,\ ?[\d]+\,\ ?[\d]+\,\ ?)[\d.]+(\))/;return e.match(r)?e.replace(r,`$1${t}$2`):e}function As(e,t){if(t&&t.colorLatexValue){var r=t.colorLatexValue;return Array.isArray(r)?r[0]:r}return e.color}var Dw={RED:"#c74440",BLUE:"#2d70b3",GREEN:"#388c46",PURPLE:"#6042a6",ORANGE:"#fa7e19",BLACK:"#000000",GRAY:"#aaaaaa"};b.Base.prototype.getGraphInfo=function(e,t){var r=t.getDependencies(),n,i;switch(r.length){case 0:n=Jv(t),i=t.boundDomain("x");break;case 1:i=t.boundDomain(r[0]),i.type==="known"&&(n=Jv(t));break;case 2:i=Wr();break}return{graphMode:this.getGraphMode(e,t),color:As(this.userData,this.metaData),pointStyle:this.userData.pointStyle,lineStyle:this.userData.lineStyle,arrowMode:this.userData.arrowMode,operator:this.getOperator(),isLinear:!!n,linearCoefficients:n,domainBound:i}};function Jv(e){switch(e.valueType){case x:return Rx(e);case A:{var t=Rx(e.elementAt(0)),r=Rx(e.elementAt(1));return!t||!r?void 0:[t,r]}default:return}}function Rx(e){var t=e.getDependencies();switch(t.length){case 0:return[+e.asValue(),0];case 1:if(e.polynomialOrder(t[0])>1)return;var r=e.getPolynomialCoefficients(t[0]);return[r[0]?+r[0].asValue():0,r[1]?+r[1].asValue():0];default:return}}var Qv=new b.Constant(he(0,1));b.Base.prototype.getMoveStrategy=function(){};b.Assignment.prototype.getMoveStrategy=function(e,t,r,n,i){return this._expression.getMoveStrategy(e,t,r,n,i)};function Rw(e){return{type:"updateSliderNonlinear",id:e.id,initialValue:e.initialValue,min:e.min,max:e.max,compiled:e.compiled,movesOn:e.movesOn,hasLinearComponent:e.hasLinearComponent}}function Cw(e){return{type:"updateGliderParameter",span:e.span,movesOn:e.movesOn}}function Lw(e){return{type:"updateSliderForGlider",id:e.sliderId,movesOn:e.movesOn,min:e.min,max:e.max}}function Kv(e,t,r,n,i,s){var o=t.getDependencies();for(let g of o)if(i[g])return;for(var a=o.length-1;a>=0;a--){var u=o[a];if(!s[u]){var l=n[u];if(l!==void 0){var c=r[u];if(c.order===1){var p=c.tree,f=p.getPolynomialCoefficients(u),m=f[1]||Qv,d=f[0]||Qv;if(!(!d.isConstant||!m.isConstant)&&!(!isFinite(d.asValue())||!isFinite(m.asValue()))&&m.asValue()!==0){var y=[-d.asValue()/m.asValue(),1/m.asValue()];return{symbol:u,id:l,coefficients:y}}}}}}}function ww(e,t){for(var r in t){var n=t[r].evaluationState,i=n.assignment;if(i===e)return r}}function _w(e){for(var t={},r=0;r<e.length;r++)t[e[r]]=!0;return t}function Cx(e,t){var r=_w(e),n={};for(var i in t){var s=t[i].evaluationState.assignment;t[i].evaluationState.is_slidable&&r[s]&&(n[s]=i)}return n}function e1(e,t,r,n){for(var i=[],s=0;s<r.length;s++){var o=r[s],a={};i.push(a);for(var u=0;u<n.length;u++){var l=n[u],c=Object.create(t);c[l]=void 0;var p=o.tryGetConcreteTree(e,c);if(p.isError){a[l]={tree:p,order:1/0};continue}else a[l]={tree:p,order:p.polynomialOrder(l)}}}return i}function t1(e,t,r){for(var n=0;n<e.length;n++){var i=e[n];t[i].order!==0&&(r[i]=!0)}}b.ParenSeq.prototype.getMoveStrategy=function(e,t,r,n,i){if(r.valueType!==A||r.getDependencies().length!==0)return;for(var s=this.getDependencies(),o=Cx(s,n),a=Object.keys(o),u=this.args,l=e1(e,t,u,a),c=[],p={},f={},m=0;m<2;m++){var d=u[m];let O=d.getInputSpan();if(d.isConstant){c[m]=O?{type:"updateCoordinate",inputSpan:O}:{type:"none"};continue}var y=Kv(e,d,l[m],o,p,f);y&&(c[m]={type:"updateSlider",id:y.id,coefficients:y.coefficients},p[y.symbol]=!0,t1(a,l[m],f)),c[m]||(c[m]={type:"none"})}let[g,h]=c,P;if(g.type==="none"&&h.type==="none"&&a.length===1&&(P=a[0]),!P)return g.type!=="none"||h.type!=="none"?c:void 0;var T=o[P],D;try{var N=Object.create(t);N[P]=void 0,D=this.getConcreteTree(e,N).getCompiledFunction()}catch(O){return}Xh(D);var I=n[T].evaluationState;return[Rw({id:T,initialValue:I.constant_value,min:I.slider_min_number,max:I.slider_max_number,compiled:D,hasLinearComponent:g.type==="updateSlider"||h.type==="updateSlider"}),{type:"none"}]};b.FunctionCall.prototype.getMoveStrategy=function(e,t,r,n,i){if(this._symbol==="glider"&&!(!r.isTypedConstant||r.valueType!==A)){var s,o,a;switch(this.args[1].type){case"Constant":{var u=this.args[1].asValue();if(typeof u!="number"||(s=this.args[0].getConcreteTree(e,t),!s.isTypedConstant))return;a=s.asTypedValue();let d=this.args[1].getInputSpan();return[d?Cw({span:d,movesOn:a}):{type:"none"},{type:"none"}]}case"Identifier":{var l=this.args[1]._symbol,c=Cx([l],n),p=c[l];if(p===void 0)return;var f=n[p].evaluationState,m=Object.create(t);return m[l]=void 0,s=this.args[0].getConcreteTree(e,m),s.isTypedConstant?(a=s.asTypedValue(),o={min:f.slider_min_number,max:f.slider_max_number},[Lw({min:o.min,max:o.max,movesOn:a,sliderId:p}),{type:"none"}]):void 0}default:return}}};b.Image.prototype.getMoveStrategy=function(e,t,r,n,i){if(!(r.center.valueType!==A||r.center.getDependencies().length!==0||!r.width.isConstant||!r.height.isConstant||!r.radianAngle.isConstant||!r.opacity.isConstant)){var s=this.getDependencies(),o=Cx(s,n),a=Object.keys(o),u=[this.width,this.height];this.center.type==="ParenSeq"?u.push(this.center.args[0],this.center.args[1]):this.center.type==="Identifier"&&(this.center.referencedStatementId=ww(this.center._symbol,n));for(var l={},c={},p=e1(e,t,u,a),f=[],m=[2,3,0,1],d=0;d<m.length;d++){var y=m[d],g=u[y];if(!g){f[y]={type:"none"};continue}if(g.isConstant){let P=g.getInputSpan();f[y]=P?{type:"updateCoordinate",inputSpan:P}:{type:"none"};continue}var h=Kv(e,g,p[y],o,l,c);h&&(f[y]={type:"updateSlider",id:h.id,coefficients:h.coefficients},l[h.symbol]=!0,t1(a,p[y],c)),f[y]||(f[y]={type:"none"})}if(!(f[0].type==="none"&&f[1].type==="none"&&f[2].type==="none"&&f[3].type==="none"))return f}};b.Base.prototype.getDefaultDragMode=function(e){return"NONE"};b.Assignment.prototype.getDefaultDragMode=function(e){return e[0].type!=="none"&&e[1].type!=="none"?"XY":e[0].type!=="none"?"X":e[1].type!=="none"?"Y":"NONE"};b.ParenSeq.prototype.getDefaultDragMode=function(e){return e[0].type==="updateSlider"&&e[1].type==="updateSlider"?"XY":e[0].type==="updateSlider"?"X":e[1].type==="updateSlider"?"Y":e[0].type==="updateSliderNonlinear"&&e[0].hasLinearComponent?"X":"NONE"};b.FunctionCall.prototype.getDefaultDragMode=function(e){return this._symbol!=="glider"?"NONE":b.Assignment.prototype.getDefaultDragMode.call(this,e)};var Fw=b.List;b.Base.prototype.tableInfo=function(e,t){return!1};b.Identifier.prototype.tableInfo=function(e,t){return e.validFirstColumnVariable(this._symbol)?{independent_variable:this._symbol,dependent_column:this.getInputString(),by_reference:!1}:!1};b.Expression.prototype.tableInfo=function(e,t){var r=t.getDependencies();if(xo(this))return!1;switch(t.valueType){case A:case Be:if(r.length!==0||t.isMovablePoint&&(t.moveStrategy[0].type==="updateSlider"||t.moveStrategy[1].type==="updateSlider"))return!1;var n=Fw.wrap(t).asValue();return{independent_variable:"x",dependent_column:"y",by_reference:!1,values:n};case x:if(r.length!==1)return!1;var i=r[0];return e.validFirstColumnVariable(i)?{independent_variable:i,dependent_column:this.getInputString(),by_reference:!1}:!1;default:return!1}};b.Assignment.prototype.tableInfo=function(e,t){if(t instanceof b.SolvedEquation||!this.getInputString().length||xo(this))return!1;var r=t.getDependencies();if(r.length>1)return!1;var n;if(r.length===0){if(!e.tableableAsConstant(this._symbol))return!1;n=e.implicitIndependent(this._symbol)}else n=r[0];if(!e.validFirstColumnVariable(n))return!1;var i=e.assignmentForbidden(this._symbol)?fs(this.getInputString().replace(/[^=]*=/,"")):fs(this.getInputString().split("=")[0]);return{independent_variable:n,dependent_column:i,by_reference:!e.assignmentForbidden(this._symbol)}};b.FunctionDefinition.prototype.tableInfo=function(e,t){if(this._argSymbols.length!==1||!this.getInputString().length)return!1;var r=t.getDependencies();if(r.length>1)return!1;var n=this._argSymbols[0];if(!e.validFirstColumnVariable(n))return!1;var i=e.assignmentForbidden(this._symbol),s=i?fs(this.getInputString().replace(/[^=]*=/,"")):fs(this.getInputString().split("=")[0]);return{independent_variable:n,dependent_column:s,by_reference:!i}};b.BaseComparator.prototype.tableInfo=function(e,t){return!1};b.DoubleInequality.prototype.tableInfo=function(e,t){return!1};b.Equation.prototype.tableInfo=function(e,t){return!1};b.Base.prototype.tableError=function(){return this.isInequality()?M("shared-calculator-error-table-inequality-supplement"):!(this instanceof b.Expression)&&!(this instanceof b.IRExpression)?M("shared-calculator-error-table-generic-supplement"):!1};b.List.prototype.tableError=function(){return M("shared-calculator-error-table-list-supplement")};b.Equation.prototype.tableError=b.Assignment.prototype.tableError=function(){return M("shared-calculator-error-table-equation-supplement")};b.FunctionDefinition.prototype.tableError=function(){return M("shared-calculator-error-table-function-definition-supplement")};b.Regression.prototype.tableError=function(){return M("shared-calculator-error-table-regression-supplement")};var Xs=class{constructor(t){this.xtolerance=t.xtolerance||t.tolerance||0,this.ytolerance=t.ytolerance||t.tolerance||0,this.ztolerance=t.ztolerance||t.tolerance||0,this.map=t.map,this.segments=[],this.segment=[],this.pivotPoint=void 0,this.pendingPoint=void 0}colinear(t,r,n){this.map&&(t=this.map(t),r=this.map(r),n=this.map(n));var i=wi(n[0],n[1],n[2]||0,t[0],t[1],t[2]||0,r[0],r[1],r[2]||0);if(i<1)return!1;var s=[t[0]+i*(r[0]-t[0]),t[1]+i*(r[1]-t[1]),t.length===3?t[2]+i*(r[2]-t[2]):0];return Math.abs(n[0]-s[0])<=this.xtolerance&&Math.abs(n[1]-s[1])<=this.ytolerance&&(t.length===2||Math.abs(n[2]-s[2])<=this.ztolerance)}addPoint(t){if(this.dimensions=t.length,this.xtolerance<0&&this.ytolerance<0&&(this.dimensions===2||this.ztolerance<0)){this.segment.push.apply(this.segment,t);return}if(!this.segment.length){this.segment.push.apply(this.segment,t);return}let r=this.dimensions===2?[this.segment[this.segment.length-2],this.segment[this.segment.length-1]]:[this.segment[this.segment.length-3],this.segment[this.segment.length-2],this.segment[this.segment.length-1]];if(!(t[0]===r[0]&&t[1]===r[1]&&t[2]===r[2])){if(!this.pivotPoint||!this.pendingPoint){this.pivotPoint=t,this.pendingPoint=t;return}(!this.colinear(r,this.pivotPoint,t)||pi(r[0]-t[0],r[1]-t[1],(r[2]||0)-(t[2]||0))<pi(r[0]-this.pendingPoint[0],r[1]-this.pendingPoint[1],(r[2]||0)-(this.pendingPoint[2]||0)))&&(this.flushPending(),this.pivotPoint=t),this.pendingPoint=t}}flushPending(){this.pendingPoint&&(this.segment.push.apply(this.segment,this.pendingPoint),this.pivotPoint=void 0,this.pendingPoint=void 0)}breakSegment(){this.flushPending(),this.segment.length>(this.dimensions||2)&&this.segments.push(this.segment),this.segment=[]}getSegments(){return this.breakSegment(),this.segments}finish(){return{segments:this.getSegments(),resolved:!0}}};var n1=5,Bw=Math.pow(2,14);function i1(e,t){let r=Vw(e,t);return{segments:r.contours.strokeSegments,fillSegments:r.contours.fillSegments,resolved:r.quadTree.resolved}}function Vw(e,t){let r=Math.pow(2,-n1),n=r1(t,r),i=r1(t,2*r),s=Gw(e,n,i),o=Yw(s.root,e,n),a=Jw(o,e,n);return{paddedDomain:n,rootDomain:i,quadTree:s,triangles:o,contours:a}}function xu(e,t,r){return{x:e,y:t,z:r}}function Pd(e,t,r){return{x:e,y:t,isZero:r}}function Id(e,t,r){return{vertices:[e,t,r],visited:!1,next:void 0}}function r1(e,t){let{mathToPixels:r}=e,n=r.interpolateX(e.xmin,e.xmax,-t),i=r.interpolateX(e.xmax,e.xmin,-t),s=r.interpolateY(e.ymin,e.ymax,-t),o=r.interpolateY(e.ymax,e.ymin,-t);return ue(X({},e),{xmin:n,ymin:s,xmax:i,ymax:o})}function Cl(e,t){return{depth:e,vertices:t,children:void 0,center:void 0}}function Lx(e,t,r){e.center=s1(e.vertices[0],e.vertices[1],e.vertices[2],e.vertices[3],t,r)}function Gw(e,t,r){let n=zw(e,r),i=[],s=[];s.push(n);let o=1,a=!0;e:for(;s.length;){let u=i;i=s,s=u;let l;for(;l=i.pop();)if(kw(l,e,t)){if(qw(l,e,t),!l.children){a=!1;break e}if(s.push(l.children[0]),s.push(l.children[1]),s.push(l.children[2]),s.push(l.children[3]),o+=3,o>=Bw){a=!1;break e}}else Lx(l,e,t)}for(let u=0;u<i.length;u++)Lx(i[u],e,t);for(let u=0;u<s.length;u++)Lx(s[u],e,t);return{root:n,resolved:a}}function zw(e,t){let r=t.xmin,n=t.xmax,i=t.ymin,s=t.ymax;return Cl(0,[bu(r,s,e),bu(n,s,e),bu(n,i,e),bu(r,i,e)])}function qw(e,t,r){let n=e.depth+1,i=e.vertices[0],s=e.vertices[1],o=e.vertices[2],a=e.vertices[3],u=un(i,s,t,r),l=un(s,o,t,r),c=un(o,a,t,r),p=un(a,i,t,r),f=un(i,o,t,r);e.children=[Cl(n,[i,u,f,p]),Cl(n,[u,s,l,f]),Cl(n,[f,l,o,c]),Cl(n,[p,f,c,a])]}function kw(e,t,r){if(e.depth<n1)return!0;if(Hw(e,r)||Uw(e,r))return!1;let n=e.vertices[0],i=e.vertices[1],s=e.vertices[2],o=e.vertices[3];if(isNaN(n.z)&&isNaN(i.z)&&isNaN(s.z)&&isNaN(o.z))return!1;if(isNaN(n.z)||isNaN(i.z)||isNaN(s.z)||isNaN(o.z))return!0;let a=s1(n,i,s,o,t,r),u=Cs(n,i,t,r),l=Cs(i,s,t,r),c=Cs(s,o,t,r),p=Cs(o,n,t,r);return So(n,u,t,r)||So(i,u,t,r)||So(i,l,t,r)||So(s,l,t,r)||So(s,c,t,r)||So(o,c,t,r)||So(o,p,t,r)||So(n,p,t,r)||Oo(n,u,a,t,r)||Oo(u,i,a,t,r)||Oo(i,l,a,t,r)||Oo(l,s,a,t,r)||Oo(s,c,a,t,r)||Oo(c,o,a,t,r)||Oo(o,p,a,t,r)||Oo(p,n,a,t,r)}function Oo(e,t,r,n,i){if(e.z>0==t.z>0&&t.z>0==r.z>0)return!1;let s,o,a,u;if(e.z>0==t.z>0){if(s=un(e,t,n,i),s.z>0!=e.z>0)return!0;o=Rs(e,r,n,i),a=Rs(t,r,n,i),u=Rs(s,r,n,i)}else if(t.z>0==r.z>0){if(s=un(t,r,n,i),s.z>0!=t.z>0)return!0;o=Rs(t,e,n,i),a=Rs(r,e,n,i),u=Rs(s,e,n,i)}else{if(s=un(r,e,n,i),s.z>0!=r.z>0)return!0;o=Rs(r,t,n,i),a=Rs(e,t,n,i),u=Rs(s,t,n,i)}let{mathToPixels:l}=i,[c,p]=l.mapCoordinatePair([u.x,u.y]),[f,m]=l.mapCoordinatePair([o.x,o.y]),[d,y]=l.mapCoordinatePair([a.x,a.y]);return pT(c,p,f,m,d,y)>i.tolerance}function So(e,t,r,n){if(isNaN(e.z)&&isNaN(t.z))return!1;if(isNaN(e.z)||isNaN(t.z))return e.z>0||t.z>0;let s=4*un(e,t,r,n).z-t.z-3*e.z,o=1e-4,a=(r((1-o)*e.x+o*t.x,(1-o)*e.y+o*t.y)-e.z)/o,u=Math.max(Math.abs(e.z),Math.abs(t.z));return Math.abs(s-a)>.125*u}function Uw(e,t){let{mathToPixels:r}=t,[n,i]=r.mapCoordinatePair([e.vertices[1].x,e.vertices[1].y]),[s,o]=r.mapCoordinatePair([e.vertices[0].x,e.vertices[0].y]),[a,u]=r.mapCoordinatePair([e.vertices[3].x,e.vertices[3].y]);return Math.abs(n-s)<10*t.tolerance||Math.abs(o-u)<10*t.tolerance}function Hw(e,t){return e.vertices[0].x<t.xmin||e.vertices[0].y>t.ymax||e.vertices[2].x>t.xmax||e.vertices[2].y<t.ymin}function Tu(e,t){return e.x<t.xmin||e.x>t.xmax||e.y<t.ymin||e.y>t.ymax}function bu(e,t,r){return xu(e,t,r(e,t))}function un(e,t,r,n){let{mathToPixels:i}=n;return bu(i.interpolateX(e.x,t.x,.5),i.interpolateY(e.y,t.y,.5),r)}function Cs(e,t,r,n){if(Tu(e,n)||Tu(t,n))return un(e,t,r,n);if(isNaN(e.z)||isNaN(t.z))return $w(e,t,r,n);if(e.z>0!=t.z>0)return un(e,t,r,n);let i=.01,s=r((1-i)*e.x+i*t.x,(1-i)*e.y+i*t.y)-e.z,o=t.z-r(i*e.x+(1-i)*t.x,i*e.y+(1-i)*t.y);return isNaN(s)||isNaN(o)||s>0==o>0?un(e,t,r,n):o1(xu(e.x,e.y,s),xu(t.x,t.y,o),r,n)}function s1(e,t,r,n,i,s){let o=Cs(e,r,i,s);return e.z>0==r.z>0&&o.z>0!=e.z>0||(o=Cs(t,n,i,s),t.z>0==n.z>0&&o.z>0!=t.z>0)?o:un(e,r,i,s)}function o1(e,t,r,n){if(isNaN(e.z))return t;if(isNaN(t.z))return e;if(!isFinite(e.z)&&!isFinite(t.z))return un(e,t,r,n);if(isFinite(e.z))if(isFinite(t.z)){let i=1-e.z/t.z,s=1-t.z/e.z;return bu(e.x/i+t.x/s,e.y/i+t.y/s,r)}else return e;else return t}function Rs(e,t,r,n){let{mathToPixels:i}=n,s=e.x,o=t.x,a=e.y,u=t.y,l=e.z,c=t.z;if(Tu(e,n)||Tu(t,n)){let y=un(e,t,r,n);return Pd(y.x,y.y,!1)}let[p,f]=i.mapCoordinatePair([s,a]),[m,d]=i.mapCoordinatePair([o,u]);for(;Math.abs(p-m)>n.tolerance||Math.abs(f-d)>n.tolerance;){let y=.5*(s+o),g=.5*(a+u),h=r(y,g);h>0==l>0?(s=y,a=g,l=h):(o=y,u=g,c=h),[p,f]=i.mapCoordinatePair([s,a]),[m,d]=i.mapCoordinatePair([o,u])}if(isNaN(l))return Pd(o,u,!1);if(isNaN(c))return Pd(s,a,!1);{let y=o1(xu(s,a,l),xu(o,u,c),r,n),g=l===0||c===0||y.z===0||y.z>=l==c>=y.z&&Math.abs(y.z)<1e250;return Pd(y.x,y.y,g)}}function $w(e,t,r,n){let{mathToPixels:i}=n;if(isNaN(e.z)===isNaN(t.z))return un(e,t,r,n);if(isNaN(e.z)){let d=e;e=t,t=d}let s=e.x,o=t.x,a=e.y,u=t.y,l=e.z,[c,p]=i.mapCoordinatePair([s,a]),[f,m]=i.mapCoordinatePair([o,u]);for(;Math.abs(c-f)>n.tolerance||Math.abs(p-m)>n.tolerance;){let d=.5*(s+o),y=.5*(a+u),g=r(d,y);isNaN(g)===isNaN(l)?(s=d,a=y,l=g):(o=d,u=y),[c,p]=i.mapCoordinatePair([s,a]),[f,m]=i.mapCoordinatePair([o,u])}return xu(s,a,l)}function Yw(e,t,r){let n={triangles:[],edgeCache:{},domain:r,fn:t};return Ll(e,n),n.triangles}function Ll(e,t){e.children&&(Ll(e.children[0],t),Ll(e.children[1],t),Ll(e.children[2],t),Ll(e.children[3],t),No(e.children[0],e.children[1],t),No(e.children[3],e.children[2],t),Do(e.children[1],e.children[2],t),Do(e.children[0],e.children[3],t))}function No(e,t,r){e.children&&t.children?(No(e.children[1],t.children[0],r),No(e.children[2],t.children[3],r)):e.children?(No(e.children[1],t,r),No(e.children[2],t,r)):t.children?(No(e,t.children[0],r),No(e,t.children[3],r)):Ww(e,t,r)}function Do(e,t,r){e.children&&t.children?(Do(e.children[2],t.children[1],r),Do(e.children[3],t.children[0],r)):e.children?(Do(e.children[2],t,r),Do(e.children[3],t,r)):t.children?(Do(e,t.children[1],r),Do(e,t.children[0],r)):Xw(e,t,r)}function Ww(e,t,r){if(!e.center||!t.center)return;let n,i;e.depth>=t.depth?(n=Cs(e.vertices[1],e.vertices[2],r.fn,r.domain),i=vd(e.vertices[1],t.center,e.vertices[2],e.center,n)):(n=Cs(t.vertices[0],t.vertices[3],r.fn,r.domain),i=vd(t.vertices[0],t.center,t.vertices[3],e.center,n)),a1(i,r.edgeCache,r.domain);for(let s=0;s<4;s++)r.triangles.push(i[s])}function Xw(e,t,r){if(!e.center||!t.center)return;let n,i;e.depth>=t.depth?(n=Cs(e.vertices[3],e.vertices[2],r.fn,r.domain),i=vd(e.vertices[2],t.center,e.vertices[3],e.center,n)):(n=Cs(t.vertices[1],t.vertices[0],r.fn,r.domain),i=vd(t.vertices[1],t.center,t.vertices[0],e.center,n)),a1(i,r.edgeCache,r.domain);for(let s=0;s<4;s++)r.triangles.push(i[s])}function vd(e,t,r,n,i){return[Id(e,i,t),Id(t,i,r),Id(r,i,n),Id(n,i,e)]}function wl(e,t,r){return e.z>0&&!Tu(e,r)&&(!(t.z>0)||Tu(t,r))}function Md(e,t){return""+e.x+","+e.y+","+t.x+","+t.y}function a1(e,t,r){Ed(e[0],e[1],e[2],Md(e[1].vertices[2],e[1].vertices[0]),t,r),Ed(e[1],e[2],e[3],Md(e[2].vertices[0],e[2].vertices[2]),t,r),Ed(e[2],e[3],e[0],Md(e[3].vertices[2],e[3].vertices[0]),t,r),Ed(e[3],e[0],e[1],Md(e[0].vertices[0],e[0].vertices[2]),t,r)}function Ed(e,t,r,n,i,s){let o=t.vertices[0],a=t.vertices[1],u=t.vertices[2];wl(a,u,s)&&(t.next=r),wl(o,a,s)&&(t.next=e),wl(u,o,s)&&jw(t,n,i),wl(o,u,s)&&Zw(t,n,i)}function Zw(e,t,r){r[t]?r[t].next=e:r[t]=e}function jw(e,t,r){r[t]?e.next=r[t]:r[t]=e}function Jw(e,t,r){let{tolerance:n,mathToPixels:i}=r,s={tolerance:n,map:a=>i.mapCoordinatePair(a)},o={fillAccumulator:new Xs(s),strokeAccumulator:new Xs(s),fn:t,domain:r};for(let a=0;a<e.length;a++){let u=e[a];u.next&&!u.visited&&Qw(u,o)}return{strokeSegments:o.strokeAccumulator.finish().segments,fillSegments:o.fillAccumulator.finish().segments}}function Qw(e,t){for(;;){let r=e.vertices[0],n=e.vertices[1],i=e.vertices[2];if(wx(r,n,t),wx(n,i,t),wx(i,r,t),e.visited||!e.next)break;e.visited=!0,e=e.next}t.strokeAccumulator.breakSegment(),t.fillAccumulator.breakSegment()}function wx(e,t,r){if(wl(e,t,r.domain)){let n=Rs(e,t,r.fn,r.domain);r.fillAccumulator.addPoint([n.x,n.y]),n.isZero?r.strokeAccumulator.addPoint([n.x,n.y]):r.strokeAccumulator.breakSegment()}}function _x(e){return Math.abs(e)<5e-8}var _l=class extends Xs{constructor(r,n,i){let{tolerance:s,mathToPixels:o}=r;super({tolerance:s,map:a=>o.mapCoordinatePair(a)});this.fn=n,this.mappedFn=a=>o.mapY(n(a)),this.derivative=i,this.poiData={zeros:{x:[],y:[]},intercept:{x:[],y:[]},extrema:{x:[],y:[]}},this.zeroBuffer=[],this.extremumBuffer=[]}getPOI(){return Vn.pointsOfInterest?(this.poiData.intercept=this.findIntercept(this.fn),this.poiData):{zeros:{x:[],y:[]},intercept:{x:[],y:[]},extrema:{x:[],y:[]}}}addPoint(r){this.segment.length===0&&_x(r[1])&&(this.poiData.zeros.x.push(r[0]),this.poiData.zeros.y.push(r[1])),this.updateZeroBuffer(r),this.updateExtremumBuffer(r),super.addPoint(r)}updateZeroBuffer(r){let[n,i]=this.map?this.map(r):r;if(!isFinite(n)||!isFinite(i)){this.zeroBuffer.length=0;return}switch(this.zeroBuffer.length){case 0:{if(_x(r[1]))return;this.zeroBuffer.push(r);return}case 1:if(r[1]===0){this.zeroBuffer.push(r);return}else if(r[1]>0!=this.zeroBuffer[0][1]>0){let s=mh(this.zeroBuffer[0][0],this.zeroBuffer[0][1],r[0],r[1],this.fn);s&&(this.poiData.zeros.x.push(s[0]),this.poiData.zeros.y.push(s[1])),this.zeroBuffer.length=0,this.zeroBuffer.push(r);return}else{this.zeroBuffer.length=0,this.zeroBuffer.push(r);return}case 2:{if(r[1]===0)return;if(r[1]>0!=this.zeroBuffer[0][1]>0){let s=il(this.zeroBuffer[0][0],this.zeroBuffer[0][1],this.zeroBuffer[1][0],this.zeroBuffer[1][1],r[0],r[1],this.fn);s&&(this.poiData.zeros.x.push(s[0]),this.poiData.zeros.y.push(s[1])),this.zeroBuffer.length=0,this.zeroBuffer.push(r);return}else{this.zeroBuffer.length=0,this.zeroBuffer.push(r);return}}}}updateExtremumBuffer(r){let[n,i]=this.map?this.map(r):r;if(!isFinite(n)||!isFinite(i)){this.extremumBuffer.length=0;return}switch(this.extremumBuffer.length){case 0:{this.extremumBuffer.push(r);return}case 1:{r[1]===this.extremumBuffer[0][1]&&(this.extremumBuffer.length=0),this.extremumBuffer.push(r);return}case 2:if(r[1]===this.extremumBuffer[1][1]){this.extremumBuffer.push(r);return}else if(r[1]>this.extremumBuffer[1][1]!=this.extremumBuffer[1][1]>this.extremumBuffer[0][1]){let s=this.bisectExtremumUsingDerivative(this.extremumBuffer[0][0],this.extremumBuffer[0][1],this.extremumBuffer[1][0],this.extremumBuffer[1][1],r[0],r[1]);s&&(this.poiData.extrema.x.push(s[0]),this.poiData.extrema.y.push(s[1]),!Ya(this.extremumBuffer[0][0],this.mappedFn(this.extremumBuffer[0][0]),s[0],this.mappedFn(s[0]),r[0],this.mappedFn(r[0]),this.mappedFn,this.ytolerance)&&s[0]>this.segment[this.segment.length-2]&&(this.pendingPoint=s)),this.extremumBuffer.shift(),this.extremumBuffer.push(r);return}else{this.extremumBuffer.shift(),this.extremumBuffer.push(r);return}case 3:{if(r[1]===this.extremumBuffer[1][1])return;if(r[1]>this.extremumBuffer[1][1]!=this.extremumBuffer[1][1]>this.extremumBuffer[0][1]){let s,o=.5*(this.extremumBuffer[1][0]+this.extremumBuffer[2][0]),a=this.fn(o);a===this.extremumBuffer[1][1]?s=il(this.extremumBuffer[0][0],this.extremumBuffer[0][1],this.extremumBuffer[1][0],this.extremumBuffer[1][1],r[0],r[1],this.fn):s=this.bisectExtremumUsingDerivative(this.extremumBuffer[1][0],this.extremumBuffer[1][1],o,a,this.extremumBuffer[2][0],this.extremumBuffer[2][1]),s&&(this.poiData.extrema.x.push(s[0]),this.poiData.extrema.y.push(s[1])),this.extremumBuffer.shift(),this.extremumBuffer.shift(),this.extremumBuffer.push(r);return}else{this.extremumBuffer.shift(),this.extremumBuffer.shift(),this.extremumBuffer.push(r);return}}}}bisectExtremumUsingDerivative(r,n,i,s,o,a){let u;if(this.derivative){let l=this.derivative(r),c=this.derivative(o);if(!isNaN(l)&&!isNaN(c)&&(s>n&&l>0&&c<0||s<n&&l<0&&c>0)){let p=mh(r,l,o,c,this.derivative);p&&(u=[p[0],this.fn(p[0])])}}return u||(u=qP(r,n,i,s,o,a,this.fn)),u}breakSegment(){this.zeroBuffer.length=0,this.extremumBuffer.length=0,this.flushPending(),this.segment.length>2&&(this.segments.push(this.segment),_x(this.segment[this.segment.length-1])&&(this.poiData.zeros.x.push(this.segment[this.segment.length-2]),this.poiData.zeros.y.push(this.segment[this.segment.length-1]))),this.segment=[]}findIntercept(r){if(!r)return{x:[],y:[]};let n=r(0);return isFinite(n)?{x:[0],y:[r(0)]}:{x:[],y:[]}}finish(){return{segments:this.getSegments(),resolved:!0,poi:this.getPOI()}}};var Kw=e=>{for(var t=[],r=[],n=e.length,i=0;i<n;i++)t.push(e[i][0]),r.push(e[i][1]);return{defined:{x:t,y:r}}},Ni=Kw;var{sin:e_,cos:t_}=Math,Jt=class{constructor(t=0,r=0,n=0){this.x=t;this.y=r;this.z=n}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}clone(){return new Jt(this.x,this.y,this.z)}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}isZero(){return this.x===0&&this.y===0&&this.z===0}isFinite(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.z)}subVectors(t,r){return this.x=t.x-r.x,this.y=t.y-r.y,this.z=t.z-r.z,this}addVectors(t,r){return this.x=t.x+r.x,this.y=t.y+r.y,this.z=t.z+r.z,this}multiply(t){return this.x*=t,this.y*=t,this.z*=t,this}magnitude(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}normalize(){return this.multiply(1/this.magnitude()),this}cross(t){return this.crossVectors(this,t)}crossVectors(t,r){let n=t.x,i=t.y,s=t.z,o=r.x,a=r.y,u=r.z;return this.x=i*u-s*a,this.y=s*o-n*u,this.z=n*a-i*o,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}rotateAroundAxis(t,r){let n=r_(t,r);return new Jt(n[0]*this.x+n[1]*this.y+n[2]*this.z,n[3]*this.x+n[4]*this.y+n[5]*this.z,n[6]*this.x+n[7]*this.y+n[8]*this.z)}};function r_(e,t){let r=e.x,n=e.y,i=e.z,s=e_(t),o=t_(t),a=1-o;return[a*r*r+o,a*r*n+s*i,a*r*i-s*n,a*n*r-s*i,a*n*n+o,a*n*i+s*r,a*i*r+s*n,a*i*n-s*r,a*i*i+o]}var sr=class{constructor(t,r){this.min=t;this.max=r}get width(){return this.max-this.min}};var{abs:rs,log10:u1,floor:Fx}=Math;function l1(e,t,r,n,i=0,s,o){if(s==0)return{x:Di(t,0),y:Di(r,0),z:Di(n,0)};if(o==0)return{x:Di(t,1),y:Di(r,1),z:Di(n,1)};var a=0,u=0,l=1,c=s,p=o;for(let m=0;m<=15&&!(rs(p/c)<Sa||rs(c/p)<Sa);m++){let d=u-(l-u)*c/(p-c),y=t.min+t.width*d,g=r.min+r.width*d,h=n.min+n.width*d,P=e(y,g,h);if(isNaN(P))return;P*c>0?(u=d,c=P):(l=d,p=P);let T=d-a;if(a=d,rs(T)<i||rs(T)<a*Sa||P==0)return i!=0?{x:t.min+t.width*a,y:r.min+r.width*a,z:n.min+n.width*a}:{x:Di(t,a),y:Di(r,a),z:Di(n,a)}}var f=c<0?l-u:u-l;a=c<0?u:l;for(let m=0;m<52;m++){f*=.5;let d=a+f,y=t.min+t.width*d,g=r.min+r.width*d,h=n.min+n.width*d,P=e(y,g,h);if(isNaN(P))return;if(P<=0&&(a=d),rs(f)<i||rs(f)<a*Sa||P==0)break}return{x:Di(t,a),y:Di(r,a),z:Di(n,a)}}function Di(e,t){let r=e.min+e.width*t,n=(rs(e.min)+rs(e.max))*Sa/2;return rs(r)<=n?0:n_(r,Fx(u1(rs(r)/n)))}function n_(e,t){if(e==0||isNaN(e)||!isFinite(e))return e;let r=Rr(t,1,15)-1,n=Fx(u1(rs(e)));var i=1;if(r>n)for(let s=0;s<r-n;s++)i*=10;if(r<n)for(let s=0;s<n-r;s++)i*=.1;return Fx(e*i+.5)/i}var c1=80,Sd=30;function Ls(e,t,r,n,i){let s=i,o=r.width/(s-1),a=n.width/(s-1),u=o/1e3,l=a/1e3,c=Array(s*s),p=Array(3*s*s),f=Array(3*s*s),m=Array(2*s*s),d=[];var y=!0;let g=(t.xmin+t.xmax)/2,h=(t.ymin+t.ymax)/2,P=(t.zmin+t.zmax)/2;for(let E=0;E<s*s;E++)c[E]=!1;for(let E=0;E<s*s;E++)p[3*E+0]=g,p[3*E+1]=h,p[3*E+2]=P;for(let E=0;E<3*s*s;E++)f[E]=0;for(let E=0;E<s;E++)for(let v=0;v<s;v++){let _=E*s+v,z=r.min+E*o,R=n.min+v*a,[H,W,$]=e(z,R),re=isFinite(H)&&isFinite(W)&&isFinite($);if(c[_]=re,m[2*_+0]=E/(s-1),m[2*_+1]=v/(s-1),re){p[3*_+0]=H,p[3*_+1]=W,p[3*_+2]=$;let[j,ve,we]=e(z+u,R),[Dt,_e,Q]=e(z,R+l);j-=H,ve-=W,we-=$,Dt-=H,_e-=W,Q-=$;let ae=ve*Q-we*_e,ge=we*Dt-j*Q,zt=j*_e-ve*Dt,Fe=Math.sqrt(ae*ae+ge*ge+zt*zt),Ft=ae/Fe,qt=ge/Fe,$r=zt/Fe;Od(Ft,qt,$r)?(f[3*_+0]=Ft,f[3*_+1]=qt,f[3*_+2]=$r):y=!1}}function T(E,v,_){let z=v*s+_;c[z]&&(E.x=p[3*z+0],E.y=p[3*z+1],E.z=p[3*z+2])}function D(E,v){return E>=0&&E<s&&v>=0&&v<s&&c[E*s+v]}if(!y)for(let E=0;E<s;E++)for(let v=0;v<s;v++){let _=E*s+v,z=new Jt(f[3*_+0],f[3*_+1],f[3*_+2]);if(c[_]&&z.isZero()){let R=new Jt(p[3*_+0],p[3*_+1],p[3*_+2]);var N=R.clone(),I=R.clone(),O=1;E<s-1&&(D(E+1,v)||D(E+1,v+1)||D(E+1,v-1))?(T(N,E+1,v),R.equals(N)&&v<s-1&&T(N,E+1,v+1),R.equals(N)&&v>0&&T(N,E+1,v-1),O=1):E>0&&(T(N,E-1,v),R.equals(N)&&v<s-1&&T(N,E-1,v+1),R.equals(N)&&v>0&&T(N,E-1,v-1),O=-1),v<s-1&&(D(E,v+1)||D(E+1,v+1)||D(E-1,v+1))?(T(I,E,v+1),R.equals(I)&&E<s-1&&T(I,E+1,v+1),R.equals(I)&&E>0&&T(I,E-1,v+1)):v>0&&(T(I,E,v-1),R.equals(I)&&E<s-1&&T(I,E+1,v-1),R.equals(I)&&E>0&&T(I,E-1,v-1),O*=-1);let H=((R.z-N.z)*(I.y-R.y)-(R.y-N.y)*(I.z-R.z))*O,W=((R.x-N.x)*(I.z-R.z)-(R.z-N.z)*(I.x-R.x))*O,$=((R.y-N.y)*(I.x-R.x)-(R.x-N.x)*(I.y-R.y))*O;Od(H,W,$)&&(f[3*_+0]=H,f[3*_+1]=W,f[3*_+2]=$)}}for(let E=0;E<s-1;E++)for(let v=0;v<s-1;v++){let _=E*s+v,z=E*s+v+1,R=(E+1)*s+v,H=(E+1)*s+v+1,W=c[_],$=c[z],re=c[R],j=c[H];W&&j&&$&&d.push(_,H,z),W&&re&&j&&d.push(_,R,H),W&&$&&re&&!j&&d.push(_,R,z),$&&re&&j&&!W&&d.push(z,R,H)}return{positions:p,normals:f,faces:d,uvs:m}}function Od(e,t,r){return e=tc(e),t=tc(t),r=tc(r),isFinite(e)&&isFinite(t)&&isFinite(r)&&!(e==0&&t==0&&r==0)}var p1=50;function Bx(e=0,t=0,r=0){return{edge0:e,edge1:t,edge2:r}}var Fl=[[0,1],[0,2],[0,3],[1,2],[2,3],[0,4],[0,7],[3,7],[4,7],[0,5],[1,5],[4,5],[1,6],[2,6],[5,6],[3,6],[6,7],[4,6],[0,8],[1,8],[2,8],[3,8],[4,8],[5,8],[6,8],[7,8]],Nd=class{constructor(t,r,n,i,s){this.cubeVertexValue=new Array(9);this.cubeEdge=new Array(26);this.readEdge=new Array(26);this.edgesWithSurface=new Array(26);this.planeA=[];this.planeB=[];this.planeC=[];this.face=Bx();this.i=0;this.j=0;this.k=0;this.p=new Jt;this.normalsAreGood=!0;this.vertices=[];this.triangles=[];this.offset=[[0,0,0],[0,1,0],[1,1,0],[1,0,0],[0,0,1],[0,1,1],[1,1,1],[1,0,1],[.5,.5,.5]];this.tetrahedronList=[[1,2,4,21,20,18],[0,1,3,20,19,18],[2,6,7,25,21,18],[5,6,8,25,22,18],[5,9,11,23,22,18],[0,9,10,23,19,18],[10,12,14,24,23,19],[3,12,13,24,20,19],[4,13,15,24,21,20],[7,15,16,24,25,21],[11,14,17,24,22,23],[8,16,17,24,22,25]];this.gridsize=s,this.f=t,this.x=r,this.y=n,this.z=i,this.size=new Jt(this.x.width/s,this.y.width/s,this.z.width/s),this.sheet=Array((s+1)*(s+1)),this.strip=Array(s+1);for(let o=0;o<(s+1)*(s+1);o++)this.sheet[o]=Bx();for(let o=0;o<s+1;o++)this.strip[o]=Bx()}loopOverUnitCubes(){this.vertices=[],this.triangles=[];let t=this.gridsize;function r(o,a){return a*(t+1)+o}for(let o=0;o<t;o++){this.k=o,this.computeLatticeVerticesOnPlanes();for(let a=0;a<t;a++){this.j=a;for(let u=0;u<t;u++){this.i=u,this.normalsAreGood=!0;for(let l=0;l<26;l++)this.cubeEdge[l]=0;this.cubeVertexValue[0]=this.planeA[r(u,a)],this.cubeVertexValue[1]=this.planeA[r(u,a+1)],this.cubeVertexValue[2]=this.planeA[r(u+1,a+1)],this.cubeVertexValue[3]=this.planeA[r(u+1,a)],this.cubeVertexValue[4]=this.planeB[r(u,a)],this.cubeVertexValue[5]=this.planeB[r(u,a+1)],this.cubeVertexValue[6]=this.planeB[r(u+1,a+1)],this.cubeVertexValue[7]=this.planeB[r(u+1,a)],this.cubeVertexValue[8]=this.planeC[a*t+u],this.p=new Jt(this.x.min+u*this.size.x,this.y.min+a*this.size.y,this.z.min+o*this.size.z),this.setEdges(),this.saveEdges(),this.generateTriangles()}}}let n=[],i=[],s=[];for(let o=0;o<this.vertices.length;o++){let a=this.vertices[o];n.push(a.v.x,a.v.y,a.v.z),i.push(a.n.x,a.n.y,a.n.z),s.push((a.v.x-this.x.min)/this.x.width,(a.v.y-this.y.min)/this.y.width)}return{positions:n,normals:i,faces:this.triangles,uvs:s}}setupGrids(){let t=this.gridsize;this.cornersGrid=new Dd(this.x.min,this.y.min,this.z.min,this.size.x,this.size.y,this.size.z,t+1,t+1,t+1),this.centersGrid=new Dd(this.x.min+this.size.x/2,this.y.min+this.size.y/2,this.z.min+this.size.z/2,this.size.x,this.size.y,this.size.z,t,t,t)}computeLatticeVerticesOnPlanes(){this.cornersGrid===void 0||this.centersGrid===void 0||(this.planeA=this.k==0?this.evaluateArray(this.cornersGrid,0):this.planeB,this.planeB=this.evaluateArray(this.cornersGrid,this.k+1),this.planeC=this.evaluateArray(this.centersGrid,this.k))}evaluateArray(t,r){let n=Array(t.numX*t.numY),i=t.z0+r*t.dz;for(let s=0;s<t.numX;s++)for(let o=0;o<t.numY;o++){let a=t.x0+s*t.dx,u=t.y0+o*t.dy;n[0*t.numX*t.numY+o*t.numX+s]=this.f(a,u,i)}return n}setEdges(){let t=this.sheet[(this.i+0)*(this.gridsize+1)+this.j+0],r=this.sheet[(this.i+1)*(this.gridsize+1)+this.j+0],n=this.sheet[(this.i+0)*(this.gridsize+1)+this.j+1];for(let i=0;i<26;i++)this.readEdge[i]=!1;if(this.k>0){this.cubeEdge[0]=t.edge0,this.cubeEdge[1]=t.edge1,this.cubeEdge[2]=t.edge2,this.cubeEdge[3]=n.edge2,this.cubeEdge[4]=r.edge0;for(let i=0;i<=4;i++)this.readEdge[i]=!0}if(this.j>0){this.cubeEdge[5]=this.strip[this.i].edge0,this.cubeEdge[6]=this.strip[this.i].edge1,this.cubeEdge[7]=this.strip[this.i+1].edge0,this.cubeEdge[8]=this.strip[this.i].edge2;for(let i=5;i<=8;i++)this.readEdge[i]=!0;this.k==0&&(this.cubeEdge[2]=t.edge2,this.readEdge[2]=!0)}if(this.i>0){this.cubeEdge[9]=this.face.edge0,this.cubeEdge[10]=this.face.edge1,this.cubeEdge[11]=this.face.edge2;for(let i=9;i<=11;i++)this.readEdge[i]=!0;this.k==0&&(this.cubeEdge[0]=t.edge0,this.readEdge[0]=!0),this.j==0&&(this.cubeEdge[5]=this.strip[this.i].edge0,this.readEdge[5]=!0)}for(let i=0;i<26;i++){if(this.readEdge[i])continue;let s=Fl[i];if(this.cubeVertexValue[s[0]]<0&&0<=this.cubeVertexValue[s[1]]||this.cubeVertexValue[s[0]]>=0&&0>this.cubeVertexValue[s[1]]){let o=this.findSurfaceCrossing(i);o!==void 0&&(this.vertices.push(o),this.cubeEdge[i]=this.vertices.length,o.n.isZero()&&(this.normalsAreGood=!1))}}}saveEdges(){this.k<this.gridsize-1&&(this.sheet[(this.i+0)*(this.gridsize+1)+this.j+0].edge0=this.cubeEdge[11],this.sheet[(this.i+0)*(this.gridsize+1)+this.j+0].edge1=this.cubeEdge[17],this.sheet[(this.i+0)*(this.gridsize+1)+this.j+0].edge2=this.cubeEdge[8]),this.j<this.gridsize-1&&(this.strip[this.i].edge0=this.cubeEdge[10],this.strip[this.i].edge1=this.cubeEdge[12],this.strip[this.i].edge2=this.cubeEdge[14]),this.i<this.gridsize-1&&(this.face.edge0=this.cubeEdge[15],this.face.edge1=this.cubeEdge[13],this.face.edge2=this.cubeEdge[16]),this.k==0&&(this.sheet[(this.i+0)*(this.gridsize+1)+this.j+1].edge2=this.cubeEdge[3],this.sheet[(this.i+1)*(this.gridsize+1)+this.j+0].edge0=this.cubeEdge[4]),this.j==0&&(this.strip[this.i+1].edge0=this.cubeEdge[7]),this.j==this.gridsize-1&&(this.sheet[this.i*(this.gridsize+1)+this.gridsize].edge2=this.cubeEdge[14]),this.i==this.gridsize-1&&(this.sheet[(this.gridsize+0)*(this.gridsize+1)+this.j].edge0=this.cubeEdge[16],this.strip[this.gridsize].edge0=this.cubeEdge[13])}cubeVertex(t){return new Jt(this.p.x+this.offset[t][0]*this.size.x,this.p.y+this.offset[t][1]*this.size.y,this.p.z+this.offset[t][2]*this.size.z)}findSurfaceCrossing(t){let r=this.cubeVertex(Fl[t][0]),n=this.cubeVertex(Fl[t][1]),i=l1(this.f,new sr(r.x,n.x),new sr(r.y,n.y),new sr(r.z,n.z),.01,this.cubeVertexValue[Fl[t][0]],this.cubeVertexValue[Fl[t][1]]);if(i===void 0||!(isFinite(i.x)&&isFinite(i.y)&&isFinite(i.z)))return;let s=new Jt(this.f(i.x+.1*this.size.x,i.y,i.z),this.f(i.x,i.y+.1*this.size.y,i.z),this.f(i.x,i.y,i.z+.1*this.size.z));return Od(s.x,s.y,s.z)||(s.x=0,s.y=0,s.z=0),{v:new Jt(i.x,i.y,i.z),n:s}}generateTriangles(){for(let i=0;i<12;i++){var t=0;for(let s=0;s<6;s++)this.cubeEdge[this.tetrahedronList[i][s]]!=0&&(this.edgesWithSurface[t]=this.tetrahedronList[i][s],t+=1);if(t>2){let s=this.cubeEdge[this.edgesWithSurface[0]]-1;var r=this.cubeEdge[this.edgesWithSurface[1]]-1,n=this.cubeEdge[this.edgesWithSurface[2]]-1;this.normalsAreGood||this.fixBadNormals(s,r,n);let o=this.vertices[s],a=this.vertices[r],u=this.vertices[n];this.checkWindingOrder(o,a,u)&&([r,n]=[n,r]),this.triangles.push(s,r,n)}if(t==4){let s=this.cubeEdge[this.edgesWithSurface[0]]-1;var r=this.cubeEdge[this.edgesWithSurface[2]]-1,n=this.cubeEdge[this.edgesWithSurface[3]]-1;this.normalsAreGood||this.fixBadNormals(s,r,n);let u=this.vertices[s],l=this.vertices[r],c=this.vertices[n];this.checkWindingOrder(u,l,c)&&([r,n]=[n,r]),this.triangles.push(s,r,n)}}}fixBadNormals(t,r,n){let i=this.vertices,s=i[t],o=i[r],a=i[n];s.n.isZero()&&(i[t]=this.fixNormal(s,s,o,a)),o.n.isZero()&&(i[r]=this.fixNormal(o,s,o,a)),a.n.isZero()&&(i[n]=this.fixNormal(a,s,o,a))}fixNormal(t,r,n,i){let s=!r.n.isZero(),o=!n.n.isZero(),a=!i.n.isZero(),u=new Jt().subVectors(i.v,r.v),l=new Jt().subVectors(r.v,n.v);var c=u.cross(l).normalize();s?c.dot(r.n)<0&&c.multiply(-1):o?c.dot(n.n)<0&&c.multiply(-1):a?c.dot(i.n)<0&&c.multiply(-1):c.dot(r.v)<0&&c.multiply(-1);var p=t;return p.n=c,p.n.isFinite()||p.n.copy(new Jt(0,0,0)),p}checkWindingOrder(t,r,n){let i=new Jt().subVectors(n.v,t.v),s=new Jt().subVectors(t.v,r.v);return i.cross(s).dot(t.n)<0}},Dd=class{constructor(t,r,n,i,s,o,a,u,l){this.x0=t;this.y0=r;this.z0=n;this.dx=i;this.dy=s;this.dz=o;this.numX=a;this.numY=u;this.numZ=l}};var f1=600;function Ad(e,t,r){let n=t.width/(r-1),i=[];for(let s=0;s<r;s++){let o=t.min+s*n,[a,u,l]=e(o);i.push(a,u,l)}return i}function d1(e,t,r){return Ad(n=>{let i=e(n),s=i[0],o=i[1],a=i[2];return[s*tn(o),s*Sr(o),a]},t,r)}function m1(e,t,r){return Ad(n=>{let i=e(n),s=i[0],o=i[1],a=i[2];return[s*Sr(a)*tn(o),s*Sr(a)*Sr(o),s*tn(a)]},t,r)}function y1(e,t){return{type:"linear",s:e,t}}function g1(e,t){return{type:"logarithmic",s:e,t}}function h1(e,t){return{type:"exponential",s:e,t}}function i_([e,t],[r,n]){let i=(n-r)/(t-e),s=(t*r-e*n)/(t-e);return y1(i,s)}function s_([e,t],[r,n]){let i=(n-r)/(Math.log(t)-Math.log(e)),s=(Math.log(t)*r-Math.log(e)*n)/(Math.log(t)-Math.log(e));return g1(i,s)}function o_([e,t],[r,n]){let i=(Math.log(n)-Math.log(r))/(t-e),s=(t*Math.log(r)-e*Math.log(n))/(t-e);return h1(i,s)}function Vx(e,t,r){switch(e){case"linear":return i_(t,r);case"logarithmic":return s_(t,r);case"exponential":return o_(t,r);default:{let n=e;throw new Error("Unexpected scale type: "+n)}}}function Gx({type:e,s:t,t:r},n){switch(e){case"linear":return t*n+r;case"logarithmic":return t*Math.log(n)+r;case"exponential":return Math.exp(t*n+r);default:let i=e;throw new Error("Unexpected scale type: "+i)}}function zx(e,t,r,n){switch(e){case"linear":return a_(t,r,n);case"logarithmic":return Math.pow(t,1-n)*Math.pow(r,n);case"exponential":return n===0?t:n===1?r:Math.log((1-n)*Math.exp(t)+n*Math.exp(r));default:let i=e;throw new Error("Unexpected scale type: "+i)}}function a_(e,t,r){return(1-r)*e+r*t}function qx({type:e,s:t,t:r}){switch(e){case"linear":return y1(1/t,-r/t);case"logarithmic":return h1(1/t,-r/t);case"exponential":return g1(1/t,-r/t);default:let n=e;throw new Error("Unexpected scale type: "+n)}}function b1({width:e,height:t}){return{left:0,right:e,top:0,bottom:t}}function x1({xmin:e,xmax:t,ymin:r,ymax:n}){return{left:e,right:t,bottom:r,top:n}}var Ao=class{constructor(t,r){this.xScale=t,this.yScale=r}static fromRects(t,r,{xAxisScale:n,yAxisScale:i}){return new Ao(Vx(n,[t.left,t.right],[r.left,r.right]),Vx(i,[t.bottom,t.top],[r.bottom,r.top]))}inverse(){return new Ao(qx(this.xScale),qx(this.yScale))}mapX(t){return Gx(this.xScale,t)}mapY(t){return Gx(this.yScale,t)}mapPoint({x:t,y:r}){return{x:this.mapX(t),y:this.mapY(r)}}mapCoordinatePair([t,r]){return[this.mapX(t),this.mapY(r)]}mapRect({top:t,bottom:r,left:n,right:i}){return{left:this.mapX(n),right:this.mapX(i),bottom:this.mapY(r),top:this.mapY(t)}}interpolateX(t,r,n){return zx(this.xScale.type,t,r,n)}interpolateY(t,r,n){return zx(this.yScale.type,t,r,n)}dangerouslyGetXScaleFactor(){if(this.xScale.type!=="linear")throw new Error(`Cannot get scale factor a '${this.xScale.type}' scale`);return this.xScale.s}dangerouslyGetYScaleFactor(){if(this.yScale.type!=="linear")throw new Error(`Cannot get scale factor a '${this.yScale.type}' scale`);return this.yScale.s}};var{floor:T1}=Math,P1=1e4;var l_=0;function Jr(){return"result_"+l_++}function c_(){return{zeros:{x:[],y:[]},extrema:{x:[],y:[]},intercept:{x:[],y:[]}}}function O1(e){return{graphMode:15,error:e,segments:[]}}function Ux(e,t){let r=e[0]+t.min*e[1],n=e[0]+t.max*e[1],i={zeros:{x:[],y:[]},intercept:{x:[],y:[]},extrema:{x:[],y:[]}};if(!isFinite(r)||!isFinite(n))return{segments:[],poi:i,resolved:!0};let s=[[t.min,r,t.max,n]],o=-e[0]/e[1];return!isNaN(o)&&o>=t.min&&o<=t.max&&(i.zeros.x.push(o),i.zeros.y.push(0)),0>=t.min&&0<=t.max&&(i.intercept.x.push(0),i.intercept.y.push(e[0])),{segments:s,poi:i,resolved:!0}}function p_(e,t){let r=Ux(e[0],t),n=Ux(e[1],t);return r.segments.length&&n.segments.length&&r.segments[0].length===4&&n.segments[0].length===4?{segments:[[r.segments[0][1],n.segments[0][1],r.segments[0][3],n.segments[0][3]]],resolved:!0}:{segments:[],resolved:!0}}function f_(e,t){let r=e(t);return{segments:[[...r,...r]],resolved:!0}}function I1(e,t,r){let{mappedFn:n,jumpTolerance:i,screen:s}=r,[o,a]=e,[u,l]=t,c=_s(o,u),p=n(c),f=s.height;if(!(a<0&&l<0&&(a>=p||l>=p))&&!(a>f&&l>f&&(a<=p||l<=p)))return Ya(o,a,c,p,u,l,n,i)}var kx=(e,t,r)=>{let{fn:n,mappedFn:i,jumpTolerance:s,accumulator:o}=r;if(!isFinite(s)||s<=0)return;let a=I1(e,t,r);if(!a)return;let u=(t[0]-e[0])/10,l=[-u,u],c;for(let p=0;p<l.length;p++){let f=e[0]+l[p],m=i(f);isFinite(m)||([f,m]=e,f=e[0],m=e[1]);let d=t[0]+l[p],y=i(d);if(isFinite(y)?c=d:[d,y]=t,I1([f,m],[d,y],r)){let[g,h]=a;o.addPoint([g,n(g)]),o.breakSegment(),o.addPoint([h,n(h)]);return}}return c},Hx=class{constructor(t,r,n){let i=s=>r.mathToPixels.mapY(t(s));this.derivative=n,this.accumulator=new _l(r,t,n),this.fn=t,this.mathToPixels=r.mathToPixels,this.mappedFn=i,this.jumpTolerance=r.tolerance||0,this.screen=r.screen}};function M1(e,t,r,n){let i=r,s=e(i),o=t.mapY(s);return isFinite(o)||(i=r+n,s=e(i),o=t.mapY(s)),isFinite(o)||(i=r-n,s=e(i),o=t.mapY(s)),[i,s,o]}function Yx(e,t,r){let n=new Hx(e,t,r),{mathToPixels:i,mappedFn:s}=n,o=t.nInitialSamples,a=Math.abs(i.interpolateX(t.min,t.max,1/(o-1))-t.min)/10,[u,l,c]=M1(e,i,t.min,a);isFinite(c)&&n.accumulator.addPoint([u,l]);for(var p=1;p<o;p++){let f=i.interpolateX(t.min,t.max,p/(o-1)),m=Math.abs(u-f)/10,[d,y,g]=M1(e,i,f,m);if(isFinite(g)&&isFinite(c)){let h=kx([u,c],[d,g],n);h!==void 0&&(d=h,y=e(d),g=i.mapY(y)),n.accumulator.addPoint([d,y])}else if(isFinite(g)&&!isFinite(c)){let h=Wn(u,c,d,g,s);if(h!==void 0){h!==d&&n.accumulator.addPoint([h,e(h)]);let P=kx([h,s(h)],[d,g],n);P!==void 0&&(d=P,y=e(d),g=i.mapY(y)),n.accumulator.addPoint([d,y])}}else if(!isFinite(g)&&isFinite(c)){let h=Wn(u,c,d,g,s);if(h!==void 0){let P=kx([u,c],[h,s(h)],n);P!==void 0&&(h=P),h!==u&&n.accumulator.addPoint([h,e(h)]),n.accumulator.breakSegment()}}u=d,l=y,c=g}return n.accumulator.finish()}function d_(e){let{fn:t,min:r,max:n}=e,i=Math.floor(r),s=Math.ceil(n),o=!0;s-i+1>P1&&(s=i+(P1-1),o=!1);let a=[];for(let u=i;u<=s;u++){let l=t(u);!isFinite(u)||!isFinite(l)||a.push([u,l])}return{segments:a,resolved:o}}function m_(e,t,r,n){let i=t.min,s=t.max-t.min,o=t.xtolerance&&t.ytolerance?Math.min(t.xtolerance,t.ytolerance):0,a=Math.floor(s/(Math.PI/r)),u,l,c;function p(f,m){let d=m%2===0?1:-1;if(!n&&d===-1)return!1;let y=m*(Math.PI/r),g=[i,i+1,i+2,i+3],h=!1;for(let P=0,T=g.length;P<T;P++){let D=f(g[P]),N=f(g[P]+y);if(isFinite(D)&&isFinite(N)&&(h=!0),isFinite(D)!==isFinite(N)||Math.abs(D-d*N)>o)return!1}return!!h}for(u=1;u<=a;u++)if(p(e,u)){for(c=u,l=2;l*u<=a;l++)p(e,l*u)||(c=void 0);if(c)break}return c?c*(Math.PI/r):null}function S1(e){return[e[1]*Math.cos(e[0]),e[1]*Math.sin(e[0])]}function E1(e,t){if(t.max<t.min)return{segments:[],resolved:!0};let{xtolerance:r,ytolerance:n,ztolerance:i,map:s}=t,o=new Xs({xtolerance:r,ytolerance:n,ztolerance:i,map:s}),a=10,u=t.min,l=e(u);isFinite(l[0])&&isFinite(l[1])&&o.addPoint(l);let c=t.nInitialSamples;for(let p=1;p<c;p++){let f=p/(c-1),m=(1-f)*t.min+f*t.max,d=e(m);Bl(e,u,l,m,d,a,o,t.screen),u=m,l=d}return o.finish()}function y_(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function Bl(e,t,r,n,i,s,o,a){if(n===t)return;let{xtolerance:u,ytolerance:l,ztolerance:c,map:p}=o,f=_s(t,n),m=e(f),d=p(r),y=p(i),g=p(m),h=isFinite(d[0])&&isFinite(d[1])&&(d.length===2||isFinite(d[2])),P=isFinite(y[0])&&isFinite(y[1])&&(y.length===2||isFinite(y[2])),T=isFinite(g[0])&&isFinite(g[1])&&(g.length===2||isFinite(g[2]));if(s===0||f===t||f===n){o.breakSegment(),P&&o.addPoint(i);return}if(!(!h&&!P)){if(h!==P){let D=t,N=n,I=r,O=i;for(;t!==f&&f!==n;)T==h?(t=f,r=m,d=g,h=T):(n=f,i=m,y=g,P=T),f=t+(n-t)/2,m=e(f),g=p(m),T=isFinite(g[0])&&isFinite(g[1])&&(g.length===2||isFinite(g[2]));h?(Bl(e,D,I,t,r,s-1,o,a),o.breakSegment()):(o.breakSegment(),o.addPoint(i),Bl(e,n,i,N,O,s-1,o,a));return}if(h&&T&&P){let D=y_(d,y),N=wi(g[0],g[1],g[2]||0,d[0],d[1],d[2]||0,y[0],y[1],y[2]||0),I=N>.2&&N<.8&&Math.abs(g[0]-(d[0]+N*(y[0]-d[0])))<=u&&Math.abs(g[1]-(d[1]+N*(y[1]-d[1])))<=l&&(d.length===2||Math.abs(g[2]-(d[2]+N*(y[2]-d[2])))<=c);if(D||I||a&&g_(d,g,y,a)){o.addPoint(i);return}}Bl(e,t,r,f,m,s-1,o,a),Bl(e,f,m,n,i,s-1,o,a)}}function g_(e,t,r,{width:n,height:i}){return e[0]<0&&r[0]<0&&(e[0]>=t[0]||r[0]>=t[0])||e[0]>n&&r[0]>n&&(e[0]<=t[0]||r[0]<=t[0])||e[1]<0&&r[1]<0&&(e[1]>=t[1]||r[1]>=t[1])||e[1]>i&&r[1]>i&&(e[1]<=t[1]||r[1]<=t[1])}function h_(e,t,r){let n=new Nd(e.fn,new sr(t.xmin,t.xmax),new sr(t.ymin,t.ymax),new sr(t.zmin,t.zmax),r);n.setupGrids();let{positions:i,normals:s,faces:o,uvs:a}=n.loopOverUnitCubes();return{guid:Jr(),positions:new Float32Array(i),normals:new Float32Array(s),faces:new Uint32Array(o),uvs:new Float32Array(a)}}function b_(e,t,r,n,i){let{positions:s,normals:o,faces:a,uvs:u}=Ls(e.fn,t,r,n,i);return{guid:Jr(),positions:new Float32Array(s),normals:new Float32Array(o),faces:new Uint32Array(a),uvs:new Float32Array(u)}}function x_(e,t,r,n,i){let s=e.fn,{positions:o,normals:a,faces:u,uvs:l}=Ls((c,p)=>{let f=s(c,p),m=f[0],d=f[1],y=f[2];return[m*tn(d),m*Sr(d),y]},t,r,n,i);return{guid:Jr(),positions:new Float32Array(o),normals:new Float32Array(a),faces:new Uint32Array(u),uvs:new Float32Array(l)}}function T_(e,t,r,n,i){let s=e.fn,{positions:o,normals:a,faces:u,uvs:l}=Ls((c,p)=>{let f=s(c,p),m=f[0],d=f[1],y=f[2];return[m*Sr(y)*tn(d),m*Sr(y)*Sr(d),m*tn(y)]},t,r,n,i);return{guid:Jr(),positions:new Float32Array(o),normals:new Float32Array(a),faces:new Uint32Array(u),uvs:new Float32Array(l)}}function P_(e,t,r){let n=e.fn,{positions:i,normals:s,faces:o,uvs:a}=Ls((u,l)=>[u,l,n(u,l)],t,new sr(t.xmin,t.xmax),new sr(t.ymin,t.ymax),r);return{guid:Jr(),positions:new Float32Array(i),normals:new Float32Array(s),faces:new Uint32Array(o),uvs:new Float32Array(a)}}function I_(e,t,r){let n=e.fn,{positions:i,normals:s,faces:o,uvs:a}=Ls((u,l)=>[n(u,l),u,l],t,new sr(t.ymin,t.ymax),new sr(t.zmin,t.zmax),r);return{guid:Jr(),positions:new Float32Array(i),normals:new Float32Array(s),faces:new Uint32Array(o),uvs:new Float32Array(a)}}function M_(e,t,r){let n=e.fn,{positions:i,normals:s,faces:o,uvs:a}=Ls((u,l)=>[u,n(u,l),l],t,new sr(t.xmin,t.xmax),new sr(t.zmin,t.zmax),r);return{guid:Jr(),positions:new Float32Array(i),normals:new Float32Array(s),faces:new Uint32Array(o),uvs:new Float32Array(a)}}function E_(e,t,r,n,i){let s=e.fn,{positions:o,normals:a,faces:u,uvs:l}=Ls((c,p)=>[c*tn(p),c*Sr(p),s(c,p)],t,r,n,i);return{guid:Jr(),positions:new Float32Array(o),normals:new Float32Array(a),faces:new Uint32Array(u),uvs:new Float32Array(l)}}function v_(e,t,r,n,i){let s=e.fn,{positions:o,normals:a,faces:u,uvs:l}=Ls((c,p)=>[s(c,p)*tn(c),s(c,p)*Sr(c),p],t,r,n,i);return{guid:Jr(),positions:new Float32Array(o),normals:new Float32Array(a),faces:new Uint32Array(u),uvs:new Float32Array(l)}}function O_(e,t,r,n,i){let s=e.fn,{positions:o,normals:a,faces:u,uvs:l}=Ls((c,p)=>[s(c,p)*Sr(p)*tn(c),s(c,p)*Sr(p)*Sr(c),s(c,p)*tn(p)],t,r,n,i);return{guid:Jr(),positions:new Float32Array(o),normals:new Float32Array(a),faces:new Uint32Array(u),uvs:new Float32Array(l)}}function v1(e){for(let t of e)if(t!==0)return!1;return!0}function N1(e,t){let{min:r,max:n,mathToPixels:i,nInitialSamples:s}=t,o=i.interpolateX(r,n,0),a=e(o),u=v1(a),l=!1,c=[];for(var p=1;p<s;p++){let f=i.interpolateX(r,n,p/(s-1)),m=e(f),d=v1(m);if(u){o=f,a=m,d||(u=!1);continue}if(d){l?(u=!0,l=!1):l=!0;continue}let y=zP(o,a,f,m,e);y!==void 0&&c.push(y),o=f,a=m}return c}function D1(e){if(!e)return!1;let t=e.viewport.xmin,r=e.viewport.xmax,n=e.viewport.ymin,i=e.viewport.ymax;return!(!isFinite(t)||!isFinite(r)||r<=t||!isFinite(n)||!isFinite(i)||i<=n||!isFinite(e.screen.width)||e.screen.width<=0||!isFinite(e.screen.height)||e.screen.height<=0)}function S_(e,t){let r=t-e;return 1+Math.ceil(r/(r/1e3))}function Pu(e,t,r){var I,O,E,v;let{viewport:n,screen:i,xAxisScale:s,yAxisScale:o}=e,a=e.viewport.xmin,u=e.viewport.xmax,l=e.viewport.ymin,c=e.viewport.ymax,p=(I=e.viewport.zmin)!=null?I:-2,f=(O=e.viewport.zmax)!=null?O:2;var m=t.lineWidth;if(m>3){var d=m*(u-a)/e.screen.width,y=m*(c-l)/e.screen.height;a-=d,u+=d,l-=y,c+=y}let h=1/4,P=t.domainBound,T,D=Ao.fromRects(x1(n),b1(i),{xAxisScale:s,yAxisScale:o}),N;switch(t.graphMode){case 1:switch(T=Qr(Ri([l,c]),P),T.type){case"empty":return!1;case"known":l=T.bounds[0],c=T.bounds[1]}let _=1+Math.ceil(Math.abs(D.mapY(c)-D.mapY(l))/h),z=new Ao(D.yScale,D.xScale);N={min:l,max:c,tolerance:h,nInitialSamples:_,mathToPixels:z,screen:{width:i.height,height:i.width}};break;case 2:{switch(T=Qr(Ri([a,u]),P),T.type){case"empty":return!1;case"known":a=T.bounds[0],u=T.bounds[1]}let R=1+Math.ceil(Math.abs(D.mapX(u)-D.mapX(a))/h);N={min:a,max:u,tolerance:h,nInitialSamples:R,mathToPixels:D,screen:i};break}case 6:{let R=e.degreeMode?Math.PI/180:1;if(((E=t.domain)==null?void 0:E.type)!=="1d")throw new Error("Expected polar graph to have domain");let{min:H,max:W}=t.domain;switch(T=Qr(Ri([H,W]),P),T.type){case"empty":return!1;case"known":H=T.bounds[0],W=T.bounds[1]}let $=1+Math.min(Math.ceil(R*Math.abs(W-H)/(2*Math.PI)*1e3),12e3);if(N={min:H,max:W,screen:i,nInitialSamples:$,xtolerance:h,ytolerance:h,map:([re,j])=>D.mapCoordinatePair(S1([re,j]))},!t.domain.isExplicit){let re=m_(r,N,R,t.operator==="=");re&&(N.max=N.min+re,N.nInitialSamples=1+Math.min(Math.ceil(R*Math.abs(N.max-N.min)/(2*Math.PI)*1e3),12e3))}break}case 5:case 24:case 25:case 26:{let R={min:0,max:1},{min:H,max:W}=((v=t.domain)==null?void 0:v.type)==="1d"?t.domain:R;switch(T=Qr(Ri([H,W]),P),T.type){case"empty":return!1;case"known":H=T.bounds[0],W=T.bounds[1]}N={min:H,max:W,screen:i,nInitialSamples:S_(H,W),xtolerance:h,ytolerance:h,ztolerance:h,map:([$,re])=>D.mapCoordinatePair([$,re])};break}case 8:N={xmin:a,xmax:u,ymin:l,ymax:c,mathToPixels:D,tolerance:h};break;case 40:case 41:case 42:case 27:case 28:case 29:case 30:case 31:case 32:case 33:case 34:case 35:case 36:case 47:case 37:case 38:case 39:case 43:case 44:case 45:case 46:return{xmin:a,xmax:u,ymin:l,ymax:c,zmin:p,zmax:f};default:return!1}return N}function Rd(e){let{viewState:t,graphInfo:r,compiled:n,maxOverride:i,showPoint:s}=e,o=n.fn,a=Pu(t,r,o),u;a||(u={segments:[],resolved:!0});let{min:l,max:c}=a;u=d_({fn:o,min:Math.max(l,0),max:i!==void 0?Math.min(i,c):c});let{points:p,droppedIndices:f}=Vl(u.segments);return{segments:[p],droppedIndices:f,graphMode:3,color:r.color,style:r.pointStyle,poi:Ni(u.segments),showPoint:s}}function N_(e){switch(e){case 43:return 31;case 44:return 32;case 45:return 34;case 46:return 35;case 47:return 36;default:return e}}function Zs(e){var d,y,g,h,P;let{viewState:t,graphInfo:r,compiled:n,derivative:i}=e,s=n.fn,o=Pu(t,r,s),a,u,l,c=N_(r.graphMode),p=t.xAxisScale==="linear"&&t.yAxisScale==="linear";if(!o)a={segments:[],resolved:!0};else{switch(c){case 1:case 2:let T=i?i.fn:void 0;a=r.isLinear&&p&&Hi(r.linearCoefficients)?Ux(r.linearCoefficients,o):Yx(s,o,T);break;case 6:a=E1(z=>[z,s(z)],o);break;case 8:a=i1(s,o);break;case 5:o.max===o.min?a=f_(s,o.min):a=r.isLinear&&p&&Hi(r.linearCoefficients)?p_(r.linearCoefficients,o):E1(s,o);break;case 37:{var f=n.fn;let z=f();return{graphMode:37,position:z,radius:.02*r.lineWidth,guid:Jr(),color:r.color}}case 38:{var f=n.fn;let R=f(),H=R[0],W=R[1],$=R[2];return{graphMode:37,position:[H*tn(W),H*Sr(W),$],radius:.02*r.lineWidth,guid:Jr(),color:r.color}}case 39:{var f=n.fn;let R=f(),H=R[0],W=R[1],$=R[2];return{graphMode:37,position:[H*Sr($)*tn(W),H*Sr($)*Sr(W),H*tn($)],radius:.02*r.lineWidth,guid:Jr(),color:r.color}}case 24:case 25:case 26:let{min:D,max:N}=((d=r.domain)==null?void 0:d.type)==="1d"?r.domain:{min:0,max:1},I=new sr(D,N),O=r.resolution,E=f1,v=O===void 0||isNaN(O)?E:Rr(T1(O),2,2e3),_=[];switch(c){case 24:_=Ad(n.fn,I,v);break;case 25:_=d1(n.fn,I,v);break;case 26:_=m1(n.fn,I,v);break}return{graphMode:24,guid:Jr(),points:_,compiled:n,color:r.color,thickness:r.lineWidth};case 36:case 27:case 28:case 29:case 30:case 31:case 32:case 33:case 34:case 35:{let z,R=o,H=c===36?p1:c1,W=r.resolution,$=W===void 0||isNaN(W)?H:Rr(T1(W),2,100),re=((y=r.domain)==null?void 0:y.type)==="2d",{uMin:j,uMax:ve,vMin:we,vMax:Dt}=((g=r.domain)==null?void 0:g.type)==="2d"?r.domain:{uMin:0,uMax:1,vMin:0,vMax:1},_e=new sr(j,ve),Q=new sr(we,Dt);switch(c){case 27:z=b_(n,R,_e,Q,$);break;case 28:z=x_(n,R,_e,Q,$);break;case 29:z=T_(n,R,_e,Q,$);break;case 30:z=P_(n,R,$);break;case 31:z=I_(n,R,$);break;case 32:z=M_(n,R,$);break;case 33:z=E_(n,R,new sr(j,re?ve:Math.max(R.xmin,R.xmax,R.ymin,R.ymax)),new sr(we,re?Dt:2*Math.PI),$);break;case 34:{let{min:ge,max:zt}=((h=r.domain)==null?void 0:h.type)==="1d"?r.domain:{min:0,max:2*Math.PI};z=v_(n,R,new sr(ge,zt),new sr(o.zmin,o.zmax),$)}break;case 35:z=O_(n,R,new sr(j,re?ve:2*Math.PI),new sr(we,re?Dt:Math.PI),$);break;case 36:z=h_(n,o,$);break}return{meshData:z,color:r.color,checkers:(P=r.checkers)!=null?P:Sd,graphMode:c,compiled:n}}default:throw new Error("Programming Error: unexpected graphmode "+c)}l=a.poi}if((!l||l.zeros.x.length+l.extrema.x.length+l.intercept.x.length>250)&&(l=c_()),c===1)for(let T in l){if(!l.hasOwnProperty(T))continue;let D=T;u=l[D].y,l[D].y=l[D].x,l[D].x=u}let m={segments:a.segments,resolved:a.resolved,graphMode:c,color:r.color,style:r.lineStyle,lineWidth:r.lineWidth,lineOpacity:r.lineOpacity,listIndex:r.listIndex,operator:r.operator,poi:l,compiled:n};if(c===6){let T=o;m.sampledDomain={min:T.min,max:T.max}}return a.fillSegments&&(m.fillSegments=a.fillSegments),m}function D_(e,t,r){let n,i,s,o,a=[],u=null;switch(r){case 6:u=S1;break;case 1:u=function(l){return[l[1],l[0]]};break}for(n=0;n<e.length;n++)for(o=e[n],i=0;i<o.length;i+=2)s=[o[i],o[i+1]],u&&(s=u(s)),a.push(s[0],s[1]);for(n=t.length-1;n>=0;n--)for(o=t[n],i=o.length-2;i>=0;i-=2)s=[o[i],o[i+1]],u&&(s=u(s)),a.push(s[0],s[1]);return a}function Cd(e,t,r){let n=p=>{let f=p[p.length-1];return f[f.length-2]},i=[],s=0,o=0,a=[],u=[],l=-1/0,c=-1/0;for(;;){if(l<=c){if(s>=t.length)break;u.push(t[s++])}if(c<=l){if(o>=e.length)break;a.push(e[o++])}if(l=n(u),c=n(a),Kr(l,c,4)){i.push(D_(a,u,r)),u=[],a=[];let p=Math.max(l,c);l=p,c=p}}return i}function Vl(e){let t=[],r={};for(let n=0;n<e.length;n++){let i=e[n],[s,o]=i;!isNaN(s)&&!isNaN(o)?t.push(i):r[n]=!0}return{points:t,droppedIndices:r}}var A_=(e,t)=>{let r=e.segments[0],n=t.segments[0],i=[[...r,...n]];return ue(X({},e),{segments:i})};function R_(e){let{viewState:t,graphInfo:r,compiled:n,derivative:i,bounds:s}=e,o=Ti(r),a=Qr(r.domainBound,Ri(s));if(a.type==="known")return o.domainBound=a,o.lineStyle="SOLID",Zs({graphInfo:o,viewState:t,compiled:n,derivative:i})}function Ro(e){let{viewState:t,graphInfo:r,compiled:n,bounds:i,included:s,showPoint:o}=e,a=Ti(r),u=Qr(r.domainBound,Ri(i));if(u.type==="known")return a.domainBound=u,a.pointStyle=s?"POINT":"OPEN",Rd({graphInfo:a,viewState:t,compiled:n,showPoint:o,maxOverride:void 0})}function C1(e){let{viewState:t,graphInfo:r,compiled:n,bounds:i,maxOverride:s,showPoint:o}=e,[a,u]=i,l=[],c;a=Math.ceil(a),u=Math.floor(u);let p=s!==void 0?s:1/0;if(a===-1/0&&u>=p)c=Ro({bounds:[a,p],included:!0,viewState:t,graphInfo:r,compiled:n,showPoint:o}),l.push(c);else if(a===-1/0&&u<1/0)c=Ro({bounds:[a,u],included:!0,viewState:t,graphInfo:r,compiled:n,showPoint:o}),l.push(c),l.push(Ro({bounds:[u+1,p],included:!1,viewState:t,graphInfo:r,compiled:n,showPoint:o}));else if(a>-1/0&&u>=p)c=Ro({bounds:[a,p],included:!0,viewState:t,graphInfo:r,compiled:n,showPoint:o}),l.push(Ro({bounds:[-1/0,a-1],included:!1,viewState:t,graphInfo:r,compiled:n,showPoint:o})),l.push(c);else{c=Ro({bounds:[a,u],included:!0,viewState:t,graphInfo:r,compiled:n,showPoint:o});let f=Ro({bounds:[-1/0,a-1],included:!1,viewState:t,graphInfo:r,compiled:n,showPoint:o}),m=Ro({bounds:[u+1,p],included:!1,viewState:t,graphInfo:r,compiled:n,showPoint:o});l.push(c);let d;f&&m&&(d=A_(f,m),l.push(d))}return{cdfTopBranch:c,topBranches:l}}var L1=e=>{let{viewState:t,graphInfo:r,compiled:n,derivative:i,bounds:s}=e,[o,a]=s,u=R_({bounds:[o,a],viewState:t,graphInfo:r,compiled:n,derivative:i}),l=[Zs({viewState:t,graphInfo:r,compiled:n,derivative:i})];return{cdfTopBranch:u,topBranches:l}};function E6(e){switch(e){case"LOOP_FORWARD":return"dcg-icon-arrow-one-way";case"LOOP_FORWARD_REVERSE":return"dcg-icon-arrow-two-way";case"PLAY_ONCE":return"dcg-icon-arrow-once";case"PLAY_INDEFINITELY":return"dcg-icon-arrow-infinite"}}function Gl(e,t){let r={};for(let n in t)t.hasOwnProperty(n)&&(Bs(e[n],t[n])||(r[n]=t[n]));return r}function wd(e,t){let r,n={};for(let i in t)t.hasOwnProperty(i)&&(Bs(e[i],t[i])||(n[i]=t[i],r=n));return r}function N6(e,t){t||(t={});let r={};for(let n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(r[n]=Ti(e[n]));for(let n in t)t.hasOwnProperty(n)&&(r[n]=t[n]);return r}function A6({from:e,to:t,props:r}){for(var n in r)r[n]&&e.hasOwnProperty(n)&&(t[n]=Ti(e[n]))}function R6(e,t){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])}function _1(e,t){let r={};for(var n in t)t.hasOwnProperty(n)&&(r[n]=e[n]);return r}function C6(e){let t={};for(let r in e)e.hasOwnProperty(r)&&(t[r]=!0);return t}var C_=(n=>(n.NONE="NONE",n.POSITIVE="POSITIVE",n.BOTH="BOTH",n))(C_||{});var F1={collapsed:!1,hidden:!1,secret:!1,readonly:!1,title:""};function _6(e){return X(X({},F1),e)}function F6(e){return Gl(F1,e)}var B1="**dcg_geo_folder**";var Wx={show:!1,min:"",max:""},Xx={breadth:"",axisOffset:"",alignedAxis:"x",showBoxplotOutliers:!0,binAlignment:"center",dotplotXMode:"exact",histogramMode:""},Zx={enabled:!1,latex:""};var L_=4e3,_d={polarDomain:{min:"",max:""},parametricDomain:{min:"",max:""},parametricDomain3Du:{min:"",max:""},parametricDomain3Dv:{min:"",max:""},cdf:Wx,colorLatex:"",description:"",fillOpacity:"",lineOpacity:"",pointOpacity:"",pointSize:"",lineWidth:"",resolution:"",checkers:"",polarCoordinateSystem:"",labelAngle:"",vizProps:Xx,clickableInfo:Zx},V1=ue(X({folderId:"",latex:"",color:"",showLabel:!1,label:"",hidden:!1,secret:!1,readonly:!1,dragMode:"AUTO",labelSize:"",labelOrientation:"default",suppressTextOutline:!1,interactiveLabel:!1,editableLabelMode:"NONE",residualVariable:"",isLogModeRegression:!1,pointStyle:"POINT",lineStyle:"SOLID",arrowMode:"DEFAULT",regressionParameters:{},displayEvaluationAsFraction:!1,slider:{},strictIntersection:!1},_d),{points:void 0,lines:void 0,fill:void 0,surfaces:void 0}),G1={hardMin:!1,hardMax:!1,animationPeriod:L_,loopMode:"LOOP_FORWARD_REVERSE",playDirection:1,isPlaying:!1,min:"-10",max:"10",step:""};function Z6(e){return ue(X(X({},V1),e),{slider:X(X({},G1),e.slider),cdf:X(X({},Wx),e.cdf),vizProps:X(X({},Xx),e.vizProps),clickableInfo:X(X({},Zx),e.clickableInfo)})}function j6(e){var t=Gl(V1,ue(X({},e),{slider:Gl(G1,e.slider)})),r=wd(Wx,e.cdf);r===void 0?delete t.cdf:t.cdf=r;var n=wd(Xx,e.vizProps);n===void 0?delete t.vizProps:t.vizProps=n;var i=wd(Zx,e.clickableInfo);return i===void 0?delete t.clickableInfo:t.clickableInfo=i,t}function w_(e){return _1(e,_d)}function J6(e,t){for(var r in _d)if(_d.hasOwnProperty(r)&&e[r]!==t[r])return!1;return!0}function Q6(e){return X({type:"statement",id:e.id,latex:e.latex,label:e.label,color:e.color,fill:e.fill,points:e.points,lines:e.lines,surfaces:e.surfaces,pointStyle:e.pointStyle,lineStyle:e.lineStyle,arrowMode:e.arrowMode,dragMode:e.dragMode,labelSize:e.labelSize,labelOrientation:e.labelOrientation,suppressTextOutline:e.suppressTextOutline,interactiveLabel:e.interactiveLabel,editableLabelMode:e.editableLabelMode,residualVariable:e.residualVariable,regressionParameters:e.regressionParameters,isLogModeRegression:e.isLogModeRegression,showLabel:e.showLabel,shouldGraph:e.hidden,slider:{min:e.slider.hardMin?e.slider.min:"",max:e.slider.hardMax?e.slider.max:"",softMin:e.slider.hardMin?"":e.slider.min,softMax:e.slider.hardMax?"":e.slider.max,step:e.slider.step,isPlayingOnce:e.slider.isPlaying&&e.slider.loopMode==="PLAY_ONCE"},strictIntersection:e.strictIntersection,isInConstructionsFolder:e.folderId===B1},w_(e))}function jx(e,t){let r;switch(t){case"solvedEquation":r=2;break;case"baseComparator":r=4;break;default:r=1;break}return Math.floor(e/r)}var F_=!1,Vd=b.List;function Br(){return{}}function B_(){return{segments:[],poi:{},graphMode:1,color:""}}function Pa(e,t,r){let n=1/0;for(let s of t){let o=e[s];Array.isArray(o)&&o.length<n&&(n=o.length)}let i=1;return r==="solvedEquation"?i=2:r==="baseComparator"&&(i=4),i*n}function js(e,t,r){return Array.isArray(e)?e[jx(t,r)]:e}function V_(e,t){var r=t.viewport.xmax-t.viewport.xmin,n=t.viewport.ymax-t.viewport.ymin;let i=pi(r,n),s=pi(30,30),o=Math.round(2-Math.log(i/s)/Math.LN10);if(o<=0)return Math.round(e)+"";{let a=Math.pow(10,o);return Math.round(e*a)/a+""}}function G_(e,t){var r=t.viewport.xmax-t.viewport.xmin,n=t.viewport.ymax-t.viewport.ymin;let i=r*n,s=30*30,o=Math.round(2-Math.log(i/s)/Math.LN10);if(o<=0)return Math.round(e)+"";{let a=Math.pow(10,o);return Math.round(e*a)/a+""}}function z_(e,t){return t.degreeMode?Math.round(e/(Math.PI/180)*10)/10+"\xB0":Math.round(e*100)/100+""}function Ia(e,t,r){let n=jx(t,r),i=e.userData.lineStyle,s=js(e.metaData.computedLineWidth,t,r),o=js(e.metaData.computedLineOpacity,t,r),a=js(e.metaData.computedFillOpacity,t,r),u=e.metaData.colorLatexValue?js(e.metaData.colorLatexValue,t,r):e.userData.color,l=js(e.metaData.computedResolution,t,r),c=js(e.metaData.computedCheckers,t,r);return{listIndex:n,style:i,lineWidth:s,lineOpacity:o,fillOpacity:a,color:u,resolution:l,checkers:c}}b.Base.prototype._graph=q_;function q_(e,t,r,n,i,s){if(t instanceof b.SolvedEquation){let l=this._graph(e,t._expression,r,n,i,t.branchMultiplier===2?"solvedEquation":void 0),c=Y1(this,t,r,e);return c&&(l||(l=[]),Array.prototype.push.apply(l,c)),l}function o(l){let c=l.editableLabelMode;return c==="TEXT"||c==="MATH"}let a=t.getExpressionType(n.graphMode,t.valueType),u=xv(a,{points:this.userData.points,lines:this.userData.lines,fill:this.userData.fill,surfaces:this.userData.surfaces});switch(n.graphMode){case 4:let{points:l,droppedIndices:c}=Vl([t.asValue()]),p=this.userData.shouldGraph&&u.points,f=this.userData.showLabel&&!p;return p?[{segments:[l],graphMode:n.graphMode,droppedIndices:c,color:As(this.userData,this.metaData),style:this.userData.pointStyle,showLabel:!!this.userData.showLabel,labelSize:this.metaData.computedLabelSize,labelAngle:this.metaData.computedLabelAngle,labelOrientation:this.userData.labelOrientation,pointOpacity:this.metaData.computedPointOpacity,suppressTextOutline:this.userData.suppressTextOutline,editableLabel:o(this.userData),labels:this.computedLabels||[],poi:Ni(l),movablePointInfo:[]}]:f?[{segments:[l],graphMode:3,color:As(this.userData,this.metaData),style:this.userData.pointStyle,showLabel:!!this.userData.showLabel,nakedLabel:!0,labelSize:this.metaData.computedLabelSize,labelAngle:this.metaData.computedLabelAngle,labelOrientation:this.userData.labelOrientation,pointOpacity:this.metaData.computedPointOpacity,suppressTextOutline:this.userData.suppressTextOutline,editableLabel:o(this.userData),labels:this.computedLabels||[],poi:Ni(l),showPoint:!1}]:[];case 3:{let d=[],y=this.userData.shouldGraph&&u.points,g=this.userData.shouldGraph&&u.lines,h=["colorLatexValue"];y&&h.push("computedPointOpacity","computedPointSize"),(this.userData.showLabel||y)&&h.push("computedLabelSize","computedLabelAngle");let P=Pa(this.metaData,h,s),T=Vd.wrap(t).asValue();rn(T),T.length>P&&(T.length=P);let D=this.userData.showLabel&&!y&&!g,N=Vl(T);return(this.userData.showLabel||y)&&d.push({segments:[N.points],graphMode:n.graphMode,droppedIndices:N.droppedIndices,color:this.metaData.colorLatexValue||this.userData.color,style:this.userData.pointStyle,showLabel:!!this.userData.showLabel,showPoint:y,labelSize:this.metaData.computedLabelSize,labelAngle:this.metaData.computedLabelAngle,labelOrientation:this.userData.labelOrientation,pointSize:this.metaData.computedPointSize,pointOpacity:this.metaData.computedPointOpacity,suppressTextOutline:this.userData.suppressTextOutline,interactiveLabel:!!this.userData.interactiveLabel,editableLabel:o(this.userData),nakedLabel:D,labels:this.computedLabels||[],poi:Ni(T)}),g&&d.push({segments:$1(T),graphMode:5,color:As(this.userData,this.metaData),style:this.userData.lineStyle,lineWidth:this.metaData.computedLineWidth,lineOpacity:this.metaData.computedLineOpacity,poi:Br()}),d}case 5:case 40:case 42:case 41:case 37:case 38:case 39:case 24:case 25:case 26:{let d=this.userData,y=this.metaData,g=[],h=["colorLatexValue"];u.lines&&h.push("computedLineOpacity","computedLineWidth"),u.fill&&h.push("computedFillOpacity");let P=Pa(this.metaData,h,s),T=Vd.wrap(t).mapElements((N,I)=>{if(I>=P)return B_();let{listIndex:O,lineWidth:E,lineOpacity:v,color:_,resolution:z,checkers:R}=Ia(this,I,s);if(N.valueType===mr){let[[re,j,ve],[we,Dt,_e],[Q,ae,ge]]=N.asValue();if(isNaN(re)||isNaN(j)||isNaN(ve)||isNaN(we)||isNaN(Dt)||isNaN(_e)||isNaN(Q)||isNaN(ae)||isNaN(ge))return;let zt=[re,j,ve,we,Dt,_e,Q,ae,ge],Fe=new Jt(re,j,ve),Ft=new Jt(we,Dt,_e),qt=new Jt(Q,ae,ge),$r=new Jt().subVectors(Fe,qt),Iu=new Jt().subVectors(Ft,Fe),ai=new Jt().crossVectors($r,Iu),uO=[ai.x,ai.y,ai.z,ai.x,ai.y,ai.z,ai.x,ai.y,ai.z];return{meshData:{guid:Jr(),positions:new Float32Array(zt),normals:new Float32Array(uO),faces:new Uint32Array([0,1,2]),uvs:new Float32Array([0,0,0,1,1,0])},color:_,graphMode:40}}if(N.valueType===yr){let re=N.asValue(),[[j,ve,we],Dt]=re;if(isNaN(j)||isNaN(ve)||isNaN(we)||isNaN(Dt))return;var H=_;return"colorLatex"in this.userData&&k1(this.userData.colorLatex)&&(H=this.userData.colorLatex),{graphMode:41,position:[j,ve,we],radius:Dt,resolution:z,guid:Jr(),color:H}}if(N.valueType===tr){let re=N.asValue(),[[j,ve,we],[Dt,_e,Q]]=re;return isNaN(j)||isNaN(ve)||isNaN(we)||isNaN(Dt)||isNaN(_e)||isNaN(Q)?void 0:{graphMode:42,guid:Jr(),points:[j,ve,we,Dt,_e,Q],color:_,thickness:E}}let W=N.getDependencies(),$=this.getGraphInfo(e,N).graphMode;if($===37||$===38||$===39){let re=js(this.metaData.computedPointSize,I,s),j=N.getCompiledFunction(),ve=this.getGraphInfo(e,N);return ve.graphMode=$,ve.lineWidth=re,ve.color=_,ve.checkers=R,ve.listIndex=O,Zs({viewState:r,graphInfo:ve,compiled:j})}else if(W.length===0){let{points:re,droppedIndices:j}=Vl([N.asValue()]);return{segments:[re],graphMode:3,droppedIndices:j,color:As(d,y),style:d.lineStyle,lineWidth:E,lineOpacity:v,poi:Ni(re)}}else{let re=N.getCompiledFunction(),j=this.getGraphInfo(e,N);return j.graphMode=n.graphMode,j.domain={type:"1d",min:this.metaData.evaluatedDomainMin,max:this.metaData.evaluatedDomainMax},j.style=this.userData.lineStyle,j.lineWidth=E,j.lineOpacity=v,j.resolution=z,j.checkers=R,j.color=_,j.listIndex=O,Zs({viewState:r,graphInfo:j,compiled:re})}}),D=[];for(let N of T)N&&D.push(N);if(u.fill)if(D.forEach((N,I)=>{if(I>=P)return;let{color:O,fillOpacity:E,listIndex:v}=Ia(this,I,s);g.push({segments:N.segments,color:O,fillOpacity:E,listIndex:v,graphMode:7,poi:Br()})}),u.lines)D=D.concat(g);else return g;return D}case 1:case 2:case 8:case 36:case 47:case 6:case 20:case 21:case 18:case 19:case 17:case 23:case 27:case 28:case 29:case 30:case 31:case 32:case 33:case 34:case 35:case 43:case 44:case 45:case 46:{let d=[],y=t.valueType===x,g=Pa(this.metaData,["computedLineOpacity","computedLineWidth","colorLatexValue","fillOpacity"],s);return Vd.wrap(t).eachElement((h,P)=>{var we,Dt;if(P>=g)return;let T=this.getGraphInfo(e,h);T.graphMode=n.graphMode;let{listIndex:D,style:N,lineWidth:I,lineOpacity:O,fillOpacity:E,color:v,resolution:_,checkers:z}=Ia(this,P,s);if(T.listIndex=D,T.style=N,T.lineWidth=I,T.lineOpacity=O,T.fillOpacity=E,T.color=v,T.resolution=_,T.checkers=z,(n.graphMode===6||n.graphMode===34||n.graphMode===45)&&(T.domain={type:"1d",min:this.metaData.evaluatedDomainMin,max:this.metaData.evaluatedDomainMax,isExplicit:this.metaData.isExplicitDomain}),(n.graphMode==27||n.graphMode==28||n.graphMode==29||n.graphMode==35||n.graphMode==33||n.graphMode==46)&&(T.domain={type:"2d",uMin:this.metaData.evaluatedDomain3DuMin,uMax:this.metaData.evaluatedDomain3DuMax,vMin:this.metaData.evaluatedDomain3DvMin,vMax:this.metaData.evaluatedDomain3DvMax}),"colorLatex"in this.userData&&k1(this.userData.colorLatex)&&(T.color=this.userData.colorLatex),n.graphMode===20){let[[Q,ae],ge]=h.asValue();if(isNaN(Q)||isNaN(ae)||isNaN(ge))return;d.push({segments:[[Q,ae,ge]],resolved:!0,graphMode:T.graphMode,color:T.color,style:T.lineStyle,lineWidth:T.lineWidth,lineOpacity:T.lineOpacity,listIndex:T.listIndex,operator:T.operator,poi:Br()});return}else if(n.graphMode===21){let Q=Pf(h.asValue());if(!Q)return;let ae=[];Q.type==="arc"?ae.push({graphMode:n.graphMode,segments:[[Q.center[0],Q.center[1],Q.radius,Q.startAngle,Q.endAngle]],color:T.color,style:T.lineStyle,lineWidth:T.lineWidth,lineOpacity:T.lineOpacity,listIndex:T.listIndex,operator:n.operator,poi:Br()}):Q.type==="rays"?ae.push({graphMode:19,segments:[[Q.start1[0],Q.start1[1],Q.end1[0],Q.end1[1]]],color:T.color,style:T.lineStyle,lineWidth:T.lineWidth,lineOpacity:T.lineOpacity,listIndex:T.listIndex,operator:n.operator,poi:Br()},{graphMode:19,segments:[[Q.start2[0],Q.start2[1],Q.end2[0],Q.end2[1]]],color:T.color,style:T.lineStyle,lineWidth:T.lineWidth,lineOpacity:T.lineOpacity,listIndex:T.listIndex,operator:n.operator,poi:Br()}):ae.push({graphMode:17,segments:[[Q.start[0],Q.start[1],Q.end[0],Q.end[1]]],color:T.color,style:T.lineStyle,lineWidth:T.lineWidth,lineOpacity:T.lineOpacity,listIndex:T.listIndex,operator:n.operator,poi:Br()}),d.push(...ae),d.push(...U1(ae,i));return}else if(n.graphMode===17||n.graphMode===18||n.graphMode===19){let[[Q,ae],[ge,zt]]=h.asValue();if(isNaN(Q)||isNaN(ae)||isNaN(ge)||isNaN(zt))return;let Fe={segments:[[Q,ae,ge,zt]],resolved:!0,graphMode:T.graphMode,color:T.color,style:T.lineStyle,arrowMode:T.arrowMode,lineWidth:T.lineWidth,lineOpacity:T.lineOpacity,listIndex:T.listIndex,operator:n.operator,poi:Br()};if(d.push(Fe),d.push(...U1([Fe],i)),this.userData.showLabel&&n.graphMode===17){let Ft=T.listIndex,qt=this.computedLabels&&this.computedLabels[Ft||0];d.push({graphMode:22,objectType:17,segments:[[Q,ae,ge,zt]],color:T.color,listIndex:Ft,showLabel:!0,labelSize:this.metaData.computedLabelSize,labelAngle:this.metaData.computedLabelAngle,labelOrientation:this.userData.labelOrientation,labels:qt?[qt]:[V_(pi(ge-Q,zt-ae),r)]})}return}else if(n.graphMode===23){let{value:Q,valueType:ae}=h.asTypedValue(),[[ge,zt],Fe,Ft]=Q;if(isNaN(ge)||isNaN(zt)||isNaN(Fe)||isNaN(Ft))return;let qt=T.listIndex,$r=ae===oe,Iu=$r?Ft:Math.abs(Ft);if(d.push({graphMode:23,segments:[[ge,zt,Fe,Ft,$r?1:0]],color:T.color,style:T.lineStyle,lineWidth:T.lineWidth,lineOpacity:T.lineOpacity,listIndex:qt,operator:n.operator,poi:Br()}),this.userData.showLabel){let ai=this.computedLabels&&this.computedLabels[qt||0];d.push({graphMode:22,objectType:23,segments:[[ge,zt,Fe,Ft]],color:v,listIndex:qt,showLabel:!0,labelSize:this.metaData.computedLabelSize,labelAngle:this.metaData.computedLabelAngle,labelOrientation:this.userData.labelOrientation,labels:ai?[ai]:[z_(Iu,r)]})}return}let R;switch(n.graphMode){case 8:case 30:R=h.getCompiledFunction(["x","y"]);break;case 43:case 31:R=h.getCompiledFunction(["y","z"]);break;case 44:case 32:R=h.getCompiledFunction(["x","z"]);break;case 33:R=h.getCompiledFunction(["r","theta"]);break;case 45:case 34:R=h.getCompiledFunction(["theta","z"]);break;case 46:case 35:R=h.getCompiledFunction(["theta","phi"]);break;case 27:case 28:case 29:R=h.getCompiledFunction(["u","v"]);break;case 47:case 36:R=h.getCompiledFunction(["x","y","z"]);break;default:R=h.getCompiledFunction()}let H=xo(this),W=H&&H.discrete,$=U_(H,h),re;try{re=h.getCompiledDerivative()}catch(Q){}let j=this.metaData.evaluatedCDFMin,ve=this.metaData.evaluatedCDFMax;if(j!==void 0&&ve!==void 0&&!isNaN(j)&&!isNaN(ve)&&y)if(W){let Q={viewState:r,graphInfo:T,compiled:R,bounds:[j,ve],maxOverride:H1(H,h),showPoint:this.userData.shouldGraph},ae=C1(Q),ge=ae.cdfTopBranch,zt=ae.topBranches;if(zt.forEach(function(Fe){!Fe||!$||(Fe.boundingBox=$)}),zt.every(Fe=>Fe!==void 0)&&(d=zt,ge&&ge.segments[0].length)){let Fe=[];ge.segments[0].forEach(function(Ft){!isNaN(Ft[0])&&!isNaN(Ft[1])&&Fe.push([Ft[0],0,Ft[0],Ft[1]])}),d.push({graphMode:5,segments:Fe,boundingBox:$,poi:Br(),color:v})}}else{let ae=L1({viewState:r,graphInfo:T,compiled:R,derivative:re,bounds:[j,ve]}),ge=ae.cdfTopBranch,zt=ae.topBranches;if(zt.forEach(function(Fe){!Fe||!$||(Fe.boundingBox=$)}),d=zt,ge&&ge.segments.length){let Fe,Ft;for(let qt=0;qt<ge.segments.length;qt++){let $r=ge.segments[qt];if($r.length>=4){Fe=$r[0];break}}for(let qt=ge.segments.length-1;qt>=0;qt--){let $r=ge.segments[qt];if($r.length>=4){Ft=$r[$r.length-2];break}}if(Fe!==void 0&&Ft!==void 0&&isFinite(Fe)&&isFinite(Ft)){let qt=Cd(ge.segments,[[Fe,0,Ft,0]],ge.graphMode);d.push({graphMode:7,segments:qt,poi:Br(),color:v})}}}else if(W){let Q=Rd({viewState:r,graphInfo:T,compiled:R,showPoint:this.userData.shouldGraph,maxOverride:H1(H,h)});$&&(Q.boundingBox=$),d.push(Q)}else{let Q=this.userData.lines===void 0?!0:this.userData.lines,ae=this.userData.surfaces===void 0?!0:this.userData.surfaces,ge={viewState:r,graphInfo:T,compiled:R,derivative:re};if(ae&&ad(T.graphMode)){let Fe=Zs(ge);d.push(Fe)}let zt=T.graphMode===44||T.graphMode===43||T.graphMode===45||T.graphMode===46||T.graphMode===47;if(!ad(T.graphMode)||zt){switch(T.graphMode){case 44:ge.graphInfo.graphMode=2;break;case 43:ge.graphInfo.graphMode=1;break;case 45:let{min:Ft,max:qt}=((we=T.domain)==null?void 0:we.type)==="1d"?T.domain:{min:0,max:2*Math.PI};ge.graphInfo.graphMode=6,ge.graphInfo.domain={type:"1d",min:Ft,max:qt,isExplicit:this.metaData.isExplicitDomain};break;case 46:let{uMin:$r,uMax:Iu}=((Dt=T.domain)==null?void 0:Dt.type)==="2d"?T.domain:{uMin:0,uMax:2*Math.PI};ge.graphInfo.graphMode=6,ge.graphInfo.domain={type:"1d",min:$r,max:Iu,isExplicit:this.metaData.isExplicitDomain};break;case 47:ge.graphInfo.graphMode=8;break}let Fe=Zs(ge);if($&&(Fe.boundingBox=$),Fe.fillSegments){let _e=Fe,{fillSegments:Ft}=_e,qt=oT(_e,["fillSegments"]);Q||(qt.lineWidth=0),d.push(qt)}else Q||(Fe.lineWidth=0),(Q||!ad(n.graphMode))&&d.push(Fe);T.graphMode===8&&T.operator!=="="&&d.push({graphMode:7,segments:Fe.fillSegments,poi:Br(),listIndex:T.listIndex,color:v,fillOpacity:E})}}}),d}case 16:{let d=[],y=this.userData.lines===void 0?!0:this.userData.lines,g=this.userData.fill===void 0?!0:this.userData.fill;if(!g&&!y)return d;let h=Pa(this.metaData,["computedLineOpacity","computedLineWidth","colorLatexValue","fillOpacity"],s),P=t.asValue();k(t.valueType)||(P=[P]);for(let T=0;T<P.length;T++){if(T>h-1)continue;let D=P[T];if(!D.length)continue;let N=this.getGraphInfo(e,t),{listIndex:I,lineWidth:O,lineOpacity:E,fillOpacity:v,color:_}=Ia(this,T,s);this.userData.shouldOmitLastPolygonSegment||(D=[...D,D[0]]),rn(D);let z=$1(D);if(z.length&&(g&&d.push({segments:z,graphMode:7,poi:Br(),color:_,fillOpacity:v,style:N.style,listIndex:I}),y&&d.push({segments:z,graphMode:5,poi:Br(),color:_,style:this.userData.lineStyle,lineWidth:O,lineOpacity:E,listIndex:I}),F_&&this.userData.showLabel)){let R=this.computedLabels&&this.computedLabels[I||0];d.push({graphMode:22,objectType:16,segments:z,color:_,listIndex:I,showLabel:!0,labelSize:this.metaData.computedLabelSize,labelAngle:this.metaData.computedLabelAngle,labelOrientation:this.userData.labelOrientation,labels:R?[R]:[G_(Bh(D),r)]})}}return d}case 7:case 11:case 10:case 15:case 22:return!1;default:let m=n.graphMode;throw new Error(`Unexpected graphMode: ${m}`)}}function k1(e){return e==="gradient_u"||e==="gradient_v"||e==="checkers"||e.startsWith("shader:")||e.startsWith("data:image")}function Bd(e,t,r){return{resolved:!0,graphMode:t,segments:r,operator:e.operator,poi:Br(),color:e.color,style:"DASHED",lineWidth:1,lineOpacity:.5,isIntersectionExtension:!0}}function U1(e,t){var n,i;if(!t)return[];let r=[];for(let s of e)if(s.graphMode===17){let o=t[(n=s.listIndex)!=null?n:0];if(!o)continue;let a=0,u,l=1,c,[p,f,m,d]=s.segments[0];for(let y=0;y<o.length;y++){let[g,h]=o[y],P=wi(g,h,0,p,f,0,m,d,0);P<a&&(a=P,u=y),s.graphMode===17&&P>l&&(l=P,c=y)}u!==void 0&&r.push(Bd(s,17,[[p,f,o[u][0],o[u][1]]])),c!==void 0&&r.push(Bd(s,17,[[m,d,o[c][0],o[c][1]]]))}else if(s.graphMode===21){let o=t[(i=s.listIndex)!=null?i:0];if(!o)continue;let[a,u,l,c,p]=s.segments[0],f=p-c+(p<c?1:-1)*2*Math.PI,m=[];for(let d of o){let[y,g]=d,h=Math.atan2(g-u,y-a),P=cT(h,c,f);0<P&&P<1&&m.push(P)}if(m.length){m.push(0,1),m.sort();let d=0,y=0;for(let P=0;P<m.length-1;P++){let T=m[P+1]-m[P];(d===void 0||T>d)&&(d=T,y=P)}let g=m[y],h=m[y+1];g>0&&r.push(Bd(s,21,[[a,u,l,c,c+g*f]])),h<1&&r.push(Bd(s,21,[[a,u,l,p,p-(1-h)*f]]))}}return r}function k_(){throw new Error("Programming error: this function is not expected to be called")}function Y1(e,t,r,n){let i=[];for(let s=0;s<t.otherVariableSolutionData.length;s++){let o=t.otherVariableSolutionData[s];if(!o)continue;let{coefficients:a,restriction:u}=o,l=a.argNames[0];if(l!=="x"&&l!=="y")continue;let c=a.getCompiledFunction().fn,p,f;l==="y"?(p=1,f=2):(p=2,f=1);let m=void 0,{listIndex:d,style:y,lineWidth:g,lineOpacity:h,color:P}=Ia(e,s,m),T=Pu(r,{graphMode:p,domainBound:Wr(),lineWidth:g,operator:"="},k_);if(!T)continue;let D=N1(c,T);for(let N of D){let I=new hr(u.substituteConstantArguments({[l]:N})),O=e.getGraphInfo(n,I);O=ue(X({},O),{graphMode:f,lineWidth:g});let E=void 0,v=e._graph(n,I,r,O,E,t.branchMultiplier===2?"solvedEquation":void 0);if(Hi(v))for(let _ of v)i.push(ue(X({},_),{listIndex:d,style:y,lineWidth:g,lineOpacity:h,color:P}))}}return i.length>0?i:!1}b.Base.prototype.tryGraph=function(e,t,r,n){try{return this.graph(e,t,r,n)}catch(i){let s=i instanceof b.Error?i.getError():Ce().getError();return[O1(s)]}};b.Base.prototype.graph=function(e,t,r,n){let i=this.getGraphInfo(e,t);return this._graph(e,t,r,i,n)};b.BaseComparator.prototype.graph=function(e,t,r){let n=this.getGraphInfo(e,t),i=n.graphMode,s="baseComparator",o=this.userData.lines===void 0?!0:this.userData.lines;if(i===8)return this._graph(e,t,r,n);if(i===10||!(t instanceof b.SolvedEquation))return!1;let a=this.getOperator(),u=[],l=[],c=!0;t._expression.eachElement(function(g){u.push(g.getCompiledFunction());try{l.push(g.getCompiledDerivative())}catch(h){c=!1}}),c||(l=void 0);let p=[],f=[-1,0,0,1],m=Pa(this.metaData,["computedLineWidth","computedLineOpacity","computedFillOpacity","colorLatexValue"],s),d=Math.min(u.length,m);for(let g=0;g<d;g++){let h=this.getGraphInfo(e,t._expression.args[g]);h.graphMode=i;let{listIndex:P,style:T,color:D,lineWidth:N,lineOpacity:I,fillOpacity:O}=Ia(this,g,s);h.listIndex=P,h.style=T,h.color=D,n.graphMode===6&&(h.domain={type:"1d",min:this.metaData.evaluatedDomainMin,max:this.metaData.evaluatedDomainMax,isExplicit:this.metaData.isExplicitDomain});let E=Zs({viewState:r,graphInfo:h,compiled:u[g],derivative:l?l[g]:void 0});E.lineWidth=N,E.lineOpacity=I,E.fillOpacity=O,E.operator=Yo(en[a].inclusive,f[g%4]),o||(E.lineWidth=0),p.push(E)}for(let g=0;g<d;g+=4){let h=Cd(p[g+1].segments,p[g+2].segments,i);p.push({graphMode:7,listIndex:p[g].listIndex,segments:h,poi:Br(),fillOpacity:p[g].fillOpacity,color:p[g].color})}let y=Y1(this,t,r,e);if(y){for(let g of y)g.operator=Yo(en[a].inclusive,0);Array.prototype.push.apply(p,y)}return p};b.DoubleInequality.prototype.graph=function(e,t,r){let n=this.getGraphInfo(e,t);if(n.graphMode===10)return!1;let i=[],s=Yo(en[this._operators[0]].inclusive,0),o=Yo(en[this._operators[1]].inclusive,0),a=this.userData,u=this.metaData,l=a.lines===void 0?!0:a.lines,c=["colorLatexValue","computedFillOpacity"];l&&c.push("computedLineWidth","computedLineOpacity");let p=Pa(u,c),f=t._expressions;return rn(f),Vd.eachArgs(f,(m,d)=>{let y=d;if(y>=p)return;m[0].userData=m[1].userData=a,m[0].metaData=m[1].metaData=u;let g=void 0,{color:h,lineWidth:P,lineOpacity:T,fillOpacity:D}=Ia(this,y,g),N=this._graph(e,m[0],r,n)[0];N.listIndex=y,N.operator=s,N.color=h,N.lineWidth=P,N.lineOpacity=T,i.push(N);let I=this._graph(e,m[1],r,n)[0];I.listIndex=y,I.operator=o,I.color=h,I.lineWidth=P,I.lineOpacity=T,i.push(I);let O=N.segments,E=I.segments;rn(O),rn(E);let v=Cd(O,E,N.graphMode);l||(N.lineWidth=0,I.lineWidth=0),i.push({graphMode:7,listIndex:N.listIndex,segments:v,lineOpacity:T,fillOpacity:D,poi:Br(),color:h})}),i};b.Regression.prototype.graph=function(e,t,r){let n=this.getGraphInfo(e,t);return this._graph(e,t.model,r,n)};function Qx(e,t){let r=1/0,n=-1/0,i=1/0,s=-1/0;for(let a of t)for(var o=0;o<a.length;o+=2){let u=a[o],l=a[o+1];u<r&&(r=u),u>n&&(n=u),l<i&&(i=l),l>s&&(s=l)}if(isFinite(r)&&isFinite(i))return{type:e,xmin:r,ymin:i,xmax:n,ymax:s}}function U_(e,t){if(!e||!(t instanceof hr))return;let r=t._chunk,n=r.getInstruction(r.getReturnIndex());if(n.type!==37)return;let i=e.discrete?"discreteDistribution":"continuousDistribution";if(e.symbol==="binomialdist"&&n.symbol==="binompdf"){let s=Nt(r,n.args[1]),o=Nt(r,n.args[2]),a=bf(o*s,s,o);return{type:i,xmin:0,xmax:s,ymin:0,ymax:a}}if(e.symbol==="poissondist"&&n.symbol==="poissonpdf"){let s=Nt(r,n.args[1]),o=Math.max(Za(Math.floor(s),s),Za(Math.ceil(s),s));return{type:i,xmin:0,xmax:2.5*s,ymin:0,ymax:o}}if(e.symbol==="normaldist"&&n.symbol==="normalpdf"){let s=Nt(r,n.args[1]),o=Nt(r,n.args[2]),a=Sh(s,s,o);return{type:i,xmin:s-2*Math.abs(o),xmax:s+2*Math.abs(o),ymin:0,ymax:a}}if(e.symbol==="uniformdist"&&n.symbol==="uniformpdf"){let s=Nt(r,n.args[1]),o=Nt(r,n.args[2]),a=(s+o)/2,u=o-s,l=Ah(a,s,o);return{type:i,xmin:s-u/3,xmax:o+u/3,ymin:0,ymax:l}}if(e.symbol==="tdist"&&n.symbol==="tpdf"){let s=Nt(r,n.args[1]),o=hf(0,s);return{type:i,xmin:-3,xmax:3,ymin:0,ymax:o}}}function H1(e,t){if(e===void 0||e.symbol!=="binomialdist"||!(t instanceof hr))return;let r=t._chunk,n=r.getInstruction(r.getReturnIndex());if(n.type===37&&n.symbol==="binompdf")return Nt(r,n.args[1])}function W1(e,t,r){let n={};r-=.5*t;for(var i=e.length-1;i>=0;i--){let s=e[i],o=Math.floor((s-r)/t);n[o]?n[o].data.push(s):n[o]={id:o,data:[s],min:o*t+r,max:o*t+r+t,center:o*t+r+t/2}}return n}b.Histogram.prototype.graph=function(e,t,r){let n=this.getGraphInfo(e,t),i=t.args[0].asValue(),s=t.args[1].asValue(),o=this.userData.vizProps&&this.userData.vizProps.binAlignment==="left"?s/2:0;rn(i);let a=W1(i,s,o),u=1;this.userData.vizProps&&this.userData.vizProps.histogramMode==="density"?u=1/(i.length*s):this.userData.vizProps&&this.userData.vizProps.histogramMode==="relative"&&(u=1/i.length);let l=[],c=[];for(let f in a){let m=a[f],d=m.data.length;c.push([m.min,0*u,m.min,d*u,m.max,d*u,m.max,0*u]);let y=0;a[m.id+1]&&(y=a[m.id+1].data.length);let g=[m.min,0*u,m.min,d*u,m.max,d*u];y<d&&g.push(m.max,y*u),l.push(g)}let p=Qx("histogram",c);return p&&s&&(p.binWidth=s),[{segments:c,graphMode:7,boundingBox:p,poi:Br(),color:n.color,fillOpacity:.4},{segments:l,graphMode:2,poi:{zeros:{x:[],y:[]},extrema:{x:[],y:[]},intercept:{x:[],y:[]}},color:n.color}]};b.DotPlot.prototype.graph=function(e,t,r){let n=this.getGraphInfo(e,t),i=t.args[1].asValue(),s=this.userData.vizProps&&this.userData.vizProps.binAlignment==="left"?i/2:0,o=t.args[0].asValue();rn(o);let a=W1(o,i,s),u=!1,l,c=[];for(let h in a){let P=a[h];for(var p=P.data.length-1;p>=0;p--)P.center!==P.data[p]&&(u=!0)}if(this.userData.vizProps&&this.userData.vizProps.dotplotXMode==="exact")for(let h in a){l=a[h].data,l.reverse();for(let T=0;T<l.length;T++)c.push([l[T],T+1])}else for(let h in a){let P=a[h];l=P.data;for(let T=0;T<l.length;T++)c.push([P.center,T+1])}let f=Qx("dotplot",c);f&&i&&(f.ymin=0,f.xmin-=.5*i,f.xmax+=.5*i,f.binWidth=i);let{computedPointOpacity:m,computedPointSize:d}=this.metaData,y=js(m,0),g=this.userData.pointSize?js(d,0):14;return[{segments:[c],graphMode:3,boundingBox:f,poi:Ni(c),color:n.color,style:this.userData.pointStyle,pointSize:g,pointOpacity:y,showPoint:!0,needsDotplotXMode:u}]};b.BoxPlot.prototype.graph=function(e,t,r){let n=this.getGraphInfo(e,t),i=this.metaData.evaluatedAxisOffset,s=this.metaData.evaluatedBreadth,o=t.args[0].asValue();if(rn(o),isNaN(s)||isNaN(i))return!1;let a=Math.min.apply(null,o),u=Math.max.apply(null,o),l=la(o,1),c=la(o,2),p=la(o,3),f=i,m=f-s/2,d=f+s/2,y=s/10,g=[];if(this.userData.vizProps.showBoxplotOutliers){let D=p-l,N=l-1.5*D,I=p+1.5*D;a=1/0,u=-1/0,o.forEach(function(O){N<=O&&O<a&&(a=O),u<O&&O<=I&&(u=O),(O<N||O>I)&&g.push([O,f])})}let h=[[l,m,p,m,p,d,l,d,l,m],[c,m,c,d],[l,f,a,f],[p,f,u,f],[a,f-y,a,f+y],[u,f-y,u,f+y]];if(this.userData.vizProps&&this.userData.vizProps.alignedAxis==="y"){for(let D of h)for(var P=0;P<D.length;P+=2){let N=D[P];D[P]=D[P+1],D[P+1]=N}for(let D of g){let N=D[0];D[0]=D[1],D[1]=N}}let T=[{segments:h,graphMode:5,boundingBox:Qx("boxplot",h.concat(g)),poi:Br(),color:n.color}];return g.length&&T.push({segments:[g],graphMode:3,color:n.color,style:"OPEN",showPoint:!0,poi:Ni(g)}),T};function H_(e){return Array.prototype.concat.apply([],e)}b.Table.prototype.isValueDraggable=function(e,t,r){if(!e.columns[t].isIndependent)return!1;let i=this.columns[t].values,s=i&&i[r];return!!(s&&isFinite(s.asValue())&&s.getDependencies().length===0)};b.Table.prototype.graph=function(e,t,r){let n={};if(t.columns[0].isError)return n;let s=t.columns[0].values;for(let o=1;o<this.columns.length;o++){let a=t.columns[o];if(a.isError)continue;let u=this.columns[o].header.userData,l=this.columns[o].header.metaData;if(u.hidden)continue;let c=Pa(l,["colorLatexValue","computedPointSize","computedPointOpacity"]),p=u.dragMode,f=p==="X"||p==="XY",m=p==="Y"||p==="XY",d=!!u.points,y=!!u.lines,g=[],h=[],P=[],T=[],D=[],N=[],I=1/0,O=-1/0,E=1/0,v=-1/0,_={};for(let R=0;R<s.length;R++){let H=s[R],W=a.values[R];if(!H||!W||!isFinite(H.asValue())||!isFinite(W.asValue())){_[R]=!0,y&&(N.length>1&&D.push(N),N=[]);continue}let $=H.asValue(),re=W.asValue();if(d){if(R>=c)continue;let j=f&&this.isValueDraggable(t,0,R),ve=m&&this.isValueDraggable(t,o,R);j||ve?(P.push([$,re]),T.push({index:R,dragX:j,dragY:ve})):h.push([$,re])}y&&N.push([$,re]),$<I&&(I=$),$>O&&(O=$),re<E&&(E=re),re>v&&(v=re)}let z={type:"table",xmin:I,xmax:O,ymin:E,ymax:v};P.length&&g.push({graphMode:4,segments:[P],color:l.colorLatexValue||u.color,tableId:u.tableId,poi:Ni(P),movablePointInfo:T,boundingBox:z,pointOpacity:l.computedPointOpacity}),h.length&&g.push({segments:[h],droppedIndices:_,graphMode:3,showPoint:!0,poi:Ni(h),color:l.colorLatexValue||u.color,pointSize:l.computedPointSize,pointOpacity:l.computedPointOpacity,style:u.pointStyle,tableId:u.tableId,boundingBox:z}),(D.length||N.length)&&(D.push(N),g.push({segments:D.map(H_),graphMode:5,poi:Br(),color:As(u,l),style:u.lineStyle,lineWidth:Array.isArray(l.computedLineWidth)?l.computedLineWidth[0]:l.computedLineWidth,lineOpacity:Array.isArray(l.computedLineOpacity)?l.computedLineOpacity[0]:l.computedLineOpacity,tableId:u.tableId,boundingBox:z})),g.length&&(n[u.id]=g)}return n};function $_(e,t,r){return e?t===0&&r===0?e[2].type!=="none"||e[3].type!=="none":t!==0&&r!==0?e[0].type!=="none"&&e[1].type!=="none":t!==0?e[0].type!=="none":r!==0?e[1].type!=="none":!1:!1}b.Image.prototype.graph=function(e,t,r){let n=[];if(t.center.valueType!==A||t.center.getDependencies().length!==0||!t.radianAngle.isConstant||!t.width.isConstant||!t.height.isConstant||!t.opacity.isConstant)return n;let i=[],s=[],o=t.width.asValue()/2,a=t.height.asValue()/2,u=t.radianAngle.asValue();for(var l=-1;l<=1;l++)for(var c=-1;c<=1;c++){let[p,f]=t.center.asValue(),m=[p+l*o*Math.cos(u)+c*a*Math.sin(u),f-l*o*Math.sin(u)+c*a*Math.cos(u)];$_(t.moveStrategy,l,c)&&(i.push(m),s.push([l,c]))}return n.push({segments:[i],scaleFactors:[s],graphMode:4,color:As(this.userData,this.metaData),style:this.userData.style,poi:Ni(i),movablePointInfo:[],pointOpacity:1}),n};function $1(e){let t=[],r=[];for(let[n,i]of e)!isNaN(n)&&!isNaN(i)?t.push(n,i):(t.length>=4&&r.push(t),t=[]);return t.length>=4&&r.push(t),r}b.List.prototype.elementAt=function(e){return e=Math.floor(e),e>=0&&e<this.args.length?this.args[e]:new b.Constant(NaN)};b.List.prototype.eachElement=function(t){for(var r=0;r<this.length;r++)t(this.elementAt(r),r)};b.List.prototype.mapElements=function(t){for(var r=[],n=0;n<this.length;n++)r.push(t(this.elementAt(n),n));return r};b.IRExpression.prototype.elementAt=function(e){var t=this._chunk.elementAt(e);return new hr(t)};b.ParenSeq.prototype.elementAt=function(e){return e<0||e>this.args.length-1?new b.Constant(NaN):this.args[e]};function Y_(){return vr(this._symbol)+" "}b.Identifier.prototype.printLatex=Y_;b.Constant.prototype.printLatex=function(){return Ns(this.asValue())};b.Ticker.prototype.printLatex=function(){return"\\ticker\\left("+this.args.map(ln).join(", ")+"\\right)"};b.Negative.prototype.printLatex=function(){return"-\\left("+this.args[0].printLatex()+"\\right)"};b.Add.prototype.printLatex=function(){return"\\left("+this.args[0].printLatex()+"\\right)+\\left("+this.args[1].printLatex()+"\\right)"};b.PercentOf.prototype.printLatex=function(){return this.args[0].printLatex()+" \\% \\operatorname{of} "+this.args[1].printLatex()};b.Subtract.prototype.printLatex=function(){return"\\left("+this.args[0].printLatex()+"\\right)-\\left("+this.args[1].printLatex()+"\\right)"};b.Multiply.prototype.printLatex=function(){return"\\left("+this.args[0].printLatex()+"\\right)*\\left("+this.args[1].printLatex()+"\\right)"};b.DotMultiply.prototype.printLatex=function(){return"\\left("+this.args[0].printLatex()+"\\right)\\cdot\\left("+this.args[1].printLatex()+"\\right)"};b.CrossMultiply.prototype.printLatex=function(){return"\\left("+this.args[0].printLatex()+"\\right)\\times\\left("+this.args[1].printLatex()+"\\right)"};b.Divide.prototype.printLatex=function(){return"\\frac{"+this.args[0].printLatex()+"}{"+this.args[1].printLatex()+"}"};b.Exponent.prototype.printLatex=function(){return"\\left("+this.args[0].printLatex()+"\\right)^{"+this.args[1].printLatex()+"}"};b.Assignment.prototype.printLatex=function(){return vr(this._symbol)+"="+this._expression.printLatex()};b.CoordinateEquation.prototype.printLatex=function(){return"\\left("+this._symbols.map(e=>vr(e)).join(",")+"\\right)="+this._expression.printLatex()};b.Equation.prototype.printLatex=function(){return this._lhs.printLatex()+"="+this._rhs.printLatex()};function zl(e){switch(e){case">":return">";case"<":return"<";case">=":return"\\ge ";case"<=":return"\\le ";case"=":return"="}return""}b.BaseComparator.prototype.printLatex=function(){return"\\left("+this.args[0].printLatex()+"\\right)"+zl(this.operator)+"\\left("+this.args[1].printLatex()+"\\right)"};b.DoubleInequality.prototype.printLatex=function(){return"\\left("+this.args[0].printLatex()+"\\right)"+zl(this.args[1])+this.args[2].printLatex()+zl(this.args[3])+"\\left("+this.args[4].printLatex()+"\\right)"};b.And.prototype.printLatex=function(){if(!(this.args[0]instanceof b.BaseComparator)||!(this.args[1]instanceof b.BaseComparator))throw new Error("Not implemented");if(this.args[0].args[1].printLatex()!==this.args[1].args[0].printLatex())throw new Error("Not implemented");return"\\left("+this.args[0].args[0].printLatex()+"\\right)"+zl(this.args[0].operator)+"\\left("+this.args[0].args[1].printLatex()+"\\right)"+zl(this.args[1].operator)+"\\left("+this.args[1].args[1].printLatex()+"\\right)"};function ln(e){return e.printLatex()}function W_(){switch(this._symbol){case"sqrt":return"\\sqrt{"+this.args[0].printLatex()+"}";case"nthroot":return"\\sqrt["+this.args[1].printLatex()+"]{"+this.args[0].printLatex()+"}";case"logbase":return"\\log_{"+this.args[1].printLatex()+"}\\left("+this.args[0].printLatex()+"\\right)";default:return vr(this._symbol)+"\\left("+this.args.map(ln).join(", ")+"\\right)"}}b.FunctionCall.prototype.printLatex=W_;b.SeededFunctionCall.prototype.printLatex=function(){return vr(this._symbol)+"\\left("+this.args.slice(1).map(ln).join(", ")+"\\right)"};b.DotAccess.prototype.printLatex=function(){return"("+this.args[0].printLatex()+").("+this.args[1].printLatex()+")"};b.Prime.prototype.printLatex=function(){switch(this.args[0]._symbol){case"logbase":return"\\log_{"+this.args[0].args[1].printLatex()+"}"+Array(this.order+1).join("'")+"\\left("+this.args[0].args[0].printLatex()+"\\right)";default:return vr(this.args[0]._symbol)+Array(this.order+1).join("'")+"\\left("+this.args[0].args.map(ln).join(", ")+"\\right)"}};b.List.prototype.printLatex=function(){return"\\left["+this.args.map(ln).join(", ")+"\\right]"};b.Range.prototype.printLatex=function(){return"\\left["+this.args[0].args.map(ln).join(", ")+" ... "+this.args[1].args.map(ln).join(", ")+"\\right]"};b.UpdateRule.prototype.printLatex=function(){return this.args[0].printLatex()+"\\to("+this.args[1].printLatex()+")"};b.ListAccess.prototype.printLatex=function(){return"\\left("+this.args[0].printLatex()+"\\right)\\left["+this.args[1].printLatex()+"\\right]"};b.ParenSeq.prototype.printLatex=function(){return"\\left("+this.args.map(ln).join(", ")+"\\right)"};b.BareSeq.prototype.printLatex=function(){return this.args.map(ln).join(", ")};b.NamedCoordinateAccess.prototype.printLatex=function(){return"\\left(\\left("+this.args[0].printLatex()+"\\right)."+this.symbol+"\\right)"};b.Norm.prototype.printLatex=function(){return"\\left|"+this.args[0].printLatex()+"\\right|"};b.Sum.prototype.printLatex=function(){return"\\sum_{"+this.args[0].printLatex()+"="+this.args[1].printLatex()+"}^{"+this.args[2].printLatex()+"}\\left("+this.args[3].printLatex()+"\\right)"};b.Product.prototype.printLatex=function(){return"\\prod_{"+this.args[0].printLatex()+"="+this.args[1].printLatex()+"}^{"+this.args[2].printLatex()+"}\\left("+this.args[3].printLatex()+"\\right)"};b.Integral.prototype.printLatex=function(){return"\\int_{"+this.args[1].printLatex()+"}^{"+this.args[2].printLatex()+"}\\left("+this.args[3].printLatex()+"\\right)d"+this.args[0].printLatex()};b.FunctionExponent.prototype.printLatex=function(){return this.args[0].printLatex()+"\\left("+this.args[1].printLatex()+"\\right)^{"+this.args[2].printLatex()+"}"};b.FunctionFactorial.prototype.printLatex=function(){return this.args[0].printLatex()+"\\left("+this.args[1].printLatex()+"\\right)!"};function X1(e){return e.isConstant&&e.asValue()===!0}function X_(e){return e.isConstant&&e.isNaN()}b.Piecewise.prototype.printLatex=function(){var e=this;if(X1(e.args[0]))return e.args[1].printLatex();for(var t=["\\left\\{"];;){if(X1(e.args[0])){t.push(e.args[1].printLatex());break}if(t.push(e.args[0].printLatex(),": "),X_(e.args[2])){t.push(e.args[1].printLatex());break}if(t.push(e.args[1].printLatex(),", "),!(e.args[2]instanceof b.Piecewise)){t.push(e.args[2].printLatex());break}e=e.args[2]}return t.push("\\right\\}"),t.join("")};b.FunctionDefinition.prototype.printLatex=function(){return vr(this._symbol)+"\\left("+this._argSymbols.map(vr).join(", ")+"\\right) = "+this._expression.printLatex()};b.Derivative.prototype.printLatex=function(){return"\\frac{d}{d"+vr(this._symbol)+"}\\left("+this.args[0].printLatex()+"\\right)"};b.Regression.prototype.printLatex=function(){return"\\left("+this._lhs.printLatex()+"\\right)\\sim\\left("+this._rhs.printLatex()+"\\right)"};b.Histogram.prototype.printLatex=function(){return"\\histogram\\left("+this.args.map(ln).join(", ")+"\\right)"};b.DotPlot.prototype.printLatex=function(){return"\\dotplot\\left("+this.args.map(ln).join(", ")+"\\right)"};b.BoxPlot.prototype.printLatex=function(){return"\\boxplot\\left("+this.args.map(ln).join(", ")+"\\right)"};b.TTest.prototype.printLatex=function(){return"\\TTest\\left("+this.args.map(ln).join(", ")+"\\right)"};b.IndependentTTest.prototype.printLatex=function(){return"\\IndependentTTest\\left("+this.args.map(ln).join(", ")+"\\right)"};b.Stats.prototype.printLatex=function(){return"\\Stats\\left("+this.args.map(ln).join(", ")+"\\right)"};b.AssignmentExpression.prototype.printLatex=function(){return vr(this._symbol)+"="+this.args[1].printLatex()};b.ListComprehension.prototype.printLatex=function(){return"\\left["+this._body.printLatex()+"\\operatorname{for}"+this._inputLists.map(ln).join(", ")+"\\right]"};b.Substitution.prototype.printLatex=function(){return"\\left(\\left("+this._body.printLatex()+"\\right)\\operatorname{with}"+this._assignments.map(ln).join(", ")+"\\right)"};b.Construction.prototype.printLatex=function(){return"\\construction "};b.Base.prototype.getExpressionType=function(e,t){switch(e){case 37:case 38:case 39:return"POINT3D";case 24:case 25:case 26:case 42:return"CURVE3D_xyz_t";case 27:case 28:case 29:return"SURFACE_xyz_uv";case 34:return"SURFACE_r_\u03B8z";case 45:return"SURFACE_r_\u03B8z_AMBIGUOUS";case 33:return"SURFACE_z_r\u03B8";case 35:return"SURFACE_r_\u03B8\u03C6";case 46:return"SURFACE_r_\u03B8\u03C6_AMBIGUOUS";case 31:case 32:case 30:case 40:case 41:return"SURFACE";case 43:case 44:return"SURFACE_AMBIGUOUS";case 36:return"IMPLICIT_SURFACE";case 47:return"IMPLICIT_SURFACE_AMBIGUOUS";case 3:case 4:return t===A?"SINGLE_POINT":"POINT_LIST";case 1:case 2:return"X_OR_Y";case 5:return"PARAMETRIC";case 6:return"POLAR";case 8:return"IMPLICIT";default:return t!==void 0&&fe(t,Te)?"POLYGON":"X_OR_Y"}};b.Histogram.prototype.getExpressionType=function(e,t){return"HISTOGRAM"};b.DotPlot.prototype.getExpressionType=function(e,t){return"DOTPLOT"};b.BoxPlot.prototype.getExpressionType=function(e,t){return"BOXPLOT"};function Kx(e,t,r){let n=[],i={},s={},o={},a={},u={},l={},c={},p=0,f=[],m=[];if(!r){r=[];for(let h in t)t.hasOwnProperty(h)&&r.push(h)}for(let h in t){if(!t.hasOwnProperty(h))continue;let P=t[h].exportPenalty||0;for(;n.length<P+1;)n.push([]);n[P].push(h)}for(let h of n){let P={};for(let T of h){let D=t[T],N=t[T].exportPenalty||0,I=Pi(D),O=D.getLegalExports(e);for(let E of O)Se[E]||i[E]||(I&&(u[E]=!0),N===0&&(a[E]=!0),P[E]=P[E]||[],P[E].push(T),P[E].length>1&&(!s[E]&&I&&(o[E]=!0),s[E]=!0))}for(let T in P)o[T]||(i[T]=P[T])}for(let h of r)c.hasOwnProperty(h)||d(h);function d(h){c[h]=c[h]||{};let P=c[h],T;P.id=h,P.index=p,P.lowlink=p,f.push(P),P.instack=!0,p++;let D=t[h].getDependencies();for(let N of D){if(!i.hasOwnProperty(N))continue;let I=i[N];for(let O of I)c.hasOwnProperty(O)?(T=c[O],T.instack&&(P.lowlink=Math.min(P.lowlink,T.index))):(d(O),T=c[O],P.lowlink=Math.min(P.lowlink,T.lowlink))}if(P.lowlink===P.index)if(T=f.pop(),T.instack=!1,T===P)y(P);else{let N=[T];for(;T=f.pop(),T.instack=!1,N.push(T),T!==P;);g(N)}}function y(h){m.push(h.id)}function g(h){let P=[];for(let T=h.length-1;T>=0;T--){let D=h[T],N=t[D.id].getLegalExports(e);Array.prototype.push.apply(P,N),P.push(N[0]),m.push(D.id)}P=zo(P),P.sort();for(let T of P)l[T]=P}return{resolved:m,globallyDefined:a,tableDefined:u,multiplyDefined:s,multiplyDefinedByTables:o,cyclicallyDefined:l}}var Z_=100;function Gd(e){for(var t=[],r=0;r<e;r++)t[r]={x:[],y:[],intersects:[]};return t}function j_(e,t,r,n){return r===1&&n===1||r===2&&n===2?function(i){return t(i)-e(i)}:r===1&&n===2||r===2&&n===1?function(i){return i-t(e(i))}:!1}function j1(e,t){t instanceof b.SolvedEquation?t=t._expression:t instanceof b.OptimizedRegression&&(t=t.model);var r=[],n=[];return t instanceof b.DoubleInequality?b.List.eachArgs(t._expressions,function(i){r.push(i[0].getCompiledFunction()),n.push(i[0].isConstant&&i[1].isNaN()),r.push(i[1].getCompiledFunction()),n.push(i[1].isConstant&&i[1].isNaN())}):b.List.wrap(t).eachElement(function(i){r.push(i.getCompiledFunction()),n.push(i.isConstant&&i.isNaN())}),{functions:r,skipIntersecting:n}}function J_(e,t){var r=[];for(var n in e)if(e.hasOwnProperty(n)&&String(n)!==String(t)&&e[n].shouldIntersect()){var i=e[n],s=j1(i.policy,i.concreteTree);r.push({id:n,graphMode:i.getGraphMode(),functions:s.functions,skipIntersecting:s.skipIntersecting})}return r}function Q_(e,t){e.intersects=Array(e.x.length);for(var r=0;r<e.x.length;r++)e.intersects[r]=t}function K_(e,t){if(t===1){var r=e.y;e.y=e.x,e.x=r}}function eF(e,t){Array.prototype.push.apply(e.x,t.x),Array.prototype.push.apply(e.y,t.y),e.intersects&&t.intersects&&Array.prototype.push.apply(e.intersects,t.intersects)}function tF(e,t,r){var n=Yx(e,t),i=n.poi.zeros,s=n.poi.extrema,o=[],a=0,u=0;for(a=0;a<i.x.length;a++){for(;u<s.x.length&&s.x[u]<i.x[a];u++)Kr(s.y[u],0)&&o.push(s.x[u]);o.push(i.x[a])}for(;u<s.x.length;u++)Kr(s.y[u],0)&&o.push(s.x[u]);return{x:o,y:o.map(r)}}function J1(e,t,r){var n=e[r],i=n.getGraphInfo(),s=n.getGraphMode(),o,a,u;try{o=j1(n.policy,n.concreteTree),a=Gd(o.functions.length),u=J_(e,r)}catch(T){return Gd(0)}if(!u)return a;for(var l=0,c=0;c<u.length;c++)for(var p=u[c],f=0;f<o.functions.length;f++)if(!o.skipIntersecting[f]){for(var m=o.functions[f].fn,d=Pu(t,i,m),y=0;y<p.functions.length;y++)if(!u[c].skipIntersecting[y]){var g=p.functions[y].fn,h=j_(m,g,s,p.graphMode);if(h){var P;try{P=tF(h,d,m)}catch(T){return Gd(0)}if(l+=P.x.length,l>Z_)return Gd(o.functions.length);Q_(P,p.id),K_(P,s),eF(a[f],P)}}}return a}function rF(e){if(e.length<2)return"text";let t=e.split("`").length-1;return t<2?"text":t===2&&e[0]==="`"&&e[e.length-1]==="`"?"latex":"mixed"}function nF(e){if(e.length===0)return[""];let t=[],r=e.split(/(`)/),n=!1,i="";for(let s=0;s<r.length;s++){let o=r[s];o.length&&(o==="`"?(i+="`",n=!n,n||(t.push(i),i="")):(i+=o,n||(t.push(i),i="")))}return i.length&&t.push(i),t}function eT(e){return nF(e).map(iF)}function iF(e){let r="\\$({"+["[a-zA-Z][0-9]*","[a-zA-Z]_[a-zA-Z0-9]+","[a-zA-Z]_\\{[a-zA-Z0-9]+\\}","\\\\[a-zA-Z]+","\\\\[a-zA-Z]+_{[a-zA-Z0-9]+}","\\\\[a-zA-Z]+_[a-zA-Z0-9]+"].join("})|\\$({")+"})",n=new RegExp(r,"g"),i=[],s=0,o=0,a;for(;a=n.exec(e);){o=a.index,o>s&&i.push(e.substr(s,o-s));let u=a[0],l=u.replace(/[{}\$]/g,"").replace(/^([a-zA-Z])([0-9]+)$/,"$1_$2");i.push({symbol:l,str:u}),s=a.index+u.length}return s<e.length&&i.push(e.substr(s)),{raw:e,parts:i}}function Q1(e,t){return t?"{"+bm(e,{bigCutoff:1e7,digits:8})+"}":hm(e,{bigCutoff:1e7,digits:8})}function tT(e,t,r){return e.map(n=>sF(n,t,r)).join("")}function sF(e,t,r){let n=[],i=rF(e.raw)==="latex";for(let s of e.parts)if(typeof s=="string")n.push(s);else{let o=new b.Identifier(s.symbol).tryGetConcreteTree(Ff,t);if(o.valueType===x&&o.getDependencies().length===0){let a=o.asValue();if(typeof a=="number"){n.push(Q1(a,i));continue}}else if(o.valueType===Z&&r<o.length&&o.getDependencies().length===0){let a=o.elementAt(r).asValue();if(typeof a=="number"){n.push(Q1(a,i));continue}}i?n.push("{?}"):n.push("?")}return n.join("")}function K1(){let e={},t={},r={},n=[],i=this.statements[oi];for(let s in this.statements){if(!this.statements.hasOwnProperty(s))continue;let o=this.statements[s];switch(o.type){case"Error":break;case"Regression":{r[s]=[],n.push(s);break}case"Construction":break;default:{let a=o.getLegalExports(this.policy);if(a){for(let l of a)o.exportPenalty!==void 0&&o.exportPenalty>0?t[l]=s:e[l]=s;let u=[];for(let l of o.getDependencies())l==="construction"&&i?u.push(...i.getDependencies()):u.push(l);r[s]=cc(u,o.getDummyDependencies(),a)}break}}}for(let s of n){let o=this.statements[s],a=ps(o.userData.residualVariable);a&&(t[a]=s);let u=o.getDependencies().slice(),l={},c;for(;c=u.pop();){if(l[c])continue;l[c]=!0;let p=e[c]||t[c];if(p){u.push(...r[p]),r[s].push(c);continue}t[c]=s}}return{exportMap:e,weakExportMap:t,dependencyMap:r}}var ql=class{constructor(){this.data={}}getChildIntersections(t){return this.data[t]||{count:0}}addListParent(t,r,n){if(Eu(n.valueType,[A,Be]),r!==void 0)n.valueType===Be?this.addPoint(t,r,n.value[r]):this.addPoint(t,r,n.value);else{Eu(n.valueType,[Be]);for(let i=0;i<n.value.length;i++)this.addPoint(t,i,n.value[i])}}addPrimitiveParent(t,r){if(Eu(r.valueType,[A,Be]),r.valueType===A)this.addPoint(t,0,r.value);else for(let n=0;n<r.value.length;n++)this.addPoint(t,0,r.value[n])}addPoint(t,r,n){var s;let i=this.data[t]||{count:0};this.data[t]||(this.data[t]=i),i[r]||(i[r]=[]),(s=i[r])==null||s.push(n),i.count++}};var kl=class{constructor(t){this.singleExpression=t.singleExpression}isGeometryEnabled(){return!1}is3dProduct(){return!1}isBeta3d(){return!1}areAllScalesLinear(){return!0}assignmentForbidden(t){return this.substitutionForbidden(t)}substitutionForbidden(t){return t.slice(0,3)!=="ans"}isValidSlider(t){return!1}sliderVariables(){return[]}graphingEnabled(){return!1}ansEnabled(){return!this.singleExpression}dimensionVarsEnabled(){return!1}disabledFeatures(){return["Sum","Product","Integral","List","Derivative","Piecewise","Exponent","PercentOf","Substitution"]}};var Ul=class{constructor(t){this.singleExpression=t.singleExpression}isGeometryEnabled(){return!1}is3dProduct(){return!1}isBeta3d(){return!1}areAllScalesLinear(){return!0}assignmentForbidden(t){return this.substitutionForbidden(t)}substitutionForbidden(t){return this.singleExpression?t.slice(0,3)!=="ans":t.slice(0,3)==="tmp"}isValidSlider(t){return!1}sliderVariables(){return[]}graphingEnabled(){return!1}ansEnabled(){return!this.singleExpression}dimensionVarsEnabled(){return!1}disabledFeatures(){return this.singleExpression?["Sum","Product","Integral","Derivative","Piecewise","Substitution","PercentOf"]:["Sum","Product","Integral","Derivative","Piecewise","Substitution"]}};var Js=typeof performance!="undefined"?()=>performance.now():()=>Date.now();typeof self!="undefined"&&self.WorkerGlobalScope&&(self.Fragile={countReferences:Af,Opcodes:pt,Types:Ee,getConstantListLength:Wt,ParsenodeError:S});var{Constant:is,Seed:tO,FunctionCall:bF,Image:xF,Slider:TF,Table:PF,TableColumn:IF,Construction:MF}=b;function EF(e,t,r,n){switch(e){case"fourFunction":return new kl({singleExpression:!1});case"singleExpressionFourFunction":return new kl({singleExpression:!0});case"scientific":return new Ul({singleExpression:!1});case"singleExpressionScientific":return new Ul({singleExpression:!0});case"graphing":return new du({enableGeometry:!1,enable3d:t,beta3d:r,scales:n});case"geometry":return new du({enableGeometry:!0,enable3d:!1,beta3d:!1,scales:n});case"graphing_3d":return new mu(r)}}var vF={fourFunction:hc,singleExpressionFourFunction:hc,scientific:Em,singleExpressionScientific:vm,graphing:Lu,graphing_3d:Lu,geometry:Lu},oi="**geo_construction_statement_id**";function Dn(e,t){var r=xi(e,t);return r.isError||r instanceof b.Expression?r:Ce()}function OF(e){let t=e.rawTree.userData,r=e.rawTree.metaData;return!!(t.cdf&&t.cdf.show&&r.distributionSpec)}function SF(e){let t=e.evaluationState.expression_type,r=e.rawTree.userData;return!r.clickableInfo||!r.clickableInfo.enabled?!1:rd(e.rawTree)?!0:e.getGraphMode()===4?!1:Tv(t)}function _t(e,t){let r="id"+e;for(let[n,i]of t||[])r+="::"+n+i;return r}var NF=new is(he(0,1)),DF=new is(he(1,1)),AF=new is(NaN);function ns(e,t){return e?e==="0"?NF:e==="1"?DF:Dn(e,t):AF}function Lo(e,t){if(e)return Dn(e,t)}function RF(e){return e.slice(0,3)!=="ans"}function CF(e){return e.slice(0,6)!=="idref_"}function rO(e,t){let{multiplyDefined:r,multiplyDefinedByTables:n,cyclicallyDefined:i}=e;for(let s in r)r.hasOwnProperty(s)&&(t[s]=n[s]?eg(s):za(s));for(let s in i){if(!i.hasOwnProperty(s))continue;let o=e.tableDefined[s]&&!e.globallyDefined[s],a=i[s].filter(RF).filter(CF);t[s]=o?rg(a):mp(a)}}function $l(e,t,r){for(let n of r)e[n]||(e[n]=[]),e[n].push(t)}function nO(e,t,r){if(r.extraDepNodes)for(let n of r.extraDepNodes)n&&$l(e,t,n.getDependencies());r.clickHandler&&$l(e,t,r.clickHandler.getDependencies())}function LF(e,t,r){let n=e.evaluationState,i=e.rawTree,s=i.metaData.cdfMin,o=i.metaData.cdfMax,a={},u=NaN,l=NaN,c=i.type==="Assignment"?i._expression:i,p=c&&c.metaData&&c.metaData.distributionSpec;if(s){let g=s.tryGetConcreteTree(t,r);g.isConstant&&(u=+g.asValue());for(let h of g.getDependencies())a[h]=!0}else u=-1/0;if(o){let g=o.tryGetConcreteTree(t,r);g.isConstant&&(l=+g.asValue());for(let h of g.getDependencies())a[h]=!0}else l=1/0;let f=!0,m=!0;if(isNaN(u)&&(f=!1,u=NaN),isNaN(l)&&(m=!1,l=NaN),f?m?u>l&&(f=!1,m=!1,n.error=fg().getError()):n.error=pg().getError():n.error=cg().getError(),f&&m){let g=new bF("cdf",[c,new is(u),new is(l)]);n.cdf_evaluation=+g.tryGetConcreteTree(t,r).asValue()}let d=-1/0,y=1/0;if(p&&(p.discrete&&(d=0),p.symbol==="binomialdist"&&c.args&&c.args[0])){let g=+c.args[0].asValue();isFinite(g)&&(y=g)}i.metaData.evaluatedCDFMin=u,i.metaData.evaluatedCDFMax=l,n.cdf_min_valid=f,n.cdf_max_valid=m,n.cdf_min_default=d,n.cdf_max_default=y,n.is_single_identifier=!1,To(n,t,a)}function wF(e,t,r,n){let i={},s=!0,o=NaN,a,u=!1;if(r){let l=r.tryGetConcreteTree(e,t);a=l.getDependencies().length===0?l.asValue():NaN,u=Array.isArray(a),o=u?a:+a;for(let c of l.getDependencies())i[c]=!0}if(u){for(let l of o)if(!isFinite(+l)){s=!1,o=NaN;break}}else isFinite(+o)||(s=!1,o=NaN);return r||(s=!0,n!==void 0&&(o=n)),{value:o,valid:s,missingVarsMap:i}}var Hl={lineWidth:{parseNode:"lineWidth",valueOutputProp:"computedLineWidth",formulaOutputProp:"",validOutputProp:"line_width_valid",default:(e,t,r,n)=>{let i=r.isGeometryEnabled(),s=n!==void 0&&fe(n,Te),o=n!==void 0&&(fe(n,G)||fe(n,tr));return i&&s?2:o?1:2.5},transform:void 0,shouldEvaluate:void 0,seed:"lw"},resolution:{parseNode:"resolution",valueOutputProp:"computedResolution",formulaOutputProp:"",validOutputProp:"resolution_valid",default:()=>{},transform:void 0,shouldEvaluate:void 0,seed:"re"},checkers:{parseNode:"checkers",valueOutputProp:"computedCheckers",formulaOutputProp:"",validOutputProp:"checkers_valid",default:()=>Sd,transform:void 0,shouldEvaluate:void 0,seed:"ch"},lineOpacity:{parseNode:"lineOpacity",valueOutputProp:"computedLineOpacity",formulaOutputProp:"",validOutputProp:"line_opacity_valid",default:(e,t,r,n)=>{let i=r.isGeometryEnabled(),s=n!==void 0&&fe(n,Te);return i&&s?.6:.9},transform:void 0,shouldEvaluate:void 0,seed:"lo"},pointOpacity:{parseNode:"pointOpacity",valueOutputProp:"computedPointOpacity",formulaOutputProp:"",validOutputProp:"point_opacity_valid",default:(e,t,r)=>!e||!t?.9:e.getGraphMode(r,t)===4?1:.9,transform:void 0,shouldEvaluate:void 0,seed:"po"},pointSize:{parseNode:"pointSize",valueOutputProp:"computedPointSize",formulaOutputProp:"",validOutputProp:"point_size_valid",default:(e,t,r,n)=>n!==void 0&&fe(n,G)?3:9,shouldEvaluate:void 0,transform:void 0,seed:"ps"},fillOpacity:{parseNode:"fillOpacity",valueOutputProp:"computedFillOpacity",formulaOutputProp:"",validOutputProp:"fill_opacity_valid",default:(e,t,r,n)=>{let i=r.isGeometryEnabled(),s=n!==void 0&&fe(n,Te);return i&&s?.2:.4},transform:void 0,shouldEvaluate:e=>{if(!e)return!1;let{expression_type:t,is_inequality:r}=e.evaluationState;return!!(t==="POLYGON"||t==="PARAMETRIC"||t==="CURVE3D_xyz_t"||r)},seed:"fo"},labelSize:{parseNode:"labelSize",valueOutputProp:"computedLabelSize",formulaOutputProp:"",validOutputProp:"label_size_valid",transform:void 0,default:()=>1,shouldEvaluate:void 0,seed:"ls"},labelAngle:{parseNode:"labelAngle",valueOutputProp:"computedLabelAngle",formulaOutputProp:"label_angle_value",validOutputProp:"label_angle_valid",default:()=>0,transform:e=>`-\\trigAngleMultiplier*(${e})`,shouldEvaluate:void 0,seed:"la"}};function iO(e,t,r,n,i,s,o){let a=Hl[s],u;e&&(u=e.tryGetConcreteTree(n,i));let l=a.default&&a.default(e,u,n,o),c=wF(n,i,r[a.parseNode],l);r[a.valueOutputProp]=c.value,a.formulaOutputProp&&(t[a.formulaOutputProp]=c.value),t[a.validOutputProp]=c.valid,To(t,n,c.missingVarsMap)}function _F(e,t,r,n){let i,s,o;if(Pi(e.rawTree)&&e.evaluationState.column_data&&e.rawTree.columns)for(let a=0;a<e.evaluationState.column_data.length;a++){i=e.evaluationState.column_data[a];let u=e.rawTree.columns[a];Zi(u)||(s=u.header.metaData,o=s[n],iO(o,i,s,t,r,n,e.concreteTree.valueType))}else i=e.evaluationState,s=e.rawTree.metaData,o=s[n],iO(o,i,s,t,r,n,e.concreteTree.valueType)}function sO(e){return oa(e[0],e[1],e[2]).formatHex()}function oO(e,t,r,n,i){let s;if(e){let o=e.tryGetConcreteTree(n,i),a=o.getDependencies().length>0?void 0:o.asValue(),{valueType:u}=o;if(s=!!(a&&(u===tt||u===Tr)),s){let l=o&&o.valueType===tt?sO(a):a.map(sO);t.colorLatexValue=l,r.color_latex_value=l}}else s=!0;r.color_latex_valid=s}function FF(e,t,r){let n,i,s;if(Pi(e.rawTree)&&e.evaluationState.column_data&&e.rawTree.columns)for(let o=0;o<e.evaluationState.column_data.length;o++){n=e.evaluationState.column_data[o];let a=e.rawTree.columns[o];Zi(a)||(i=a.header.metaData,s=i.colorLatex,oO(s,i,n,t,r))}else n=e.evaluationState,i=e.rawTree.metaData,s=i.colorLatex,oO(s,i,n,t,r)}function BF(e){if(e.concreteTree.valueType===tt&&e.concreteTree.getDependencies().length>0){let t=e.concreteTree._chunk;try{e.evaluationState.shader=y0(t)}catch(r){e.evaluationState.error=r instanceof b.Error?r.getError():Ce().getError()}}}function VF(e,t,r){let n=e.evaluationState,i=e.rawTree,s={},o=i.metaData.clickHandler;if(!o)return;let a=o.tryGetConcreteTree(t,r);!a.isError&&a.valueType!==Ze&&(a=_u(te(a.valueType)));for(let l of a.getDependencies())t.validActionVariable(l)||(s[l]=!0);let u=Object.keys(s);u.length>0&&(a=Ct(u).setDependencies(a.getDependencies())),a.isError&&!ux(t,a)?n.click_handler={status:"error",error:a.getError()}:a.isEmptyAction?n.click_handler={status:"empty"}:n.click_handler={status:"maybe-valid"},To(n,t,s)}function GF(e,t,r){let n=e.evaluationState,i=e.rawTree,s=n.expression_type==="POLAR"||n.expression_type==="SURFACE_r_\u03B8z"||n.expression_type==="SURFACE_r_\u03B8z_AMBIGUOUS"?i.metaData.polarDomainMin:i.metaData.parametricDomainMin,o=n.expression_type==="POLAR"||n.expression_type==="SURFACE_r_\u03B8z"||n.expression_type==="SURFACE_r_\u03B8z_AMBIGUOUS"?i.metaData.polarDomainMax:i.metaData.parametricDomainMax,a={},u=NaN,l=NaN,c=!1;if(s){c=!0;let m=s.tryGetConcreteTree(t,r);m.isConstant&&(u=+m.asValue());for(let d of m.getDependencies())a[d]=!0}else u=0;if(o){c=!0;let m=o.tryGetConcreteTree(t,r);m.isConstant&&(l=+m.asValue());for(let d of m.getDependencies())a[d]=!0}else n.expression_type==="PARAMETRIC"||n.expression_type==="CURVE3D_xyz_t"?l=1:n.expression_type==="POLAR"?l=Math.PI*12/+r.trigAngleMultiplier.asValue():(n.expression_type==="SURFACE_r_\u03B8z"||n.expression_type==="SURFACE_r_\u03B8z_AMBIGUOUS")&&(l=Math.PI*2);let p=!0,f=!0;isFinite(u)||(p=!1,u=NaN),isFinite(l)||(f=!1,l=NaN),p?f?u>l&&(p=!1,f=!1,n.error=lg().getError()):n.error=gp().getError():n.error=yp().getError(),i.metaData.evaluatedDomainMin=u,i.metaData.evaluatedDomainMax=l,(n.expression_type==="POLAR"||n.expression_type==="SURFACE_r_\u03B8z"||n.expression_type==="SURFACE_r_\u03B8z_AMBIGUOUS")&&(i.metaData.isExplicitDomain=c),n.domain_min_number=u,n.domain_max_number=l,n.domain_min_valid=p,n.domain_max_valid=f,(n.expression_type==="PARAMETRIC"||n.expression_type==="CURVE3D_xyz_t")&&(delete a.t,To(n,t,a))}function zF(e,t,r){let n=e.evaluationState,i=n.expression_type,s=e.rawTree,o=s.metaData.parametricDomain3DuMin,a=s.metaData.parametricDomain3DuMax,u=s.metaData.parametricDomain3DvMin,l=s.metaData.parametricDomain3DvMax,c={},p=0,f=1,m=0,d=1;if(i==="SURFACE_r_\u03B8\u03C6"||i==="SURFACE_r_\u03B8\u03C6_AMBIGUOUS"?(f=2*Math.PI,d=Math.PI):i==="SURFACE_z_r\u03B8"&&(f=10,d=2*Math.PI),o){let y=o.tryGetConcreteTree(t,r);y.isConstant&&(p=+y.asValue());for(let g of y.getDependencies())c[g]=!0}if(a){let y=a.tryGetConcreteTree(t,r);y.isConstant&&(f=+y.asValue());for(let g of y.getDependencies())c[g]=!0}if(u){let y=u.tryGetConcreteTree(t,r);y.isConstant&&(m=+y.asValue());for(let g of y.getDependencies())c[g]=!0}if(l){let y=l.tryGetConcreteTree(t,r);y.isConstant&&(d=+y.asValue());for(let g of y.getDependencies())c[g]=!0}isFinite(p)||(p=NaN),isFinite(f)||(f=NaN),isFinite(m)||(m=NaN),isFinite(d)||(d=NaN),!isFinite(p)||!isFinite(m)?n.error=yp().getError():(!isFinite(f)||!isFinite(d))&&(n.error=gp().getError()),s.metaData.evaluatedDomain3DuMin=p,s.metaData.evaluatedDomain3DuMax=f,s.metaData.evaluatedDomain3DvMin=m,s.metaData.evaluatedDomain3DvMax=d,n.domain_min_u_valid=isFinite(p),n.domain_max_u_valid=isFinite(f),n.domain_min_v_valid=isFinite(m),n.domain_max_v_valid=isFinite(d),delete c.u,delete c.v,To(n,t,c)}function qF(e,t,r){let n=e.evaluationState,i=e.rawTree,s=i.metaData.vizAxisOffset,o=i.metaData.vizBreadth,a={},u=NaN,l=NaN;if(s){let f=s.tryGetConcreteTree(t,r);f.isConstant&&(u=+f.asValue());for(let m of f.getDependencies())a[m]=!0}else u=1;if(o){let f=o.tryGetConcreteTree(t,r);f.isConstant&&(l=+f.asValue());for(let m of f.getDependencies())a[m]=!0}else l=1;let c=!0,p=!0;isFinite(u)||(c=!1,u=NaN),isFinite(l)||(p=!1,l=NaN),c?p||(n.error=Py().getError()):n.error=Ty().getError(),i.metaData.evaluatedAxisOffset=u,i.metaData.evaluatedBreadth=l,n.viz_values={axisOffset:u,breadth:l},n.viz_valids={axisOffset:c,breadth:p},To(n,t,a)}function kF(e){return e.globalRandomSeed||[]}function rT(e,t,r,n,i){let s={},o={},a=[],u=[];for(let l in n)n[l]&&(o[l]=!0,a.push(l));for(let l in i)i[l]&&(s[l]=!0,u.push(l));for(;a.length||u.length;){for(;a.length;){let l=a.pop(),c=t[l];if(c)for(let p of c.getLegalExports(e))s[p]||(s[p]=!0,u.push(p))}for(;u.length;){let l=u.pop(),c=r[l];if(c)for(let p of c)o[p]||(o[p]=!0,a.push(p))}}return{ids:o,symbols:s}}function nT(e,t,r){if(e.isError||e.getDependencies().length||e.valueType!==Ze)return;let n=e.asValue();if(n)for(let i in n.updateRules){t[i]=sx(n,i);let{value:s,valueType:o}=n.updateRules[i];r[i]=new b.Assignment(i,Ke(o,s))}}var zd=class{constructor(){this.childIntersections=new ql;this.getCLSymbolMap=K1;this.statements={},this.analysis={},this.currentStatus={},this.currentLabel={},this.unpublishedIds={},this.dimensions={width:0,height:0},this.intersectId=void 0,this.dirtyExportedSymbolRoots={},this.dirtyStatementRoots={},this.markedRegressionDirty=!1,this.use_degrees=!1,this.initialEvaluation=!1,this.globalEventCount=0,this.actions=!0,this.substitutions=!0,this.setEvaluationMode("graphing"),this.setProduct("graphing"),this.setBeta3d(!1),this.setRestrictedFunctions(!1),this.setForceEnableGeometryFunctions(!1),this.setFunctionDefinition(!0),this.setReplaceRoundWithReciprocal(!1),this.setDistributions(!0),this.invalidate()}invalidate(){delete this.statements[oi];for(let r in this.statements)this.statements.hasOwnProperty(r)&&this.markAsDirtyRoot(r);this.currentStatus={},this.analysis={};let t=this.viewState?{xAxisScale:this.viewState.xAxisScale,yAxisScale:this.viewState.yAxisScale}:void 0;this.policy=EF(this.evaluationMode,this.product==="graphing-3d",this.beta3d,t),this.parent_frame=vF[this.evaluationMode].getFrame({restrictedFunctions:this.restrictedFunctions,forceEnableGeometryFunctions:this.forceEnableGeometryFunctions,isGeometryCalculator:this.evaluationMode==="geometry",is3DCalculator:this.product==="graphing-3d",replaceRoundWithReciprocal:this.replaceRoundWithReciprocal,distributions:this.distributions,additionalFunctions:this.additionalFunctions,trigAngleMultiplier:new is(this.use_degrees?Math.PI/180:he(1,1)),initialEvaluation:new is(this.initialEvaluation?1:0),globalEventCount:new is(0),globalRandomSeed:new tO(this.globalRandomSeedString||""),width:this.policy.dimensionVarsEnabled()?new is(he(this.dimensions.width,1)):vp("width"),height:this.policy.dimensionVarsEnabled()?new is(he(this.dimensions.height,1)):vp("height")}),this.frame=Object.create(this.parent_frame),this.lastFrame=Object.create(this.parent_frame),this.regressionFrame=Object.create(this.parent_frame),this.lastClockTickTime=void 0}processChangeSet(t){let r=Js(),n={cacheWrites:0,cacheReads:0,cacheHits:0,cacheMisses:0};WE(n);let i={intersections:{},graphs:{}};t.isCompleteState&&(this.invalidate(),this.statements={},this.currentLabel={});let s=!!t.isCompleteState&&!t.isUndoRedoState;s!==this.initialEvaluation&&(this.initialEvaluation=s,this.invalidate()),t.viewState&&this.setViewState(t.viewState),t.hasOwnProperty("degreeMode")&&this.setDegreeMode(t.degreeMode),t.hasOwnProperty("globalRandomSeed")&&this.setGlobalRandomSeed(t.globalRandomSeed),t.hasOwnProperty("evaluationMode")&&this.setEvaluationMode(t.evaluationMode),t.hasOwnProperty("additionalFunctions")&&this.setAdditionalFunctions(t.additionalFunctions),t.hasOwnProperty("restrictedFunctions")&&this.setRestrictedFunctions(t.restrictedFunctions),t.hasOwnProperty("forceEnableGeometryFunctions")&&this.setForceEnableGeometryFunctions(t.forceEnableGeometryFunctions),t.hasOwnProperty("distributions")&&this.setDistributions(t.distributions),t.hasOwnProperty("functionDefinition")&&this.setFunctionDefinition(t.functionDefinition),t.hasOwnProperty("replaceRoundWithReciprocal")&&this.setReplaceRoundWithReciprocal(t.replaceRoundWithReciprocal),t.hasOwnProperty("pointsOfInterest")&&this.setWorkerConfigProperty("pointsOfInterest",t.pointsOfInterest),t.hasOwnProperty("plotSingleVariableImplicitEquations")&&this.setWorkerConfigProperty("plotSingleVariableImplicitEquations",t.plotSingleVariableImplicitEquations),t.hasOwnProperty("plotImplicits")&&this.setWorkerConfigProperty("plotImplicits",t.plotImplicits),t.hasOwnProperty("plotInequalities")&&this.setWorkerConfigProperty("plotInequalities",t.plotInequalities),t.hasOwnProperty("sliders")&&this.setWorkerConfigProperty("sliders",t.sliders),t.hasOwnProperty("actions")&&this.setActions(!!t.actions),t.hasOwnProperty("substitutions")&&this.setSubstitutions(!!t.substitutions),t.hasOwnProperty("beta3d")&&this.setBeta3d(!!t.beta3d),t.hasOwnProperty("product")&&this.setProduct(t.product);let o;if(t.hasOwnProperty("selectedIds")){let p=t.selectedIds||{};(this.intersectId===void 0||!p[this.intersectId])&&([o]=Object.keys(p),this.intersectId=o)}t.hasOwnProperty("dimensions")&&this.setDimensions(t.dimensions);let a=Js();this.processStatements(t,i);let u=Js();n.processStatements=u-a,a=u,this.updateAnalysis(),u=Js(),n.updateAnalysis=u-a,a=u,o!==void 0&&this._updateIntersections(o,i),u=Js(),n.updateIntersections=u-a,a=u;let l=this._publishAllStatuses();u=Js(),n.publishAllStatuses=u-a,a=u,this._computeAllLabels(),u=Js(),n.computeAllLabels=u-a,a=u,this._computeAriaDescriptions(),u=Js(),n.computeAriaDescriptions=u-a,a=u,this._graphAllChanged(i),u=Js(),n.graphAllChanges=u-a;let c=this.processEvents(t.events);return this.unpublishedIds={},n.timeInWorker=u-r,{syncId:t.syncId,isCompleteState:t.isCompleteState,intersectionChanges:i.intersections,statusChanges:l,graphChanges:i.graphs,timingData:n,eventUpdates:c}}processStatements(t,r){if(t.removes)for(let n in t.removes){let i;if(!t.isCompleteState&&this.statements.hasOwnProperty(n)&&(i=this.statements[n].getAllIds()),this.removeStatement(n,r),!t.isCompleteState&&i)for(let s of i)r.graphs[s]=void 0}if(t.statements)for(let n in t.statements){let i=t.statements[n];i===null||this.addStatement(i,r)}}setViewState(t){if(Bs(t,this.viewState))return;let r=!!(this.viewState&&t.xAxisScale===this.viewState.xAxisScale&&t.yAxisScale===this.viewState.yAxisScale);if(this.viewState=t,r)for(let n in this.statements)this.statements.hasOwnProperty(n)&&(this.unpublishedIds[n]=!0);else this.invalidate()}getViewState(){return this.viewState}setDegreeMode(t){this.use_degrees=t,this.invalidate()}setDimensions(t){t!==void 0&&(this.dimensions=t,this.invalidate())}setGlobalRandomSeed(t){this.globalRandomSeedString=t,this.parent_frame.globalRandomSeed=new tO(t),this.dirtyExportedSymbolRoots.globalRandomSeed=!0}setEvaluationMode(t){this.evaluationMode=t,this.invalidate()}setProduct(t){this.product=t,this.invalidate()}setBeta3d(t){this.beta3d=t,this.invalidate()}setAdditionalFunctions(t){this.additionalFunctions=t,this.invalidate()}setRestrictedFunctions(t){this.restrictedFunctions=t,this.invalidate()}setForceEnableGeometryFunctions(t){this.forceEnableGeometryFunctions=t,this.invalidate()}setDistributions(t){this.distributions=t,this.invalidate()}setFunctionDefinition(t){this.functionDefinition=t,this.invalidate()}setReplaceRoundWithReciprocal(t){this.replaceRoundWithReciprocal=t,this.invalidate()}setActions(t){t!==this.actions&&(this.actions=t,this.invalidate())}setSubstitutions(t){t!==this.substitutions&&(this.substitutions=t,this.invalidate())}setWorkerConfigProperty(t,r){r!==Vn[t]&&(Vn[t]=r,this.invalidate())}_publishAllStatuses(){let t={},r=this.currentStatus;this.currentStatus={};for(let n in this.unpublishedIds){if(!this.analysis.hasOwnProperty(n))continue;let i=this.analysis[n].evaluationState;Bs(i,r[n])||(t[n]=i),this.currentStatus[n]=i}return t}_computeAllLabels(){for(let t in this.currentLabel){let r=this.statements[t];if(!r)continue;let n=r.tryGetConcreteTree(this.policy,this.frame),i=1;(n.valueType===Be||n.valueType===$t||n.valueType===er||n.valueType===Lt||n.valueType===wt)&&(i=n.length);let s=[],o=this.currentLabel[t];if(Hi(o))for(let a=0;a<i;a++)s.push(tT(o,this.frame,a));Bs(s,r.computedLabels)||(r.computedLabels=s,this.unpublishedIds[t]=!0)}}_computeAriaDescriptions(){for(let t in this.analysis){let r=this.analysis[t],n=r.evaluationState,s=r.rawTree.userData;if(s.description&&s.description!==""){n.computed_description=[];let o=1;r.concreteTree.isList?o=r.concreteTree.length:n.dimensions&&n.dimensions.x&&Array.isArray(n.dimensions.x)&&(o=n.dimensions.x.length);for(let a=0;a<o;a++)n.computed_description.push(tT(eT(s.description),this.frame,a))}}}_graphAllChanged(t){let r=this.getViewState(),n=!1;if(!(!r||!D1(r))){for(let i in this.unpublishedIds){if(!this.analysis.hasOwnProperty(i))continue;let s=this.analysis[i],o=s.evaluationState.expression_type,a=o==="SINGLE_POINT"||o==="POINT_LIST";if(Pi(s.rawTree)){let u=s.graph(r,void 0),l=s.rawTree.getAllIds();for(let c of l)u[c]?this._notifyGraphComputed(c,u[c],t):this._notifyGraphRemoved(c,t)}else s.evaluationState.is_graphable&&(s.rawTree.userData.shouldGraph||s.rawTree.userData.showLabel&&a)?(this._notifyGraphComputed(i,s.graph(r,this.childIntersections.getChildIntersections(i)),t),this.intersectId===i&&(n=!0)):this._notifyGraphRemoved(i,t)}Dr(this.unpublishedIds).length&&this.intersectId!==void 0&&(this.unpublishedIds.hasOwnProperty(this.intersectId)||(n=!0)),n&&this._updateIntersections(this.intersectId,t)}}_notifyGraphRemoved(t,r){r.graphs[t]=void 0}_notifyGraphComputed(t,r,n){GI(r),n.graphs[t]=r}_updateIntersections(t,r){if(!this.viewState)return;if(!this.analysis[t]||!this.analysis[t].shouldIntersect()){r.intersections[t]=[];return}let n=J1(this.analysis,this.viewState,t);r.intersections[t]=n}getDisabledFeatures(){let t=this.policy.disabledFeatures();this.functionDefinition===!1&&(t=t.concat("FunctionDefinition")),this.actions===!1&&(t=t.concat("UpdateRule")),this.substitutions===!1&&(t=t.concat("Substitution"));let r=this.additionalFunctions||[];return t=t.filter(n=>!(n==="Exponent"&&r.indexOf("exponent")!==-1||n==="PercentOf"&&r.indexOf("percent")!==-1)),t}areFractionsDisallowed(){let{evaluationMode:t}=this;return t!=="fourFunction"&&t!=="singleExpressionFourFunction"?!1:!this.additionalFunctions||this.additionalFunctions.indexOf("fraction")===-1}addStatement(t,r){if(!t)return;let n=t.id;this.markExportsDirty(n),this.markAsDirtyRoot(n);let i;if(t.type==="statement"){let l=t.latexSelection;i=l&&{input:t.latex,start:l.start,end:l.end}}let s={index:this.policy.ansEnabled()?t.index:void 0,disabledFeatures:this.getDisabledFeatures(),disallowFrac:this.areFractionsDisallowed(),seedPrefix:_t(n),writeIntegral:this.evaluationMode==="geometry",selection:i},o={extraDepNodes:[]};switch(t.type){case"table":let l=[];this.statements.hasOwnProperty(n)&&(l=this.statements[n].getAllIds()),t.shouldGraph=!0;let c=t.columns,p=[],f=I=>!I.replace(/\\space|\\ /g,"").match(/\S/);for(let I=0;I<c.length;I++){let O,E,v,_=c[I];O=xi(_.latex,ue(X({},s),{seedPrefix:_t(n,[["tr",0],["tc",I]])})),E=[];let z=-1;for(let R=0;R<c[I].values.length;R++)f(_.values[R])?E.push(new is(NaN)):(E.push(xi(_.values[R],ue(X({},s),{seedPrefix:_t(n,[["tr",R+1],["tc",I]])}))),z=R);if(E=E.slice(0,z+1),v=new IF(O,E),v.id=_.id,v.header){if(v.header.userData=_,v.header.metaData={extraDepNodes:[]},_.colorLatex){let R=Dn(_.colorLatex,ue(X({},s),{seedPrefix:_t(n,[["tr",0],["tc",I],["cl",I]])}));v.header.metaData.colorLatex=R,v.header.metaData.extraDepNodes.push(R)}if(_.pointSize){let R=Dn(_.pointSize,ue(X({},s),{seedPrefix:_t(n,[["tr",0],["tc",I],["ps",I]])}));v.header.metaData.pointSize=R,v.header.metaData.extraDepNodes.push(R)}if(_.pointOpacity){let R=Dn(_.pointOpacity,ue(X({},s),{seedPrefix:_t(n,[["tr",0],["tc",I],["po",I]])}));v.header.metaData.pointOpacity=R,v.header.metaData.extraDepNodes.push(R)}if(_.lineWidth){let R=Dn(_.lineWidth,ue(X({},s),{seedPrefix:_t(n,[["tr",0],["tc",I],["lw",I]])}));v.header.metaData.lineWidth=R,v.header.metaData.extraDepNodes.push(R)}if(_.lineOpacity){let R=Dn(_.lineOpacity,ue(X({},s),{seedPrefix:_t(n,[["tr",0],["tc",I],["lo",I]])}));v.header.metaData.lineOpacity=R,v.header.metaData.extraDepNodes.push(R)}}p.push(v)}this.statements[n]=new PF(p);let m=this.statements[n].getAllIds();l.forEach(I=>{m.indexOf(I)===-1&&this._notifyGraphRemoved(I,r)});break;case"image":let d="-\\trigAngleMultiplier*("+t.angle+")",y=Dn(t.center,ue(X({},s),{seedPrefix:_t(n,[["ic",n]])})),g=Dn(d,ue(X({},s),{seedPrefix:_t(n,[["ia",n]])})),h=Dn(t.width,ue(X({},s),{seedPrefix:_t(n,[["iw",n]])})),P=Dn(t.height,ue(X({},s),{seedPrefix:_t(n,[["ih",n]])})),T=Dn(t.opacity,ue(X({},s),{seedPrefix:_t(n,[["io",n]])}));this.statements[n]=new xF({center:y,radianAngle:g,width:h,height:P,opacity:T},void 0);break;case"ticker":{this.statements[n]=new b.Ticker({handler:Dn(t.handlerLatex,ue(X({},s),{allowDt:!0})),minStep:Dn(t.minStepLatex||"0",s)});break}default:t=t;let D,N=fs(t.latex);N.slice(-1)==="="?D=N.substring(0,N.length-1):D=t.latex,this.statements[n]=xi(D,s);for(let I in Hl){let O=I;if(t[O]){let E=Hl[O],v=t[O];E.transform&&(v=E.transform(v));let _=ns(v,ue(X({},s),{seedPrefix:_t(n,[[E.seed,n]])}));o[O]=_,o.extraDepNodes.push(_)}}if(t.colorLatex){let I=Lo(t.colorLatex,ue(X({},s),{seedPrefix:_t(n,[["ac",n]])}));o.colorLatex=I,o.extraDepNodes.push(I)}if(t.polarDomain&&t.polarDomain.min&&(o.polarDomainMin=ns(t.polarDomain.min,ue(X({},s),{seedPrefix:_t(n,[["lm",n]])})),o.extraDepNodes.push(o.polarDomainMin)),t.polarDomain&&t.polarDomain.max&&(o.polarDomainMax=ns(t.polarDomain.max,ue(X({},s),{seedPrefix:_t(n,[["lM",n]])})),o.extraDepNodes.push(o.polarDomainMax)),t.parametricDomain&&t.parametricDomain.min&&(o.parametricDomainMin=ns(t.parametricDomain.min,ue(X({},s),{seedPrefix:_t(n,[["lm",n]])})),o.extraDepNodes.push(o.parametricDomainMin)),t.parametricDomain3Du&&t.parametricDomain3Du.min&&(o.parametricDomain3DuMin=ns(t.parametricDomain3Du.min,ue(X({},s),{seedPrefix:_t(n,[["lm",n]])})),o.extraDepNodes.push(o.parametricDomain3DuMin)),t.parametricDomain3Dv&&t.parametricDomain3Dv.min&&(o.parametricDomain3DvMin=ns(t.parametricDomain3Dv.min,ue(X({},s),{seedPrefix:_t(n,[["lm",n]])})),o.extraDepNodes.push(o.parametricDomain3DvMin)),t.parametricDomain&&t.parametricDomain.max&&(o.parametricDomainMax=ns(t.parametricDomain.max,ue(X({},s),{seedPrefix:_t(n,[["lM",n]])})),o.extraDepNodes.push(o.parametricDomainMax)),t.parametricDomain3Du&&t.parametricDomain3Du.max&&(o.parametricDomain3DuMax=ns(t.parametricDomain3Du.max,ue(X({},s),{seedPrefix:_t(n,[["lM",n]])})),o.extraDepNodes.push(o.parametricDomain3DuMax)),t.parametricDomain3Dv&&t.parametricDomain3Dv.max&&(o.parametricDomain3DvMax=ns(t.parametricDomain3Dv.max,ue(X({},s),{seedPrefix:_t(n,[["lM",n]])})),o.extraDepNodes.push(o.parametricDomain3DvMax)),t.vizProps&&(t.vizProps.axisOffset&&(o.vizAxisOffset=ns(t.vizProps.axisOffset,ue(X({},s),{seedPrefix:_t(n,[["vo",n]])})),o.extraDepNodes.push(o.vizAxisOffset)),t.vizProps.breadth&&(o.vizBreadth=ns(t.vizProps.breadth,ue(X({},s),{seedPrefix:_t(n,[["vb",n]])})),o.extraDepNodes.push(o.vizBreadth))),t.cdf&&t.cdf.show){let I=gv(t.latex);I&&I.type==="distribution"&&(o.distributionSpec=I,o.cdfMin=Lo(t.cdf.min,ue(X({},s),{seedPrefix:_t(n,[["lm",n]])})),o.extraDepNodes.push(o.cdfMin),o.cdfMax=Lo(t.cdf.max,ue(X({},s),{seedPrefix:_t(n,[["lM",n]])})),o.extraDepNodes.push(o.cdfMax))}if(this.statements[n].shouldPromoteToSlider(this.policy)){let I=t.slider,O=!!(I&&I.isPlayingOnce),E=Lo(I&&I.softMin,s),v=Lo(I&&I.softMax,s),_=Lo(I&&I.min,ue(X({},s),{seedPrefix:_t(n,[["lm",n]])})),z=Lo(I&&I.max,ue(X({},s),{seedPrefix:_t(n,[["lM",n]])})),R=Lo(I&&I.step,ue(X({},s),{seedPrefix:_t(n,[["ls",n]])}));this.statements[n]=new TF(this.statements[n],{sliderMin:_,sliderMax:z,sliderStep:R,sliderIsPlayingOnce:O,sliderSoftMin:E,sliderSoftMax:v})}}let a=t.clickableInfo;a&&a.enabled&&a.latex&&(o.clickHandler=Dn(a.latex,ue(X({},s),{allowIndex:!0}))),this.statements[n].userData=t,this.statements[n].metaData=o;let u=t.label;if(u){let l=this.currentLabel[n];(!l||l.raw!==u)&&(this.currentLabel[n]=eT(u))}else delete this.currentLabel[n]}removeStatement(t,r){let n=this.statements[t];if(n){if(this.markExportsDirty(t),Pi(n)){let i=this;n.getAllIds().forEach(function(s){i._notifyGraphRemoved(s,r)})}else this._notifyGraphRemoved(t,r);delete this.currentLabel[t],delete this.statements[t],delete this.analysis[t],delete this.currentStatus[t]}}markExportsDirty(t){if(this.statements[t]){cu(this.statements[t])&&(this.markedRegressionDirty=!0);for(let r of this.statements[t].getLegalExports(this.policy))this.dirtyExportedSymbolRoots[r]=!0}}markAsDirtyRoot(t){this.dirtyStatementRoots[t]=!0}getFrame(){return this.updateAnalysis(),this.frame}getAnalysis(){return this.updateAnalysis(),this.analysis}getEvaluationState(t){if(this.updateAnalysis(),!!this.analysis[t])return this.analysis[t].evaluationState}_updateRegressions(t){let r=this.frame,n=this.lastFrame,i=this.regressionFrame,s=[];for(let c in t)t.hasOwnProperty(c)&&cu(t[c])&&s.push(c);let o=this;s.sort(function(c,p){let f=o.statements[c].userData&&o.statements[c].userData.residualVariable,m=o.statements[p].userData&&o.statements[p].userData.residualVariable;return f&&!m?-1:m&&!f?1:0});let a=Kx(this.policy,t,s);rO(a,i);let u=a.resolved,l={};for(let c of u)if(c!==oi)if(cu(this.statements[c]))this.analysis[c]=t[c].analyze(this.policy,i,r,n,l),this.analysis[c].exportTo(this.policy,r),delete t[c];else{let p=t[c].tryGetConcreteTree(this.policy,i);t[c].exportTo(this.policy,p,i),l[c]={rawTree:t[c],concreteTree:p}}}buildSymbolToExpressionDirtyMap(){let t={};for(let r in this.statements){if(!this.statements.hasOwnProperty(r))continue;let n=this.statements[r],i=n.metaData;if($l(t,r,n.getDependencies()),$l(t,r,n.getLegalExports(this.policy)),cu(n)&&n.userData&&n.userData.residualVariable&&$l(t,r,[ps(n.userData.residualVariable)]),nO(t,r,i),Pi(n)&&n.columns)for(let s=0;s<n.columns.length;s++){let o=n.columns[s];!Zi(o)&&o.header&&o.header.metaData&&nO(t,r,o.header.metaData)}}return t}buildChildIntersectionMap(){var n,i;let t=this.childIntersections,r=new ql;for(let s in this.analysis){let o=this.analysis[s],{geometry:a}=o.evaluationState;if(a!=null&&a.call&&a.call.symbol==="intersection"&&this.statements[s].userData.shouldGraph&&!o.concreteTree.isError){let u=!!this.unpublishedIds[s],l=o.concreteTree.asTypedValue();for(let c of a.call.parents){let p=c&&this.frame[c[0]],f=p&&p.userData.id;if(f==null)continue;let m=c&&c[1],d=this.analysis[f];k(d.concreteTree.asTypedValue().valueType)?r.addListParent(f,m===void 0?void 0:m-1,l):r.addPrimitiveParent(f,l),u&&(this.unpublishedIds[f]=!0)}}}for(let s in t.data){let o=((n=t.data[s])==null?void 0:n.count)||0;(((i=r.data[s])==null?void 0:i.count)||0)<o&&(this.unpublishedIds[s]=!0)}return r}updateConstruction(){if(!this.policy.isGeometryEnabled){this.parent_frame.construction=na();return}let t=[];for(let o in this.statements)this.statements[o].userData.isInConstructionsFolder&&t.push(o);let r=this.statements[oi],n=new MF(t);n.metaData={extraDepNodes:[]},n.userData={};let i={};for(let o of(r==null?void 0:r.getDependencies())||[])i[o]=!0;let s={};for(let o of n.getDependencies())s[o]=!0;(!r||!Bs(i,s))&&(this.statements[oi]=n,this.parent_frame.construction=n,this.markAsDirtyRoot(oi),this.markExportsDirty(oi))}updateAnalysis(){var f;this.updateConstruction();let t=this.buildSymbolToExpressionDirtyMap(),r=rT(this.policy,this.statements,t,this.dirtyStatementRoots,this.dirtyExportedSymbolRoots),n=this.markedRegressionDirty;for(let m in r.ids)this.statements[m]&&cu(this.statements[m])&&(n=!0);let i={};if(n){for(let m in this.statements)this.statements[m]&&(i[m]=this.statements[m]);this.frame=Object.create(this.parent_frame),this.regressionFrame=Object.create(this.parent_frame)}else{let m=r.ids;for(let y in m)this.statements[y]&&(i[y]=this.statements[y]);let d=r.symbols;for(let y in d)d[y]&&(delete this.frame[y],delete this.regressionFrame[y])}for(let m in i)i[m]&&(this.unpublishedIds[m]=!0);this.markedRegressionDirty=!1,this.dirtyExportedSymbolRoots={},this.dirtyStatementRoots={};let s=this.analysis,o=this.frame;(this.evaluationMode==="graphing"||this.evaluationMode==="geometry"||this.evaluationMode==="graphing_3d")&&this._updateRegressions(i);let a=Kx(this.policy,i);rO(a,o);let u=a.resolved;for(let m of u)if(m!==oi)switch(this.evaluationMode){case"fourFunction":case"singleExpressionFourFunction":s[m]=this.statements[m].analyzeFourFunction(this.policy,o,s),s[m].exportTo(this.policy,o);break;case"scientific":s[m]=this.statements[m].analyzeScientific(this.policy,o,s),s[m].exportTo(this.policy,o);break;case"singleExpressionScientific":s[m]=this.statements[m].analyzeSingleExpressionScientific(this.policy,o,s),s[m].exportTo(this.policy,o);break;case"graphing":case"graphing_3d":case"geometry":if(o.r){let d=Object.create(o);if(d.r=void 0,s[m]=this.statements[m].analyze(this.policy,d,s),s[m].getGraphMode()===6){s[m].exportTo(this.policy,o);continue}}s[m]=this.statements[m].analyze(this.policy,o,s),s[m].exportTo(this.policy,o);break}if(this.evaluationMode==="graphing"||this.evaluationMode==="graphing_3d"||this.evaluationMode==="geometry"){for(let m of u){if(m===oi)continue;let d=s[m],y=d.evaluationState.expression_type;for(let g in Hl){let h=g;var l=Hl[h];this.evaluationMode!=="graphing_3d"&&(h==="checkers"||h==="resolution")||(!l.shouldEvaluate||l.shouldEvaluate(d))&&_F(d,this.policy,o,h)}FF(d,this.policy,o),this.product==="graphing-3d"&&BF(d),this.actions&&SF(d)&&VF(d,this.policy,o),y==="PARAMETRIC"||y==="CURVE3D_xyz_t"||y==="POLAR"||y==="SURFACE_r_\u03B8z"||y==="SURFACE_r_\u03B8z_AMBIGUOUS"?GF(d,this.policy,o):y==="SURFACE_xyz_uv"||y==="SURFACE_r_\u03B8\u03C6"||y==="SURFACE_r_\u03B8\u03C6_AMBIGUOUS"||y==="SURFACE_z_r\u03B8"?zF(d,this.policy,o):y==="BOXPLOT"?qF(d,this.policy,o):OF(d)&&LF(d,this.policy,o)}this.childIntersections=this.buildChildIntersectionMap()}kF(t).forEach(function(m){s[m].evaluationState.depends_on_random_seed=!0});let c=rT(this.policy,this.statements,t,{[oi]:!0},{construction:!0});for(let m in c.ids){if(m===oi)continue;let d=s[m].evaluationState;d.geometry&&(d.geometry.unconstructable=!0)}let p;for(let m in this.statements)if((f=this.statements[m].parseOptions)!=null&&f.selection){p=m;break}if(p){let m=rT(this.policy,this.statements,t,{[p]:!0},{[`idref_${p}`]:!0});for(let d in m.ids){if(d===oi)continue;let y=s[d].evaluationState;y.geometry&&(y.geometry.depends_on_selected=!0)}}this.lastFrame=Object.create(this.parent_frame);for(let m in o)o.hasOwnProperty(m)&&(this.lastFrame[m]=o[m])}processEvents(t){if(!t||!this.actions)return;let r=Object.create(this.frame),n={},i=!1,s=!1,o;for(let l of t)switch(this.globalEventCount+=1,r.globalEventCount=new b.Constant(this.globalEventCount),l.type){case"step":{let p=this.statements[l.expressionId];if(!p)continue;let f=p.tryGetConcreteTree(this.policy,r);s=!0,nT(f,n,r);break}case"click":{let p=this.statements[l.expressionId];if(!p||!p.metaData.clickHandler)continue;r.index=new b.Constant(l.indexVar+1);let f=p.metaData.clickHandler.tryGetConcreteTree(this.policy,r);s=!0,i=!0,nT(f,n,r);break}case"clock-tick":{(o===void 0||l.isFirstTick&&!o.isFirstTick)&&(o=l);break}default:return l}if(o){let l=this.statements[o.id];if(l&&l instanceof b.Ticker){var a=l.minStep.tryGetConcreteTree(this.policy,r).asValue(),u=typeof a=="number"&&a>=0&&isFinite(a);if(u){let c=this.lastClockTickTime;if(this.lastClockTickTime=Date.now(),!o.isFirstTick&&c!==void 0){r.dt=new b.Constant(this.lastClockTickTime-c);let p=l.handler.tryGetConcreteTree(this.policy,r);nT(p,n,r)}}}}return{objectClicked:i,userAction:s,updates:n}}};var aO=class{constructor(t){this.context=new zd,this.sendMessage=t}processChangeSet(t){var r=this.context.processChangeSet(t);this.sendMessage("processChangeSet",r)}};Object.defineProperty(__dcg_chunk_exports__, 'a', { get: () => HF });
Object.defineProperty(__dcg_chunk_exports__, 'b', { get: () => X });
Object.defineProperty(__dcg_chunk_exports__, 'c', { get: () => ue });
Object.defineProperty(__dcg_chunk_exports__, 'd', { get: () => $F });
Object.defineProperty(__dcg_chunk_exports__, 'e', { get: () => oT });
Object.defineProperty(__dcg_chunk_exports__, 'f', { get: () => YF });
Object.defineProperty(__dcg_chunk_exports__, 'g', { get: () => WF });
Object.defineProperty(__dcg_chunk_exports__, 'h', { get: () => ui });
Object.defineProperty(__dcg_chunk_exports__, 'i', { get: () => XF });
Object.defineProperty(__dcg_chunk_exports__, 'j', { get: () => ZF });
Object.defineProperty(__dcg_chunk_exports__, 'k', { get: () => Fs });
Object.defineProperty(__dcg_chunk_exports__, 'l', { get: () => Go });
Object.defineProperty(__dcg_chunk_exports__, 'm', { get: () => Aa });
Object.defineProperty(__dcg_chunk_exports__, 'n', { get: () => TT });
Object.defineProperty(__dcg_chunk_exports__, 'o', { get: () => PT });
Object.defineProperty(__dcg_chunk_exports__, 'p', { get: () => Bi });
Object.defineProperty(__dcg_chunk_exports__, 'q', { get: () => sm });
Object.defineProperty(__dcg_chunk_exports__, 'r', { get: () => AT });
Object.defineProperty(__dcg_chunk_exports__, 's', { get: () => LO });
Object.defineProperty(__dcg_chunk_exports__, 't', { get: () => wO });
Object.defineProperty(__dcg_chunk_exports__, 'u', { get: () => _O });
Object.defineProperty(__dcg_chunk_exports__, 'v', { get: () => VO });
Object.defineProperty(__dcg_chunk_exports__, 'w', { get: () => qO });
Object.defineProperty(__dcg_chunk_exports__, 'x', { get: () => YO });
Object.defineProperty(__dcg_chunk_exports__, 'y', { get: () => om });
Object.defineProperty(__dcg_chunk_exports__, 'z', { get: () => VT });
Object.defineProperty(__dcg_chunk_exports__, 'A', { get: () => nS });
Object.defineProperty(__dcg_chunk_exports__, 'B', { get: () => iS });
Object.defineProperty(__dcg_chunk_exports__, 'C', { get: () => Dr });
Object.defineProperty(__dcg_chunk_exports__, 'D', { get: () => qo });
Object.defineProperty(__dcg_chunk_exports__, 'E', { get: () => ZT });
Object.defineProperty(__dcg_chunk_exports__, 'F', { get: () => Bs });
Object.defineProperty(__dcg_chunk_exports__, 'G', { get: () => gS });
Object.defineProperty(__dcg_chunk_exports__, 'H', { get: () => Vi });
Object.defineProperty(__dcg_chunk_exports__, 'I', { get: () => Uo });
Object.defineProperty(__dcg_chunk_exports__, 'J', { get: () => JT });
Object.defineProperty(__dcg_chunk_exports__, 'K', { get: () => OS });
Object.defineProperty(__dcg_chunk_exports__, 'L', { get: () => VS });
Object.defineProperty(__dcg_chunk_exports__, 'M', { get: () => JF });
Object.defineProperty(__dcg_chunk_exports__, 'N', { get: () => Ti });
Object.defineProperty(__dcg_chunk_exports__, 'O', { get: () => C_ });
Object.defineProperty(__dcg_chunk_exports__, 'P', { get: () => Ax });
Object.defineProperty(__dcg_chunk_exports__, 'Q', { get: () => Td });
Object.defineProperty(__dcg_chunk_exports__, 'R', { get: () => vw });
Object.defineProperty(__dcg_chunk_exports__, 'S', { get: () => Ow });
Object.defineProperty(__dcg_chunk_exports__, 'T', { get: () => Dw });
Object.defineProperty(__dcg_chunk_exports__, 'U', { get: () => Aw });
Object.defineProperty(__dcg_chunk_exports__, 'V', { get: () => mP });
Object.defineProperty(__dcg_chunk_exports__, 'W', { get: () => yP });
Object.defineProperty(__dcg_chunk_exports__, 'X', { get: () => ci });
Object.defineProperty(__dcg_chunk_exports__, 'Y', { get: () => cT });
Object.defineProperty(__dcg_chunk_exports__, 'Z', { get: () => rc });
Object.defineProperty(__dcg_chunk_exports__, '_', { get: () => pi });
Object.defineProperty(__dcg_chunk_exports__, '$', { get: () => _s });
Object.defineProperty(__dcg_chunk_exports__, 'aa', { get: () => wi });
Object.defineProperty(__dcg_chunk_exports__, 'ba', { get: () => PO });
Object.defineProperty(__dcg_chunk_exports__, 'ca', { get: () => TB });
Object.defineProperty(__dcg_chunk_exports__, 'da', { get: () => PB });
Object.defineProperty(__dcg_chunk_exports__, 'ea', { get: () => Kr });
Object.defineProperty(__dcg_chunk_exports__, 'fa', { get: () => IB });
Object.defineProperty(__dcg_chunk_exports__, 'ga', { get: () => vP });
Object.defineProperty(__dcg_chunk_exports__, 'ha', { get: () => rf });
Object.defineProperty(__dcg_chunk_exports__, 'ia', { get: () => nf });
Object.defineProperty(__dcg_chunk_exports__, 'ja', { get: () => Zn });
Object.defineProperty(__dcg_chunk_exports__, 'ka', { get: () => BP });
Object.defineProperty(__dcg_chunk_exports__, 'la', { get: () => Tz });
Object.defineProperty(__dcg_chunk_exports__, 'ma', { get: () => vz });
Object.defineProperty(__dcg_chunk_exports__, 'na', { get: () => nD });
Object.defineProperty(__dcg_chunk_exports__, 'oa', { get: () => Rr });
Object.defineProperty(__dcg_chunk_exports__, 'pa', { get: () => nI });
Object.defineProperty(__dcg_chunk_exports__, 'qa', { get: () => ml });
Object.defineProperty(__dcg_chunk_exports__, 'ra', { get: () => Qa });
Object.defineProperty(__dcg_chunk_exports__, 'sa', { get: () => Ka });
Object.defineProperty(__dcg_chunk_exports__, 'ta', { get: () => kh });
Object.defineProperty(__dcg_chunk_exports__, 'ua', { get: () => Uh });
Object.defineProperty(__dcg_chunk_exports__, 'va', { get: () => Mh });
Object.defineProperty(__dcg_chunk_exports__, 'wa', { get: () => FA });
Object.defineProperty(__dcg_chunk_exports__, 'xa', { get: () => AI });
Object.defineProperty(__dcg_chunk_exports__, 'ya', { get: () => BA });
Object.defineProperty(__dcg_chunk_exports__, 'za', { get: () => Pf });
Object.defineProperty(__dcg_chunk_exports__, 'Aa', { get: () => fl });
Object.defineProperty(__dcg_chunk_exports__, 'Ba', { get: () => Hh });
Object.defineProperty(__dcg_chunk_exports__, 'Ca', { get: () => CI });
Object.defineProperty(__dcg_chunk_exports__, 'Da', { get: () => LI });
Object.defineProperty(__dcg_chunk_exports__, 'Ea', { get: () => zA });
Object.defineProperty(__dcg_chunk_exports__, 'Fa', { get: () => wI });
Object.defineProperty(__dcg_chunk_exports__, 'Ga', { get: () => qA });
Object.defineProperty(__dcg_chunk_exports__, 'Ha', { get: () => _I });
Object.defineProperty(__dcg_chunk_exports__, 'Ia', { get: () => kA });
Object.defineProperty(__dcg_chunk_exports__, 'Ja', { get: () => QA });
Object.defineProperty(__dcg_chunk_exports__, 'Ka', { get: () => tR });
Object.defineProperty(__dcg_chunk_exports__, 'La', { get: () => rR });
Object.defineProperty(__dcg_chunk_exports__, 'Ma', { get: () => Is });
Object.defineProperty(__dcg_chunk_exports__, 'Na', { get: () => Xv });
Object.defineProperty(__dcg_chunk_exports__, 'Oa', { get: () => E6 });
Object.defineProperty(__dcg_chunk_exports__, 'Pa', { get: () => cn });
Object.defineProperty(__dcg_chunk_exports__, 'Qa', { get: () => M });
Object.defineProperty(__dcg_chunk_exports__, 'Ra', { get: () => ft });
Object.defineProperty(__dcg_chunk_exports__, 'Sa', { get: () => x });
Object.defineProperty(__dcg_chunk_exports__, 'Ta', { get: () => A });
Object.defineProperty(__dcg_chunk_exports__, 'Ua', { get: () => Bt });
Object.defineProperty(__dcg_chunk_exports__, 'Va', { get: () => Z });
Object.defineProperty(__dcg_chunk_exports__, 'Wa', { get: () => Ir });
Object.defineProperty(__dcg_chunk_exports__, 'Xa', { get: () => Be });
Object.defineProperty(__dcg_chunk_exports__, 'Ya', { get: () => Qt });
Object.defineProperty(__dcg_chunk_exports__, 'Za', { get: () => Me });
Object.defineProperty(__dcg_chunk_exports__, '_a', { get: () => Tr });
Object.defineProperty(__dcg_chunk_exports__, '$a', { get: () => Te });
Object.defineProperty(__dcg_chunk_exports__, 'ab', { get: () => er });
Object.defineProperty(__dcg_chunk_exports__, 'bb', { get: () => pe });
Object.defineProperty(__dcg_chunk_exports__, 'cb', { get: () => $t });
Object.defineProperty(__dcg_chunk_exports__, 'db', { get: () => ie });
Object.defineProperty(__dcg_chunk_exports__, 'eb', { get: () => cr });
Object.defineProperty(__dcg_chunk_exports__, 'fb', { get: () => ee });
Object.defineProperty(__dcg_chunk_exports__, 'gb', { get: () => pr });
Object.defineProperty(__dcg_chunk_exports__, 'hb', { get: () => ne });
Object.defineProperty(__dcg_chunk_exports__, 'ib', { get: () => fr });
Object.defineProperty(__dcg_chunk_exports__, 'jb', { get: () => Pe });
Object.defineProperty(__dcg_chunk_exports__, 'kb', { get: () => dr });
Object.defineProperty(__dcg_chunk_exports__, 'lb', { get: () => de });
Object.defineProperty(__dcg_chunk_exports__, 'mb', { get: () => Lt });
Object.defineProperty(__dcg_chunk_exports__, 'nb', { get: () => oe });
Object.defineProperty(__dcg_chunk_exports__, 'ob', { get: () => wt });
Object.defineProperty(__dcg_chunk_exports__, 'pb', { get: () => Re });
Object.defineProperty(__dcg_chunk_exports__, 'qb', { get: () => Vr });
Object.defineProperty(__dcg_chunk_exports__, 'rb', { get: () => G });
Object.defineProperty(__dcg_chunk_exports__, 'sb', { get: () => pn });
Object.defineProperty(__dcg_chunk_exports__, 'tb', { get: () => te });
Object.defineProperty(__dcg_chunk_exports__, 'ub', { get: () => k });
Object.defineProperty(__dcg_chunk_exports__, 'vb', { get: () => ke });
Object.defineProperty(__dcg_chunk_exports__, 'wb', { get: () => Ud });
Object.defineProperty(__dcg_chunk_exports__, 'xb', { get: () => Zl });
Object.defineProperty(__dcg_chunk_exports__, 'yb', { get: () => fe });
Object.defineProperty(__dcg_chunk_exports__, 'zb', { get: () => Ee });
Object.defineProperty(__dcg_chunk_exports__, 'Ab', { get: () => rr });
Object.defineProperty(__dcg_chunk_exports__, 'Bb', { get: () => ym });
Object.defineProperty(__dcg_chunk_exports__, 'Cb', { get: () => YS });
Object.defineProperty(__dcg_chunk_exports__, 'Db', { get: () => aP });
Object.defineProperty(__dcg_chunk_exports__, 'Eb', { get: () => dc });
Object.defineProperty(__dcg_chunk_exports__, 'Fb', { get: () => JS });
Object.defineProperty(__dcg_chunk_exports__, 'Gb', { get: () => bm });
Object.defineProperty(__dcg_chunk_exports__, 'Hb', { get: () => vr });
Object.defineProperty(__dcg_chunk_exports__, 'Ib', { get: () => KS });
Object.defineProperty(__dcg_chunk_exports__, 'Jb', { get: () => ps });
Object.defineProperty(__dcg_chunk_exports__, 'Kb', { get: () => fs });
Object.defineProperty(__dcg_chunk_exports__, 'Lb', { get: () => Vs });
Object.defineProperty(__dcg_chunk_exports__, 'Mb', { get: () => Se });
Object.defineProperty(__dcg_chunk_exports__, 'Nb', { get: () => Ff });
Object.defineProperty(__dcg_chunk_exports__, 'Ob', { get: () => en });
Object.defineProperty(__dcg_chunk_exports__, 'Pb', { get: () => b });
Object.defineProperty(__dcg_chunk_exports__, 'Qb', { get: () => hz });
Object.defineProperty(__dcg_chunk_exports__, 'Rb', { get: () => Jp });
Object.defineProperty(__dcg_chunk_exports__, 'Sb', { get: () => PP });
Object.defineProperty(__dcg_chunk_exports__, 'Tb', { get: () => rn });
Object.defineProperty(__dcg_chunk_exports__, 'Ub', { get: () => Hi });
Object.defineProperty(__dcg_chunk_exports__, 'Vb', { get: () => _z });
Object.defineProperty(__dcg_chunk_exports__, 'Wb', { get: () => yR });
Object.defineProperty(__dcg_chunk_exports__, 'Xb', { get: () => A0 });
Object.defineProperty(__dcg_chunk_exports__, 'Yb', { get: () => Wi });
Object.defineProperty(__dcg_chunk_exports__, 'Zb', { get: () => Gf });
Object.defineProperty(__dcg_chunk_exports__, '_b', { get: () => q0 });
Object.defineProperty(__dcg_chunk_exports__, '$b', { get: () => Hr });
Object.defineProperty(__dcg_chunk_exports__, 'ac', { get: () => se });
Object.defineProperty(__dcg_chunk_exports__, 'bc', { get: () => vb });
Object.defineProperty(__dcg_chunk_exports__, 'cc', { get: () => yo });
Object.defineProperty(__dcg_chunk_exports__, 'dc', { get: () => hE });
Object.defineProperty(__dcg_chunk_exports__, 'ec', { get: () => DE });
Object.defineProperty(__dcg_chunk_exports__, 'fc', { get: () => xi });
Object.defineProperty(__dcg_chunk_exports__, 'gc', { get: () => QE });
Object.defineProperty(__dcg_chunk_exports__, 'hc', { get: () => rv });
Object.defineProperty(__dcg_chunk_exports__, 'ic', { get: () => ad });
Object.defineProperty(__dcg_chunk_exports__, 'jc', { get: () => gv });
Object.defineProperty(__dcg_chunk_exports__, 'kc', { get: () => Ns });
Object.defineProperty(__dcg_chunk_exports__, 'lc', { get: () => RL });
Object.defineProperty(__dcg_chunk_exports__, 'mc', { get: () => E5 });
Object.defineProperty(__dcg_chunk_exports__, 'nc', { get: () => du });
Object.defineProperty(__dcg_chunk_exports__, 'oc', { get: () => FL });
Object.defineProperty(__dcg_chunk_exports__, 'pc', { get: () => xv });
Object.defineProperty(__dcg_chunk_exports__, 'qc', { get: () => Tv });
Object.defineProperty(__dcg_chunk_exports__, 'rc', { get: () => jt });
Object.defineProperty(__dcg_chunk_exports__, 'sc', { get: () => ld });
Object.defineProperty(__dcg_chunk_exports__, 'tc', { get: () => QL });
Object.defineProperty(__dcg_chunk_exports__, 'uc', { get: () => c1 });
Object.defineProperty(__dcg_chunk_exports__, 'vc', { get: () => Sd });
Object.defineProperty(__dcg_chunk_exports__, 'wc', { get: () => p1 });
Object.defineProperty(__dcg_chunk_exports__, 'xc', { get: () => f1 });
Object.defineProperty(__dcg_chunk_exports__, 'yc', { get: () => Vx });
Object.defineProperty(__dcg_chunk_exports__, 'zc', { get: () => Gx });
Object.defineProperty(__dcg_chunk_exports__, 'Ac', { get: () => zx });
Object.defineProperty(__dcg_chunk_exports__, 'Bc', { get: () => qx });
Object.defineProperty(__dcg_chunk_exports__, 'Cc', { get: () => b1 });
Object.defineProperty(__dcg_chunk_exports__, 'Dc', { get: () => x1 });
Object.defineProperty(__dcg_chunk_exports__, 'Ec', { get: () => Ao });
Object.defineProperty(__dcg_chunk_exports__, 'Fc', { get: () => Gl });
Object.defineProperty(__dcg_chunk_exports__, 'Gc', { get: () => wd });
Object.defineProperty(__dcg_chunk_exports__, 'Hc', { get: () => N6 });
Object.defineProperty(__dcg_chunk_exports__, 'Ic', { get: () => A6 });
Object.defineProperty(__dcg_chunk_exports__, 'Jc', { get: () => R6 });
Object.defineProperty(__dcg_chunk_exports__, 'Kc', { get: () => _1 });
Object.defineProperty(__dcg_chunk_exports__, 'Lc', { get: () => C6 });
Object.defineProperty(__dcg_chunk_exports__, 'Mc', { get: () => _6 });
Object.defineProperty(__dcg_chunk_exports__, 'Nc', { get: () => F6 });
Object.defineProperty(__dcg_chunk_exports__, 'Oc', { get: () => B1 });
Object.defineProperty(__dcg_chunk_exports__, 'Pc', { get: () => L_ });
Object.defineProperty(__dcg_chunk_exports__, 'Qc', { get: () => _d });
Object.defineProperty(__dcg_chunk_exports__, 'Rc', { get: () => V1 });
Object.defineProperty(__dcg_chunk_exports__, 'Sc', { get: () => G1 });
Object.defineProperty(__dcg_chunk_exports__, 'Tc', { get: () => Z6 });
Object.defineProperty(__dcg_chunk_exports__, 'Uc', { get: () => j6 });
Object.defineProperty(__dcg_chunk_exports__, 'Vc', { get: () => w_ });
Object.defineProperty(__dcg_chunk_exports__, 'Wc', { get: () => J6 });
Object.defineProperty(__dcg_chunk_exports__, 'Xc', { get: () => Q6 });
Object.defineProperty(__dcg_chunk_exports__, 'Yc', { get: () => Z1 });
Object.defineProperty(__dcg_chunk_exports__, 'Zc', { get: () => rF });
Object.defineProperty(__dcg_chunk_exports__, '_c', { get: () => nF });
Object.defineProperty(__dcg_chunk_exports__, '$c', { get: () => kl });
Object.defineProperty(__dcg_chunk_exports__, 'ad', { get: () => Ul });
Object.defineProperty(__dcg_chunk_exports__, 'bd', { get: () => zd });
Object.defineProperty(__dcg_chunk_exports__, 'cd', { get: () => aO });

    return __dcg_chunk_exports__;
  };
  const __dcg_shared_module_exports__ = __dcg_shared_module__();
const __dcg_worker_module__ = (__dcg_shared_module_exports__) => {var o={};__dcg_shared_module_exports__['M'].log=function(e){self.postMessage({log:JSON.stringify(e)})};var a=self;a.window=a;a.onmessage=function(e){var n=e.data&&e.data.connectionId;if(n)if(e.data.originalMessage.type==="destroy")delete o[n];else{var s=o[n];s||(s=new __dcg_shared_module_exports__['cd'](function(g,c){a.postMessage({connectionId:n,originalMessage:{type:g,payload:c}})}),o[n]=s),s.processChangeSet(e.data.originalMessage)}};a.loadMessageQueue&&(a.loadMessageQueue.forEach(function(e){a.onmessage(e)}),delete a.loadMessageQueue);

};

  const __dcg_worker_source_exports__ = (function () {
    // worker.js
    const __dcg_worker_module_source__ = `
      const __dcg_shared_module__ = ${__dcg_shared_module__.toString()};
      const __dcg_worker_module__ = ${__dcg_worker_module__.toString()};
      __dcg_worker_module__(__dcg_shared_module__());`

    let createWorker;
    if (typeof Blob !== 'undefined' && URL && typeof URL.createObjectURL === 'function') {
      createWorker = () => {
        const workerURL = URL.createObjectURL(new Blob([__dcg_worker_module_source__], { type: 'application/javascript' }))
        const worker = new Worker(workerURL);
        worker.revokeObjectURL = () => {
          URL.revokeObjectURL(workerURL);
        }
        return worker;
      }
    } else {
      // Just for testing in Node
      createWorker = () => {
        (new Function(__dcg_worker_module_source__))();
      }
    }

    return {createWorker, default: {createWorker}};
  })();
  var B5,YG,XG=__dcg_shared_module_exports__['f'](()=>{B5=function(){{let i=function(o){t&&r.evtInScope(o)&&(o.stopPropagation(),o.stopImmediatePropagation())},n=function(o){t&&r.evtInScope(o)&&(o.preventDefault(),o.stopPropagation(),o.stopImmediatePropagation())};var t=!1,e=null,r={isGhostEvent:function(o){return!1},evtInScope:function(o){return!1}};return document.addEventListener("mousedown",function(o){r.evtInScope(o)&&(e=document.activeElement,t=r.isGhostEvent(o),i(o))},!0),document.addEventListener("mouseup",i,!0),document.addEventListener("click",function(o){n(o),t&&document.activeElement!==e&&(document.activeElement&&document.activeElement.blur(),e&&e.focus()),t=!1},!0),document.addEventListener("focus",n,!0),document.addEventListener("blur",n,!0),r}}(),YG=B5});function aL(t,e,r){r=r||Rr;var i,n,o=r.createElement("script");if(o.text=t,e)for(i in U5)n=e[i]||e.getAttribute&&e.getAttribute(i),n&&o.setAttribute(i,n);r.head.appendChild(o).parentNode.removeChild(o)}function Yu(t){return t==null?t+"":typeof t=="object"||typeof t=="function"?sv[oL.call(t)]||"object":typeof t}function QG(t){var e=!!t&&"length"in t&&t.length,r=Yu(t);return gr(t)||ju(t)?!1:r==="array"||e===0||typeof e=="number"&&e>0&&e-1 in t}function sl(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()}function ZG(t,e,r){return gr(e)?G.grep(t,function(i,n){return!!e.call(i,n,i)!==r}):e.nodeType?G.grep(t,function(i){return i===e!==r}):typeof e!="string"?G.grep(t,function(i){return tv.call(e,i)>-1!==r}):G.filter(e,t,r)}function _A(t,e){for(;(t=t[e])&&t.nodeType!==1;);return t}function W5(t){var e={};return G.each(t.match(_c)||[],function(r,i){e[i]=!0}),e}function qu(t){return t}function Zx(t){throw t}function FA(t,e,r,i){var n;try{t&&gr(n=t.promise)?n.call(t).done(e).fail(r):t&&gr(n=t.then)?n.call(t,e,r):e.apply(void 0,[t].slice(i))}catch(o){r.apply(void 0,[o])}}function iv(){Rr.removeEventListener("DOMContentLoaded",iv),window.removeEventListener("load",iv),G.ready()}function X5(t,e){return e.toUpperCase()}function Oc(t){return t.replace(J5,"ms-").replace(Y5,X5)}function Of(){this.expando=G.expando+Of.uid++}function eU(t){return t==="true"?!0:t==="false"?!1:t==="null"?null:t===+t+""?+t:Q5.test(t)?JSON.parse(t):t}function RA(t,e,r){var i;if(r===void 0&&t.nodeType===1)if(i="data-"+e.replace(Z5,"-$&").toLowerCase(),r=t.getAttribute(i),typeof r=="string"){try{r=eU(r)}catch(n){}sa.set(t,e,r)}else r=void 0;return r}function uL(t,e,r,i){var n,o,s=20,a=i?function(){return i.cur()}:function(){return G.css(t,e,"")},l=a(),c=r&&r[3]||(G.cssNumber[e]?"":"px"),d=t.nodeType&&(G.cssNumber[e]||c!=="px"&&+l)&&_f.exec(G.css(t,e));if(d&&d[3]!==c){for(l=l/2,c=c||d[3],d=+l||1;s--;)G.style(t,e,d+c),(1-o)*(1-(o=a()/l||.5))<=0&&(s=0),d=d/o;d=d*2,G.style(t,e,d+c),r=r||[]}return r&&(d=+d||+l||0,n=r[1]?d+(r[1]+1)*r[2]:+r[2],i&&(i.unit=c,i.start=d,i.end=n)),n}function rU(t){var e,r=t.ownerDocument,i=t.nodeName,n=NA[i];return n||(e=r.body.appendChild(r.createElement(i)),n=G.css(e,"display"),e.parentNode.removeChild(e),n==="none"&&(n="block"),NA[i]=n,n)}function zu(t,e){for(var r,i,n=[],o=0,s=t.length;o<s;o++)i=t[o],i.style&&(r=i.style.display,e?(r==="none"&&(n[o]=Kt.get(i,"display")||null,n[o]||(i.style.display="")),i.style.display===""&&av(i)&&(n[o]=rU(i))):r!=="none"&&(n[o]="none",Kt.set(i,"display",r)));for(o=0;o<s;o++)n[o]!=null&&(t[o].style.display=n[o]);return t}function na(t,e){var r;return typeof t.getElementsByTagName!="undefined"?r=t.getElementsByTagName(e||"*"):typeof t.querySelectorAll!="undefined"?r=t.querySelectorAll(e||"*"):r=[],e===void 0||e&&sl(t,e)?G.merge([t],r):r}function uV(t,e){for(var r=0,i=t.length;r<i;r++)Kt.set(t[r],"globalEval",!e||Kt.get(e[r],"globalEval"))}function fL(t,e,r,i,n){for(var o,s,a,l,c,d,u=e.createDocumentFragment(),p=[],g=0,b=t.length;g<b;g++)if(o=t[g],o||o===0)if(Yu(o)==="object")G.merge(p,o.nodeType?[o]:o);else if(!iU.test(o))p.push(e.createTextNode(o));else{for(s=s||u.appendChild(e.createElement("div")),a=(gL.exec(o)||["",""])[1].toLowerCase(),l=ol[a]||ol._default,s.innerHTML=l[1]+G.htmlPrefilter(o)+l[2],d=l[0];d--;)s=s.lastChild;G.merge(p,s.childNodes),s=u.firstChild,s.textContent=""}for(u.textContent="",g=0;o=p[g++];){if(i&&G.inArray(o,i)>-1){n&&n.push(o);continue}if(c=Xu(o),s=na(u.appendChild(o),"script"),c&&uV(s),r)for(d=0;o=s[d++];)mL.test(o.type||"")&&r.push(o)}return u}function $u(){return!0}function Wu(){return!1}function nU(t,e){return t===oU()==(e==="focus")}function oU(){try{return Rr.activeElement}catch(t){}}function iV(t,e,r,i,n,o){var s,a;if(typeof e=="object"){typeof r!="string"&&(i=i||r,r=void 0);for(a in e)iV(t,a,r,i,e[a],o);return t}if(i==null&&n==null?(n=r,i=r=void 0):n==null&&(typeof r=="string"?(n=i,i=void 0):(n=i,i=r,r=void 0)),n===!1)n=Wu;else if(!n)return t;return o===1&&(s=n,n=function(l){return G().off(l),s.apply(this,arguments)},n.guid=s.guid||(s.guid=G.guid++)),t.each(function(){G.event.add(this,e,n,i,r)})}function nv(t,e,r){if(!r){Kt.get(t,e)===void 0&&G.event.add(t,e,$u);return}Kt.set(t,e,!1),G.event.add(t,e,{namespace:!1,handler:function(i){var n,o,s=Kt.get(this,e);if(i.isTrigger&1&&this[e]){if(s.length)(G.event.special[e]||{}).delegateType&&i.stopPropagation();else if(s=Eh.call(arguments),Kt.set(this,e,s),n=r(this,e),this[e](),o=Kt.get(this,e),s!==o||n?Kt.set(this,e,!1):o={},s!==o)return i.stopImmediatePropagation(),i.preventDefault(),o&&o.value}else s.length&&(Kt.set(this,e,{value:G.event.trigger(G.extend(s[0],G.Event.prototype),s.slice(1),this)}),i.stopImmediatePropagation())}})}function KA(t,e){return sl(t,"table")&&sl(e.nodeType!==11?e:e.firstChild,"tr")&&G(t).children("tbody")[0]||t}function cU(t){return t.type=(t.getAttribute("type")!==null)+"/"+t.type,t}function dU(t){return(t.type||"").slice(0,5)==="true/"?t.type=t.type.slice(5):t.removeAttribute("type"),t}function UA(t,e){var r,i,n,o,s,a,l;if(e.nodeType===1){if(Kt.hasData(t)&&(o=Kt.get(t),l=o.events,l)){Kt.remove(e,"handle events");for(n in l)for(r=0,i=l[n].length;r<i;r++)G.event.add(e,n,l[n][r])}sa.hasData(t)&&(s=sa.access(t),a=G.extend({},s),sa.set(e,a))}}function hU(t,e){var r=e.nodeName.toLowerCase();r==="input"&&Tf.test(t.type)?e.checked=t.checked:(r==="input"||r==="textarea")&&(e.defaultValue=t.defaultValue)}function Hu(t,e,r,i){e=nL(e);var n,o,s,a,l,c,d=0,u=t.length,p=u-1,g=e[0],b=gr(g);if(b||u>1&&typeof g=="string"&&!Si.checkClone&&aU.test(g))return t.each(function(x){var w=t.eq(x);b&&(e[0]=g.call(this,x,w.html())),Hu(w,e,r,i)});if(u&&(n=fL(e,t[0].ownerDocument,!1,t,i),o=n.firstChild,n.childNodes.length===1&&(n=o),o||i)){for(s=G.map(na(n,"script"),cU),a=s.length;d<u;d++)l=n,d!==p&&(l=G.clone(l,!0,!0),a&&G.merge(s,na(l,"script"))),r.call(t[d],l,d);if(a)for(c=s[s.length-1].ownerDocument,G.map(s,dU),d=0;d<a;d++)l=s[d],mL.test(l.type||"")&&!Kt.access(l,"globalEval")&&G.contains(c,l)&&(l.src&&(l.type||"").toLowerCase()!=="module"?G._evalUrl&&!l.noModule&&G._evalUrl(l.src,{nonce:l.nonce||l.getAttribute("nonce")},c):aL(l.textContent.replace(lU,""),l,c))}return t}function qA(t,e,r){for(var i,n=e?G.filter(e,t):t,o=0;(i=n[o])!=null;o++)!r&&i.nodeType===1&&G.cleanData(na(i)),i.parentNode&&(r&&Xu(i)&&uV(na(i,"script")),i.parentNode.removeChild(i));return t}function Lf(t,e,r){var i,n,o,s,a=t.style;return r=r||lv(t),r&&(s=r.getPropertyValue(e)||r[e],s===""&&!Xu(t)&&(s=G.style(t,e)),!Si.pixelBoxStyles()&&gV.test(s)&&pU.test(e)&&(i=a.width,n=a.minWidth,o=a.maxWidth,a.minWidth=a.maxWidth=a.width=s,s=r.width,a.width=i,a.minWidth=n,a.maxWidth=o)),s!==void 0?s+"":s}function bL(t,e){return{get:function(){if(t()){delete this.get;return}return(this.get=e).apply(this,arguments)}}}function uU(t){for(var e=t[0].toUpperCase()+t.slice(1),r=HA.length;r--;)if(t=HA[r]+e,t in wL)return t}function nV(t){var e=G.cssProps[t]||zA[t];return e||(t in wL?t:zA[t]=uU(t)||t)}function xL(t,e,r){var i=_f.exec(e);return i?Math.max(0,i[2]-(r||0))+(i[3]||"px"):e}function oV(t,e,r,i,n,o){var s=e==="width"?1:0,a=0,l=0;if(r===(i?"border":"content"))return 0;for(;s<4;s+=2)r==="margin"&&(l+=G.css(t,r+kd[s],!0,n)),i?(r==="content"&&(l-=G.css(t,"padding"+kd[s],!0,n)),r!=="margin"&&(l-=G.css(t,"border"+kd[s]+"Width",!0,n))):(l+=G.css(t,"padding"+kd[s],!0,n),r!=="padding"?l+=G.css(t,"border"+kd[s]+"Width",!0,n):a+=G.css(t,"border"+kd[s]+"Width",!0,n));return!i&&o>=0&&(l+=Math.max(0,Math.ceil(t["offset"+e[0].toUpperCase()+e.slice(1)]-o-l-a-.5))||0),l}function jA(t,e,r){var i=lv(t),n=!Si.boxSizingReliable()||r,o=n&&G.css(t,"boxSizing",!1,i)==="border-box",s=o,a=Lf(t,e,i),l="offset"+e[0].toUpperCase()+e.slice(1);if(gV.test(a)){if(!r)return a;a="auto"}return(!Si.boxSizingReliable()&&o||!Si.reliableTrDimensions()&&sl(t,"tr")||a==="auto"||!parseFloat(a)&&G.css(t,"display",!1,i)==="inline")&&t.getClientRects().length&&(o=G.css(t,"boxSizing",!1,i)==="border-box",s=l in t,s&&(a=t[l])),a=parseFloat(a)||0,a+oV(t,e,r||(o?"border":"content"),s,i,a)+"px"}function oa(t,e,r,i,n){return new oa.prototype.init(t,e,r,i,n)}function sV(){ov&&(Rr.hidden===!1&&window.requestAnimationFrame?window.requestAnimationFrame(sV):window.setTimeout(sV,G.fx.interval),G.fx.tick())}function JA(){return window.setTimeout(function(){Ju=void 0}),Ju=Date.now()}function ev(t,e){var r,i=0,n={height:t};for(e=e?1:0;i<4;i+=2-e)r=kd[i],n["margin"+r]=n["padding"+r]=t;return e&&(n.opacity=n.width=t),n}function vL(t,e,r){for(var i,n=(Kl.tweeners[e]||[]).concat(Kl.tweeners["*"]),o=0,s=n.length;o<s;o++)if(i=n[o].call(r,e,t))return i}function bU(t,e,r){var i,n,o,s,a,l,c,d,u="width"in e||"height"in e,p=this,g={},b=t.style,x=t.nodeType&&av(t),w=Kt.get(t,"fxshow");r.queue||(s=G._queueHooks(t,"fx"),s.unqueued==null&&(s.unqueued=0,a=s.empty.fire,s.empty.fire=function(){s.unqueued||a()}),s.unqueued++,p.always(function(){p.always(function(){s.unqueued--,G.queue(t,"fx").length||s.empty.fire()})}));for(i in e)if(n=e[i],fU.test(n)){if(delete e[i],o=o||n==="toggle",n===(x?"hide":"show"))if(n==="show"&&w&&w[i]!==void 0)x=!0;else continue;g[i]=w&&w[i]||G.style(t,i)}if(l=!G.isEmptyObject(e),!(!l&&G.isEmptyObject(g))){u&&t.nodeType===1&&(r.overflow=[b.overflow,b.overflowX,b.overflowY],c=w&&w.display,c==null&&(c=Kt.get(t,"display")),d=G.css(t,"display"),d==="none"&&(c?d=c:(zu([t],!0),c=t.style.display||c,d=G.css(t,"display"),zu([t]))),(d==="inline"||d==="inline-block"&&c!=null)&&G.css(t,"float")==="none"&&(l||(p.done(function(){b.display=c}),c==null&&(d=b.display,c=d==="none"?"":d)),b.display="inline-block")),r.overflow&&(b.overflow="hidden",p.always(function(){b.overflow=r.overflow[0],b.overflowX=r.overflow[1],b.overflowY=r.overflow[2]})),l=!1;for(i in g)l||(w?"hidden"in w&&(x=w.hidden):w=Kt.access(t,"fxshow",{display:c}),o&&(w.hidden=!x),x&&zu([t],!0),p.done(function(){x||zu([t]),Kt.remove(t,"fxshow");for(i in g)G.style(t,i,g[i])})),l=vL(x?w[i]:0,i,p),i in w||(w[i]=l.start,x&&(l.end=l.start,l.start=0))}}function wU(t,e){var r,i,n,o,s;for(r in t)if(i=Oc(r),n=e[i],o=t[r],Array.isArray(o)&&(n=o[1],o=t[r]=o[0]),r!==i&&(t[i]=o,delete t[r]),s=G.cssHooks[i],s&&"expand"in s){o=s.expand(o),delete t[i];for(r in o)r in t||(t[r]=o[r],e[r]=n)}else e[i]=n}function Kl(t,e,r){var i,n,o=0,s=Kl.prefilters.length,a=G.Deferred().always(function(){delete l.elem}),l=function(){if(n)return!1;for(var u=Ju||JA(),p=Math.max(0,c.startTime+c.duration-u),g=p/c.duration||0,b=1-g,x=0,w=c.tweens.length;x<w;x++)c.tweens[x].run(b);return a.notifyWith(t,[c,b,p]),b<1&&w?p:(w||a.notifyWith(t,[c,1,0]),a.resolveWith(t,[c]),!1)},c=a.promise({elem:t,props:G.extend({},e),opts:G.extend(!0,{specialEasing:{},easing:G.easing._default},r),originalProperties:e,originalOptions:r,startTime:Ju||JA(),duration:r.duration,tweens:[],createTween:function(u,p){var g=G.Tween(t,c.opts,u,p,c.opts.specialEasing[u]||c.opts.easing);return c.tweens.push(g),g},stop:function(u){var p=0,g=u?c.tweens.length:0;if(n)return this;for(n=!0;p<g;p++)c.tweens[p].run(1);return u?(a.notifyWith(t,[c,1,0]),a.resolveWith(t,[c,u])):a.rejectWith(t,[c,u]),this}}),d=c.props;for(wU(d,c.opts.specialEasing);o<s;o++)if(i=Kl.prefilters[o].call(c,t,d,c.opts),i)return gr(i.stop)&&(G._queueHooks(c.elem,c.opts.queue).stop=i.stop.bind(i)),i;return G.map(d,vL,c),gr(c.opts.start)&&c.opts.start.call(t,c),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always),G.fx.timer(G.extend(l,{elem:t,anim:c,queue:c.opts.queue})),c}function Mp(t){var e=t.match(_c)||[];return e.join(" ")}function Ip(t){return t.getAttribute&&t.getAttribute("class")||""}function eV(t){return Array.isArray(t)?t:typeof t=="string"?t.match(_c)||[]:[]}function lV(t,e,r,i){var n;if(Array.isArray(e))G.each(e,function(o,s){r||DU.test(t)?i(t,s):lV(t+"["+(typeof s=="object"&&s!=null?o:"")+"]",s,r,i)});else if(!r&&Yu(e)==="object")for(n in e)lV(t+"["+n+"]",e[n],r,i);else i(t,e)}function tL(t){return function(e,r){typeof e!="string"&&(r=e,e="*");var i,n=0,o=e.toLowerCase().match(_c)||[];if(gr(r))for(;i=o[n++];)i[0]==="+"?(i=i.slice(1)||"*",(t[i]=t[i]||[]).unshift(r)):(t[i]=t[i]||[]).push(r)}}function rL(t,e,r,i){var n={},o=t===cV;function s(a){var l;return n[a]=!0,G.each(t[a]||[],function(c,d){var u=d(e,r,i);if(typeof u=="string"&&!o&&!n[u])return e.dataTypes.unshift(u),s(u),!1;if(o)return!(l=u)}),l}return s(e.dataTypes[0])||!n["*"]&&s("*")}function tV(t,e){var r,i,n=G.ajaxSettings.flatOptions||{};for(r in e)e[r]!==void 0&&((n[r]?t:i||(i={}))[r]=e[r]);return i&&G.extend(!0,t,i),t}function LU(t,e,r){for(var i,n,o,s,a=t.contents,l=t.dataTypes;l[0]==="*";)l.shift(),i===void 0&&(i=t.mimeType||e.getResponseHeader("Content-Type"));if(i){for(n in a)if(a[n]&&a[n].test(i)){l.unshift(n);break}}if(l[0]in r)o=l[0];else{for(n in r){if(!l[0]||t.converters[n+" "+l[0]]){o=n;break}s||(s=n)}o=o||s}if(o)return o!==l[0]&&l.unshift(o),r[o]}function PU(t,e,r,i){var n,o,s,a,l,c={},d=t.dataTypes.slice();if(d[1])for(s in t.converters)c[s.toLowerCase()]=t.converters[s];for(o=d.shift();o;)if(t.responseFields[o]&&(r[t.responseFields[o]]=e),!l&&i&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l=o,o=d.shift(),o){if(o==="*")o=l;else if(l!=="*"&&l!==o){if(s=c[l+" "+o]||c["* "+o],!s){for(n in c)if(a=n.split(" "),a[1]===o&&(s=c[l+" "+a[0]]||c["* "+a[0]],s)){s===!0?s=c[n]:c[n]!==!0&&(o=a[0],d.unshift(a[1]));break}}if(s!==!0)if(s&&t.throws)e=s(e);else try{e=s(e)}catch(u){return{state:"parsererror",error:s?u:"No conversion from "+l+" to "+o}}}}return{state:"success",data:e}}var Gd,iL,Eh,nL,hV,tv,sv,oL,rv,sL,K5,Si,gr,ju,Rr,U5,lL,G,Ap,Uu,OA,cL,dL,hL,q5,H5,z5,$5,_c,j5,pV,Vd,J5,Y5,Af,Kt,sa,Q5,Z5,pL,_f,kd,Tp,Xu,tU,av,NA,Tf,gL,mL,ol,iU,BA,sU,aU,lU,gV,lv,yL,pU,HA,wL,zA,gU,$A,mU,WA,Ju,ov,fU,yU,CL,If,xU,vU,CU,YA,XA,Mf,DL,aV,DU,QA,SU,EU,kU,GU,VU,IU,MU,TU,AU,ZA,cV,eL,dV,OU,Pf,SL,rV,_U,FU,RU,I,Oe=__dcg_shared_module_exports__['f'](()=>{XG();Gd=[],iL=Object.getPrototypeOf,Eh=Gd.slice,nL=Gd.flat?function(t){return Gd.flat.call(t)}:function(t){return Gd.concat.apply([],t)},hV=Gd.push,tv=Gd.indexOf,sv={},oL=sv.toString,rv=sv.hasOwnProperty,sL=rv.toString,K5=sL.call(Object),Si={},gr=function(e){return typeof e=="function"&&typeof e.nodeType!="number"&&typeof e.item!="function"},ju=function(e){return e!=null&&e===e.window},Rr=window.document,U5={type:!0,src:!0,nonce:!0,noModule:!0};lL="3.6.0",G=function(t,e){return new G.fn.init(t,e)};G.fn=G.prototype={jquery:lL,constructor:G,length:0,toArray:function(){return Eh.call(this)},get:function(t){return t==null?Eh.call(this):t<0?this[t+this.length]:this[t]},pushStack:function(t){var e=G.merge(this.constructor(),t);return e.prevObject=this,e},each:function(t){return G.each(this,t)},map:function(t){return this.pushStack(G.map(this,function(e,r){return t.call(e,r,e)}))},slice:function(){return this.pushStack(Eh.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(G.grep(this,function(t,e){return(e+1)%2}))},odd:function(){return this.pushStack(G.grep(this,function(t,e){return e%2}))},eq:function(t){var e=this.length,r=+t+(t<0?e:0);return this.pushStack(r>=0&&r<e?[this[r]]:[])},end:function(){return this.prevObject||this.constructor()},push:hV,sort:Gd.sort,splice:Gd.splice};G.extend=G.fn.extend=function(){var t,e,r,i,n,o,s=arguments[0]||{},a=1,l=arguments.length,c=!1;for(typeof s=="boolean"&&(c=s,s=arguments[a]||{},a++),typeof s!="object"&&!gr(s)&&(s={}),a===l&&(s=this,a--);a<l;a++)if((t=arguments[a])!=null)for(e in t)i=t[e],!(e==="__proto__"||s===i)&&(c&&i&&(G.isPlainObject(i)||(n=Array.isArray(i)))?(r=s[e],n&&!Array.isArray(r)?o=[]:!n&&!G.isPlainObject(r)?o={}:o=r,n=!1,s[e]=G.extend(c,o,i)):i!==void 0&&(s[e]=i));return s};G.extend({expando:"jQuery"+(lL+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isPlainObject:function(t){var e,r;return!t||oL.call(t)!=="[object Object]"?!1:(e=iL(t),e?(r=rv.call(e,"constructor")&&e.constructor,typeof r=="function"&&sL.call(r)===K5):!0)},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},globalEval:function(t,e,r){aL(t,{nonce:e&&e.nonce},r)},each:function(t,e){var r,i=0;if(QG(t))for(r=t.length;i<r&&e.call(t[i],i,t[i])!==!1;i++);else for(i in t)if(e.call(t[i],i,t[i])===!1)break;return t},makeArray:function(t,e){var r=e||[];return t!=null&&(QG(Object(t))?G.merge(r,typeof t=="string"?[t]:t):hV.call(r,t)),r},inArray:function(t,e,r){return e==null?-1:tv.call(e,t,r)},merge:function(t,e){for(var r=+e.length,i=0,n=t.length;i<r;i++)t[n++]=e[i];return t.length=n,t},grep:function(t,e,r){for(var i,n=[],o=0,s=t.length,a=!r;o<s;o++)i=!e(t[o],o),i!==a&&n.push(t[o]);return n},map:function(t,e,r){var i,n,o=0,s=[];if(QG(t))for(i=t.length;o<i;o++)n=e(t[o],o,r),n!=null&&s.push(n);else for(o in t)n=e(t[o],o,r),n!=null&&s.push(n);return nL(s)},guid:1,support:Si});typeof Symbol=="function"&&(G.fn[Symbol.iterator]=Gd[Symbol.iterator]);G.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(t,e){sv["[object "+e+"]"]=e.toLowerCase()});Ap=function(t){var e,r,i,n,o,s,a,l,c,d,u,p,g,b,x,w,E,k,S,T="sizzle"+1*new Date,V=t.document,O=0,y=0,L=Gr(),P=Gr(),K=Gr(),$=Gr(),U=function(N,W){return N===W&&(u=!0),0},J={}.hasOwnProperty,R=[],q=R.pop,_=R.push,A=R.push,z=R.slice,Q=function(N,W){for(var re=0,be=N.length;re<be;re++)if(N[re]===W)return re;return-1},fe="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",ie="[\\x20\\t\\r\\n\\f]",Le="(?:\\\\[\\da-fA-F]{1,6}"+ie+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",pe="\\["+ie+"*("+Le+")(?:"+ie+"*([*^$|!~]?=)"+ie+`*(?:'((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)"|(`+Le+"))|)"+ie+"*\\]",ae=":("+Le+`)(?:\\((('((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)")|((?:\\\\.|[^\\\\()[\\]]|`+pe+")*)|.*)\\)|)",ye=new RegExp(ie+"+","g"),H=new RegExp("^"+ie+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ie+"+$","g"),ge=new RegExp("^"+ie+"*,"+ie+"*"),Se=new RegExp("^"+ie+"*([>+~]|"+ie+")"+ie+"*"),Ke=new RegExp(ie+"|>"),Ae=new RegExp(ae),Ze=new RegExp("^"+Le+"$"),qe={ID:new RegExp("^#("+Le+")"),CLASS:new RegExp("^\\.("+Le+")"),TAG:new RegExp("^("+Le+"|[*])"),ATTR:new RegExp("^"+pe),PSEUDO:new RegExp("^"+ae),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ie+"*(even|odd|(([+-]|)(\\d*)n|)"+ie+"*(?:([+-]|)"+ie+"*(\\d+)|))"+ie+"*\\)|)","i"),bool:new RegExp("^(?:"+fe+")$","i"),needsContext:new RegExp("^"+ie+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ie+"*((?:-\\d)?\\d*)"+ie+"*\\)|)(?=[^-]|$)","i")},At=/HTML$/i,Fe=/^(?:input|select|textarea|button)$/i,Lt=/^h\d$/i,_r=/^[^{]+\{\s*\[native \w/,Ge=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,vi=/[+~]/,ht=new RegExp("\\\\[\\da-fA-F]{1,6}"+ie+"?|\\\\([^\\r\\n\\f])","g"),Ee=function(N,W){var re="0x"+N.slice(1)-65536;return W||(re<0?String.fromCharCode(re+65536):String.fromCharCode(re>>10|55296,re&1023|56320))},bo=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,st=function(N,W){return W?N==="\0"?"\uFFFD":N.slice(0,-1)+"\\"+N.charCodeAt(N.length-1).toString(16)+" ":"\\"+N},gt=function(){p()},ft=Ci(function(N){return N.disabled===!0&&N.nodeName.toLowerCase()==="fieldset"},{dir:"parentNode",next:"legend"});try{A.apply(R=z.call(V.childNodes),V.childNodes),R[V.childNodes.length].nodeType}catch(N){A={apply:R.length?function(W,re){_.apply(W,z.call(re))}:function(W,re){for(var be=W.length,se=0;W[be++]=re[se++];);W.length=be-1}}}function le(N,W,re,be){var se,ue,De,ze,$e,kt,ct,wt=W&&W.ownerDocument,Vt=W?W.nodeType:9;if(re=re||[],typeof N!="string"||!N||Vt!==1&&Vt!==9&&Vt!==11)return re;if(!be&&(p(W),W=W||g,x)){if(Vt!==11&&($e=Ge.exec(N)))if(se=$e[1]){if(Vt===9)if(De=W.getElementById(se)){if(De.id===se)return re.push(De),re}else return re;else if(wt&&(De=wt.getElementById(se))&&S(W,De)&&De.id===se)return re.push(De),re}else{if($e[2])return A.apply(re,W.getElementsByTagName(N)),re;if((se=$e[3])&&r.getElementsByClassName&&W.getElementsByClassName)return A.apply(re,W.getElementsByClassName(se)),re}if(r.qsa&&!$[N+" "]&&(!w||!w.test(N))&&(Vt!==1||W.nodeName.toLowerCase()!=="object")){if(ct=N,wt=W,Vt===1&&(Ke.test(N)||Se.test(N))){for(wt=vi.test(N)&&ta(W.parentNode)||W,(wt!==W||!r.scope)&&((ze=W.getAttribute("id"))?ze=ze.replace(bo,st):W.setAttribute("id",ze=T)),kt=s(N),ue=kt.length;ue--;)kt[ue]=(ze?"#"+ze:":scope")+" "+Mr(kt[ue]);ct=kt.join(",")}try{return A.apply(re,wt.querySelectorAll(ct)),re}catch(ar){$(N,!0)}finally{ze===T&&W.removeAttribute("id")}}}return l(N.replace(H,"$1"),W,re,be)}function Gr(){var N=[];function W(re,be){return N.push(re+" ")>i.cacheLength&&delete W[N.shift()],W[re+" "]=be}return W}function _e(N){return N[T]=!0,N}function rr(N){var W=g.createElement("fieldset");try{return!!N(W)}catch(re){return!1}finally{W.parentNode&&W.parentNode.removeChild(W),W=null}}function ve(N,W){for(var re=N.split("|"),be=re.length;be--;)i.attrHandle[re[be]]=W}function Et(N,W){var re=W&&N,be=re&&N.nodeType===1&&W.nodeType===1&&N.sourceIndex-W.sourceIndex;if(be)return be;if(re){for(;re=re.nextSibling;)if(re===W)return-1}return N?1:-1}function It(N){return function(W){var re=W.nodeName.toLowerCase();return re==="input"&&W.type===N}}function Ve(N){return function(W){var re=W.nodeName.toLowerCase();return(re==="input"||re==="button")&&W.type===N}}function ni(N){return function(W){return"form"in W?W.parentNode&&W.disabled===!1?"label"in W?"label"in W.parentNode?W.parentNode.disabled===N:W.disabled===N:W.isDisabled===N||W.isDisabled!==!N&&ft(W)===N:W.disabled===N:"label"in W?W.disabled===N:!1}}function rt(N){return _e(function(W){return W=+W,_e(function(re,be){for(var se,ue=N([],re.length,W),De=ue.length;De--;)re[se=ue[De]]&&(re[se]=!(be[se]=re[se]))})})}function ta(N){return N&&typeof N.getElementsByTagName!="undefined"&&N}r=le.support={},o=le.isXML=function(N){var W=N&&N.namespaceURI,re=N&&(N.ownerDocument||N).documentElement;return!At.test(W||re&&re.nodeName||"HTML")},p=le.setDocument=function(N){var W,re,be=N?N.ownerDocument||N:V;return be==g||be.nodeType!==9||!be.documentElement||(g=be,b=g.documentElement,x=!o(g),V!=g&&(re=g.defaultView)&&re.top!==re&&(re.addEventListener?re.addEventListener("unload",gt,!1):re.attachEvent&&re.attachEvent("onunload",gt)),r.scope=rr(function(se){return b.appendChild(se).appendChild(g.createElement("div")),typeof se.querySelectorAll!="undefined"&&!se.querySelectorAll(":scope fieldset div").length}),r.attributes=rr(function(se){return se.className="i",!se.getAttribute("className")}),r.getElementsByTagName=rr(function(se){return se.appendChild(g.createComment("")),!se.getElementsByTagName("*").length}),r.getElementsByClassName=_r.test(g.getElementsByClassName),r.getById=rr(function(se){return b.appendChild(se).id=T,!g.getElementsByName||!g.getElementsByName(T).length}),r.getById?(i.filter.ID=function(se){var ue=se.replace(ht,Ee);return function(De){return De.getAttribute("id")===ue}},i.find.ID=function(se,ue){if(typeof ue.getElementById!="undefined"&&x){var De=ue.getElementById(se);return De?[De]:[]}}):(i.filter.ID=function(se){var ue=se.replace(ht,Ee);return function(De){var ze=typeof De.getAttributeNode!="undefined"&&De.getAttributeNode("id");return ze&&ze.value===ue}},i.find.ID=function(se,ue){if(typeof ue.getElementById!="undefined"&&x){var De,ze,$e,kt=ue.getElementById(se);if(kt){if(De=kt.getAttributeNode("id"),De&&De.value===se)return[kt];for($e=ue.getElementsByName(se),ze=0;kt=$e[ze++];)if(De=kt.getAttributeNode("id"),De&&De.value===se)return[kt]}return[]}}),i.find.TAG=r.getElementsByTagName?function(se,ue){if(typeof ue.getElementsByTagName!="undefined")return ue.getElementsByTagName(se);if(r.qsa)return ue.querySelectorAll(se)}:function(se,ue){var De,ze=[],$e=0,kt=ue.getElementsByTagName(se);if(se==="*"){for(;De=kt[$e++];)De.nodeType===1&&ze.push(De);return ze}return kt},i.find.CLASS=r.getElementsByClassName&&function(se,ue){if(typeof ue.getElementsByClassName!="undefined"&&x)return ue.getElementsByClassName(se)},E=[],w=[],(r.qsa=_r.test(g.querySelectorAll))&&(rr(function(se){var ue;b.appendChild(se).innerHTML="<a id='"+T+"'></a><select id='"+T+"-\r\\' msallowcapture=''><option selected=''></option></select>",se.querySelectorAll("[msallowcapture^='']").length&&w.push("[*^$]="+ie+`*(?:''|"")`),se.querySelectorAll("[selected]").length||w.push("\\["+ie+"*(?:value|"+fe+")"),se.querySelectorAll("[id~="+T+"-]").length||w.push("~="),ue=g.createElement("input"),ue.setAttribute("name",""),se.appendChild(ue),se.querySelectorAll("[name='']").length||w.push("\\["+ie+"*name"+ie+"*="+ie+`*(?:''|"")`),se.querySelectorAll(":checked").length||w.push(":checked"),se.querySelectorAll("a#"+T+"+*").length||w.push(".#.+[+~]"),se.querySelectorAll("\\\f"),w.push("[\\r\\n\\f]")}),rr(function(se){se.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var ue=g.createElement("input");ue.setAttribute("type","hidden"),se.appendChild(ue).setAttribute("name","D"),se.querySelectorAll("[name=d]").length&&w.push("name"+ie+"*[*^$|!~]?="),se.querySelectorAll(":enabled").length!==2&&w.push(":enabled",":disabled"),b.appendChild(se).disabled=!0,se.querySelectorAll(":disabled").length!==2&&w.push(":enabled",":disabled"),se.querySelectorAll("*,:x"),w.push(",.*:")})),(r.matchesSelector=_r.test(k=b.matches||b.webkitMatchesSelector||b.mozMatchesSelector||b.oMatchesSelector||b.msMatchesSelector))&&rr(function(se){r.disconnectedMatch=k.call(se,"*"),k.call(se,"[s!='']:x"),E.push("!=",ae)}),w=w.length&&new RegExp(w.join("|")),E=E.length&&new RegExp(E.join("|")),W=_r.test(b.compareDocumentPosition),S=W||_r.test(b.contains)?function(se,ue){var De=se.nodeType===9?se.documentElement:se,ze=ue&&ue.parentNode;return se===ze||!!(ze&&ze.nodeType===1&&(De.contains?De.contains(ze):se.compareDocumentPosition&&se.compareDocumentPosition(ze)&16))}:function(se,ue){if(ue){for(;ue=ue.parentNode;)if(ue===se)return!0}return!1},U=W?function(se,ue){if(se===ue)return u=!0,0;var De=!se.compareDocumentPosition-!ue.compareDocumentPosition;return De||(De=(se.ownerDocument||se)==(ue.ownerDocument||ue)?se.compareDocumentPosition(ue):1,De&1||!r.sortDetached&&ue.compareDocumentPosition(se)===De?se==g||se.ownerDocument==V&&S(V,se)?-1:ue==g||ue.ownerDocument==V&&S(V,ue)?1:d?Q(d,se)-Q(d,ue):0:De&4?-1:1)}:function(se,ue){if(se===ue)return u=!0,0;var De,ze=0,$e=se.parentNode,kt=ue.parentNode,ct=[se],wt=[ue];if(!$e||!kt)return se==g?-1:ue==g?1:$e?-1:kt?1:d?Q(d,se)-Q(d,ue):0;if($e===kt)return Et(se,ue);for(De=se;De=De.parentNode;)ct.unshift(De);for(De=ue;De=De.parentNode;)wt.unshift(De);for(;ct[ze]===wt[ze];)ze++;return ze?Et(ct[ze],wt[ze]):ct[ze]==V?-1:wt[ze]==V?1:0}),g},le.matches=function(N,W){return le(N,null,null,W)},le.matchesSelector=function(N,W){if(p(N),r.matchesSelector&&x&&!$[W+" "]&&(!E||!E.test(W))&&(!w||!w.test(W)))try{var re=k.call(N,W);if(re||r.disconnectedMatch||N.document&&N.document.nodeType!==11)return re}catch(be){$(W,!0)}return le(W,g,null,[N]).length>0},le.contains=function(N,W){return(N.ownerDocument||N)!=g&&p(N),S(N,W)},le.attr=function(N,W){(N.ownerDocument||N)!=g&&p(N);var re=i.attrHandle[W.toLowerCase()],be=re&&J.call(i.attrHandle,W.toLowerCase())?re(N,W,!x):void 0;return be!==void 0?be:r.attributes||!x?N.getAttribute(W):(be=N.getAttributeNode(W))&&be.specified?be.value:null},le.escape=function(N){return(N+"").replace(bo,st)},le.error=function(N){throw new Error("Syntax error, unrecognized expression: "+N)},le.uniqueSort=function(N){var W,re=[],be=0,se=0;if(u=!r.detectDuplicates,d=!r.sortStable&&N.slice(0),N.sort(U),u){for(;W=N[se++];)W===N[se]&&(be=re.push(se));for(;be--;)N.splice(re[be],1)}return d=null,N},n=le.getText=function(N){var W,re="",be=0,se=N.nodeType;if(se){if(se===1||se===9||se===11){if(typeof N.textContent=="string")return N.textContent;for(N=N.firstChild;N;N=N.nextSibling)re+=n(N)}else if(se===3||se===4)return N.nodeValue}else for(;W=N[be++];)re+=n(W);return re},i=le.selectors={cacheLength:50,createPseudo:_e,match:qe,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(N){return N[1]=N[1].replace(ht,Ee),N[3]=(N[3]||N[4]||N[5]||"").replace(ht,Ee),N[2]==="~="&&(N[3]=" "+N[3]+" "),N.slice(0,4)},CHILD:function(N){return N[1]=N[1].toLowerCase(),N[1].slice(0,3)==="nth"?(N[3]||le.error(N[0]),N[4]=+(N[4]?N[5]+(N[6]||1):2*(N[3]==="even"||N[3]==="odd")),N[5]=+(N[7]+N[8]||N[3]==="odd")):N[3]&&le.error(N[0]),N},PSEUDO:function(N){var W,re=!N[6]&&N[2];return qe.CHILD.test(N[0])?null:(N[3]?N[2]=N[4]||N[5]||"":re&&Ae.test(re)&&(W=s(re,!0))&&(W=re.indexOf(")",re.length-W)-re.length)&&(N[0]=N[0].slice(0,W),N[2]=re.slice(0,W)),N.slice(0,3))}},filter:{TAG:function(N){var W=N.replace(ht,Ee).toLowerCase();return N==="*"?function(){return!0}:function(re){return re.nodeName&&re.nodeName.toLowerCase()===W}},CLASS:function(N){var W=L[N+" "];return W||(W=new RegExp("(^|"+ie+")"+N+"("+ie+"|$)"))&&L(N,function(re){return W.test(typeof re.className=="string"&&re.className||typeof re.getAttribute!="undefined"&&re.getAttribute("class")||"")})},ATTR:function(N,W,re){return function(be){var se=le.attr(be,N);return se==null?W==="!=":W?(se+="",W==="="?se===re:W==="!="?se!==re:W==="^="?re&&se.indexOf(re)===0:W==="*="?re&&se.indexOf(re)>-1:W==="$="?re&&se.slice(-re.length)===re:W==="~="?(" "+se.replace(ye," ")+" ").indexOf(re)>-1:W==="|="?se===re||se.slice(0,re.length+1)===re+"-":!1):!0}},CHILD:function(N,W,re,be,se){var ue=N.slice(0,3)!=="nth",De=N.slice(-4)!=="last",ze=W==="of-type";return be===1&&se===0?function($e){return!!$e.parentNode}:function($e,kt,ct){var wt,Vt,ar,St,zi,Fn,Di=ue!==De?"nextSibling":"previousSibling",$i=$e.parentNode,gh=ze&&$e.nodeName.toLowerCase(),bp=!ct&&!ze,Ds=!1;if($i){if(ue){for(;Di;){for(St=$e;St=St[Di];)if(ze?St.nodeName.toLowerCase()===gh:St.nodeType===1)return!1;Fn=Di=N==="only"&&!Fn&&"nextSibling"}return!0}if(Fn=[De?$i.firstChild:$i.lastChild],De&&bp){for(St=$i,ar=St[T]||(St[T]={}),Vt=ar[St.uniqueID]||(ar[St.uniqueID]={}),wt=Vt[N]||[],zi=wt[0]===O&&wt[1],Ds=zi&&wt[2],St=zi&&$i.childNodes[zi];St=++zi&&St&&St[Di]||(Ds=zi=0)||Fn.pop();)if(St.nodeType===1&&++Ds&&St===$e){Vt[N]=[O,zi,Ds];break}}else if(bp&&(St=$e,ar=St[T]||(St[T]={}),Vt=ar[St.uniqueID]||(ar[St.uniqueID]={}),wt=Vt[N]||[],zi=wt[0]===O&&wt[1],Ds=zi),Ds===!1)for(;(St=++zi&&St&&St[Di]||(Ds=zi=0)||Fn.pop())&&!((ze?St.nodeName.toLowerCase()===gh:St.nodeType===1)&&++Ds&&(bp&&(ar=St[T]||(St[T]={}),Vt=ar[St.uniqueID]||(ar[St.uniqueID]={}),Vt[N]=[O,Ds]),St===$e)););return Ds-=se,Ds===be||Ds%be===0&&Ds/be>=0}}},PSEUDO:function(N,W){var re,be=i.pseudos[N]||i.setFilters[N.toLowerCase()]||le.error("unsupported pseudo: "+N);return be[T]?be(W):be.length>1?(re=[N,N,"",W],i.setFilters.hasOwnProperty(N.toLowerCase())?_e(function(se,ue){for(var De,ze=be(se,W),$e=ze.length;$e--;)De=Q(se,ze[$e]),se[De]=!(ue[De]=ze[$e])}):function(se){return be(se,0,re)}):be}},pseudos:{not:_e(function(N){var W=[],re=[],be=a(N.replace(H,"$1"));return be[T]?_e(function(se,ue,De,ze){for(var $e,kt=be(se,null,ze,[]),ct=se.length;ct--;)($e=kt[ct])&&(se[ct]=!(ue[ct]=$e))}):function(se,ue,De){return W[0]=se,be(W,null,De,re),W[0]=null,!re.pop()}}),has:_e(function(N){return function(W){return le(N,W).length>0}}),contains:_e(function(N){return N=N.replace(ht,Ee),function(W){return(W.textContent||n(W)).indexOf(N)>-1}}),lang:_e(function(N){return Ze.test(N||"")||le.error("unsupported lang: "+N),N=N.replace(ht,Ee).toLowerCase(),function(W){var re;do if(re=x?W.lang:W.getAttribute("xml:lang")||W.getAttribute("lang"))return re=re.toLowerCase(),re===N||re.indexOf(N+"-")===0;while((W=W.parentNode)&&W.nodeType===1);return!1}}),target:function(N){var W=t.location&&t.location.hash;return W&&W.slice(1)===N.id},root:function(N){return N===b},focus:function(N){return N===g.activeElement&&(!g.hasFocus||g.hasFocus())&&!!(N.type||N.href||~N.tabIndex)},enabled:ni(!1),disabled:ni(!0),checked:function(N){var W=N.nodeName.toLowerCase();return W==="input"&&!!N.checked||W==="option"&&!!N.selected},selected:function(N){return N.parentNode&&N.parentNode.selectedIndex,N.selected===!0},empty:function(N){for(N=N.firstChild;N;N=N.nextSibling)if(N.nodeType<6)return!1;return!0},parent:function(N){return!i.pseudos.empty(N)},header:function(N){return Lt.test(N.nodeName)},input:function(N){return Fe.test(N.nodeName)},button:function(N){var W=N.nodeName.toLowerCase();return W==="input"&&N.type==="button"||W==="button"},text:function(N){var W;return N.nodeName.toLowerCase()==="input"&&N.type==="text"&&((W=N.getAttribute("type"))==null||W.toLowerCase()==="text")},first:rt(function(){return[0]}),last:rt(function(N,W){return[W-1]}),eq:rt(function(N,W,re){return[re<0?re+W:re]}),even:rt(function(N,W){for(var re=0;re<W;re+=2)N.push(re);return N}),odd:rt(function(N,W){for(var re=1;re<W;re+=2)N.push(re);return N}),lt:rt(function(N,W,re){for(var be=re<0?re+W:re>W?W:re;--be>=0;)N.push(be);return N}),gt:rt(function(N,W,re){for(var be=re<0?re+W:re;++be<W;)N.push(be);return N})}},i.pseudos.nth=i.pseudos.eq;for(e in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})i.pseudos[e]=It(e);for(e in{submit:!0,reset:!0})i.pseudos[e]=Ve(e);function _t(){}_t.prototype=i.filters=i.pseudos,i.setFilters=new _t,s=le.tokenize=function(N,W){var re,be,se,ue,De,ze,$e,kt=P[N+" "];if(kt)return W?0:kt.slice(0);for(De=N,ze=[],$e=i.preFilter;De;){(!re||(be=ge.exec(De)))&&(be&&(De=De.slice(be[0].length)||De),ze.push(se=[])),re=!1,(be=Se.exec(De))&&(re=be.shift(),se.push({value:re,type:be[0].replace(H," ")}),De=De.slice(re.length));for(ue in i.filter)(be=qe[ue].exec(De))&&(!$e[ue]||(be=$e[ue](be)))&&(re=be.shift(),se.push({value:re,type:ue,matches:be}),De=De.slice(re.length));if(!re)break}return W?De.length:De?le.error(N):P(N,ze).slice(0)};function Mr(N){for(var W=0,re=N.length,be="";W<re;W++)be+=N[W].value;return be}function Ci(N,W,re){var be=W.dir,se=W.next,ue=se||be,De=re&&ue==="parentNode",ze=y++;return W.first?function($e,kt,ct){for(;$e=$e[be];)if($e.nodeType===1||De)return N($e,kt,ct);return!1}:function($e,kt,ct){var wt,Vt,ar,St=[O,ze];if(ct){for(;$e=$e[be];)if(($e.nodeType===1||De)&&N($e,kt,ct))return!0}else for(;$e=$e[be];)if($e.nodeType===1||De)if(ar=$e[T]||($e[T]={}),Vt=ar[$e.uniqueID]||(ar[$e.uniqueID]={}),se&&se===$e.nodeName.toLowerCase())$e=$e[be]||$e;else{if((wt=Vt[ue])&&wt[0]===O&&wt[1]===ze)return St[2]=wt[2];if(Vt[ue]=St,St[2]=N($e,kt,ct))return!0}return!1}}function gn(N){return N.length>1?function(W,re,be){for(var se=N.length;se--;)if(!N[se](W,re,be))return!1;return!0}:N[0]}function Ll(N,W,re){for(var be=0,se=W.length;be<se;be++)le(N,W[be],re);return re}function wo(N,W,re,be,se){for(var ue,De=[],ze=0,$e=N.length,kt=W!=null;ze<$e;ze++)(ue=N[ze])&&(!re||re(ue,be,se))&&(De.push(ue),kt&&W.push(ze));return De}function ro(N,W,re,be,se,ue){return be&&!be[T]&&(be=ro(be)),se&&!se[T]&&(se=ro(se,ue)),_e(function(De,ze,$e,kt){var ct,wt,Vt,ar=[],St=[],zi=ze.length,Fn=De||Ll(W||"*",$e.nodeType?[$e]:$e,[]),Di=N&&(De||!W)?wo(Fn,ar,N,$e,kt):Fn,$i=re?se||(De?N:zi||be)?[]:ze:Di;if(re&&re(Di,$i,$e,kt),be)for(ct=wo($i,St),be(ct,[],$e,kt),wt=ct.length;wt--;)(Vt=ct[wt])&&($i[St[wt]]=!(Di[St[wt]]=Vt));if(De){if(se||N){if(se){for(ct=[],wt=$i.length;wt--;)(Vt=$i[wt])&&ct.push(Di[wt]=Vt);se(null,$i=[],ct,kt)}for(wt=$i.length;wt--;)(Vt=$i[wt])&&(ct=se?Q(De,Vt):ar[wt])>-1&&(De[ct]=!(ze[ct]=Vt))}}else $i=wo($i===ze?$i.splice(zi,$i.length):$i),se?se(null,ze,$i,kt):A.apply(ze,$i)})}function nr(N){for(var W,re,be,se=N.length,ue=i.relative[N[0].type],De=ue||i.relative[" "],ze=ue?1:0,$e=Ci(function(wt){return wt===W},De,!0),kt=Ci(function(wt){return Q(W,wt)>-1},De,!0),ct=[function(wt,Vt,ar){var St=!ue&&(ar||Vt!==c)||((W=Vt).nodeType?$e(wt,Vt,ar):kt(wt,Vt,ar));return W=null,St}];ze<se;ze++)if(re=i.relative[N[ze].type])ct=[Ci(gn(ct),re)];else{if(re=i.filter[N[ze].type].apply(null,N[ze].matches),re[T]){for(be=++ze;be<se&&!i.relative[N[be].type];be++);return ro(ze>1&&gn(ct),ze>1&&Mr(N.slice(0,ze-1).concat({value:N[ze-2].type===" "?"*":""})).replace(H,"$1"),re,ze<be&&nr(N.slice(ze,be)),be<se&&nr(N=N.slice(be)),be<se&&Mr(N))}ct.push(re)}return gn(ct)}function Hi(N,W){var re=W.length>0,be=N.length>0,se=function(ue,De,ze,$e,kt){var ct,wt,Vt,ar=0,St="0",zi=ue&&[],Fn=[],Di=c,$i=ue||be&&i.find.TAG("*",kt),gh=O+=Di==null?1:Math.random()||.1,bp=$i.length;for(kt&&(c=De==g||De||kt);St!==bp&&(ct=$i[St])!=null;St++){if(be&&ct){for(wt=0,!De&&ct.ownerDocument!=g&&(p(ct),ze=!x);Vt=N[wt++];)if(Vt(ct,De||g,ze)){$e.push(ct);break}kt&&(O=gh)}re&&((ct=!Vt&&ct)&&ar--,ue&&zi.push(ct))}if(ar+=St,re&&St!==ar){for(wt=0;Vt=W[wt++];)Vt(zi,Fn,De,ze);if(ue){if(ar>0)for(;St--;)zi[St]||Fn[St]||(Fn[St]=q.call($e));Fn=wo(Fn)}A.apply($e,Fn),kt&&!ue&&Fn.length>0&&ar+W.length>1&&le.uniqueSort($e)}return kt&&(O=gh,c=Di),zi};return re?_e(se):se}return a=le.compile=function(N,W){var re,be=[],se=[],ue=K[N+" "];if(!ue){for(W||(W=s(N)),re=W.length;re--;)ue=nr(W[re]),ue[T]?be.push(ue):se.push(ue);ue=K(N,Hi(se,be)),ue.selector=N}return ue},l=le.select=function(N,W,re,be){var se,ue,De,ze,$e,kt=typeof N=="function"&&N,ct=!be&&s(N=kt.selector||N);if(re=re||[],ct.length===1){if(ue=ct[0]=ct[0].slice(0),ue.length>2&&(De=ue[0]).type==="ID"&&W.nodeType===9&&x&&i.relative[ue[1].type]){if(W=(i.find.ID(De.matches[0].replace(ht,Ee),W)||[])[0],W)kt&&(W=W.parentNode);else return re;N=N.slice(ue.shift().value.length)}for(se=qe.needsContext.test(N)?0:ue.length;se--&&(De=ue[se],!i.relative[ze=De.type]);)if(($e=i.find[ze])&&(be=$e(De.matches[0].replace(ht,Ee),vi.test(ue[0].type)&&ta(W.parentNode)||W))){if(ue.splice(se,1),N=be.length&&Mr(ue),!N)return A.apply(re,be),re;break}}return(kt||a(N,ct))(be,W,!x,re,!W||vi.test(N)&&ta(W.parentNode)||W),re},r.sortStable=T.split("").sort(U).join("")===T,r.detectDuplicates=!!u,p(),r.sortDetached=rr(function(N){return N.compareDocumentPosition(g.createElement("fieldset"))&1}),rr(function(N){return N.innerHTML="<a href='#'></a>",N.firstChild.getAttribute("href")==="#"})||ve("type|href|height|width",function(N,W,re){if(!re)return N.getAttribute(W,W.toLowerCase()==="type"?1:2)}),(!r.attributes||!rr(function(N){return N.innerHTML="<input/>",N.firstChild.setAttribute("value",""),N.firstChild.getAttribute("value")===""}))&&ve("value",function(N,W,re){if(!re&&N.nodeName.toLowerCase()==="input")return N.defaultValue}),rr(function(N){return N.getAttribute("disabled")==null})||ve(fe,function(N,W,re){var be;if(!re)return N[W]===!0?W.toLowerCase():(be=N.getAttributeNode(W))&&be.specified?be.value:null}),le}(window);G.find=Ap;G.expr=Ap.selectors;G.expr[":"]=G.expr.pseudos;G.uniqueSort=G.unique=Ap.uniqueSort;G.text=Ap.getText;G.isXMLDoc=Ap.isXML;G.contains=Ap.contains;G.escapeSelector=Ap.escape;Uu=function(t,e,r){for(var i=[],n=r!==void 0;(t=t[e])&&t.nodeType!==9;)if(t.nodeType===1){if(n&&G(t).is(r))break;i.push(t)}return i},OA=function(t,e){for(var r=[];t;t=t.nextSibling)t.nodeType===1&&t!==e&&r.push(t);return r},cL=G.expr.match.needsContext;dL=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;G.filter=function(t,e,r){var i=e[0];return r&&(t=":not("+t+")"),e.length===1&&i.nodeType===1?G.find.matchesSelector(i,t)?[i]:[]:G.find.matches(t,G.grep(e,function(n){return n.nodeType===1}))};G.fn.extend({find:function(t){var e,r,i=this.length,n=this;if(typeof t!="string")return this.pushStack(G(t).filter(function(){for(e=0;e<i;e++)if(G.contains(n[e],this))return!0}));for(r=this.pushStack([]),e=0;e<i;e++)G.find(t,n[e],r);return i>1?G.uniqueSort(r):r},filter:function(t){return this.pushStack(ZG(this,t||[],!1))},not:function(t){return this.pushStack(ZG(this,t||[],!0))},is:function(t){return!!ZG(this,typeof t=="string"&&cL.test(t)?G(t):t||[],!1).length}});q5=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,H5=G.fn.init=function(t,e,r){var i,n;if(!t)return this;if(r=r||hL,typeof t=="string")if(t[0]==="<"&&t[t.length-1]===">"&&t.length>=3?i=[null,t,null]:i=q5.exec(t),i&&(i[1]||!e))if(i[1]){if(e=e instanceof G?e[0]:e,G.merge(this,G.parseHTML(i[1],e&&e.nodeType?e.ownerDocument||e:Rr,!0)),dL.test(i[1])&&G.isPlainObject(e))for(i in e)gr(this[i])?this[i](e[i]):this.attr(i,e[i]);return this}else return n=Rr.getElementById(i[2]),n&&(this[0]=n,this.length=1),this;else return!e||e.jquery?(e||r).find(t):this.constructor(e).find(t);else{if(t.nodeType)return this[0]=t,this.length=1,this;if(gr(t))return r.ready!==void 0?r.ready(t):t(G)}return G.makeArray(t,this)};H5.prototype=G.fn;hL=G(Rr);z5=/^(?:parents|prev(?:Until|All))/,$5={children:!0,contents:!0,next:!0,prev:!0};G.fn.extend({has:function(t){var e=G(t,this),r=e.length;return this.filter(function(){for(var i=0;i<r;i++)if(G.contains(this,e[i]))return!0})},closest:function(t,e){var r,i=0,n=this.length,o=[],s=typeof t!="string"&&G(t);if(!cL.test(t)){for(;i<n;i++)for(r=this[i];r&&r!==e;r=r.parentNode)if(r.nodeType<11&&(s?s.index(r)>-1:r.nodeType===1&&G.find.matchesSelector(r,t))){o.push(r);break}}return this.pushStack(o.length>1?G.uniqueSort(o):o)},index:function(t){return t?typeof t=="string"?tv.call(G(t),this[0]):tv.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(G.uniqueSort(G.merge(this.get(),G(t,e))))},addBack:function(t){return this.add(t==null?this.prevObject:this.prevObject.filter(t))}});G.each({parent:function(t){var e=t.parentNode;return e&&e.nodeType!==11?e:null},parents:function(t){return Uu(t,"parentNode")},parentsUntil:function(t,e,r){return Uu(t,"parentNode",r)},next:function(t){return _A(t,"nextSibling")},prev:function(t){return _A(t,"previousSibling")},nextAll:function(t){return Uu(t,"nextSibling")},prevAll:function(t){return Uu(t,"previousSibling")},nextUntil:function(t,e,r){return Uu(t,"nextSibling",r)},prevUntil:function(t,e,r){return Uu(t,"previousSibling",r)},siblings:function(t){return OA((t.parentNode||{}).firstChild,t)},children:function(t){return OA(t.firstChild)},contents:function(t){return t.contentDocument!=null&&iL(t.contentDocument)?t.contentDocument:(sl(t,"template")&&(t=t.content||t),G.merge([],t.childNodes))}},function(t,e){G.fn[t]=function(r,i){var n=G.map(this,e,r);return t.slice(-5)!=="Until"&&(i=r),i&&typeof i=="string"&&(n=G.filter(i,n)),this.length>1&&($5[t]||G.uniqueSort(n),z5.test(t)&&n.reverse()),this.pushStack(n)}});_c=/[^\x20\t\r\n\f]+/g;G.Callbacks=function(t){t=typeof t=="string"?W5(t):G.extend({},t);var e,r,i,n,o=[],s=[],a=-1,l=function(){for(n=n||t.once,i=e=!0;s.length;a=-1)for(r=s.shift();++a<o.length;)o[a].apply(r[0],r[1])===!1&&t.stopOnFalse&&(a=o.length,r=!1);t.memory||(r=!1),e=!1,n&&(r?o=[]:o="")},c={add:function(){return o&&(r&&!e&&(a=o.length-1,s.push(r)),function d(u){G.each(u,function(p,g){gr(g)?(!t.unique||!c.has(g))&&o.push(g):g&&g.length&&Yu(g)!=="string"&&d(g)})}(arguments),r&&!e&&l()),this},remove:function(){return G.each(arguments,function(d,u){for(var p;(p=G.inArray(u,o,p))>-1;)o.splice(p,1),p<=a&&a--}),this},has:function(d){return d?G.inArray(d,o)>-1:o.length>0},empty:function(){return o&&(o=[]),this},disable:function(){return n=s=[],o=r="",this},disabled:function(){return!o},lock:function(){return n=s=[],!r&&!e&&(o=r=""),this},locked:function(){return!!n},fireWith:function(d,u){return n||(u=u||[],u=[d,u.slice?u.slice():u],s.push(u),e||l()),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!i}};return c};G.extend({Deferred:function(t){var e=[["notify","progress",G.Callbacks("memory"),G.Callbacks("memory"),2],["resolve","done",G.Callbacks("once memory"),G.Callbacks("once memory"),0,"resolved"],["reject","fail",G.Callbacks("once memory"),G.Callbacks("once memory"),1,"rejected"]],r="pending",i={state:function(){return r},always:function(){return n.done(arguments).fail(arguments),this},catch:function(o){return i.then(null,o)},pipe:function(){var o=arguments;return G.Deferred(function(s){G.each(e,function(a,l){var c=gr(o[l[4]])&&o[l[4]];n[l[1]](function(){var d=c&&c.apply(this,arguments);d&&gr(d.promise)?d.promise().progress(s.notify).done(s.resolve).fail(s.reject):s[l[0]+"With"](this,c?[d]:arguments)})}),o=null}).promise()},then:function(o,s,a){var l=0;function c(d,u,p,g){return function(){var b=this,x=arguments,w=function(){var k,S;if(!(d<l)){if(k=p.apply(b,x),k===u.promise())throw new TypeError("Thenable self-resolution");S=k&&(typeof k=="object"||typeof k=="function")&&k.then,gr(S)?g?S.call(k,c(l,u,qu,g),c(l,u,Zx,g)):(l++,S.call(k,c(l,u,qu,g),c(l,u,Zx,g),c(l,u,qu,u.notifyWith))):(p!==qu&&(b=void 0,x=[k]),(g||u.resolveWith)(b,x))}},E=g?w:function(){try{w()}catch(k){G.Deferred.exceptionHook&&G.Deferred.exceptionHook(k,E.stackTrace),d+1>=l&&(p!==Zx&&(b=void 0,x=[k]),u.rejectWith(b,x))}};d?E():(G.Deferred.getStackHook&&(E.stackTrace=G.Deferred.getStackHook()),window.setTimeout(E))}}return G.Deferred(function(d){e[0][3].add(c(0,d,gr(a)?a:qu,d.notifyWith)),e[1][3].add(c(0,d,gr(o)?o:qu)),e[2][3].add(c(0,d,gr(s)?s:Zx))}).promise()},promise:function(o){return o!=null?G.extend(o,i):i}},n={};return G.each(e,function(o,s){var a=s[2],l=s[5];i[s[1]]=a.add,l&&a.add(function(){r=l},e[3-o][2].disable,e[3-o][3].disable,e[0][2].lock,e[0][3].lock),a.add(s[3].fire),n[s[0]]=function(){return n[s[0]+"With"](this===n?void 0:this,arguments),this},n[s[0]+"With"]=a.fireWith}),i.promise(n),t&&t.call(n,n),n},when:function(t){var e=arguments.length,r=e,i=Array(r),n=Eh.call(arguments),o=G.Deferred(),s=function(a){return function(l){i[a]=this,n[a]=arguments.length>1?Eh.call(arguments):l,--e||o.resolveWith(i,n)}};if(e<=1&&(FA(t,o.done(s(r)).resolve,o.reject,!e),o.state()==="pending"||gr(n[r]&&n[r].then)))return o.then();for(;r--;)FA(n[r],s(r),o.reject);return o.promise()}});j5=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;G.Deferred.exceptionHook=function(t,e){window.console&&window.console.warn&&t&&j5.test(t.name)&&window.console.warn("jQuery.Deferred exception: "+t.message,t.stack,e)};G.readyException=function(t){window.setTimeout(function(){throw t})};pV=G.Deferred();G.fn.ready=function(t){return pV.then(t).catch(function(e){G.readyException(e)}),this};G.extend({isReady:!1,readyWait:1,ready:function(t){(t===!0?--G.readyWait:G.isReady)||(G.isReady=!0,!(t!==!0&&--G.readyWait>0)&&pV.resolveWith(Rr,[G]))}});G.ready.then=pV.then;Rr.readyState==="complete"||Rr.readyState!=="loading"&&!Rr.documentElement.doScroll?window.setTimeout(G.ready):(Rr.addEventListener("DOMContentLoaded",iv),window.addEventListener("load",iv));Vd=function(t,e,r,i,n,o,s){var a=0,l=t.length,c=r==null;if(Yu(r)==="object"){n=!0;for(a in r)Vd(t,e,a,r[a],!0,o,s)}else if(i!==void 0&&(n=!0,gr(i)||(s=!0),c&&(s?(e.call(t,i),e=null):(c=e,e=function(d,u,p){return c.call(G(d),p)})),e))for(;a<l;a++)e(t[a],r,s?i:i.call(t[a],a,e(t[a],r)));return n?t:c?e.call(t):l?e(t[0],r):o},J5=/^-ms-/,Y5=/-([a-z])/g;Af=function(t){return t.nodeType===1||t.nodeType===9||!+t.nodeType};Of.uid=1;Of.prototype={cache:function(t){var e=t[this.expando];return e||(e={},Af(t)&&(t.nodeType?t[this.expando]=e:Object.defineProperty(t,this.expando,{value:e,configurable:!0}))),e},set:function(t,e,r){var i,n=this.cache(t);if(typeof e=="string")n[Oc(e)]=r;else for(i in e)n[Oc(i)]=e[i];return n},get:function(t,e){return e===void 0?this.cache(t):t[this.expando]&&t[this.expando][Oc(e)]},access:function(t,e,r){return e===void 0||e&&typeof e=="string"&&r===void 0?this.get(t,e):(this.set(t,e,r),r!==void 0?r:e)},remove:function(t,e){var r,i=t[this.expando];if(i!==void 0){if(e!==void 0)for(Array.isArray(e)?e=e.map(Oc):(e=Oc(e),e=e in i?[e]:e.match(_c)||[]),r=e.length;r--;)delete i[e[r]];(e===void 0||G.isEmptyObject(i))&&(t.nodeType?t[this.expando]=void 0:delete t[this.expando])}},hasData:function(t){var e=t[this.expando];return e!==void 0&&!G.isEmptyObject(e)}};Kt=new Of,sa=new Of,Q5=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Z5=/[A-Z]/g;G.extend({hasData:function(t){return sa.hasData(t)||Kt.hasData(t)},data:function(t,e,r){return sa.access(t,e,r)},removeData:function(t,e){sa.remove(t,e)},_data:function(t,e,r){return Kt.access(t,e,r)},_removeData:function(t,e){Kt.remove(t,e)}});G.fn.extend({data:function(t,e){var r,i,n,o=this[0],s=o&&o.attributes;if(t===void 0){if(this.length&&(n=sa.get(o),o.nodeType===1&&!Kt.get(o,"hasDataAttrs"))){for(r=s.length;r--;)s[r]&&(i=s[r].name,i.indexOf("data-")===0&&(i=Oc(i.slice(5)),RA(o,i,n[i])));Kt.set(o,"hasDataAttrs",!0)}return n}return typeof t=="object"?this.each(function(){sa.set(this,t)}):Vd(this,function(a){var l;if(o&&a===void 0)return l=sa.get(o,t),l!==void 0||(l=RA(o,t),l!==void 0)?l:void 0;this.each(function(){sa.set(this,t,a)})},null,e,arguments.length>1,null,!0)},removeData:function(t){return this.each(function(){sa.remove(this,t)})}});G.extend({queue:function(t,e,r){var i;if(t)return e=(e||"fx")+"queue",i=Kt.get(t,e),r&&(!i||Array.isArray(r)?i=Kt.access(t,e,G.makeArray(r)):i.push(r)),i||[]},dequeue:function(t,e){e=e||"fx";var r=G.queue(t,e),i=r.length,n=r.shift(),o=G._queueHooks(t,e),s=function(){G.dequeue(t,e)};n==="inprogress"&&(n=r.shift(),i--),n&&(e==="fx"&&r.unshift("inprogress"),delete o.stop,n.call(t,s,o)),!i&&o&&o.empty.fire()},_queueHooks:function(t,e){var r=e+"queueHooks";return Kt.get(t,r)||Kt.access(t,r,{empty:G.Callbacks("once memory").add(function(){Kt.remove(t,[e+"queue",r])})})}});G.fn.extend({queue:function(t,e){var r=2;return typeof t!="string"&&(e=t,t="fx",r--),arguments.length<r?G.queue(this[0],t):e===void 0?this:this.each(function(){var i=G.queue(this,t,e);G._queueHooks(this,t),t==="fx"&&i[0]!=="inprogress"&&G.dequeue(this,t)})},dequeue:function(t){return this.each(function(){G.dequeue(this,t)})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var r,i=1,n=G.Deferred(),o=this,s=this.length,a=function(){--i||n.resolveWith(o,[o])};for(typeof t!="string"&&(e=t,t=void 0),t=t||"fx";s--;)r=Kt.get(o[s],t+"queueHooks"),r&&r.empty&&(i++,r.empty.add(a));return a(),n.promise(e)}});pL=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,_f=new RegExp("^(?:([+-])=|)("+pL+")([a-z%]*)$","i"),kd=["Top","Right","Bottom","Left"],Tp=Rr.documentElement,Xu=function(t){return G.contains(t.ownerDocument,t)},tU={composed:!0};Tp.getRootNode&&(Xu=function(t){return G.contains(t.ownerDocument,t)||t.getRootNode(tU)===t.ownerDocument});av=function(t,e){return t=e||t,t.style.display==="none"||t.style.display===""&&Xu(t)&&G.css(t,"display")==="none"};NA={};G.fn.extend({show:function(){return zu(this,!0)},hide:function(){return zu(this)},toggle:function(t){return typeof t=="boolean"?t?this.show():this.hide():this.each(function(){av(this)?G(this).show():G(this).hide()})}});Tf=/^(?:checkbox|radio)$/i,gL=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,mL=/^$|^module$|\/(?:java|ecma)script/i;(function(){var t=Rr.createDocumentFragment(),e=t.appendChild(Rr.createElement("div")),r=Rr.createElement("input");r.setAttribute("type","radio"),r.setAttribute("checked","checked"),r.setAttribute("name","t"),e.appendChild(r),Si.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,e.innerHTML="<textarea>x</textarea>",Si.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue,e.innerHTML="<option></option>",Si.option=!!e.lastChild})();ol={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};ol.tbody=ol.tfoot=ol.colgroup=ol.caption=ol.thead;ol.th=ol.td;Si.option||(ol.optgroup=ol.option=[1,"<select multiple='multiple'>","</select>"]);iU=/<|&#?\w+;/;BA=/^([^.]*)(?:\.(.+)|)/;G.event={global:{},add:function(t,e,r,i,n){var o,s,a,l,c,d,u,p,g,b,x,w=Kt.get(t);if(Af(t))for(r.handler&&(o=r,r=o.handler,n=o.selector),n&&G.find.matchesSelector(Tp,n),r.guid||(r.guid=G.guid++),(l=w.events)||(l=w.events=Object.create(null)),(s=w.handle)||(s=w.handle=function(E){return typeof G!="undefined"&&G.event.triggered!==E.type?G.event.dispatch.apply(t,arguments):void 0}),e=(e||"").match(_c)||[""],c=e.length;c--;)a=BA.exec(e[c])||[],g=x=a[1],b=(a[2]||"").split(".").sort(),g&&(u=G.event.special[g]||{},g=(n?u.delegateType:u.bindType)||g,u=G.event.special[g]||{},d=G.extend({type:g,origType:x,data:i,handler:r,guid:r.guid,selector:n,needsContext:n&&G.expr.match.needsContext.test(n),namespace:b.join(".")},o),(p=l[g])||(p=l[g]=[],p.delegateCount=0,(!u.setup||u.setup.call(t,i,b,s)===!1)&&t.addEventListener&&t.addEventListener(g,s)),u.add&&(u.add.call(t,d),d.handler.guid||(d.handler.guid=r.guid)),n?p.splice(p.delegateCount++,0,d):p.push(d),G.event.global[g]=!0)},remove:function(t,e,r,i,n){var o,s,a,l,c,d,u,p,g,b,x,w=Kt.hasData(t)&&Kt.get(t);if(!(!w||!(l=w.events))){for(e=(e||"").match(_c)||[""],c=e.length;c--;){if(a=BA.exec(e[c])||[],g=x=a[1],b=(a[2]||"").split(".").sort(),!g){for(g in l)G.event.remove(t,g+e[c],r,i,!0);continue}for(u=G.event.special[g]||{},g=(i?u.delegateType:u.bindType)||g,p=l[g]||[],a=a[2]&&new RegExp("(^|\\.)"+b.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=o=p.length;o--;)d=p[o],(n||x===d.origType)&&(!r||r.guid===d.guid)&&(!a||a.test(d.namespace))&&(!i||i===d.selector||i==="**"&&d.selector)&&(p.splice(o,1),d.selector&&p.delegateCount--,u.remove&&u.remove.call(t,d));s&&!p.length&&((!u.teardown||u.teardown.call(t,b,w.handle)===!1)&&G.removeEvent(t,g,w.handle),delete l[g])}G.isEmptyObject(l)&&Kt.remove(t,"handle events")}},dispatch:function(t){var e,r,i,n,o,s,a=new Array(arguments.length),l=G.event.fix(t),c=(Kt.get(this,"events")||Object.create(null))[l.type]||[],d=G.event.special[l.type]||{};for(a[0]=l,e=1;e<arguments.length;e++)a[e]=arguments[e];if(l.delegateTarget=this,!(d.preDispatch&&d.preDispatch.call(this,l)===!1)){for(s=G.event.handlers.call(this,l,c),e=0;(n=s[e++])&&!l.isPropagationStopped();)for(l.currentTarget=n.elem,r=0;(o=n.handlers[r++])&&!l.isImmediatePropagationStopped();)(!l.rnamespace||o.namespace===!1||l.rnamespace.test(o.namespace))&&(l.handleObj=o,l.data=o.data,i=((G.event.special[o.origType]||{}).handle||o.handler).apply(n.elem,a),i!==void 0&&(l.result=i)===!1&&(l.preventDefault(),l.stopPropagation()));return d.postDispatch&&d.postDispatch.call(this,l),l.result}},handlers:function(t,e){var r,i,n,o,s,a=[],l=e.delegateCount,c=t.target;if(l&&c.nodeType&&!(t.type==="click"&&t.button>=1)){for(;c!==this;c=c.parentNode||this)if(c.nodeType===1&&!(t.type==="click"&&c.disabled===!0)){for(o=[],s={},r=0;r<l;r++)i=e[r],n=i.selector+" ",s[n]===void 0&&(s[n]=i.needsContext?G(n,this).index(c)>-1:G.find(n,this,null,[c]).length),s[n]&&o.push(i);o.length&&a.push({elem:c,handlers:o})}}return c=this,l<e.length&&a.push({elem:c,handlers:e.slice(l)}),a},addProp:function(t,e){Object.defineProperty(G.Event.prototype,t,{enumerable:!0,configurable:!0,get:gr(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},set:function(r){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:r})}})},fix:function(t){return t[G.expando]?t:new G.Event(t)},special:{load:{noBubble:!0},click:{setup:function(t){var e=this||t;return Tf.test(e.type)&&e.click&&sl(e,"input")&&nv(e,"click",$u),!1},trigger:function(t){var e=this||t;return Tf.test(e.type)&&e.click&&sl(e,"input")&&nv(e,"click"),!0},_default:function(t){var e=t.target;return Tf.test(e.type)&&e.click&&sl(e,"input")&&Kt.get(e,"click")||sl(e,"a")}},beforeunload:{postDispatch:function(t){t.result!==void 0&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}}};G.removeEvent=function(t,e,r){t.removeEventListener&&t.removeEventListener(e,r)};G.Event=function(t,e){if(!(this instanceof G.Event))return new G.Event(t,e);t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||t.defaultPrevented===void 0&&t.returnValue===!1?$u:Wu,this.target=t.target&&t.target.nodeType===3?t.target.parentNode:t.target,this.currentTarget=t.currentTarget,this.relatedTarget=t.relatedTarget):this.type=t,e&&G.extend(this,e),this.timeStamp=t&&t.timeStamp||Date.now(),this[G.expando]=!0};G.Event.prototype={constructor:G.Event,isDefaultPrevented:Wu,isPropagationStopped:Wu,isImmediatePropagationStopped:Wu,isSimulated:!1,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=$u,t&&!this.isSimulated&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=$u,t&&!this.isSimulated&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=$u,t&&!this.isSimulated&&t.stopImmediatePropagation(),this.stopPropagation()}};G.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},G.event.addProp);G.each({focus:"focusin",blur:"focusout"},function(t,e){G.event.special[t]={setup:function(){return nv(this,t,nU),!1},trigger:function(){return nv(this,t),!0},_default:function(){return!0},delegateType:e}});G.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(t,e){G.event.special[t]={delegateType:e,bindType:e,handle:function(r){var i,n=this,o=r.relatedTarget,s=r.handleObj;return(!o||o!==n&&!G.contains(n,o))&&(r.type=s.origType,i=s.handler.apply(this,arguments),r.type=e),i}}});G.fn.extend({on:function(t,e,r,i){return iV(this,t,e,r,i)},one:function(t,e,r,i){return iV(this,t,e,r,i,1)},off:function(t,e,r){var i,n;if(t&&t.preventDefault&&t.handleObj)return i=t.handleObj,G(t.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if(typeof t=="object"){for(n in t)this.off(n,e,t[n]);return this}return(e===!1||typeof e=="function")&&(r=e,e=void 0),r===!1&&(r=Wu),this.each(function(){G.event.remove(this,t,r,e)})}});sU=/<script|<style|<link/i,aU=/checked\s*(?:[^=]|=\s*.checked.)/i,lU=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;G.extend({htmlPrefilter:function(t){return t},clone:function(t,e,r){var i,n,o,s,a=t.cloneNode(!0),l=Xu(t);if(!Si.noCloneChecked&&(t.nodeType===1||t.nodeType===11)&&!G.isXMLDoc(t))for(s=na(a),o=na(t),i=0,n=o.length;i<n;i++)hU(o[i],s[i]);if(e)if(r)for(o=o||na(t),s=s||na(a),i=0,n=o.length;i<n;i++)UA(o[i],s[i]);else UA(t,a);return s=na(a,"script"),s.length>0&&uV(s,!l&&na(t,"script")),a},cleanData:function(t){for(var e,r,i,n=G.event.special,o=0;(r=t[o])!==void 0;o++)if(Af(r)){if(e=r[Kt.expando]){if(e.events)for(i in e.events)n[i]?G.event.remove(r,i):G.removeEvent(r,i,e.handle);r[Kt.expando]=void 0}r[sa.expando]&&(r[sa.expando]=void 0)}}});G.fn.extend({detach:function(t){return qA(this,t,!0)},remove:function(t){return qA(this,t)},text:function(t){return Vd(this,function(e){return e===void 0?G.text(this):this.empty().each(function(){(this.nodeType===1||this.nodeType===11||this.nodeType===9)&&(this.textContent=e)})},null,t,arguments.length)},append:function(){return Hu(this,arguments,function(t){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var e=KA(this,t);e.appendChild(t)}})},prepend:function(){return Hu(this,arguments,function(t){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var e=KA(this,t);e.insertBefore(t,e.firstChild)}})},before:function(){return Hu(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return Hu(this,arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},empty:function(){for(var t,e=0;(t=this[e])!=null;e++)t.nodeType===1&&(G.cleanData(na(t,!1)),t.textContent="");return this},clone:function(t,e){return t=t==null?!1:t,e=e==null?t:e,this.map(function(){return G.clone(this,t,e)})},html:function(t){return Vd(this,function(e){var r=this[0]||{},i=0,n=this.length;if(e===void 0&&r.nodeType===1)return r.innerHTML;if(typeof e=="string"&&!sU.test(e)&&!ol[(gL.exec(e)||["",""])[1].toLowerCase()]){e=G.htmlPrefilter(e);try{for(;i<n;i++)r=this[i]||{},r.nodeType===1&&(G.cleanData(na(r,!1)),r.innerHTML=e);r=0}catch(o){}}r&&this.empty().append(e)},null,t,arguments.length)},replaceWith:function(){var t=[];return Hu(this,arguments,function(e){var r=this.parentNode;G.inArray(this,t)<0&&(G.cleanData(na(this)),r&&r.replaceChild(e,this))},t)}});G.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){G.fn[t]=function(r){for(var i,n=[],o=G(r),s=o.length-1,a=0;a<=s;a++)i=a===s?this:this.clone(!0),G(o[a])[e](i),hV.apply(n,i.get());return this.pushStack(n)}});gV=new RegExp("^("+pL+")(?!px)[a-z%]+$","i"),lv=function(t){var e=t.ownerDocument.defaultView;return(!e||!e.opener)&&(e=window),e.getComputedStyle(t)},yL=function(t,e,r){var i,n,o={};for(n in e)o[n]=t.style[n],t.style[n]=e[n];i=r.call(t);for(n in e)t.style[n]=o[n];return i},pU=new RegExp(kd.join("|"),"i");(function(){function t(){if(c){l.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",c.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",Tp.appendChild(l).appendChild(c);var d=window.getComputedStyle(c);r=d.top!=="1%",a=e(d.marginLeft)===12,c.style.right="60%",o=e(d.right)===36,i=e(d.width)===36,c.style.position="absolute",n=e(c.offsetWidth/3)===12,Tp.removeChild(l),c=null}}function e(d){return Math.round(parseFloat(d))}var r,i,n,o,s,a,l=Rr.createElement("div"),c=Rr.createElement("div");c.style&&(c.style.backgroundClip="content-box",c.cloneNode(!0).style.backgroundClip="",Si.clearCloneStyle=c.style.backgroundClip==="content-box",G.extend(Si,{boxSizingReliable:function(){return t(),i},pixelBoxStyles:function(){return t(),o},pixelPosition:function(){return t(),r},reliableMarginLeft:function(){return t(),a},scrollboxSize:function(){return t(),n},reliableTrDimensions:function(){var d,u,p,g;return s==null&&(d=Rr.createElement("table"),u=Rr.createElement("tr"),p=Rr.createElement("div"),d.style.cssText="position:absolute;left:-11111px;border-collapse:separate",u.style.cssText="border:1px solid",u.style.height="1px",p.style.height="9px",p.style.display="block",Tp.appendChild(d).appendChild(u).appendChild(p),g=window.getComputedStyle(u),s=parseInt(g.height,10)+parseInt(g.borderTopWidth,10)+parseInt(g.borderBottomWidth,10)===u.offsetHeight,Tp.removeChild(d)),s}}))})();HA=["Webkit","Moz","ms"],wL=Rr.createElement("div").style,zA={};gU=/^(none|table(?!-c[ea]).+)/,$A=/^--/,mU={position:"absolute",visibility:"hidden",display:"block"},WA={letterSpacing:"0",fontWeight:"400"};G.extend({cssHooks:{opacity:{get:function(t,e){if(e){var r=Lf(t,"opacity");return r===""?"1":r}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(t,e,r,i){if(!(!t||t.nodeType===3||t.nodeType===8||!t.style)){var n,o,s,a=Oc(e),l=$A.test(e),c=t.style;if(l||(e=nV(a)),s=G.cssHooks[e]||G.cssHooks[a],r!==void 0){if(o=typeof r,o==="string"&&(n=_f.exec(r))&&n[1]&&(r=uL(t,e,n),o="number"),r==null||r!==r)return;o==="number"&&!l&&(r+=n&&n[3]||(G.cssNumber[a]?"":"px")),!Si.clearCloneStyle&&r===""&&e.indexOf("background")===0&&(c[e]="inherit"),(!s||!("set"in s)||(r=s.set(t,r,i))!==void 0)&&(l?c.setProperty(e,r):c[e]=r)}else return s&&"get"in s&&(n=s.get(t,!1,i))!==void 0?n:c[e]}},css:function(t,e,r,i){var n,o,s,a=Oc(e),l=$A.test(e);return l||(e=nV(a)),s=G.cssHooks[e]||G.cssHooks[a],s&&"get"in s&&(n=s.get(t,!0,r)),n===void 0&&(n=Lf(t,e,i)),n==="normal"&&e in WA&&(n=WA[e]),r===""||r?(o=parseFloat(n),r===!0||isFinite(o)?o||0:n):n}});G.each(["height","width"],function(t,e){G.cssHooks[e]={get:function(r,i,n){if(i)return gU.test(G.css(r,"display"))&&(!r.getClientRects().length||!r.getBoundingClientRect().width)?yL(r,mU,function(){return jA(r,e,n)}):jA(r,e,n)},set:function(r,i,n){var o,s=lv(r),a=!Si.scrollboxSize()&&s.position==="absolute",l=a||n,c=l&&G.css(r,"boxSizing",!1,s)==="border-box",d=n?oV(r,e,n,c,s):0;return c&&a&&(d-=Math.ceil(r["offset"+e[0].toUpperCase()+e.slice(1)]-parseFloat(s[e])-oV(r,e,"border",!1,s)-.5)),d&&(o=_f.exec(i))&&(o[3]||"px")!=="px"&&(r.style[e]=i,i=G.css(r,e)),xL(r,i,d)}}});G.cssHooks.marginLeft=bL(Si.reliableMarginLeft,function(t,e){if(e)return(parseFloat(Lf(t,"marginLeft"))||t.getBoundingClientRect().left-yL(t,{marginLeft:0},function(){return t.getBoundingClientRect().left}))+"px"});G.each({margin:"",padding:"",border:"Width"},function(t,e){G.cssHooks[t+e]={expand:function(r){for(var i=0,n={},o=typeof r=="string"?r.split(" "):[r];i<4;i++)n[t+kd[i]+e]=o[i]||o[i-2]||o[0];return n}},t!=="margin"&&(G.cssHooks[t+e].set=xL)});G.fn.extend({css:function(t,e){return Vd(this,function(r,i,n){var o,s,a={},l=0;if(Array.isArray(i)){for(o=lv(r),s=i.length;l<s;l++)a[i[l]]=G.css(r,i[l],!1,o);return a}return n!==void 0?G.style(r,i,n):G.css(r,i)},t,e,arguments.length>1)}});G.Tween=oa;oa.prototype={constructor:oa,init:function(t,e,r,i,n,o){this.elem=t,this.prop=r,this.easing=n||G.easing._default,this.options=e,this.start=this.now=this.cur(),this.end=i,this.unit=o||(G.cssNumber[r]?"":"px")},cur:function(){var t=oa.propHooks[this.prop];return t&&t.get?t.get(this):oa.propHooks._default.get(this)},run:function(t){var e,r=oa.propHooks[this.prop];return this.options.duration?this.pos=e=G.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):this.pos=e=t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),r&&r.set?r.set(this):oa.propHooks._default.set(this),this}};oa.prototype.init.prototype=oa.prototype;oa.propHooks={_default:{get:function(t){var e;return t.elem.nodeType!==1||t.elem[t.prop]!=null&&t.elem.style[t.prop]==null?t.elem[t.prop]:(e=G.css(t.elem,t.prop,""),!e||e==="auto"?0:e)},set:function(t){G.fx.step[t.prop]?G.fx.step[t.prop](t):t.elem.nodeType===1&&(G.cssHooks[t.prop]||t.elem.style[nV(t.prop)]!=null)?G.style(t.elem,t.prop,t.now+t.unit):t.elem[t.prop]=t.now}}};oa.propHooks.scrollTop=oa.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}};G.easing={linear:function(t){return t},swing:function(t){return .5-Math.cos(t*Math.PI)/2},_default:"swing"};G.fx=oa.prototype.init;G.fx.step={};fU=/^(?:toggle|show|hide)$/,yU=/queueHooks$/;G.Animation=G.extend(Kl,{tweeners:{"*":[function(t,e){var r=this.createTween(t,e);return uL(r.elem,t,_f.exec(e),r),r}]},tweener:function(t,e){gr(t)?(e=t,t=["*"]):t=t.match(_c);for(var r,i=0,n=t.length;i<n;i++)r=t[i],Kl.tweeners[r]=Kl.tweeners[r]||[],Kl.tweeners[r].unshift(e)},prefilters:[bU],prefilter:function(t,e){e?Kl.prefilters.unshift(t):Kl.prefilters.push(t)}});G.speed=function(t,e,r){var i=t&&typeof t=="object"?G.extend({},t):{complete:r||!r&&e||gr(t)&&t,duration:t,easing:r&&e||e&&!gr(e)&&e};return G.fx.off?i.duration=0:typeof i.duration!="number"&&(i.duration in G.fx.speeds?i.duration=G.fx.speeds[i.duration]:i.duration=G.fx.speeds._default),(i.queue==null||i.queue===!0)&&(i.queue="fx"),i.old=i.complete,i.complete=function(){gr(i.old)&&i.old.call(this),i.queue&&G.dequeue(this,i.queue)},i};G.fn.extend({fadeTo:function(t,e,r,i){return this.filter(av).css("opacity",0).show().end().animate({opacity:e},t,r,i)},animate:function(t,e,r,i){var n=G.isEmptyObject(t),o=G.speed(e,r,i),s=function(){var a=Kl(this,G.extend({},t),o);(n||Kt.get(this,"finish"))&&a.stop(!0)};return s.finish=s,n||o.queue===!1?this.each(s):this.queue(o.queue,s)},stop:function(t,e,r){var i=function(n){var o=n.stop;delete n.stop,o(r)};return typeof t!="string"&&(r=e,e=t,t=void 0),e&&this.queue(t||"fx",[]),this.each(function(){var n=!0,o=t!=null&&t+"queueHooks",s=G.timers,a=Kt.get(this);if(o)a[o]&&a[o].stop&&i(a[o]);else for(o in a)a[o]&&a[o].stop&&yU.test(o)&&i(a[o]);for(o=s.length;o--;)s[o].elem===this&&(t==null||s[o].queue===t)&&(s[o].anim.stop(r),n=!1,s.splice(o,1));(n||!r)&&G.dequeue(this,t)})},finish:function(t){return t!==!1&&(t=t||"fx"),this.each(function(){var e,r=Kt.get(this),i=r[t+"queue"],n=r[t+"queueHooks"],o=G.timers,s=i?i.length:0;for(r.finish=!0,G.queue(this,t,[]),n&&n.stop&&n.stop.call(this,!0),e=o.length;e--;)o[e].elem===this&&o[e].queue===t&&(o[e].anim.stop(!0),o.splice(e,1));for(e=0;e<s;e++)i[e]&&i[e].finish&&i[e].finish.call(this);delete r.finish})}});G.each(["toggle","show","hide"],function(t,e){var r=G.fn[e];G.fn[e]=function(i,n,o){return i==null||typeof i=="boolean"?r.apply(this,arguments):this.animate(ev(e,!0),i,n,o)}});G.each({slideDown:ev("show"),slideUp:ev("hide"),slideToggle:ev("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,e){G.fn[t]=function(r,i,n){return this.animate(e,r,i,n)}});G.timers=[];G.fx.tick=function(){var t,e=0,r=G.timers;for(Ju=Date.now();e<r.length;e++)t=r[e],!t()&&r[e]===t&&r.splice(e--,1);r.length||G.fx.stop(),Ju=void 0};G.fx.timer=function(t){G.timers.push(t),G.fx.start()};G.fx.interval=13;G.fx.start=function(){ov||(ov=!0,sV())};G.fx.stop=function(){ov=null};G.fx.speeds={slow:600,fast:200,_default:400};G.fn.delay=function(t,e){return t=G.fx&&G.fx.speeds[t]||t,e=e||"fx",this.queue(e,function(r,i){var n=window.setTimeout(r,t);i.stop=function(){window.clearTimeout(n)}})};(function(){var t=Rr.createElement("input"),e=Rr.createElement("select"),r=e.appendChild(Rr.createElement("option"));t.type="checkbox",Si.checkOn=t.value!=="",Si.optSelected=r.selected,t=Rr.createElement("input"),t.value="t",t.type="radio",Si.radioValue=t.value==="t"})();If=G.expr.attrHandle;G.fn.extend({attr:function(t,e){return Vd(this,G.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each(function(){G.removeAttr(this,t)})}});G.extend({attr:function(t,e,r){var i,n,o=t.nodeType;if(!(o===3||o===8||o===2)){if(typeof t.getAttribute=="undefined")return G.prop(t,e,r);if((o!==1||!G.isXMLDoc(t))&&(n=G.attrHooks[e.toLowerCase()]||(G.expr.match.bool.test(e)?CL:void 0)),r!==void 0){if(r===null){G.removeAttr(t,e);return}return n&&"set"in n&&(i=n.set(t,r,e))!==void 0?i:(t.setAttribute(e,r+""),r)}return n&&"get"in n&&(i=n.get(t,e))!==null?i:(i=G.find.attr(t,e),i==null?void 0:i)}},attrHooks:{type:{set:function(t,e){if(!Si.radioValue&&e==="radio"&&sl(t,"input")){var r=t.value;return t.setAttribute("type",e),r&&(t.value=r),e}}}},removeAttr:function(t,e){var r,i=0,n=e&&e.match(_c);if(n&&t.nodeType===1)for(;r=n[i++];)t.removeAttribute(r)}});CL={set:function(t,e,r){return e===!1?G.removeAttr(t,r):t.setAttribute(r,r),r}};G.each(G.expr.match.bool.source.match(/\w+/g),function(t,e){var r=If[e]||G.find.attr;If[e]=function(i,n,o){var s,a,l=n.toLowerCase();return o||(a=If[l],If[l]=s,s=r(i,n,o)!=null?l:null,If[l]=a),s}});xU=/^(?:input|select|textarea|button)$/i,vU=/^(?:a|area)$/i;G.fn.extend({prop:function(t,e){return Vd(this,G.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each(function(){delete this[G.propFix[t]||t]})}});G.extend({prop:function(t,e,r){var i,n,o=t.nodeType;if(!(o===3||o===8||o===2))return(o!==1||!G.isXMLDoc(t))&&(e=G.propFix[e]||e,n=G.propHooks[e]),r!==void 0?n&&"set"in n&&(i=n.set(t,r,e))!==void 0?i:t[e]=r:n&&"get"in n&&(i=n.get(t,e))!==null?i:t[e]},propHooks:{tabIndex:{get:function(t){var e=G.find.attr(t,"tabindex");return e?parseInt(e,10):xU.test(t.nodeName)||vU.test(t.nodeName)&&t.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}});Si.optSelected||(G.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null},set:function(t){var e=t.parentNode;e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex)}});G.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){G.propFix[this.toLowerCase()]=this});G.fn.extend({addClass:function(t){var e,r,i,n,o,s,a,l=0;if(gr(t))return this.each(function(c){G(this).addClass(t.call(this,c,Ip(this)))});if(e=eV(t),e.length){for(;r=this[l++];)if(n=Ip(r),i=r.nodeType===1&&" "+Mp(n)+" ",i){for(s=0;o=e[s++];)i.indexOf(" "+o+" ")<0&&(i+=o+" ");a=Mp(i),n!==a&&r.setAttribute("class",a)}}return this},removeClass:function(t){var e,r,i,n,o,s,a,l=0;if(gr(t))return this.each(function(c){G(this).removeClass(t.call(this,c,Ip(this)))});if(!arguments.length)return this.attr("class","");if(e=eV(t),e.length){for(;r=this[l++];)if(n=Ip(r),i=r.nodeType===1&&" "+Mp(n)+" ",i){for(s=0;o=e[s++];)for(;i.indexOf(" "+o+" ")>-1;)i=i.replace(" "+o+" "," ");a=Mp(i),n!==a&&r.setAttribute("class",a)}}return this},toggleClass:function(t,e){var r=typeof t,i=r==="string"||Array.isArray(t);return typeof e=="boolean"&&i?e?this.addClass(t):this.removeClass(t):gr(t)?this.each(function(n){G(this).toggleClass(t.call(this,n,Ip(this),e),e)}):this.each(function(){var n,o,s,a;if(i)for(o=0,s=G(this),a=eV(t);n=a[o++];)s.hasClass(n)?s.removeClass(n):s.addClass(n);else(t===void 0||r==="boolean")&&(n=Ip(this),n&&Kt.set(this,"__className__",n),this.setAttribute&&this.setAttribute("class",n||t===!1?"":Kt.get(this,"__className__")||""))})},hasClass:function(t){var e,r,i=0;for(e=" "+t+" ";r=this[i++];)if(r.nodeType===1&&(" "+Mp(Ip(r))+" ").indexOf(e)>-1)return!0;return!1}});CU=/\r/g;G.fn.extend({val:function(t){var e,r,i,n=this[0];return arguments.length?(i=gr(t),this.each(function(o){var s;this.nodeType===1&&(i?s=t.call(this,o,G(this).val()):s=t,s==null?s="":typeof s=="number"?s+="":Array.isArray(s)&&(s=G.map(s,function(a){return a==null?"":a+""})),e=G.valHooks[this.type]||G.valHooks[this.nodeName.toLowerCase()],(!e||!("set"in e)||e.set(this,s,"value")===void 0)&&(this.value=s))})):n?(e=G.valHooks[n.type]||G.valHooks[n.nodeName.toLowerCase()],e&&"get"in e&&(r=e.get(n,"value"))!==void 0?r:(r=n.value,typeof r=="string"?r.replace(CU,""):r==null?"":r)):void 0}});G.extend({valHooks:{option:{get:function(t){var e=G.find.attr(t,"value");return e!=null?e:Mp(G.text(t))}},select:{get:function(t){var e,r,i,n=t.options,o=t.selectedIndex,s=t.type==="select-one",a=s?null:[],l=s?o+1:n.length;for(o<0?i=l:i=s?o:0;i<l;i++)if(r=n[i],(r.selected||i===o)&&!r.disabled&&(!r.parentNode.disabled||!sl(r.parentNode,"optgroup"))){if(e=G(r).val(),s)return e;a.push(e)}return a},set:function(t,e){for(var r,i,n=t.options,o=G.makeArray(e),s=n.length;s--;)i=n[s],(i.selected=G.inArray(G.valHooks.option.get(i),o)>-1)&&(r=!0);return r||(t.selectedIndex=-1),o}}}});G.each(["radio","checkbox"],function(){G.valHooks[this]={set:function(t,e){if(Array.isArray(e))return t.checked=G.inArray(G(t).val(),e)>-1}},Si.checkOn||(G.valHooks[this].get=function(t){return t.getAttribute("value")===null?"on":t.value})});Si.focusin="onfocusin"in window;YA=/^(?:focusinfocus|focusoutblur)$/,XA=function(t){t.stopPropagation()};G.extend(G.event,{trigger:function(t,e,r,i){var n,o,s,a,l,c,d,u,p=[r||Rr],g=rv.call(t,"type")?t.type:t,b=rv.call(t,"namespace")?t.namespace.split("."):[];if(o=u=s=r=r||Rr,!(r.nodeType===3||r.nodeType===8)&&!YA.test(g+G.event.triggered)&&(g.indexOf(".")>-1&&(b=g.split("."),g=b.shift(),b.sort()),l=g.indexOf(":")<0&&"on"+g,t=t[G.expando]?t:new G.Event(g,typeof t=="object"&&t),t.isTrigger=i?2:3,t.namespace=b.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+b.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=r),e=e==null?[t]:G.makeArray(e,[t]),d=G.event.special[g]||{},!(!i&&d.trigger&&d.trigger.apply(r,e)===!1))){if(!i&&!d.noBubble&&!ju(r)){for(a=d.delegateType||g,YA.test(a+g)||(o=o.parentNode);o;o=o.parentNode)p.push(o),s=o;s===(r.ownerDocument||Rr)&&p.push(s.defaultView||s.parentWindow||window)}for(n=0;(o=p[n++])&&!t.isPropagationStopped();)u=o,t.type=n>1?a:d.bindType||g,c=(Kt.get(o,"events")||Object.create(null))[t.type]&&Kt.get(o,"handle"),c&&c.apply(o,e),c=l&&o[l],c&&c.apply&&Af(o)&&(t.result=c.apply(o,e),t.result===!1&&t.preventDefault());return t.type=g,!i&&!t.isDefaultPrevented()&&(!d._default||d._default.apply(p.pop(),e)===!1)&&Af(r)&&l&&gr(r[g])&&!ju(r)&&(s=r[l],s&&(r[l]=null),G.event.triggered=g,t.isPropagationStopped()&&u.addEventListener(g,XA),r[g](),t.isPropagationStopped()&&u.removeEventListener(g,XA),G.event.triggered=void 0,s&&(r[l]=s)),t.result}},simulate:function(t,e,r){var i=G.extend(new G.Event,r,{type:t,isSimulated:!0});G.event.trigger(i,null,e)}});G.fn.extend({trigger:function(t,e){return this.each(function(){G.event.trigger(t,e,this)})},triggerHandler:function(t,e){var r=this[0];if(r)return G.event.trigger(t,e,r,!0)}});Si.focusin||G.each({focus:"focusin",blur:"focusout"},function(t,e){var r=function(i){G.event.simulate(e,i.target,G.event.fix(i))};G.event.special[e]={setup:function(){var i=this.ownerDocument||this.document||this,n=Kt.access(i,e);n||i.addEventListener(t,r,!0),Kt.access(i,e,(n||0)+1)},teardown:function(){var i=this.ownerDocument||this.document||this,n=Kt.access(i,e)-1;n?Kt.access(i,e,n):(i.removeEventListener(t,r,!0),Kt.remove(i,e))}}});Mf=window.location,DL={guid:Date.now()},aV=/\?/;G.parseXML=function(t){var e,r;if(!t||typeof t!="string")return null;try{e=new window.DOMParser().parseFromString(t,"text/xml")}catch(i){}return r=e&&e.getElementsByTagName("parsererror")[0],(!e||r)&&G.error("Invalid XML: "+(r?G.map(r.childNodes,function(i){return i.textContent}).join(`
`):t)),e};DU=/\[\]$/,QA=/\r?\n/g,SU=/^(?:submit|button|image|reset|file)$/i,EU=/^(?:input|select|textarea|keygen)/i;G.param=function(t,e){var r,i=[],n=function(o,s){var a=gr(s)?s():s;i[i.length]=encodeURIComponent(o)+"="+encodeURIComponent(a==null?"":a)};if(t==null)return"";if(Array.isArray(t)||t.jquery&&!G.isPlainObject(t))G.each(t,function(){n(this.name,this.value)});else for(r in t)lV(r,t[r],e,n);return i.join("&")};G.fn.extend({serialize:function(){return G.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=G.prop(this,"elements");return t?G.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!G(this).is(":disabled")&&EU.test(this.nodeName)&&!SU.test(t)&&(this.checked||!Tf.test(t))}).map(function(t,e){var r=G(this).val();return r==null?null:Array.isArray(r)?G.map(r,function(i){return{name:e.name,value:i.replace(QA,`\r
`)}}):{name:e.name,value:r.replace(QA,`\r
`)}}).get()}});kU=/%20/g,GU=/#.*$/,VU=/([?&])_=[^&]*/,IU=/^(.*?):[ \t]*([^\r\n]*)$/mg,MU=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,TU=/^(?:GET|HEAD)$/,AU=/^\/\//,ZA={},cV={},eL="*/".concat("*"),dV=Rr.createElement("a");dV.href=Mf.href;G.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Mf.href,type:"GET",isLocal:MU.test(Mf.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":eL,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":G.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?tV(tV(t,G.ajaxSettings),e):tV(G.ajaxSettings,t)},ajaxPrefilter:tL(ZA),ajaxTransport:tL(cV),ajax:function(t,e){typeof t=="object"&&(e=t,t=void 0),e=e||{};var r,i,n,o,s,a,l,c,d,u,p=G.ajaxSetup({},e),g=p.context||p,b=p.context&&(g.nodeType||g.jquery)?G(g):G.event,x=G.Deferred(),w=G.Callbacks("once memory"),E=p.statusCode||{},k={},S={},T="canceled",V={readyState:0,getResponseHeader:function(y){var L;if(l){if(!o)for(o={};L=IU.exec(n);)o[L[1].toLowerCase()+" "]=(o[L[1].toLowerCase()+" "]||[]).concat(L[2]);L=o[y.toLowerCase()+" "]}return L==null?null:L.join(", ")},getAllResponseHeaders:function(){return l?n:null},setRequestHeader:function(y,L){return l==null&&(y=S[y.toLowerCase()]=S[y.toLowerCase()]||y,k[y]=L),this},overrideMimeType:function(y){return l==null&&(p.mimeType=y),this},statusCode:function(y){var L;if(y)if(l)V.always(y[V.status]);else for(L in y)E[L]=[E[L],y[L]];return this},abort:function(y){var L=y||T;return r&&r.abort(L),O(0,L),this}};if(x.promise(V),p.url=((t||p.url||Mf.href)+"").replace(AU,Mf.protocol+"//"),p.type=e.method||e.type||p.method||p.type,p.dataTypes=(p.dataType||"*").toLowerCase().match(_c)||[""],p.crossDomain==null){a=Rr.createElement("a");try{a.href=p.url,a.href=a.href,p.crossDomain=dV.protocol+"//"+dV.host!=a.protocol+"//"+a.host}catch(y){p.crossDomain=!0}}if(p.data&&p.processData&&typeof p.data!="string"&&(p.data=G.param(p.data,p.traditional)),rL(ZA,p,e,V),l)return V;c=G.event&&p.global,c&&G.active++===0&&G.event.trigger("ajaxStart"),p.type=p.type.toUpperCase(),p.hasContent=!TU.test(p.type),i=p.url.replace(GU,""),p.hasContent?p.data&&p.processData&&(p.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&(p.data=p.data.replace(kU,"+")):(u=p.url.slice(i.length),p.data&&(p.processData||typeof p.data=="string")&&(i+=(aV.test(i)?"&":"?")+p.data,delete p.data),p.cache===!1&&(i=i.replace(VU,"$1"),u=(aV.test(i)?"&":"?")+"_="+DL.guid+++u),p.url=i+u),p.ifModified&&(G.lastModified[i]&&V.setRequestHeader("If-Modified-Since",G.lastModified[i]),G.etag[i]&&V.setRequestHeader("If-None-Match",G.etag[i])),(p.data&&p.hasContent&&p.contentType!==!1||e.contentType)&&V.setRequestHeader("Content-Type",p.contentType),V.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+(p.dataTypes[0]!=="*"?", "+eL+"; q=0.01":""):p.accepts["*"]);for(d in p.headers)V.setRequestHeader(d,p.headers[d]);if(p.beforeSend&&(p.beforeSend.call(g,V,p)===!1||l))return V.abort();if(T="abort",w.add(p.complete),V.done(p.success),V.fail(p.error),r=rL(cV,p,e,V),!r)O(-1,"No Transport");else{if(V.readyState=1,c&&b.trigger("ajaxSend",[V,p]),l)return V;p.async&&p.timeout>0&&(s=window.setTimeout(function(){V.abort("timeout")},p.timeout));try{l=!1,r.send(k,O)}catch(y){if(l)throw y;O(-1,y)}}function O(y,L,P,K){var $,U,J,R,q,_=L;l||(l=!0,s&&window.clearTimeout(s),r=void 0,n=K||"",V.readyState=y>0?4:0,$=y>=200&&y<300||y===304,P&&(R=LU(p,V,P)),!$&&G.inArray("script",p.dataTypes)>-1&&G.inArray("json",p.dataTypes)<0&&(p.converters["text script"]=function(){}),R=PU(p,R,V,$),$?(p.ifModified&&(q=V.getResponseHeader("Last-Modified"),q&&(G.lastModified[i]=q),q=V.getResponseHeader("etag"),q&&(G.etag[i]=q)),y===204||p.type==="HEAD"?_="nocontent":y===304?_="notmodified":(_=R.state,U=R.data,J=R.error,$=!J)):(J=_,(y||!_)&&(_="error",y<0&&(y=0))),V.status=y,V.statusText=(L||_)+"",$?x.resolveWith(g,[U,_,V]):x.rejectWith(g,[V,_,J]),V.statusCode(E),E=void 0,c&&b.trigger($?"ajaxSuccess":"ajaxError",[V,p,$?U:J]),w.fireWith(g,[V,_]),c&&(b.trigger("ajaxComplete",[V,p]),--G.active||G.event.trigger("ajaxStop")))}return V},getJSON:function(t,e,r){return G.get(t,e,r,"json")},getScript:function(t,e){return G.get(t,void 0,e,"script")}});G.each(["get","post"],function(t,e){G[e]=function(r,i,n,o){return gr(i)&&(o=o||n,n=i,i=void 0),G.ajax(G.extend({url:r,type:e,dataType:o,data:i,success:n},G.isPlainObject(r)&&r))}});G.ajaxPrefilter(function(t){var e;for(e in t.headers)e.toLowerCase()==="content-type"&&(t.contentType=t.headers[e]||"")});G._evalUrl=function(t,e,r){return G.ajax({url:t,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(i){G.globalEval(i,e,r)}})};G.fn.extend({wrapAll:function(t){var e;return this[0]&&(gr(t)&&(t=t.call(this[0])),e=G(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var r=this;r.firstElementChild;)r=r.firstElementChild;return r}).append(this)),this},wrapInner:function(t){return gr(t)?this.each(function(e){G(this).wrapInner(t.call(this,e))}):this.each(function(){var e=G(this),r=e.contents();r.length?r.wrapAll(t):e.append(t)})},wrap:function(t){var e=gr(t);return this.each(function(r){G(this).wrapAll(e?t.call(this,r):t)})},unwrap:function(t){return this.parent(t).not("body").each(function(){G(this).replaceWith(this.childNodes)}),this}});G.expr.pseudos.hidden=function(t){return!G.expr.pseudos.visible(t)};G.expr.pseudos.visible=function(t){return!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length)};G.ajaxSettings.xhr=function(){try{return new window.XMLHttpRequest}catch(t){}};OU={0:200,1223:204},Pf=G.ajaxSettings.xhr();Si.cors=!!Pf&&"withCredentials"in Pf;Si.ajax=Pf=!!Pf;G.ajaxTransport(function(t){var e,r;if(Si.cors||Pf&&!t.crossDomain)return{send:function(i,n){var o,s=t.xhr();if(s.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(o in t.xhrFields)s[o]=t.xhrFields[o];t.mimeType&&s.overrideMimeType&&s.overrideMimeType(t.mimeType),!t.crossDomain&&!i["X-Requested-With"]&&(i["X-Requested-With"]="XMLHttpRequest");for(o in i)s.setRequestHeader(o,i[o]);e=function(a){return function(){e&&(e=r=s.onload=s.onerror=s.onabort=s.ontimeout=s.onreadystatechange=null,a==="abort"?s.abort():a==="error"?typeof s.status!="number"?n(0,"error"):n(s.status,s.statusText):n(OU[s.status]||s.status,s.statusText,(s.responseType||"text")!=="text"||typeof s.responseText!="string"?{binary:s.response}:{text:s.responseText},s.getAllResponseHeaders()))}},s.onload=e(),r=s.onerror=s.ontimeout=e("error"),s.onabort!==void 0?s.onabort=r:s.onreadystatechange=function(){s.readyState===4&&window.setTimeout(function(){e&&r()})},e=e("abort");try{s.send(t.hasContent&&t.data||null)}catch(a){if(e)throw a}},abort:function(){e&&e()}}});G.ajaxPrefilter(function(t){t.crossDomain&&(t.contents.script=!1)});G.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(t){return G.globalEval(t),t}}});G.ajaxPrefilter("script",function(t){t.cache===void 0&&(t.cache=!1),t.crossDomain&&(t.type="GET")});G.ajaxTransport("script",function(t){if(t.crossDomain||t.scriptAttrs){var e,r;return{send:function(i,n){e=G("<script>").attr(t.scriptAttrs||{}).prop({charset:t.scriptCharset,src:t.url}).on("load error",r=function(o){e.remove(),r=null,o&&n(o.type==="error"?404:200,o.type)}),Rr.head.appendChild(e[0])},abort:function(){r&&r()}}}});SL=[],rV=/(=)\?(?=&|$)|\?\?/;G.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=SL.pop()||G.expando+"_"+DL.guid++;return this[t]=!0,t}});G.ajaxPrefilter("json jsonp",function(t,e,r){var i,n,o,s=t.jsonp!==!1&&(rV.test(t.url)?"url":typeof t.data=="string"&&(t.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&rV.test(t.data)&&"data");if(s||t.dataTypes[0]==="jsonp")return i=t.jsonpCallback=gr(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,s?t[s]=t[s].replace(rV,"$1"+i):t.jsonp!==!1&&(t.url+=(aV.test(t.url)?"&":"?")+t.jsonp+"="+i),t.converters["script json"]=function(){return o||G.error(i+" was not called"),o[0]},t.dataTypes[0]="json",n=window[i],window[i]=function(){o=arguments},r.always(function(){n===void 0?G(window).removeProp(i):window[i]=n,t[i]&&(t.jsonpCallback=e.jsonpCallback,SL.push(i)),o&&gr(n)&&n(o[0]),o=n=void 0}),"script"});Si.createHTMLDocument=function(){var t=Rr.implementation.createHTMLDocument("").body;return t.innerHTML="<form></form><form></form>",t.childNodes.length===2}();G.parseHTML=function(t,e,r){if(typeof t!="string")return[];typeof e=="boolean"&&(r=e,e=!1);var i,n,o;return e||(Si.createHTMLDocument?(e=Rr.implementation.createHTMLDocument(""),i=e.createElement("base"),i.href=Rr.location.href,e.head.appendChild(i)):e=Rr),n=dL.exec(t),o=!r&&[],n?[e.createElement(n[1])]:(n=fL([t],e,o),o&&o.length&&G(o).remove(),G.merge([],n.childNodes))};G.fn.load=function(t,e,r){var i,n,o,s=this,a=t.indexOf(" ");return a>-1&&(i=Mp(t.slice(a)),t=t.slice(0,a)),gr(e)?(r=e,e=void 0):e&&typeof e=="object"&&(n="POST"),s.length>0&&G.ajax({url:t,type:n||"GET",dataType:"html",data:e}).done(function(l){o=arguments,s.html(i?G("<div>").append(G.parseHTML(l)).find(i):l)}).always(r&&function(l,c){s.each(function(){r.apply(this,o||[l.responseText,c,l])})}),this};G.expr.pseudos.animated=function(t){return G.grep(G.timers,function(e){return t===e.elem}).length};G.offset={setOffset:function(t,e,r){var i,n,o,s,a,l,c,d=G.css(t,"position"),u=G(t),p={};d==="static"&&(t.style.position="relative"),a=u.offset(),o=G.css(t,"top"),l=G.css(t,"left"),c=(d==="absolute"||d==="fixed")&&(o+l).indexOf("auto")>-1,c?(i=u.position(),s=i.top,n=i.left):(s=parseFloat(o)||0,n=parseFloat(l)||0),gr(e)&&(e=e.call(t,r,G.extend({},a))),e.top!=null&&(p.top=e.top-a.top+s),e.left!=null&&(p.left=e.left-a.left+n),"using"in e?e.using.call(t,p):u.css(p)}};G.fn.extend({offset:function(t){if(arguments.length)return t===void 0?this:this.each(function(n){G.offset.setOffset(this,t,n)});var e,r,i=this[0];if(i)return i.getClientRects().length?(e=i.getBoundingClientRect(),r=i.ownerDocument.defaultView,{top:e.top+r.pageYOffset,left:e.left+r.pageXOffset}):{top:0,left:0}},position:function(){if(this[0]){var t,e,r,i=this[0],n={top:0,left:0};if(G.css(i,"position")==="fixed")e=i.getBoundingClientRect();else{for(e=this.offset(),r=i.ownerDocument,t=i.offsetParent||r.documentElement;t&&(t===r.body||t===r.documentElement)&&G.css(t,"position")==="static";)t=t.parentNode;t&&t!==i&&t.nodeType===1&&(n=G(t).offset(),n.top+=G.css(t,"borderTopWidth",!0),n.left+=G.css(t,"borderLeftWidth",!0))}return{top:e.top-n.top-G.css(i,"marginTop",!0),left:e.left-n.left-G.css(i,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent;t&&G.css(t,"position")==="static";)t=t.offsetParent;return t||Tp})}});G.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,e){var r=e==="pageYOffset";G.fn[t]=function(i){return Vd(this,function(n,o,s){var a;if(ju(n)?a=n:n.nodeType===9&&(a=n.defaultView),s===void 0)return a?a[e]:n[o];a?a.scrollTo(r?a.pageXOffset:s,r?s:a.pageYOffset):n[o]=s},t,i,arguments.length)}});G.each(["top","left"],function(t,e){G.cssHooks[e]=bL(Si.pixelPosition,function(r,i){if(i)return i=Lf(r,e),gV.test(i)?G(r).position()[e]+"px":i})});G.each({Height:"height",Width:"width"},function(t,e){G.each({padding:"inner"+t,content:e,"":"outer"+t},function(r,i){G.fn[i]=function(n,o){var s=arguments.length&&(r||typeof n!="boolean"),a=r||(n===!0||o===!0?"margin":"border");return Vd(this,function(l,c,d){var u;return ju(l)?i.indexOf("outer")===0?l["inner"+t]:l.document.documentElement["client"+t]:l.nodeType===9?(u=l.documentElement,Math.max(l.body["scroll"+t],u["scroll"+t],l.body["offset"+t],u["offset"+t],u["client"+t])):d===void 0?G.css(l,c,a):G.style(l,c,d,a)},e,s?n:void 0,s)}})});G.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){G.fn[e]=function(r){return this.on(e,r)}});G.fn.extend({bind:function(t,e,r){return this.on(t,null,e,r)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,r,i){return this.on(e,t,r,i)},undelegate:function(t,e,r){return arguments.length===1?this.off(t,"**"):this.off(e,t||"**",r)},hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)}});G.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(t,e){G.fn[e]=function(r,i){return arguments.length>0?this.on(e,null,r,i):this.trigger(e)}});_U=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;G.proxy=function(t,e){var r,i,n;if(typeof e=="string"&&(r=t[e],e=t,t=r),!!gr(t))return i=Eh.call(arguments,2),n=function(){return t.apply(e||this,i.concat(Eh.call(arguments)))},n.guid=t.guid=t.guid||G.guid++,n};G.holdReady=function(t){t?G.readyWait++:G.ready(!0)};G.isArray=Array.isArray;G.parseJSON=JSON.parse;G.nodeName=sl;G.isFunction=gr;G.isWindow=ju;G.camelCase=Oc;G.type=Yu;G.now=Date.now;G.isNumeric=function(t){var e=G.type(t);return(e==="number"||e==="string")&&!isNaN(t-parseFloat(t))};G.trim=function(t){return t==null?"":(t+"").replace(_U,"")};FU=window.jQuery,RU=window.$;G.noConflict=function(t){return window.$===G&&(window.$=RU),t&&window.jQuery===G&&(window.jQuery=FU),G};typeof noGlobal=="undefined"&&(window.jQuery=window.$=G);I=G});var oo,ql=__dcg_shared_module_exports__['f'](()=>{oo=()=>{let t="";try{t=location.search,t[0]=="?"&&(t=t.slice(1))}catch(i){}let e=t.split("&"),r={};for(let i of e){let n=i.split("=");n.length==2?r[n[0]]=decodeURIComponent(n[1]):r[n[0]]=!0}return r}});var pP=__dcg_shared_module_exports__['g'](Wf=>{var pt=Wf&&Wf.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(i[o]=n[o])},t(e,r)};return function(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");t(e,r);function i(){this.constructor=e}e.prototype=r===null?Object.create(r):(i.prototype=r.prototype,new i)}}(),xv=Wf&&Wf.__assign||function(){return xv=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++){e=arguments[r];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},xv.apply(this,arguments)};(function(){var t=-1,e=1,r=Math.min,i=Math.max;function n(){}function o(D,f){if(!f)throw new Error("prayer failed: "+D)}function s(D){o("a direction was passed",D===t||D===e)}var a=new URLSearchParams(window.location.search);function l(D){var f=document.implementation.createHTMLDocument("");if(f.body.innerHTML=D,f.body.children.length===1)return f.body.children[0];for(var h=document.createDocumentFragment();f.body.firstChild;)h.appendChild(f.body.firstChild);return h}var c=function(f,h,m){var v;switch(f){case"svg":case"path":v=document.createElementNS("http://www.w3.org/2000/svg",f);break;default:v=document.createElement(f)}for(var M in h){var B=h[M];B!==void 0&&v.setAttribute(M,typeof B=="string"?B:String(B))}if(m)for(var j=0;j<m.length;j++)v.appendChild(m[j]);return v};c.text=function(D){return document.createTextNode(D)},c.block=function(D,f,h){var m=c(D,f,[h.html()]);return h.setDOM(m),R.linkElementByBlockNode(m,h),m},c.entityText=function(D){var f=l(D);return o("entity parses to a single text node",f instanceof DocumentFragment&&f.childNodes.length===1&&f.childNodes[0]instanceof Text),f.childNodes[0]};function d(D,f){var h,m,v;if(typeof((h=D)===null||h===void 0?void 0:h.closest)=="function")return D.closest(f);if(!(D instanceof HTMLElement))return null;var M=Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,B=D;do{if(M.call(B,f))return B;B=(v=(m=B==null?void 0:B.parentElement)!==null&&m!==void 0?m:B==null?void 0:B.parentNode)!==null&&v!==void 0?v:null}while(B!==null&&B.nodeType===1);return null}var u="\xA0",p="\u200B",g="\u02D9",b="\u2211",x="\u220F",w="\u2210",E="\u222B";function k(D){return D.getClientRects().length?D.getBoundingClientRect():{top:0,left:0,height:0,width:0,x:0,y:0,bottom:0,right:0}}function S(){return window.pageXOffset!==void 0?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft}function T(){return window.pageYOffset!==void 0?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop}var V=function(){var D,f;return typeof requestAnimationFrame=="function"&&typeof cancelAnimationFrame=="function"?(D=requestAnimationFrame,f=cancelAnimationFrame):(D=function(h){return setTimeout(h,13)},f=clearTimeout),function(h,m){var v=Date.now(),M,B=0;function j(){var Ue=(Date.now()-v)/h;Ue<=B?ce():B=Ue,m(B,ce,ee)}function ee(){M!==void 0&&f(M),M=void 0}function ce(){ee(),M=D(j)}m(h<=0?1:0,ce,ee)}}(),O=function(){function D(f){this.span=c("span",{class:"dcg-mq-aria-alert","aria-live":"assertive","aria-atomic":"true"}),this.msg="",this.items=[],this.controller=f}return D.prototype.attach=function(){var f=this.controller.container;this.span.parentNode!==f&&L(f).prepend(L(this.span))},D.prototype.queue=function(f,h){h===void 0&&(h=!1);var m="";if(f instanceof le){var v=f.mathspeak({ignoreShorthand:!0});h&&(f.parent&&f.parent.ariaLabel&&f.ariaLabel==="block"?m=f.parent.ariaLabel+" "+v:f.ariaLabel&&(m=f.ariaLabel+" "+v)),m===""&&(m=v)}else m=f||"";return this.items.push(m),this},D.prototype.queueDirOf=function(f){return s(f),this.queue(f===t?"before":"after")},D.prototype.queueDirEndOf=function(f){return s(f),this.queue(f===t?"beginning of":"end of")},D.prototype.alert=function(f){return this.attach(),f&&this.queue(f),this.items.length&&(this.msg=this.items.join(" ").replace(/ +(?= )/g,"").trim(),this.controller.containerHasFocus()&&(this.controller.options.logAriaAlerts&&this.msg&&console.log(this.msg),this.span.textContent=this.msg)),this.clear()},D.prototype.clear=function(){return this.items.length=0,this},D}(),y=function(){function D(f,h){var m;arguments.length===1&&(h=f),!(!f||!h)&&(this.ends=(m={},m[t]=f,m[e]=h,m))}return D.create=function(f,h){arguments.length===1&&(h=f),o("No half-empty DOMFragments",!!f==!!h);var m=new D(f,h);return o("last is a forward sibling of first",m.isValid()),m},D.prototype.isEmpty=function(){return this.ends===void 0},D.prototype.isOneNode=function(){return!!(this.ends&&this.ends[t]===this.ends[e])},D.prototype.isValid=function(){if(!this.ends||this.ends[t]===this.ends[e])return!0;var f;return this.eachNode(function(h){return f=h}),f===this.ends[e]},D.prototype.firstNode=function(){return o("Fragment is not empty",this.ends),this.ends[t]},D.prototype.lastNode=function(){return o("Fragment is not empty",this.ends),this.ends[e]},D.prototype.children=function(){var f=this.oneNode(),h=f.firstChild,m=f.lastChild;return h&&m?new D(h,m):new D},D.prototype.join=function(f){if(!this.ends)return f;if(!f.ends)return this;for(var h=!1,m=this.ends[e].nextSibling;m;){if(m===f.ends[t]){h=!0;break}m=m.nextSibling}return o("sibling must be a forward DOM sibling of this fragment",h),new D(this.ends[t],f.ends[e])},D.prototype.oneNode=function(){return o("Fragment has a single node",this.ends&&this.ends[t]===this.ends[e]),this.ends[t]},D.prototype.oneElement=function(){var f=this.oneNode();return o("Node is an Element",f.nodeType===Node.ELEMENT_NODE),f},D.prototype.oneText=function(){var f=this.oneNode();return o("Node is Text",f.nodeType===Node.TEXT_NODE),f},D.prototype.eachNode=function(f){if(!this.ends)return this;for(var h=this.ends[e],m=this.ends[t],v=void 0;m&&(v=m.nextSibling,f(m),m!==h);m=v);return this},D.prototype.eachElement=function(f){return this.eachNode(function(h){h.nodeType===Node.ELEMENT_NODE&&f(h)}),this},D.prototype.text=function(){var f="";return this.eachNode(function(h){f+=h.textContent||""}),f},D.prototype.toNodeArray=function(){var f=[];return this.eachNode(function(h){return f.push(h)}),f},D.prototype.toElementArray=function(){var f=[];return this.eachElement(function(h){return f.push(h)}),f},D.prototype.toDocumentFragment=function(){var f=document.createDocumentFragment();return this.eachNode(function(h){return f.appendChild(h)}),f},D.prototype.insertBefore=function(f){return this.insDirOf(t,f)},D.prototype.insertAfter=function(f){return this.insDirOf(e,f)},D.prototype.append=function(f){return f.appendTo(this.oneElement()),this},D.prototype.prepend=function(f){return f.prependTo(this.oneElement()),this},D.prototype.appendTo=function(f){return this.insAtDirEnd(e,f)},D.prototype.prependTo=function(f){return this.insAtDirEnd(t,f)},D.prototype.parent=function(){if(!this.ends)return this;var f=this.ends[t].parentNode;return f?new D(f):new D},D.prototype.wrapAll=function(f){if(f.textContent="",!this.ends)return this;var h=this.ends[t].parentNode,m=this.ends[e].nextSibling;return this.appendTo(f),h&&h.insertBefore(f,m),this},D.prototype.replaceWith=function(f){var h,m=(h=this.ends)===null||h===void 0?void 0:h[e],v=m==null?void 0:m.parentNode,M=m==null?void 0:m.nextSibling;this.detach();var B=f.toDocumentFragment();return!m||!v?this:(v.insertBefore(B,M||null),this)},D.prototype.nthElement=function(f){if(this.ends&&!(f<0||f!==Math.floor(f)))for(var h=this.ends[t];h;){if(h.nodeType===Node.ELEMENT_NODE){if(f<=0)return h;f-=1}if(h===this.ends[e])return;h=h.nextSibling}},D.prototype.firstElement=function(){return this.nthElement(0)},D.prototype.lastElement=function(){if(this.ends)for(var f=this.ends[e];f;){if(f.nodeType===Node.ELEMENT_NODE)return f;if(f===this.ends[t])return;f=f.previousSibling}},D.prototype.first=function(){return new D(this.firstElement())},D.prototype.last=function(){return new D(this.lastElement())},D.prototype.eq=function(f){return new D(this.nthElement(f))},D.prototype.slice=function(f){if(!this.ends)return this;var h=this.nthElement(f);return h?new D(h,this.ends[e]):new D},D.prototype.next=function(){for(var f=this.oneNode();f;)if(f=f.nextSibling,f&&f.nodeType===Node.ELEMENT_NODE)return new D(f);return new D},D.prototype.prev=function(){for(var f=this.oneNode();f;)if(f=f.previousSibling,f&&f.nodeType===Node.ELEMENT_NODE)return new D(f);return new D},D.prototype.empty=function(){return this.eachElement(function(f){f.textContent=""}),this},D.prototype.remove=function(){return this.toDocumentFragment(),this},D.prototype.detach=function(){return this.remove()},D.prototype.insDirOf=function(f,h){var m;if(!this.ends)return this;var v=(m=h.ends)===null||m===void 0?void 0:m[f];return!v||!v.parentNode?this.detach():(P(f,v.parentNode,this.toDocumentFragment(),v),this)},D.prototype.insAtDirEnd=function(f,h){return this.ends?(K(f,this.toDocumentFragment(),h),this):this},D.prototype.hasClass=function(f){var h=!1;return this.eachElement(function(m){m.classList.contains(f)&&(h=!0)}),h},D.prototype.addClass=function(f){for(var h=function(j){if(!j)return"continue";m.eachElement(function(ee){ee.classList.add(j)})},m=this,v=0,M=f.split(/\s+/);v<M.length;v++){var B=M[v];h(B)}return this},D.prototype.removeClass=function(f){for(var h=function(j){if(!j)return"continue";m.eachElement(function(ee){ee.classList.remove(j)})},m=this,v=0,M=f.split(/\s+/);v<M.length;v++){var B=M[v];h(B)}return this},D.prototype.toggleClass=function(f,h){if(h===!0)return this.addClass(f);if(h===!1)return this.removeClass(f);for(var m=function(ee){if(!ee)return"continue";v.eachElement(function(ce){ce.classList.toggle(ee)})},v=this,M=0,B=f.split(/\s+/);M<B.length;M++){var j=B[M];m(j)}return this},D}(),L=y.create;function P(D,f,h,m){f.insertBefore(h,D===t?m:m.nextSibling)}function K(D,f,h){D===t?h.insertBefore(f,h.firstChild):h.appendChild(f)}var $=function(){function D(f,h,m){this.init(f,h,m)}return D.prototype.init=function(f,h,m){this.parent=f,this[t]=h,this[e]=m},D.copy=function(f){return new D(f.parent,f[t],f[e])},D}();function U(D,f){var h=D[t];if(h){var m=D[e];if(m)for(m=m[e];h!==m;h=h[e]){var v=f(h);if(v===!1)break}}}function J(D,f,h){var m=D[t];if(!m)return f;var v=D[e];if(!v)return f;for(v=v[e];m!==v;m=m[e])f=h(f,m);return f}var R=function(){function D(){var m;this[f]=0,this[h]=0,this.parent=0,this.ends=(m={},m[t]=0,m[e]=0,m),this.id=D.uniqueNodeId()}D.uniqueNodeId=function(){return D.idCounter+=1},D.getNodeOfElement=function(m){if(m){if(!m.nodeType)throw new Error("must pass an Element to NodeBase.getNodeOfElement");var v=m;return v.mqBlockNode||v.mqCmdNode}},D.linkElementByBlockNode=function(m,v){m.mqBlockNode=v},D.linkElementByCmdNode=function(m,v){m.mqCmdNode=v},D.prototype.setEnds=function(m){this.ends=m,o("No half-empty node ends",!!this.ends[t]==!!this.ends[e])},D.prototype.getEnd=function(m){return this.ends[m]},D.prototype.toString=function(){return"{{ MathQuill Node #"+this.id+" }}"},D.prototype.setDOM=function(m){return m&&o("DOM is an element or a text node",m.nodeType===Node.ELEMENT_NODE||m.nodeType===Node.TEXT_NODE),this._el=m,this},D.prototype.domFrag=function(){return L(this._el)},D.prototype.createDir=function(m,v){s(m);var M=this;return M.html(),M.domFrag().insDirOf(m,v.domFrag()),v[m]=M.adopt(v.parent,v[t],v[e]),M},D.prototype.createLeftOf=function(m){this.createDir(t,m)},D.prototype.selectChildren=function(m,v){return new Le(m,v)},D.prototype.bubble=function(m){for(var v=this.getSelfNode(),M=v;M;M=M.parent){var B=m(M);if(B===!1)break}return this},D.prototype.postOrder=function(m){var v=this.getSelfNode();return function M(B){return B?(B.eachChild(M),m(B),!0):!1}(v),v},D.prototype.isEmpty=function(){return this.ends[t]===0&&this.ends[e]===0},D.prototype.isQuietEmptyDelimiter=function(m){if(!this.isEmpty()||!m||!this.parent||this.parent.ctrlSeq===void 0)return!1;var v=this.parent.ctrlSeq.replace(/^\\(left|right)?/,"");return m.hasOwnProperty(v)},D.prototype.isStyleBlock=function(){return!1},D.prototype.isTextBlock=function(){return!1},D.prototype.children=function(){return new _(this.getEnd(t),this.getEnd(e))},D.prototype.eachChild=function(m){return U(this.ends,m),this},D.prototype.foldChildren=function(m,v){return J(this.ends,m,v)},D.prototype.withDirAdopt=function(m,v,M,B){var j=this.getSelfNode();return new _(j,j).withDirAdopt(m,v,M,B),this},D.prototype.adopt=function(m,v,M){var B=this.getSelfNode();return new _(B,B).adopt(m,v,M),this.getSelfNode()},D.prototype.disown=function(){var m=this.getSelfNode();return new _(m,m).disown(),this},D.prototype.remove=function(){return this.domFrag().remove(),this.disown()},D.prototype.shouldIgnoreSubstitutionInSimpleSubscript=function(m){return!(!m.disableAutoSubstitutionInSubscripts||!this.parent||!(this.parent.parent instanceof Ol)||!this.parent.domFrag().hasClass("dcg-mq-sub"))},D.prototype.getSelfNode=function(){return this},D.prototype.parser=function(){o("Abstract parser() method is never called",!1)},D.prototype.html=function(){throw new Error("html() unimplemented in NodeBase")},D.prototype.text=function(){return""},D.prototype.latex=function(){var m={latex:"",startIndex:-1,endIndex:-1};return this.latexRecursive(m),m.latex},D.prototype.latexRecursive=function(m){},D.prototype.checkCursorContextOpen=function(m){m.startSelectionBefore===this&&(m.startIndex=m.latex.length),m.endSelectionBefore===this&&(m.endIndex=m.latex.length)},D.prototype.checkCursorContextClose=function(m){m.startSelectionAfter===this&&(m.startIndex=m.latex.length),m.endSelectionAfter===this&&(m.endIndex=m.latex.length)},D.prototype.finalizeTree=function(m,v){},D.prototype.contactWeld=function(m,v){},D.prototype.blur=function(m){},D.prototype.focus=function(){},D.prototype.intentionalBlur=function(){},D.prototype.reflow=function(){},D.prototype.registerInnerField=function(m,v){},D.prototype.chToCmd=function(m,v){o("Abstract chToCmd() method is never called",!1)},D.prototype.mathspeak=function(m){return""},D.prototype.seek=function(m,v){},D.prototype.siblingDeleted=function(m,v){},D.prototype.siblingCreated=function(m,v){},D.prototype.finalizeInsert=function(m,v){},D.prototype.fixDigitGrouping=function(m){},D.prototype.writeLatex=function(m,v){},D.prototype.write=function(m,v){};var f,h;return f=t,h=e,D.idCounter=0,D}();function q(D,f,h){o("a parent is always present",D),o("leftward is properly set up",function(){return f?f[e]===h&&f.parent===D:D.getEnd(t)===h}()),o("rightward is properly set up",function(){return h?h[t]===f&&h.parent===D:D.getEnd(e)===f}())}var _=function(){function D(f,h,m){var v,M;if(this.disowned=!1,m===void 0&&(m=t),s(m),o("no half-empty fragments",!f==!h),!f||!h){this.setEnds((v={},v[t]=0,v[e]=0,v));return}o("withDir is passed to Fragment",f instanceof le),o("oppDir is passed to Fragment",h instanceof le),o("withDir and oppDir have the same parent",f.parent===h.parent);var B=(M={},M[m]=f,M[-m]=h,M);this.setEnds(B);var j=0;this.each(function(ee){j=ee}),o("following direction siblings from start reaches end",j===B[e])}return D.prototype.getDOMFragFromEnds=function(){var f=this.ends[t],h=this.ends[e];return f===0||h===0?L():f===h?f.domFrag():f.domFrag().join(h.domFrag())},D.prototype.setEnds=function(f){this.ends=f},D.prototype.getEnd=function(f){return this.ends?this.ends[f]:0},D.prototype.domFrag=function(){return this.getDOMFragFromEnds()},D.prototype.withDirAdopt=function(f,h,m,v){return f===t?this.adopt(h,m,v):this.adopt(h,v,m)},D.prototype.adopt=function(f,h,m){var v;q(f,h,m);var M=this;this.disowned=!1;var B=M.ends[t];if(!B)return this;var j=M.ends[e];if(!j)return this;var ee=(v={},v[t]=f.getEnd(t),v[e]=f.getEnd(e),v);return h||(ee[t]=B),m?m[t]=j:ee[e]=j,f.setEnds(ee),j[e]=m,M.each(function(ce){return ce[t]=h,ce.parent=f,h&&(h[e]=ce),h=ce,!0}),M},D.prototype.disown=function(){var f,h=this,m=h.ends[t];if(!m||h.disowned)return h;this.disowned=!0;var v=h.ends[e];if(!v)return h;var M=m.parent;q(M,m[t],m),q(M,v,v[e]);var B=(f={},f[t]=M.getEnd(t),f[e]=M.getEnd(e),f);if(m[t]){var j=m[t];j[e]=v[e]}else B[t]=v[e];if(v[e]){var ee=v[e];ee[t]=m[t]}else B[e]=m[t];return B[t]&&B[e]?M.setEnds(B):M.ends=B,h},D.prototype.remove=function(){return this.domFrag().remove(),this.disown()},D.prototype.each=function(f){return U(this.ends,f),this},D.prototype.fold=function(f,h){return J(this.ends,f,h)},D}(),A={},z={};function Q(D){return D&&D.prototype instanceof le}var fe=function(D){pt(f,D);function f(h,m,v){var M=D.call(this,h,m,v)||this;return M.ancestors={},M}return f.fromCursor=function(h){return new f(h.parent,h[t],h[e])},f}($),ie=function(D){pt(f,D);function f(h,m,v){var M=D.call(this,h,0,0)||this;return M.upDownCache={},M.cursorElement=c("span",{class:"dcg-mq-cursor"},[c.text(p)]),M._domFrag=L(),M.controller=v,M.options=m,M.setDOMFrag(L(M.cursorElement)),M.blink=function(){L(M.cursorElement).toggleClass("dcg-mq-blink")},M}return f.prototype.setDOMFrag=function(h){return this._domFrag=h,this},f.prototype.domFrag=function(){return this._domFrag},f.prototype.show=function(){if(L(this.cursorElement).removeClass("dcg-mq-blink"),this.setDOMFrag(L(this.cursorElement)),this.intervalId)clearInterval(this.intervalId);else{var h=this[e];if(h){var m=this.selection;m&&m.getEnd(t)[t]===this[t]?this.domFrag().insertBefore(m.domFrag()):this.domFrag().insertBefore(h.domFrag())}else this.domFrag().appendTo(this.parent.domFrag().oneElement());this.parent.focus()}return this.intervalId=setInterval(this.blink,500),this},f.prototype.hide=function(){return this.intervalId&&clearInterval(this.intervalId),this.intervalId=0,this.domFrag().detach(),this.setDOMFrag(L()),this},f.prototype.withDirInsertAt=function(h,m,v,M){var B=this.parent;this.parent=m,this[h]=v,this[-h]=M,B!==m&&B.blur&&B.blur(this)},f.prototype.insDirOf=function(h,m){return s(h),this.domFrag().insDirOf(h,m.domFrag()),this.withDirInsertAt(h,m.parent,m[h],m),this.parent.domFrag().addClass("dcg-mq-hasCursor"),this},f.prototype.insLeftOf=function(h){return this.insDirOf(t,h)},f.prototype.insRightOf=function(h){return this.insDirOf(e,h)},f.prototype.insAtDirEnd=function(h,m){return s(h),this.domFrag().insAtDirEnd(h,m.domFrag().oneElement()),this.withDirInsertAt(h,m,0,m.getEnd(h)),m.focus(),this},f.prototype.insAtLeftEnd=function(h){return this.insAtDirEnd(t,h)},f.prototype.insAtRightEnd=function(h){return this.insAtDirEnd(e,h)},f.prototype.jumpUpDown=function(h,m){var v=this;v.upDownCache[h.id]=$.copy(v);var M=v.upDownCache[m.id];if(M){var B=M[e];B?v.insLeftOf(B):v.insAtRightEnd(M.parent)}else{var j=v.getBoundingClientRectWithoutMargin().left;m.seek(j,v)}v.controller.aria.queue(m,!0)},f.prototype.getBoundingClientRectWithoutMargin=function(){var h=this.domFrag();h.removeClass("dcg-mq-cursor");var m=k(h.oneElement()),v=m.left,M=m.right;return h.addClass("dcg-mq-cursor"),{left:v,right:M}},f.prototype.unwrapGramp=function(){var h=this.parent.parent,m=h.parent,v=h[e],M=this,B=h[t];if(h.disown().eachChild(function(ke){return ke.isEmpty()||(ke.children().adopt(m,B,v).each(function(Je){return Je.domFrag().insertBefore(h.domFrag()),!0}),B=ke.getEnd(e)),!0}),!this[e]){var j=this[t];if(j)this[e]=j[e];else for(;!this[e];){var ee=this.parent[e];if(ee)this.parent=ee,this[e]=ee.getEnd(t);else{this[e]=h[e],this.parent=m;break}}}var ce=this[e];ce?this.insLeftOf(ce):this.insAtRightEnd(m),h.domFrag().remove();var Ue=h[t],Me=h[e];Ue&&Ue.siblingDeleted(M.options,e),Me&&Me.siblingDeleted(M.options,t)},f.prototype.startSelection=function(){for(var h=this.anticursor=fe.fromCursor(this),m=h.ancestors,v=h;v.parent;v=v.parent)m[v.parent.id]=v},f.prototype.endSelection=function(){delete this.anticursor},f.prototype.select=function(){var h,m=this.anticursor;if(this[t]===m[t]&&this.parent===m.parent)return!1;for(var v=this;v.parent;v=v.parent)if(v.parent.id in m.ancestors){h=v.parent;break}o("cursor and anticursor in the same tree",h);var M=h,B=m.ancestors[M.id],j,ee,ce=e;if(v[t]!==B){for(var Ue=v;Ue;Ue=Ue[e])if(Ue[e]===B[e]){ce=t,j=v,ee=B;break}}ce===e&&(j=B,ee=v),j instanceof $&&(j=j[e]),ee instanceof $&&(ee=ee[t]),this.hide().selection=M.selectChildren(j,ee);var Me=this.selection.getEnd(ce);return this.insDirOf(ce,Me),this.selectionChanged(),!0},f.prototype.resetToEnd=function(h){this.clearSelection();var m=h.root;this[e]=0,this[t]=m.getEnd(e),this.parent=m},f.prototype.clearSelection=function(){return this.selection&&(this.selection.clear(),delete this.selection,this.selectionChanged()),this},f.prototype.deleteSelection=function(){var h=this.selection;h&&(this[t]=h.getEnd(t)[t],this[e]=h.getEnd(e)[e],h.remove(),this.selectionChanged(),delete this.selection)},f.prototype.replaceSelection=function(){var h=this.selection;return h&&(this[t]=h.getEnd(t)[t],this[e]=h.getEnd(e)[e],delete this.selection),h},f.prototype.depth=function(){for(var h=this,m=0;h=h.parent;)m+=h instanceof Hi?1:0;return m},f.prototype.isTooDeep=function(h){return this.options.maxDepth!==void 0?this.depth()+(h||0)>this.options.maxDepth:!1},f.prototype.selectionChanged=function(){},f}($),Le=function(D){pt(f,D);function f(h,m,v){var M=D.call(this,h,m,v)||this;return M._el=c("span",{class:"dcg-mq-selection"}),M.getDOMFragFromEnds().wrapAll(M._el),M}return f.prototype.isCleared=function(){return this._el===void 0},f.prototype.domFrag=function(){return this.isCleared()?this.getDOMFragFromEnds():L(this._el)},f.prototype.setEnds=function(h){o("Selection ends are never empty",h[t]&&h[e]),this.ends=h},f.prototype.getEnd=function(h){return this.ends[h]},f.prototype.adopt=function(h,m,v){return this.clear(),D.prototype.adopt.call(this,h,m,v)},f.prototype.clear=function(){var h=this.getDOMFragFromEnds();return this.domFrag().replaceWith(h),this._el=void 0,this},f.prototype.join=function(h,m){return m===void 0&&(m=""),this.fold("",function(v,M){return v+m+M[h]()})},f}(_),pe=function(){function D(f,h,m){this.textareaEventListeners={},this.id=f.id,this.data={},this.root=f,this.container=h,this.options=m,this.aria=new O(this.getControllerSelf()),this.ariaLabel="Math Input",this.ariaPostLabel="",f.controller=this.getControllerSelf(),this.cursor=f.cursor=new ie(f,m,this.getControllerSelf())}return D.prototype.getControllerSelf=function(){return this},D.prototype.handle=function(f,h){var m,v=this.options.handlers,M=(m=this.options.handlers)===null||m===void 0?void 0:m.fns[f];if(M){var B=v==null?void 0:v.APIClasses[this.KIND_OF_MQ];o("APIClass is defined",B);var j=new B(this);h===t||h===e?M(h,j):M(j)}},D.onNotify=function(f){D.notifyees.push(f)},D.prototype.notify=function(f){for(var h=0;h<D.notifyees.length;h+=1)D.notifyees[h](this.cursor,f);return this},D.prototype.setAriaLabel=function(f){var h=this.getAriaLabel();return f&&typeof f=="string"&&f!==""?this.ariaLabel=f:this.editable?this.ariaLabel="Math Input":this.ariaLabel="",this.ariaLabel!==h&&!this.containerHasFocus()&&this.updateMathspeak(),this},D.prototype.getAriaLabel=function(){return this.ariaLabel!=="Math Input"?this.ariaLabel:this.editable?"Math Input":""},D.prototype.setAriaPostLabel=function(f,h){var m=this;return f&&typeof f=="string"&&f!==""?(f!==this.ariaPostLabel&&typeof h=="number"&&(this._ariaAlertTimeout&&clearTimeout(this._ariaAlertTimeout),this._ariaAlertTimeout=setTimeout(function(){m.containerHasFocus()?m.aria.alert(m.root.mathspeak().trim()+" "+f.trim()):m.updateMathspeak()},h)),this.ariaPostLabel=f):(this._ariaAlertTimeout&&clearTimeout(this._ariaAlertTimeout),this.ariaPostLabel=""),this},D.prototype.getAriaPostLabel=function(){return this.ariaPostLabel||""},D.prototype.containerHasFocus=function(){return document.activeElement&&this.container.contains(document.activeElement)},D.prototype.getTextareaOrThrow=function(){var f=this.textarea;if(!f)throw new Error("expected a textarea");return f},D.prototype.getTextareaSpanOrThrow=function(){var f=this.textareaSpan;if(!f)throw new Error("expected a textareaSpan");return f},D.prototype.addTextareaEventListeners=function(f){if(this.textarea)for(var h in f){var m=h;this.removeTextareaEventListener(m),this.textarea.addEventListener(m,f[m])}},D.prototype.removeTextareaEventListener=function(f){if(this.textarea){var h=this.textareaEventListeners[f];h&&this.textarea.removeEventListener(f,h)}},D.prototype.exportMathSpeak=function(){return this.root.mathspeak()},D.prototype.updateMathspeak=function(){},D.prototype.scrollHoriz=function(){},D.prototype.selectionChanged=function(){},D.prototype.setOverflowClasses=function(){},D.notifyees=[],D}(),ae={},ye={},H={handlers:!0,autoCommands:!0,quietEmptyDelimiters:!0,autoParenthesizedFunctions:!0,autoOperatorNames:!0,leftRightIntoCmdGoes:!0,maxDepth:!0,interpretTildeAsSim:!0},ge={},Se=function(){function D(f){this.version=f}return D.prototype.assertJquery=function(){return o("Interface versions > 2 do not depend on JQuery",this.version<=2),o("JQuery is set for interface v < 3",this.jQuery),this.jQuery},D}(),Ke=function(){function D(){}return D}(),Ae=function(){window.console&&console.warn(`You are using the MathQuill API without specifying an interface version, which will fail in v1.0.0. Easiest fix is to do the following before doing anything else:

    MathQuill = MathQuill.getInterface(1);
    // now MathQuill.MathField() works like it used to

See also the "\`dev\` branch (2014\u20132015) \u2192 v0.10.0 Migration Guide" at
  https://github.com/mathquill/mathquill/wiki/%60dev%60-branch-(2014%E2%80%932015)-%E2%86%92-v0.10.0-Migration-Guide`)},Ze;function qe(D){return Ae(),Ze||(Ze=Lt(1)),Ze(D)}qe.prototype=Ke.prototype,qe.VERSION="v0.10.1",qe.interfaceVersion=function(D){if(D!==1)throw"Only interface version 1 supported. You specified: "+D;return Ae=function(){window.console&&console.warn(`You called MathQuill.interfaceVersion(1); to specify the interface version, which will fail in v1.0.0. You can fix this easily by doing this before doing anything else:

    MathQuill = MathQuill.getInterface(1);
    // now MathQuill.MathField() works like it used to

See also the "\`dev\` branch (2014\u20132015) \u2192 v0.10.0 Migration Guide" at
  https://github.com/mathquill/mathquill/wiki/%60dev%60-branch-(2014%E2%80%932015)-%E2%86%92-v0.10.0-Migration-Guide`)},Ae(),qe},qe.getInterface=Lt;var At=Lt.MIN=1,Fe=Lt.MAX=3;function Lt(D){if(D!==1&&D!==2&&D!==3)throw"Only interface versions between "+At+" and "+Fe+" supported. You specified: "+D;var f=D;if(f<3){var h=window.jQuery;if(!h)throw"MathQuill interface version ".concat(f," requires jQuery 1.5.2+ to be loaded first");Se.prototype.jQuery=h}var m=xv(xv({},ge),{handlers:function(Me){return{fns:Me||{},APIClasses:ee}}});function v(Me,ke){for(var Je in ke)if(ke.hasOwnProperty(Je)){if(Je==="substituteKeyboardEvents"&&f>=3)throw new Error(["As of interface version 3, the 'substituteKeyboardEvents'","option is no longer supported. Use 'overrideTypedText' and","'overrideKeystroke' instead."].join(" "));var Ye=ke[Je],at=m[Je];Me[Je]=at?at(Ye):Ye}}var M=f<3?Se:function(Me){pt(ke,Me);function ke(){return Me!==null&&Me.apply(this,arguments)||this}return ke}(Se),B=function(Me){pt(ke,Me);function ke(Je){var Ye=Me.call(this)||this;return Ye.__controller=Je,Ye.__options=Je.options,Ye.id=Je.id,Ye.data=Je.data,Ye}return ke.prototype.mathquillify=function(Je){var Ye=this.__controller,at=Ye.root,ut=Ye.container;Ye.createTextarea();var Pt=L(ut).addClass(Je).children().detach();at.setDOM(L(c("span",{class:"dcg-mq-root-block","aria-hidden":!0})).appendTo(ut).oneElement()),R.linkElementByBlockNode(at.domFrag().oneElement(),at),this.latex(Pt.text()),this.revert=function(){return Ye.removeMouseEventListener(),L(ut).removeClass("dcg-mq-editable-field dcg-mq-math-mode dcg-mq-text-mode").empty().append(Pt),f<3?this.__options.assertJquery()(ut):ut}},ke.prototype.setAriaLabel=function(Je){return this.__controller.setAriaLabel(Je),this},ke.prototype.getAriaLabel=function(){return this.__controller.getAriaLabel()},ke.prototype.config=function(Je){return v(this.__options,Je),this},ke.prototype.el=function(){return this.__controller.container},ke.prototype.text=function(){return this.__controller.exportText()},ke.prototype.mathspeak=function(){return this.__controller.exportMathSpeak()},ke.prototype.latex=function(Je){if(arguments.length>0){this.__controller.renderLatexMath(Je);var Ye=this.__controller.cursor;return this.__controller.blurred&&Ye.hide().parent.blur(Ye),this}return this.__controller.exportLatex()},ke.prototype.selection=function(){return this.__controller.exportLatexSelection()},ke.prototype.html=function(){return this.__controller.root.domFrag().oneElement().innerHTML.replace(/ jQuery\d+="(?:\d+|null)"/g,"").replace(/ mathquill-(?:command|block)-id="?\d+"?/g,"").replace(/<span class="?dcg-mq-cursor( dcg-mq-blink)?"?>.?<\/span>/i,"").replace(/ dcg-mq-hasCursor|dcg-mq-hasCursor ?/,"").replace(/ class=(""|(?= |>))/g,"")},ke.prototype.reflow=function(){return this.__controller.root.postOrder(function(Je){Je.reflow()}),this},ke}(Ke),j=function(Me){pt(ke,Me);function ke(){return Me!==null&&Me.apply(this,arguments)||this}return ke.prototype.mathquillify=function(Je){return Me.prototype.mathquillify.call(this,Je),this.__controller.editable=!0,this.__controller.addMouseEventListener(),this.__controller.editablesTextareaEvents(),this},ke.prototype.focus=function(){return this.__controller.getTextareaOrThrow().focus(),this.__controller.scrollHoriz(),this},ke.prototype.blur=function(){return this.__controller.getTextareaOrThrow().blur(),this},ke.prototype.write=function(Je){this.__controller.writeLatex(Je),this.__controller.scrollHoriz();var Ye=this.__controller.cursor;return this.__controller.blurred&&Ye.hide().parent.blur(Ye),this},ke.prototype.empty=function(){var Je,Ye=this.__controller.root,at=this.__controller.cursor;return Ye.setEnds((Je={},Je[t]=0,Je[e]=0,Je)),Ye.domFrag().empty(),delete at.selection,at.insAtRightEnd(Ye),this},ke.prototype.cmd=function(Je){var Ye=this.__controller.notify(void 0),at=Ye.cursor;if(/^\\[a-z]+$/i.test(Je)&&!at.isTooDeep()){Je=Je.slice(1);var ut=A[Je],Pt;ut&&(ut.constructor?Pt=new ut(Je):Pt=ut(Je),at.selection&&Pt.replaces(at.replaceSelection()),Pt.createLeftOf(at.show()))}else at.parent.write(at,Je);return Ye.scrollHoriz(),Ye.blurred&&at.hide().parent.blur(at),this},ke.prototype.select=function(){return this.__controller.selectAll(),this},ke.prototype.clearSelection=function(){return this.__controller.cursor.clearSelection(),this},ke.prototype.moveToDirEnd=function(Je){return this.__controller.notify("move").cursor.insAtDirEnd(Je,this.__controller.root),this},ke.prototype.moveToLeftEnd=function(){return this.moveToDirEnd(t)},ke.prototype.moveToRightEnd=function(){return this.moveToDirEnd(e)},ke.prototype.keystroke=function(Je,Ye){for(var at=Je.replace(/^\s+|\s+$/g,"").split(/\s+/),ut=0;ut<at.length;ut+=1)this.__controller.keystroke(at[ut],Ye);return this},ke.prototype.typedText=function(Je){for(var Ye=0;Ye<Je.length;Ye+=1)this.__controller.typedText(Je.charAt(Ye));return this},ke.prototype.dropEmbedded=function(Je,Ye,at){var ut=Je-S(),Pt=Ye-T(),Wr=document.elementFromPoint(ut,Pt);this.__controller.seek(Wr,ut,Pt);var Sn=new t1().setOptions(at);Sn.createLeftOf(this.__controller.cursor)},ke.prototype.setAriaPostLabel=function(Je,Ye){return this.__controller.setAriaPostLabel(Je,Ye),this},ke.prototype.getAriaPostLabel=function(){return this.__controller.getAriaPostLabel()},ke.prototype.clickAt=function(Je,Ye,at){at=at||document.elementFromPoint(Je,Ye);var ut=this.__controller,Pt=ut.root,Wr=Pt.domFrag().oneElement();return Wr.contains(at)||(at=Wr),ut.seek(at,Je,Ye),ut.blurred&&this.focus(),this},ke.prototype.ignoreNextMousedown=function(Je){return this.__controller.cursor.options.ignoreNextMousedown=Je,this},ke}(B),ee={AbstractMathQuill:B,EditableField:j};o("API.StaticMath defined",ae.StaticMath),ee.StaticMath=ae.StaticMath(ee),o("API.MathField defined",ae.MathField),ee.MathField=ae.MathField(ee),o("API.InnerMathField defined",ae.InnerMathField),ee.InnerMathField=ae.InnerMathField(ee),ae.TextField&&(ee.TextField=ae.TextField(ee));var ce=function(Me){if(!Me||!Me.nodeType)return null;for(var ke,Je=L(Me).children().toElementArray(),Ye=0,at=Je;Ye<at.length;Ye++){var ut=at[Ye];if(ut.classList.contains("dcg-mq-root-block")){ke=ut;break}}var Pt=R.getNodeOfElement(ke),Wr=Pt&&Pt.controller,Sn=Wr&&ee[Wr.KIND_OF_MQ];return Wr&&Sn?new Sn(Wr):null};ce.L=t,ce.R=e,ce.config=function(Me){return v(M.prototype,Me),this},ce.registerEmbed=function(Me,ke){if(!/^[a-z][a-z0-9]*$/i.test(Me))throw"Embed name must start with letter and be only letters and digits";ye[Me]=ke},ce.StaticMath=Ue("StaticMath",ee.StaticMath),ce.MathField=Ue("MathField",ee.MathField),ce.InnerMathField=Ue("InnerMathField",ee.InnerMathField),ee.TextField&&(ce.TextField=Ue("TextField",ee.TextField)),ce.prototype=B.prototype,ce.EditableField=function(){throw"wtf don't call me, I'm 'abstract'"},ce.EditableField.prototype=j.prototype,f<3&&(ce.saneKeyboardEvents=rt);function Ue(Me,ke){o(Me+" is defined",ke);function Je(Ye,at){if(!Ye||!Ye.nodeType)return null;var ut=ce(Ye);if(ut instanceof ke)return ut;var Pt=new ta(new ke.RootBlock,Ye,new M(f));return Pt.KIND_OF_MQ=Me,new ke(Pt).__mathquillify(at||{},f)}return Je.prototype=ke.prototype,Je}return ce}qe.noConflict=function(){return window.MathQuill=_r,qe};var _r=window.MathQuill;window.MathQuill=qe;function Ge(D){D.moveOutOf=function(f){o("controller is defined",this.controller),this.controller.handle("moveOutOf",f)},D.deleteOutOf=function(f){o("controller is defined",this.controller),this.controller.handle("deleteOutOf",f)},D.selectOutOf=function(f){o("controller is defined",this.controller),this.controller.handle("selectOutOf",f)},D.upOutOf=function(){o("controller is defined",this.controller),this.controller.handle("upOutOf")},D.downOutOf=function(){o("controller is defined",this.controller),this.controller.handle("downOutOf")},D.reflow=function(){o("controller is defined",this.controller),this.controller.handle("reflow"),this.controller.handle("edited"),this.controller.handle("edit")}}function vi(D,f){throw D?D="'"+D+"'":D="EOF","Parse Error: "+f+" at "+D}var ht=function(){function D(f){this._=f}return D.prototype.parse=function(f){return this.skip(D.eof)._(""+f,h,vi);function h(m,v){return v}},D.prototype.or=function(f){o("or is passed a parser",f instanceof D);var h=this;return new D(function(m,v,M){return h._(m,v,B);function B(j){return f._(m,v,M)}})},D.prototype.then=function(f){var h=this;return new D(function(m,v,M){return h._(m,B,M);function B(j,ee){var ce=f instanceof D?f:f(ee);return o("a parser is returned",ce instanceof D),ce._(j,v,M)}})},D.prototype.many=function(){var f=this;return new D(function(h,m,v){for(var M=[];f._(h,B,j););return m(h,M);function B(ee,ce){return h=ee,M.push(ce),!0}function j(){return!1}})},D.prototype.times=function(f,h){arguments.length<2&&(h=f);var m=this;return new D(function(v,M,B){for(var j=[],ee=!0,ce,Ue=0;Ue<f;Ue+=1)if(ee=!!m._(v,Me,ke),!ee)return B(v,ce);for(;Ue<h&&ee;Ue+=1)m._(v,Me,Je);return M(v,j);function Me(Ye,at){return j.push(at),v=Ye,!0}function ke(Ye,at){return ce=at,v=Ye,!1}function Je(Ye,at){return!1}})},D.prototype.result=function(f){return this.then(D.succeed(f))},D.prototype.atMost=function(f){return this.times(0,f)},D.prototype.atLeast=function(f){var h=this;return h.times(f).then(function(m){return h.many().map(function(v){return m.concat(v)})})},D.prototype.map=function(f){return this.then(function(h){return D.succeed(f(h))})},D.prototype.skip=function(f){return this.then(function(h){return f.result(h)})},D.string=function(f){var h=f.length,m="expected '"+f+"'";return new D(function(v,M,B){var j=v.slice(0,h);return j===f?M(v.slice(h),j):B(v,m)})},D.regex=function(f){o("regexp parser is anchored",f.toString().charAt(1)==="^");var h="expected "+f;return new D(function(m,v,M){var B=f.exec(m);if(B){var j=B[0];return v(m.slice(j.length),j)}else return M(m,h)})},D.succeed=function(f){return new D(function(h,m){return m(h,f)})},D.fail=function(f){return new D(function(h,m,v){return v(h,f)})},D.letter=D.regex(/^[a-z]/i),D.letters=D.regex(/^[a-z]*/i),D.digit=D.regex(/^[0-9]/),D.digits=D.regex(/^[0-9]*/),D.whitespace=D.regex(/^\s+/),D.optWhitespace=D.regex(/^\s*/),D.any=new D(function(f,h,m){return f?h(f.slice(1),f.charAt(0)):m(f,"expected any character")}),D.all=new D(function(f,h,m){return h("",f)}),D.eof=new D(function(f,h,m){return f?m(f,"expected EOF"):h(f,f)}),D}(),Ee=function(){function D(){this.fn=n}return D.prototype.listen=function(f){this.fn=f,clearTimeout(this.timeoutId),this.timeoutId=setTimeout(this.fn)},D.prototype.listenOnce=function(f){var h=this;this.listen(function(){for(var m=[],v=0;v<arguments.length;v++)m[v]=arguments[v];h.clearListener(),f.apply(void 0,m)})},D.prototype.clearListener=function(){this.fn=n,clearTimeout(this.timeoutId)},D.prototype.trigger=function(){for(var f=[],h=0;h<arguments.length;h++)f[h]=arguments[h];this.fn.apply(this,f)},D}(),bo=function(){var D={8:"Backspace",9:"Tab",10:"Enter",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Esc",32:"Spacebar",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",45:"Insert",46:"Del",144:"NumLock"},f={ArrowRight:"Right",ArrowLeft:"Left",ArrowDown:"Down",ArrowUp:"Up",Delete:"Del",Escape:"Esc"," ":"Spacebar"};function h(B){switch(v(B)){case"Right":case"Left":case"Down":case"Up":return!0}return!1}function m(B){return B.length===1&&B>="a"&&B<="z"}function v(B){var j;if(B.key===void 0){var ee=B.which||B.keyCode;return D[ee]||String.fromCharCode(ee)}return m(B.key)?B.key.toUpperCase():(j=f[B.key])!==null&&j!==void 0?j:B.key}function M(B){var j=v(B),ee=[];return B.ctrlKey&&ee.push("Ctrl"),B.metaKey&&ee.push("Meta"),B.altKey&&ee.push("Alt"),B.shiftKey&&ee.push("Shift"),ee.length?(j!=="Alt"&&j!=="Control"&&j!=="Meta"&&j!=="Shift"&&ee.push(j),ee.join("-")):j}return function(j,ee){var ce=null,Ue=null,Me=new Ee;function ke(){try{j instanceof HTMLTextAreaElement&&j.select()}catch(Qr){}}function Je(Qr){Me.trigger(),Me.clearListener(),j instanceof HTMLTextAreaElement&&(j.value=Qr),Qr&&ke(),Ye=!!Qr}var Ye=!1;function at(){return!("selectionStart"in j)||!(j instanceof HTMLTextAreaElement)?!1:j.selectionStart!==j.selectionEnd}function ut(){ee.options&&ee.options.overrideKeystroke?ee.options.overrideKeystroke(M(ce),ce):ee.keystroke(M(ce),ce)}function Pt(Qr){Me.trigger(Qr),Qr.target===j&&(ce=Qr,Ue=null,Ye&&Me.listenOnce(function(mh){mh&&mh.type==="focusout"||ke()}),ut())}function Wr(Qr){Me.trigger(Qr),Qr.target===j&&(ce&&Ue&&ut(),Ue=Qr,h(Qr)?Me.listenOnce(Rn):Me.listen(Xr))}function Sn(Qr){Me.trigger(Qr),Qr.target===j&&ce&&!Ue&&(h(Qr)?Me.listenOnce(Rn):Me.listen(Xr))}function Xr(){if(!at()&&j instanceof HTMLTextAreaElement){var Qr=j.value;ce&&!ce.altKey&&ce.ctrlKey&&!ce.metaKey&&ce.shiftKey&&(ce.key==="U"||ce.key==="Unidentified"||ce.key==="Process")||(Qr.length===1?(j.value="",ee.options&&ee.options.overrideTypedText?ee.options.overrideTypedText(Qr):ee.typedText(Qr)):Rn())}}function Rn(){j instanceof HTMLTextAreaElement&&j.value.length>1&&ke()}function Va(){ce=null,Ue=null,Me.clearListener(),j instanceof HTMLTextAreaElement&&(j.value="")}function rl(Qr){Me.trigger(),Qr.target===j&&(document.activeElement!==j&&j.focus(),Me.listen(function(){if(j instanceof HTMLTextAreaElement){var Vc=j.value;j.value="",Vc&&ee.paste(Vc)}}))}function xp(Qr){Me.trigger(Qr)}return ee.options&&ee.options.disableCopyPaste?ee.addTextareaEventListeners({keydown:Pt,keypress:Wr,keyup:Sn,focusout:Va,copy:function(Qr){Qr.preventDefault()},cut:function(Qr){Qr.preventDefault()},paste:function(Qr){Me.trigger(),Qr.preventDefault()},input:xp}):ee.addTextareaEventListeners({keydown:Pt,keypress:Wr,keyup:Sn,focusout:Va,cut:function(){Me.listenOnce(function(){ee.cut()})},copy:function(){Me.listenOnce(function(){ee.copy()})},paste:rl,input:xp}),{select:Je}}}(),st=function(D){pt(f,D);function f(){return D!==null&&D.apply(this,arguments)||this}return f.prototype.exportText=function(){return this.root.foldChildren("",function(h,m){return h+m.text()})},f}(pe);pe.onNotify(function(D,f){if(f==="edit"||f==="replace"||f===void 0){var h=D.controller;if(!h||!h.options.enableDigitGrouping||h.blurred!==!1)return;h.disableGroupingForSeconds(1)}});var gt=function(D){pt(f,D);function f(){var h=D!==null&&D.apply(this,arguments)||this;return h.handleTextareaFocusEditable=function(){var m=h.cursor;h.updateMathspeak(),h.blurred=!1,clearTimeout(h.blurTimeout),L(h.container).addClass("dcg-mq-focused"),m.parent||m.insAtRightEnd(h.root),m.selection?(m.selection.domFrag().removeClass("dcg-mq-blur"),h.selectionChanged()):m.show(),h.setOverflowClasses()},h.handleTextareaBlurEditable=function(){h.textareaSelectionTimeout&&(clearTimeout(h.textareaSelectionTimeout),h.textareaSelectionTimeout=0),h.disableGroupingForSeconds(0),h.blurred=!0,h.blurTimeout=setTimeout(function(){h.root.postOrder(function(m){m.intentionalBlur()}),h.cursor.clearSelection().endSelection(),h.blur(),h.updateMathspeak(),h.scrollHoriz()}),window.addEventListener("blur",h.handleWindowBlur)},h.handleTextareaFocusStatic=function(){h.blurred=!1},h.handleTextareaBlurStatic=function(){h.cursor.selection&&h.cursor.selection.clear(),setTimeout(function(){L(h.getTextareaSpanOrThrow()).detach(),h.blurred=!0})},h.handleWindowBlur=function(){clearTimeout(h.blurTimeout),h.cursor.selection&&h.cursor.selection.domFrag().addClass("dcg-mq-blur"),h.blur(),h.updateMathspeak()},h}return f.prototype.disableGroupingForSeconds=function(h){var m=this;clearTimeout(this.__disableGroupingTimeout),h===0?this.root.domFrag().removeClass("dcg-mq-suppress-grouping"):(this.root.domFrag().addClass("dcg-mq-suppress-grouping"),this.__disableGroupingTimeout=setTimeout(function(){m.root.domFrag().removeClass("dcg-mq-suppress-grouping")},h*1e3))},f.prototype.blur=function(){this.cursor.hide().parent.blur(this.cursor),L(this.container).removeClass("dcg-mq-focused"),window.removeEventListener("blur",this.handleWindowBlur),this.options&&this.options.resetCursorOnBlur&&this.cursor.resetToEnd(this)},f.prototype.addEditableFocusBlurListeners=function(){var h=this,m=h.cursor;this.addTextareaEventListeners({focus:this.handleTextareaFocusEditable,blur:this.handleTextareaBlurEditable}),h.blurred=!0,m.hide().parent.blur(m)},f.prototype.addStaticFocusBlurListeners=function(){this.addTextareaEventListeners({focus:this.handleTextareaFocusStatic,blur:this.handleTextareaBlurStatic})},f}(st),ft=!1,le=function(D){pt(f,D);function f(){return D!==null&&D.apply(this,arguments)||this}return f.prototype.keystroke=function(h,m,v){var M=v.cursor;switch(h){case"Ctrl-Shift-Backspace":case"Ctrl-Backspace":v.ctrlDeleteDir(t);break;case"Shift-Backspace":case"Backspace":v.backspace();break;case"Esc":case"Tab":v.escapeDir(e,h,m);return;case"Shift-Tab":case"Shift-Esc":v.escapeDir(t,h,m);return;case"End":v.notify("move").cursor.insAtRightEnd(M.parent),v.aria.queue("end of").queue(M.parent,!0);break;case"Ctrl-End":v.notify("move").cursor.insAtRightEnd(v.root),v.aria.queue("end of").queue(v.ariaLabel).queue(v.root).queue(v.ariaPostLabel);break;case"Shift-End":v.selectToBlockEndInDir(e);break;case"Ctrl-Shift-End":v.selectToRootEndInDir(e);break;case"Home":v.notify("move").cursor.insAtLeftEnd(M.parent),v.aria.queue("beginning of").queue(M.parent,!0);break;case"Ctrl-Home":v.notify("move").cursor.insAtLeftEnd(v.root),v.aria.queue("beginning of").queue(v.ariaLabel).queue(v.root).queue(v.ariaPostLabel);break;case"Shift-Home":v.selectToBlockEndInDir(t);break;case"Ctrl-Shift-Home":v.selectToRootEndInDir(t);break;case"Left":v.moveLeft();break;case"Shift-Left":v.selectLeft();break;case"Ctrl-Left":break;case"Right":v.moveRight();break;case"Shift-Right":v.selectRight();break;case"Ctrl-Right":break;case"Up":v.moveUp();break;case"Down":v.moveDown();break;case"Shift-Up":v.withIncrementalSelection(function(B){if(M[t])for(;M[t];)B(t);else B(t)});break;case"Shift-Down":v.withIncrementalSelection(function(B){if(M[e])for(;M[e];)B(e);else B(e)});break;case"Ctrl-Up":break;case"Ctrl-Down":break;case"Ctrl-Shift-Del":case"Ctrl-Del":v.ctrlDeleteDir(e);break;case"Shift-Del":case"Del":v.deleteForward();break;case"Meta-A":case"Ctrl-A":v.selectAll();break;case"Ctrl-Alt-Up":M.parent.parent&&M.parent.parent instanceof f?v.aria.queue(M.parent.parent):v.aria.queue("nothing above");break;case"Ctrl-Alt-Down":M.parent&&M.parent instanceof f?v.aria.queue(M.parent):v.aria.queue("block is empty");break;case"Ctrl-Alt-Left":M.parent.parent&&M.parent.parent.getEnd(t)?v.aria.queue(M.parent.parent.getEnd(t)):v.aria.queue("nothing to the left");break;case"Ctrl-Alt-Right":M.parent.parent&&M.parent.parent.getEnd(e)?v.aria.queue(M.parent.parent.getEnd(e)):v.aria.queue("nothing to the right");break;case"Ctrl-Alt-Shift-Down":M.selection?v.aria.queue(M.selection.join("mathspeak"," ").trim()+" selected"):v.aria.queue("nothing selected");break;case"Ctrl-Alt-=":case"Ctrl-Alt-Shift-Right":v.ariaPostLabel.length?v.aria.queue(v.ariaPostLabel):v.aria.queue("no answer");break;default:return}v.aria.alert(),m==null||m.preventDefault(),v.scrollHoriz()},f.prototype.moveOutOf=function(h,m,v){o("overridden or never called on this node",!1)},f.prototype.moveTowards=function(h,m,v){o("overridden or never called on this node",!1)},f.prototype.deleteOutOf=function(h,m){o("overridden or never called on this node",!1)},f.prototype.deleteTowards=function(h,m){o("overridden or never called on this node",!1)},f.prototype.unselectInto=function(h,m){o("overridden or never called on this node",!1)},f.prototype.selectOutOf=function(h,m){o("overridden or never called on this node",!1)},f.prototype.selectTowards=function(h,m){o("overridden or never called on this node",!1)},f}(R);pe.onNotify(function(D,f){(f==="move"||f==="upDown")&&D.show().clearSelection()}),ge.leftRightIntoCmdGoes=function(D){if(D&&D!=="up"&&D!=="down")throw'"up" or "down" required for leftRightIntoCmdGoes option, got "'+D+'"';return D},pe.onNotify(function(D,f){f!=="upDown"&&(D.upDownCache={})}),pe.onNotify(function(D,f){f==="edit"&&D.show().deleteSelection()}),pe.onNotify(function(D,f){f!=="select"&&D.endSelection()});var Gr=function(D){pt(f,D);function f(){return D!==null&&D.apply(this,arguments)||this}return f.prototype.keystroke=function(h,m){this.cursor.parent.keystroke(h,m,this.getControllerSelf())},f.prototype.escapeDir=function(h,m,v){s(h);var M=this.cursor;if(M.parent!==this.root&&(v==null||v.preventDefault()),M.parent!==this.root)return M.clearSelection(),M.parent.moveOutOf(h,M),M.controller.aria.alert(),this.notify("move")},f.prototype.moveDir=function(h){s(h);var m=this.cursor,v=m.options.leftRightIntoCmdGoes,M=m[h];return m.selection?m.insDirOf(h,m.selection.getEnd(h)):M?M.moveTowards(h,m,v):m.parent.moveOutOf(h,m,v),this.notify("move")},f.prototype.moveLeft=function(){return this.moveDir(t)},f.prototype.moveRight=function(){return this.moveDir(e)},f.prototype.moveUp=function(){return this.moveUpDown("up")},f.prototype.moveDown=function(){return this.moveUpDown("down")},f.prototype.moveUpDown=function(h){var m=this,v=m.notify("upDown").cursor,M,B;h==="up"?(M="upInto",B="upOutOf"):(M="downInto",B="downOutOf");var j=v[t],ee=v[e],ce=ee&&ee[M],Ue=j&&j[M];return ce?v.insAtLeftEnd(ce):Ue?v.insAtRightEnd(Ue):v.parent.bubble(function(Me){var ke=Me[B];if(ke&&(typeof ke=="function"&&(ke=ke.call(Me,v)),ke instanceof le&&v.jumpUpDown(Me,ke),ke!==!0))return!1}),m},f.prototype.deleteDir=function(h){s(h);var m=this.cursor,v=m[h],M=m.parent.parent,B=m.controller;if(v&&v instanceof le)v.sides?B.aria.queue(v.parent.chToCmd(v.sides[-h].ch).mathspeak({createdLeftOf:m})):!v.blocks&&v.parent.ctrlSeq!=="\\text"&&B.aria.queue(v);else if(M&&M instanceof le)if(M.sides)B.aria.queue(M.parent.chToCmd(M.sides[h].ch).mathspeak({createdLeftOf:m}));else if(M.blocks&&M.mathspeakTemplate)if(M.upInto&&M.downInto)B.aria.queue(M.mathspeakTemplate[1]);else{var j=M.mathspeakTemplate,ee=h===t?j[0]:j[j.length-1];B.aria.queue(ee)}else B.aria.queue(M);var ce=m.selection;if(this.notify("edit"),!ce){var Ue=m[h];Ue?Ue.deleteTowards(h,m):m.parent.deleteOutOf(h,m)}var Me=m[t],ke=m[e];return Me.siblingDeleted&&Me.siblingDeleted(m.options,e),ke.siblingDeleted&&ke.siblingDeleted(m.options,t),m.parent.bubble(function(Je){Je.reflow()}),this},f.prototype.ctrlDeleteDir=function(h){s(h);var m=this.cursor;if(!m[h]||m.selection)return this.deleteDir(h);this.notify("edit");var v;h===t?v=new _(m.parent.getEnd(t),m[t]):v=new _(m[e],m.parent.getEnd(e)),m.controller.aria.queue(v),v.remove(),m.insAtDirEnd(h,m.parent);var M=m[t],B=m[e];return M&&M.siblingDeleted(m.options,e),B&&B.siblingDeleted(m.options,t),m.parent.bubble(function(j){j.reflow()}),this},f.prototype.backspace=function(){return this.deleteDir(t)},f.prototype.deleteForward=function(){return this.deleteDir(e)},f.prototype.startIncrementalSelection=function(){o("Multiple selections can't be simultaneously open",!ft),ft=!0,this.notify("select");var h=this.cursor;h.anticursor||h.startSelection()},f.prototype.selectDirIncremental=function(h){o("A selection is open",ft),ft=!0;var m=this.cursor,v=m.selection;s(h);var M=m[h];M?v&&v.getEnd(h)===M&&m.anticursor[-h]!==M?M.unselectInto(h,m):M.selectTowards(h,m):m.parent.selectOutOf(h,m)},f.prototype.finishIncrementalSelection=function(){o("A selection is open",ft);var h=this.cursor;h.clearSelection(),h.select()||h.show();var m=h.selection;m&&h.controller.aria.clear().queue(m.join("mathspeak"," ").trim()+" selected"),ft=!1},f.prototype.withIncrementalSelection=function(h){var m=this;try{this.startIncrementalSelection();try{h(function(v){return m.selectDirIncremental(v)})}finally{this.finishIncrementalSelection()}}finally{ft=!1}},f.prototype.selectDir=function(h){this.withIncrementalSelection(function(m){return m(h)})},f.prototype.selectLeft=function(){return this.selectDir(t)},f.prototype.selectRight=function(){return this.selectDir(e)},f.prototype.selectAll=function(){this.notify("move");var h=this.cursor;h.insAtRightEnd(this.root),this.withIncrementalSelection(function(m){for(;h[t];)m(t)})},f.prototype.selectToBlockEndInDir=function(h){var m=this.cursor;this.withIncrementalSelection(function(v){for(;m[h];)v(h)})},f.prototype.selectToRootEndInDir=function(h){var m=this,v=this.cursor;this.withIncrementalSelection(function(M){for(;v[h]||v.parent!==m.root;)M(h)})},f}(gt),_e=function(D){pt(f,D);function f(h){return D.call(this)||this}return f}(le),rr=function(){function D(Xr){var Rn=new Hi;return Xr.adopt(Rn,0,0),Rn}function f(Xr){for(var Rn=Xr[0]||new Hi,Va=1;Va<Xr.length;Va+=1)Xr[Va].children().adopt(Rn,Rn.getEnd(e),0);return Rn}var h=ht.string,m=ht.regex,v=ht.letter,M=ht.digit,B=ht.any,j=ht.optWhitespace,ee=ht.succeed,ce=ht.fail,Ue=v.map(function(Xr){return new ue(Xr)}),Me=M.map(function(Xr){return new re(Xr)}),ke=m(/^[^${}\\_^]/).map(function(Xr){return new Ll(Xr)}),Je=m(/^[^\\a-eg-zA-Z]/).or(h("\\").then(m(/^[a-z]+/i).or(m(/^\s+/).result(" ")).or(B))).then(function(Xr){var Rn=A[Xr];if(Rn)if(Rn.constructor){var Va=Rn;return new Va(Xr).parser()}else{var rl=Rn;return rl(Xr).parser()}else return ce("unknown command: \\"+Xr)}),Ye=Je.or(Ue).or(Me).or(ke),at=h("{").then(function(){return Pt}).skip(h("}")),ut=j.then(at.or(Ye.map(D))),Pt=ut.many().map(f).skip(j),Wr=h("[").then(ut.then(function(Xr){return Xr.join("latex")!=="]"?ee(Xr):ce("")}).many().map(f).skip(j)).skip(h("]")),Sn=Pt;return Sn.block=ut,Sn.optBlock=Wr,Sn}();ge.maxDepth=function(D){return typeof D=="number"?D:void 0};var ve=function(D){pt(f,D);function f(){return D!==null&&D.apply(this,arguments)||this}return f.prototype.cleanLatex=function(h){return h.replace(/(\\[a-z]+) (?![a-z])/gi,"$1")},f.prototype.exportLatex=function(){return this.cleanLatex(this.root.latex())},f.prototype.writeLatex=function(h){var m=this.notify("edit").cursor;return m.parent.writeLatex(m,h),this},f.prototype.exportLatexSelection=function(){var h={latex:"",startIndex:-1,endIndex:-1},m=this.cursor.selection;if(m)h.startSelectionBefore=m.getEnd(t),h.endSelectionAfter=m.getEnd(e);else{var v=this.cursor[t];v?h.startSelectionAfter=v:h.startSelectionBefore=this.cursor.parent;var M=this.cursor[e];M?h.endSelectionBefore=M:h.endSelectionAfter=this.cursor.parent}this.root.latexRecursive(h);for(var B=h.latex,j=this.cleanLatex(B),ee=h.startIndex,ce=h.endIndex,Ue=0,Me=0;Me<h.endIndex;Me++)B[Me]!==j[Ue]?(Me<h.startIndex&&(ee-=1),ce-=1):Ue+=1;return{latex:j,startIndex:ee,endIndex:ce}},f.prototype.classifyLatexForEfficientUpdate=function(h){if(typeof h=="string"){var m=h.match(/-?[0-9.]+$/g);if(m&&m.length===1)return{latex:h,prefix:h.substr(0,h.length-m[0].length),digits:m[0]}}},f.prototype.updateLatexMathEfficiently=function(h,m){var v,M,B,j,ee=this.root,ce,Ue=this.classifyLatexForEfficientUpdate(h);if(Ue){if(ce=this.classifyLatexForEfficientUpdate(m),!ce||ce.prefix!==Ue.prefix)return!1}else return!1;var Me=ce.digits,ke=Ue.digits,Je=!1,Ye=!1;Me[0]==="-"&&(Je=!0,Me=Me.substr(1)),ke[0]==="-"&&(Ye=!0,ke=ke.substr(1));for(var at=this.root.getEnd(e),ut=[],Pt=Me.length-1;Pt>=0;Pt--){if(!at||at.ctrlSeq!==Me[Pt]||at.parent!==ee)return!1;ut.unshift(at),at=at[t]}if(Je&&!Ye){var Wr=at;if(!Wr||Wr.ctrlSeq!=="-"||Wr[e]!==ut[0]||Wr.parent!==ee)return!1;var Sn=Wr[t];if(Sn&&Sn.parent!==ee)return!1;ut[0][t]=Wr[t],ee.getEnd(t)===Wr&&ee.setEnds((v={},v[t]=ut[0],v[e]=ee.getEnd(e),v)),Sn&&(Sn[e]=ut[0]),Wr.domFrag().remove()}if(!Je&&Ye){var Xr=new St("-"),Rn=document.createElement("span");Rn.textContent="-",Xr.setDOM(Rn);var Va=ut[0][t];Va&&(Va[e]=Xr),ee.getEnd(t)===ut[0]&&ee.setEnds((M={},M[t]=Xr,M[e]=ee.getEnd(e),M)),Xr.parent=ee,Xr[t]=ut[0][t],Xr[e]=ut[0],ut[0][t]=Xr,Xr.contactWeld(this.cursor),Xr.domFrag().insertBefore(ut[0].domFrag())}var rl=Math.min(Me.length,ke.length);for(Pt=0;Pt<rl;Pt++){var xp=ke[Pt];at=ut[Pt],at.ctrlSeq!==xp&&(at.ctrlSeq=xp,at.domFrag().oneElement().textContent=xp,at.mathspeakName=xp)}if(Me.length>ke.length)for(at=ut[ke.length-1],ee.setEnds((B={},B[t]=ee.getEnd(t),B[e]=at,B)),at[e]=0,Pt=Me.length-1;Pt>=rl;Pt--)ut[Pt].domFrag().remove();if(ke.length>Me.length){var Qr=document.createDocumentFragment();for(Pt=rl;Pt<ke.length;Pt++){var mh=document.createElement("span");mh.className="dcg-mq-digit",mh.textContent=ke[Pt];var Vc=new re(ke[Pt]);Vc.parent=ee,Vc.setDOM(mh),Qr.appendChild(mh),Vc[t]=ee.getEnd(e),Vc[e]=0;var _5=Vc[t];_5[e]=Vc,ee.setEnds((j={},j[t]=ee.getEnd(t),j[e]=Vc,j))}ee.domFrag().oneElement().appendChild(Qr)}var i1=this.exportLatex();if(i1!==h)return console.warn("tried updating latex efficiently but did not work. Attempted: "+h+" but wrote: "+i1),!1;var n1=ee.getEnd(e);return n1&&n1.fixDigitGrouping(this.cursor.options),!0},f.prototype.renderLatexMathFromScratch=function(h){var m,v=this.root,M=this.cursor,B=ht.all,j=ht.eof,ee=rr.skip(j).or(B.result(!1)).parse(h);if(v.setEnds((m={},m[t]=0,m[e]=0,m)),ee&&ee.children().adopt(v,0,0),ee){var ce=v.domFrag();ce.children().remove(),ce.oneElement().appendChild(ee.html()),v.finalizeInsert(M.options,M)}else v.domFrag().empty()},f.prototype.renderLatexMath=function(h){var m=this.cursor,v=this.root;this.notify("replace"),m.clearSelection();var M=this.exportLatex();(!v.getEnd(t)||!v.getEnd(e)||M!==h)&&(this.updateLatexMathEfficiently(h,M)||this.renderLatexMathFromScratch(h),this.updateMathspeak()),m.insAtRightEnd(v)},f.prototype.renderLatexText=function(h){var m,v=this.root,M=this.cursor;v.domFrag().children().slice(1).remove(),v.setEnds((m={},m[t]=0,m[e]=0,m)),delete M.selection,M.show().insAtRightEnd(v);var B=ht.regex,j=ht.string,ee=ht.eof,ce=ht.all,Ue=j("$").then(rr).skip(j("$").or(ee)).map(function(ut){var Pt=new RootMathCommand(M);Pt.createBlocks();var Wr=Pt.getEnd(t);return ut.children().adopt(Wr,0,0),Pt}),Me=j("\\$").result("$"),ke=Me.or(B(/^[^$]/)).map(function(ut){return new Ll(ut)}),Je=Ue.or(ke).many(),Ye=Je.skip(ee).or(ce.result(!1)).parse(h);if(Ye){for(var at=0;at<Ye.length;at+=1)Ye[at].adopt(v,v.getEnd(e),0);L(v.html()).appendTo(v.domFrag().oneElement()),v.finalizeInsert(M.options,M)}},f}(Gr),Et=function(D){return!1};Se.prototype.ignoreNextMousedown=Et;var It;(function(){pe.onNotify(function(D,f){(f==="edit"||f==="replace")&&It&&It.cursor===D&&It.cb()})})();var Ve=function(D){pt(f,D);function f(){var h=D!==null&&D.apply(this,arguments)||this;return h.handleMouseDown=function(m){var v=d(m.target,".dcg-mq-root-block"),M=v&&R.getNodeOfElement(v)||R.getNodeOfElement(h.root.domFrag().oneElement()),B=M.domFrag().firstNode().ownerDocument,j=M.controller,ee=j.cursor,ce=ee.blink,Ue=j.getTextareaSpanOrThrow(),Me=j.getTextareaOrThrow();if(m.preventDefault(),m.target.unselectable=!0,ee.options.ignoreNextMousedown(m)||(ee.options.ignoreNextMousedown=Et,d(m.target,".dcg-mq-ignore-mousedown")))return;var ke=null;function Je(Sn){ke=Sn.target}function Ye(Sn){ee.anticursor||ee.startSelection(),j.seek(ke,Sn.clientX,Sn.clientY).cursor.select(),ee.selection&&ee.controller.aria.clear().queue(ee.selection.join("mathspeak")+" selected").alert(),ke=null}function at(){v==null||v.removeEventListener("mousemove",Je),B==null||B.removeEventListener("mousemove",Ye),B==null||B.removeEventListener("mouseup",Pt),It=void 0}function ut(){j.editable?(ee.show(),ee.controller.aria.queue(ee.parent).alert()):L(Ue).detach()}function Pt(){ee.blink=ce,ee.selection||ut(),at()}var Wr;It={cursor:ee,cb:function(){Wr=!0,ee.blink=ce,ee.clearSelection(),ut(),at()}},!(j.blurred&&(v&&!j.editable&&L(v).prepend(L(Ue)),Me.focus(),Wr))&&(ee.blink=n,j.seek(m.target,m.clientX,m.clientY).cursor.startSelection(),v==null||v.addEventListener("mousemove",Je),B==null||B.addEventListener("mousemove",Ye),B==null||B.addEventListener("mouseup",Pt))},h}return f.prototype.addMouseEventListener=function(){this.container.addEventListener("mousedown",this.handleMouseDown)},f.prototype.removeMouseEventListener=function(){this.container.removeEventListener("mousedown",this.handleMouseDown)},f.prototype.seek=function(h,m,v){for(var M=this.notify("select").cursor,B;h&&(B=R.getNodeOfElement(h),!B);)h=h.parentElement;return B||(B=this.root),M.clearSelection().show(),B.seek(m,M),this.scrollHoriz(),this},f}(ve),ni=function(D){pt(f,D);function f(){return D!==null&&D.apply(this,arguments)||this}return f.prototype.setOverflowClasses=function(){var h=this.root.domFrag().oneElement(),m=!1,v=!1;if(!this.blurred){var M=k(h).width,B=h.scrollWidth,j=h.scrollLeft;m=B>M+j,v=j>0}h.classList.contains("dcg-mq-editing-overflow-right")!==m&&h.classList.toggle("dcg-mq-editing-overflow-right"),h.classList.contains("dcg-mq-editing-overflow-left")!==v&&h.classList.toggle("dcg-mq-editing-overflow-left")},f.prototype.scrollHoriz=function(){var h=this,m=this.cursor,v=m.selection,M=k(this.root.domFrag().oneElement());if(m.domFrag().isEmpty()&&!v){this.cancelScrollHoriz&&(this.cancelScrollHoriz(),this.cancelScrollHoriz=void 0);var B=this.root.domFrag().oneElement(),j=B.scrollLeft;V(this.getScrollAnimationDuration(),function(ut,Pt,Wr){ut>=1?(h.cancelScrollHoriz=void 0,B.scrollLeft=0,h.setOverflowClasses()):(h.cancelScrollHoriz=Wr,Pt(),B.scrollLeft=Math.round((1-ut)*j))});return}else if(v){var Ue=k(v.domFrag().oneElement()),Me=Ue.left-(M.left+20),ke=Ue.right-(M.right-20);if(v.getEnd(t)===m[e])if(Me<0)var ce=Me;else if(ke>0)if(Ue.left-ke<M.left+20)var ce=Me;else var ce=ke;else return;else if(ke>0)var ce=ke;else if(Me<0)if(Ue.right-Me>M.right-20)var ce=ke;else var ce=Me;else return}else{var ee=k(m.domFrag().oneElement()).left;if(ee>M.right-20)var ce=ee-(M.right-20);else if(ee<M.left+20)var ce=ee-(M.left+20);else return}var Je=this.root.domFrag().oneElement();if(!(ce<0&&Je.scrollLeft===0)&&!(ce>0&&Je.scrollWidth<=Je.scrollLeft+M.width)){this.cancelScrollHoriz&&(this.cancelScrollHoriz(),this.cancelScrollHoriz=void 0);var Ye=this.root.domFrag().oneElement(),at=Ye.scrollLeft;V(this.getScrollAnimationDuration(),function(ut,Pt,Wr){ut>=1?(h.cancelScrollHoriz=void 0,Ye.scrollLeft=Math.round(at+ce),h.setOverflowClasses()):(h.cancelScrollHoriz=Wr,Pt(),Ye.scrollLeft=Math.round(at+ut*ce))})}},f.prototype.getScrollAnimationDuration=function(){var h;return(h=this.options.scrollAnimationDuration)!==null&&h!==void 0?h:100},f}(Ve);Se.prototype.substituteTextarea=function(){return c("textarea",{autocapitalize:"off",autocomplete:"off",autocorrect:"off",spellcheck:!1,"x-palm-disable-ste-all":!0})};function rt(D,f){return bo(D[0],f)}Se.prototype.substituteKeyboardEvents=rt;var ta=function(D){pt(f,D);function f(){var h=D!==null&&D.apply(this,arguments)||this;return h.selectFn=n,h}return f.prototype.createTextarea=function(){this.textareaSpan=c("span",{class:"dcg-mq-textarea"});var h=this.options.substituteTextarea();if(!h.nodeType)throw"substituteTextarea() must return a DOM element, got "+h;this.textarea=L(h).appendTo(this.textareaSpan).oneElement();var m=this;m.cursor.selectionChanged=function(){m.selectionChanged()}},f.prototype.selectionChanged=function(){var h=this;h.textareaSelectionTimeout||(h.textareaSelectionTimeout=setTimeout(function(){h.setTextareaSelection()}))},f.prototype.setTextareaSelection=function(){this.textareaSelectionTimeout=0;var h="";this.cursor.selection&&(h=this.cleanLatex(this.cursor.selection.join("latex")),this.options.statelessClipboard&&(h="$"+h+"$")),this.selectFn(h)},f.prototype.staticMathTextareaEvents=function(){var h=this;this.removeTextareaEventListener("cut"),this.removeTextareaEventListener("paste"),h.options.disableCopyPaste?this.removeTextareaEventListener("copy"):this.addTextareaEventListeners({copy:function(){h.setTextareaSelection()}}),this.addStaticFocusBlurListeners(),h.selectFn=function(m){var v=h.getTextareaOrThrow();v instanceof HTMLTextAreaElement&&(v.value=m,m&&v.select())}},f.prototype.editablesTextareaEvents=function(){var h=this,m=h.getTextareaOrThrow(),v=h.getTextareaSpanOrThrow();if(this.options.version<3){var M=this.options.assertJquery(),B=this.options.substituteKeyboardEvents(M(m),this);this.selectFn=function(ee){B.select(ee)}}else{var j=bo(m,this).select;this.selectFn=j}L(this.container).prepend(L(v)),this.addEditableFocusBlurListeners(),this.updateMathspeak()},f.prototype.unbindEditablesEvents=function(){var h=this,m=h.getTextareaOrThrow(),v=h.getTextareaSpanOrThrow();this.selectFn=function(M){m instanceof HTMLTextAreaElement&&(m.value=M,M&&m.select())},L(v).remove(),this.removeTextareaEventListener("focus"),this.removeTextareaEventListener("blur"),h.blurred=!0,this.removeTextareaEventListener("cut"),this.removeTextareaEventListener("paste")},f.prototype.typedText=function(h){if(h===`
`)return this.handle("enter");var m=this.notify(void 0).cursor;m.parent.write(m,h),this.scrollHoriz()},f.prototype.cut=function(){var h=this,m=h.cursor;m.selection&&setTimeout(function(){h.notify("edit"),m.parent.bubble(function(v){v.reflow()}),h.options&&h.options.onCut&&h.options.onCut()})},f.prototype.copy=function(){this.setTextareaSelection()},f.prototype.paste=function(h){this.options.statelessClipboard&&(h.slice(0,1)==="$"&&h.slice(-1)==="$"?h=h.slice(1,-1):h="\\text{"+h+"}"),this.writeLatex(h).cursor.show(),this.scrollHoriz(),this.options&&this.options.onPaste&&this.options.onPaste()},f.prototype.setupStaticField=function(){this.mathspeakSpan=c("span",{class:"dcg-mq-mathspeak"}),L(this.container).prepend(L(this.mathspeakSpan)),this.updateMathspeak(),this.blurred=!0,this.cursor.hide().parent.blur(this.cursor)},f.prototype.updateMathspeak=function(){var h=this,m=h.getAriaLabel(),v=/[A-Za-z0-9]$/.test(m)?m+":":m,M=h.root.mathspeak().trim();this.aria.clear();var B=h.getTextareaOrThrow();h.mathspeakSpan?(B.setAttribute("aria-label",""),h.mathspeakSpan.textContent=(v+" "+M).trim()):B.setAttribute("aria-label",(v+" "+M+" "+h.ariaPostLabel).trim())},f}(ni),_t=function(D){pt(f,D);function f(){return D!==null&&D.apply(this,arguments)||this}return f.prototype.finalizeInsert=function(h,m){var v=this;v.postOrder(function(j){j.finalizeTree(h)}),v.postOrder(function(j){j.contactWeld(m)}),v.postOrder(function(j){j.blur(m)}),v.postOrder(function(j){j.reflow()});var M=v[e],B=v[t];M&&M.siblingCreated(h,t),B&&B.siblingCreated(h,e),v.bubble(function(j){j.reflow()})},f.prototype.prepareInsertionAt=function(h){var m=h.options.maxDepth;if(m!==void 0){var v=h.depth();if(v>m)return!1;this.removeNodesDeeperThan(m-v)}return!0},f.prototype.removeNodesDeeperThan=function(h){for(var m=0,v=[[this,m]],M;M=v.shift();){var B=M;B[0].children().each(function(j){var ee=j instanceof Hi?1:0;m=B[1]+ee,m<=h?v.push([j,m]):(ee?j.children():j).remove()})}},f}(le),Mr=function(){function D(f,h){this.childCount=f,this.render=h}return D}(),Ci=function(D){pt(f,D);function f(h,m,v){var M=D.call(this)||this;return M.textTemplate=[""],M.mathspeakTemplate=[""],M.setCtrlSeqHtmlAndText(h,m,v),M}return f.prototype.setEnds=function(h){o("MathCommand ends are never empty",h[t]&&h[e]),this.ends=h},f.prototype.getEnd=function(h){return this.ends[h]},f.prototype.setCtrlSeqHtmlAndText=function(h,m,v){this.ctrlSeq||(this.ctrlSeq=h),m&&(this.domView=m),v&&(this.textTemplate=v)},f.prototype.replaces=function(h){h.disown(),this.replacedFragment=h},f.prototype.isEmpty=function(){return this.foldChildren(!0,function(h,m){return h&&m.isEmpty()})},f.prototype.parser=function(){var h=this,m=rr.block;return m.times(this.numBlocks()).map(function(v){h.blocks=v;for(var M=0;M<v.length;M+=1)v[M].adopt(h,h.getEnd(e),0);return h})},f.prototype.createLeftOf=function(h){var m=this,v=m.replacedFragment;if(m.createBlocks(),D.prototype.createLeftOf.call(this,h),v){var M=m.getEnd(t);v.adopt(M,0,0),v.domFrag().appendTo(M.domFrag().oneElement()),m.placeCursor(h),m.prepareInsertionAt(h)}m.finalizeInsert(h.options,h),m.placeCursor(h)},f.prototype.createBlocks=function(){for(var h=this,m=h.numBlocks(),v=h.blocks=Array(m),M=0;M<m;M+=1){var B=v[M]=new Hi;B.adopt(h,h.getEnd(e),0)}},f.prototype.placeCursor=function(h){h.insAtRightEnd(this.foldChildren(this.getEnd(t),function(m,v){return m.isEmpty()?m:v}))},f.prototype.moveTowards=function(h,m,v){var M;v==="up"?M=this.upInto:v==="down"&&(M=this.downInto);var B=M||this.getEnd(-h);m.insAtDirEnd(-h,B),m.controller.aria.queueDirEndOf(-h).queue(m.parent,!0)},f.prototype.deleteTowards=function(h,m){this.isEmpty()?m[h]=this.remove()[h]:this.moveTowards(h,m)},f.prototype.selectTowards=function(h,m){m[-h]=this,m[h]=this[h]},f.prototype.selectChildren=function(){return new Le(this,this)},f.prototype.unselectInto=function(h,m){var v=m.anticursor,M=v.ancestors[this.id];m.insAtDirEnd(-h,M)},f.prototype.seek=function(h,m){function v(ee){var ce,Ue=ee.domFrag().oneElement(),Me=k(Ue).left,ke=Me+Ue.offsetWidth;return ce={},ce[t]=Me,ce[e]=ke,ce}var M=this,B=v(M);if(h<B[t])return m.insLeftOf(M);if(h>B[e])return m.insRightOf(M);var j=B[t];M.eachChild(function(ee){var ce=v(ee);if(h<ce[t])return h-j<ce[t]-h?ee[t]?m.insAtRightEnd(ee[t]):m.insLeftOf(M):m.insAtLeftEnd(ee),!1;if(h>ce[e]){ee[e]?j=ce[e]:B[e]-h<h-ce[e]?m.insRightOf(M):m.insAtRightEnd(ee);return}else return ee.seek(h,m),!1})},f.prototype.numBlocks=function(){return this.domView.childCount},f.prototype.html=function(){var h=this.blocks;o("domView is defined",this.domView);var m=this.domView,v=m.render(h||[]);return this.setDOM(v),R.linkElementByCmdNode(v,this),v},f.prototype.latexRecursive=function(h){this.checkCursorContextOpen(h),h.latex+=this.ctrlSeq||"",this.eachChild(function(m){h.latex+="{";var v=h.latex.length;m.latexRecursive(h);var M=h.latex.length;v===M&&(h.latex+=" "),h.latex+="}"}),this.checkCursorContextClose(h)},f.prototype.text=function(){var h=this,m=0;return h.foldChildren(h.textTemplate[m],function(v,M){m+=1;var B=M.text();return v&&h.textTemplate[m]==="("&&B[0]==="("&&B.slice(-1)===")"?v+B.slice(1,-1)+h.textTemplate[m]:v+B+(h.textTemplate[m]||"")})},f.prototype.mathspeak=function(){var h=this,m=0;return h.foldChildren(h.mathspeakTemplate[m]||"Start"+h.ctrlSeq+" ",function(v,M){return m+=1,v+" "+M.mathspeak()+" "+(h.mathspeakTemplate[m]+" "||"End"+h.ctrlSeq+" ")})},f}(_t),gn=function(D){pt(f,D);function f(h,m,v,M){var B=D.call(this)||this;return B.setCtrlSeqHtmlTextAndMathspeak(h,m?new Mr(0,function(){return m.cloneNode(!0)}):void 0,v,M),B}return f.prototype.setCtrlSeqHtmlTextAndMathspeak=function(h,m,v,M){!v&&h&&(v=h.replace(/^\\/,"")),this.mathspeakName=M||v,D.prototype.setCtrlSeqHtmlAndText.call(this,h,m,[v||""])},f.prototype.parser=function(){return ht.succeed(this)},f.prototype.numBlocks=function(){return 0},f.prototype.replaces=function(h){h.remove()},f.prototype.createBlocks=function(){},f.prototype.moveTowards=function(h,m){m.domFrag().insDirOf(h,this.domFrag()),m[-h]=this,m[h]=this[h],m.controller.aria.queue(this)},f.prototype.deleteTowards=function(h,m){m[h]=this.remove()[h]},f.prototype.seek=function(h,m){var v=this.domFrag().oneElement(),M=k(v).left;return h-M<v.offsetWidth/2?m.insLeftOf(this):m.insRightOf(this),m},f.prototype.latexRecursive=function(h){this.checkCursorContextOpen(h),h.latex+=this.ctrlSeq||"",this.checkCursorContextClose(h)},f.prototype.text=function(){return this.textTemplate.join("")},f.prototype.mathspeak=function(h){return this.mathspeakName||""},f.prototype.placeCursor=function(){},f.prototype.isEmpty=function(){return!0},f}(Ci),Ll=function(D){pt(f,D);function f(h,m,v){return D.call(this,h,c("span",{},[m||c.text(h)]),void 0,v)||this}return f}(gn);function wo(D,f,h){return function(){return new Ll(D,f?c.entityText(f):void 0,h)}}var ro=function(D){pt(f,D);function f(h,m,v,M,B){var j=this;return B?j=D.call(this,h,c("span",{},[m||c.text(h||"")]),void 0,M)||this:j=D.call(this,h,c("span",{class:"dcg-mq-binary-operator"},m?[m]:[]),v,M)||this,j}return f}(gn);function nr(D,f,h,m){return function(){return new ro(D,f?c.entityText(f):void 0,h,m)}}var Hi=function(D){pt(f,D);function f(){var h=D!==null&&D.apply(this,arguments)||this;return h.ariaLabel="block",h}return f.prototype.join=function(h){return this.foldChildren("",function(m,v){return m+v[h]()})},f.prototype.html=function(){var h=document.createDocumentFragment();return this.eachChild(function(m){var v=m.html();h.appendChild(v)}),h},f.prototype.latexRecursive=function(h){this.checkCursorContextOpen(h),this.eachChild(function(m){return m.latexRecursive(h)}),this.checkCursorContextClose(h)},f.prototype.text=function(){var h=this.getEnd(t),m=this.getEnd(e);return h===m&&h!==0?h.text():this.join("text")},f.prototype.mathspeak=function(){var h="",m={};return this.controller&&(m=this.controller.options.autoOperatorNames),this.foldChildren([],function(v,M){if(M.isPartOfOperator)h+=M.mathspeak();else{if(h!==""){if(m._maxLength>0){var B=m[h.toLowerCase()];typeof B=="string"&&(h=B)}v.push(h+" "),h=""}var j=M.mathspeak(),ee=M.ctrlSeq;isNaN(ee)&&ee!=="."&&(!M.parent||!M.parent.parent||!M.parent.parent.isTextBlock())&&(j=" "+j+" "),v.push(j)}return v}).join("").replace(/ +(?= )/g,"").replace(/(\.)([0-9]+)/g,function(v,M,B){return M+B.split("").join(" ").trim()})},f.prototype.keystroke=function(h,m,v){if(v.options.spaceBehavesLikeTab&&(h==="Spacebar"||h==="Shift-Spacebar")){m==null||m.preventDefault(),v.escapeDir(h==="Shift-Spacebar"?t:e,h,m);return}return D.prototype.keystroke.call(this,h,m,v)},f.prototype.moveOutOf=function(h,m,v){var M;if(v==="up"?M=this.parent.upInto:v==="down"&&(M=this.parent.downInto),!M&&this[h]){var B=-h;m.insAtDirEnd(B,this[h]),m.controller.aria.queueDirEndOf(B).queue(m.parent,!0)}else m.insDirOf(h,this.parent),m.controller.aria.queueDirOf(h).queue(this.parent)},f.prototype.selectOutOf=function(h,m){m.insDirOf(h,this.parent)},f.prototype.deleteOutOf=function(h,m){m.unwrapGramp()},f.prototype.seek=function(h,m){var v=this.getEnd(e);if(!v)return m.insAtRightEnd(this);var M=v.domFrag().oneElement(),B=k(M).left;if(B+M.offsetWidth<h)return m.insAtRightEnd(this);var j=this.getEnd(t);if(h<k(j.domFrag().oneElement()).left)return m.insAtLeftEnd(this);for(;h<k(v.domFrag().oneElement()).left;)v=v[t];return v.seek(h,m)},f.prototype.chToCmd=function(h,m){var v;return h.match(/^[a-eg-zA-Z]$/)?new ue(h):/^\d$/.test(h)?new re(h):m&&m.typingSlashWritesDivisionSymbol&&h==="/"?A["\xF7"](h):m&&m.typingAsteriskWritesTimesSymbol&&h==="*"?A["\xD7"](h):m&&m.typingPercentWritesPercentOf&&h==="%"?A.percentof(h):(v=z[h]||A[h])?v.constructor?new v(h):v(h):new Ll(h)},f.prototype.write=function(h,m){var v=this.chToCmd(m,h.options);h.selection&&v.replaces(h.replaceSelection()),h.isTooDeep()||(v.createLeftOf(h.show()),m==="/"?h.controller.aria.alert("over"):h.controller.aria.alert(v.mathspeak({createdLeftOf:h})))},f.prototype.writeLatex=function(h,m){var v=ht.all,M=ht.eof,B=rr.skip(M).or(v.result(!1)).parse(m);if(B&&!B.isEmpty()&&B.prepareInsertionAt(h)){B.children().adopt(h.parent,h[t],h[e]),L(B.html()).insertBefore(h.domFrag()),h[t]=B.getEnd(e),B.finalizeInsert(h.options,h);var j=B.getEnd(e),ee=B.getEnd(t),ce=j[e],Ue=ee[t];ce&&ce.siblingCreated(h.options,t),Ue&&Ue.siblingCreated(h.options,e),h.parent.bubble(function(Me){Me.reflow()})}},f.prototype.focus=function(){return this.domFrag().addClass("dcg-mq-hasCursor"),this.domFrag().removeClass("dcg-mq-empty"),this},f.prototype.blur=function(h){return this.domFrag().removeClass("dcg-mq-hasCursor"),this.isEmpty()&&(this.domFrag().addClass("dcg-mq-empty"),h&&this.isQuietEmptyDelimiter(h.options.quietEmptyDelimiters)&&this.domFrag().addClass("dcg-mq-quiet-delimiter")),this},f}(_t);Se.prototype.mouseEvents=!0,ae.StaticMath=function(D){var f;return f=function(h){pt(m,h);function m(v){var M=h.call(this,v)||this,B=M.innerFields=[];return M.__controller.root.postOrder(function(j){j.registerInnerField(B,D.InnerMathField)}),M}return m.prototype.__mathquillify=function(v,M){return this.config(v),h.prototype.mathquillify.call(this,"dcg-mq-math-mode"),this.__controller.setupStaticField(),this.__options.mouseEvents&&(this.__controller.addMouseEventListener(),this.__controller.staticMathTextareaEvents()),this},m.prototype.latex=function(v){var M=h.prototype.latex.apply(this,arguments);if(arguments.length>0){var B=this.innerFields=[];this.__controller.root.postOrder(function(j){j.registerInnerField(B,D.InnerMathField)}),this.__controller.updateMathspeak()}return M},m.prototype.setAriaLabel=function(v){return this.__controller.setAriaLabel(v),this},m.prototype.getAriaLabel=function(){return this.__controller.getAriaLabel()},m}(D.AbstractMathQuill),f.RootBlock=Hi,f};var N=function(D){pt(f,D);function f(){return D!==null&&D.apply(this,arguments)||this}return f}(Hi);Ge(N.prototype),ae.MathField=function(D){var f;return f=function(h){pt(m,h);function m(){return h!==null&&h.apply(this,arguments)||this}return m.prototype.__mathquillify=function(v,M){return this.config(v),M>1&&(this.__controller.root.reflow=n),h.prototype.mathquillify.call(this,"dcg-mq-editable-field dcg-mq-math-mode"),delete this.__controller.root.reflow,this},m}(D.EditableField),f.RootBlock=N,f},ae.InnerMathField=function(D){return o("MathField class is defined",D.MathField),function(f){pt(h,f);function h(){return f!==null&&f.apply(this,arguments)||this}return h.prototype.makeStatic=function(){this.__controller.editable=!1,this.__controller.root.blur(),this.__controller.unbindEditablesEvents(),L(this.__controller.container).removeClass("dcg-mq-editable-field")},h.prototype.makeEditable=function(){this.__controller.editable=!0,this.__controller.editablesTextareaEvents(),this.__controller.cursor.insAtRightEnd(this.__controller.root),L(this.__controller.container).addClass("dcg-mq-editable-field")},h}(D.MathField)};var W=function(D){pt(f,D);function f(){return D!==null&&D.apply(this,arguments)||this}return f.prototype.finalizeTree=function(h,m){this.sharedSiblingMethod(h,m)},f.prototype.siblingDeleted=function(h,m){this.sharedSiblingMethod(h,m)},f.prototype.siblingCreated=function(h,m){this.sharedSiblingMethod(h,m)},f.prototype.sharedSiblingMethod=function(h,m){m!==t&&this[e]instanceof f||this.fixDigitGrouping(h)},f.prototype.fixDigitGrouping=function(h){if(h.enableDigitGrouping){var m=this,v=this,M=0,B=[],j="\\ ",ee=".",ce=m;do if(/^[0-9]$/.test(ce.ctrlSeq))m=ce;else if(ce.ctrlSeq===j)m=ce,M+=1;else if(ce.ctrlSeq===ee)m=ce,B.push(ce);else break;while(ce=m[t]);for(;ce=v[e];)if(/^[0-9]$/.test(ce.ctrlSeq))v=ce;else if(ce.ctrlSeq===j)v=ce,M+=1;else if(ce.ctrlSeq===ee)v=ce,B.push(ce);else break;for(;v!==m&&m&&m.ctrlSeq===j;)m=m[e],M-=1;for(;v!==m&&v&&v.ctrlSeq===j;)v=v[t],M-=1;if(!(m===v&&m&&m.ctrlSeq===j)){var Ue=M>0||B.length>1;Ue?this.removeGroupingBetween(m,v):B[0]?(B[0]!==m&&this.addGroupingBetween(B[0][t],m),B[0]!==v&&this.removeGroupingBetween(B[0][e],v)):this.addGroupingBetween(v,m)}}},f.prototype.removeGroupingBetween=function(h,m){var v=h;do if(v instanceof f&&v.setGroupingClass(void 0),!v||v===m)break;while(v=v[e])},f.prototype.addGroupingBetween=function(h,m){for(var j=h,v=0,M=0,j=h;j&&(M+=1,j!==m);)j=j[t];var B=M%3;B===0&&(B=3);for(var j=h;j;){v+=1;var ee=void 0;if(M>=4&&(v===M?ee="dcg-mq-group-leading-"+B:v%3===0&&v!==M&&(ee="dcg-mq-group-start"),ee||(ee="dcg-mq-group-other")),j instanceof f&&j.setGroupingClass(ee),j===m)break;j=j[t]}},f.prototype.setGroupingClass=function(h){this._groupingClass!==h&&(this._groupingClass&&this.domFrag().removeClass(this._groupingClass),h&&this.domFrag().addClass(h),this._groupingClass=h)},f}(gn),re=function(D){pt(f,D);function f(h,m){return D.call(this,h,c("span",{class:"dcg-mq-digit"},[c.text(h)]),void 0,m)||this}return f.prototype.createLeftOf=function(h){var m=h[t],v=m&&m[t],M=h.parent.parent instanceof Ol?h.parent.parent.sub:void 0;h.options.autoSubscriptNumerals&&h.parent!==M&&(m instanceof be&&m.isItalic!==!1||m instanceof Ol&&v instanceof be&&v.isItalic!==!1)?(new j0().createLeftOf(h),D.prototype.createLeftOf.call(this,h),h.insRightOf(h.parent.parent)):D.prototype.createLeftOf.call(this,h)},f.prototype.mathspeak=function(h){if(h&&h.createdLeftOf){var m=h.createdLeftOf,v=m[t],M=v&&v[t],B=m.parent.parent instanceof Ol?m.parent.parent.sub:void 0;if(m.options.autoSubscriptNumerals&&m.parent!==B&&(v instanceof be&&v.isItalic!==!1||m[t]instanceof Ol&&M instanceof be&&M.isItalic!==!1))return"Subscript "+D.prototype.mathspeak.call(this)+" Baseline"}return D.prototype.mathspeak.call(this)},f}(W),be=function(D){pt(f,D);function f(h,m){return D.call(this,h,c("var",{},[m||c.text(h)]))||this}return f.prototype.text=function(){var h=this.ctrlSeq||"";return this.isPartOfOperator?h[0]=="\\"?h=h.slice(1,h.length):h[h.length-1]==" "&&(h=h.slice(0,-1)):(this[t]&&!(this[t]instanceof f)&&!(this[t]instanceof ro)&&this[t].ctrlSeq!=="\\ "&&(h="*"+h),this[e]&&!(this[e]instanceof ro)&&!(this[e]instanceof Ol)&&(h+="*")),h},f.prototype.mathspeak=function(){var h=this.ctrlSeq||"";return this.isPartOfOperator||h.length>1||this.parent&&this.parent.parent&&this.parent.parent.isTextBlock()?D.prototype.mathspeak.call(this):'"'+h+'"'},f}(gn);function se(D,f,h){return function(){return new be(D,c.entityText(f))}}Se.prototype.autoCommands={_maxLength:0},ge.autoCommands=function(D){if(typeof D!="string"||!/^[a-z]+(?: [a-z]+)*$/i.test(D))throw'"'+D+'" not a space-delimited list of only letters';for(var f=D.split(" "),h={},m=0,v=0;v<f.length;v+=1){var M=f[v];if(M.length<2)throw'autocommand "'+M+'" not minimum length of 2';if(A[M]===kt)throw'"'+M+'" is a built-in operator name';h[M]=1,m=i(m,M.length)}return h._maxLength=m,h},Se.prototype.quietEmptyDelimiters={},ge.quietEmptyDelimiters=function(D){D===void 0&&(D="");for(var f=D.split(" "),h={},m=0;m<f.length;m+=1){var v=f[m];h[v]=1}return h},Se.prototype.autoParenthesizedFunctions={_maxLength:0},ge.autoParenthesizedFunctions=function(D){if(typeof D!="string"||!/^[a-z]+(?: [a-z]+)*$/i.test(D))throw'"'+D+'" not a space-delimited list of only letters';for(var f=D.split(" "),h={},m=0,v=0;v<f.length;v+=1){var M=f[v];if(M.length<2)throw'autocommand "'+M+'" not minimum length of 2';h[M]=1,m=i(m,M.length)}return h._maxLength=m,h};var ue=function(D){pt(f,D);function f(h){var m=D.call(this,h)||this;return m.letter=h,m}return f.prototype.checkAutoCmds=function(h){if(!this.shouldIgnoreSubstitutionInSimpleSubscript(h.options)){var m=h.options.autoCommands,v=m._maxLength||0;if(v>0){for(var M="",B=this,j=0;B instanceof f&&B.ctrlSeq===B.letter&&j<v;)M=B.letter+M,B=B[t],j+=1;for(;M.length;){if(m.hasOwnProperty(M)){for(B=this,j=1;B&&j<M.length;j+=1,B=B[t]);new _(B,this).remove(),h[t]=B[t];var ee=A[M],ce;return Q(ee)?ce=new ee(M):ce=ee(M),ce.createLeftOf(h)}M=M.slice(1)}}}},f.prototype.autoParenthesize=function(h){var m=h.parent.getEnd(e);if(!(m&&m instanceof _l&&m.ctrlSeq==="\\left(")&&!this.shouldIgnoreSubstitutionInSimpleSubscript(h.options)){for(var v="",M=this,B=0,j=h.options.autoParenthesizedFunctions,ee=j._maxLength||0,ce=h.options.autoOperatorNames;M instanceof f&&B<ee;)v=M.letter+v,M=M[t],B+=1;for(;v.length;){if(j.hasOwnProperty(v)&&ce.hasOwnProperty(v))return h.parent.write(h,"(");v=v.slice(1)}}},f.prototype.createLeftOf=function(h){D.prototype.createLeftOf.call(this,h),this.checkAutoCmds(h),this.autoParenthesize(h)},f.prototype.italicize=function(h){return this.isItalic=h,this.isPartOfOperator=!h,this.domFrag().toggleClass("dcg-mq-operator-name",!h),this},f.prototype.finalizeTree=function(h,m){this.sharedSiblingMethod(h,m)},f.prototype.siblingDeleted=function(h,m){this.sharedSiblingMethod(h,m)},f.prototype.siblingCreated=function(h,m){this.sharedSiblingMethod(h,m)},f.prototype.sharedSiblingMethod=function(h,m){m!==t&&this[e]instanceof f||this.autoUnItalicize(h)},f.prototype.autoUnItalicize=function(h){var m=h.autoOperatorNames;if(m._maxLength!==0&&!this.shouldIgnoreSubstitutionInSimpleSubscript(h)){for(var v=this.letter,M=this[t];M instanceof f;M=M[t])v=M.letter+v;for(var B=this[e];B instanceof f;B=B[e])v+=B.letter;var j=M&&M[e],ee=B&&B[t];new _(j||this.parent.getEnd(t),ee||this.parent.getEnd(e)).each(function(rl){rl instanceof f&&(rl.italicize(!0).domFrag().removeClass("dcg-mq-first dcg-mq-last dcg-mq-followed-by-supsub"),rl.ctrlSeq=rl.letter)});var ce=m._maxLength||0;e:for(var Ue=0,Me=M[e]||this.parent.getEnd(t);Me&&Ue<v.length;Ue+=1,Me=Me[e])for(var ke=r(ce,v.length-Ue);ke>0;ke-=1){var Je=v.slice(Ue,Ue+ke),Ye=void 0;if(m.hasOwnProperty(Je)){for(var at=0,ut=Me;at<ke;at+=1,ut=ut[e])ut instanceof f&&(ut.italicize(!1),Ye=ut);var Pt=De.hasOwnProperty(Je);if(Me.ctrlSeq=(Pt?"\\":"\\operatorname{")+Me.ctrlSeq,Ye.ctrlSeq+=Pt?" ":"}",ze.hasOwnProperty(Je)){var Wr=Ye[t],Sn=Wr&&Wr[t],Xr=Sn&&Sn[t];Xr.domFrag().addClass("dcg-mq-last")}if(this.shouldOmitPadding(Me[t])||Me.domFrag().addClass("dcg-mq-first"),!this.shouldOmitPadding(Ye[e]))if(Ye[e]instanceof Ol){var Rn=Ye[e],Va=Rn.siblingCreated=Rn.siblingDeleted=function(){Rn.domFrag().toggleClass("dcg-mq-after-operator-name",!(Rn[e]instanceof _l))};Va()}else Ye.domFrag().toggleClass("dcg-mq-last",!(Ye[e]instanceof _l));Ue+=ke-1,Me=Ye;continue e}}}},f.prototype.shouldOmitPadding=function(h){return!h||h.ctrlSeq==="."||h instanceof ro||h instanceof wp},f}(be),De={};Se.prototype.autoOperatorNames=$e();var ze={limsup:1,liminf:1,projlim:1,injlim:1};function $e(){for(var D={_maxLength:9},f="arg deg det dim exp gcd hom inf ker lg lim ln log max min sup limsup liminf injlim projlim Pr".split(" "),h=0;h<f.length;h+=1)De[f[h]]=D[f[h]]=1;for(var m="sin cos tan arcsin arccos arctan sinh cosh tanh sec csc cot coth".split(" "),h=0;h<m.length;h+=1)De[m[h]]=1;for(var v="sin cos tan sec cosec csc cotan cot ctg".split(" "),h=0;h<v.length;h+=1)D[v[h]]=D["arc"+v[h]]=D[v[h]+"h"]=D["ar"+v[h]+"h"]=D["arc"+v[h]+"h"]=1;for(var M="gcf hcf lcm proj span".split(" "),h=0;h<M.length;h+=1)D[M[h]]=1;return D}ge.autoOperatorNames=function(D){if(typeof D!="string")throw'"'+D+'" not a space-delimited list';if(!/^[a-z\|\-]+(?: [a-z\|\-]+)*$/i.test(D))throw'"'+D+'" not a space-delimited list of letters or "|"';for(var f=D.split(" "),h={},m=0,v=0;v<f.length;v+=1){var M=f[v];if(M.length<2)throw'"'+M+'" not minimum length of 2';if(M.indexOf("|")<0)h[M]=M,m=i(m,M.length);else{var B=M.split("|");if(B.length>2)throw'"'+M+'" has more than 1 mathspeak delimiter';if(B[0].length<2)throw'"'+M[0]+'" not minimum length of 2';h[B[0]]=B[1].replace(/-/g," "),m=i(m,B[0].length)}}return h._maxLength=m,h};var kt=function(D){pt(f,D);function f(h){return D.call(this,h||"")||this}return f.prototype.createLeftOf=function(h){for(var m=this.ctrlSeq,v=0;v<m.length;v+=1)new ue(m.charAt(v)).createLeftOf(h)},f.prototype.parser=function(){for(var h=this.ctrlSeq,m=new Hi,v=0;v<h.length;v+=1)new ue(h.charAt(v)).adopt(m,m.getEnd(e),0);return ht.succeed(m.children())},f}(gn);for(var ct in Se.prototype.autoOperatorNames)Se.prototype.autoOperatorNames.hasOwnProperty(ct)&&(A[ct]=kt);A.operatorname=function(D){pt(f,D);function f(){return D!==null&&D.apply(this,arguments)||this}return f.prototype.createLeftOf=function(){},f.prototype.numBlocks=function(){return 1},f.prototype.parser=function(){return rr.block.map(function(h){var m=!0,v="",M=h.children();return M.each(function(B){B instanceof ue?v+=B.letter:m=!1}),m&&v==="ans"?J0():M})},f}(Ci),A.f=function(D){pt(f,D);function f(){var h=this,m="f";return h=D.call(this,m)||this,h.letter=m,h.domView=new Mr(0,function(){return c("var",{class:"dcg-mq-f"},[c.text("f")])}),h}return f.prototype.italicize=function(h){return this.domFrag().eachElement(function(m){return m.textContent="f"}),this.domFrag().toggleClass("dcg-mq-f",h),D.prototype.italicize.call(this,h)},f}(ue),A[" "]=A.space=function(){return new W("\\ ",c("span",{},[c.text(u)])," ")},A["."]=function(){return new W(".",c("span",{class:"dcg-mq-digit"},[c.text(".")]),".")},A["'"]=A.prime=wo("'","&prime;","prime"),A["\u2033"]=A.dprime=wo("\u2033","&Prime;","double prime"),A.backslash=wo("\\backslash ","\\","backslash"),z["\\"]||(z["\\"]=A.backslash),A.$=wo("\\$","$","dollar"),A.square=wo("\\square ","\u25A1","square"),A.mid=wo("\\mid ","\u2223","mid");var wt=function(D){pt(f,D);function f(h,m,v){return D.call(this,h,c("span",{class:"dcg-mq-nonSymbola"},[m||c.text(h)]))||this}return f}(gn);A["@"]=function(){return new wt("@")},A["&"]=function(){return new wt("\\&",c.entityText("&amp;"),"and")},A["%"]=function(D){pt(f,D);function f(){return D.call(this,"\\%",c.text("%"),"percent")||this}return f.prototype.parser=function(){var h=ht.optWhitespace,m=ht.string;return h.then(m("\\operatorname{of}").map(function(){return Y0()})).or(D.prototype.parser.call(this))},f}(wt),A["\u2225"]=A.parallel=wo("\\parallel ","&#x2225;","parallel"),A["\u2226"]=A.nparallel=wo("\\nparallel ","&#x2226;","not parallel"),A["\u27C2"]=A.perp=wo("\\perp ","&#x27C2;","perpendicular"),A.alpha=A.beta=A.gamma=A.delta=A.zeta=A.eta=A.theta=A.iota=A.kappa=A.mu=A.nu=A.xi=A.rho=A.sigma=A.tau=A.chi=A.psi=A.omega=function(D){return new be("\\"+D+" ",c.entityText("&"+D+";"))},A.phi=se("\\phi ","&#981;","phi"),A.phiv=A.varphi=se("\\varphi ","&phi;","phi"),A.epsilon=se("\\epsilon ","&#1013;","epsilon"),A.epsiv=A.varepsilon=se("\\varepsilon ","&epsilon;","epsilon"),A.piv=A.varpi=se("\\varpi ","&piv;","piv"),A.sigmaf=A.sigmav=A.varsigma=se("\\varsigma ","&sigmaf;","sigma"),A.thetav=A.vartheta=A.thetasym=se("\\vartheta ","&thetasym;","theta"),A.upsilon=A.upsi=se("\\upsilon ","&upsilon;","upsilon"),A.gammad=A.Gammad=A.digamma=se("\\digamma ","&#989;","gamma"),A.kappav=A.varkappa=se("\\varkappa ","&#1008;","kappa"),A.rhov=A.varrho=se("\\varrho ","&#1009;","rho"),A.pi=A.\u03C0=function(){return new wt("\\pi ",c.entityText("&pi;"),"pi")},A.lambda=function(){return new wt("\\lambda ",c.entityText("&lambda;"),"lambda")},A.Upsilon=A.Upsi=A.upsih=A.Upsih=function(){return new gn("\\Upsilon ",c("var",{style:"font-family: serif"},[c.entityText("&upsih;")]),"capital upsilon")},A.Gamma=A.Delta=A.Theta=A.Lambda=A.Xi=A.Pi=A.Sigma=A.Phi=A.Psi=A.Omega=A.forall=function(D){return new Ll("\\"+D+" ",c.entityText("&"+D+";"))};var Vt=function(D){pt(f,D);function f(h){var m=D.call(this)||this;return m.latexStr=h,m}return f.prototype.createLeftOf=function(h){var m=rr.parse(this.latexStr);m.children().adopt(h.parent,h[t],h[e]),h[t]=m.getEnd(e),L(m.html()).insertBefore(h.domFrag()),m.finalizeInsert(h.options,h);var v=m.getEnd(e),M=v&&v[e];M&&M.siblingCreated(h.options,t);var B=m.getEnd(t),j=B&&B[t];j&&j.siblingCreated(h.options,e),h.parent.bubble(function(ee){ee.reflow()})},f.prototype.mathspeak=function(){return rr.parse(this.latexStr).mathspeak()},f.prototype.parser=function(){var h=rr.parse(this.latexStr).children();return ht.succeed(h)},f}(Ci);A["\u2070"]=function(){return new Vt("^0")},A["\xB9"]=function(){return new Vt("^1")},A["\xB2"]=function(){return new Vt("^2")},A["\xB3"]=function(){return new Vt("^3")},A["\u2074"]=function(){return new Vt("^4")},A["\u2075"]=function(){return new Vt("^5")},A["\u2076"]=function(){return new Vt("^6")},A["\u2077"]=function(){return new Vt("^7")},A["\u2078"]=function(){return new Vt("^8")},A["\u2079"]=function(){return new Vt("^9")},A["\xBC"]=function(){return new Vt("\\frac14")},A["\xBD"]=function(){return new Vt("\\frac12")},A["\xBE"]=function(){return new Vt("\\frac34")},A["\u221A"]=function(){return new Vt("\\sqrt{}")};function ar(D){if(!D)return!1;var f=D[t];if(f){if(f instanceof ro||/^(\\ )|[,;:\(\[]$/.test(f.ctrlSeq))return!1}else return D.parent&&D.parent.parent&&D.parent.parent.isStyleBlock()?ar(D.parent.parent):!1;return!0}var St=function(D){pt(f,D);function f(h,m,v){return D.call(this,h,m,void 0,v,!0)||this}return f.prototype.contactWeld=function(h,m){this.sharedSiblingMethod(h.options,m)},f.prototype.siblingCreated=function(h,m){this.sharedSiblingMethod(h,m)},f.prototype.siblingDeleted=function(h,m){this.sharedSiblingMethod(h,m)},f.prototype.sharedSiblingMethod=function(h,m){if(m!==e)return this.domFrag().oneElement().className=ar(this)?"dcg-mq-binary-operator":"",this},f}(ro);A["+"]=function(D){pt(f,D);function f(){return D.call(this,"+",c.text("+"))||this}return f.prototype.mathspeak=function(){return ar(this)?"plus":"positive"},f}(St);var zi=function(D){pt(f,D);function f(){return D.call(this,"-",c.entityText("&minus;"))||this}return f.prototype.mathspeak=function(){return ar(this)?"minus":"negative"},f}(St);A["\u2212"]=A["\u2014"]=A["\u2013"]=A["-"]=zi,A["\xB1"]=A.pm=A.plusmn=A.plusminus=function(){return new St("\\pm ",c.entityText("&plusmn;"),"plus-or-minus")},A.mp=A.mnplus=A.minusplus=function(){return new St("\\mp ",c.entityText("&#8723;"),"minus-or-plus")},z["*"]=A.sdot=A.cdot=nr("\\cdot ","&middot;","*","times");var Fn=function(D){pt(f,D);function f(){return D.call(this,"\\to ",c.entityText("&rarr;"),"to")||this}return f.prototype.deleteTowards=function(h,m){if(h===t){var v=m[t];new _(v,this).remove(),m[t]=v[t],new zi().createLeftOf(m),m[t].bubble(function(M){M.reflow()});return}D.prototype.deleteTowards.call(this,h,m)},f}(ro);A["\u2192"]=A.to=Fn;var Di=function(D){pt(f,D);function f(h,m){var v=this,M=m?"Strict":"";return v=D.call(this,h["ctrlSeq".concat(M)],c.entityText(h["htmlEntity".concat(M)]),h["text".concat(M)],h["mathspeak".concat(M)])||this,v.data=h,v.strict=m,v}return f.prototype.swap=function(h){this.strict=h;var m=h?"Strict":"";this.ctrlSeq=this.data["ctrlSeq".concat(m)],this.domFrag().children().replaceWith(L(c.entityText(this.data["htmlEntity".concat(m)]))),this.textTemplate=[this.data["text".concat(m)]],this.mathspeakName=this.data["mathspeak".concat(m)]},f.prototype.deleteTowards=function(h,m){if(h===t&&!this.strict){this.swap(!0),this.bubble(function(v){v.reflow()});return}D.prototype.deleteTowards.call(this,h,m)},f}(ro),$i={ctrlSeq:"\\le ",htmlEntity:"&le;",text:"\u2264",mathspeak:"less than or equal to",ctrlSeqStrict:"<",htmlEntityStrict:"&lt;",textStrict:"<",mathspeakStrict:"less than"},gh={ctrlSeq:"\\ge ",htmlEntity:"&ge;",text:"\u2265",mathspeak:"greater than or equal to",ctrlSeqStrict:">",htmlEntityStrict:"&gt;",textStrict:">",mathspeakStrict:"greater than"},bp=function(D){pt(f,D);function f(){return D.call(this,gh,!0)||this}return f.prototype.createLeftOf=function(h){var m=h[t];if(m instanceof ro&&m.ctrlSeq==="-"){var v=m;h[t]=v[t],v.remove(),new Fn().createLeftOf(h),h[t].bubble(function(M){M.reflow()});return}D.prototype.createLeftOf.call(this,h)},f}(Di);A["<"]=A.lt=function(){return new Di($i,!0)},A[">"]=A.gt=bp,A["\u2264"]=A.le=A.leq=function(){return new Di($i,!1)},A["\u2265"]=A.ge=A.geq=function(){return new Di(gh,!1)},A.infty=A.infin=A.infinity=wo("\\infty ","&infin;","infinity"),A["\u2260"]=A.ne=A.neq=nr("\\ne ","&ne;","not equal");var Ds=function(D){pt(f,D);function f(){return D.call(this,"=",c.text("="),"=","equals")||this}return f.prototype.createLeftOf=function(h){var m=h[t];if(m instanceof Di&&m.strict){m.swap(!1),m.bubble(function(v){v.reflow()});return}D.prototype.createLeftOf.call(this,h)},f}(ro);A["="]=Ds,A["\xD7"]=A.times=A.cross=nr("\\times ","&times;","[x]","times"),A["\xF7"]=A.div=A.divide=A.divides=nr("\\div ","&divide;","[/]","over");var $0=function(D){pt(f,D);function f(){return D.call(this,"\\sim ",c.text("~"),"~","tilde")||this}return f.prototype.createLeftOf=function(h){if(h[t]instanceof f){var m=h[t];h[t]=m[t],m.remove(),new W0().createLeftOf(h),h[t].bubble(function(v){v.reflow()});return}D.prototype.createLeftOf.call(this,h)},f}(ro),W0=function(D){pt(f,D);function f(){return D.call(this,"\\approx ",c.entityText("&approx;"),"\u2248","approximately equal")||this}return f.prototype.deleteTowards=function(h,m){if(h===t){var v=m[t];new _(v,this).remove(),m[t]=v[t],new $0().createLeftOf(m),m[t].bubble(function(M){M.reflow()});return}D.prototype.deleteTowards.call(this,h,m)},f}(ro);A.tildeNbsp=wo("~",u," "),A.sim=$0,A["\u2248"]=A.approx=W0,z["~"]=A.sim,A["~"]=A.tildeNbsp,ge.interpretTildeAsSim=function(D){var f=!!D;return f?A["~"]=A.sim:A["~"]=A.tildeNbsp,f};var wf={sqrt:{width:"",html:function(){return c("svg",{preserveAspectRatio:"none",viewBox:"0 0 32 54"},[c("path",{d:"M0 33 L7 27 L12.5 47 L13 47 L30 0 L32 0 L13 54 L11 54 L4.5 31 L0 33"})])}},"|":{width:".4em",html:function(){return c("svg",{preserveAspectRatio:"none",viewBox:"0 0 10 54"},[c("path",{d:"M4.4 0 L4.4 54 L5.6 54 L5.6 0"})])}},"[":{width:".55em",html:function(){return c("svg",{preserveAspectRatio:"none",viewBox:"0 0 11 24"},[c("path",{d:"M8 0 L3 0 L3 24 L8 24 L8 23 L4 23 L4 1 L8 1"})])}},"]":{width:".55em",html:function(){return c("svg",{preserveAspectRatio:"none",viewBox:"0 0 11 24"},[c("path",{d:"M3 0 L8 0 L8 24 L3 24 L3 23 L7 23 L7 1 L3 1"})])}},"(":{width:".55em",html:function(){return c("svg",{preserveAspectRatio:"none",viewBox:"3 0 106 186"},[c("path",{d:"M85 0 A61 101 0 0 0 85 186 L75 186 A75 101 0 0 1 75 0"})])}},")":{width:".55em",html:function(){return c("svg",{preserveAspectRatio:"none",viewBox:"3 0 106 186"},[c("path",{d:"M24 0 A61 101 0 0 1 24 186 L34 186 A75 101 0 0 0 34 0"})])}},"{":{width:".7em",html:function(){return c("svg",{preserveAspectRatio:"none",viewBox:"10 0 210 350"},[c("path",{d:"M170 0 L170 6 A47 52 0 0 0 123 60 L123 127 A35 48 0 0 1 88 175 A35 48 0 0 1 123 223 L123 290 A47 52 0 0 0 170 344 L170 350 L160 350 A58 49 0 0 1 102 301 L103 220 A45 40 0 0 0 58 180 L58 170 A45 40 0 0 0 103 130 L103 49 A58 49 0 0 1 161 0"})])}},"}":{width:".7em",html:function(){return c("svg",{preserveAspectRatio:"none",viewBox:"10 0 210 350"},[c("path",{d:"M60 0 L60 6 A47 52 0 0 1 107 60 L107 127 A35 48 0 0 0 142 175 A35 48 0 0 0 107 223 L107 290 A47 52 0 0 1 60 344 L60 350 L70 350 A58 49 0 0 0 128 301 L127 220 A45 40 0 0 1 172 180 L172 170 A45 40 0 0 1 127 130 L127 49 A58 49 0 0 0 70 0"})])}},"&#8741;":{width:".7em",html:function(){return c("svg",{preserveAspectRatio:"none",viewBox:"0 0 10 54"},[c("path",{d:"M3.2 0 L3.2 54 L4 54 L4 0 M6.8 0 L6.8 54 L6 54 L6 0"})])}},"&lang;":{width:".55em",html:function(){return c("svg",{preserveAspectRatio:"none",viewBox:"0 0 10 54"},[c("path",{d:"M6.8 0 L3.2 27 L6.8 54 L7.8 54 L4.2 27 L7.8 0"})])}},"&rang;":{width:".55em",html:function(){return c("svg",{preserveAspectRatio:"none",viewBox:"0 0 10 54"},[c("path",{d:"M3.2 0 L6.8 27 L3.2 54 L2.2 54 L5.8 27 L2.2 0"})])}}},Pl=function(D){pt(f,D);function f(h,m,v,M,B){var j=D.call(this,h,new Mr(1,function(ee){return c.block(m,v,ee[0])}))||this;return j.ariaLabel=M||h.replace(/^\\/,""),j.mathspeakTemplate=["Start"+j.ariaLabel+",","End"+j.ariaLabel],j.shouldNotSpeakDelimiters=B&&B.shouldNotSpeakDelimiters,j}return f.prototype.mathspeak=function(h){return!this.shouldNotSpeakDelimiters||h&&h.ignoreShorthand?D.prototype.mathspeak.call(this):this.foldChildren("",function(m,v){return m+" "+v.mathspeak(h)}).trim()},f}(Ci);A.mathrm=function(D){pt(f,D);function f(){return D.call(this,"\\mathrm","span",{class:"dcg-mq-roman dcg-mq-font"},"Roman Font",{shouldNotSpeakDelimiters:!0})||this}return f.prototype.isTextBlock=function(){return!0},f}(Pl),A.mathit=function(){return new Pl("\\mathit","i",{class:"dcg-mq-font"},"Italic Font")},A.mathbf=function(){return new Pl("\\mathbf","b",{class:"dcg-mq-font"},"Bold Font")},A.mathsf=function(){return new Pl("\\mathsf","span",{class:"dcg-mq-sans-serif dcg-mq-font"},"Serif Font")},A.mathtt=function(){return new Pl("\\mathtt","span",{class:"dcg-mq-monospace dcg-mq-font"},"Math Text")},A.underline=function(){return new Pl("\\underline","span",{class:"dcg-mq-non-leaf dcg-mq-underline"},"Underline")},A.overline=A.bar=function(){return new Pl("\\overline","span",{class:"dcg-mq-non-leaf dcg-mq-overline"},"Overline")},A.overrightarrow=function(){return new Pl("\\overrightarrow","span",{class:"dcg-mq-non-leaf dcg-mq-overarrow dcg-mq-arrow-right"},"Over Right Arrow")},A.overleftarrow=function(){return new Pl("\\overleftarrow","span",{class:"dcg-mq-non-leaf dcg-mq-overarrow dcg-mq-arrow-left"},"Over Left Arrow")},A.overleftrightarrow=function(){return new Pl("\\overleftrightarrow ","span",{class:"dcg-mq-non-leaf dcg-mq-overarrow dcg-mq-arrow-leftright"},"Over Left and Right Arrow")},A.overarc=function(){return new Pl("\\overarc","span",{class:"dcg-mq-non-leaf dcg-mq-overarc"},"Over Arc")},A.dot=function(){return new Ci("\\dot",new Mr(1,function(D){return c("span",{class:"dcg-mq-non-leaf"},[c("span",{class:"dcg-mq-dot-recurring-inner"},[c("span",{class:"dcg-mq-dot-recurring"},[c.text(g)]),c.block("span",{class:"dcg-mq-empty-box"},D[0])])])}))},A.textcolor=function(D){pt(f,D);function f(){return D!==null&&D.apply(this,arguments)||this}return f.prototype.setColor=function(h){this.color=h,this.domView=new Mr(1,function(m){return c.block("span",{class:"dcg-mq-textcolor",style:"color:"+h},m[0])}),this.ariaLabel=h.replace(/^\\/,""),this.mathspeakTemplate=["Start "+this.ariaLabel+",","End "+this.ariaLabel]},f.prototype.latexRecursive=function(h){this.checkCursorContextOpen(h);var m=this.blocks[0];h.latex+="\\textcolor{"+this.color+"}{",m.latexRecursive(h),h.latex+="}",this.checkCursorContextClose(h)},f.prototype.parser=function(){var h=this,m=ht.optWhitespace,v=ht.string,M=ht.regex;return m.then(v("{")).then(M(/^[#\w\s.,()%-]*/)).skip(v("}")).then(function(B){return h.setColor(B),D.prototype.parser.call(h)})},f.prototype.isStyleBlock=function(){return!0},f}(Ci);var SY=A.class=function(D){pt(f,D);function f(){return D!==null&&D.apply(this,arguments)||this}return f.prototype.parser=function(){var h=this,m=ht.string,v=ht.regex;return ht.optWhitespace.then(m("{")).then(v(/^[-\w\s\\\xA0-\xFF]*/)).skip(m("}")).then(function(M){return h.cls=M||"",h.domView=new Mr(1,function(B){return c.block("span",{class:"dcg-mq-class ".concat(M)},B[0])}),h.ariaLabel=M+" class",h.mathspeakTemplate=["Start "+h.ariaLabel+",","End "+h.ariaLabel],D.prototype.parser.call(h)})},f.prototype.latexRecursive=function(h){this.checkCursorContextOpen(h);var m=this.blocks[0];h.latex+="\\class{"+this.cls+"}{",m.latexRecursive(h),h.latex+="}",this.checkCursorContextClose(h)},f.prototype.isStyleBlock=function(){return!0},f}(Ci),Ix=/^[\+\-]?[\d]+$/;function EG(D){if(!D)return"";var f="";return D.eachChild(function(h){h.ctrlSeq!==void 0&&(f+=h.ctrlSeq)}),f}Se.prototype.charsThatBreakOutOfSupSub="";var Ol=function(D){pt(f,D);function f(){var h=D!==null&&D.apply(this,arguments)||this;return h.ctrlSeq="_{...}^{...}",h}return f.prototype.setEnds=function(h){o("SupSub ends must be MathBlocks",h[t]instanceof Hi&&h[e]instanceof Hi),this.ends=h},f.prototype.getEnd=function(h){return this.ends[h]},f.prototype.createLeftOf=function(h){if(!(!this.replacedFragment&&!h[t]&&h.options.supSubsRequireOperand))return D.prototype.createLeftOf.call(this,h)},f.prototype.contactWeld=function(h){for(var m=t;m;m=m===t?e:!1){var v=this[m],M=void 0;if(v instanceof f){for(var B="sub";B;B=B==="sub"?"sup":!1){var j=this[B],ee=v[B];if(j){if(!ee)v.addBlock(j.disown());else if(j.isEmpty())M=new $(ee,0,ee.getEnd(t));else{j.domFrag().children().insAtDirEnd(-m,ee.domFrag().oneElement());var ce=j.children().disown();M=new $(ee,ce.getEnd(e),ee.getEnd(t)),m===t?ce.adopt(ee,ee.getEnd(e),0):ce.adopt(ee,0,ee.getEnd(t))}this.placeCursor=function(Ue,Me){return function(ke){ke.insAtDirEnd(-m,Ue||Me)}}(ee,j)}}this.remove(),h&&h[t]===this&&(m===e&&M?M[t]?h.insRightOf(M[t]):h.insAtLeftEnd(M.parent):h.insRightOf(v));break}}},f.prototype.finalizeTree=function(){var h=this.getEnd(t);h.write=function(m,v){if(m.options.autoSubscriptNumerals&&this===this.parent.sub&&"0123456789".indexOf(v)>=0){var M=this.chToCmd(v,m.options);M instanceof gn?m.deleteSelection():m.clearSelection().insRightOf(this.parent),M.createLeftOf(m.show()),m.controller.aria.queue("Baseline").alert(M.mathspeak({createdLeftOf:m}));return}m[t]&&!m[e]&&!m.selection&&m.options.charsThatBreakOutOfSupSub.indexOf(v)>-1&&(m.insRightOf(this.parent),m.controller.aria.queue("Baseline")),Hi.prototype.write.call(this,m,v)}},f.prototype.moveTowards=function(h,m,v){m.options.autoSubscriptNumerals&&!this.sup?m.insDirOf(h,this):D.prototype.moveTowards.call(this,h,m,v)},f.prototype.deleteTowards=function(h,m){if(m.options.autoSubscriptNumerals&&this.sub){var v=this.sub.getEnd(-h);v instanceof gn?v.remove():v&&v.deleteTowards(h,m.insAtDirEnd(-h,this.sub)),this.sub.isEmpty()&&(this.sub.deleteOutOf(t,m.insAtLeftEnd(this.sub)),this.sup&&m.insDirOf(-h,this))}else D.prototype.deleteTowards.call(this,h,m)},f.prototype.latexRecursive=function(h){if(this.checkCursorContextOpen(h),this.sub){h.latex+="_{";var m=h.latex.length;this.sub.latexRecursive(h);var v=h.latex.length;m===v&&(h.latex+=" "),h.latex+="}"}if(this.sup){h.latex+="^{";var m=h.latex.length;this.sup.latexRecursive(h);var v=h.latex.length;m===v&&(h.latex+=" "),h.latex+="}"}this.checkCursorContextClose(h)},f.prototype.text=function(){function h(m,v){var M=v&&v.text()||"";return v?m+(M.length===1?M:"("+(M||" ")+")"):""}return h("_",this.sub)+h("^",this.sup)},f.prototype.addBlock=function(h){this.supsub==="sub"?(this.sup=this.upInto=this.sub.upOutOf=h,h.adopt(this,this.sub,0).downOutOf=this.sub,h.setDOM(L(c("span",{class:"dcg-mq-sup"})).append(h.domFrag().children()).prependTo(this.domFrag().oneElement()).oneElement()),R.linkElementByBlockNode(h.domFrag().oneElement(),h)):(this.sub=this.downInto=this.sup.downOutOf=h,h.adopt(this,0,this.sup).upOutOf=this.sup,this.domFrag().removeClass("dcg-mq-sup-only"),h.setDOM(L(c("span",{class:"dcg-mq-sub"})).append(h.domFrag().children()).appendTo(this.domFrag().oneElement()).oneElement()),R.linkElementByBlockNode(h.domFrag().oneElement(),h),this.domFrag().append(L(c("span",{style:"display:inline-block;width:0"},[c.text(p)]))));for(var m=0;m<2;m+=1)(function(v,M,B,j){var ee=v[M];ee.deleteOutOf=function(ce,Ue){if(Ue.insDirOf(this[ce]?-ce:ce,this.parent),!this.isEmpty()){var Me=this.getEnd(ce);this.children().disown().withDirAdopt(ce,Ue.parent,Ue[ce],Ue[-ce]).domFrag().insDirOf(-ce,Ue.domFrag()),Ue[-ce]=Me}v.supsub=B,delete v[M],delete v["".concat(j,"Into")];var ke=v[B];ke["".concat(j,"OutOf")]=kG,delete ke.deleteOutOf,M==="sub"&&v.domFrag().addClass("dcg-mq-sup-only").children().last().remove(),this.remove()}})(this,"sub sup".split(" ")[m],"sup sub".split(" ")[m],"down up".split(" ")[m])},f}(Ci);function kG(D){var f=this.parent,h=D;do{if(h[e])return D.insLeftOf(f);h=h.parent.parent}while(h!==f);D.insRightOf(f)}var j0=function(D){pt(f,D);function f(){var h=D!==null&&D.apply(this,arguments)||this;return h.supsub="sub",h.domView=new Mr(1,function(m){return c("span",{class:"dcg-mq-supsub dcg-mq-non-leaf"},[c.block("span",{class:"dcg-mq-sub"},m[0]),c("span",{style:"display:inline-block;width:0"},[c.text(p)])])}),h.textTemplate=["_"],h.mathspeakTemplate=["Subscript,",", Baseline"],h.ariaLabel="subscript",h}return f.prototype.finalizeTree=function(){this.downInto=this.sub=this.getEnd(t),this.sub.upOutOf=kG,D.prototype.finalizeTree.call(this)},f}(Ol);A.subscript=A._=j0,A.superscript=A.supscript=A["^"]=function(D){pt(f,D);function f(){var h=D!==null&&D.apply(this,arguments)||this;return h.supsub="sup",h.domView=new Mr(1,function(m){return c("span",{class:"dcg-mq-supsub dcg-mq-non-leaf dcg-mq-sup-only"},[c.block("span",{class:"dcg-mq-sup"},m[0])])}),h.textTemplate=["^(",")"],h.ariaLabel="superscript",h.mathspeakTemplate=["Superscript,",", Baseline"],h}return f.prototype.mathspeak=function(h){var m=this.upInto;if(m!==void 0){var v=EG(m);if((!h||!h.ignoreShorthand)&&Ix.test(v)){if(v==="0")return"to the 0 power";if(v==="2")return"squared";if(v==="3")return"cubed";var M="";/^[+-]?\d{1,3}$/.test(v)&&(/(11|12|13|4|5|6|7|8|9|0)$/.test(v)?M="th":/1$/.test(v)?M="st":/2$/.test(v)?M="nd":/3$/.test(v)&&(M="rd"));var B=typeof m=="object"?m.mathspeak():v;return"to the "+B+M+" power"}}return D.prototype.mathspeak.call(this)},f.prototype.finalizeTree=function(){this.upInto=this.sup=this.getEnd(e),this.sup.downOutOf=kG,D.prototype.finalizeTree.call(this)},f}(Ol);var wp=function(D){pt(f,D);function f(h,m,v){var M=D.call(this)||this;M.ariaLabel=v||h.replace(/^\\/,"");var B=new Mr(2,function(j){return c("span",{class:"dcg-mq-large-operator dcg-mq-non-leaf"},[c("span",{class:"dcg-mq-to"},[c.block("span",{},j[1])]),c("big",{},[c.text(m)]),c("span",{class:"dcg-mq-from"},[c.block("span",{},j[0])])])});return gn.prototype.setCtrlSeqHtmlTextAndMathspeak.call(M,h,B),M}return f.prototype.createLeftOf=function(h){D.prototype.createLeftOf.call(this,h),h.options.sumStartsWithNEquals&&(new ue("n").createLeftOf(h),new Ds().createLeftOf(h))},f.prototype.latexRecursive=function(h){this.checkCursorContextOpen(h),h.latex+=this.ctrlSeq+"_{";var m=h.latex.length;this.getEnd(t).latexRecursive(h);var v=h.latex.length;v===m&&(h.latex+=" "),h.latex+="}^{",m=h.latex.length,this.getEnd(e).latexRecursive(h),v=h.latex.length,m===v&&(h.latex+=" "),h.latex+="}",this.checkCursorContextClose(h)},f.prototype.mathspeak=function(){return"Start "+this.ariaLabel+" from "+this.getEnd(t).mathspeak()+" to "+this.getEnd(e).mathspeak()+", end "+this.ariaLabel+", "},f.prototype.parser=function(){for(var h=ht.string,m=ht.optWhitespace,v=ht.succeed,M=rr.block,B=this,j=B.blocks=[new Hi,new Hi],ee=0;ee<j.length;ee+=1)j[ee].adopt(B,B.getEnd(e),0);return m.then(h("_").or(h("^"))).then(function(ce){var Ue=j[ce==="_"?0:1];return M.then(function(Me){return Me.children().adopt(Ue,Ue.getEnd(e),0),v(B)})}).many().result(B)},f.prototype.finalizeTree=function(){var h=this.getEnd(t),m=this.getEnd(e);h.ariaLabel="lower bound",m.ariaLabel="upper bound",this.downInto=h,this.upInto=m,h.upOutOf=m,m.downOutOf=h},f}(Ci);A["\u2211"]=A.sum=A.summation=function(){return new wp("\\sum ",b,"sum")},A["\u220F"]=A.prod=A.product=function(){return new wp("\\prod ",x,"product")},A.coprod=A.coproduct=function(){return new wp("\\coprod ",w,"co product")},A["\u222B"]=A.int=A.integral=function(D){pt(f,D);function f(){var h=D.call(this,"\\int ","","integral")||this;return h.ariaLabel="integral",h.domView=new Mr(2,function(m){return c("span",{class:"dcg-mq-int dcg-mq-non-leaf"},[c("big",{},[c.text(E)]),c("span",{class:"dcg-mq-supsub dcg-mq-non-leaf"},[c("span",{class:"dcg-mq-sup"},[c.block("span",{class:"dcg-mq-sup-inner"},m[1])]),c.block("span",{class:"dcg-mq-sub"},m[0]),c("span",{style:"display:inline-block;width:0"},[c.text(p)])])])}),h}return f.prototype.createLeftOf=function(h){Ci.prototype.createLeftOf.call(this,h)},f}(wp);var T5=A.frac=A.dfrac=A.cfrac=A.fraction=function(D){pt(f,D);function f(){var h=D!==null&&D.apply(this,arguments)||this;return h.ctrlSeq="\\frac",h.domView=new Mr(2,function(m){return c("span",{class:"dcg-mq-fraction dcg-mq-non-leaf"},[c.block("span",{class:"dcg-mq-numerator"},m[0]),c.block("span",{class:"dcg-mq-denominator"},m[1]),c("span",{style:"display:inline-block;width:0"},[c.text(p)])])}),h.textTemplate=["(",")/(",")"],h}return f.prototype.finalizeTree=function(){var h=this.getEnd(t),m=this.getEnd(e);this.upInto=m.upOutOf=h,this.downInto=h.downOutOf=m,h.ariaLabel="numerator",m.ariaLabel="denominator",this.getFracDepth()>1?this.mathspeakTemplate=["StartNestedFraction,","NestedOver",", EndNestedFraction"]:this.mathspeakTemplate=["StartFraction,","Over",", EndFraction"]},f.prototype.mathspeak=function(h){if(h&&h.createdLeftOf){var m=h.createdLeftOf;return m.parent.mathspeak()}var v=EG(this.getEnd(t)),M=EG(this.getEnd(e));if((!h||!h.ignoreShorthand)&&Ix.test(v)&&Ix.test(M)){var B=v==="1"||v==="-1",j="";if(M==="2"?j=B?"half":"halves":M==="3"?j=B?"third":"thirds":M==="4"?j=B?"quarter":"quarters":M==="5"?j=B?"fifth":"fifths":M==="6"?j=B?"sixth":"sixths":M==="7"?j=B?"seventh":"sevenths":M==="8"?j=B?"eighth":"eighths":M==="9"&&(j=B?"ninth":"ninths"),j!==""){for(var ee="",ce=!1,Ue=this[t];Ue&&Ue[t]!==void 0;Ue=Ue[t])if(Ue.ctrlSeq!=="\\ ")if(Ix.test(Ue.ctrlSeq||""))ce=!0;else{ce=!1;break}return ce&&(ee+="and "),ee+=this.getEnd(t).mathspeak()+" "+j,ee}}return D.prototype.mathspeak.call(this)},f.prototype.getFracDepth=function(){var h=0,m=function(v,M){return v instanceof le&&v.ctrlSeq&&v.ctrlSeq.toLowerCase().search("frac")>=0&&(M+=1),v&&v.parent?m(v.parent,M):M};return m(this,h)},f}(Ci),A5=A.over=z["/"]=function(D){pt(f,D);function f(){return D!==null&&D.apply(this,arguments)||this}return f.prototype.createLeftOf=function(h){if(!this.replacedFragment){var m=h[t];if(!h.options.typingSlashCreatesNewFraction)for(;m&&!(m instanceof ro||m instanceof(A.text||n)||m instanceof wp||m.ctrlSeq==="\\ "||/^[,;:]$/.test(m.ctrlSeq));)m=m[t];if(m instanceof wp&&m[e]instanceof Ol){m=m[e];var v=m[e];v instanceof Ol&&v.ctrlSeq!=m.ctrlSeq&&(m=m[e])}if(m!==h[t]&&!h.isTooDeep(1)){var v=m[e],M=h[t];this.replaces(new _(v||h.parent.getEnd(t),M)),h[t]=m}}D.prototype.createLeftOf.call(this,h)},f}(T5),J0=function(){return new gn("\\operatorname{ans}",c("span",{class:"dcg-mq-ans"},[c.text("ans")]),"ans")};A.ans=J0;var Y0=function(){return new gn("\\%\\operatorname{of}",c("span",{class:"dcg-mq-nonSymbola dcg-mq-operator-name"},[c.text("% of ")]),"percent of")};A.percent=A.percentof=Y0;var L5=function(D){pt(f,D);function f(){var h=D!==null&&D.apply(this,arguments)||this;return h.tokenId="",h.ctrlSeq="\\token",h.textTemplate=["token(",")"],h.mathspeakTemplate=["StartToken,",", EndToken"],h.ariaLabel="token",h}return f.prototype.html=function(){var h=c("span",{class:"dcg-mq-token dcg-mq-ignore-mousedown","data-dcg-mq-token":this.tokenId});return this.setDOM(h),R.linkElementByCmdNode(h,this),h},f.prototype.latexRecursive=function(h){this.checkCursorContextOpen(h),h.latex+="\\token{"+this.tokenId+"}",this.checkCursorContextClose(h)},f.prototype.mathspeak=function(){var h=[];return this.domFrag().children().eachElement(function(m){var v=m.getAttribute("aria-label");typeof v=="string"&&v!==""&&h.push(v)}),h.length>0?h.join(" ").trim():"token "+this.tokenId},f.prototype.parser=function(){var h=this;return rr.block.map(function(m){var v=m.getEnd(t);if(v)for(h.tokenId+=v.ctrlSeq;v=v[e];)h.tokenId+=v.ctrlSeq;return h})},f}(gn);A.token=L5;var X0=function(D){pt(f,D);function f(){var h=D!==null&&D.apply(this,arguments)||this;return h.ctrlSeq="\\sqrt",h.domView=new Mr(1,function(m){return c("span",{class:"dcg-mq-non-leaf dcg-mq-sqrt-container"},[c("span",{class:"dcg-mq-scaled dcg-mq-sqrt-prefix"},[wf.sqrt.html()]),c.block("span",{class:"dcg-mq-non-leaf dcg-mq-sqrt-stem"},m[0])])}),h.textTemplate=["sqrt(",")"],h.mathspeakTemplate=["StartRoot,",", EndRoot"],h.ariaLabel="root",h}return f.prototype.parser=function(){return rr.optBlock.then(function(h){return rr.block.map(function(m){var v=new GG;return v.blocks=[h,m],h.adopt(v,0,0),m.adopt(v,h,0),v})}).or(D.prototype.parser.call(this))},f}(Ci);A.sqrt=X0,A.hat=function(D){pt(f,D);function f(){var h=D!==null&&D.apply(this,arguments)||this;return h.ctrlSeq="\\hat",h.domView=new Mr(1,function(m){return c("span",{class:"dcg-mq-non-leaf"},[c("span",{class:"dcg-mq-hat-prefix"},[c.text("^")]),c.block("span",{class:"dcg-mq-hat-stem"},m[0])])}),h.textTemplate=["hat(",")"],h}return f}(Ci);var GG=function(D){pt(f,D);function f(){var h=D!==null&&D.apply(this,arguments)||this;return h.domView=new Mr(2,function(m){return c("span",{class:"dcg-mq-nthroot-container dcg-mq-non-leaf"},[c.block("sup",{class:"dcg-mq-nthroot dcg-mq-non-leaf"},m[0]),c("span",{class:"dcg-mq-scaled dcg-mq-sqrt-container"},[c("span",{class:"dcg-mq-sqrt-prefix dcg-mq-scaled"},[wf.sqrt.html()]),c.block("span",{class:"dcg-mq-sqrt-stem dcg-mq-non-leaf"},m[1])])])}),h.textTemplate=["sqrt[","](",")"],h}return f.prototype.latexRecursive=function(h){this.checkCursorContextOpen(h),h.latex+="\\sqrt[",this.getEnd(t).latexRecursive(h),h.latex+="]{",this.getEnd(e).latexRecursive(h),h.latex+="}",this.checkCursorContextClose(h)},f.prototype.mathspeak=function(){var h=this.getEnd(t).mathspeak(),m=this.getEnd(e).mathspeak();return this.getEnd(t).ariaLabel="Index",this.getEnd(e).ariaLabel="Radicand",h==="3"?"Start Cube Root, "+m+", End Cube Root":"Root Index "+h+", Start Root, "+m+", End Root"},f}(X0);A.nthroot=GG,A.cbrt=function(D){pt(f,D);function f(){return D!==null&&D.apply(this,arguments)||this}return f.prototype.createLeftOf=function(h){D.prototype.createLeftOf.call(this,h),new re("3").createLeftOf(h),h.controller.moveRight()},f}(GG);var Q0=function(D){pt(f,D);function f(h,m,v){var M=this,B=new Mr(1,function(j){return c("span",{class:"dcg-mq-non-leaf"},[c("span",{class:"dcg-mq-diacritic-above"},[m]),c.block("span",{class:"dcg-mq-diacritic-stem"},j[0])])});return M=D.call(this,h,B,v)||this,M}return f}(Ci);A.vec=function(){return new Q0("\\vec",c.entityText("&rarr;"),["vec(",")"])},A.tilde=function(){return new Q0("\\tilde",c.text("~"),["tilde(",")"])};var Z0=function(D){pt(f,D);function f(){return D!==null&&D.apply(this,arguments)||this}return f.prototype.setDOM=function(h){var m;D.prototype.setDOM.call(this,h);var v=this.domFrag().children();return v.isEmpty()||(this.delimFrags=(m={},m[t]=v.first(),m[e]=v.last(),m)),this},f}(Ci),_l=function(D){pt(f,D);function f(h,m,v,M,B){var j,ee=D.call(this,"\\left"+M,void 0,[m,v])||this;return ee.side=h,ee.sides=(j={},j[t]={ch:m,ctrlSeq:M},j[e]={ch:v,ctrlSeq:B},j),ee}return f.prototype.numBlocks=function(){return 1},f.prototype.html=function(){var h=this,m=this.getSymbol(t),v=this.getSymbol(e);return this.domView=new Mr(1,function(M){return c("span",{class:"dcg-mq-non-leaf dcg-mq-bracket-container"},[c("span",{style:"width:"+m.width,class:"dcg-mq-scaled dcg-mq-bracket-l dcg-mq-paren"+(h.side===e?" dcg-mq-ghost":"")},[m.html()]),c.block("span",{style:"margin-left:"+m.width+";margin-right:"+v.width,class:"dcg-mq-bracket-middle dcg-mq-non-leaf"},M[0]),c("span",{style:"width:"+v.width,class:"dcg-mq-scaled dcg-mq-bracket-r dcg-mq-paren"+(h.side===t?" dcg-mq-ghost":"")},[v.html()])])}),D.prototype.html.call(this)},f.prototype.getSymbol=function(h){var m=this.sides[h||e].ch;return wf[m]||{width:"0",html:""}},f.prototype.latexRecursive=function(h){this.checkCursorContextOpen(h),h.latex+="\\left"+this.sides[t].ctrlSeq,this.getEnd(t).latexRecursive(h),h.latex+="\\right"+this.sides[e].ctrlSeq,this.checkCursorContextClose(h)},f.prototype.mathspeak=function(h){var m=this.sides[t].ch,v=this.sides[e].ch;if(m==="|"&&v==="|")this.mathspeakTemplate=["StartAbsoluteValue,",", EndAbsoluteValue"],this.ariaLabel="absolute value";else if(h&&h.createdLeftOf&&this.side){var M="";return this.side===t?M=this.textTemplate[0]:this.side===e&&(M=this.textTemplate[1]),(this.side===t?"left ":"right ")+Mu[M]}else this.mathspeakTemplate=["left "+Mu[m]+",",", right "+Mu[v]],this.ariaLabel=Mu[m]+" block";return D.prototype.mathspeak.call(this)},f.prototype.matchBrack=function(h,m,v){return v instanceof f&&v.side&&v.side!==-m&&(!h.restrictMismatchedBrackets||xf[this.sides[this.side].ch]===v.sides[v.side].ch||{"(":"]","[":")"}[this.sides[t].ch]===v.sides[e].ch)&&v},f.prototype.closeOpposing=function(h){h.side=0,h.sides[this.side]=this.sides[this.side];var m=h.delimFrags[this.side===t?t:e].removeClass("dcg-mq-ghost");this.replaceBracket(m,this.side)},f.prototype.createLeftOf=function(h){var m;if(!this.replacedFragment){var v=h.options;this.sides[t].ch==="|"?m=this.matchBrack(v,e,h[e])||this.matchBrack(v,t,h[t])||this.matchBrack(v,0,h.parent.parent):m=this.matchBrack(v,-this.side,h[-this.side])||this.matchBrack(v,-this.side,h.parent.parent)}if(m){var M=this.side=-m.side;this.closeOpposing(m),m===h.parent.parent&&h[M]&&new _(h[M],h.parent.getEnd(M),-M).disown().withDirAdopt(-M,m.parent,m,m[M]).domFrag().insDirOf(M,m.domFrag()),m.bubble(function(B){B.reflow()})}else m=this,M=m.side,m.replacedFragment?m.side=0:h[-M]&&(m.replaces(new _(h[-M],h.parent.getEnd(-M),M)),h[-M]=0),D.prototype.createLeftOf.call(this,h);M===t?h.insAtLeftEnd(m.getEnd(t)):h.insRightOf(m)},f.prototype.placeCursor=function(){},f.prototype.unwrap=function(){this.getEnd(t).children().disown().adopt(this.parent,this,this[e]).domFrag().insertAfter(this.domFrag()),this.remove()},f.prototype.deleteSide=function(h,m,v){var M=this.parent,B=this[h],j=M.getEnd(h);if(h===this.side){this.unwrap(),B?v.insDirOf(-h,B):v.insAtDirEnd(h,M);return}var ee=v.options,ce=!this.side;if(this.side=-h,this.matchBrack(ee,h,this.getEnd(t).getEnd(this.side))){this.closeOpposing(this.getEnd(t).getEnd(this.side));var Ue=this.getEnd(t).getEnd(h);this.unwrap(),Ue&&Ue.siblingCreated(v.options,h),B?v.insDirOf(-h,B):v.insAtDirEnd(h,M)}else{if(this.matchBrack(ee,h,this.parent.parent))this.parent.parent.closeOpposing(this),this.parent.parent.unwrap();else if(m&&ce){this.unwrap(),B?v.insDirOf(-h,B):v.insAtDirEnd(h,M);return}else{this.sides[h]=P5(this),this.delimFrags[t].removeClass("dcg-mq-ghost"),this.delimFrags[e].removeClass("dcg-mq-ghost");var Me=this.delimFrags[h].addClass("dcg-mq-ghost");this.replaceBracket(Me,h)}if(B){var ke=this.getEnd(t),Ue=ke.getEnd(h);ke.domFrag().removeClass("dcg-mq-empty"),new _(B,j,-h).disown().withDirAdopt(-h,ke,Ue,0).domFrag().insAtDirEnd(h,ke.domFrag().oneElement()),Ue&&Ue.siblingCreated(v.options,h),v.insDirOf(-h,B)}else m?v.insDirOf(h,this):v.insAtDirEnd(h,this.getEnd(t))}},f.prototype.replaceBracket=function(h,m){var v=this.getSymbol(m);if(h.children().replaceWith(L(v.html())),h.oneElement().style.width=v.width,m===t){var M=h.next();M.isEmpty()||(M.oneElement().style.marginLeft=v.width)}else{var B=h.prev();B.isEmpty()||(B.oneElement().style.marginRight=v.width)}},f.prototype.deleteTowards=function(h,m){this.deleteSide(-h,!1,m)},f.prototype.finalizeTree=function(){this.getEnd(t).deleteOutOf=function(h,m){this.parent.deleteSide(h,!0,m)},this.finalizeTree=this.intentionalBlur=function(){this.delimFrags[this.side===t?e:t].removeClass("dcg-mq-ghost"),this.side=0}},f.prototype.siblingCreated=function(h,m){m===-this.side&&this.finalizeTree()},f}(Z0);function P5(D){var f=D.side,h=D.sides[f];return{ch:xf[h.ch],ctrlSeq:xf[h.ctrlSeq]}}var xf={"(":")",")":"(","[":"]","]":"[","{":"}","}":"{","\\{":"\\}","\\}":"\\{","&lang;":"&rang;","&rang;":"&lang;","\\langle ":"\\rangle ","\\rangle ":"\\langle ","|":"|","\\lVert ":"\\rVert ","\\rVert ":"\\lVert "},Mu={"&lang;":"angle-bracket","&rang;":"angle-bracket","|":"pipe"};function VG(D,m,h){var m=m||D,v=xf[D],M=xf[m];z[D]=function(){return new _l(t,D,v,m,M)},z[v]=function(){return new _l(e,D,v,m,M)},Mu[D]=Mu[v]=h}VG("(","","parenthesis"),VG("[","","bracket"),VG("{","\\{","brace"),A.langle=function(){return new _l(t,"&lang;","&rang;","\\langle ","\\rangle ")},A.rangle=function(){return new _l(e,"&lang;","&rang;","\\langle ","\\rangle ")},z["|"]=function(){return new _l(t,"|","|","|","|")},A.lVert=function(){return new _l(t,"&#8741;","&#8741;","\\lVert ","\\rVert ")},A.rVert=function(){return new _l(e,"&#8741;","&#8741;","\\lVert ","\\rVert ")},A.left=function(D){pt(f,D);function f(){return D!==null&&D.apply(this,arguments)||this}return f.prototype.parser=function(){var h=ht.regex,m=ht.string,v=ht.optWhitespace;return v.then(h(/^(?:[([|]|\\\{|\\langle(?![a-zA-Z])|\\lVert(?![a-zA-Z]))/)).then(function(M){var B=M.replace(/^\\/,"");return M=="\\langle"&&(B="&lang;",M=M+" "),M=="\\lVert"&&(B="&#8741;",M=M+" "),rr.then(function(j){return m("\\right").skip(v).then(h(/^(?:[\])|]|\\\}|\\rangle(?![a-zA-Z])|\\rVert(?![a-zA-Z]))/)).map(function(ee){var ce=ee.replace(/^\\/,"");ee=="\\rangle"&&(ce="&rang;",ee=ee+" "),ee=="\\rVert"&&(ce="&#8741;",ee=ee+" ");var Ue=new _l(0,B,ce,M,ee);return Ue.blocks=[j],j.adopt(Ue,0,0),Ue})})})},f}(Ci),A.right=function(D){pt(f,D);function f(){return D!==null&&D.apply(this,arguments)||this}return f.prototype.parser=function(){return ht.fail("unmatched \\right")},f}(Ci);var IG=wf["("],MG=wf[")"],e1=function(D){pt(f,D);function f(){var h=D!==null&&D.apply(this,arguments)||this;return h.ctrlSeq="\\binom",h.domView=new Mr(2,function(m){return c("span",{class:"dcg-mq-non-leaf dcg-mq-bracket-container"},[c("span",{style:"width:"+IG.width,class:"dcg-mq-paren dcg-mq-bracket-l dcg-mq-scaled"},[IG.html()]),c("span",{style:"margin-left:"+IG.width+"; margin-right:"+MG.width,class:"dcg-mq-non-leaf dcg-mq-bracket-middle"},[c("span",{class:"dcg-mq-array dcg-mq-non-leaf"},[c.block("span",{},m[0]),c.block("span",{},m[1])])]),c("span",{style:"width:"+MG.width,class:"dcg-mq-paren dcg-mq-bracket-r dcg-mq-scaled"},[MG.html()])])}),h.textTemplate=["choose(",",",")"],h.mathspeakTemplate=["StartBinomial,","Choose",", EndBinomial"],h.ariaLabel="binomial",h}return f}(Z0);A.binom=A.binomial=e1,A.choose=function(D){pt(f,D);function f(){return D!==null&&D.apply(this,arguments)||this}return f.prototype.createLeftOf=function(h){A5.prototype.createLeftOf(h)},f}(e1);var O5=function(D){pt(f,D);function f(){var h=D!==null&&D.apply(this,arguments)||this;return h.ctrlSeq="\\MathQuillMathField",h.domView=new Mr(1,function(m){return c("span",{class:"dcg-mq-editable-field"},[c.block("span",{class:"dcg-mq-root-block","aria-hidden":"true"},m[0])])}),h}return f.prototype.parser=function(){var h=this,m=ht.string,v=ht.regex,M=ht.succeed;return m("[").then(v(/^[a-z][a-z0-9]*/i)).skip(m("]")).map(function(B){h.name=B}).or(M(void 0)).then(D.prototype.parser.call(this))},f.prototype.finalizeTree=function(h){var m=new ta(this.getEnd(t),this.domFrag().oneElement(),h);m.KIND_OF_MQ="MathField",m.editable=!0,m.createTextarea(),m.editablesTextareaEvents(),m.cursor.insAtRightEnd(m.root),Ge(m.root);function v(M){if(M.parentNode&&!L(M).hasClass("dcg-mq-root-block")&&v(M.parentNode),M.nodeType===Node.ELEMENT_NODE){var B=M;B.getAttribute("aria-hidden")==="true"&&(B.removeAttribute("aria-hidden"),L(M).children().eachElement(function(j){j.setAttribute("aria-hidden","true")}))}}v(this.domFrag().parent().oneElement()),this.domFrag().oneElement().removeAttribute("aria-hidden")},f.prototype.registerInnerField=function(h,m){var v=this.getEnd(t).controller,M=new m(v);h[this.name]=M,h.push(M)},f.prototype.latexRecursive=function(h){this.checkCursorContextOpen(h),this.getEnd(t).latexRecursive(h),this.checkCursorContextClose(h)},f.prototype.text=function(){return this.getEnd(t).text()},f}(Ci);A.editable=A.MathQuillMathField=O5;var t1=function(D){pt(f,D);function f(){return D!==null&&D.apply(this,arguments)||this}return f.prototype.setOptions=function(h){function m(){return""}return this.text=h.text||m,this.domView=new Mr(0,function(){return c("span",{},[l(h.htmlString||"")])}),this.latex=h.latex||m,this},f.prototype.latexRecursive=function(h){this.checkCursorContextOpen(h),h.latex+=this.latex(),this.checkCursorContextClose(h)},f.prototype.parser=function(){var h=this,m=ht.string,v=ht.regex,M=ht.succeed;return m("{").then(v(/^[a-z][a-z0-9]*/i)).skip(m("}")).then(function(B){return m("[").then(v(/^[-\w\s]*/)).skip(m("]")).or(M(void 0)).map(function(j){return h.setOptions(ye[B](j))})})},f}(gn);if(A.embed=t1,window.jQuery){Ze=Lt(1);for(var r1 in Ze)(function(D,f){typeof f=="function"?(qe[D]=function(){return Ae(),f.apply(this,arguments)},qe[D].prototype=f.prototype):qe[D]=f})(r1,Ze[r1])}})()});function Co(t,e){vv&&vv.notify(t,e)}function Rp(t,e,r,i){if(e){e=__dcg_shared_module_exports__['b']({},e);for(var n in e)try{e[n]=JSON.stringify(e[n],null,2)}catch(o){e[n]="[[could not stringify]]"}}vv&&vv.leaveBreadcrumb(t,e,r,i)}var vv,Wl=__dcg_shared_module_exports__['f'](()=>{});function nq(t,e){if(e!=null){if(typeof t!="string")throw new Error("Must pass a string for an EventHandler name");if(typeof e!="function")throw new Error("Must pass a function for an EventHandler callback");return{bindings:{onMount:function(r){r[t.toLowerCase()]=function(i){i&&e.apply(this,arguments)}}}}}}var r2,i2=__dcg_shared_module_exports__['f'](()=>{r2=nq});function oq(t){var e=function(){return t};return e.isDCGViewConst=!0,e}function sq(t){return!!(typeof t=="function"&&t.isDCGViewConst)}var ao,tc=__dcg_shared_module_exports__['f'](()=>{ao={isConst:sq,makeConst:oq}});function aq(t,e,r){r===void 0?t.removeAttribute(e):t.setAttribute(e,r+"")}var ZC,RI=__dcg_shared_module_exports__['f'](()=>{ZC={update:aq}});function lq(t,e){var r=e(),i;return ao.isConst(e)||(i={onUpdate:function(n){var o=e();o!==r&&(r=o,ZC.update(n,t,o))}}),{value:r,bindings:i}}var n2,o2=__dcg_shared_module_exports__['f'](()=>{tc();RI();n2=lq});function cq(t){return t[0]==="o"&&t[1]==="n"&&t[2].toUpperCase()===t[2]}var s2,a2=__dcg_shared_module_exports__['f'](()=>{s2=cq});function dq(t,e){NI[t]=e}function hq(t){return NI.hasOwnProperty(t)}function pq(t,e){var r=NI[t];return r(e)}var NI,By,BI=__dcg_shared_module_exports__['f'](()=>{NI={};By={isCustomAttribute:hq,add:dq,parse:pq}});function uq(t,e,r){var i=t._bindings[e];i?i.push(r):t._bindings[e]=[r]}function gq(t,e){var r=t._bindings[e];if(r)for(var i=r.length,n=0;n<i;n++)r[n]()}var qs,Ky=__dcg_shared_module_exports__['f'](()=>{qs={add:uq,invoke:gq}});function mq(t){Wg.push(t)}function fq(t){var e=Wg;Wg=[];for(var r=0;r<e.length;r++){var i=e[r];i!==t&&Wg.push(i)}}function yq(t,e){try{if(e&&e._isDCGView){t+=" ["+e._viewName+"]";var r=e.traceViewHierarchy();r.ancestors.length>0&&(t+=`
View Hierarchy:
`+r.formatted)}throw new Error(t)}catch(n){console.warn(n);for(var i=0;i<Wg.length;i++)Wg[i](n)}}var Wg,Xc,Uy=__dcg_shared_module_exports__['f'](()=>{Wg=[];Xc={warn:yq,addWarningHandler:mq,removeWarningHandler:fq}});function xq(t,e,r){var i=!1;return function(){if(i){Xc.warn(t+" is a one-time binding but was called multiple times",r);return}i=!0,e.apply(this,arguments)}}function vq(t,e,r){var i=r.bindings;if(i)for(var n in i){var o=i[n];n in bq&&(o=o.bind(null,e)),n in wq&&(o=xq(n,o,t)),qs.add(t,n,o)}}function Cq(t,e){if(typeof e!="function")throw new Error('The "'+t+'" attr must be a function. It is: '+JSON.stringify(e));return By.isCustomAttribute(t)?By.parse(t,e):s2(t)?r2(t,e):n2(t,e)}function Dq(t,e,r){if(e)for(var i in e){var n=Cq(i,e[i]);if(n){var o=n.value;o!==void 0&&r.setAttribute(i,o),n.bindings&&vq(t,r,n)}}}var bq,wq,l2,c2=__dcg_shared_module_exports__['f'](()=>{i2();o2();a2();BI();Ky();Uy();bq={onMount:!0,didMount:!0,willUnmount:!0,willUpdate:!0,onUpdate:!0,didUpdate:!0},wq={willMount:!0,onMount:!0,didMount:!0,willUnmount:!0,onUnmount:!0,didUnmount:!0};l2=Dq});function Sq(){d2=!0}function Eq(t,e,r){if(typeof r!="function")throw new Error("bindText expects a function");var i=r();i==null&&(i="");var n=document.createTextNode(i);if(d2){var o=document.createElement("span");o.appendChild(n),e.appendChild(o)}else e.appendChild(n);qs.add(t,"onUpdate",function(){var s=r();s==null&&(s=""),i!==s&&(n.nodeValue=s,i=s)})}var d2,eD,KI=__dcg_shared_module_exports__['f'](()=>{Ky();d2=!1;eD={bindText:Eq,enableSpanWrapping:Sq}});function h2(t,e){var r=document.createTextNode(e);t.appendChild(r)}function UI(t,e,r){if(this.tagName=t,this.attrs=e,this.children=r,Array.isArray(this.children))for(var i=0;i<this.children.length;i++){var n=typeof this.children[i];n!=="object"&&n!=="function"||(this.children[i]._parentElement=this)}}var kq,p2,u2=__dcg_shared_module_exports__['f'](()=>{c2();KI();tc();Uy();kq=eD.bindText;UI.prototype._isDCGElement=!0;UI.prototype.renderToDocFrag=function(t,e){if(this._domNode)throw new Error("Cannot remount a DCGElement");var r=this.children,i=document.createElement(this.tagName);this._domNode=i,l2(e,this.attrs,i),t.appendChild(i);for(var n=r.length,o=0;o<n;o++){var s=r[o];s._isDCGElement?s.renderToDocFrag(i,e):ao.isConst(s)?h2(i,s()):typeof s=="function"?kq(e,i,s):(Xc.warn("Text should be a const or a getter: "+JSON.stringify(s),e),h2(i,s))}};p2=UI});function g2(t,e){if(t!=null)if(Array.isArray(t))for(var r=0;r<t.length;r++)g2(t[r],e);else e.push(t)}function Gq(t,e){for(var r=[],i=arguments.length-1,n=2;n<=i;n++)g2(arguments[n],r);if(typeof t=="string")return new p2(t,e,r);if(t&&t._isDCGViewClass)return new t(e,r);throw new Error("createElement expects a String or DCGViewClass")}var Qc,jg=__dcg_shared_module_exports__['f'](()=>{u2();Qc=Gq});function Vq(){for(var t=this._element;t._isDCGView;)t=t._element;return t._domNode}function Iq(t,e){if(e&&e._childViews.push(this),this.__generatedHTMLBefore)throw new Error("Cannot remount a DCGView");if(this.__generatedHTMLBefore=!0,this._element.renderToDocFrag(t,this),Array.isArray(this._siblingElements))for(var r=0;r<this._siblingElements.length;r++)this._siblingElements[r].renderToDocFrag(t,this)}function Mq(t,e,r){if(!t||!t._isDCGViewClass)throw new Error("Must pass a DCGView class to be mounted");if(!e||e.nodeType!==1)throw new Error("Must pass an HTMLElement for the node");if(e._mountedDCGView)throw new Error("This node is already mounted by a view");var i=new t(r),n=document.createDocumentFragment();return i.renderToDocFrag(n),e.innerHTML="",qI(i),e._mountedDCGView=i,e.appendChild(n),HI(i),zI(i),i}function Tq(t){var e=t._mountedDCGView;if(!e)throw new Error("This node is not mounted by a DCGView");$I(e),t.innerHTML="",delete t._mountedDCGView,WI(e),jI(e)}function qI(t){t.willMount&&t.willMount(),qs.invoke(t,"willMount"),t._childViews.forEach(qI)}function HI(t){t._isMounted=!0,t.onMount&&t.onMount(),qs.invoke(t,"onMount"),t._childViews.forEach(HI)}function zI(t){t.didMount&&t.didMount(),qs.invoke(t,"didMount"),t._childViews.forEach(zI)}function $I(t){t.willUnmount&&t.willUnmount(),qs.invoke(t,"willUnmount"),t._childViews.forEach($I)}function WI(t){t._isMounted=!1,t._childViews.forEach(WI),qs.invoke(t,"onUnmount"),t.onUnmount&&t.onUnmount()}function jI(t){t._childViews.forEach(jI),qs.invoke(t,"didUnmount"),t.didUnmount&&t.didUnmount()}function Aq(t,e){var r=document.createDocumentFragment();return t.renderToDocFrag(r,e),r.firstChild}var Qt,jh=__dcg_shared_module_exports__['f'](()=>{Ky();Qt={renderToDocFrag:Iq,findRootNode:Vq,createNodeForView:Aq,willMount:qI,onMount:HI,didMount:zI,willUnmount:$I,onUnmount:WI,didUnmount:jI,mountToNode:Mq,unmountFromNode:Tq}});function Lq(){if(!this._isMounted)return Xc.warn("Trying to update view that is not mounted. Ignoring update.",this);if(!(this.shouldUpdate&&!this.shouldUpdate())){if(this.willUpdate&&this.willUpdate(),qs.invoke(this,"willUpdate"),qs.invoke(this,"onUpdate"),this.onUpdate&&this.onUpdate(),this.overrideChildUpdates)this.overrideChildUpdates();else for(var t=this._childViews,e=t.length,r=0;r<e;r++)t[r].update();qs.invoke(this,"didUpdate"),this.didUpdate&&this.didUpdate()}}var m2,f2=__dcg_shared_module_exports__['f'](()=>{Ky();Uy();m2={update:Lq}});function Pq(t){var e=arguments.length;if(e<2)return t;for(var r=1;r<e;r++)for(var i=arguments[r],n=Object.keys(i),o=n.length,s=0;s<o;s++){var a=n[s];t[a]=i[a]}return t}var Zc,Jg=__dcg_shared_module_exports__['f'](()=>{Zc=Pq});function Oq(t){if(!t)throw new Error("must pass a spec to DCGView.createClass");if(typeof t.template!="function")throw new Error("must pass a template function to DCGView.createClass");var e=function(i,n){this._viewName=t.viewName||(this.constructor?this.constructor.name:"Anonymous DCGView"),this._setupProps(i,n),this.init&&this.init(),this._callTemplate()};e.prototype._setupProps=function(i,n){if(i){for(var o in i){var s=i[o];if(typeof s!="function"&&s!==void 0)throw new Error('The "'+o+'" prop must be a function. It is: '+JSON.stringify(s))}this.props=i}else this.props={};this.children=n,this._childViews=[],this._bindings={}},e.prototype._callTemplate=function(){if(this._element=this.template(),!this._element||!this._element._isDCGElement)throw new Error("template() must return a DCGElement");this._element._parentElement=this},e.prototype.bindFn=function(i){return i.bind(this)},e.prototype.findRootNode=Qt.findRootNode,e.prototype.renderToDocFrag=Qt.renderToDocFrag,e.prototype.const=ao.makeConst,e.prototype.spread=Zc,e.prototype.createElement=Qc,e.prototype.update=m2.update,e.prototype.traceViewHierarchy=function(){for(var i=[],n=this._parentElement;n;n=n._parentElement)i.unshift(n);var o=i.concat([this]).filter(function(s){return!(!s._isDCGView||s._isDCGSwitch&&s._parentElement&&s._parentElement._isDCGIf||s._isDCGIfDefinedWrapper||s._isDCGSwitchWrapper||s._isDCGSwitchUnionWrapper)}).map(function(s,a){for(var l="";a-- >0;)l+="  ";return l+"<"+s._viewName+">"}).join(`
`);return{ancestors:i,formatted:o}};for(var r in t)if(t.hasOwnProperty(r))if(!e.prototype.hasOwnProperty(r))e.prototype[r]=t[r];else throw new Error("Cannot override the "+r+"() method");return e._isDCGViewClass=!0,e.prototype._isDCGView=!0,e.prototype._isDCGElement=!0,e}var Ui,ml=__dcg_shared_module_exports__['f'](()=>{jg();jh();f2();tc();Jg();Ui=Oq});function y2(t){var e=t(),r=typeof e;if(r==="string")return e;if(!r||r!=="object")throw new Error("Unsupported type returned from style getter: "+r);var i="";for(var n in e){var o=e[n];e.hasOwnProperty(n)&&o!=null&&(i?i+=";"+n+":"+o:i=n+":"+o)}return i}function _q(t){var e,r=y2(t);return ao.isConst(t)||(e={onUpdate:function(i){var n=y2(t);r!==n&&(ZC.update(i,"style",n),r=n)}}),{value:r,bindings:e}}var b2,w2=__dcg_shared_module_exports__['f'](()=>{tc();RI();b2=_q});function x2(t){var e=t(),r=typeof e;if(r==="string")return e;if(!r||r!=="object")throw new Error("Unsupported type returned from class getter: "+r);var i="";for(var n in e)if(e.hasOwnProperty(n)){var o=e[n];o&&(i?i+=" "+n:i=n)}return i}function Fq(t,e,r){for(var i=[],n=t.className.replace(v2,"").split(C2),o=e.replace(v2,"").split(C2),s={},a=o.length-1;a>=0;a--)s[o[a]]=!0;var l=n.length;for(a=0;a<l;a++){var c=n[a];s.hasOwnProperty(c)||i.push(c)}return r?i.length?r+" "+i.join(" "):r:i.join(" ")}function Rq(t){var e,r=x2(t);return ao.isConst(t)||(e={onUpdate:function(i){var n=x2(t);r!==n&&(i.className===r?(i.className=n,r=n):(i.className=Fq(i,r,n),r=n))}}),{value:r,bindings:e}}var v2,C2,D2,S2=__dcg_shared_module_exports__['f'](()=>{tc();v2=/^\s+|\s+$/g,C2=/\s+/;D2=Rq});function Nq(t){return function(e){if(typeof e!="function")throw new Error("The "+t+" attribute expects a function for the value");if(ao.isConst(e))throw new Error("The "+t+" attribute does not expect a const for the value");var r={bindings:{}};return r.bindings[t]=e,r}}var ed,E2=__dcg_shared_module_exports__['f'](()=>{tc();ed=Nq});function k2(t){var e=t.length,r=new Array(e),i=new Array(e+1),n=0,o,s;for(s=0;s<e;s++){if(t[i[n]]<t[s])o=n+1;else{for(var a=1,l=n-1;a<=l;){var c=Math.ceil((a+l)/2);t[i[c]]<t[s]?a=c+1:l=c-1}o=a}r[s]=i[o-1],i[o]=s,o>n&&(n=o)}var d=new Array(n),u=i[n];for(s=n-1;s>=0;s--)d[s]=t[u],u=r[u];return d}var G2=__dcg_shared_module_exports__['f'](()=>{});function Bq(t,e){var r={},i,n,o=[],s=[];for(i=0;i<e.length;i++)n=e[i],r[n]=i;for(i=0;i<t.length;i++)n=t[i],r[n]===void 0&&o.push(n);var a=[];for(i=0;i<t.length;i++){n=t[i];var l=r[n];l!==void 0&&a.push(l)}var c=k2(a),d={};for(i=0;i<c.length;i++)n=e[c[i]],d[n]=!0;for(i=e.length-1;i>=0;i--)n=e[i],!d[n]&&s.push({key:n,beforeKey:e[i+1]});return{removes:o,inserts:s}}var tD,JI=__dcg_shared_module_exports__['f'](()=>{G2();tD=Bq});function Hq(t,e){return Qc(qq,{items:t,keyFunction:e.key,viewFunction:e.item})}var Kq,Uq,qq,V2,I2=__dcg_shared_module_exports__['f'](()=>{ml();JI();jg();jh();Kq=Ui({viewName:"EachPlaceholder",_isDCGEachPlaceholder:!0,template:function(){return this.createElement("div",{style:this.const("display: none")})}}),Uq=Ui({viewName:"EachWrapper",_isDCGEachWrapper:!0,template:function(){return this.children[0]}}),qq=Ui({viewName:"Each",_isDCGEach:!0,getKeys:function(){this._keyToItem={};var t=this.props.items(),e=this.props.keyFunction?t.map(this.props.keyFunction):t.slice(0);if(!this._chosenKeyType&&e.length&&(this._chosenKeyType=typeof e[0],this._chosenKeyType!=="string"&&this._chosenKeyType!=="number"))throw new Error("The key: "+JSON.stringify(e[0])+" is not a string or number");for(var r=0;r<e.length;r++){var i=e[r];if(typeof i!==this._chosenKeyType)throw new Error("Keys must be the same type. "+JSON.stringify(i)+" is not a "+this._chosenKeyType);if(i in this._keyToItem)throw new Error("The key: "+JSON.stringify(i)+" is not unique");this._keyToItem[i]=t[r]}return e},createViewForKey:function(t){var e=this._keyToItem[t],r=this.props.viewFunction.call(this,e,t),i=r;return i._isDCGView||(i=this.createElement(Uq,null,r)),this._keyToView[t]=i,i},template:function(){this._keyToView={},this._keys=this.getKeys(),this._element=this.createElement(Kq,null),this._siblingElements=[];for(var t=0;t<this._keys.length;t++){var e=this._keys[t],r=this.createViewForKey(e);r._parentElement=this._element._parentElement,this._siblingElements.push(r)}return this._element},detachAllRemovedViews:function(){for(var t=this._childViews,e=0,r=t.length,i,n=0;n<r;n++)i=t[n],i._will_be_unmounted_?e++:t[n-e]=i;t.splice(r-e,e)},overrideChildUpdates:function(){var t=this._keys,e=this.getKeys();this._keys=e;var r=this._element.findRootNode().parentNode,i,n,o,s,a,l,c=tD(t,e),d=[];for(i=c.removes.length-1;i>=0;i--)l=c.removes[i],d.push(this._keyToView[l]);for(d.forEach(Qt.willUnmount),i=0;i<c.removes.length;i++)l=c.removes[i],n=this._keyToView[l],delete this._keyToView[l],n._will_be_unmounted_=!0,r.removeChild(n.findRootNode());d.length>0&&this.detachAllRemovedViews(),d.forEach(Qt.onUnmount),d.forEach(Qt.didUnmount);var u=[];for(i=c.inserts.length-1;i>=0;i--)l=c.inserts[i].key,l in this._keyToView||(n=this.createViewForKey(l),u.push(n),Qt.createNodeForView(n,this));for(u.forEach(Qt.willMount),i=0;i<c.inserts.length;i++)a=c.inserts[i],o=this._keyToView[a.key].findRootNode(),a.beforeKey!==void 0?s=this._keyToView[a.beforeKey].findRootNode():s=null,r.insertBefore(o,s);u.forEach(Qt.onMount),u.forEach(Qt.didMount);var p=this._childViews,g=p.length-u.length;for(i=0;i<g;i++)p[i].update()}});V2=Hq});var zq,$q,M2,T2=__dcg_shared_module_exports__['f'](()=>{ml();JI();tc();jh();zq=Ui({viewName:"ForWrapper",template:function(){return this.children[0]}}),$q=Ui({viewName:"For",_isDCGFor:!0,getKeys:function(){this._keyToItem={};var t=this.props.each();if(!Array.isArray(t))throw new Error("<For each={}> must return an array");var e=this.props.key?t.map(this.props.key):t.slice(0);if(!this._chosenKeyType&&e.length&&(this._chosenKeyType=typeof e[0],this._chosenKeyType!=="string"&&this._chosenKeyType!=="number"))throw new Error("The key: "+JSON.stringify(e[0])+" is not a string or number");for(var r=0;r<e.length;r++){var i=e[r];if(typeof i!==this._chosenKeyType)throw new Error("Keys must be the same type. "+JSON.stringify(i)+" is not a "+this._chosenKeyType);if(i in this._keyToItem)throw new Error("The key: "+JSON.stringify(i)+" is not unique");this._keyToItem[i]=t[r]}return e},createViewForKey:function(t){var e=this._keyToItem[t],r=this._viewFunction.call(this,e,t),i=r;return i._isDCGView||(i=this.createElement(zq,null,r)),this._keyToView[t]=i,i},template:function(){if(this._keyToView={},typeof this.props.each!="function")throw new Error("<For each={}> must be a function");if(this.children.length!==1)throw new Error("<For> expects a single child. You passed "+this.children.length);var t=this.children[0];if(!t||!t._isDCGElement)throw new Error("<For> expects the root node to be a DCGElement. You passed "+JSON.stringify(t));if(t._isDCGView)throw new Error("<For> expects the root node to not be a DCGView. Pass in something like <div> or <span>");if(t.children.length!==1)throw new Error("<For> expects a root node with a single child. You passed "+t.children.length);if(this._viewFunction=t.children[0],this._viewFunction&&this._viewFunction._isDCGElement)throw new Error("<For> expects a function that constructs a DCGElement. You passed a DCGElement directly");if(typeof this._viewFunction!="function"){var e=JSON.stringify(this._viewFunction);throw new Error("<For> expects a function that constructs a DCGElement. You passed "+e)}if(ao.isConst(this._viewFunction))throw new Error("<For> expects a function that constructs a DCGElement. You passed a constant");this._keys=this.getKeys();for(var r=[],i=0;i<this._keys.length;i++){var n=this._keys[i],o=this.createViewForKey(n);o._parentElement=this,r.push(o)}return t.children=r,t},detachAllRemovedViews:function(){for(var t=this._childViews,e=0,r=t.length,i,n=0;n<r;n++)i=t[n],i._will_be_unmounted_?e++:t[n-e]=i;t.splice(r-e,e)},overrideChildUpdates:function(){var t=this._keys,e=this.getKeys();this._keys=e;var r=this.findRootNode(),i,n,o,s,a,l,c=tD(t,e),d=[];for(i=c.removes.length-1;i>=0;i--)l=c.removes[i],d.push(this._keyToView[l]);for(d.forEach(Qt.willUnmount),i=0;i<c.removes.length;i++)l=c.removes[i],n=this._keyToView[l],delete this._keyToView[l],n._will_be_unmounted_=!0,r.removeChild(n.findRootNode());d.length>0&&this.detachAllRemovedViews(),d.forEach(Qt.onUnmount),d.forEach(Qt.didUnmount);var u=[];for(i=c.inserts.length-1;i>=0;i--)l=c.inserts[i].key,l in this._keyToView||(n=this.createViewForKey(l),u.push(n),Qt.createNodeForView(n,this));for(u.forEach(Qt.willMount),i=0;i<c.inserts.length;i++)a=c.inserts[i],o=this._keyToView[a.key].findRootNode(),a.beforeKey!==void 0?s=this._keyToView[a.beforeKey].findRootNode():s=null,r.insertBefore(o,s);u.forEach(Qt.onMount),u.forEach(Qt.didMount);var p=this._childViews,g=p.length-u.length;for(i=0;i<g;i++)p[i].update()}}),M2=$q});var Wq,jq,rD,YI=__dcg_shared_module_exports__['f'](()=>{ml();tc();jh();Wq=Ui({viewName:"SwitchWrapper",_isDCGSwitchWrapper:!0,template:function(){return this.children[0]}}),jq=Ui({viewName:"Switch",_isDCGSwitch:!0,updateKey:function(){this._key=this.props.key()},createView:function(){var t=this._viewFunction(this._key);t==null&&(t=this.createElement("div",{style:this.const("display: none")}));var e=this.createElement(Wq,null,t);return e._parentElement=this,e},template:function(){if(this._key=void 0,typeof this.props.key!="function")throw new Error("<Switch key={}> must be a function");if(this.children.length!==1)throw new Error("<Switch> expects a single child. You passed "+this.children.length);if(this._viewFunction=this.children[0],this._viewFunction&&this._viewFunction._isDCGElement)throw new Error("<Switch> expects a function that constructs a DCGElement. You passed a DCGElement directly");if(typeof this._viewFunction!="function"){var t=JSON.stringify(this._viewFunction);throw new Error("<Switch> expects a function that constructs a DCGElement. You passed "+t)}if(ao.isConst(this._viewFunction))throw new Error("<Switch> expects a function that constructs a DCGElement. You passed a constant");return this.updateKey(),this.createView()},overrideChildUpdates:function(){var t=this._key;this.updateKey();var e=this._key;if(t===e)this._element.update();else{var r=this.findRootNode(),i=document.createTextNode("");r.parentNode.insertBefore(i,r),Qt.willUnmount(this._element),this._childViews=[],r.parentNode.removeChild(r),Qt.onUnmount(this._element),Qt.didUnmount(this._element),this._element=this.createView();var n=Qt.createNodeForView(this._element,this);Qt.willMount(this._element),i.parentNode.insertBefore(n,i),i.parentNode.removeChild(i),Qt.onMount(this._element),Qt.didMount(this._element)}}}),rD=jq});function A2(t,e,r){return Qc(Yq,{getCase:function(){var i=e();return t?i&&i[t]:i},buildChildView:function(i){var n=r[i];if(n)return n(e)}})}function Xq(t,e){return typeof t=="string"?A2.bind(this,t,e):A2(void 0,t,e)}var Jq,Yq,iD,XI=__dcg_shared_module_exports__['f'](()=>{ml();jh();jg();Jq=Ui({viewName:"SwitchUnionWrapper",_isDCGSwitchUnionWrapper:!0,template:function(){return this.children[0]}}),Yq=Ui({viewName:"SwitchUnion",_isDCGSwitchUnion:!0,updateCase:function(){this._case=this.props.getCase()},createView:function(){var t=this.props.buildChildView(this._case);t==null&&(t=this.createElement("div",{style:this.const("display: none")}));var e=this.createElement(Jq,null,t);return e._parentElement=this,e},template:function(){return this._case=void 0,this.updateCase(),this.createView()},overrideChildUpdates:function(){var t=this._case;this.updateCase();var e=this._case;if(t===e)this._element.update();else{var r=this.findRootNode(),i=document.createTextNode("");r.parentNode.insertBefore(i,r),Qt.willUnmount(this._element),this._childViews=[],r.parentNode.removeChild(r),Qt.onUnmount(this._element),Qt.didUnmount(this._element),this._element=this.createView();var n=Qt.createNodeForView(this._element,this);Qt.willMount(this._element),i.parentNode.insertBefore(n,i),i.parentNode.removeChild(i),Qt.onMount(this._element),Qt.didMount(this._element)}}});iD=Xq});var Qq,L2,P2=__dcg_shared_module_exports__['f'](()=>{ml();tc();YI();Qq=Ui({viewName:"If",_isDCGIf:!0,template:function(){if(typeof this.props.predicate!="function")throw new Error("<If predicate={}> must be a function");if(this.children.length!==1)throw new Error("<If> expects a single child. You passed "+this.children.length);if(this._viewFunction=this.children[0],this._viewFunction&&this._viewFunction._isDCGElement)throw new Error("<If> expects a function that constructs a DCGElement. You passed a DCGElement directly");if(typeof this._viewFunction!="function"){var t=JSON.stringify(this._viewFunction);throw new Error("<If> expects a function that constructs a DCGElement. You passed "+t)}if(ao.isConst(this._viewFunction))throw new Error("<If> expects a function that constructs a DCGElement. You passed a constant");var e=function(){return!!this.props.predicate()}.bind(this),r=function(i){if(i)return this._viewFunction()}.bind(this);return this.createElement(rD,{key:e},r)}}),L2=Qq});function tH(t,e){return Qc(eH,{isDefined:function(){var r=t();return r!=null},buildChildView:function(){return e(t)}})}var Zq,eH,O2,_2=__dcg_shared_module_exports__['f'](()=>{ml();jh();jg();Zq=Ui({viewName:"IfDefinedWrapper",_isDCGIfDefinedWrapper:!0,template:function(){return this.children[0]}}),eH=Ui({viewName:"IfDefined",_isDCGIfDefined:!0,updateIsDefined:function(){this._isDefined=this.props.isDefined()},createView:function(){var t;this._isDefined&&(t=this.props.buildChildView()),t==null&&(t=this.createElement("div",{style:this.const("display: none")}));var e=this.createElement(Zq,null,t);return e._parentElement=this,e},template:function(){return this._isDefined=void 0,this.updateIsDefined(),this.createView()},overrideChildUpdates:function(){var t=this._isDefined;this.updateIsDefined();var e=this._isDefined;if(t===e)this._element.update();else{var r=this.findRootNode(),i=document.createTextNode("");r.parentNode.insertBefore(i,r),Qt.willUnmount(this._element),this._childViews=[],r.parentNode.removeChild(r),Qt.onUnmount(this._element),Qt.didUnmount(this._element),this._element=this.createView();var n=Qt.createNodeForView(this._element,this);Qt.willMount(this._element),i.parentNode.insertBefore(n,i),i.parentNode.removeChild(i),Qt.onMount(this._element),Qt.didMount(this._element)}}});O2=tH});function rH(t,e){var r=iD(function(){return t()?"true":"false"},e);return r._viewName="IfElse",r}var F2,R2=__dcg_shared_module_exports__['f'](()=>{XI();F2=rH});var N2,B2=__dcg_shared_module_exports__['f'](()=>{ml();Jg();N2=Ui({viewName:"Textarea",computeValue:function(){var t=this.props.value();return t==null?"":t+""},template:function(){if(!this.props.value)throw new Error('<Textarea> expects a "value={}" prop');if(!this.props.onInput)throw new Error('<Textarea> expects an "onInput={}" prop');var t=Zc({},this.props,{onInput:function(e){this.props.onInput(e.target.value),this._isMounted&&this.update()}.bind(this)});return this.props.disabled&&(t.disabled=function(){if(this.props.disabled())return!0}.bind(this)),delete t.value,this.createElement("textarea",t,this.const(this.computeValue()))},didUpdate:function(){this.rootDOM||(this.rootDOM=this.findRootNode());var t=this.computeValue();this.rootDOM.value!==t&&(this.rootDOM.value=t)}})});var K2,U2=__dcg_shared_module_exports__['f'](()=>{ml();Jg();K2=Ui({viewName:"Input",computeValue:function(){var t=this.props.value();return t==null?"":t+""},template:function(){if(!this.props.value)throw new Error('<Input> expects a "value={}" prop');if(!this.props.onInput)throw new Error('<Input> expects an "onInput={}" prop');var t=Zc({},this.props,{value:this.const(this.computeValue()),onInput:function(e){this.props.onInput(e.target.value),this._isMounted&&this.update()}.bind(this)});return this.props.onEnterPressed&&(t.onKeypress=function(e){e.which===13&&this.props.onEnterPressed()}.bind(this)),this.props.disabled&&(t.disabled=function(){if(this.props.disabled())return!0}.bind(this)),t.hasOwnProperty("tabindex")||(t.tabindex=function(){return this.props.disabled&&this.props.disabled()?"-1":"0"}.bind(this)),this.createElement("input",t)},didUpdate:function(){this.rootDOM||(this.rootDOM=this.findRootNode());var t=this.computeValue();this.rootDOM.value!==t&&(this.rootDOM.value=t)}})});var q2,H2=__dcg_shared_module_exports__['f'](()=>{ml();Jg();q2=Ui({viewName:"Checkbox",computeChecked:function(){return!!this.props.checked()},template:function(){if(!this.props.checked)throw new Error('<Checkbox> expects a "checked={}" prop');if(!this.props.onChange)throw new Error('<Checkbox> expects an "onChange={}" prop');var t=Zc({},this.props,{type:this.const("checkbox"),checked:this.const(this.computeChecked()?"checked":void 0),onChange:function(e){this.props.onChange(e.target.checked),this._isMounted&&this.update()}.bind(this)});return this.createElement("input",t)},didUpdate:function(){this.rootDOM||(this.rootDOM=this.findRootNode());var t=this.computeChecked();this.rootDOM.checked!==t&&(this.rootDOM.checked=t)}})});var z2,$2=__dcg_shared_module_exports__['f'](()=>{I2();T2();YI();XI();P2();_2();R2();B2();U2();H2();z2={Each:V2,For:M2,Switch:rD,SwitchUnion:iD,If:L2,IfDefined:O2,IfElse:F2,Textarea:N2,Input:K2,Checkbox:q2}});var W2,j2=__dcg_shared_module_exports__['f'](()=>{ml();W2=Ui({template:function(){}})});var iH,fl,rc,J2=__dcg_shared_module_exports__['f'](()=>{jg();ml();jh();Jg();tc();BI();w2();S2();E2();$2();Uy();KI();j2();iH=eD.enableSpanWrapping,fl={createElement:Qc,createClass:Ui,mountToNode:Qt.mountToNode,unmountFromNode:Qt.unmountFromNode,spread:Zc,const:ao.makeConst,isConst:ao.isConst,addCustomAttribute:By.add,Components:z2,addWarningHandler:Xc.addWarningHandler,removeWarningHandler:Xc.removeWarningHandler,_warn:Xc.warn,enableSpanWrapping:iH,Class:W2};fl.addCustomAttribute("style",b2);fl.addCustomAttribute("class",D2);fl.addCustomAttribute("willMount",ed("willMount"));fl.addCustomAttribute("onMount",ed("onMount"));fl.addCustomAttribute("didMount",ed("didMount"));fl.addCustomAttribute("willUnmount",ed("willUnmount"));fl.addCustomAttribute("onUnmount",ed("onUnmount"));fl.addCustomAttribute("didUnmount",ed("didUnmount"));fl.addCustomAttribute("willUpdate",ed("willUpdate"));fl.addCustomAttribute("onUpdate",ed("onUpdate"));fl.addCustomAttribute("didUpdate",ed("didUpdate"));rc=fl});function Ud(t,e){let i=new RegExp("[?|&]"+e+"=([^&;]+?)(&|#|;|$)").exec(t);return i?decodeURIComponent(i[1].replace(/\+/g,"%20")):null}function nH(t,e){return new RegExp("[?|&]"+e+"(=|&|;|$)").test(t)}function oH(t,e,r){if(e!==encodeURIComponent(e))throw new Error("Programming error: parameter name should be URL-safe without encoding.");let i=encodeURIComponent(r);if(t.length){let n=t.split("#"),o=/\?/.test(t)?`${n[0]}&${e}=${i}`:`${n[0]}?${e}=${i}`;return n[1]!==void 0?`${o}#${n[1]}`:o}else return`?${e}=${i}`}function sH(t,e,r){let n=new RegExp("([?|&])"+e+"=([^&;]+?)(&|#|;|$)").exec(t);if(!n)return t;let o=n[1],s=n[2],a=`${o}${e}=${s}`,l=encodeURIComponent(r),c=`${o}${e}=${l}`;return t.replace(a,c)}function nD(t,e,r){return nH(t,e)?sH(t,e,r):oH(t,e,r)}var Xp=__dcg_shared_module_exports__['f'](()=>{});function hH(t){let e=cH.exec(t);if(e){let r=e[1];return!dH.test(r)}return!1}function oD(t,e){let r=oo(),i="";return e!==void 0?i=e:i=r.lang?""+r.lang:"",t===""||i===""||aH.test(t)||lH.test(t)||hH(t)?t:nD(t,"lang",i)}var aH,lH,cH,dH,Y2=__dcg_shared_module_exports__['f'](()=>{ql();Xp();aH=/lang=[A-Za-z]+/,lH=/(cl|learn|help).desmos.com/,cH=/^(?:https?:)?(?:\/\/)?([^\s\/\?]+)/i,dH=/(^desmos\.com$)|(\.desmos.com$)/});var X2=__dcg_shared_module_exports__['f'](()=>{});var Z=__dcg_shared_module_exports__['g']((bie,Q2)=>{J2();Oe();Wl();Y2();X2();rc.addWarningHandler(t=>Co(t));rc.addCustomAttribute("href",function(t){let e=oD(t()),r={value:`${oD(t())}`,bindings:{onMount(i){if(!I(i).is("a")&&!I(i).is("use"))throw new Error("Cannot have an href on a non-link element.")}}};return r.bindings.onUpdate=function(i){let n=oD(t());e!==n&&(e=n,i.setAttribute("href",n))},r});rc.addCustomAttribute("onTap",t=>({value:"",bindings:{onMount(e){I(e).on("dcg-tap",t)}}}));rc.addCustomAttribute("ignoreRealClick",t=>({bindings:{onMount(e){I(e).on("click",function(r){t()&&r.preventDefault()})}}}));rc.addCustomAttribute("onTapStart",t=>({bindings:{onMount(e){I(e).on("dcg-tapstart",t)}}}));rc.addCustomAttribute("onTapMove",t=>({bindings:{onMount(e){I(e).on("dcg-tapmove",t)}}}));rc.addCustomAttribute("onTapEnd",t=>({bindings:{onMount(e){I(e).on("dcg-tapend",t)}}}));rc.addCustomAttribute("onLongHold",t=>({bindings:{onMount(e){I(e).on("dcg-longhold",t)}}}));rc.addCustomAttribute("manageFocus",function(t){return t()===void 0?{}:{bindings:{onMount(e){t().shouldBeFocused()&&e.focus(),e.onfocus=function(r){t().shouldBeFocused()||t().onFocusedChanged(!0,r)},e.onblur=function(r){t().shouldBeFocused()&&t().onFocusedChanged(!1,r)}},onUpdate(e){let r=t().shouldBeFocused(),i=document.activeElement===e;r&&!i?e.focus():i&&!r&&e.blur()},willUnmount(e){e.onfocus=null,e.onblur=null}}}});Q2.exports=rc});var ep=__dcg_shared_module_exports__['g']((tb,EM)=>{(function(e,r){if(typeof tb=="object"&&typeof EM=="object")EM.exports=r();else{var i=r();for(var n in i)(typeof tb=="object"?tb:e)[n]=i[n]}})(tb,function(){return function(t){var e={};function r(i){if(e[i])return e[i].exports;var n=e[i]={i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=t,r.c=e,r.i=function(i){return i},r.d=function(i,n,o){r.o(i,n)||Object.defineProperty(i,n,{configurable:!1,enumerable:!0,get:o})},r.n=function(i){var n=i&&i.__esModule?function(){return i.default}:function(){return i};return r.d(n,"a",n),n},r.o=function(i,n){return Object.prototype.hasOwnProperty.call(i,n)},r.p="",r(r.s=26)}([function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(22);function n(o,s){var a=i.map(o,s);return o.warnings&&(a.warnings=o.warnings),a}e.map=n},function(t,e){var r=t.exports={},i,n;function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?i=setTimeout:i=o}catch(E){i=o}try{typeof clearTimeout=="function"?n=clearTimeout:n=s}catch(E){n=s}})();function a(E){if(i===setTimeout)return setTimeout(E,0);if((i===o||!i)&&setTimeout)return i=setTimeout,setTimeout(E,0);try{return i(E,0)}catch(k){try{return i.call(null,E,0)}catch(S){return i.call(this,E,0)}}}function l(E){if(n===clearTimeout)return clearTimeout(E);if((n===s||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(E);try{return n(E)}catch(k){try{return n.call(null,E)}catch(S){return n.call(this,E)}}}var c=[],d=!1,u,p=-1;function g(){!d||!u||(d=!1,u.length?c=u.concat(c):p=-1,c.length&&b())}function b(){if(!d){var E=a(g);d=!0;for(var k=c.length;k;){for(u=c,c=[];++p<k;)u&&u[p].run();p=-1,k=c.length}u=null,d=!1,l(E)}}r.nextTick=function(E){var k=new Array(arguments.length-1);if(arguments.length>1)for(var S=1;S<arguments.length;S++)k[S-1]=arguments[S];c.push(new x(E,k)),c.length===1&&!d&&a(b)};function x(E,k){this.fun=E,this.array=k}x.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={};function w(){}r.on=w,r.addListener=w,r.once=w,r.off=w,r.removeListener=w,r.removeAllListeners=w,r.emit=w,r.prependListener=w,r.prependOnceListener=w,r.listeners=function(E){return[]},r.binding=function(E){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(E){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=["abs","ans","arccosh","arccot","arccoth","arccsc","arccsch","arcsec","arcsech","arcsinh","arctanh","binomialdist","boxplot","cdf","ceil","corr","cov","csch","distance","dotplot","erf","floor","gcf","histogram","IndependentTTest","iTTest","ittest","lcm","length","mad","mcd","mcm","mean","median","midpoint","mod","nCr","normaldist","nPr","pdf","poissondist","polygon","quantile","quartile","random","round","sech","sign","signum","sgn","stdDev","stddev","stdDevP","stddevp","stdev","stdevp","tdist","total","TScore","TScore","Tscore","tscore","tscore","TTest","ttest","var","variance","varp"],n=i,o=p(i),s;function a(g){for(var b=!1,x=0,w="",E="",k=0,S=g;k<S.length;k++){var T=S[k];if(T.type==="terminal"&&/[A-Za-z]/.test(T.value))w+=T.value,x++;else break}return E=w.replace(s,"\\operatorname{$1}"),b=x>0&&E!==w,{modified:b,terminalCount:x,value:E}}e.getAutoOperator=a;function l(g){return n.indexOf(g.toLowerCase())!==-1}e.containsValue=l;function c(g){if(!Array.isArray(g))throw new Error("Operator names must be an array, got "+typeof g);for(var b=0,x=g;b<x.length;b++){var w=x[b];if(typeof w!="string")throw new Error("Operator names must be strings, found "+typeof w)}n=g,u()}e.setOperatorNames=c;function d(){n=i,s=o}e.resetOperatorNames=d;function u(){s=p(n)}function p(g){var b=g.sort(function(x,w){return w.length-x.length||w.localeCompare(x)}).join("|");return new RegExp("("+b+")","g")}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(2),n=r(14),o=r(15),s=r(16),a=r(0),l=r(23),c=r(25);function d(x){if(!c.isSixDotCells(x))throw new Error("EncodingError: Expected input to be six-dot unicode braille characters.")}function u(x,w){return d(x),s.default(e.UnicodeBraille.toBrailleAscii(x),w)}e.nemethToLatex=u;function p(x,w){return w&&w.operatorNames?i.setOperatorNames(w.operatorNames):i.resetOperatorNames(),a.map(n.default(x),e.UnicodeBraille.coerceToSixDotCells)}e.latexToNemeth=p;function g(x,w){return d(x),l.default(e.UnicodeBraille.toBrailleAscii(x),w)}e.uebToLatex=g;function b(x,w){return w&&w.operatorNames?i.setOperatorNames(w.operatorNames):i.resetOperatorNames(),a.map(o.default(x),e.UnicodeBraille.coerceToSixDotCells)}e.latexToUeb=b,e.UnicodeBraille={coerceToSixDotCells:c.coerceToSixDotCells,toBrailleAscii:c.toBrailleAscii,toExpandedBrailleAscii:c.toExpandedBrailleAscii},e.version="1.0.3"},function(t,e){},function(t,e,r){(function(i){function n(c,d){for(var u=0,p=c.length-1;p>=0;p--){var g=c[p];g==="."?c.splice(p,1):g===".."?(c.splice(p,1),u++):u&&(c.splice(p,1),u--)}if(d)for(;u--;u)c.unshift("..");return c}var o=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,s=function(c){return o.exec(c).slice(1)};e.resolve=function(){for(var c="",d=!1,u=arguments.length-1;u>=-1&&!d;u--){var p=u>=0?arguments[u]:i.cwd();if(typeof p!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!p)continue;c=p+"/"+c,d=p.charAt(0)==="/"}return c=n(a(c.split("/"),function(g){return!!g}),!d).join("/"),(d?"/":"")+c||"."},e.normalize=function(c){var d=e.isAbsolute(c),u=l(c,-1)==="/";return c=n(a(c.split("/"),function(p){return!!p}),!d).join("/"),!c&&!d&&(c="."),c&&u&&(c+="/"),(d?"/":"")+c},e.isAbsolute=function(c){return c.charAt(0)==="/"},e.join=function(){var c=Array.prototype.slice.call(arguments,0);return e.normalize(a(c,function(d,u){if(typeof d!="string")throw new TypeError("Arguments to path.join must be strings");return d}).join("/"))},e.relative=function(c,d){c=e.resolve(c).substr(1),d=e.resolve(d).substr(1);function u(k){for(var S=0;S<k.length&&k[S]==="";S++);for(var T=k.length-1;T>=0&&k[T]==="";T--);return S>T?[]:k.slice(S,T-S+1)}for(var p=u(c.split("/")),g=u(d.split("/")),b=Math.min(p.length,g.length),x=b,w=0;w<b;w++)if(p[w]!==g[w]){x=w;break}for(var E=[],w=x;w<p.length;w++)E.push("..");return E=E.concat(g.slice(x)),E.join("/")},e.sep="/",e.delimiter=":",e.dirname=function(c){var d=s(c),u=d[0],p=d[1];return!u&&!p?".":(p&&(p=p.substr(0,p.length-1)),u+p)},e.basename=function(c,d){var u=s(c)[2];return d&&u.substr(-1*d.length)===d&&(u=u.substr(0,u.length-d.length)),u},e.extname=function(c){return s(c)[3]};function a(c,d){if(c.filter)return c.filter(d);for(var u=[],p=0;p<c.length;p++)d(c[p],p,c)&&u.push(c[p]);return u}var l="ab".substr(-1)==="b"?function(c,d,u){return c.substr(d,u)}:function(c,d,u){return d<0&&(d=c.length+d),c.substr(d,u)}}).call(e,r(1))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});function i(n){if(!n.hash)throw n;return{_diagnostic:{expected:n.hash.expected,message:n.message,text:n.hash.text,token:n.hash.token},location:n.hash.loc}}e.default=i},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});function i(p){return{type:"terminal",value:p}}e.terminal=i;function n(p){return{type:"command",value:p}}e.command=n;function o(p){return{type:"greek",value:p}}e.greek=o;function s(p){return{subscript:p._,superscript:p["^"],type:"level"}}e.level=s;function a(p,g){var b=[],x=p.match(/'+/);if(x!==null)for(var w=x[0].length,E=0;E<w;E++)b.push(n("\\prime"));return u(b,g)}e.processPrimes=a;function l(p,g){return{type:"fraction",numerator:p,denominator:g}}e.fraction=l;function c(p,g){return{name:p,type:"typeform",value:g}}e.typeform=c;function d(p,g){return{type:"radical",index:g,radicand:p}}e.radical=d;function u(){for(var p=[],g=0;g<arguments.length;g++)p[g]=arguments[g];return Array.prototype.concat.apply([],p)}e.group=u},function(t,e){t.exports=function(r){return r.webpackPolyfill||(r.deprecate=function(){},r.paths=[],r.children||(r.children=[]),Object.defineProperty(r,"loaded",{enumerable:!0,get:function(){return r.l}}),Object.defineProperty(r,"id",{enumerable:!0,get:function(){return r.i}}),r.webpackPolyfill=1),r}},function(t,e,r){(function(i,n){var o=function(){var s=function(bo,st,gt,ft){for(gt=gt||{},ft=bo.length;ft--;gt[bo[ft]]=st);return gt},a=[1,11],l=[1,12],c=[1,13],d=[1,70],u=[1,71],p=[1,69],g=[1,38],b=[1,39],x=[1,59],w=[1,60],E=[1,61],k=[1,62],S=[1,63],T=[1,64],V=[1,65],O=[1,66],y=[1,67],L=[1,68],P=[1,40],K=[1,34],$=[1,35],U=[1,36],J=[1,37],R=[1,41],q=[1,42],_=[1,43],A=[1,44],z=[1,45],Q=[1,46],fe=[1,47],ie=[1,48],Le=[1,49],pe=[1,50],ae=[1,51],ye=[1,52],H=[1,53],ge=[1,17],Se=[1,54],Ke=[1,55],Ae=[1,56],Ze=[1,57],qe=[1,58],At=[5,12,13,14,18,24,25],Fe=[5,11,12,13,14,15,17,18,20,21,23,24,25,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,82],Lt=[1,75],_r=[5,11,12,13,14,15,17,18,20,21,23,24,25,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,77,78,79,80,82],Ge=[5,11,12,13,14,15,17,18,20,21,23,24,25,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82],vi={trace:function(){},yy:{},symbols_:{error:2,sentence:3,group:4,EOF:5,element:6,index_element:7,modified_expression:8,radical:9,primes:10,OPEN_MODEXP:11,MODEXP_UNDER:12,MODEXP_OVER:13,CLOSE_MODEXP:14,RADICAL_INDEX:15,index_group:16,OPEN_RADICAL:17,CLOSE_RADICAL:18,level:19,LEVEL:20,BASELINE:21,frac:22,OPEN_FRAC:23,SLASH:24,CLOSE_FRAC:25,subscript_head:26,number:27,atom:28,command:29,greek:30,letter:31,comma:32,period:33,space:34,operation:35,comparison:36,level_with_comparison:37,ellipsis:38,colon:39,infinity:40,integral:41,factorial:42,ampersand:43,question_mark:44,bracket:45,",":46,".":47,"[":48,"{":49,"(":50,"]":51,"}":52,")":53,LANGLE:54,RANGLE:55,PIPE:56,DOUBLE_PIPE:57,SPACE:58,COMMAND:59,GREEK:60,LETTER:61,CAPITAL_LETTER:62,"+":63,"-":64,CDOT:65,TIMES:66,"*":67,"/":68,DIV:69,PERCENT:70,TO:71,COMPARISON:72,LEVEL_WITH_COMPARISON:73,ELLIPSIS:74,COLON:75,NUMBER:76,INFINITY:77,INTEGRAL:78,FACTORIAL:79,"&":80,PRIMES:81,"?":82,unknown:83,UNKNOWN:84,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",11:"OPEN_MODEXP",12:"MODEXP_UNDER",13:"MODEXP_OVER",14:"CLOSE_MODEXP",15:"RADICAL_INDEX",17:"OPEN_RADICAL",18:"CLOSE_RADICAL",20:"LEVEL",21:"BASELINE",23:"OPEN_FRAC",24:"SLASH",25:"CLOSE_FRAC",46:",",47:".",48:"[",49:"{",50:"(",51:"]",52:"}",53:")",54:"LANGLE",55:"RANGLE",56:"PIPE",57:"DOUBLE_PIPE",58:"SPACE",59:"COMMAND",60:"GREEK",61:"LETTER",62:"CAPITAL_LETTER",63:"+",64:"-",65:"CDOT",66:"TIMES",67:"*",68:"/",69:"DIV",70:"PERCENT",71:"TO",72:"COMPARISON",73:"LEVEL_WITH_COMPARISON",74:"ELLIPSIS",75:"COLON",76:"NUMBER",77:"INFINITY",78:"INTEGRAL",79:"FACTORIAL",80:"&",81:"PRIMES",82:"?",84:"UNKNOWN"},productions_:[0,[3,2],[3,1],[4,2],[4,1],[6,1],[6,1],[6,2],[6,1],[8,7],[8,6],[8,5],[8,6],[8,5],[8,5],[8,4],[8,4],[8,3],[8,4],[8,4],[8,4],[8,4],[8,3],[8,3],[8,2],[9,5],[9,4],[9,4],[9,3],[9,3],[9,2],[19,1],[19,1],[22,5],[22,4],[22,4],[22,3],[16,2],[16,1],[7,3],[7,2],[7,2],[7,3],[7,2],[7,2],[7,1],[7,1],[7,1],[26,1],[26,1],[26,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[28,1],[32,1],[33,1],[45,1],[45,1],[45,1],[45,1],[45,1],[45,1],[45,1],[45,1],[45,1],[45,1],[34,1],[29,1],[30,1],[31,1],[31,1],[35,1],[35,1],[35,1],[35,1],[35,1],[35,1],[35,1],[35,1],[35,1],[36,1],[37,1],[38,1],[39,1],[27,1],[40,1],[41,1],[42,1],[43,1],[10,1],[44,1],[83,1]],performAction:function(st,gt,ft,le,Gr,_e,rr){var ve=_e.length-1;switch(Gr){case 1:return _e[ve-1];case 2:return le.group();case 3:case 37:case 41:case 43:case 44:this.$=le.group(_e[ve-1],_e[ve]);break;case 4:case 38:this.$=le.group(_e[ve]);break;case 7:this.$=le.group(_e[ve-1],_e[ve]);break;case 9:this.$=le.modified_expression(_e[ve-5],_e[ve-3],_e[ve-1]);break;case 10:this.$=le.modified_expression(_e[ve-4],_e[ve-2]);break;case 11:this.$=le.modified_expression(_e[ve-3],_e[ve-1]);break;case 12:this.$=le.modified_expression(_e[ve-4],le.group(),_e[ve-1]);break;case 13:this.$=le.modified_expression(_e[ve-3],le.group(),_e[ve-1]);break;case 14:this.$=le.modified_expression(_e[ve-3],le.group(),le.group());break;case 15:case 16:this.$=le.modified_expression(_e[ve-2],le.group());break;case 17:this.$=le.modified_expression(_e[ve-1]);break;case 18:case 19:case 22:case 23:case 24:this.$=le.modified_expression(le.group());break;case 20:case 21:le.warnOrError("Multi-level modified expressions are not supported."),this.$=le.modified_expression(le.group());break;case 25:this.$=le.radical(_e[ve-1],_e[ve-3]);break;case 26:this.$=le.radical(_e[ve-1],le.group());break;case 27:this.$=le.radical(le.group(),_e[ve-2]);break;case 28:this.$=le.radical(le.group(),le.group());break;case 29:this.$=le.radical(_e[ve-1]);break;case 30:this.$=le.radical(le.group());break;case 31:this.$=le.level(_e[ve]);break;case 32:this.$=le.baseline();break;case 33:this.$=le.fraction(_e[ve-3],_e[ve-1]);break;case 34:this.$=le.fraction(_e[ve-2],le.group());break;case 35:this.$=le.fraction(le.group(),_e[ve-1]);break;case 36:this.$=le.fraction(le.group(),le.group());break;case 39:this.$=le.group(le.simple_subscript(_e[ve-2],_e[ve]),_e[ve-1]);break;case 40:this.$=le.simple_subscript(_e[ve-1],_e[ve]);break;case 42:le.warnOrError("Illegal use of Nemeth primes"),this.$=le.group(le.simple_subscript(_e[ve-2],_e[ve-1]),_e[ve]);break;case 67:this.$=le.terminal(",");break;case 68:this.$=le.terminal(".");break;case 69:this.$=le.terminal("[");break;case 70:this.$=le.terminal("\\{");break;case 71:this.$=le.terminal("(");break;case 72:this.$=le.terminal("]");break;case 73:this.$=le.terminal("\\}");break;case 74:this.$=le.terminal(")");break;case 75:this.$=le.terminal("\\langle ");break;case 76:this.$=le.terminal("\\rangle ");break;case 77:this.$=le.terminal("|");break;case 78:this.$=le.terminal("\\|");break;case 79:this.$=le.terminal(" ");break;case 80:this.$=le.command(_e[ve].toLowerCase());break;case 81:this.$=le.terminal(le.greek(_e[ve]));break;case 82:this.$=le.terminal(_e[ve].toLowerCase());break;case 83:this.$=le.terminal(_e[ve].toUpperCase());break;case 84:this.$=le.terminal("+");break;case 85:this.$=le.terminal("-");break;case 86:this.$=le.terminal("\\cdot ");break;case 87:this.$=le.terminal("\\times ");break;case 88:this.$=le.terminal("*");break;case 89:this.$=le.terminal("/");break;case 90:this.$=le.terminal("\\div ");break;case 91:this.$=le.terminal("\\%");break;case 92:this.$=le.terminal("\\to ");break;case 93:this.$=le.comparison(_e[ve].trim());break;case 94:this.$=le.level_with_comparison(_e[ve].trim());break;case 95:this.$=le.terminal("\\ldots ");break;case 96:this.$=le.terminal(":");break;case 97:this.$=le.terminal(_e[ve]);break;case 98:this.$=le.terminal("\\infty ");break;case 99:this.$=le.terminal("\\int ");break;case 100:this.$=le.terminal("!");break;case 101:this.$=le.terminal("\\&");break;case 102:this.$=le.primes(_e[ve]);break;case 103:this.$=le.terminal("?");break}},table:[{3:1,4:2,5:[1,3],6:4,7:5,8:6,9:7,11:a,15:l,17:c,19:33,20:d,21:u,22:32,23:p,26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:g,47:b,48:x,49:w,50:E,51:k,52:S,53:T,54:V,55:O,56:y,57:L,58:P,59:K,60:$,61:U,62:J,63:R,64:q,65:_,66:A,67:z,68:Q,69:fe,70:ie,71:Le,72:pe,73:ae,74:ye,75:H,76:ge,77:Se,78:Ke,79:Ae,80:Ze,82:qe},{1:[3]},{5:[1,72]},{1:[2,2]},s(At,[2,4],{6:4,7:5,8:6,9:7,26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,22:32,19:33,4:73,11:a,15:l,17:c,20:d,21:u,23:p,46:g,47:b,48:x,49:w,50:E,51:k,52:S,53:T,54:V,55:O,56:y,57:L,58:P,59:K,60:$,61:U,62:J,63:R,64:q,65:_,66:A,67:z,68:Q,69:fe,70:ie,71:Le,72:pe,73:ae,74:ye,75:H,76:ge,77:Se,78:Ke,79:Ae,80:Ze,82:qe}),s(Fe,[2,5]),s(Fe,[2,6]),s(Fe,[2,8],{10:74,81:Lt}),s(_r,[2,45],{10:76,27:77,76:ge,81:Lt}),s(Fe,[2,46],{10:78,81:Lt}),s(Fe,[2,47],{10:79,81:Lt}),{4:80,6:4,7:5,8:6,9:7,11:a,12:[1,82],13:[1,81],14:[1,83],15:l,17:c,19:33,20:d,21:u,22:32,23:p,26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:g,47:b,48:x,49:w,50:E,51:k,52:S,53:T,54:V,55:O,56:y,57:L,58:P,59:K,60:$,61:U,62:J,63:R,64:q,65:_,66:A,67:z,68:Q,69:fe,70:ie,71:Le,72:pe,73:ae,74:ye,75:H,76:ge,77:Se,78:Ke,79:Ae,80:Ze,82:qe},{7:86,16:84,17:[1,85],19:33,20:d,21:u,22:32,23:p,26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:g,47:b,48:x,49:w,50:E,51:k,52:S,53:T,54:V,55:O,56:y,57:L,58:P,59:K,60:$,61:U,62:J,63:R,64:q,65:_,66:A,67:z,68:Q,69:fe,70:ie,71:Le,72:pe,73:ae,74:ye,75:H,76:ge,77:Se,78:Ke,79:Ae,80:Ze,82:qe},{4:87,6:4,7:5,8:6,9:7,11:a,15:l,17:c,18:[1,88],19:33,20:d,21:u,22:32,23:p,26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:g,47:b,48:x,49:w,50:E,51:k,52:S,53:T,54:V,55:O,56:y,57:L,58:P,59:K,60:$,61:U,62:J,63:R,64:q,65:_,66:A,67:z,68:Q,69:fe,70:ie,71:Le,72:pe,73:ae,74:ye,75:H,76:ge,77:Se,78:Ke,79:Ae,80:Ze,82:qe},s(Ge,[2,48]),s(Ge,[2,49]),s(Ge,[2,50]),s(Ge,[2,97]),s(Ge,[2,51]),s(Ge,[2,52]),s(Ge,[2,53]),s(Ge,[2,54]),s(Ge,[2,55]),s(Ge,[2,56]),s(Ge,[2,57]),s(Ge,[2,58]),s(Ge,[2,59]),s(Ge,[2,60]),s(Ge,[2,61]),s(Ge,[2,62]),s(Ge,[2,63]),s(Ge,[2,64]),s(Ge,[2,65]),s(Ge,[2,66]),s(Ge,[2,80]),s(Ge,[2,81]),s(Ge,[2,82]),s(Ge,[2,83]),s(Ge,[2,67]),s(Ge,[2,68]),s(Ge,[2,79]),s(Ge,[2,84]),s(Ge,[2,85]),s(Ge,[2,86]),s(Ge,[2,87]),s(Ge,[2,88]),s(Ge,[2,89]),s(Ge,[2,90]),s(Ge,[2,91]),s(Ge,[2,92]),s(Ge,[2,93]),s(Ge,[2,94]),s(Ge,[2,95]),s(Ge,[2,96]),s(Ge,[2,98]),s(Ge,[2,99]),s(Ge,[2,100]),s(Ge,[2,101]),s(Ge,[2,103]),s(Ge,[2,69]),s(Ge,[2,70]),s(Ge,[2,71]),s(Ge,[2,72]),s(Ge,[2,73]),s(Ge,[2,74]),s(Ge,[2,75]),s(Ge,[2,76]),s(Ge,[2,77]),s(Ge,[2,78]),{4:89,6:4,7:5,8:6,9:7,11:a,15:l,17:c,19:33,20:d,21:u,22:32,23:p,24:[1,90],26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:g,47:b,48:x,49:w,50:E,51:k,52:S,53:T,54:V,55:O,56:y,57:L,58:P,59:K,60:$,61:U,62:J,63:R,64:q,65:_,66:A,67:z,68:Q,69:fe,70:ie,71:Le,72:pe,73:ae,74:ye,75:H,76:ge,77:Se,78:Ke,79:Ae,80:Ze,82:qe},s(Ge,[2,31]),s(Ge,[2,32]),{1:[2,1]},s(At,[2,3]),s(Fe,[2,7]),s(Fe,[2,102]),s(_r,[2,41],{27:91,76:ge}),s(Fe,[2,40],{10:92,81:Lt}),s(Fe,[2,43]),s(Fe,[2,44]),{12:[1,93],13:[1,94],14:[1,95]},{12:[1,96],13:[1,97],14:[1,98]},{12:[1,100],13:[1,99],14:[1,101]},s(Fe,[2,24]),{17:[1,102]},{4:103,6:4,7:5,8:6,9:7,11:a,15:l,17:c,18:[1,104],19:33,20:d,21:u,22:32,23:p,26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:g,47:b,48:x,49:w,50:E,51:k,52:S,53:T,54:V,55:O,56:y,57:L,58:P,59:K,60:$,61:U,62:J,63:R,64:q,65:_,66:A,67:z,68:Q,69:fe,70:ie,71:Le,72:pe,73:ae,74:ye,75:H,76:ge,77:Se,78:Ke,79:Ae,80:Ze,82:qe},{7:86,16:105,17:[2,38],19:33,20:d,21:u,22:32,23:p,26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:g,47:b,48:x,49:w,50:E,51:k,52:S,53:T,54:V,55:O,56:y,57:L,58:P,59:K,60:$,61:U,62:J,63:R,64:q,65:_,66:A,67:z,68:Q,69:fe,70:ie,71:Le,72:pe,73:ae,74:ye,75:H,76:ge,77:Se,78:Ke,79:Ae,80:Ze,82:qe},{18:[1,106]},s(Ge,[2,30]),{24:[1,107]},{4:108,6:4,7:5,8:6,9:7,11:a,15:l,17:c,19:33,20:d,21:u,22:32,23:p,25:[1,109],26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:g,47:b,48:x,49:w,50:E,51:k,52:S,53:T,54:V,55:O,56:y,57:L,58:P,59:K,60:$,61:U,62:J,63:R,64:q,65:_,66:A,67:z,68:Q,69:fe,70:ie,71:Le,72:pe,73:ae,74:ye,75:H,76:ge,77:Se,78:Ke,79:Ae,80:Ze,82:qe},s(Fe,[2,39]),s(Fe,[2,42]),{4:110,6:4,7:5,8:6,9:7,11:a,13:[1,111],14:[1,112],15:l,17:c,19:33,20:d,21:u,22:32,23:p,26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:g,47:b,48:x,49:w,50:E,51:k,52:S,53:T,54:V,55:O,56:y,57:L,58:P,59:K,60:$,61:U,62:J,63:R,64:q,65:_,66:A,67:z,68:Q,69:fe,70:ie,71:Le,72:pe,73:ae,74:ye,75:H,76:ge,77:Se,78:Ke,79:Ae,80:Ze,82:qe},{4:113,6:4,7:5,8:6,9:7,11:a,14:[1,114],15:l,17:c,19:33,20:d,21:u,22:32,23:p,26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:g,47:b,48:x,49:w,50:E,51:k,52:S,53:T,54:V,55:O,56:y,57:L,58:P,59:K,60:$,61:U,62:J,63:R,64:q,65:_,66:A,67:z,68:Q,69:fe,70:ie,71:Le,72:pe,73:ae,74:ye,75:H,76:ge,77:Se,78:Ke,79:Ae,80:Ze,82:qe},s(Fe,[2,17]),{14:[1,115]},{14:[1,116]},s(Fe,[2,22]),{14:[1,117]},{14:[1,118]},s(Fe,[2,23]),{4:119,6:4,7:5,8:6,9:7,11:a,15:l,17:c,18:[1,120],19:33,20:d,21:u,22:32,23:p,26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:g,47:b,48:x,49:w,50:E,51:k,52:S,53:T,54:V,55:O,56:y,57:L,58:P,59:K,60:$,61:U,62:J,63:R,64:q,65:_,66:A,67:z,68:Q,69:fe,70:ie,71:Le,72:pe,73:ae,74:ye,75:H,76:ge,77:Se,78:Ke,79:Ae,80:Ze,82:qe},{18:[1,121]},s(Ge,[2,28]),{17:[2,37]},s(Ge,[2,29]),{4:122,6:4,7:5,8:6,9:7,11:a,15:l,17:c,19:33,20:d,21:u,22:32,23:p,25:[1,123],26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:g,47:b,48:x,49:w,50:E,51:k,52:S,53:T,54:V,55:O,56:y,57:L,58:P,59:K,60:$,61:U,62:J,63:R,64:q,65:_,66:A,67:z,68:Q,69:fe,70:ie,71:Le,72:pe,73:ae,74:ye,75:H,76:ge,77:Se,78:Ke,79:Ae,80:Ze,82:qe},{25:[1,124]},s(Ge,[2,36]),{13:[1,125],14:[1,126]},{4:127,6:4,7:5,8:6,9:7,11:a,14:[1,128],15:l,17:c,19:33,20:d,21:u,22:32,23:p,26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:g,47:b,48:x,49:w,50:E,51:k,52:S,53:T,54:V,55:O,56:y,57:L,58:P,59:K,60:$,61:U,62:J,63:R,64:q,65:_,66:A,67:z,68:Q,69:fe,70:ie,71:Le,72:pe,73:ae,74:ye,75:H,76:ge,77:Se,78:Ke,79:Ae,80:Ze,82:qe},s(Fe,[2,16]),{14:[1,129]},s(Fe,[2,15]),s(Fe,[2,18]),s(Fe,[2,20]),s(Fe,[2,19]),s(Fe,[2,21]),{18:[1,130]},s(Ge,[2,27]),s(Ge,[2,26]),{25:[1,131]},s(Ge,[2,34]),s(Ge,[2,35]),{4:132,6:4,7:5,8:6,9:7,11:a,14:[1,133],15:l,17:c,19:33,20:d,21:u,22:32,23:p,26:8,27:9,28:10,29:14,30:15,31:16,32:18,33:19,34:20,35:21,36:22,37:23,38:24,39:25,40:26,41:27,42:28,43:29,44:30,45:31,46:g,47:b,48:x,49:w,50:E,51:k,52:S,53:T,54:V,55:O,56:y,57:L,58:P,59:K,60:$,61:U,62:J,63:R,64:q,65:_,66:A,67:z,68:Q,69:fe,70:ie,71:Le,72:pe,73:ae,74:ye,75:H,76:ge,77:Se,78:Ke,79:Ae,80:Ze,82:qe},s(Fe,[2,11]),{14:[1,134]},s(Fe,[2,14]),s(Fe,[2,13]),s(Ge,[2,25]),s(Ge,[2,33]),{14:[1,135]},s(Fe,[2,10]),s(Fe,[2,12]),s(Fe,[2,9])],defaultActions:{3:[2,2],72:[2,1],105:[2,37]},parseError:function(st,gt){if(gt.recoverable)this.trace(st);else{var ft=new Error(st);throw ft.hash=gt,ft}},parse:function(st){var gt=this,ft=[0],le=[],Gr=[null],_e=[],rr=this.table,ve="",Et=0,It=0,Ve=0,ni=2,rt=1,ta=_e.slice.call(arguments,1),_t=Object.create(this.lexer),Mr={yy:{}};for(var Ci in this.yy)Object.prototype.hasOwnProperty.call(this.yy,Ci)&&(Mr.yy[Ci]=this.yy[Ci]);_t.setInput(st,Mr.yy),Mr.yy.lexer=_t,Mr.yy.parser=this,typeof _t.yylloc=="undefined"&&(_t.yylloc={});var gn=_t.yylloc;_e.push(gn);var Ll=_t.options&&_t.options.ranges;typeof Mr.yy.parseError=="function"?this.parseError=Mr.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;function wo(ct){ft.length=ft.length-2*ct,Gr.length=Gr.length-ct,_e.length=_e.length-ct}e:var ro=function(){var ct;return ct=_t.lex()||rt,typeof ct!="number"&&(ct=gt.symbols_[ct]||ct),ct};for(var nr,Hi,N,W,re,be,se={},ue,De,ze,$e;;){if(N=ft[ft.length-1],this.defaultActions[N]?W=this.defaultActions[N]:((nr===null||typeof nr=="undefined")&&(nr=ro()),W=rr[N]&&rr[N][nr]),typeof W=="undefined"||!W.length||!W[0]){var kt="";$e=[];for(ue in rr[N])this.terminals_[ue]&&ue>ni&&$e.push("'"+this.terminals_[ue]+"'");_t.showPosition?kt="Parse error on line "+(Et+1)+`:
`+_t.showPosition()+`
Expecting `+$e.join(", ")+", got '"+(this.terminals_[nr]||nr)+"'":kt="Parse error on line "+(Et+1)+": Unexpected "+(nr==rt?"end of input":"'"+(this.terminals_[nr]||nr)+"'"),this.parseError(kt,{text:_t.match,token:this.terminals_[nr]||nr,line:_t.yylineno,loc:gn,expected:$e})}if(W[0]instanceof Array&&W.length>1)throw new Error("Parse Error: multiple actions possible at state: "+N+", token: "+nr);switch(W[0]){case 1:ft.push(nr),Gr.push(_t.yytext),_e.push(_t.yylloc),ft.push(W[1]),nr=null,Hi?(nr=Hi,Hi=null):(It=_t.yyleng,ve=_t.yytext,Et=_t.yylineno,gn=_t.yylloc,Ve>0&&Ve--);break;case 2:if(De=this.productions_[W[1]][1],se.$=Gr[Gr.length-De],se._$={first_line:_e[_e.length-(De||1)].first_line,last_line:_e[_e.length-1].last_line,first_column:_e[_e.length-(De||1)].first_column,last_column:_e[_e.length-1].last_column},Ll&&(se._$.range=[_e[_e.length-(De||1)].range[0],_e[_e.length-1].range[1]]),be=this.performAction.apply(se,[ve,It,Et,Mr.yy,W[1],Gr,_e].concat(ta)),typeof be!="undefined")return be;De&&(ft=ft.slice(0,-1*De*2),Gr=Gr.slice(0,-1*De),_e=_e.slice(0,-1*De)),ft.push(this.productions_[W[1]][0]),Gr.push(se.$),_e.push(se._$),ze=rr[ft[ft.length-2]][ft[ft.length-1]],ft.push(ze);break;case 3:return!0}}return!0}},ht=function(){var bo={EOF:1,parseError:function(gt,ft){if(this.yy.parser)this.yy.parser.parseError(gt,ft);else throw new Error(gt)},setInput:function(st,gt){return this.yy=gt||this.yy||{},this._input=st,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var st=this._input[0];this.yytext+=st,this.yyleng++,this.offset++,this.match+=st,this.matched+=st;var gt=st.match(/(?:\r\n?|\n).*/g);return gt?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),st},unput:function(st){var gt=st.length,ft=st.split(/(?:\r\n?|\n)/g);this._input=st+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-gt),this.offset-=gt;var le=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),ft.length-1&&(this.yylineno-=ft.length-1);var Gr=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:ft?(ft.length===le.length?this.yylloc.first_column:0)+le[le.length-ft.length].length-ft[0].length:this.yylloc.first_column-gt},this.options.ranges&&(this.yylloc.range=[Gr[0],Gr[0]+this.yyleng-gt]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(st){this.unput(this.match.slice(st))},pastInput:function(){var st=this.matched.substr(0,this.matched.length-this.match.length);return(st.length>20?"...":"")+st.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var st=this.match;return st.length<20&&(st+=this._input.substr(0,20-st.length)),(st.substr(0,20)+(st.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var st=this.pastInput(),gt=new Array(st.length+1).join("-");return st+this.upcomingInput()+`
`+gt+"^"},test_match:function(st,gt){var ft,le,Gr;if(this.options.backtrack_lexer&&(Gr={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(Gr.yylloc.range=this.yylloc.range.slice(0))),le=st[0].match(/(?:\r\n?|\n).*/g),le&&(this.yylineno+=le.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:le?le[le.length-1].length-le[le.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+st[0].length},this.yytext+=st[0],this.match+=st[0],this.matches=st,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(st[0].length),this.matched+=st[0],ft=this.performAction.call(this,this.yy,this,gt,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),ft)return ft;if(this._backtrack){for(var _e in Gr)this[_e]=Gr[_e];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var st,gt,ft,le;this._more||(this.yytext="",this.match="");for(var Gr=this._currentRules(),_e=0;_e<Gr.length;_e++)if(ft=this._input.match(this.rules[Gr[_e]]),ft&&(!gt||ft[0].length>gt[0].length)){if(gt=ft,le=_e,this.options.backtrack_lexer){if(st=this.test_match(ft,Gr[_e]),st!==!1)return st;if(this._backtrack){gt=!1;continue}else return!1}else if(!this.options.flex)break}return gt?(st=this.test_match(gt,Gr[le]),st!==!1?st:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var gt=this.next();return gt||this.lex()},begin:function(gt){this.conditionStack.push(gt)},popState:function(){var gt=this.conditionStack.length-1;return gt>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(gt){return gt=this.conditionStack.length-1-Math.abs(gt||0),gt>=0?this.conditionStack[gt]:"INITIAL"},pushState:function(gt){this.begin(gt)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(gt,ft,le,Gr){var _e=Gr;switch(le){case 0:return this.begin("modexp"),11;break;case 1:return 21;case 2:return this.begin("modexp"),11;break;case 3:return 12;case 4:return 13;case 5:return this.popState(),14;break;case 6:return 63;case 7:return 64;case 8:return 65;case 9:return 66;case 10:return 67;case 11:return 68;case 12:return 69;case 13:return 54;case 14:return 48;case 15:return 49;case 16:return 50;case 17:return 55;case 18:return 51;case 19:return 52;case 20:return 53;case 21:return 57;case 22:return 56;case 23:return 75;case 24:return 70;case 25:return 71;case 26:return 73;case 27:return 73;case 28:return 73;case 29:return 73;case 30:return 73;case 31:return 73;case 32:return 73;case 33:return 73;case 34:return 73;case 35:return 72;case 36:return 73;case 37:return 73;case 38:return 72;case 39:return 72;case 40:return 72;case 41:return 72;case 42:return 72;case 43:return 72;case 44:return 72;case 45:return 72;case 46:return 72;case 47:return 72;case 48:return 74;case 49:return 20;case 50:return 47;case 51:return 21;case 52:return 81;case 53:return 60;case 54:return 15;case 55:return this.begin("radical"),17;break;case 56:return this.popState(),18;break;case 57:return 18;case 58:return 78;case 59:return 80;case 60:return 79;case 61:return 59;case 62:return 59;case 63:return ft.yytext=this.matches[1],76;break;case 64:return 23;case 65:return 24;case 66:return 25;case 67:return ft.yytext=this.matches[1],62;break;case 68:return 61;case 69:return 77;case 70:return 82;case 71:return 46;case 72:return 47;case 73:return 58;case 74:return 5;case 75:return 84}},rules:[/^(?:"(?=[^>\]]+%))/,/^(?:")/,/^(?:"(?=[^>\]]+\]|[^>\]]+%))/,/^(?:%)/,/^(?:<)/,/^(?:\])/,/^(?:[+])/,/^(?:[-])/,/^(?:[*])/,/^(?:[@][*])/,/^(?:[@][\#])/,/^(?:[_][/])/,/^(?:[.][/])/,/^(?:[.][.][(])/,/^(?:[@][(])/,/^(?:[.][(])/,/^(?:[(])/,/^(?:[.][.][)])/,/^(?:[@][)])/,/^(?:[.][)])/,/^(?:[)])/,/^(?:[\\][\\])/,/^(?:[\\])/,/^(?:[_][3])/,/^(?:[@][0])/,/^(?:[ ][$]O[ ])/,/^(?:[ ][\^;]+[.]K[ ])/,/^(?:[\^;]+[=])/,/^(?:[ ][\^;]+[/][.]K[ ])/,/^(?:[ ][\^;]+[@][:][@][:][ ])/,/^(?:[ ][\^;]+["]K[:][ ])/,/^(?:[ ][\^;]+[.]1[:][ ])/,/^(?:[ ][\^;]+["]K[ ])/,/^(?:[ ][\^;]+[.]1[ ])/,/^(?:[ ][\^;]+[/][$][L][ ])/,/^(?:[ ][.]K[ ])/,/^(?:[ ][\^;]+[/]?[$][L][ ])/,/^(?:[ ][\^;]+[$]P[ ])/,/^(?:[=])/,/^(?:[ ][/][.]K[ ])/,/^(?:[ ][@][:][@][:][ ])/,/^(?:[ ]["]K[:][ ])/,/^(?:[ ][.]1[:][ ])/,/^(?:[ ]["]K[ ])/,/^(?:[ ][.]1[ ])/,/^(?:[@][:])/,/^(?:[ ][/]?[$][L][ ])/,/^(?:[ ][$]P[ ])/,/^(?:[ ]['][']['][ ])/,/^(?:[\^;]+)/,/^(?:[.]["])/,/^(?:["])/,/^(?:[']+)/,/^(?:[.][,]?[ABGDEZ\?\:IKLMNXOPRSTUYF\&W])/,/^(?:[.]*[<])/,/^(?:[.]*[>])/,/^(?:[.]*\])/,/^(?:[.]*\])/,/^(?:!)/,/^(?:[_]&)/,/^(?:&)/,/^(?:(ARC)?(SIN|COS|TAN|CSC|SEC|COT)(H)?)/,/^(?:(ARG|DET|EXP|IM|INF|LIM|LN|LOG|MAX|MIN|MOD|RE|SUP))/,/^(?:#?(\d*\.?\d+))/,/^(?:[,]*[?])/,/^(?:[,]*[/])/,/^(?:[,]*#)/,/^(?:[,]([A-Z]))/,/^(?:[A-Z])/,/^(?:[,][=])/,/^(?:[_][8])/,/^(?:[,][ ]?)/,/^(?:[.])/,/^(?:[ ])/,/^(?:$)/,/^(?:.)/],conditions:{radical:{rules:[0,1,2,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75],inclusive:!0},modexp:{rules:[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75],inclusive:!0},INITIAL:{rules:[2,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75],inclusive:!0}}};return bo}();vi.lexer=ht;function Ee(){this.yy={}}return Ee.prototype=vi,vi.Parser=Ee,new Ee}();e.parser=o,e.Parser=o.Parser,e.parse=function(){return o.parse.apply(o,arguments)},e.main=function(a){a[1]||(console.log("Usage: "+a[0]+" FILE"),i.exit(1));var l=r(4).readFileSync(r(5).normalize(a[1]),"utf8");return e.parser.parse(l)},typeof n!="undefined"&&r.c[r.s]===n&&e.main(i.argv.slice(1))}).call(e,r(1),r(8)(t))},function(t,e,r){(function(i,n){var o=function(){var s=function(rr,ve,Et,It){for(Et=Et||{},It=rr.length;It--;Et[rr[It]]=ve);return Et},a=[1,15],l=[1,16],c=[1,17],d=[1,36],u=[1,18],p=[1,37],g=[1,38],b=[1,14],x=[1,46],w=[1,47],E=[1,39],k=[1,40],S=[1,41],T=[1,56],V=[1,42],O=[1,43],y=[1,44],L=[1,45],P=[1,54],K=[1,55],$=[1,57],U=[1,58],J=[1,59],R=[1,60],q=[1,61],_=[1,62],A=[1,63],z=[1,64],Q=[1,65],fe=[1,66],ie=[1,67],Le=[1,68],pe=[1,69],ae=[1,70],ye=[1,71],H=[1,72],ge=[1,73],Se=[1,74],Ke=[1,75],Ae=[1,76],Ze=[1,48],qe=[1,49],At=[1,50],Fe=[1,51],Lt=[1,52],_r=[1,77],Ge=[1,53],vi=[5,14,18,19,29,52,53,54],ht=[5,10,13,14,15,18,19,29,52,53,54],Ee=[5,10,13,14,15,17,18,19,21,23,24,28,29,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88],bo=[1,85],st=[1,86],gt=[1,87],ft=[10,13,15,17,21,23,24,28,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88],le={trace:function(){},yy:{},symbols_:{error:2,sentence:3,group:4,EOF:5,expression_group:6,delimited_expression:7,level:8,radical:9,LEVEL:10,basic_token:11,bracketed_expression:12,RADICAL_WITH_INDEX:13,CLOSE_RADICAL:14,RADICAL:15,frac:16,OPEN_FRAC:17,OVER:18,CLOSE_FRAC:19,simple_frac:20,NUMBER:21,NUMBER_FRAC_DENOMINATOR:22,NUMBER_FRAC_NUMERATOR_BAD:23,NUMBER_FRAC_DENOMINATOR_BAD:24,atom:25,lbracket:26,rbracket:27,OPEN_GROUP:28,CLOSE_GROUP:29,command:30,greek:31,letter:32,comma:33,period:34,colon:35,infinity:36,integral:37,factorial:38,ampersand:39,question_mark:40,bracket:41,space:42,operation:43,comparison:44,ellipsis:45,primes:46,",":47,".":48,"[":49,"{":50,"(":51,"]":52,"}":53,")":54,SPACE:55,COMMAND:56,GREEK:57,CAPITAL_LETTER:58,LETTER:59,PIPE:60,DOUBLE_PIPE:61,"+":62,"-":63,CDOT:64,TIMES:65,"*":66,DIV:67,SLASH:68,PERCENT:69,TO:70,"=":71,NEQ:72,"<":73,">":74,LEQ:75,APPROX:76,GEQ:77,TILDE:78,PARALLEL:79,PERPENDICULAR:80,ELLIPSIS:81,COLON:82,INFINITY:83,INTEGRAL:84,FACTORIAL:85,"&":86,PRIMES:87,"?":88,unknown:89,UNKNOWN:90,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",10:"LEVEL",13:"RADICAL_WITH_INDEX",14:"CLOSE_RADICAL",15:"RADICAL",17:"OPEN_FRAC",18:"OVER",19:"CLOSE_FRAC",21:"NUMBER",22:"NUMBER_FRAC_DENOMINATOR",23:"NUMBER_FRAC_NUMERATOR_BAD",24:"NUMBER_FRAC_DENOMINATOR_BAD",28:"OPEN_GROUP",29:"CLOSE_GROUP",47:",",48:".",49:"[",50:"{",51:"(",52:"]",53:"}",54:")",55:"SPACE",56:"COMMAND",57:"GREEK",58:"CAPITAL_LETTER",59:"LETTER",60:"PIPE",61:"DOUBLE_PIPE",62:"+",63:"-",64:"CDOT",65:"TIMES",66:"*",67:"DIV",68:"SLASH",69:"PERCENT",70:"TO",71:"=",72:"NEQ",73:"<",74:">",75:"LEQ",76:"APPROX",77:"GEQ",78:"TILDE",79:"PARALLEL",80:"PERPENDICULAR",81:"ELLIPSIS",82:"COLON",83:"INFINITY",84:"INTEGRAL",85:"FACTORIAL",86:"&",87:"PRIMES",88:"?",90:"UNKNOWN"},productions_:[0,[3,2],[3,1],[4,3],[4,2],[4,1],[4,2],[4,1],[7,1],[7,1],[8,2],[8,2],[8,2],[9,4],[9,3],[9,3],[9,2],[9,4],[9,3],[9,2],[16,5],[16,4],[16,4],[16,3],[16,2],[20,2],[20,1],[20,1],[11,1],[11,1],[11,1],[6,2],[6,2],[6,1],[6,1],[12,3],[12,2],[12,3],[12,2],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[25,1],[33,1],[34,1],[26,1],[26,1],[26,1],[27,1],[27,1],[27,1],[42,1],[30,1],[31,1],[32,1],[32,1],[41,1],[41,1],[43,1],[43,1],[43,1],[43,1],[43,1],[43,1],[43,1],[43,1],[43,1],[44,1],[44,1],[44,1],[44,1],[44,1],[44,1],[44,1],[44,1],[44,1],[44,1],[45,1],[35,1],[36,1],[37,1],[38,1],[39,1],[46,1],[40,1],[89,1]],performAction:function(ve,Et,It,Ve,ni,rt,ta){var _t=rt.length-1;switch(ni){case 1:return rt[_t-1];case 2:return Ve.group();case 3:case 35:this.$=Ve.group(rt[_t-2],rt[_t-1],rt[_t]);break;case 4:case 6:case 31:case 32:case 36:this.$=Ve.group(rt[_t-1],rt[_t]);break;case 5:case 7:case 33:case 34:this.$=Ve.group(rt[_t]);break;case 10:case 11:case 12:this.$=Ve.basic_level(rt[_t-1],Ve.group(rt[_t]));break;case 13:case 17:this.$=Ve.radical(rt[_t-1],Ve.group(rt[_t-2]));break;case 14:case 15:this.$=Ve.radical(Ve.group(),Ve.group(rt[_t-1]));break;case 16:this.$=Ve.radical(Ve.group(),Ve.group());break;case 18:this.$=Ve.radical(rt[_t-1]);break;case 19:this.$=Ve.radical(Ve.group());break;case 20:this.$=Ve.fraction(rt[_t-3],rt[_t-1]);break;case 21:this.$=Ve.fraction(rt[_t-2],Ve.group());break;case 22:this.$=Ve.fraction(Ve.group(),rt[_t-1]);break;case 23:case 24:this.$=Ve.fraction(Ve.group(),Ve.group());break;case 25:this.$=Ve.fraction(Ve.group(Ve.terminal(Ve.to_number(rt[_t-1]))),Ve.group(Ve.terminal(Ve.to_number(rt[_t]))));break;case 26:this.$=Ve.fraction(Ve.group(Ve.terminal(Ve.to_number(rt[_t]))),Ve.group());break;case 27:this.$=Ve.fraction(Ve.group(),Ve.group(Ve.terminal(Ve.to_number(rt[$01]))));break;case 37:this.$=Ve.group(rt[_t-1]);break;case 38:this.$=Ve.group();break;case 39:this.$=Ve.terminal(Ve.to_number(rt[_t]));break;case 57:this.$=Ve.terminal(",");break;case 58:this.$=Ve.terminal(".");break;case 59:this.$=Ve.terminal("[");break;case 60:this.$=Ve.terminal("\\{");break;case 61:this.$=Ve.terminal("(");break;case 62:this.$=Ve.terminal("]");break;case 63:this.$=Ve.terminal("\\}");break;case 64:this.$=Ve.terminal(")");break;case 65:this.$=Ve.terminal(" ");break;case 66:this.$=Ve.command("\\"+rt[_t].trim().toLowerCase());break;case 67:this.$=Ve.terminal(Ve.greek(rt[_t]));break;case 68:this.$=Ve.terminal(rt[_t].toUpperCase());break;case 69:this.$=Ve.terminal(rt[_t].toLowerCase());break;case 70:this.$=Ve.terminal("|");break;case 71:this.$=Ve.terminal("\\|");break;case 72:this.$=Ve.terminal("+");break;case 73:this.$=Ve.terminal("-");break;case 74:this.$=Ve.terminal("\\cdot ");break;case 75:this.$=Ve.terminal("\\times ");break;case 76:this.$=Ve.terminal("*");break;case 77:this.$=Ve.terminal("\\div ");break;case 78:this.$=Ve.terminal("/");break;case 79:this.$=Ve.terminal("\\%");break;case 80:this.$=Ve.terminal("\\to ");break;case 81:this.$=Ve.terminal("=");break;case 82:this.$=Ve.terminal("\\neq ");break;case 83:this.$=Ve.terminal("<");break;case 84:this.$=Ve.terminal(">");break;case 85:this.$=Ve.terminal("\\leq ");break;case 86:this.$=Ve.terminal("\\approx ");break;case 87:this.$=Ve.terminal("\\geq ");break;case 88:this.$=Ve.terminal("\\sim ");break;case 89:this.$=Ve.terminal("\\parallel ");break;case 90:this.$=Ve.terminal("\\perp ");break;case 91:this.$=Ve.terminal("\\ldots ");break;case 92:this.$=Ve.terminal(":");break;case 93:this.$=Ve.terminal("\\infty ");break;case 94:this.$=Ve.terminal("\\int ");break;case 95:this.$=Ve.terminal("!");break;case 96:this.$=Ve.terminal("\\&");break;case 97:this.$=Ve.primes(rt[_t]);break;case 98:this.$=Ve.terminal("?");break}},table:[{3:1,4:2,5:[1,3],6:4,7:5,8:8,9:9,10:a,11:6,12:7,13:l,15:c,16:11,17:d,20:12,21:u,23:p,24:g,25:10,26:13,28:b,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:x,48:w,49:E,50:k,51:S,55:T,56:V,57:O,58:y,59:L,60:P,61:K,62:$,63:U,64:J,65:R,66:q,67:_,68:A,69:z,70:Q,71:fe,72:ie,73:Le,74:pe,75:ae,76:ye,77:H,78:ge,79:Se,80:Ke,81:Ae,82:Ze,83:qe,84:At,85:Fe,86:Lt,87:_r,88:Ge},{1:[3]},{5:[1,78]},{1:[2,2]},s(vi,[2,5],{8:8,9:9,7:79,10:a,13:l,15:c}),s(vi,[2,7],{6:4,7:5,11:6,12:7,8:8,9:9,25:10,16:11,20:12,26:13,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,4:80,10:a,13:l,15:c,17:d,21:u,23:p,24:g,28:b,47:x,48:w,49:E,50:k,51:S,55:T,56:V,57:O,58:y,59:L,60:P,61:K,62:$,63:U,64:J,65:R,66:q,67:_,68:A,69:z,70:Q,71:fe,72:ie,73:Le,74:pe,75:ae,76:ye,77:H,78:ge,79:Se,80:Ke,81:Ae,82:Ze,83:qe,84:At,85:Fe,86:Lt,87:_r,88:Ge}),s(ht,[2,33],{11:6,12:7,25:10,16:11,20:12,26:13,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,6:81,17:d,21:u,23:p,24:g,28:b,47:x,48:w,49:E,50:k,51:S,55:T,56:V,57:O,58:y,59:L,60:P,61:K,62:$,63:U,64:J,65:R,66:q,67:_,68:A,69:z,70:Q,71:fe,72:ie,73:Le,74:pe,75:ae,76:ye,77:H,78:ge,79:Se,80:Ke,81:Ae,82:Ze,83:qe,84:At,85:Fe,86:Lt,87:_r,88:Ge}),s(ht,[2,34],{11:6,12:7,25:10,16:11,20:12,26:13,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,6:82,17:d,21:u,23:p,24:g,28:b,47:x,48:w,49:E,50:k,51:S,55:T,56:V,57:O,58:y,59:L,60:P,61:K,62:$,63:U,64:J,65:R,66:q,67:_,68:A,69:z,70:Q,71:fe,72:ie,73:Le,74:pe,75:ae,76:ye,77:H,78:ge,79:Se,80:Ke,81:Ae,82:Ze,83:qe,84:At,85:Fe,86:Lt,87:_r,88:Ge}),s(Ee,[2,8]),s(Ee,[2,9]),s(Ee,[2,28]),s(Ee,[2,29]),s(Ee,[2,30]),{4:83,6:4,7:5,8:8,9:9,10:a,11:6,12:7,13:l,15:c,16:11,17:d,20:12,21:u,23:p,24:g,25:10,26:13,27:84,28:b,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:x,48:w,49:E,50:k,51:S,52:bo,53:st,54:gt,55:T,56:V,57:O,58:y,59:L,60:P,61:K,62:$,63:U,64:J,65:R,66:q,67:_,68:A,69:z,70:Q,71:fe,72:ie,73:Le,74:pe,75:ae,76:ye,77:H,78:ge,79:Se,80:Ke,81:Ae,82:Ze,83:qe,84:At,85:Fe,86:Lt,87:_r,88:Ge},{4:88,6:4,7:5,8:8,9:9,10:a,11:6,12:7,13:l,15:c,16:11,17:d,20:12,21:u,23:p,24:g,25:10,26:13,28:b,29:[1,89],30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:x,48:w,49:E,50:k,51:S,55:T,56:V,57:O,58:y,59:L,60:P,61:K,62:$,63:U,64:J,65:R,66:q,67:_,68:A,69:z,70:Q,71:fe,72:ie,73:Le,74:pe,75:ae,76:ye,77:H,78:ge,79:Se,80:Ke,81:Ae,82:Ze,83:qe,84:At,85:Fe,86:Lt,87:_r,88:Ge},{9:92,11:90,12:91,13:l,15:c,16:11,17:d,20:12,21:u,23:p,24:g,25:10,26:13,28:b,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:x,48:w,49:E,50:k,51:S,55:T,56:V,57:O,58:y,59:L,60:P,61:K,62:$,63:U,64:J,65:R,66:q,67:_,68:A,69:z,70:Q,71:fe,72:ie,73:Le,74:pe,75:ae,76:ye,77:H,78:ge,79:Se,80:Ke,81:Ae,82:Ze,83:qe,84:At,85:Fe,86:Lt,87:_r,88:Ge},{11:93,12:94,14:[1,95],16:11,17:d,20:12,21:u,23:p,24:g,25:10,26:13,28:b,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:x,48:w,49:E,50:k,51:S,55:T,56:V,57:O,58:y,59:L,60:P,61:K,62:$,63:U,64:J,65:R,66:q,67:_,68:A,69:z,70:Q,71:fe,72:ie,73:Le,74:pe,75:ae,76:ye,77:H,78:ge,79:Se,80:Ke,81:Ae,82:Ze,83:qe,84:At,85:Fe,86:Lt,87:_r,88:Ge},{4:96,6:4,7:5,8:8,9:9,10:a,11:6,12:7,13:l,14:[1,97],15:c,16:11,17:d,20:12,21:u,23:p,24:g,25:10,26:13,28:b,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:x,48:w,49:E,50:k,51:S,55:T,56:V,57:O,58:y,59:L,60:P,61:K,62:$,63:U,64:J,65:R,66:q,67:_,68:A,69:z,70:Q,71:fe,72:ie,73:Le,74:pe,75:ae,76:ye,77:H,78:ge,79:Se,80:Ke,81:Ae,82:Ze,83:qe,84:At,85:Fe,86:Lt,87:_r,88:Ge},s(Ee,[2,39],{22:[1,98]}),s(Ee,[2,40]),s(Ee,[2,41]),s(Ee,[2,42]),s(Ee,[2,43]),s(Ee,[2,44]),s(Ee,[2,45]),s(Ee,[2,46]),s(Ee,[2,47]),s(Ee,[2,48]),s(Ee,[2,49]),s(Ee,[2,50]),s(Ee,[2,51]),s(Ee,[2,52]),s(Ee,[2,53]),s(Ee,[2,54]),s(Ee,[2,55]),s(Ee,[2,56]),{4:99,6:4,7:5,8:8,9:9,10:a,11:6,12:7,13:l,15:c,16:11,17:d,18:[1,100],19:[1,101],20:12,21:u,23:p,24:g,25:10,26:13,28:b,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:x,48:w,49:E,50:k,51:S,55:T,56:V,57:O,58:y,59:L,60:P,61:K,62:$,63:U,64:J,65:R,66:q,67:_,68:A,69:z,70:Q,71:fe,72:ie,73:Le,74:pe,75:ae,76:ye,77:H,78:ge,79:Se,80:Ke,81:Ae,82:Ze,83:qe,84:At,85:Fe,86:Lt,87:_r,88:Ge},s(Ee,[2,26]),s(Ee,[2,27]),s(ft,[2,59]),s(ft,[2,60]),s(ft,[2,61]),s(Ee,[2,66]),s(Ee,[2,67]),s(Ee,[2,68]),s(Ee,[2,69]),s(Ee,[2,57]),s(Ee,[2,58]),s(Ee,[2,92]),s(Ee,[2,93]),s(Ee,[2,94]),s(Ee,[2,95]),s(Ee,[2,96]),s(Ee,[2,98]),s(Ee,[2,70]),s(Ee,[2,71]),s(Ee,[2,65]),s(Ee,[2,72]),s(Ee,[2,73]),s(Ee,[2,74]),s(Ee,[2,75]),s(Ee,[2,76]),s(Ee,[2,77]),s(Ee,[2,78]),s(Ee,[2,79]),s(Ee,[2,80]),s(Ee,[2,81]),s(Ee,[2,82]),s(Ee,[2,83]),s(Ee,[2,84]),s(Ee,[2,85]),s(Ee,[2,86]),s(Ee,[2,87]),s(Ee,[2,88]),s(Ee,[2,89]),s(Ee,[2,90]),s(Ee,[2,91]),s(Ee,[2,97]),{1:[2,1]},s(vi,[2,4],{6:4,7:5,11:6,12:7,8:8,9:9,25:10,16:11,20:12,26:13,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,4:102,10:a,13:l,15:c,17:d,21:u,23:p,24:g,28:b,47:x,48:w,49:E,50:k,51:S,55:T,56:V,57:O,58:y,59:L,60:P,61:K,62:$,63:U,64:J,65:R,66:q,67:_,68:A,69:z,70:Q,71:fe,72:ie,73:Le,74:pe,75:ae,76:ye,77:H,78:ge,79:Se,80:Ke,81:Ae,82:Ze,83:qe,84:At,85:Fe,86:Lt,87:_r,88:Ge}),s(vi,[2,6]),s(ht,[2,31]),s(ht,[2,32]),{27:103,52:bo,53:st,54:gt},s(Ee,[2,36]),s(Ee,[2,62]),s(Ee,[2,63]),s(Ee,[2,64]),{29:[1,104]},s(Ee,[2,38]),s(Ee,[2,10]),s(Ee,[2,11]),s(Ee,[2,12]),{4:105,6:4,7:5,8:8,9:9,10:a,11:6,12:7,13:l,14:[1,106],15:c,16:11,17:d,20:12,21:u,23:p,24:g,25:10,26:13,28:b,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:x,48:w,49:E,50:k,51:S,55:T,56:V,57:O,58:y,59:L,60:P,61:K,62:$,63:U,64:J,65:R,66:q,67:_,68:A,69:z,70:Q,71:fe,72:ie,73:Le,74:pe,75:ae,76:ye,77:H,78:ge,79:Se,80:Ke,81:Ae,82:Ze,83:qe,84:At,85:Fe,86:Lt,87:_r,88:Ge},{4:108,6:4,7:5,8:8,9:9,10:a,11:6,12:7,13:l,14:[1,107],15:c,16:11,17:d,20:12,21:u,23:p,24:g,25:10,26:13,28:b,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:x,48:w,49:E,50:k,51:S,55:T,56:V,57:O,58:y,59:L,60:P,61:K,62:$,63:U,64:J,65:R,66:q,67:_,68:A,69:z,70:Q,71:fe,72:ie,73:Le,74:pe,75:ae,76:ye,77:H,78:ge,79:Se,80:Ke,81:Ae,82:Ze,83:qe,84:At,85:Fe,86:Lt,87:_r,88:Ge},s(Ee,[2,16]),{14:[1,109]},s(Ee,[2,19]),s(Ee,[2,25]),{18:[1,110]},{4:111,6:4,7:5,8:8,9:9,10:a,11:6,12:7,13:l,15:c,16:11,17:d,19:[1,112],20:12,21:u,23:p,24:g,25:10,26:13,28:b,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:x,48:w,49:E,50:k,51:S,55:T,56:V,57:O,58:y,59:L,60:P,61:K,62:$,63:U,64:J,65:R,66:q,67:_,68:A,69:z,70:Q,71:fe,72:ie,73:Le,74:pe,75:ae,76:ye,77:H,78:ge,79:Se,80:Ke,81:Ae,82:Ze,83:qe,84:At,85:Fe,86:Lt,87:_r,88:Ge},s(Ee,[2,24]),s(vi,[2,3]),s(Ee,[2,35]),s(Ee,[2,37]),{14:[1,113]},s(Ee,[2,15]),s(Ee,[2,14]),{14:[1,114]},s(Ee,[2,18]),{4:115,6:4,7:5,8:8,9:9,10:a,11:6,12:7,13:l,15:c,16:11,17:d,19:[1,116],20:12,21:u,23:p,24:g,25:10,26:13,28:b,30:19,31:20,32:21,33:22,34:23,35:24,36:25,37:26,38:27,39:28,40:29,41:30,42:31,43:32,44:33,45:34,46:35,47:x,48:w,49:E,50:k,51:S,55:T,56:V,57:O,58:y,59:L,60:P,61:K,62:$,63:U,64:J,65:R,66:q,67:_,68:A,69:z,70:Q,71:fe,72:ie,73:Le,74:pe,75:ae,76:ye,77:H,78:ge,79:Se,80:Ke,81:Ae,82:Ze,83:qe,84:At,85:Fe,86:Lt,87:_r,88:Ge},{19:[1,117]},s(Ee,[2,23]),s(Ee,[2,13]),s(Ee,[2,17]),{19:[1,118]},s(Ee,[2,21]),s(Ee,[2,22]),s(Ee,[2,20])],defaultActions:{3:[2,2],78:[2,1]},parseError:function(ve,Et){if(Et.recoverable)this.trace(ve);else{var It=new Error(ve);throw It.hash=Et,It}},parse:function(ve){var Et=this,It=[0],Ve=[],ni=[null],rt=[],ta=this.table,_t="",Mr=0,Ci=0,gn=0,Ll=2,wo=1,ro=rt.slice.call(arguments,1),nr=Object.create(this.lexer),Hi={yy:{}};for(var N in this.yy)Object.prototype.hasOwnProperty.call(this.yy,N)&&(Hi.yy[N]=this.yy[N]);nr.setInput(ve,Hi.yy),Hi.yy.lexer=nr,Hi.yy.parser=this,typeof nr.yylloc=="undefined"&&(nr.yylloc={});var W=nr.yylloc;rt.push(W);var re=nr.options&&nr.options.ranges;typeof Hi.yy.parseError=="function"?this.parseError=Hi.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;function be(Di){It.length=It.length-2*Di,ni.length=ni.length-Di,rt.length=rt.length-Di}e:var se=function(){var Di;return Di=nr.lex()||wo,typeof Di!="number"&&(Di=Et.symbols_[Di]||Di),Di};for(var ue,De,ze,$e,kt,ct,wt={},Vt,ar,St,zi;;){if(ze=It[It.length-1],this.defaultActions[ze]?$e=this.defaultActions[ze]:((ue===null||typeof ue=="undefined")&&(ue=se()),$e=ta[ze]&&ta[ze][ue]),typeof $e=="undefined"||!$e.length||!$e[0]){var Fn="";zi=[];for(Vt in ta[ze])this.terminals_[Vt]&&Vt>Ll&&zi.push("'"+this.terminals_[Vt]+"'");nr.showPosition?Fn="Parse error on line "+(Mr+1)+`:
`+nr.showPosition()+`
Expecting `+zi.join(", ")+", got '"+(this.terminals_[ue]||ue)+"'":Fn="Parse error on line "+(Mr+1)+": Unexpected "+(ue==wo?"end of input":"'"+(this.terminals_[ue]||ue)+"'"),this.parseError(Fn,{text:nr.match,token:this.terminals_[ue]||ue,line:nr.yylineno,loc:W,expected:zi})}if($e[0]instanceof Array&&$e.length>1)throw new Error("Parse Error: multiple actions possible at state: "+ze+", token: "+ue);switch($e[0]){case 1:It.push(ue),ni.push(nr.yytext),rt.push(nr.yylloc),It.push($e[1]),ue=null,De?(ue=De,De=null):(Ci=nr.yyleng,_t=nr.yytext,Mr=nr.yylineno,W=nr.yylloc,gn>0&&gn--);break;case 2:if(ar=this.productions_[$e[1]][1],wt.$=ni[ni.length-ar],wt._$={first_line:rt[rt.length-(ar||1)].first_line,last_line:rt[rt.length-1].last_line,first_column:rt[rt.length-(ar||1)].first_column,last_column:rt[rt.length-1].last_column},re&&(wt._$.range=[rt[rt.length-(ar||1)].range[0],rt[rt.length-1].range[1]]),ct=this.performAction.apply(wt,[_t,Ci,Mr,Hi.yy,$e[1],ni,rt].concat(ro)),typeof ct!="undefined")return ct;ar&&(It=It.slice(0,-1*ar*2),ni=ni.slice(0,-1*ar),rt=rt.slice(0,-1*ar)),It.push(this.productions_[$e[1]][0]),ni.push(wt.$),rt.push(wt._$),St=ta[It[It.length-2]][It[It.length-1]],It.push(St);break;case 3:return!0}}return!0}},Gr=function(){var rr={EOF:1,parseError:function(Et,It){if(this.yy.parser)this.yy.parser.parseError(Et,It);else throw new Error(Et)},setInput:function(ve,Et){return this.yy=Et||this.yy||{},this._input=ve,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var ve=this._input[0];this.yytext+=ve,this.yyleng++,this.offset++,this.match+=ve,this.matched+=ve;var Et=ve.match(/(?:\r\n?|\n).*/g);return Et?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),ve},unput:function(ve){var Et=ve.length,It=ve.split(/(?:\r\n?|\n)/g);this._input=ve+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-Et),this.offset-=Et;var Ve=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),It.length-1&&(this.yylineno-=It.length-1);var ni=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:It?(It.length===Ve.length?this.yylloc.first_column:0)+Ve[Ve.length-It.length].length-It[0].length:this.yylloc.first_column-Et},this.options.ranges&&(this.yylloc.range=[ni[0],ni[0]+this.yyleng-Et]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(ve){this.unput(this.match.slice(ve))},pastInput:function(){var ve=this.matched.substr(0,this.matched.length-this.match.length);return(ve.length>20?"...":"")+ve.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var ve=this.match;return ve.length<20&&(ve+=this._input.substr(0,20-ve.length)),(ve.substr(0,20)+(ve.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var ve=this.pastInput(),Et=new Array(ve.length+1).join("-");return ve+this.upcomingInput()+`
`+Et+"^"},test_match:function(ve,Et){var It,Ve,ni;if(this.options.backtrack_lexer&&(ni={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(ni.yylloc.range=this.yylloc.range.slice(0))),Ve=ve[0].match(/(?:\r\n?|\n).*/g),Ve&&(this.yylineno+=Ve.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:Ve?Ve[Ve.length-1].length-Ve[Ve.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+ve[0].length},this.yytext+=ve[0],this.match+=ve[0],this.matches=ve,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(ve[0].length),this.matched+=ve[0],It=this.performAction.call(this,this.yy,this,Et,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),It)return It;if(this._backtrack){for(var rt in ni)this[rt]=ni[rt];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var ve,Et,It,Ve;this._more||(this.yytext="",this.match="");for(var ni=this._currentRules(),rt=0;rt<ni.length;rt++)if(It=this._input.match(this.rules[ni[rt]]),It&&(!Et||It[0].length>Et[0].length)){if(Et=It,Ve=rt,this.options.backtrack_lexer){if(ve=this.test_match(It,ni[rt]),ve!==!1)return ve;if(this._backtrack){Et=!1;continue}else return!1}else if(!this.options.flex)break}return Et?(ve=this.test_match(Et,ni[Ve]),ve!==!1?ve:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var Et=this.next();return Et||this.lex()},begin:function(Et){this.conditionStack.push(Et)},popState:function(){var Et=this.conditionStack.length-1;return Et>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(Et){return Et=this.conditionStack.length-1-Math.abs(Et||0),Et>=0?this.conditionStack[Et]:"INITIAL"},pushState:function(Et){this.begin(Et)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(Et,It,Ve,ni){var rt=ni;switch(Ve){case 0:this.begin("captext");return;case 1:return 58;case 2:return this.popState(),58;break;case 3:return 62;case 4:return 63;case 5:return 64;case 6:return 65;case 7:return 66;case 8:return 67;case 9:return 49;case 10:return 50;case 11:return 51;case 12:return 52;case 13:return 53;case 14:return 54;case 15:return 72;case 16:return 75;case 17:return 76;case 18:return 77;case 19:return 71;case 20:return 73;case 21:return 74;case 22:return 78;case 23:return 69;case 24:return 70;case 25:return 81;case 26:return 13;case 27:return 15;case 28:return 14;case 29:return 10;case 30:return 28;case 31:return 29;case 32:return 84;case 33:return 85;case 34:return 86;case 35:return 17;case 36:return 18;case 37:return 19;case 38:return 79;case 39:return 80;case 40:return 83;case 41:return It.yytext=this.matches[1],21;break;case 42:return It.yytext=this.matches[1],22;break;case 43:return It.yytext=this.matches[1],24;break;case 44:return 68;case 45:return 47;case 46:return 48;case 47:return 87;case 48:return 61;case 49:return 60;case 50:return 82;case 51:return 56;case 52:return 56;case 53:return 57;case 54:return It.yytext=this.matches[1],58;break;case 55:return 59;case 56:return;case 57:return 88;case 58:return;case 59:return 55;case 60:return 5;case 61:return 90}},rules:[/^(?:([,][,])(?=[A-Z]))/,/^(?:[A-Z](?=[A-Z]))/,/^(?:[A-Z])/,/^(?:["][6])/,/^(?:["][-])/,/^(?:["][4])/,/^(?:["][8])/,/^(?:["][9])/,/^(?:["][/])/,/^(?:[.][<])/,/^(?:[_][<])/,/^(?:["][<])/,/^(?:[.][>])/,/^(?:[_][>])/,/^(?:["][>])/,/^(?:["][7][@][:])/,/^(?:[_][@][<])/,/^(?:[\^][9])/,/^(?:[_][@][>])/,/^(?:["][7])/,/^(?:[@][<])/,/^(?:[@][>])/,/^(?:[@][9])/,/^(?:[.][0])/,/^(?:[:][O])/,/^(?:[4][4][4])/,/^(?:[%][9])/,/^(?:[%])/,/^(?:[\+])/,/^(?:[95]+(?=.))/,/^(?:[<])/,/^(?:[>])/,/^(?:!)/,/^(?:[6])/,/^(?:[@]&)/,/^(?:[(])/,/^(?:[.][/])/,/^(?:[)])/,/^(?:#[L])/,/^(?:#-)/,/^(?:#=)/,/^(?:#([A-J4]+))/,/^(?:[/]([A-J4]+))/,/^(?:[#][/]([A-J4]+))/,/^(?:[_]?[/])/,/^(?:[1])/,/^(?:[4])/,/^(?:[7]+)/,/^(?:[_][\\][_][\\])/,/^(?:[_][\\])/,/^(?:[3])/,/^(?:(ARC)?(SIN|COS|TAN|CSC|SEC|COT)(H)?)/,/^(?:(ARG|DET|EXP|IM|INF|LIM|LN|LOG|MAX|MIN|MOD|RE|SUP))/,/^(?:[,]?[.][ABGDEZ\?\:IKLMNXOPRSTUYF\&W])/,/^(?:[,]([A-Z]))/,/^(?:[A-Z])/,/^(?:[,]['])/,/^(?:[8])/,/^(?:[;])/,/^(?:[ ])/,/^(?:$)/,/^(?:.)/],conditions:{captext:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61],inclusive:!0},INITIAL:{rules:[0,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61],inclusive:!0}}};return rr}();le.lexer=Gr;function _e(){this.yy={}}return _e.prototype=le,le.Parser=_e,new _e}();e.parser=o,e.Parser=o.Parser,e.parse=function(){return o.parse.apply(o,arguments)},e.main=function(a){a[1]||(console.log("Usage: "+a[0]+" FILE"),i.exit(1));var l=r(4).readFileSync(r(5).normalize(a[1]),"utf8");return e.parser.parse(l)},typeof n!="undefined"&&r.c[r.s]===n&&e.main(i.argv.slice(1))}).call(e,r(1),r(8)(t))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(2),n=r(7),o={"~":"\\ ","\\,":"\\ ","\\:":"\\ ","\\;":"\\ ","\\!":"\\ "},s={"\\Vert":"\\|","\\ge":"\\geq","\\le":"\\leq","\\vert":"|"},a={"\\space":!0};function l(u){for(var p=[],g=0;g<u.length;g++){var b=u[g];switch(b.type){case"command":var x=b.value.slice(1).trim();s.hasOwnProperty(b.value)?p.push(n.command(s[b.value])):i.containsValue(x)?p.push(n.typeform("operator_name",c(x))):a[b.value]||p.push(b);break;case"level":var w={subscript:b.subscript&&b.subscript.length>0?l(b.subscript):void 0,superscript:b.superscript&&b.superscript.length>0?l(b.superscript):void 0,type:b.type};(w.subscript||w.superscript)&&p.push(w);break;case"fraction":p.push({denominator:l(b.denominator),numerator:l(b.numerator),type:b.type});break;case"radical":p.push({index:b.index?l(b.index):void 0,radicand:l(b.radicand),type:b.type});break;case"terminal":d(u.slice(g))?(p.push({type:"command",value:"\\ldots"}),g+=2):p.push({type:b.type,value:o.hasOwnProperty(b.value)?o[b.value]:b.value});break;case"typeform":p.push(b);break;case"greek":p.push({type:b.type,value:o.hasOwnProperty(b.value)?o[b.value]:b.value});break;default:throw new Error(`Unexpected item:
`+JSON.stringify({group:u,item:b}))}}return p}e.default=l;function c(u){for(var p=[],g=0,b=u;g<b.length;g++){var x=b[g];p.push(n.terminal(x))}return p}function d(u){for(var p=0,g=0;g<Math.min(3,u.length);g++){var b=u[g];b.type==="terminal"&&b.value==="."&&p++}return p===3}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(6),n=r(13),o=r(7);n.parser.yy=o;function s(a){try{return{isError:!1,value:n.parser.parse(a)}}catch(l){return{isError:!0,error:i.default(l)}}}e.default=s},function(t,e,r){(function(i,n){var o=function(){var s=function(q,_,A,z){for(A=A||{},z=q.length;z--;A[q[z]]=_);return A},a=[1,13],l=[1,14],c=[1,15],d=[1,16],u=[1,17],p=[1,21],g=[1,18],b=[1,19],x=[1,20],w=[1,22],E=[1,23],k=[1,28],S=[1,30],T=[1,31],V=[1,32],O=[1,33],y=[1,29],L=[5,21,27,38],P=[5,19,21,22,23,24,25,26,27,28,32,33,34,35,36,37,38],K=[5,10,12,13,14,19,21,22,23,24,25,26,27,28,32,33,34,35,36,37,38],$=[5,10,19,21,22,23,24,25,26,27,28,32,33,34,35,36,37,38],U={trace:function(){},yy:{},symbols_:{error:2,sentence:3,group:4,EOF:5,level:6,expression:7,subscript:8,superscript:9,_:10,atom:11,"^":12,"PRIMES^":13,PRIMES:14,delimited_group:15,typeform:16,frac:17,radical:18,LEFT:19,delimiter:20,RIGHT:21,FRAC:22,OPERATOR_NAME:23,MATHRM:24,TEXT:25,RADICAL_OPTARG:26,CLOSE_OPTARG:27,RADICAL:28,curly_group:29,greek:30,command:31,SYMBOL:32,DELIMITER:33,DELIMITER_COMMAND:34,GREEK:35,COMMAND:36,"{":37,"}":38,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",10:"_",12:"^",13:"PRIMES^",14:"PRIMES",19:"LEFT",21:"RIGHT",22:"FRAC",23:"OPERATOR_NAME",24:"MATHRM",25:"TEXT",26:"RADICAL_OPTARG",27:"CLOSE_OPTARG",28:"RADICAL",32:"SYMBOL",33:"DELIMITER",34:"DELIMITER_COMMAND",35:"GREEK",36:"COMMAND",37:"{",38:"}"},productions_:[0,[3,2],[3,1],[4,3],[4,2],[4,1],[4,2],[4,1],[6,2],[6,2],[6,1],[6,1],[8,2],[9,2],[9,2],[9,1],[7,1],[7,1],[7,1],[7,1],[7,1],[15,5],[15,4],[17,3],[16,2],[16,2],[16,2],[18,4],[18,3],[18,2],[18,2],[11,1],[11,1],[11,1],[11,1],[11,1],[20,1],[20,1],[30,1],[31,1],[29,3],[29,2]],performAction:function(_,A,z,Q,fe,ie,Le){var pe=ie.length-1;switch(fe){case 1:return ie[pe-1];case 2:return Q.group();case 3:this.$=Q.group(ie[pe-2],ie[pe-1],ie[pe]);break;case 4:case 6:this.$=Q.group(ie[pe-1],ie[pe]);break;case 5:case 7:this.$=Q.group(ie[pe]);break;case 8:this.$=Q.level({_:Q.group(ie[pe-1]),"^":Q.group(ie[pe])});break;case 9:this.$=Q.level({_:Q.group(ie[pe]),"^":Q.group(ie[pe-1])});break;case 10:this.$=Q.level({"^":Q.group(ie[pe])});break;case 11:this.$=Q.level({_:Q.group(ie[pe])});break;case 12:case 13:this.$=ie[pe];break;case 14:this.$=Q.processPrimes(ie[pe-1],ie[pe]);break;case 15:this.$=Q.processPrimes(ie[pe],Q.group());break;case 21:this.$=Q.group(ie[pe-3],ie[pe-2],ie[pe]);break;case 22:this.$=Q.group(ie[pe-2],ie[pe]);break;case 23:this.$=Q.fraction(Q.group(ie[pe-1]),Q.group(ie[pe]));break;case 24:this.$=Q.typeform("operator_name",Q.group(ie[pe]));break;case 25:this.$=Q.typeform("mathrm",Q.group(ie[pe]));break;case 26:this.$=Q.typeform("text",Q.group(ie[pe]));break;case 27:this.$=Q.radical(ie[pe],Q.group(ie[pe-2]));break;case 28:this.$=Q.radical(Q.group(ie[pe]),Q.group());break;case 29:case 30:this.$=Q.radical(Q.group(ie[pe]));break;case 35:case 36:this.$=Q.terminal(ie[pe]);break;case 37:case 39:this.$=Q.command(ie[pe]);break;case 38:this.$=Q.greek(ie[pe]);break;case 40:this.$=ie[pe-1];break;case 41:this.$=Q.group();break}},table:[{3:1,4:2,5:[1,3],6:4,7:5,8:6,9:7,10:a,11:12,12:l,13:c,14:d,15:8,16:9,17:10,18:11,19:u,20:25,22:p,23:g,24:b,25:x,26:w,28:E,29:24,30:26,31:27,32:k,33:S,34:T,35:V,36:O,37:y},{1:[3]},{5:[1,34]},{1:[2,2]},s(L,[2,5],{15:8,16:9,17:10,18:11,11:12,29:24,20:25,30:26,31:27,7:35,19:u,22:p,23:g,24:b,25:x,26:w,28:E,32:k,33:S,34:T,35:V,36:O,37:y}),s(L,[2,7],{6:4,7:5,8:6,9:7,15:8,16:9,17:10,18:11,11:12,29:24,20:25,30:26,31:27,4:36,10:a,12:l,13:c,14:d,19:u,22:p,23:g,24:b,25:x,26:w,28:E,32:k,33:S,34:T,35:V,36:O,37:y}),s(P,[2,11],{9:37,12:l,13:c,14:d}),s(P,[2,10],{8:38,10:a}),s(K,[2,16]),s(K,[2,17]),s(K,[2,18]),s(K,[2,19]),s(K,[2,20]),{11:39,20:25,29:24,30:26,31:27,32:k,33:S,34:T,35:V,36:O,37:y},{11:40,20:25,29:24,30:26,31:27,32:k,33:S,34:T,35:V,36:O,37:y},{11:41,20:25,29:24,30:26,31:27,32:k,33:S,34:T,35:V,36:O,37:y},s($,[2,15]),{20:42,33:S,34:T},{11:43,20:25,29:24,30:26,31:27,32:k,33:S,34:T,35:V,36:O,37:y},{11:44,20:25,29:24,30:26,31:27,32:k,33:S,34:T,35:V,36:O,37:y},{11:45,20:25,29:24,30:26,31:27,32:k,33:S,34:T,35:V,36:O,37:y},{11:46,20:25,29:24,30:26,31:27,32:k,33:S,34:T,35:V,36:O,37:y},{4:47,6:4,7:5,8:6,9:7,10:a,11:12,12:l,13:c,14:d,15:8,16:9,17:10,18:11,19:u,20:25,22:p,23:g,24:b,25:x,26:w,27:[1,48],28:E,29:24,30:26,31:27,32:k,33:S,34:T,35:V,36:O,37:y},{11:49,17:50,20:25,22:p,29:24,30:26,31:27,32:k,33:S,34:T,35:V,36:O,37:y},s(K,[2,31]),s(K,[2,32]),s(K,[2,33]),s(K,[2,34]),s(K,[2,35]),{4:51,6:4,7:5,8:6,9:7,10:a,11:12,12:l,13:c,14:d,15:8,16:9,17:10,18:11,19:u,20:25,22:p,23:g,24:b,25:x,26:w,28:E,29:24,30:26,31:27,32:k,33:S,34:T,35:V,36:O,37:y,38:[1,52]},s(K,[2,36]),s(K,[2,37]),s(K,[2,38]),s(K,[2,39]),{1:[2,1]},s(L,[2,4],{6:4,7:5,8:6,9:7,15:8,16:9,17:10,18:11,11:12,29:24,20:25,30:26,31:27,4:53,10:a,12:l,13:c,14:d,19:u,22:p,23:g,24:b,25:x,26:w,28:E,32:k,33:S,34:T,35:V,36:O,37:y}),s(L,[2,6]),s(P,[2,8]),s(P,[2,9]),s([5,12,13,14,19,21,22,23,24,25,26,27,28,32,33,34,35,36,37,38],[2,12]),s($,[2,13]),s($,[2,14]),{4:54,6:4,7:5,8:6,9:7,10:a,11:12,12:l,13:c,14:d,15:8,16:9,17:10,18:11,19:u,20:25,21:[1,55],22:p,23:g,24:b,25:x,26:w,28:E,29:24,30:26,31:27,32:k,33:S,34:T,35:V,36:O,37:y},s(K,[2,24]),s(K,[2,25]),s(K,[2,26]),{11:56,20:25,29:24,30:26,31:27,32:k,33:S,34:T,35:V,36:O,37:y},{27:[1,57]},{11:58,20:25,29:24,30:26,31:27,32:k,33:S,34:T,35:V,36:O,37:y},s(K,[2,29]),s(K,[2,30]),{38:[1,59]},s(K,[2,41]),s(L,[2,3]),{21:[1,60]},{20:61,33:S,34:T},s(K,[2,23]),{11:62,20:25,29:24,30:26,31:27,32:k,33:S,34:T,35:V,36:O,37:y},s(K,[2,28]),s(K,[2,40]),{20:63,33:S,34:T},s(K,[2,22]),s(K,[2,27]),s(K,[2,21])],defaultActions:{3:[2,2],34:[2,1]},parseError:function(_,A){if(A.recoverable)this.trace(_);else{var z=new Error(_);throw z.hash=A,z}},parse:function(_){var A=this,z=[0],Q=[],fe=[null],ie=[],Le=this.table,pe="",ae=0,ye=0,H=0,ge=2,Se=1,Ke=ie.slice.call(arguments,1),Ae=Object.create(this.lexer),Ze={yy:{}};for(var qe in this.yy)Object.prototype.hasOwnProperty.call(this.yy,qe)&&(Ze.yy[qe]=this.yy[qe]);Ae.setInput(_,Ze.yy),Ze.yy.lexer=Ae,Ze.yy.parser=this,typeof Ae.yylloc=="undefined"&&(Ae.yylloc={});var At=Ae.yylloc;ie.push(At);var Fe=Ae.options&&Ae.options.ranges;typeof Ze.yy.parseError=="function"?this.parseError=Ze.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;function Lt(ve){z.length=z.length-2*ve,fe.length=fe.length-ve,ie.length=ie.length-ve}e:var _r=function(){var ve;return ve=Ae.lex()||Se,typeof ve!="number"&&(ve=A.symbols_[ve]||ve),ve};for(var Ge,vi,ht,Ee,bo,st,gt={},ft,le,Gr,_e;;){if(ht=z[z.length-1],this.defaultActions[ht]?Ee=this.defaultActions[ht]:((Ge===null||typeof Ge=="undefined")&&(Ge=_r()),Ee=Le[ht]&&Le[ht][Ge]),typeof Ee=="undefined"||!Ee.length||!Ee[0]){var rr="";_e=[];for(ft in Le[ht])this.terminals_[ft]&&ft>ge&&_e.push("'"+this.terminals_[ft]+"'");Ae.showPosition?rr="Parse error on line "+(ae+1)+`:
`+Ae.showPosition()+`
Expecting `+_e.join(", ")+", got '"+(this.terminals_[Ge]||Ge)+"'":rr="Parse error on line "+(ae+1)+": Unexpected "+(Ge==Se?"end of input":"'"+(this.terminals_[Ge]||Ge)+"'"),this.parseError(rr,{text:Ae.match,token:this.terminals_[Ge]||Ge,line:Ae.yylineno,loc:At,expected:_e})}if(Ee[0]instanceof Array&&Ee.length>1)throw new Error("Parse Error: multiple actions possible at state: "+ht+", token: "+Ge);switch(Ee[0]){case 1:z.push(Ge),fe.push(Ae.yytext),ie.push(Ae.yylloc),z.push(Ee[1]),Ge=null,vi?(Ge=vi,vi=null):(ye=Ae.yyleng,pe=Ae.yytext,ae=Ae.yylineno,At=Ae.yylloc,H>0&&H--);break;case 2:if(le=this.productions_[Ee[1]][1],gt.$=fe[fe.length-le],gt._$={first_line:ie[ie.length-(le||1)].first_line,last_line:ie[ie.length-1].last_line,first_column:ie[ie.length-(le||1)].first_column,last_column:ie[ie.length-1].last_column},Fe&&(gt._$.range=[ie[ie.length-(le||1)].range[0],ie[ie.length-1].range[1]]),st=this.performAction.apply(gt,[pe,ye,ae,Ze.yy,Ee[1],fe,ie].concat(Ke)),typeof st!="undefined")return st;le&&(z=z.slice(0,-1*le*2),fe=fe.slice(0,-1*le),ie=ie.slice(0,-1*le)),z.push(this.productions_[Ee[1]][0]),fe.push(gt.$),ie.push(gt._$),Gr=Le[z[z.length-2]][z[z.length-1]],z.push(Gr);break;case 3:return!0}}return!0}},J=function(){var q={EOF:1,parseError:function(A,z){if(this.yy.parser)this.yy.parser.parseError(A,z);else throw new Error(A)},setInput:function(_,A){return this.yy=A||this.yy||{},this._input=_,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var _=this._input[0];this.yytext+=_,this.yyleng++,this.offset++,this.match+=_,this.matched+=_;var A=_.match(/(?:\r\n?|\n).*/g);return A?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),_},unput:function(_){var A=_.length,z=_.split(/(?:\r\n?|\n)/g);this._input=_+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-A),this.offset-=A;var Q=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),z.length-1&&(this.yylineno-=z.length-1);var fe=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:z?(z.length===Q.length?this.yylloc.first_column:0)+Q[Q.length-z.length].length-z[0].length:this.yylloc.first_column-A},this.options.ranges&&(this.yylloc.range=[fe[0],fe[0]+this.yyleng-A]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(_){this.unput(this.match.slice(_))},pastInput:function(){var _=this.matched.substr(0,this.matched.length-this.match.length);return(_.length>20?"...":"")+_.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var _=this.match;return _.length<20&&(_+=this._input.substr(0,20-_.length)),(_.substr(0,20)+(_.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var _=this.pastInput(),A=new Array(_.length+1).join("-");return _+this.upcomingInput()+`
`+A+"^"},test_match:function(_,A){var z,Q,fe;if(this.options.backtrack_lexer&&(fe={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(fe.yylloc.range=this.yylloc.range.slice(0))),Q=_[0].match(/(?:\r\n?|\n).*/g),Q&&(this.yylineno+=Q.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:Q?Q[Q.length-1].length-Q[Q.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+_[0].length},this.yytext+=_[0],this.match+=_[0],this.matches=_,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(_[0].length),this.matched+=_[0],z=this.performAction.call(this,this.yy,this,A,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),z)return z;if(this._backtrack){for(var ie in fe)this[ie]=fe[ie];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var _,A,z,Q;this._more||(this.yytext="",this.match="");for(var fe=this._currentRules(),ie=0;ie<fe.length;ie++)if(z=this._input.match(this.rules[fe[ie]]),z&&(!A||z[0].length>A[0].length)){if(A=z,Q=ie,this.options.backtrack_lexer){if(_=this.test_match(z,fe[ie]),_!==!1)return _;if(this._backtrack){A=!1;continue}else return!1}else if(!this.options.flex)break}return A?(_=this.test_match(A,fe[Q]),_!==!1?_:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var A=this.next();return A||this.lex()},begin:function(A){this.conditionStack.push(A)},popState:function(){var A=this.conditionStack.length-1;return A>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(A){return A=this.conditionStack.length-1-Math.abs(A||0),A>=0?this.conditionStack[A]:"INITIAL"},pushState:function(A){this.begin(A)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(A,z,Q,fe){var ie=fe;switch(Q){case 0:break;case 1:return this.begin("optarg"),26;break;case 2:return this.popState(),27;break;case 3:return 23;case 4:return 24;case 5:return 25;case 6:return 28;case 7:return 22;case 8:return 13;case 9:return 14;case 10:return 12;case 11:return 10;case 12:return 19;case 13:return 21;case 14:return 34;case 15:return 33;case 16:return 37;case 17:return 38;case 18:return 32;case 19:return 32;case 20:return 32;case 21:return 35;case 22:return 35;case 23:return 36;case 24:return 32;case 25:return 5}},rules:[/^(?:\s+)/,/^(?:(\\sqrt)\s*\[)/,/^(?:\])/,/^(?:(\\operatorname))/,/^(?:(\\mathrm))/,/^(?:(\\text))/,/^(?:(\\sqrt))/,/^(?:(\\frac))/,/^(?:'+\^)/,/^(?:'+)/,/^(?:\^)/,/^(?:[_])/,/^(?:(\\left))/,/^(?:(\\right))/,/^(?:(\\langle|\\rangle|\\vert|\\Vert))/,/^(?:\[|\]|\\\{|\\\}|\(|\)|\||\\\|)/,/^(?:\{)/,/^(?:\})/,/^(?:\\(infty))/,/^(?:\\(int))/,/^(?:!)/,/^(?:\\(alpha|beta|gamma|delta|epsilon|zeta|eta|theta|iota|kappa|lambda|mu|nu|omicron|pi|rho|sigma|tau|xi|upsilon|phi|chi|psi|omega))/,/^(?:\\(Alpha|Beta|Gamma|Delta|Epsilon|Zeta|Eta|Theta|Iota|Kappa|Lambda|Mu|Nu|Omicron|Pi|Rho|Sigma|Tau|Xi|Upsilon|Phi|Chi|Psi|Omega))/,/^(?:\\[A-Za-z]+)/,/^(?:\\.|.)/,/^(?:$)/],conditions:{optarg:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25],inclusive:!0},INITIAL:{rules:[0,1,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25],inclusive:!0}}};return q}();U.lexer=J;function R(){this.yy={}}return R.prototype=U,U.Parser=R,new R}();e.parser=o,e.Parser=o.Parser,e.parse=function(){return o.parse.apply(o,arguments)},e.main=function(a){a[1]||(console.log("Usage: "+a[0]+" FILE"),i.exit(1));var l=r(4).readFileSync(r(5).normalize(a[1]),"utf8");return e.parser.parse(l)},typeof n!="undefined"&&r.c[r.s]===n&&e.main(i.argv.slice(1))}).call(e,r(1),r(8)(t))},function(t,e,r){"use strict";var i=this&&this.__assign||function(){return i=Object.assign||function(U){for(var J,R=1,q=arguments.length;R<q;R++){J=arguments[R];for(var _ in J)Object.prototype.hasOwnProperty.call(J,_)&&(U[_]=J[_])}return U},i.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var n=r(11),o=r(12),s=r(0);function a(U){return s.map(o.default(U),function(J){return $(n.default(J))})}e.default=a;var l={"!":"&","*":"@#",",":", ","/":"_/",":":"_3","<":' "K ',"=":" .K ",">":" .1 ","?":"_8","[":"@(","\\ ":" ","\\%":"@0","\\&":"_&","\\,":" ","\\infty":",=","\\int":"!","\\{":".(","\\|":"\\\\","\\}":".)","]":"@)","|":"\\"};function c(U){return/^[a-z]$/.test(U.value)?U.value.toUpperCase():/^[A-Z]$/.test(U.value)?","+U.value:/^[0-9.]$/.test(U.value)||/^[+\-()]$/.test(U.value)?U.value:l.hasOwnProperty(U.value)?l[U.value]:"[terminal: "+U.value+"]"}var d={"\\Vert":"\\\\","\\cdot":"*","\\div":"./","\\ge":" .1: ","\\geq":" .1: ","\\langle":"..(","\\ldots":" ''' ","\\le":' "K: ',"\\leq":' "K: ',"\\ne":" /.K ","\\neq":" /.K ","\\approx":" @:@: ","\\nparallel":" /$L ","\\parallel":" $L ","\\perp":" $P ","\\prime":"'","\\prod":".,P","\\rangle":"..)","\\sim":"@:","\\sum":".,S","\\times":"@*","\\to":" $O ","\\vert":"\\"},u={"\\Alpha":".,A","\\Beta":".,B","\\Chi":".,&","\\Delta":".,D","\\Epsilon":".,E","\\Eta":".,:","\\Gamma":".,G","\\Iota":".,I","\\Kappa":".,K","\\Lambda":".,L","\\Mu":".,M","\\Nu":".,N","\\Omega":".,W","\\Omicron":".,O","\\Phi":".,F","\\Pi":".,P","\\Psi":".,Y","\\Rho":".,R","\\Sigma":".,S","\\Tau":".,T","\\Theta":".,?","\\Upsilon":".,U","\\Xi":".,X","\\Zeta":".,Z","\\alpha":".A","\\beta":".B","\\chi":".&","\\delta":".D","\\epsilon":".E","\\eta":".:","\\gamma":".G","\\iota":".I","\\kappa":".K","\\lambda":".L","\\mu":".M","\\nu":".N","\\omega":".W","\\omicron":".O","\\phi":".F","\\pi":".P","\\psi":".Y","\\rho":".R","\\sigma":".S","\\tau":".T","\\theta":".?","\\upsilon":".U","\\xi":".X","\\zeta":".Z"};function p(U){return d.hasOwnProperty(U.value)?d[U.value]:U.value.slice(1).toUpperCase()+" "}function g(U){return u.hasOwnProperty(U.value)?u[U.value]:U.value.slice(1).toUpperCase()+" "}function b(U){return U.value==="\\space"}function x(U,J){return U.isStartOfLine&&/^-?$/.test(J)||/\s-?$/.test(J)||U.wasFraction}function w(U){return U.value==="\\sum"||U.value==="\\prod"}function E(U,J){if(J>=U.length)return!1;var R=U[J];if(R.type==="terminal"){if(/^[0-9]$/.test(R.value))return!0;if(R.value!=="."||J+1>=U.length)return!1;if(R=U[J+1],R.type==="terminal")return/^[0-9]$/.test(R.value)}return!1}function k(U,J){for(var R="",q=U.levelIndicator,_=0,A=!1,z=0;z<J.length;z++){E(J,z)&&(q===""&&/[A-Z]$/.test(R)?R+=y(q):x(U,R)&&(R+="#"));var Q=J[z],fe=z<J.length-1?J[z+1]:null;switch(Q.type!=="level"&&q!==U.levelIndicator&&(K(Q)?q="":(U.wasModifiedExpression&&U.levelIndicator===""?U=P(U,{wasModifiedExpression:!1}):R+=y(U.levelIndicator),q=U.levelIndicator)),Q.type){case"terminal":!U.wasModifiedExpression&&q!==""&&K(Q)?R+=" "+y(q)+c(Q).trim()+" ":R+=c(Q),Q.value==="."&&fe&&(fe.type==="terminal"&&/^[^_\d,]/.test(c(fe))||fe.type==="greek")&&(R+='"'),U=P(U,{wasFraction:!1,wasRomanCommand:!1});break;case"command":if(!b(Q)){var ie=w(Q);ie&&(R+='"'),!ie&&q!==""&&K(Q)?R+=" "+y(q)+p(Q).trim()+" ":R+=p(Q),U=P(U,{wasFraction:!1,wasModifiedExpression:ie,wasRomanCommand:!0})}break;case"greek":R+=g(Q),U=P(U,{wasFraction:!1});break;case"fraction":var Le=S(U,Q);R+=Le.value,_=Math.max(_,Le.fractionLevel),U=P(U,{wasFraction:!0,wasRomanCommand:!1});break;case"radical":var pe=T(U,Q);R+=pe.value,_=Math.max(_,pe.fractionLevel),U=P(U,{wasFraction:!1,wasRomanCommand:!1});break;case"level":!U.wasModifiedExpression&&U.wasRomanCommand?(A=/\s$/.test(R),A&&(R=R.replace(/\s$/,""))):A=!1;var ae=R.length>0&&/[A-Za-z]/.test(R[R.length-1])===!0,ye=V(U,ae,A,Q);R+=ye.value,q=ye.levelIndicator,U=P(U,{wasFraction:!1,wasRomanCommand:!1});break;case"typeform":R+=k(U,Q.value).value,Q.name==="operator_name"&&(R+=" "),U=P(U,{wasFraction:!1,wasModifiedExpression:!1,wasRomanCommand:!1});break}}return{fractionLevel:_,levelIndicator:q,value:R}}function S(U,J){U=P(U,{isStartOfLine:!1});for(var R=k(U,J.numerator),q=k(U,J.denominator),_=Math.max(R.fractionLevel,q.fractionLevel),A="",z=0;z<_;z++)A+=",";var Q=A+"?"+R.value;return R.levelIndicator!==U.levelIndicator&&(Q+=y(U.levelIndicator)),/\.$/.test(R.value)&&(Q+='"'),Q+=A+"/"+q.value,q.levelIndicator!==U.levelIndicator&&(Q+=y(U.levelIndicator)),/\.$/.test(q.value)&&(Q+='"'),Q+=A+"#",{fractionLevel:_+1,value:Q}}function T(U,J){for(var R=U.radicalLevel,q="",_="",A=0;A<R;A++)_+=".";if(J.index){q+=_+"<";var z=k(P(U,{isStartOfLine:!1}),J.index);q+=z.value,/\.$/.test(z.value)&&(q+='"'),z.levelIndicator!==U.levelIndicator&&(q+=y(U.levelIndicator)),q+=">"}else q+=_+">";var Q=k(P(U,{isStartOfLine:!1,radicalLevel:R+1}),J.radicand);return q+=Q.value,/\.$/.test(Q.value)&&(q+='"'),Q.levelIndicator!==U.levelIndicator&&(q+=y(U.levelIndicator)),q+=_+"]",{fractionLevel:Q.fractionLevel,value:q}}function V(U,J,R,q){var _=U.levelIndicator,A="",z=O(q.superscript);if(A+=z,q.subscript){U.wasModifiedExpression&&(A+="%"),_=U.levelIndicator+";";var Q=k(P(U,{isStartOfLine:!1,levelIndicator:_}),q.subscript);J&&/^[0-9]*(\.|\,)?[0-9]+$/.test(Q.value)&&_.length<=1?_=U.levelIndicator:!U.wasModifiedExpression&&q.subscript[0]&&q.subscript[0].type!=="level"&&(A+=y(_)),A+=Q.value,/\.$/.test(Q.value)&&(A+='"')}if(q.superscript){U.wasModifiedExpression&&(A+="<"),_=U.levelIndicator+"^";var fe=k(P(U,{isStartOfLine:!1,levelIndicator:_}),q.superscript.slice(z.length));!U.wasModifiedExpression&&q.superscript[0]&&q.superscript[0].type!=="level"&&fe.value!==""&&(A+=y(_)),A+=fe.value,/\.$/.test(fe.value)&&(A+='"')}return U.wasModifiedExpression?A+="]":U.wasRomanCommand&&R&&(A+=" ",_=_.slice(0,_.length-1)),{levelIndicator:_,value:A}}function O(U){var J="";if(U)for(var R=0,q=U;R<q.length;R++){var _=q[R];if(_.type==="command"&&_.value==="\\prime")J+="'";else break}return J}function y(U){return U||'"'}function L(){return{isStartOfLine:!0,levelIndicator:"",radicalLevel:0,wasFraction:!1,wasModifiedExpression:!1,wasRomanCommand:!1}}function P(U,J){return i(i({},U),J)}function K(U){return U.type==="terminal"||U.type==="command"?/^<|>|\=|\\leq?|\\geq?|\\neq?$/.test(U.value):!1}function $(U){var J=L();return k(J,U).value}},function(t,e,r){"use strict";var i=this&&this.__assign||function(){return i=Object.assign||function(R){for(var q,_=1,A=arguments.length;_<A;_++){q=arguments[_];for(var z in q)Object.prototype.hasOwnProperty.call(q,z)&&(R[z]=q[z])}return R},i.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var n=r(7),o=r(11),s=r(12),a=r(0);function l(R){return a.map(s.default(R),function(q){return J(o.default(q))})}e.default=l;var c={"!":"6","(":'"<',")":'">',"*":'"9',"+":'"6',",":"1","-":'"-',".":"4","/":"_/",":":"3","<":"@<","=":'"7',">":"@>","?":"8","[":".<","\\ ":" ","\\%":".0","\\&":"@&","\\,":" ","\\infty":"#=","\\int":"!","\\{":"_<","\\|":"_\\_\\","\\}":"_>","]":".>","|":"_\\"};function d(R,q,_){var A="",z=q.value,Q=_&&_.type==="terminal"?_.value:"";return S(z,R)&&(A+=";"),/^[\D]/.test(z)&&(R=U(R,{wasNumber:!1})),/^[a-z]$/.test(z)?R.capsLock?(R=U(R,{capsLock:!1}),A+=",'"+z.toUpperCase()):A+=z.toUpperCase():/^[A-Z]$/.test(z)?R.capsLock?A+=z:/[A-Z]/.test(Q)?(R=U(R,{capsLock:!0}),A+=",,"+z):A+=","+z:(R=U(R,{capsLock:!1}),/^[0-9.]$/.test(z)?A+=E(z):c.hasOwnProperty(z)?A+=c[z]:A+="[terminal: "+z+"]"),{value:A,ctx:R}}var u={"\\Vert":"_\\_\\","\\cdot":'"4',"\\div":'"/',"\\ge":"_@>","\\geq":"_@>","\\langle":"@<","\\ldots":"444","\\le":"_@<","\\leq":"_@<","\\ne":'"7@:',"\\neq":'"7@:',"\\approx":"^9","\\parallel":"#L","\\perp":"#-","\\prime":"7","\\prod":",.P","\\rangle":"@>","\\sim":"@9","\\sum":",.S","\\times":'"8',"\\to":":O","\\vert":"_\\"},p={"\\Alpha":",.A","\\Beta":",.B","\\Chi":",.&","\\Delta":",.D","\\Epsilon":",.E","\\Eta":",.:","\\Gamma":",.G","\\Iota":",.I","\\Kappa":",.K","\\Lambda":",.L","\\Mu":",.M","\\Nu":",.N","\\Omega":",.W","\\Omicron":",.O","\\Phi":",.F","\\Pi":",.P","\\Psi":",.Y","\\Rho":",.R","\\Sigma":",.S","\\Tau":",.T","\\Theta":",.?","\\Upsilon":",.U","\\Xi":",.X","\\Zeta":",.Z","\\alpha":".A","\\beta":".B","\\chi":".&","\\delta":".D","\\epsilon":".E","\\eta":".:","\\gamma":".G","\\iota":".I","\\kappa":".K","\\lambda":".L","\\mu":".M","\\nu":".N","\\omega":".W","\\omicron":".O","\\phi":".F","\\pi":".P","\\psi":".Y","\\rho":".R","\\sigma":".S","\\tau":".T","\\theta":".?","\\upsilon":".U","\\xi":".X","\\zeta":".Z"};function g(R,q){var _;return u.hasOwnProperty(R.value)?_=u[R.value]:_=R.value.slice(1).toUpperCase()+" ",S(_,q)&&(_=";"+_),/^[\D]/.test(_)&&(q=U(q,{wasNumber:!1})),{value:_,ctx:q}}function b(R){return p.hasOwnProperty(R.value)?p[R.value]:R.value.slice(1).toUpperCase()+" "}function x(R){return R.value==="\\space"}function w(R,q){if(q<R.length){var _=R[q];if(_.type==="terminal"){if(/^\d$/.test(_.value))return!0;if(_.value!=="."||q+1>=R.length)return!1;if(_=R[q+1],_.type==="terminal")return/^\d$/.test(_.value)}}return!1}function E(R){for(var q="",_="A".charCodeAt(0)-1,A=0,z=R;A<z.length;A++){var Q=z[A];Q===","?q+="1":Q==="."?q+="4":Q==="0"?q+="J":q+=String.fromCharCode(_+Number(Q))}return q}function k(R,q){for(var _,A,z="",Q=!0,fe=0;fe<q.length;fe++){w(q,fe)?(R=U(R,{wasNumber:!0}),Q&&(z+="#",Q=!1)):Q=!0;var ie=q[fe];switch(ie.type){case"terminal":var Le=fe<q.length-1?q[fe+1]:void 0;_=d(R,ie,Le),R=_.ctx,z+=_.value,z[z.length-1]===" "&&(Q=!0);break;case"command":x(ie)||(A=g(ie,R),R=A.ctx,z+=A.value,z[z.length-1]===" "&&(Q=!0));break;case"greek":z+=b(ie),z[z.length-1]===" "&&(Q=!0);break;case"fraction":var pe=T(R,ie);z+=pe.value,R=pe.ctx,Q=!1;break;case"radical":var ae=O(R,ie);z+=ae.value,Q=!0;break;case"level":var ye=y(R,ie);z+=ye.value,R=ye.ctx,Q=!0;break;case"typeform":var H=k(R,ie.value).value;z+=H,/(ARC)?(SIN|COS|TAN|CSC|SEC|COT)(H)?/.test(H)&&(z+=" ");break}}return{ctx:R,value:z}}function S(R,q){return q.wasNumber&&/^[A-Ja-j]/.test(R)}function T(R,q){var _=k(R,q.numerator),A=k(R,q.denominator),z;return V(_.value)&&V(A.value)?(R=U(R,{wasNumber:!0}),z=_.value+"/"+A.value.slice(1)):(R=U(R,{wasNumber:!1}),z="("+_.value+"./"+A.value+")"),{ctx:R,value:z}}function V(R){return/^\#[A-J41]+$/.test(R)}function O(R,q){var _="%",A=k(R,q.radicand);if(q.index){var z=k(R,n.group(n.level({"^":q.index})));_+=z.value,/\#[A-J]$/.test(z.value)&&/^[A-J]/.test(A.value)&&(_+=";")}return _+=A.value+"+",{ctx:R,value:_}}function y(R,q){var _="",A=P(q.superscript);_+=A;var z;if(q.subscript){var Q=k(R,q.subscript);K(q.subscript,Q.value,0)?z="<"+L(Q.value)+">":z=Q.value,R=U(R,{wasNumber:Q.ctx.wasNumber}),z!==""&&(_+="5"+z)}if(q.superscript){var fe=k(R,q.superscript.slice(A.length));K(q.superscript,fe.value,A.length)?z="<"+L(fe.value)+">":z=fe.value,R=U(R,{wasNumber:fe.ctx.wasNumber}),(A===""||z!=="")&&(_+="9"+z)}return{ctx:R,value:_}}function L(R){return/^;/.test(R)?R.slice(1):R}function P(R){var q="";if(R)for(var _=0,A=R;_<A.length;_++){var z=A[_];if(z.type==="command"&&z.value==="\\prime")q+="7";else break}return q}function K(R,q,_){var A=R[0],z=(q.match(/\</g)||[]).length,Q=/^["|\.|_]?\</.test(q),fe=(q.match(/\>/g)||[]).length,ie=/["|\.|_]?\>$/.test(q);return!V(q)&&R.length-_>1&&z===0&&fe===0||z>0&&fe>0&&(!Q||!ie)||z>1||fe>1||A&&A.type==="typeform"}function $(){return{capsLock:!1,wasNumber:!1}}function U(R,q){return i(i({},R),q)}function J(R){var q=$();return k(q,R).value}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(2),n=r(18),o=r(0);function s(S,T){for(var V="",O=T,y="",L=!1,P="",K="",$=u(S),U=0;U<S.length;U++){var J=S[U],R=U+1<S.length?S[U+1]:null;switch(J.type){case"terminal":var q=i.getAutoOperator(S.slice(U));q.value!==""?(V+=q.value,U+=q.terminalCount-1,L=L||q.modified):J.value===" "?(L?(y=P,V+=w(O,y),O=y):V+="\\ ",L=!1):($[U]===a?V+="\\left":$[U]===l&&(V+="\\right"),V+=J.value);break;case"comparison":y="",V+=w(O,y),O=y,L=!1,V+=J.value;break;case"level_with_comparison":V+=w(O,J.level),O=J.level,L=!1,V+=J.value;break;case"command":var _=J.value.slice(1).trim();R&&R.type==="terminal"&&/[a-z]/.test(R.value)?(V+=_,L=!1):i.containsValue(_)?(V+="\\operatorname{"+_+"}",L=!0):(V+=J.value,L=!0),P=O;break;case"expression":V+=J.value;break;case"fraction":V+=x(J.numerator,J.denominator,O);break;case"modified_expression":V+=s(J.expression,O)+" ",J.under&&(V+="_{"+s(J.under,O)+"}"),J.over&&(V+="^{"+s(J.over,O)+"}");break;case"radical":V+="\\sqrt",J.index&&(V+="["+s(J.index,O)+"]"),V+="{"+s(J.value,O)+"}";break;case"simple_subscript":O===""?(V+=J.base.value+"_{"+J.subscript.value+"}",J.base.type==="command"&&(L=!0,P=O)):V+=J.base.value+J.subscript.value;break;case"level":V+=w(O,J.value,K),O=J.value,J.value==="^"&&K!==""&&(K="");break;case"primes":R&&R.type==="level"&&R.value===";"?K=J.value:O!==""?(V+=Array(J.value.length+1).join("\\prime "),K=""):(V+=J.value,K="");break}}return V+=w(O,T)+K,V.replace(/([^\\])( )$/,"$1")}var a=1,l=-1,c=0,d=2;function u(S){for(var T=[],V=[],O=0;O<S.length;O++){var y=S[O];if(p(y))T.push({direction:a,index:O}),V.push(c);else if(g(y)){for(;T.length&&T[T.length-1].direction===d;)T.pop();if(T.length){var L=T.pop();if(L){var P=L.index;V[P]=a,V.push(l)}}else V.push(c)}else if(b(y))if(T.length&&T[T.length-1].direction===d){var L=T.pop();if(L){var P=L.index;V[P]=a,V.push(l)}}else T.push({direction:d,index:O}),V.push(c);else V.push(c)}return V}function p(S){return S.type==="terminal"?/^(\\langle |\[|\(|\\{)$/.test(S.value):!1}function g(S){return S.type==="terminal"?/^(\\rangle |\]|\)|\\})$/.test(S.value):!1}function b(S){return S.type==="terminal"?/^(\\\||\|)$/.test(S.value):!1}function x(S,T,V){return"\\frac{"+s(S,V)+"}{"+s(T,V)+"}"}function w(S,T,V){var O="",y,L,P,K=Math.max(S.length,T.length);for(y=0;y<K&&S[y]===T[y];y++);for(L=S.length-1;L>=y;L--)O+="}";for(P=y;P<T.length;P++)T[P]==="^"&&(V&&(O+=V),O+="^{"),T[P]===";"&&(O+="_{");return O}function E(S){return s(S,"")}function k(S,T){return T&&T.operatorNames?i.setOperatorNames(T.operatorNames):i.resetOperatorNames(),o.map(n.default(S,T),E)}e.default=k},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});function i(S){return{type:"terminal",value:S}}e.terminal=i;function n(S){return{type:"command",value:"\\"+S.trim()+" "}}e.command=n;var o={'"K':"<",'"K:':"\\leq ",$L:"\\parallel ",$O:"\\to ",$P:"\\perp ",".1":">",".1:":"\\geq ",".K":"=","@:@:":"\\approx","/$L":"\\nparallel ","/.K":"\\neq ","=":"=","@:":"\\sim "};function s(S){var T=/[\^;]+/.exec(S),V=T?T.toString():"",O=S.slice(l.length);return{type:"level_with_comparison",level:V,value:o[O]}}e.level_with_comparison=s;function a(S){return{type:"comparison",value:o[S]}}e.comparison=a;function l(S){return{type:"level",value:S}}e.level=l;function c(){return l("")}e.baseline=c;function d(S){return{type:"primes",value:S}}e.primes=d;function u(S,T){return{type:"fraction",numerator:S,denominator:T}}e.fraction=u;function p(S,T,V){return{type:"modified_expression",expression:S,under:T,over:V}}e.modified_expression=p;function g(S,T){return{type:"radical",value:S,index:T}}e.radical=g;function b(S){return{type:"expression",value:S}}e.expression=b;function x(S,T){return{type:"simple_subscript",base:S,subscript:T}}e.simple_subscript=x;var w={".&":"\\chi",".,&":"\\Chi",".,:":"\\Eta",".,?":"\\Theta",".,A":"\\Alpha",".,B":"\\Beta",".,D":"\\Delta",".,E":"\\Epsilon",".,F":"\\Phi",".,G":"\\Gamma",".,I":"\\Iota",".,K":"\\Kappa",".,L":"\\Lambda",".,M":"\\Mu",".,N":"\\Nu",".,O":"\\Omicron",".,P":"\\prod",".,R":"\\Rho",".,S":"\\sum",".,T":"\\Tau",".,U":"\\Upsilon",".,W":"\\Omega",".,X":"\\Xi",".,Y":"\\Psi",".,Z":"\\Zeta",".:":"\\eta",".?":"\\theta",".A":"\\alpha",".B":"\\beta",".D":"\\delta",".E":"\\epsilon",".F":"\\phi",".G":"\\gamma",".I":"\\iota",".K":"\\kappa",".L":"\\lambda",".M":"\\mu",".N":"\\nu",".O":"\\omicron",".P":"\\pi",".R":"\\rho",".S":"\\sigma",".T":"\\tau",".U":"\\upsilon",".W":"\\omega",".X":"\\xi",".Y":"\\psi",".Z":"\\zeta"};function E(S){if(w.hasOwnProperty(S))return w[S]+" ";throw new Error("Unknown Greek letter")}e.greek=E;function k(){for(var S=[],T=0;T<arguments.length;T++)S[T]=arguments[T];return Array.prototype.concat.apply([],S)}e.group=k},function(t,e,r){"use strict";var i=this&&this.__assign||function(){return i=Object.assign||function(c){for(var d,u=1,p=arguments.length;u<p;u++){d=arguments[u];for(var g in d)Object.prototype.hasOwnProperty.call(d,g)&&(c[g]=d[g])}return c},i.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var n=r(6),o=r(9),s=r(17),a=r(20);function l(c,d){d||(d={});var u=o.parser,p=Object.create(u);p.yy=s,p.yy.warnOrError=function(b){p.parseError(b,{recoverable:!1})};var g=Object.create(u);g.yy=i({warnings:[]},s),g.yy.warnOrError=function(b){g.yy.warnings.push(b)},g.lexer=a.default,d.strict?u=p:u=g;try{return{isError:!1,value:u.parse(c),warnings:u.yy.warnings||[]}}catch(b){return{error:n.default(b),isError:!0}}}e.default=l},function(t,e,r){"use strict";var i=this&&this.__assign||function(){return i=Object.assign||function(c){for(var d,u=1,p=arguments.length;u<p;u++){d=arguments[u];for(var g in d)Object.prototype.hasOwnProperty.call(d,g)&&(c[g]=d[g])}return c},i.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var n=r(6),o=r(21),s=r(10),a=r(24);function l(c,d){d||(d={});var u=s.parser,p=Object.create(u);p.yy=a;var g=Object.create(u);g.yy=i({warnings:[]},a),g.lexer=o.default,d.strict?u=p:u=g;try{return{isError:!1,value:u.parse(c),warnings:u.yy.warnings||[]}}catch(b){return{error:n.default(b),isError:!0}}}e.default=l},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(9),n=i.parser.lexer,o=Object.create(n);e.default=o;var s=i.parser.terminals_,a=i.parser.symbols_;o.setInput=function(l,c){this.delimiterStack=[],this.outputQueue=[],this.canAcceptPrimes=!1,n.setInput.call(this,l,c)},o.lex=function(){var l=-1;if(!this)return l;if(this.outputQueue.length)return this.outputQueue.shift();for(var c=n.lex.call(this);s[c]==="UNKNOWN"||!this.canAcceptPrimes&&s[c]==="PRIMES";)this.warn(),c=n.lex.call(this);this.canAcceptPrimes=!0;var d,u,p=this.delimiterStack?this.delimiterStack[this.delimiterStack.length-1]:-1;switch(s[c]){case"OPEN_FRAC":case"OPEN_MODEXP":this.delimiterStack.push(c),this.canAcceptPrimes=!1;break;case"RADICAL_INDEX":p===a.RADICAL_INDEX&&(this.delimiterStack.pop(),this.pushCloseTokens(p)),this.delimiterStack.push(c),this.canAcceptPrimes=!1;break;case"OPEN_RADICAL":p===a.RADICAL_INDEX&&this.delimiterStack.pop(),this.delimiterStack.push(c),this.canAcceptPrimes=!1;break;case"SLASH":for(d=!1;this.delimiterStack.length;)if(u=this.delimiterStack.pop()||-1,u===a.OPEN_FRAC){d=!0;break}else this.pushCloseTokens(u);d||this.pushOpenTokens(c),this.delimiterStack.push(c),this.canAcceptPrimes=!1;break;case"CLOSE_FRAC":for(d=!1;this.delimiterStack.length;)if(u=this.delimiterStack.pop()||-1,u===a.SLASH){d=!0;break}else if(u===a.OPEN_FRAC){this.addMissingToken(a.SLASH),d=!0;break}else this.pushCloseTokens(u);if(!d)return this.warn(),this.canAcceptPrimes=!1,this.lex();break;case"CLOSE_RADICAL":for(d=!1;this.delimiterStack.length;)if(u=this.delimiterStack.pop()||-1,u===a.OPEN_RADICAL){d=!0;break}else if(u===a.RADICAL_INDEX){d=!0,this.addMissingToken(a.OPEN_RADICAL);break}else this.pushCloseTokens(u);d||this.pushOpenTokens(c);break;case"CLOSE_MODEXP":for(d=!1;this.delimiterStack.length;)if(u=this.delimiterStack.pop()||-1,u===a.OPEN_MODEXP){d=!0;break}else this.pushCloseTokens(u);d||this.pushOpenTokens(c);break;case"EOF":for(;this.delimiterStack.length;)u=this.delimiterStack.pop()||-1,this.pushCloseTokens(u);break}return this.outputQueue.push(c),l=this.outputQueue.shift()||-1,l},o.warn=function(){this.yylloc&&this.yy.warnings.push({location:this.yylloc})},o.addMissingToken=function(l){this.outputQueue.push(l),this.warn()},o.pushCloseTokens=function(l){switch(s[l]){case"OPEN_FRAC":this.addMissingToken(a.SLASH),this.addMissingToken(a.CLOSE_FRAC);break;case"SLASH":this.addMissingToken(a.CLOSE_FRAC);break;case"RADICAL_INDEX":this.addMissingToken(a.OPEN_RADICAL),this.addMissingToken(a.CLOSE_RADICAL);break;case"OPEN_RADICAL":this.addMissingToken(a.CLOSE_RADICAL);break;case"OPEN_MODEXP":this.addMissingToken(a.CLOSE_MODEXP);break}},o.pushOpenTokens=function(l){switch(s[l]){case"SLASH":this.addMissingToken(a.OPEN_FRAC);break;case"CLOSE_FRAC":this.addMissingToken(a.OPEN_FRAC),this.addMissingToken(a.SLASH);break;case"CLOSE_RADICAL":this.addMissingToken(a.OPEN_RADICAL);break;case"CLOSE_MODEXP":this.addMissingToken(a.OPEN_MODEXP);break}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(10),n=i.parser.lexer,o=Object.create(n);e.default=o;var s=i.parser.terminals_,a=i.parser.symbols_;o.setInput=function(l,c){this.delimiterStack=[],this.outputQueue=[],n.setInput.call(this,l,c)},o.lex=function(){var l=-1;if(this.outputQueue.length)return this.outputQueue.shift();for(var c=n.lex.call(this);s[c]==="UNKNOWN";)this.warn(),c=n.lex.call(this);var d,u,p=this.delimiterStack?this.delimiterStack[this.delimiterStack.length-1]:-1;switch(s[c]){case"OPEN_FRAC":this.delimiterStack.push(c);break;case"OPEN_GROUP":this.delimiterStack.push(c);break;case"RADICAL_WITH_INDEX":p===a.RADICAL_WITH_INDEX&&(this.delimiterStack.pop(),this.pushCloseTokens(p)),this.delimiterStack.push(c);break;case"RADICAL":p===a.RADICAL_WITH_INDEX&&this.delimiterStack.pop(),this.delimiterStack.push(c);break;case"OVER":for(d=!1;this.delimiterStack.length;)if(u=this.delimiterStack.pop()||-1,u===a.OPEN_FRAC){d=!0;break}else this.pushCloseTokens(u);d||this.pushOpenTokens(c),this.delimiterStack.push(c);break;case"CLOSE_FRAC":for(d=!1;this.delimiterStack.length;)if(u=this.delimiterStack.pop()||-1,u===a.OVER){d=!0;break}else if(u===a.OPEN_FRAC){this.outputQueue.push(a.OVER),d=!0;break}else this.pushCloseTokens(u);d||this.pushOpenTokens(c);break;case"CLOSE_GROUP":for(d=!1;this.delimiterStack.length;)if(u=this.delimiterStack.pop()||-1,u===a.OPEN_GROUP){d=!0;break}else this.pushCloseTokens(u);d||this.pushOpenTokens(c);break;case"CLOSE_RADICAL":for(d=!1;this.delimiterStack.length;)if(u=this.delimiterStack.pop()||-1,u===a.RADICAL||u===a.RADICAL_WITH_INDEX){d=!0;break}else this.pushCloseTokens(u);d||this.pushOpenTokens(c);break;case"EOF":for(;this.delimiterStack.length;)u=this.delimiterStack.pop()||-1,this.pushCloseTokens(u);break}return this.outputQueue.push(c),l=this.outputQueue.shift()||-1,l},o.warn=function(){this.yylloc&&this.yy.warnings.push({location:this.yylloc})},o.addMissingToken=function(l){this.outputQueue.push(l),this.warn()},o.pushCloseTokens=function(l){switch(s[l]){case"OPEN_FRAC":this.addMissingToken(a.OVER),this.addMissingToken(a.CLOSE_FRAC);break;case"OVER":this.addMissingToken(a.CLOSE_FRAC);break;case"OPEN_GROUP":this.addMissingToken(a.CLOSE_GROUP);break;case"RADICAL_WITH_INDEX":case"RADICAL":this.addMissingToken(a.CLOSE_RADICAL);break}},o.pushOpenTokens=function(l){switch(s[l]){case"OVER":this.addMissingToken(a.OPEN_FRAC);break;case"CLOSE_FRAC":this.addMissingToken(a.OPEN_FRAC),this.addMissingToken(a.OVER);break;case"CLOSE_GROUP":this.addMissingToken(a.OPEN_GROUP);break;case"CLOSE_RADICAL":this.addMissingToken(a.RADICAL);break}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});function i(s){return s.isError}e.isErr=i;function n(s){return!s.isError}e.isOk=n;function o(s,a){return i(s)?s:{isError:!1,value:a(s.value)}}e.map=o},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(2),n=r(19),o=r(0);function s(T,V){for(var O="",y=!1,L="",P=u(T),K=0;K<T.length;K++){var $=T[K],U=K+1<T.length?T[K+1]:null;switch($.type){case"terminal":var J=i.getAutoOperator(T.slice(K));J.value!==""?(O+=J.value,K+=J.terminalCount-1):$.value===" "&&!y?O+="\\ ":(P[K]===a?O+="\\left":P[K]===l&&(O+="\\right"),O+=$.value),y=!1;break;case"command":var R=$.value.slice(1).trim();U&&U.type==="terminal"&&/[a-z]/.test(U.value)?(O+=R,y=!1):i.containsValue(R)?(O+="\\operatorname{"+R+"}",y=!0):(O+=$.value,y=!0);break;case"expression":O+=$.value;break;case"fraction":O+=x($.numerator,$.denominator);break;case"radical":O+="\\sqrt",$.index&&(O+="["+s($.index)+"]"),O+="{"+s($.value)+"}";break;case"basic_level":O+=w($.level,$.value,L),$.level==="9"&&(L="");break;case"bracketed_level":O+=E($.level,$.lbrack,$.value,$.rbrack,L),$.level==="9"&&(L="");break;case"primes":U&&(U.type==="basic_level"||U.type==="bracketed_level")&&U.level==="5"?L=$.value:V&&V!==""?(O+=Array($.value.length+1).join("\\prime "),L=""):(O+=$.value,L="");break}}return O+=L,O.replace(/([^\\])( )$/,"$1")}var a=1,l=-1,c=0,d=2;function u(T){for(var V=[],O=[],y=0;y<T.length;y++){var L=T[y];if(p(L))V.push({direction:a,index:y}),O.push(c);else if(g(L)){for(;V.length&&V[V.length-1].direction===d;)V.pop();if(V.length){var P=V.pop();if(P){var K=P.index;O[K]=a,O.push(l)}}else O.push(c)}else if(b(L))if(V.length&&V[V.length-1].direction===d){var P=V.pop();if(P){var K=P.index;O[K]=a,O.push(l)}}else V.push({direction:d,index:y}),O.push(c);else O.push(c)}return O}function p(T){return T.type==="terminal"?/^(\\langle |\[|\(|\\{)$/.test(T.value):!1}function g(T){return T.type==="terminal"?/^(\\rangle |\]|\)|\\})$/.test(T.value):!1}function b(T){return T.type==="terminal"?/^(\\\||\|)$/.test(T.value):!1}function x(T,V){return"\\frac{"+s(T)+"}{"+s(V)+"}"}function w(T,V,O){var y="",L="{"+s(V,T)+"}";return T==="9"?y+=O+"^"+L:T==="5"&&(y+="_"+L),y}function E(T,V,O,y,L){var P="",K="{"+V+s(O,T)+y+"}";return T==="9"?P+=L+"^"+K:T==="5"&&(P+="_"+K),P}var k=s;function S(T,V){return V&&V.operatorNames?i.setOperatorNames(V.operatorNames):i.resetOperatorNames(),o.map(n.default(T,V),function(O){return k(O,"")})}e.default=S},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});function i(x){return{type:"terminal",value:x}}e.terminal=i;function n(x){return{type:"command",value:x}}e.command=n;function o(x,w){return{type:"basic_level",level:x,value:w}}e.basic_level=o;function s(x,w,E,k){return{type:"bracketed_level",level:x,lbrack:w,value:E,rbrack:k}}e.bracketed_level=s;function a(x){var w=x.length>0?Array(x.length+1).join("'"):"";return{type:"primes",value:w}}e.primes=a;function l(x,w){return{type:"fraction",numerator:x,denominator:w}}e.fraction=l;function c(x,w){return{type:"radical",value:x,index:w}}e.radical=c;function d(x){return{type:"expression",value:x}}e.expression=d;function u(){for(var x=[],w=0;w<arguments.length;w++)x[w]=arguments[w];return Array.prototype.concat.apply([],x)}e.group=u;var p={",.&":"\\Chi",",.:":"\\Eta",",.?":"\\Theta",",.A":"\\Alpha",",.B":"\\Beta",",.D":"\\Delta",",.E":"\\Epsilon",",.F":"\\Phi",",.G":"\\Gamma",",.I":"\\Iota",",.K":"\\Kappa",",.L":"\\Lambda",",.M":"\\Mu",",.N":"\\Nu",",.O":"\\Omicron",",.P":"\\prod",",.R":"\\Rho",",.S":"\\sum",",.T":"\\Tau",",.U":"\\Upsilon",",.W":"\\Omega",",.X":"\\Xi",",.Y":"\\Psi",",.Z":"\\Zeta",".&":"\\chi",".:":"\\eta",".?":"\\theta",".A":"\\alpha",".B":"\\beta",".D":"\\delta",".E":"\\epsilon",".F":"\\phi",".G":"\\gamma",".I":"\\iota",".K":"\\kappa",".L":"\\lambda",".M":"\\mu",".N":"\\nu",".O":"\\omicron",".P":"\\pi",".R":"\\rho",".S":"\\sigma",".T":"\\tau",".U":"\\upsilon",".W":"\\omega",".X":"\\xi",".Y":"\\psi",".Z":"\\zeta"};function g(x){if(p.hasOwnProperty(x))return p[x]+" ";throw new Error("Unknown Greek letter")}e.greek=g;function b(x){for(var w="",E="A".charCodeAt(0)-1,k=0,S=x;k<S.length;k++){var T=S[k];T==="4"?w+=".":T==="J"?w+="0":w+=T.charCodeAt(0)-E}return w}e.to_number=b},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=` A1B'K2L@CIF/MSP"E3H9O6R^DJG>NTQ,*5<-U8V.%[$+X!&;:4\\0Z7(_?W]#Y)=`,n=10240;function o(b){return String.fromCharCode(n+b)}function s(b){return b.charCodeAt(0)-n}function a(b){return i[b]}function l(b){return i.indexOf(b)}function c(b){for(var x="",w=0,E=b;w<E.length;w++){var k=E[w];x+=o(l(k))}return x}function d(b){for(var x="",w=0,E=b;w<E.length;w++){var k=E[w];x+=a(s(k))}return x}e.toBrailleAscii=d;function u(b){return d(b).replace(/[@-^]/g,function(x){return String.fromCharCode(x.charCodeAt(0)+32)})}e.toExpandedBrailleAscii=u;function p(b){var x="";if(b)for(var w=0,E=b;w<E.length;w++){var k=E[w],S=k.charCodeAt(0);96<=S&&S<=127&&(S-=32,k=String.fromCharCode(S)),32<=S&&S<=95&&(k=c(k),S=k.charCodeAt(0)),10305<=S&&S<=10495&&(S=10240+(S-1024)%64,k=String.fromCharCode(S)),10240<=S&&S<=10304?x+=k:x+=String.fromCharCode(10240)}return x}e.coerceToSixDotCells=p;function g(b){for(var x=0;x<b.length;x++){var w=b.charCodeAt(x);if(w<10240||w>10304)return!1}return!0}e.isSixDotCells=g},function(t,e,r){r(3),t.exports=r(3)}])})});var UB=__dcg_shared_module_exports__['g']((Mve,KB)=>{KB.exports={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,menuitem:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0}});var HB=__dcg_shared_module_exports__['g']((Tve,qB)=>{var EW=/([\w-]+)|=|(['"])([.\s\S]*?)\2/g,kW=UB();qB.exports=function(t){var e=0,r,i=!0,n={type:"tag",name:"",voidElement:!1,attrs:{},children:[]};return t.replace(EW,function(o){if(o==="="){i=!0,e++;return}i?e===0?((kW[o]||t.charAt(t.length-2)==="/")&&(n.voidElement=!0),n.name=o):(n.attrs[r]=o.replace(/^['"]|['"]$/g,""),r=void 0):(r&&(n.attrs[r]=r),r=o),e++,i=!1}),n}});var $B=__dcg_shared_module_exports__['g']((Ave,zB)=>{var GW=/(?:<!--[\S\s]*?-->|<(?:"[^"]*"['"]*|'[^']*'['"]*|[^'">])+>)/g,VW=HB(),IW=Object.create?Object.create(null):{};function GT(t,e,r,i,n){var o=e.indexOf("<",i),s=e.slice(i,o===-1?void 0:o);/^\s*$/.test(s)&&(s=" "),(!n&&o>-1&&r+t.length>=0||s!==" ")&&t.push({type:"text",content:s})}zB.exports=function(e,r){r||(r={}),r.components||(r.components=IW);var i=[],n,o=-1,s=[],a={},l=!1;return e.replace(GW,function(c,d){if(l){if(c!=="</"+n.name+">")return;l=!1}var u=c.charAt(1)!=="/",p=c.indexOf("<!--")===0,g=d+c.length,b=e.charAt(g),x;u&&!p&&(o++,n=VW(c),n.type==="tag"&&r.components[n.name]&&(n.type="component",l=!0),!n.voidElement&&!l&&b&&b!=="<"&&GT(n.children,e,o,g,r.ignoreWhitespace),a[n.tagName]=n,o===0&&i.push(n),x=s[o-1],x&&x.children.push(n),s[o]=n),(p||!u||n.voidElement)&&(p||o--,!l&&b!=="<"&&b&&(x=o===-1?i:s[o].children,GT(x,e,o,g,r.ignoreWhitespace)))}),!i.length&&e.length&&GT(i,e,0,0,r.ignoreWhitespace),i}});var JB=__dcg_shared_module_exports__['g']((Lve,jB)=>{function MW(t){var e=[];for(var r in t)e.push(r+'="'+t[r]+'"');return e.length?" "+e.join(" "):""}function WB(t,e){switch(e.type){case"text":return t+e.content;case"tag":return t+="<"+e.name+(e.attrs?MW(e.attrs):"")+(e.voidElement?"/>":">"),e.voidElement?t:t+e.children.reduce(WB,"")+"</"+e.name+">"}}jB.exports=function(t){return t.reduce(function(e,r){return e+WB("",r)},"")}});var XB=__dcg_shared_module_exports__['g']((Pve,YB)=>{YB.exports={parse:$B(),stringify:JB()}});var LA;function R5(t){LA=t(__dcg_shared_module_exports__['d'])}R5(function(t){function e(){window.consoleOverride=!0;var i=window.console.log;window.console.log=function(){for(var n=[],o=0;o<arguments.length;o++)n.push(arguments[o]);i.apply(window.console,[].concat([n.join(" ")],n))}}var r={ready:function(){try{window.TestBridge=r,parent.USING_SELENIUM&&e()}catch(i){}}};return r});var{ready:PA}=LA;Oe();Oe();XG();var Ar={};__dcg_shared_module_exports__['h'](Ar,{ALT:()=>UU,BACKSPACE:()=>Pa,CAPSLOCK:()=>qU,CONTROL:()=>KU,DELETE:()=>Op,DOWN:()=>Yn,END:()=>Gh,ENTER:()=>ll,ESCAPE:()=>jn,HOME:()=>Vh,LEFT:()=>Rc,PAGEDOWN:()=>eg,PAGEUP:()=>Zu,RIGHT:()=>Nc,SHIFT:()=>Rf,SPACEBAR:()=>Nf,TAB:()=>Oa,UP:()=>Jn,default:()=>Fc,isBacktick:()=>BU,isHelp:()=>mV,isRedo:()=>Pp,isSelectAll:()=>NU,isUndo:()=>Lp,lookup:()=>Te,lookupChar:()=>ei});Oe();var EL=function(){{var t={IS_IE8:navigator.userAgent.match(/MSIE 8.0/i)!==null,IS_IE9:navigator.userAgent.match(/MSIE 9.0/i)!==null,IS_IE:navigator.userAgent.match(/MSIE/i)!==null||navigator.userAgent.match(/Trident/i)!==null&&navigator.userAgent.match(/rv:11/i)!==null,IS_EDGE:navigator.userAgent.match(/Edge/i)!==null,IS_IPAD:navigator.userAgent.match(/iPad/i)!==null,IS_MOBILE:navigator.userAgent.match(/Mobile|Android/i)!==null,IS_ANDROID:navigator.userAgent.match(/Android/i)!==null,IS_IOS:navigator.userAgent.match(/(iPad|iPhone|iPod)/i)!==null||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1,IS_CHROME:navigator.userAgent.match(/Chrome/i)!==null,IS_FIREFOX:navigator.userAgent.match(/Firefox/i)!==null,IS_SAFARI:navigator.userAgent.match(/^((?!chrome|android).)*safari/i)!==null,IS_APPLE:navigator.platform.match(/(Mac|iPhone|iPod|iPad)/i)!==null,IS_WINDOWS:navigator.platform.match(/(Win32)/i)!==null,IS_TOUCH:navigator.userAgent.match(/Touch/i)!==null,IS_KINDLE:navigator.userAgent.match(/Kindle/i)!==null||navigator.userAgent.match(/Silk/i)!==null,IS_BRAILLENOTE:navigator.userAgent.match(/KeyWeb/i)!==null,IS_IN_IFRAME:window.parent!==window};return t.IS_TABLET=t.IS_IPAD||t.IS_ANDROID||t.IS_KINDLE,t.IS_TOUCH_DEVICE=t.SHOULD_NOT_AUTOFOCUS=t.IS_IOS||t.IS_ANDROID||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i),t.IOS_VERSION=function(){var e=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);return e?[parseInt(e[1],10),parseInt(e[2],10),parseInt(e[3]||0,10)]:null}(),t.MAC_VERSION=function(){var e=navigator.appVersion.match(/OS X (\d+)_(\d+)_?(\d+)?/);return e?[parseInt(e[1],10),parseInt(e[2],10),parseInt(e[3]||0,10)]:null}(),t.CHROME_VERSION=function(){var e=navigator.appVersion.match(/Chrom(e|ium)\/([0-9]+)\.([0-9]+)\.?([0-9]+)?/);return e?[parseInt(e[2],10),parseInt(e[3],10),parseInt(e[4]||0,10)]:null}(),t.SUPPORTS_INPUTMODE=function(){var e="inputMode"in document.createElement("textarea");return!(!e||t.IS_IOS&&t.IOS_VERSION&&t.IOS_VERSION[0]<15)}(),t.SUPPORTS_TRANSLATE3D=!1,I(document).ready(function(){var e=document.createElement("p"),r,i,n={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};document.body.insertBefore(e,null);for(var o in n)if(e.style[o]!==void 0){if(e.style[o]="translate3d(1px,1px,1px)",i=window.getComputedStyle(e),!i)return;r=i.getPropertyValue(n[o])}document.body.removeChild(e),t.SUPPORTS_TRANSLATE3D=r!==void 0&&r.length>0&&r!=="none"}),t.translateRule=function(e,r){return t.SUPPORTS_TRANSLATE3D?"translate3d("+e+(e?"px":"")+","+r+(r?"px":"")+",0)":"translate("+e+(e?"px":"")+","+r+(r?"px":"")+")"},t.SUPPORTS_CANVAS=function(){var e=document.createElement("canvas"),r=!!(e.getContext&&e.getContext("2d"));return r}(),t}}(),kL=EL,{SHOULD_NOT_AUTOFOCUS:Ul,IS_TOUCH_DEVICE:GL,IS_SAFARI:VL,IS_APPLE:Zr,IS_IOS:kh,IS_ANDROID:Qu,IS_IPAD:La,IS_IN_IFRAME:Id,IOS_VERSION:Ff,MAC_VERSION:MY,CHROME_VERSION:TY,IS_IE:IL,IS_EDGE:AY,IS_CHROME:LY,IS_FIREFOX:PY,IS_MOBILE:al,IS_WINDOWS:ML,IS_TOUCH:TL,SUPPORTS_INPUTMODE:cv,translateRule:AL}=EL;var LL=function(){{var t=function(){for(var e={8:this.BACKSPACE="Backspace",9:this.TAB="Tab",13:this.ENTER="Enter",16:this.SHIFT="Shift",17:this.CONTROL="Control",18:this.ALT="Alt",20:this.CAPSLOCK="CapsLock",27:this.ESCAPE="Esc",32:this.SPACEBAR="Space",33:this.PAGEUP="PageUp",34:this.PAGEDOWN="PageDown",35:this.END="End",36:this.HOME="Home",37:this.LEFT="Left",38:this.UP="Up",39:this.RIGHT="Right",40:this.DOWN="Down",46:this.DELETE="Del"},r={Backspace:this.BACKSPACE,Tab:this.TAB,Enter:this.ENTER,Shift:this.SHIFT,Control:this.CONTROL,Alt:this.ALT,CapsLock:this.CAPSLOCK,Escape:this.ESCAPE," ":this.SPACEBAR,PageUp:this.PAGEUP,PageDown:this.PAGEDOWN,End:this.END,Home:this.HOME,ArrowLeft:this.LEFT,ArrowUp:this.UP,ArrowRight:this.RIGHT,ArrowDown:this.DOWN,Delete:this.DELETE},i={UIKeyInputUpArrow:this.UP,UIKeyInputDownArrow:this.DOWN,UIKeyInputLeftArrow:this.LEFT,UIKeyInputRightArrow:this.RIGHT,UIKeyInputEscape:this.ESCAPE,UIKeyInputPageUp:this.PAGEUP,UIKeyInputPageDown:this.PAGEDOWN},n=["0123456789abcdefghijklmnopqrstuvwxyz","\xBA\xA1\u2122\xA3\xA2\u221E\xA7\xB6\u2022\xAA\xE5\u222B\xE7\u2202 \u0192\xA9\u02D9 \u2206\u02DA\xAC\xB5 \xF8\u03C0\u0153\xAE\xDF\u2020 \u221A\u2211\u2248\xA5\u03A9","\u201A\u2044\u20AC\u2039\u203A\uFB01\uFB02\u2021\xB0\xB7\xC5\u0131\xC7\xCE\xB4\xCF\u02DD\xD3\u02C6\xD4\uF8FF\xD2\xC2\u02DC\xD8\u220F\u0152\u2030\xCD\u02C7\xA8\u25CA\u201E\u02DB\xC1\xB8"].map(function(p){return p.split("")}),o=n[0],s=n[1],a=n[2],l={},c={},d=0;d<o.length;d++){var u=o[d];s[d]!==" "&&(l[s[d]]=u.toUpperCase()),a[d]!==" "&&(c[a[d]]=u.toUpperCase())}this.isUndo=function(p){return!p.altKey&&!p.shiftKey&&(p.ctrlKey||p.metaKey)&&(p.key=="z"||p.which==90)},this.isRedo=function(p){return!p.altKey&&(p.ctrlKey||p.metaKey)&&(p.key==="y"||p.which==89||p.shiftKey&&(p.key==="Z"||p.key==="z"||p.which===90))},this.isSelectAll=function(p){return!p.altKey&&(p.ctrlKey||p.metaKey)&&(p.key==="a"||p.key==="A"||p.which==65)},this.isBacktick=function(p){return!p.altKey&&!p.ctrlKey&&!p.metaKey&&!p.shiftKey&&(p.key==="`"||p.which==192)},this.isHelp=function(p){return!p.altKey&&(p.ctrlKey||p.metaKey)&&(p.key==="/"||p.which==191)},this.lookup=function(p){return r[p.key]||e[p.which]||i[p.key]},this.lookupChar=function(p){if(!p.key)return String.fromCharCode(p.which);if(kL.IS_APPLE&&p.altKey){var g=p.shiftKey?c:l;if(g[p.key])return g[p.key]}if(p.key.length===1)return p.key.toUpperCase();if(p.key==="Enter")return String.fromCharCode(13);if(p.key==="Tab")return String.fromCharCode(9)}};return new t}}(),Fc=LL,{isUndo:Lp,isRedo:Pp,isSelectAll:NU,isBacktick:BU,isHelp:mV,BACKSPACE:Pa,TAB:Oa,ENTER:ll,SHIFT:Rf,CONTROL:KU,ALT:UU,CAPSLOCK:qU,ESCAPE:jn,SPACEBAR:Nf,PAGEUP:Zu,PAGEDOWN:eg,END:Gh,HOME:Vh,LEFT:Rc,UP:Jn,RIGHT:Nc,DOWN:Yn,DELETE:Op,lookup:Te,lookupChar:ei}=LL;var HU=function(){{let ae=function(H,ge){H.trim().split(/\s+/).forEach(function(Se){var Ke=pe?{passive:!1}:void 0;document.addEventListener(Se,function(Ae){n("document.on:"+Ae.type),ge(I.event.fix(Ae))},Ke)})},ye=function(H){var ge=!!I(H).closest(".dcg-do-not-blur").length,Se=!!I(H).closest(".dcg-do-blur").length;return!!(ge&&!Se&&P(H))};var t=document.location.href.indexOf("dcgDebugTouchTracking=dcgYES")!==-1,e,r;window._touchtracking_id_counter==null&&(window._touchtracking_id_counter=0),window._touchtracking_id_counter+=1;var i="touchtracking_id_"+window._touchtracking_id_counter,n=function(H){r&&(r[0].value="("+Date.now()+") "+H+`
`+r[0].value)},o=function(H){I(H).addClass("dcg-tap-container"),I(H).addClass(i),t&&(e&&e.remove(),e=I('<div style="position:absolute;bottom:10px;right:10px;"><textarea rows="30" cols="40"></textarea><div id="dcg-touchtracking-debug-copy" class="dcg-btn-blue">COPY LOGS</div></div>'),r=e.find("textarea"),I(H).append(e),I("#dcg-touchtracking-debug-copy")[0].addEventListener("mousedown",function(){r[0].select(),document.execCommand("copy")},!0),n("monitor touches"))},s=function(H){I(H).addClass("dcg-no-touchtracking")};YG.evtInScope=function(H){return P(H.target)},YG.isGhostEvent=function(H){return window.PointerEvent||p!==l&&p!==u&&!U()||H.target===k||H.target&&I.contains(H.target,k)||k&&I.contains(k,H.target)?!1:(n("found ghost event"),!0)};var a=0,l=1,c=2,d=3,u=4,p=a,g={},b={},x=[],w=0,E=null,k=null,S=null,T=[],V=function(H){for(var ge=[];H;)ge.push(H),H=H.parentNode;return ge},O=function(H){for(var ge=[],Se=0;Se<H.length;Se++){var Ke=H[Se];if(ge.push(Ke),I(Ke).is(".dcg-tap-container, .dcg-no-touchtracking"))return I(Ke).is(".dcg-tap-container."+i)?ge:[]}return[]},y=function(H,ge){k=null,p=H,n("beginMode:"+p),p===l?x=V(ge.originalEvent.touches[0].target):x=V(ge.target),I(O(x)).addClass("dcg-depressed").each(function(){var Se=I(this);K(Se)&&Se.addClass("dcg-focus-by-tap")}),I(x).each(function(){var Se=I(this);Se.data({originalScrollTop:Se.scrollTop(),originalScrollLeft:Se.scrollLeft()})}),b={}},L=function(H){return H.is('input, textarea, select, [role="textbox"]')||H.hasClass("dcg-mathquill-input-span")||H.is("[contenteditable=true]")},P=function(H){return!!I(H).closest(".dcg-tap-container, .dcg-no-touchtracking").is(".dcg-tap-container."+i)},K=function(H){return p!==d&&!L(H)&&P(H)},$=function(H,ge){k=null;var Se=!1;n("endMode:"+p),I(".dcg-depressed").removeClass("dcg-depressed");var Ke=I(document.activeElement);if(!ye(H.target)&&K(Ke))try{Ke.blur()}catch(vi){}if(I(".dcg-focus-by-tap").removeClass("dcg-focus-by-tap"),I(x).each(function(){var vi=I(this),ht=vi.data("originalScrollTop")-vi.scrollTop(),Ee=vi.data("originalScrollLeft")-vi.scrollLeft();(ht||Ee)&&(b.scroll=!0)}),b["dcg-tapstart"]===1&&b["dcg-tapend"]===1&&!b["dcg-tapcancel"]&&!b.scroll){n("potential dcg-tap");var Ae=ge.changedTouches[0].clientX,Ze=ge.changedTouches[0].clientY;if(H&&!H.device&&Ae===0&&Ze===0){n("event appears to be simulated"),Se=!0,p=d;var qe=H.target.getBoundingClientRect();Ae=(qe.left+qe.right)/2,Ze=(qe.top+qe.bottom)/2}n("potential dcg-tap coords:"+Ae+":"+Ze);for(var At=!1,Fe=!1,Lt=0;Lt<x.length&&!At;Lt++){var _r=I(x[Lt]),Ge;if(typeof _r[0].getBoundingClientRect=="function"&&(Ge=_r[0].getBoundingClientRect()),_r.attr("tapboundary")==="true"&&(At=!0),!(Ge&&(Ae<Ge.left||Ze<Ge.top||Ae>Ge.right||Ze>Ge.bottom))){k=_r[0],Fe=!0,q("dcg-tap",H,{target:k,touches:ge.touches,changedTouches:ge.changedTouches});break}}}n("result of dcg-tap:  did_dispatch="+Fe+"  did_escape="+At),p===l||p===u?E=setTimeout(function(){E=null,w=new Date().getTime()},1e3):Se&&(E=setTimeout(function(){E=null,w=new Date().getTime()},100)),x=[],p=a},U=function(){return E||new Date().getTime()-w<500},J=function(H){return H.identifier!==void 0?H.identifier:H.pointerId},R=function(H){for(var ge=[],Se=0;Se<H.length;Se++){var Ke=H[Se];ge.push({identifier:J(Ke),x:Ke.pageX,y:Ke.pageY,screenX:Ke.screenX,screenY:Ke.screenY,pageX:Ke.pageX,pageY:Ke.pageY,clientX:Ke.clientX,clientY:Ke.clientY})}return ge},q=function(H,ge,Se){var Ke=J(ge),Ae=R(Se.touches),Ze=R(Se.changedTouches);if(n("dispatchEvent:"+H),H==="dcg-tapstart")g[Ke]={type:H,pageX:Ze[0].pageX,pageY:Ze[0].pageY};else if(H==="dcg-tapmove"){var qe=Ze[0],At=g[Ke];if(At&&qe.pageX===At.pageX&&qe.pageY===At.pageY||(p===l||p===u)&&At&&At.type==="dcg-tapstart"&&Math.abs(At.pageX-qe.pageX)+Math.abs(At.pageY-qe.pageY)<2)return;g[Ke]={type:H,pageX:Ze[0].pageX,pageY:Ze[0].pageY}}b[H.toLowerCase()]===void 0?b[H.toLowerCase()]=1:b[H.toLowerCase()]++;var Fe=I.event.fix(ge.originalEvent);Fe.type=H,Fe.device=p===l||p===u?"touch":p===d?"keyboard":"mouse",Fe.touches=Ae,Fe.changedTouches=Ze,Fe.target=Se.target?Se.target:ge.target;var Lt=Fe.device!=="keyboard"&&b["dcg-longhold"]>0;Fe.wasLongheld=function(){return Lt},Fe.preventTap=function(){b["dcg-tapcancel"]=1},clearTimeout(S),Fe.type==="dcg-tapstart"&&Fe.device!=="keyboard"&&Fe.touches.length===1&&(S=setTimeout(function(){q("dcg-longhold",ge,Se)},500)),Fe.target&&Fe.target.nodeName&&Fe.target.nodeName.toLowerCase()==="a"&&Fe.type==="dcg-tap"&&Fe.device==="keyboard"&&Fe.target.click&&Fe.target.click(),n("trigger event:"+Fe.type),I(Fe.target).trigger(Fe)},_=function(H){var ge=x,Se=!!x.length,Ke=I(".dcg-tap-container."+i+" .dcg-hovered"),Ae=I.makeArray(Ke.filter(function(){return P(this)})),Ze=[],qe=[],At=[];O(V(H)).forEach(function(Lt){(!Se||ge.indexOf(Lt)!==-1)&&(Ae.indexOf(Lt)===-1&&At.push(Lt),Ze.push(Lt))});for(var Fe=0;Fe<Ae.length;Fe++)H=Ae[Fe],Ze.indexOf(H)===-1&&qe.push(H);I(qe).removeClass("dcg-hovered").trigger("tipsyhide"),I(At).addClass("dcg-hovered").trigger("tipsyshow")},A=function(H){for(var ge=0;ge<T.length;ge++)if(T[ge].pointerId===H)return!0;return!1},z=function(H){for(var ge=0;ge<T.length;ge++)if(T[ge].pointerId===H)return T.splice(ge,1)[0]},Q=function(H){p===a&&y(u,H),_(null),T.push(H.originalEvent),q("dcg-tapstart",H,{touches:T,changedTouches:[H.originalEvent]})},fe=function(H){z(H.originalEvent.pointerId);var ge={touches:T,changedTouches:[H.originalEvent]};q("dcg-tapcancel",H,ge),T.length===0&&$(H,ge)},ie=function(H){z(H.originalEvent.pointerId);var ge={touches:T,changedTouches:[H.originalEvent]};q("dcg-tapend",H,ge),T.length===0&&$(H,ge)},Le=function(H){return H.originalEvent.pointerType==="touch"||H.originalEvent.pointerType===2};ae("pointerdown MSPointerDown",function(H){if(!(p===c||p===l||!Le(H))){if(A(H.originalEvent.pointerId)){n("exit. pointer id already exists: "+H.originalEvent.pointerId);return}Q(H)}}),ae("pointermove MSPointerMove",function(H){p===c||p===l||!Le(H)||(A(H.originalEvent.pointerId)||(n("pointer id already exists: "+H.originalEvent.pointerId),Q(H)),z(H.originalEvent.pointerId),T.push(H.originalEvent),q("dcg-tapmove",H,{touches:T,changedTouches:[H.originalEvent]}))}),I(document).on("pointercancel MSPointerCancel",function(H){if(n("document.on:"+H.type),!(p!==u||!Le(H))&&A(H.originalEvent.pointerId)){fe(H);for(var ge;ge=T.pop();){var H=I.Event(ge,{originalEvent:ge});fe(H)}}}),I(document).on("pointerup MSPointerUp",function(H){if(n("document.on:"+H.type),!(p!==u||!Le(H))&&A(H.originalEvent.pointerId)){ie(H);for(var ge;ge=T.pop();){var H=I.Event(ge,{originalEvent:ge});ie(H)}}});var pe=function(){var H=!1;try{var ge=Object.defineProperty({},"passive",{get:function(){H=!0}});window.addEventListener("test",function(){},ge),window.removeEventListener("test",function(){},ge)}catch(Se){}return H}();return ae("touchstart",function(H){p===c||p===u||(p===a&&y(l,H),_(null),q("dcg-tapstart",H,{touches:H.originalEvent.touches,changedTouches:H.originalEvent.changedTouches}))}),ae("touchmove",function(H){p===l&&q("dcg-tapmove",H,{touches:H.originalEvent.touches,changedTouches:H.originalEvent.changedTouches})}),ae("touchcancel",function(H){if(p===l){var ge={touches:H.originalEvent.touches,changedTouches:H.originalEvent.changedTouches};q("dcg-tapcancel",H,ge),H.originalEvent.touches.length===0&&$(H,ge)}}),ae("touchend",function(H){if(p===l){var ge={touches:H.originalEvent.touches,changedTouches:H.originalEvent.changedTouches};q("dcg-tapend",H,ge),H.originalEvent.touches.length===0&&$(H,ge)}}),I(document).on("mousedown",function(H){if(n("document.on:"+H.type),!(H.button===1||H.button===2)){if(p===l||p===u||U()){!I(H.target).is("input, textarea, select")&&P(H.target)&&H.preventDefault(),n("abort mousedown: "+p+":"+U());return}y(c,H),q("dcg-tapstart",H,{touches:[H],changedTouches:[H]})}}),I(document).ready(function(){I(document).on("mousedown",function(H){if(n("document.on:"+H.type),!!ye(H.target)){H.preventDefault();try{var ge=window.getSelection();if(ge.rangeCount===1){var Se=ge.getRangeAt(0);Se.startContainer===Se.endContainer&&I(Se.startContainer).closest(".dcg-text-selectable").length&&ge.removeAllRanges()}}catch(Ke){}}})}),I(document).on("mouseleave",function(H){if(n("document.on:"+H.type),p===a){if(U()){n("abort mouseleave: "+p+":"+U());return}_(null)}}),I(document).on("mousemove",function(H){if(n("document.on:"+H.type),!(H.button===1||H.button===2)&&!(p===l||p===u)){if(U()){n("abort mousemove: "+p+":"+U());return}_(H.target),q("dcg-tapmove",H,{touches:[H],changedTouches:[H]})}}),I(document).on("mouseup",function(H){if(n("document.on:"+H.type),!(H.button===1||H.button===2)&&p===c){var ge={touches:[],changedTouches:[H]};q("dcg-tapend",H,ge),$(H,ge)}}),I(document).on("keydown",function(H){if(n("document.on:"+H.type),!(Fc.lookup(H)!==Fc.ENTER&&Fc.lookup(H)!==Fc.SPACEBAR||!P(H.target))&&p!==d){if(I(H.target).is('a:not([ontap]), button, input, textarea, select, [role="textbox"], [contenteditable="true"]'))return;H.preventDefault(),y(d,H),q("dcg-tapstart",H,{touches:[H],changedTouches:[H]})}}),I(document).on("keyup",function(H){if(n("document.on:"+H.type),!(Fc.lookup(H)!==Fc.ENTER&&Fc.lookup(H)!==Fc.SPACEBAR||!P(H.target))&&p===d){var ge={touches:[],changedTouches:[H]};q("dcg-tapend",H,ge),$(H,ge)}}),{monitor:o,ignore:s,isTapActive:function(){return p!==a},elIsFocusable:L}}}();var{ignore:UY,isTapActive:PL,elIsFocusable:Ih,monitor:Mh}=HU;Oe();var zU=0,$U="guid_"+Math.round(Math.random()*1e6)+"_"+new Date().getTime()+"_",fV=class{constructor(){this.__observers={},this.__eventObservers={},this.__oldProperties={},this.__propertyComparators={},this.guid=$U+ ++zU}unobserveAll(){this.__observers={},this.__eventObservers={}}getProperty(e){return this[e]}getOldProperty(e){return this.__oldProperties[e]}setProperty(e,r){var i=this[e];this[e]=r;var n=this.__propertyComparators[e];if(n){if(n(i,r))return}else if(__dcg_shared_module_exports__['F'](i,r))return;this.__oldProperties[e]=i,this.notifyPropertyChange(e)}setProperties(e){for(var r in e)e.hasOwnProperty(r)&&this.setProperty(r,e[r])}setPropertyComparator(e,r){this.__propertyComparators[e]=r}notifyPropertyChange(e){this.__callObservers(this.__observers,e,this)}observe(e,r){this.__addObservers(this.__observers,e,r)}unobserve(e){this.__removeObservers(this.__observers,e)}observeAndSync(e,r){this.observe(e,r);for(var i=e.split(" "),n=0;n<i.length;n++){var o=i[n].split("."),s=o[0];this.hasOwnProperty(s)&&r(s,this)}}triggerEvent(e,r){this.__callObservers(this.__eventObservers,e,r)}observeEvent(e,r){this.__addObservers(this.__eventObservers,e,r)}unobserveEvent(e){this.__removeObservers(this.__eventObservers,e)}__callObservers(e,r,i){var n=e[r];if(n)for(var o=0;o<n.length;o++)n[o].callback(r,i)}__removeObservers(e,r){for(var i=r.split(" "),n=0;n<i.length;n++){var o=i[n].split("."),s=o[0],a=o[1];if(s&&a){var l=e[s],c=[];if(!l)continue;for(var d=0;d<l.length;d++){var u=l[d];u.namespace!==a&&c.push(u)}e[s]=c}else if(s)delete e[s];else if(a)for(s in e)e.hasOwnProperty(s)&&this.__removeObservers(e,s+"."+a)}}__addObservers(e,r,i){for(var n=r.split(" "),o=0;o<n.length;o++){var s=n[o].split("."),a=s[0];if(!a)throw"Must supply a property to observe";var l=s[1],c={namespace:l,callback:i},d=e[a];d?d.push(c):e[a]=[c]}}},Lr=fV;Oe();function ti(){if(document.activeElement){var t=I(document.activeElement);Ih(t)&&I(document.activeElement).trigger("blur")}}var Md=function(e,r,i,n){this.type=e,this.bubbles=r,this.cancelable=i,this.target=n};Md.prototype={stopPropagation:function(){},preventDefault:function(){this.defaultPrevented=!0}};var WU={100:"Continue",101:"Switching Protocols",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",300:"Multiple Choice",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported"};function jU(t){var e;if(typeof DOMParser!="undefined"){var r=new DOMParser;e=r.parseFromString(t,"text/xml")}else e=new ActiveXObject("Microsoft.XMLDOM"),e.async="false",e.loadXML(t);return e}var JU={"Accept-Charset":!0,"Accept-Encoding":!0,Connection:!0,"Content-Length":!0,Cookie:!0,Cookie2:!0,"Content-Transfer-Encoding":!0,Date:!0,Expect:!0,Host:!0,"Keep-Alive":!0,Referer:!0,TE:!0,Trailer:!0,"Transfer-Encoding":!0,Upgrade:!0,"User-Agent":!0,Via:!0};function YU(t,e){e.addEventListener(t,function(r){var i=e["on"+t];i&&typeof i=="function"&&i.call(r.target,r)})}function dv(){this._eventListeners={};for(var t=["loadstart","progress","load","error","abort","loadend"],e=t.length-1;e>=0;e--)YU(t[e],this)}dv.prototype={addEventListener:function(e,r){this._eventListeners[e]=this._eventListeners[e]||[],this._eventListeners[e].push(r)},removeEventListener:function(e,r){for(var i=this._eventListeners[e]||[],n=0,o=i.length;n<o;++n)if(i[n]==r)return i.splice(n,1)},dispatchEvent:function(e){for(var r=e.type,i=this._eventListeners[r]||[],n=0;n<i.length;n++)typeof i[n]=="function"?i[n].call(this,e):i[n].handleEvent(e);return!!e.defaultPrevented},_progress:function(e,r,i){var n=new Md("progress");n.target=this,n.lengthComputable=e,n.loaded=r,n.total=i,this.dispatchEvent(n)}};function gi(){dv.call(this),this.readyState=gi.UNSENT,this.requestHeaders={},this.requestBody=null,this.status=0,this.statusText="",this.upload=new dv}gi.prototype=new dv;gi.UNSENT=0;gi.OPENED=1;gi.HEADERS_RECEIVED=2;gi.LOADING=3;gi.DONE=4;var OL={UNSENT:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4,async:!0,withCredentials:!1,open:function(e,r,i,n,o){this.method=e,this.url=r,this.async=typeof i=="boolean"?i:!0,this.username=n,this.password=o,this.responseText=null,this.responseXML=null,this.requestHeaders={},this.sendFlag=!1,this._readyStateChange(gi.OPENED)},setRequestHeader:function(e,r){if(_L(this),JU[e]||/^(Sec-|Proxy-)/.test(e))throw new Error('Refused to set unsafe header "'+e+'"');this.requestHeaders[e]?this.requestHeaders[e]+=","+r:this.requestHeaders[e]=r},send:function(e){if(_L(this),!/^(get|head)$/i.test(this.method)){var r=!1;Object.keys(this.requestHeaders).forEach(function(i){i.toLowerCase()==="content-type"&&(r=!0)}),!r&&!(e||"").toString().match("FormData")&&(this.requestHeaders["Content-Type"]="text/plain;charset=UTF-8"),this.requestBody=e}this.errorFlag=!1,this.sendFlag=this.async,this._readyStateChange(gi.OPENED),typeof this.onSend=="function"&&this.onSend(this),this.dispatchEvent(new Md("loadstart",!1,!1,this)),gi.onSend&&gi.onSend(this)},abort:function(){this.aborted=!0,this.responseText=null,this.errorFlag=!0,this.requestHeaders={},this.readyState>gi.UNSENT&&this.sendFlag&&(this._readyStateChange(gi.DONE),this.sendFlag=!1),this.readyState=gi.UNSENT,this.dispatchEvent(new Md("abort",!1,!1,this)),typeof this.onerror=="function"&&this.onerror()},error:function(){this.responseText=null,this.errorFlag=!0,this.requestHeaders={},this.readyState>gi.UNSENT&&this.sendFlag&&(this.sendFlag=!1),this.readyState=gi.DONE,this.dispatchEvent(new Md("error",!1,!1,this)),typeof this.onerror=="function"&&this.onerror()},getResponseHeader:function(e){if(this.readyState<gi.HEADERS_RECEIVED||/^Set-Cookie2?$/i.test(e))return null;e=e.toLowerCase();for(var r in this.responseHeaders)if(r.toLowerCase()==e)return this.responseHeaders[r];return null},getAllResponseHeaders:function(){if(this.readyState<gi.HEADERS_RECEIVED)return"";var e="";for(var r in this.responseHeaders)this.responseHeaders.hasOwnProperty(r)&&!/^Set-Cookie2?$/i.test(r)&&(e+=r+": "+this.responseHeaders[r]+`\r
`);return e},overrideMimeType:function(e){typeof e=="string"&&(this.forceMimeType=e.toLowerCase())},_readyStateChange:function(e){this.readyState=e,typeof this.onreadystatechange=="function"&&this.onreadystatechange(new Md("readystatechange")),this.dispatchEvent(new Md("readystatechange")),this.readyState==gi.DONE&&(this.dispatchEvent(new Md("load",!1,!1,this)),this.dispatchEvent(new Md("loadend",!1,!1,this)))},_setResponseHeaders:function(e){this.responseHeaders={};for(var r in e)e.hasOwnProperty(r)&&(this.responseHeaders[r]=e[r]);this.forceMimeType&&(this.responseHeaders["Content-Type"]=this.forceMimeType),this.async?this._readyStateChange(gi.HEADERS_RECEIVED):this.readyState=gi.HEADERS_RECEIVED},_setResponseBody:function(e){XU(this),QU(this),ZU(e);var r=this.chunkSize||10,i=0;this.responseText="";do this.async&&this._readyStateChange(gi.LOADING),this.responseText+=e.substring(i,i+r),i+=r;while(i<e.length);var n=this.getResponseHeader("Content-Type");if(this.responseText&&(!n||/(text\/xml)|(application\/xml)|(\+xml)/.test(n)))try{this.responseXML=jU(this.responseText)}catch(o){}this.async?this._readyStateChange(gi.DONE):this.readyState=gi.DONE},respond:function(e,r,i){this._setResponseHeaders(r||{}),this.status=typeof e=="number"?e:200,this.statusText=WU[this.status],this._setResponseBody(i||"")}};for(yV in OL)gi.prototype[yV]=OL[yV];var yV;function _L(t){if(t.readyState!==gi.OPENED)throw new Error("INVALID_STATE_ERR");if(t.sendFlag)throw new Error("INVALID_STATE_ERR")}function XU(t){if(t.readyState==gi.DONE)throw new Error("Request done")}function QU(t){if(t.async&&t.readyState!=gi.HEADERS_RECEIVED)throw new Error("No headers received")}function ZU(t){if(typeof t!="string"){var e=new Error("Attempted to respond to fake XMLHttpRequest with "+t+", which is not a string.");throw e.name="InvalidBodyException",e}}Oe();var Bc={cb20221031:1};function FL(t){return function(e){if(e&&e.responseJSON&&(e=e.responseJSON),e.success===!0)t.resolve();else{let r=(e&&e.errors||[]).map(function(i){return i.message});t.reject(r[0]||"Internal Server Error")}}}var Bf="";function Kf(){return Bf}function RL(t){Bf=t}function NL(t){let e=I.Deferred();return t?aa("/account/google_auth?code="+t).always(FL(e)):setTimeout(function(){e.reject("no auth code")},1),e.promise()}function BL(t){let e=I.Deferred(),r=t&&t.jwt,i=t&&t.name||"";return!t||!r?setTimeout(function(){e.reject("no auth code")},1):aa("/account/apple_auth?name="+encodeURIComponent(i)+"&jwt="+encodeURIComponent(r)).always(FL(e)),e.promise()}function bV(t){if(t&&t.routeDeprecated){t.js&&new Function(t.js)();let e=I.Deferred();return e.reject(t),e.promise()}else return t}function Bn(t,e){return I.ajax({type:"POST",url:Bf+t,headers:{Accept:"application/json, text/javascript, */*; q=0.01"},data:e,xhrFields:{withCredentials:!0}}).then(bV)}function KL(t,e){return I.ajax({type:"POST",contentType:"application/json",url:Bf+t,headers:{Accept:"application/json, text/javascript, */*; q=0.01"},data:JSON.stringify(e||null),xhrFields:{withCredentials:!0}}).then(bV)}function aa(t,e){return e===void 0&&(e={}),e=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['b']({},e),Bc),I.ajax({dataType:"json",url:Bf+t,xhrFields:{withCredentials:!0},data:e}).then(bV)}var cl=null,qf=null,vV=!1,wV={},UL=0;function e8(){window.XMLHttpRequest=gi,gi.onSend=function(t){var e=UL+"";UL+=1,wV[e]=t,cl.methods.proxyXHR(JSON.stringify({id:e,url:t.url,method:t.method,headers:t.requestHeaders,body:t.requestBody}))}}function t8(t){var e=I(t.target).closest("a[href]")[0];if(e&&e.protocol==="file:"){var r=e.getAttribute("href");r[0]!=="/"&&(r="/"+r),e.setAttribute("href",Kf()+r)}}kh?(Uf=[],hv=[],qL=function(t){var e=hv.length?hv.pop():Uf.length;return Uf[e]=t,e},HL=function(t){var e=Uf[t];return Uf[t]=null,hv.push(t),e},cl={loaded:!1,methods:{},queuedMethodCalls:[]},I(function(){var t=[];window.ObjC_callback=function(r){cl.loaded=!0,r.split(" ").forEach(function(i){cl.methods[i]=function(n,o){var s=o?qL(o):-1;t.push("desmos:"+i+"/"+s+"/"+encodeURIComponent(n)),t.length===1&&e.attr("src",t[0])}}),this.ObjC_callback=function(i,n){try{i!==-1&&HL(i)(n)}finally{t.shift(),t.length>0&&e.attr("src",t[0])}},cl.methods.proxyXHR&&e8(),cl.queuedMethodCalls.forEach(function(i){la[i.methodName].apply(la,i.args)})};var e=I('<iframe id="objc-bridge" style="position:absolute; left: -1000px; z-index: -1" src="desmos:loaded"/>').appendTo(document.body)})):Qu?qf=window.Android:vV=!0;var Uf,hv,qL,HL,r8=["hideLoadingScreen","gaEvent","openGoogleLogin","openAppleLogin","logout","saveCookies","deleteCookies","startSingleAppMode","endSingleAppMode","setWWWSubdomain","sendSerializedAnalyticsEvent","sendStoredLogsToDesmos"],xV=class extends Lr{constructor(){super();this.heartbeatTimeout=void 0,this.observeEvent("started resumed",r=>{this.gaEvent(r+":"+this.versionNumber),this.incrementHeartbeat(0)}),document.location.search.indexOf("simulateVersionNumber")!==-1&&(this.versionNumber="?.?.?");for(let r of r8)this[r]=function(){vV||(qf?qf[r]?qf[r].apply(qf,arguments):__dcg_shared_module_exports__['M'].log("call to missing Android method",r,arguments):cl&&(cl.loaded?cl.methods[r]?cl.methods[r].apply(cl,arguments):__dcg_shared_module_exports__['M'].log("call to missing ObjC method",r,arguments):cl.queuedMethodCalls.push({methodName:r,args:arguments})))}}heartbeat(r){clearTimeout(this.heartbeatTimeout),this.gaEvent("heartbeat-"+10*r),this.incrementHeartbeat(r)}incrementHeartbeat(r){clearTimeout(this.heartbeatTimeout),this.heartbeatTimeout=setTimeout(()=>{this.heartbeat(r+1)},600*1e3)}_started(r,i){this.appId=r,this.versionNumber=i,this.triggerEvent("started",void 0)}_resumed(){this.triggerEvent("resumed",void 0)}handleAndroidBackButtonAndReturnIfShouldMoveToBackground(){var r=window.Calc&&window.Calc.controller;return r&&r.isKeypadOpen()?(ti(),"false"):(r=window.MainController,r&&r.handleAndroidBackButton()?"false":"true")}isInApp(){return window.platform&&window.platform!=="www"}onGoogleAuthResult(r){this.triggerEvent("onGoogleAuthResult",r)}onAppleAuthResult(r){this.triggerEvent("onAppleAuthResult",r)}onObjCXHRProxyResult(r){var i=r.id,n=wV[i];delete wV[i],r.status===0?n.error():n.respond(r.status,r.headers,r.body)}sendAnalyticsEvent(r,i){this.sendSerializedAnalyticsEvent(JSON.stringify({type:r,payload:i}))}},la=new xV;vV||(window.AppBridge=la,document.addEventListener("click",t8,!0));window.__dcgAppBridgeDefined=!0;var zL=`[{"hash":"2rnqgoa6a4","parent_hash":"89ndqgh5id","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/2rnqgoa6a4.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/2rnqgoa6a4","title":"Lines: Slope Intercept Form","access":"all","created":"Tue, 18 Aug 2015 19:24:05 GMT","i18nKey":"graphing-calculator-label-example-graph-lines-slope-intercept-form","example":true},{"hash":"onfy0dzx2o","parent_hash":"kha6fgxhaf","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/onfy0dzx2o.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/onfy0dzx2o","title":"Lines: Point Slope Form","access":"all","created":"Tue, 18 Aug 2015 20:21:16 GMT","i18nKey":"graphing-calculator-label-example-graph-lines-point-slope-form","example":true},{"hash":"md6buy4efz","parent_hash":"fi71u8ej0q","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/md6buy4efz.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/md6buy4efz","title":"Lines: Two Point Form","access":"all","created":"Tue, 18 Aug 2015 20:21:39 GMT","i18nKey":"graphing-calculator-label-example-graph-lines-two-point-form","example":true},{"hash":"zukjgk9iry","parent_hash":"jv9fmw2qz8","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/zukjgk9iry.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/zukjgk9iry","title":"Parabolas: Standard Form","access":"all","created":"Tue, 18 Aug 2015 20:22:02 GMT","i18nKey":"graphing-calculator-label-example-graph-parabolas-standard-form","example":true},{"hash":"8keeh1pt5l","parent_hash":"klodq5d0ph","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/8keeh1pt5l.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/8keeh1pt5l","title":"Parabolas: Vertex Form","access":"all","created":"Tue, 18 Aug 2015 20:22:22 GMT","i18nKey":"graphing-calculator-label-example-graph-parabolas-vertex-form","example":true},{"hash":"dxkknajdqb","parent_hash":"t6auzqijzl","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/dxkknajdqb.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/dxkknajdqb","title":"Parabolas: Standard Form + Tangent","access":"all","created":"Tue, 18 Aug 2015 20:24:05 GMT","i18nKey":"graphing-calculator-label-example-graph-parabolas-standard-form-plus-tangent","example":true},{"hash":"kihjluohq9","parent_hash":"vpnnmvncdb","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/kihjluohq9.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/kihjluohq9","title":"Trigonometry: Period and Amplitude","access":"all","created":"Tue, 18 Aug 2015 20:24:32 GMT","i18nKey":"graphing-calculator-label-example-graph-trig-period-and-amplitude","example":true},{"hash":"l3u8133jwj","parent_hash":"51d9lso1ia","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/l3u8133jwj.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/l3u8133jwj","title":"Trigonometry: Phase","access":"all","created":"Tue, 18 Aug 2015 20:24:53 GMT","i18nKey":"graphing-calculator-label-example-graph-trig-phase","example":true},{"hash":"7eeumgl7it","parent_hash":"7rnv0erick","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/7eeumgl7it.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/7eeumgl7it","title":"Trigonometry: Wave Interference","access":"link","created":"Tue, 03 Dec 2019 18:14:54 GMT","i18nKey":"graphing-calculator-label-example-graph-trig-wave-interference","example":true},{"hash":"qmzx2skkzy","parent_hash":"s9myfmvujr","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/qmzx2skkzy.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/qmzx2skkzy","title":"Trigonometry: Unit Circle","access":"all","created":"Tue, 18 Aug 2015 20:26:18 GMT","i18nKey":"graphing-calculator-label-example-graph-trig-unit-circle","example":true},{"hash":"ivud1auwvw","parent_hash":"8dsmqe5ycc","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/ivud1auwvw.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/ivud1auwvw","title":"Conic Sections: Circle","access":"all","created":"Tue, 18 Aug 2015 20:27:04 GMT","i18nKey":"graphing-calculator-label-example-graph-conic-sections-circle","example":true},{"hash":"djcrjdfiif","parent_hash":"0jwlvn9hcs","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/djcrjdfiif.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/djcrjdfiif","title":"Conic Sections: Parabola and Focus","access":"all","created":"Tue, 18 Aug 2015 20:27:50 GMT","i18nKey":"graphing-calculator-label-example-graph-conic-sections-parabola-and-focus","example":true},{"hash":"afja7ee9mh","parent_hash":"duajwxdopa","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/afja7ee9mh.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/afja7ee9mh","title":"Conic Sections: Ellipse with Foci","access":"all","created":"Tue, 18 Aug 2015 20:28:08 GMT","i18nKey":"graphing-calculator-label-example-graph-conic-sections-ellipse-with-foci","example":true},{"hash":"vgfqbejegx","parent_hash":"k6xcbueze5","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/vgfqbejegx.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/vgfqbejegx","title":"Conic Sections: Hyperbola","access":"all","created":"Tue, 18 Aug 2015 20:28:27 GMT","i18nKey":"graphing-calculator-label-example-graph-conic-sections-hyperbola","example":true},{"hash":"0ovfwwmfrb","parent_hash":"scuci1750d","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/0ovfwwmfrb.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/0ovfwwmfrb","title":"Polar: Rose","access":"all","created":"Tue, 18 Aug 2015 20:28:48 GMT","i18nKey":"graphing-calculator-label-example-graph-polar-rose","example":true},{"hash":"qlbdlxyrza","parent_hash":"nicremwert","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/qlbdlxyrza.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/qlbdlxyrza","title":"Polar: Logarithmic Spiral","access":"all","created":"Tue, 18 Aug 2015 20:29:08 GMT","i18nKey":"graphing-calculator-label-example-graph-polar-logarithmic-spiral","example":true},{"hash":"rayzacuktw","parent_hash":"21pbohd07u","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/rayzacuktw.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/rayzacuktw","title":"Polar: Limacon","access":"all","created":"Tue, 18 Aug 2015 20:29:25 GMT","i18nKey":"graphing-calculator-label-example-graph-polar-limacon","example":true},{"hash":"gxnu7fbgks","parent_hash":"kk3axf8oon","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/gxnu7fbgks.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/gxnu7fbgks","title":"Polar: Conic Sections","access":"link","created":"Tue, 18 Aug 2015 20:29:42 GMT","i18nKey":"graphing-calculator-label-example-graph-polar-conic-sections","example":true},{"hash":"rnyjcjpouf","parent_hash":"ogvj2tzgjj","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/rnyjcjpouf.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/rnyjcjpouf","title":"Parametric: Introduction","access":"all","created":"Tue, 18 Aug 2015 20:30:31 GMT","i18nKey":"graphing-calculator-label-example-graph-parametric-introduction","example":true},{"hash":"eg5he4xpg9","parent_hash":"pwjl3pe4da","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/eg5he4xpg9.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/eg5he4xpg9","title":"Parametric: Cycloid","access":"link","created":"Tue, 18 Aug 2015 20:30:46 GMT","i18nKey":"graphing-calculator-label-example-graph-parametric-cycloid","example":true},{"hash":"nyterjs0uf","parent_hash":"nqxx2mhknn","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/nyterjs0uf.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/nyterjs0uf","title":"Transformations: Translating a Function","access":"link","created":"Fri, 29 Sep 2017 00:47:36 GMT","i18nKey":"graphing-calculator-label-example-graph-transformations-translating-a-function","example":true},{"hash":"vdkjrpznnu","parent_hash":"doxva7ciht","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/vdkjrpznnu.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/vdkjrpznnu","title":"Transformations: Scaling a Function","access":"link","created":"Tue, 18 Aug 2015 21:23:20 GMT","i18nKey":"graphing-calculator-label-example-graph-transformations-scaling-a-function","example":true},{"hash":"fcjhdt1xdw","parent_hash":"tif5liedlj","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/fcjhdt1xdw.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/fcjhdt1xdw","title":"Transformations: Inverse of a Function","access":"link","created":"Tue, 18 Aug 2015 21:23:36 GMT","i18nKey":"graphing-calculator-label-example-graph-transformations-inverse-of-a-function","example":true},{"hash":"jwquvmikhr","parent_hash":"2l0r87hkmq","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/jwquvmikhr.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/jwquvmikhr","title":"Statistics: Linear Regression","access":"link","created":"Tue, 18 Aug 2015 21:24:01 GMT","i18nKey":"graphing-calculator-label-example-graph-stats-linear-regression","example":true},{"hash":"qrdbrcfnsl","parent_hash":"paknt6oneh","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/qrdbrcfnsl.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/qrdbrcfnsl","title":"Statistics: Anscombe's Quartet","access":"link","created":"Mon, 13 Jul 2020 20:40:16 GMT","i18nKey":"graphing-calculator-label-example-graph-stats-anscombes-quartet","example":true},{"hash":"sanlujpfmc","parent_hash":"tyszvsmelo","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/sanlujpfmc.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/sanlujpfmc","title":"Statistics: 4th Order Polynomial","access":"all","created":"Tue, 18 Aug 2015 21:25:02 GMT","i18nKey":"graphing-calculator-label-example-graph-stats-fourth-order-polynomial","example":true},{"hash":"iwfjdrhdyr","parent_hash":"4n11jtzki0","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/iwfjdrhdyr.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/iwfjdrhdyr","title":"Lists: Family of sin Curves","access":"link","created":"Tue, 18 Aug 2015 21:25:30 GMT","i18nKey":"graphing-calculator-label-example-graph-lists-family-of-sin-curves","example":true},{"hash":"ib4qkln029","parent_hash":"1flkupc1yt","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/ib4qkln029.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/ib4qkln029","title":"Lists: Curve Stitching","access":"link","created":"Thu, 05 May 2016 06:33:59 GMT","i18nKey":"graphing-calculator-label-example-graph-lists-curve-stitching","example":true},{"hash":"zdv2kras4n","parent_hash":"fqhp5hq3ka","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/zdv2kras4n.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/zdv2kras4n","title":"Lists: Plotting a List of Points","access":"link","created":"Tue, 18 Aug 2015 21:27:01 GMT","i18nKey":"graphing-calculator-label-example-graph-lists-plotting-a-list-of-points","example":true},{"hash":"qtzamwcdrk","parent_hash":"aqgbwm3qfd","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/qtzamwcdrk.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/qtzamwcdrk","title":"Calculus: Derivatives","access":"link","created":"Tue, 18 Aug 2015 21:27:17 GMT","i18nKey":"graphing-calculator-label-example-graph-calculus-derivatives","example":true},{"hash":"mekfho0w38","parent_hash":"irip8pnpdf","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/mekfho0w38.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/mekfho0w38","title":"Calculus: Secant Line","access":"link","created":"Tue, 18 Aug 2015 21:27:32 GMT","i18nKey":"graphing-calculator-label-example-graph-calculus-secant-line","example":true},{"hash":"fs3lx8gptb","parent_hash":"dlzhsldcgo","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/fs3lx8gptb.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/fs3lx8gptb","title":"Calculus: Tangent Line","access":"link","created":"Tue, 18 Aug 2015 21:27:46 GMT","i18nKey":"graphing-calculator-label-example-graph-calculus-tangent-line","example":true},{"hash":"noanuckuli","parent_hash":"gkjridbqfj","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/noanuckuli.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/noanuckuli","title":"Calculus: Taylor Expansion of sin(x)","access":"link","created":"Tue, 18 Aug 2015 21:28:02 GMT","i18nKey":"graphing-calculator-label-example-graph-calculus-taylor-expansion-of-sin-x","example":true},{"hash":"qigfpckugc","parent_hash":null,"thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/qigfpckugc.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/qigfpckugc","title":"Calculus: Integrals","access":"link","created":"Tue, 19 Apr 2016 14:03:33 GMT","i18nKey":"graphing-calculator-label-example-graph-calculus-integrals","example":true},{"hash":"u2qz73ufju","parent_hash":"o3pwn3vkgh","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/u2qz73ufju.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/u2qz73ufju","title":"Calculus: Integral with adjustable bounds","access":"link","created":"Tue, 19 Apr 2016 14:12:40 GMT","i18nKey":"graphing-calculator-label-example-graph-calculus-integral-with-adjustable-bounds","example":true},{"hash":"gaa5aqyb5s","parent_hash":null,"thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/gaa5aqyb5s.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/gaa5aqyb5s","title":"Calculus: Fundamental Theorem of Calculus","access":"link","created":"Tue, 19 Apr 2016 14:15:45 GMT","i18nKey":"graphing-calculator-label-example-graph-calculus-fundamental-theorem-of-calculus","example":true},{"hash":"8hxtdephtf","parent_hash":"xova2bfhj5","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/8hxtdephtf.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/8hxtdephtf","title":"hungry pac-man","access":"link","created":"Mon, 20 Apr 2015 14:47:01 GMT","i18nKey":"graphing-calculator-label-example-graph-pac-man","example":true,"easterEgg":"betchacant"},{"hash":"qbaliml2om","parent_hash":"8mmk4hrmqg","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/qbaliml2om.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/qbaliml2om","title":"PRIDE flag","access":"link","created":"Wed, 02 Jun 2021 01:46:57 GMT","i18nKey":"graphing-calculator-label-example-graph-pride-flag","example":true,"easterEgg":"pride"},{"hash":"ieellz6qbr","parent_hash":"velayq9vsr","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/ieellz6qbr.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/ieellz6qbr","title":"PRIDE flag","access":"link","created":"Wed, 02 Jun 2021 01:51:23 GMT","i18nKey":"graphing-calculator-label-example-graph-pride-flag","example":true,"easterEgg":"pride"},{"hash":"dhzndt8brx","parent_hash":"brei8peg52","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/dhzndt8brx.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/dhzndt8brx","title":"3D World","access":"link","created":"Fri, 03 Jun 2016 01:50:06 GMT","i18nKey":"graphing-calculator-label-example-graph-3d-world","example":true,"easterEgg":"betchacant"},{"hash":"zzhx3zzlns","parent_hash":"ccmfndxptv","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/zzhx3zzlns.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/zzhx3zzlns","title":"Checkerboard Inversion","access":"link","created":"Thu, 02 Jun 2016 22:06:08 GMT","i18nKey":"graphing-calculator-label-example-graph-checkerboard-inversion","example":true,"easterEgg":"betchacant"},{"hash":"c1u72uowae","parent_hash":null,"thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/c1u72uowae.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/c1u72uowae","title":"desmos graph of awesomeness","access":"link","created":"Sun, 18 Aug 2013 06:25:20 GMT","i18nKey":"graphing-calculator-label-example-graph-regular-sine-wave","example":true,"easterEgg":"betchacant"},{"hash":"2mwse3jtff","parent_hash":"msmdonti4c","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/2mwse3jtff.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/2mwse3jtff","title":"Fastest path to point","access":"link","created":"Thu, 02 Jun 2016 22:02:44 GMT","i18nKey":"graphing-calculator-label-example-graph-fastest-path-to-a-point","example":true,"easterEgg":"betchacant"},{"hash":"8ytrg3nyln","parent_hash":"d7qrsg2hxg","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/8ytrg3nyln.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/8ytrg3nyln","title":"Fireworks!","access":"link","created":"Fri, 03 Jun 2016 01:50:52 GMT","i18nKey":"graphing-calculator-label-example-graph-fireworks","example":true,"easterEgg":"betchacant"},{"hash":"9ed6k6wexp","parent_hash":"9ed6k6wexp","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/9qixqdozzh.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/9ed6k6wexp","title":"Sierpinski Valentine","access":"link","created":"Sat, 14 Feb 2015 18:42:18 GMT","i18nKey":"graphing-calculator-label-example-graph-fractal-valentine","example":true,"easterEgg":"betchacant"},{"hash":"am6ab20tmw","parent_hash":"hvycjwscfq","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/am6ab20tmw.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/am6ab20tmw","title":"Outstretched Arm","access":"link","created":"Fri, 03 Jun 2016 01:45:50 GMT","i18nKey":"graphing-calculator-label-example-graph-outstretched-arm","example":true,"easterEgg":"betchacant"}]
`;ql();var vo={},_a=oo();if(typeof Desmos!="undefined"&&Desmos.config)for(pv in Desmos.config)Desmos.config.hasOwnProperty(pv)&&(_a[pv]=Desmos.config[pv]);var pv,Hl=function(t){return _a.hasOwnProperty(t)},Nr=function(t){vo[t]=Hl(t)},Yi=function(t){vo[t]=!Hl("no"+t)};Nr("testing");Nr("maintenance");Nr("disableScrollFix");Nr("nativeOnscreenKeypad");Nr("hidden");Nr("disableMouseInteractions");Nr("advancedStyling");Nr("outofdom");Nr("beta3d");_a.lang&&(vo.language=_a.lang);_a.fontSize&&(vo.fontSize=_a.fontSize);_a.backgroundColor&&(vo.backgroundColor="#"+_a.backgroundColor);_a.textColor&&(vo.textColor="#"+_a.textColor);vo.no_navigation_warning=Hl("noconcat")||Hl("testing");vo.previewMessage="You're previewing some new accessibility features.";vo.previewFeedbackUrl="mailto:feedback@desmos.com";var n8=location&&location.hostname==="preview.desmos.com";vo.previewMode=Hl("previewMode")||n8;Nr("lockViewport");Nr("authorFeatures");Nr("degreeMode");Nr("clearIntoDegreeMode");Nr("plaidMode");Nr("editOnWeb");Nr("crossOriginSaveTest");Nr("showResetButtonOnGraphpaper");Nr("transparentBackground");Nr("forceLogModeRegressions");Yi("links");Yi("trace");Yi("zoomFit");Nr("expressionsCollapsed");Nr("invertedColors");Nr("projectorMode");Yi("images");Yi("folders");Yi("settingsMenu");Yi("expressionsTopbar");Yi("zoomButtons");Yi("keypad");Yi("graphpaper");Yi("expressions");Yi("branding");Yi("pointsOfInterest");Yi("plotSingleVariableImplicitEquations");Yi("plotImplicits");Yi("plotInequalities");Yi("notes");Yi("sliders");Nr("pauseWhenOffscreen");Nr("worksheetSVG");Yi("brailleControls");Nr("audioTraceKeypad");Yi("audio");Nr("sciKeypad");Nr("4fnKeypad");Nr("ans");Hl("braille")&&(vo.braille=!0);Yi("qwertyKeyboard");Nr("restrictedFunctions");Nr("forceEnableGeometryFunctions");Yi("functionDefinition");Nr("singleExpression");Nr("restrictedEditing");Nr("replaceCommaWith10Exp");Nr("replaceRoundWithReciprocal");Hl("typingAsteriskWritesTimesSymbol")&&(vo.typingAsteriskWritesTimesSymbol=!0);Yi("substitutions");Yi("logScales");Yi("labels");Yi("distributions");vo["4fnKeypad"]?Nr("decimalToFraction"):Yi("decimalToFraction");Nr("3d");Hl("exponentButtonForSquareRoot")?vo.additionalFunctions=["exponent"]:_a.additionalFunctions&&typeof _a.additionalFunctions=="string"&&(vo.additionalFunctions=_a.additionalFunctions.split(","));Hl("actions")?vo.actions=!0:Hl("noactions")?vo.actions=!1:Hl("clickableObjects")&&(vo.actions=!0);function mi(t){return vo[t]}function uv(){return __dcg_shared_module_exports__['N'](vo)}Oe();function gv(t){var e=[];for(let i of t)if(!(!i||typeof i!="string")){var r=i.split("-")[0];e.push(i),e.push(r);for(let n in Ra){let o=Ra[n];n.split("-")[0]===r&&o.useAsRoot&&e.push(n)}}return e}function $L(){let t={},e=Object.keys(Ra);for(let r in e){let i=e[r];t[i]={code:i,display_name:Ra[i].displayName}}return t}var Ra={en:{displayName:"English (US)",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},es:{displayName:"Espa\xF1ol (LATAM)",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_ES-ES.pdf",useAsRoot:!0},et:{displayName:"Eesti",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},ru:{displayName:"\u0420\u0443\u0441\u0441\u043A\u0438\u0439",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_RU.pdf",useAsRoot:!1},da:{displayName:"Dansk",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},de:{displayName:"Deutsch",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_DE.pdf",useAsRoot:!1},"pt-BR":{displayName:"Portugu\xEAs (Brasil)",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!0},"pt-PT":{displayName:"Portugu\xEAs (Portugal)",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},ca:{displayName:"Catal\xE0",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},fr:{displayName:"Fran\xE7ais",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_FR.pdf",useAsRoot:!1},it:{displayName:"Italiano",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_IT.pdf",useAsRoot:!1},is:{displayName:"\xCDslenska",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},nl:{displayName:"Nederlands",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},no:{displayName:"Norsk",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},"sv-SE":{displayName:"Svenska",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!0},hu:{displayName:"Magyar",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},cs:{displayName:"\u010Ce\u0161tina",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},pl:{displayName:"Polski",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_PL.pdf",useAsRoot:!1},id:{displayName:"Bahasa Indonesia",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},vi:{displayName:"Ti\u1EBFng Vi\u1EC7t",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_VI.pdf",useAsRoot:!1},el:{displayName:"\u0395\u03BB\u03BB\u03B7\u03BD\u03B9\u03BA\u03AC",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_EL.pdf",useAsRoot:!1},uk:{displayName:"\u0423\u043A\u0440\u0430\u0457\u043D\u0441\u044C\u043A\u0430",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},ka:{displayName:"\u10E5\u10D0\u10E0\u10D7\u10E3\u10DA\u10D8",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},th:{displayName:"\u0E20\u0E32\u0E29\u0E32\u0E44\u0E17\u0E22",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},tr:{displayName:"T\xFCrk\xE7e",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_TR.pdf",useAsRoot:!1},"zh-CN":{displayName:"\u7B80\u4F53\u4E2D\u6587",useAsRoot:!0,userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_ZH-CN.pdf"},"zh-TW":{displayName:"\u7E41\u9AD4\u4E2D\u6587",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_ZH-TW.pdf",useAsRoot:!1},ko:{displayName:"\uD55C\uAD6D\uC5B4",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf",useAsRoot:!1},ja:{displayName:"\u65E5\u672C\u8A9E",userGuideURL:"https://desmos.s3.amazonaws.com/Desmos_User_Guide_JA.pdf",useAsRoot:!1}};var WL=`### Strings shared among tools and homepage


### 5533 English words, 997 English strings

account-shell-button-cancel = Cancel
account-shell-button-clear = Clear
account-shell-button-confirm-delete =
    { $count ->
        [one] Yes, delete graph
       *[other] Yes, delete graphs
    }
account-shell-button-contact-us = Contact Us
account-shell-button-create-own-activity = Create your own submission activity.
account-shell-button-delete = Delete
account-shell-button-download-braille = Download Braille Equations
account-shell-button-download-png = Download PNG
account-shell-button-download-svg = Download SVG
account-shell-button-duplicate = Duplicate
account-shell-button-duplicate-mac = Duplicate or Rename (cmd+shift+s)
account-shell-button-duplicate-pc = Duplicate or Rename (ctrl+shift+s)
account-shell-button-embed = Embed
account-shell-button-export-image = Export Image
account-shell-button-hide-browser-warning = Hide this warning.
account-shell-button-line-medium = Medium
account-shell-button-line-thick = Thick
account-shell-button-line-thin = Thin
account-shell-button-log-in = Log In
account-shell-button-mygraphs-attempt-recovery = Attempt recovery.
account-shell-button-mygraphs-cancel = Cancel
account-shell-button-mygraphs-close-graph-list = Close Graph List
account-shell-button-mygraphs-close-graph-preview = Close Graph Preview
account-shell-button-mygraphs-delete-graph = Delete Graph
account-shell-button-mygraphs-delete-title = Delete { $graphTitle }
account-shell-button-mygraphs-offline-try-again = offline. click to try again.
account-shell-button-mygraphs-save = Save
account-shell-button-mygraphs-try-again = Try again
account-shell-button-open-construction = Open Construction
account-shell-button-open-graph = Open Graph
account-shell-button-print = Print
account-shell-button-rename = Rename
account-shell-button-retry-now = Retry now
account-shell-button-save = Save
account-shell-button-sign-up = Sign Up
account-shell-button-submit = Submit
account-shell-button-submit-graph = Submit This Graph
account-shell-button-svg-options = SVG Options
account-shell-button-update-graph = Update your submission
account-shell-error-art-contest-logged-out = You must be logged in to enter the art contest.
account-shell-error-change-email-logged-out = You must be logged in to change your email.
account-shell-error-change-name-logged-out = You must be logged in to change your name.
account-shell-error-changing-name = There was an error changing your user name.
account-shell-error-consent-error = There was an error accepting your consent.
account-shell-error-consent-logged-out = You must be logged in to consent to data collection.
account-shell-error-create-account-unexpected = Sorry, there was an error creating your account.
account-shell-error-delete-graph-logged-out = You must be logged in to delete graphs.
account-shell-error-delete-graph-logged-out-2 = You must be logged in to delete a graph.
account-shell-error-delete-unexpected = Sorry, there was an unexpected error deleting this graph. Error { $code }.
account-shell-error-deletion-error = There was an error. Try again later?
account-shell-error-deletion-error-2 = Error while deleting your account.
account-shell-error-deletion-link-not-found = We can't find that deletion token. Perhaps it's been used already?
account-shell-error-email-already-registered = Sorry, someone has already registered with this email address.
account-shell-error-email-invalid = Please enter a valid email address.
account-shell-error-email-password-mismatch = Sorry, your email and password did not match.
account-shell-error-email-too-short = Please enter an email address that is at most { $num } characters.
account-shell-error-feedback-empty = Please enter your feedback
account-shell-error-feedback-unexpected = Sorry, there was an unexpected problem sending feedback. Error { $code }.
account-shell-error-graph-too-large = This graph is too large to save. The maximum allowable size is 5 MB.
account-shell-error-invalid-deletion-link = This is not a valid deletion link.
account-shell-error-invalid-recovery-link = This is not a valid recovery link.
account-shell-error-logged-in-register = You are already logged in. You must first log out to register as a different user.
account-shell-error-logging-in = Error logging in.
account-shell-error-logging-out = Error logging out.
account-shell-error-missing-email = Please enter your email address.
account-shell-error-missing-name = Please enter your name.
account-shell-error-missing-new-password = Please enter your new password.
account-shell-error-missing-password = Please enter your password.
account-shell-error-mygraphs-check-connection = Check your internet connection?
account-shell-error-mygraphs-error-deleting = Error deleting.
account-shell-error-mygraphs-error-loading = Error loading graph
account-shell-error-name-too-long = Please enter a name that is at most { $num } characters.
account-shell-error-new-password-too-long = Please enter a new password that is at most { $num } characters.
account-shell-error-new-password-too-short = Please enter a new password that is at least { $num } characters.
account-shell-error-password-same-as-old = New password cannot match old password.
account-shell-error-password-too-long = Please enter a password that is at most { $num } characters.
account-shell-error-password-too-short = Please enter a password that is at least { $num } characters.
account-shell-error-passwords-do-not-match = The passwords that you entered did not match. Please try again.
account-shell-error-problem-resetting-password = Problem resetting your password. Please try again.
account-shell-error-recover-link-not-found = Sorry, we can't find that recovery link. Perhaps it's been used already?
account-shell-error-recover-password-too-short = Passwords must be at least { $num } characters long
account-shell-error-recover-unrecognized-email = Sorry, we could not find any users registered with this email address.
account-shell-error-request-error = Error while making request.
account-shell-error-save-art-contest = Error saving. Please try again later.
account-shell-error-save-graph = Sorry, there was an unexpected error saving your graph. Error { $code }.
account-shell-error-save-graph-logged-out = You must be logged in to save graphs.
account-shell-error-setting-email = Error setting new email.
account-shell-error-sharing-link = Sorry, there was an error generating a link to your graph. Check your internet connection.
account-shell-error-something-went-wrong = Something went wrong, please report this to desmos.com support. (Error { $error_num })
account-shell-error-submitting = Error submitting. Please try again later.
account-shell-error-unexpected-error = Unexpected error.
account-shell-error-unknown = Sorry! Something went wrong. Please try again later.
account-shell-error-update-account-settings-logged-out = You must be logged in to update your account settings.
account-shell-error-update-graph-logged-out = You must be logged in to update graphs.
account-shell-error-user-info-logged-out = You must be logged in to retrieve user information.
account-shell-error-verifying-email = Sorry, there was a problem verifying your email.
account-shell-error-view-graphs-logged-out = You must be logged in to view saved graphs.
account-shell-heading-3dcalc-page-title = Desmos | 3D Graphing Calculator
account-shell-heading-artist-statement = Your Artist Statement
account-shell-heading-birth-year = Your Birth Year
account-shell-heading-contact-us = Contact Us
account-shell-heading-country = Your Country
account-shell-heading-download-instructions = Download Instructions
account-shell-heading-duplicate-construction = Duplicate This Construction
account-shell-heading-duplicate-graph = Duplicate This Graph
account-shell-heading-email = Your Email
account-shell-heading-email-details = This will never be shared, but please provide an email where we can reach you!
account-shell-heading-embossers = Tactile Graphics Embossers
account-shell-heading-embossing-instructions = Embossing Instructions
account-shell-heading-export-graph = Export Your Graph
account-shell-heading-export-size = Size
account-shell-heading-geometry-page-title = Desmos | Geometry
account-shell-heading-graphingcalc-page-title = Desmos | Graphing Calculator
account-shell-heading-line-thickness = Line Thickness
account-shell-heading-math-art-contest = Global Math Art Contest
account-shell-heading-mygraphs-examples = Examples
account-shell-heading-mygraphs-recovered-work = Recovered Work
account-shell-heading-mygraphs-saved-constructions = Saved Constructions
account-shell-heading-mygraphs-saved-graphs = Saved Graphs
account-shell-heading-name = Your Name
account-shell-heading-name-details = This will be public
account-shell-heading-rename-graph = Rename This Graph
account-shell-heading-resources = Resources
account-shell-heading-save-construction = Save This Construction
account-shell-heading-save-graph = Save This Graph
account-shell-heading-share-graph = Share Your Graph
account-shell-heading-submit-graph = Submit This Graph
account-shell-heading-title-mygraphs-search = Search
account-shell-heading-tours = Tours
account-shell-heading-unsupported-browser = Unsupported Browser
account-shell-label-account-information = Account Information
account-shell-label-advanced-preferences = Advanced
account-shell-label-age-13-14 = Age 13\u201314
account-shell-label-age-15-16 = Age 15\u201316
account-shell-label-age-17-18 = Age 17\u201318
account-shell-label-artiist-statement-description = In 2-3 sentences, describe the inspiration behind your graph.
account-shell-label-artist-statement-placeholder = Tell us about your graph...
account-shell-label-beta = Beta
account-shell-label-betchacant-loading = Challenge accepted...
account-shell-label-birth-year-placeholder = Birth Year
account-shell-label-country-placeholder = Your Country
account-shell-label-created-days-ago = { $number } days ago
account-shell-label-created-hours-ago = { $number } hours ago
account-shell-label-created-last-week = last week
account-shell-label-created-minutes-ago = { $number } minutes ago
account-shell-label-created-on-date = { $month } { $day }, { $year }
account-shell-label-created-one-hour-ago = one hour ago
account-shell-label-created-one-minute-ago = one minute ago
account-shell-label-created-seconds-ago = less than a minute ago
account-shell-label-created-weeks-ago = { $number } weeks ago
account-shell-label-created-yesterday = yesterday
account-shell-label-delete-graph-modal-title = Delete Graph
account-shell-label-email-address = Email Address
account-shell-label-email-placeholder = So we can write back!
account-shell-label-export-size-large-rectangle = Large Rectangle
account-shell-label-export-size-large-square = Large Square
account-shell-label-export-size-medium-rectangle = Medium Rectangle
account-shell-label-export-size-medium-square = Medium Square
account-shell-label-export-size-small-square = Small Square
account-shell-label-feature-flag-actions = Actions
account-shell-label-feedback-email = Email Address
account-shell-label-feedback-message = Questions? Feedback?
account-shell-label-feedback-placeholder = Write to us!
account-shell-label-feedback-sending = Sending...
account-shell-label-full-name = Full Name
account-shell-label-graph-actions = Graph actions
account-shell-label-graph-title = Title
account-shell-label-help = Help
account-shell-label-help-menu = Help Menu
account-shell-label-language = Language
account-shell-label-loading = Loading...
account-shell-label-math-art-contest = Global Math Art Contest
account-shell-label-month-apr = Apr
account-shell-label-month-aug = Aug
account-shell-label-month-dec = Dec
account-shell-label-month-feb = Feb
account-shell-label-month-jan = Jan
account-shell-label-month-jul = Jul
account-shell-label-month-jun = Jun
account-shell-label-month-mar = Mar
account-shell-label-month-may = May
account-shell-label-month-nov = Nov
account-shell-label-month-oct = Oct
account-shell-label-month-sep = Sep
account-shell-label-mygraphs-example = example
account-shell-label-mygraphs-last-saved = last saved: { $date }
account-shell-label-mygraphs-no-unsaved-changes = no unsaved changes
account-shell-label-mygraphs-unsaved-graph = unsaved graph
account-shell-label-no-unsaved-changes = No Unsaved Changes
account-shell-label-open-graph-mac = { $open_graph } (cmd+o)
account-shell-label-open-graph-pc = { $open_graph } (ctrl+o)
account-shell-label-privacy-policy-changed = We\u2019ve made changes to our privacy policy!
account-shell-label-save-changes-mac = Save Changes (cmd+s)
account-shell-label-save-changes-pc = Save Changes (ctrl+s)
account-shell-label-saving-graph = Saving graph...
account-shell-label-share = share
account-shell-label-share-graph = Share Graph
account-shell-label-share-link = Share this link:
account-shell-label-submission-already-received = Your Art Contest Submission
account-shell-label-submission-received = Submission Received!
account-shell-label-submitting = Submitting...
account-shell-label-success = Success!
account-shell-label-you-are-eligible = You're eligible to participate in the 2022 Global Math Art Contest!
account-shell-label-zoom = Zoom: { $value }%
account-shell-link-accessibility-conformance-report = Accessibility Conformance Report
account-shell-link-account-settings = Account Settings
account-shell-link-download-chrome = Click here to download Google Chrome.
account-shell-link-email-support = Email Our Support Team
account-shell-link-getting-started = Getting Started
account-shell-link-help = Help
account-shell-link-help-center = Help Center
account-shell-link-keyboard-shortcuts = Keyboard Shortcuts
account-shell-link-learn-more = Learn More
account-shell-link-mygraphs-log-in = Log In
account-shell-link-mygraphs-sign-up = Sign Up
account-shell-link-privacy = Privacy Policy
account-shell-link-share-thoughts = Share your thoughts!
account-shell-link-sign-out = Sign Out
account-shell-link-terms = Terms of Service
account-shell-link-user-guide = Desmos User Guide
account-shell-link-video-tutorials = Video Tutorials
account-shell-narration-back = Back
account-shell-narration-clear-selected-country = Clear Selected Country
account-shell-narration-graph-preview = Graph Preview
account-shell-narration-image-download = Image Download
account-shell-narration-language-menu = Language Options Menu
account-shell-narration-mygraphs-open-graph = Open graph
account-shell-narration-share-options = Share Options
account-shell-narration-size-options = Size Options
account-shell-text-3d-confirm-leave = Are you sure you want to leave this construction? Your unsaved work will be lost.
account-shell-text-advanced-preferences-instructions = Try these advanced features. Feel free to send any questions or feedback to support@desmos.com.
account-shell-text-alt-text-art-contest = Earth with students from different countries and a red ribbon around it. Illustration.
account-shell-text-alt-text-success = Five people standing around and talking about an exciting piece of art in a museum. Illustration.
account-shell-text-art-contest-about-paragraph = Want to share your awesome graph with the world? Students ages 13+ can enter the Desmos Global Math Art Contest before<1> January 15th </1>for a chance to be featured on our website and win other prizes! <2>Learn more</2>
account-shell-text-art-contest-congratulations = Congratulations, and keep graphing!
account-shell-text-art-contest-copyright-agreement = I pledge that (a) this is my original work and (b) this isn't based on copyrighted material.
account-shell-text-art-contest-legal-disclaimer = By submitting this graph, you acknowledge that Desmos Studio, PBC may, at its discretion, post it publicly at the contest website and/or on social media channels.
account-shell-text-art-contest-notice-default = Once you've created a graph, you can submit it here to participate in the Global Math Art Contest!
account-shell-text-art-contest-notice-login = Please create an account or sign in to participate in the Global Math Art Contest!
account-shell-text-art-contest-submission-already-received = <1>Your previous submission to the Global Math Art Contest was successfully received! You can click the link below to update your submission, any time before January 15th.</1>
account-shell-text-art-contest-success-paragraph = If you'd like to revise your submission, feel free to resubmit anytime before<1> January 15th</1>{"."} We'll only look at the most recent submission.
account-shell-text-artcontest-ineligible = <1><2>Based on your age and location, we aren\u2019t able to accept a graph submission from you this year.</2><3>Keep up the awesome graphing! There will be new contests every year.</3></1>
account-shell-text-check-recovery-link = Please check your email for a password recovery link.
account-shell-text-confirm-leave = Are you sure you want to leave this graph? Your unsaved work will be lost.
account-shell-text-construction-cleared = Construction Cleared.
account-shell-text-contest-submit-by-teacher = Are you a teacher looking to submit your students' graphs?
account-shell-text-contest-under-16 = Under 16?
account-shell-text-contest-verify-eligibility = Verify your eligibility
account-shell-text-copy-of-title = [Copy of] { $originalTitle }
account-shell-text-delete-graphs-confirmation =
    Are you sure you want to delete { $count ->
        [one] "{ $title }"
       *[other] the { $count } selected graphs
    }?
account-shell-text-download-instructions = To download, right click on the image of the graph select "Save As." You might also be able to click and drag the image onto your desktop.
account-shell-text-embossing-etc-print = Set paper size to { $size }. Then click "Edit" and select File > Emboss.
account-shell-text-embossing-etc-save = Save this image. Open Firebird, select File > Open > Image File, and open the image.
account-shell-text-embossing-vpmax-print = Right click image and select "print". Set paper size to { $size }.
account-shell-text-embossing-vpmax-save = Right click graph image and save to desktop.
account-shell-text-error = error
account-shell-text-feature-flag-actions-description = Make graphs interactive by defining rules for responding to clicks or to the passage of time.
account-shell-text-feedback-sent = Thanks! We'll be in touch.
account-shell-text-geometry-confirm-leave = Are you sure you want to leave this construction? Your unsaved work will be lost.
account-shell-text-graph-cleared = Graph cleared.
account-shell-text-graph-uses-advanced-features = This graph uses advanced features.
account-shell-text-local-regulations-notice = Local regulations require you to submit your graph through your teacher or guardian. Share this link with them:
account-shell-text-logged-in = Logged in successfully!
account-shell-text-login-window-blocked-apple = Login window blocked. Please allow popups from desmos.com to sign in with Apple
account-shell-text-login-window-blocked-google = Login window blocked. Please allow popups from desmos.com to sign in with Google.
account-shell-text-maintenance-mode = Desmos is in Maintenance Mode.
account-shell-text-mygraphs-attempting-recovery = Attempting recovery...
account-shell-text-mygraphs-count-more = { $count } more...
account-shell-text-mygraphs-current-construction = Current Construction
account-shell-text-mygraphs-current-graph = Current Graph
account-shell-text-mygraphs-deleting = Deleting...
account-shell-text-mygraphs-loading = Loading...
account-shell-text-mygraphs-lost-work = Lost work?
account-shell-text-mygraphs-maintenance-mode = Desmos is temporarily in maintenance mode. You can open example graphs, but won't be able to sign in, open your graphs, or save any changes. We're so sorry for the inconvenience.
account-shell-text-mygraphs-new-blank-graph = New Blank Graph
account-shell-text-mygraphs-new-construction = New Construction
account-shell-text-mygraphs-no-examples-match-search = No examples match your search.
account-shell-text-mygraphs-no-saved-graphs = No saved graphs yet.
account-shell-text-mygraphs-no-search-results = No saved graphs match your search.
account-shell-text-mygraphs-no-unsaved-graphs = Couldn't find any unsaved graphs.
account-shell-text-mygraphs-opened-graph = Opened '{ $graphTitle }'
account-shell-text-mygraphs-opening = Opening...
account-shell-text-mygraphs-or = or
account-shell-text-mygraphs-search-by-title = search by title
account-shell-text-mygraphs-share-thoughts = Share your thoughts!
account-shell-text-mygraphs-slow-big-constructions = This can take a little while for big constructions...
account-shell-text-mygraphs-slow-big-graphs = This can take a little while for big graphs...
account-shell-text-mygraphs-submit-to-contest = <1>Submit this graph to the <2>Global Math Art Contest!</2></1>
account-shell-text-mygraphs-synced = synced!
account-shell-text-mygraphs-to-save-constructions = to save your constructions!
account-shell-text-mygraphs-to-save-graphs = to save your graphs!
account-shell-text-mygraphs-updating-graphs = updating graphs...
account-shell-text-mygraphs-version = Version
account-shell-text-new-construction-created = New construction created.
account-shell-text-new-graph-created = New graph created.
account-shell-text-or = or
account-shell-text-saved = saved
account-shell-text-share-submit-to-contest = <1>Submit this graph to the <2>Global Math Art Contest!</2></1>
account-shell-text-unsupported-browser-android = Desmos works best on your version of Android if you use the Chrome Browser.
account-shell-text-untitled = Untitled
account-shell-text-untitled-graph = Untitled Graph
shared-button-accept = Accept
shared-button-cancel = Cancel
shared-button-change-email-address = Change email address
shared-button-change-email-and-password = Change email and password
shared-button-close-dialog = Close Dialog
shared-button-confirm-name = Confirm Name
shared-button-continue-to-desmos = Continue to Desmos
shared-button-create-account = Create Account
shared-button-delete-account-question = Delete your Desmos account?
shared-button-email-address-narrow = Email
shared-button-email-address-wide = Email Address
shared-button-external-account-narrow = External
shared-button-external-account-wide = External Account
shared-button-go-to-account-settings = Go to Account Settings
shared-button-google-account-narrow = Google
shared-button-google-account-wide = Google Account
shared-button-learn-more-capitalized = Learn More
shared-button-login = Log in
shared-button-login-capitalized = Log In
shared-button-more-options-menu = More Options
shared-button-recover-password = Recover Password
shared-button-save = Save
shared-button-send-delete-account-email = Send Delete Account Email
shared-button-send-email = Send Email
shared-button-sign-in-with-apple = Sign in with Apple
shared-button-sign-in-with-google = Sign in with Google
shared-button-try-again = Didn't work? Try again!
shared-calculator-button-braille-mode-nemeth = Nemeth
shared-calculator-button-braille-mode-ueb = UEB
shared-calculator-button-clear = clear
shared-calculator-button-clear-all = clear all
shared-calculator-button-controlbar-functions = functions
shared-calculator-button-language = Language
shared-calculator-button-mac = Mac Shortcuts
shared-calculator-button-print = Print
shared-calculator-button-reverse-contrast = Reverse Contrast
shared-calculator-button-windows-chrome = Windows / ChromeOS Shortcuts
shared-calculator-error-action-merge-free-variable = Cannot combine an action that depends on free variable '{ $symbol }'.
shared-calculator-error-add-arguments-to-definition-many = Try including '{ $symbols }' and '{ $lastSymbol }' as arguments by defining the function as '{ $newSignature }'.
shared-calculator-error-add-arguments-to-definition-one = Try including '{ $lastSymbol }' as an argument by defining the function as '{ $newSignature }'.
shared-calculator-error-add-type-error = Cannot add { $symbol1 } and { $symbol2 }.
shared-calculator-error-adjacent-numbers = Sorry, I don't know what to do with adjacent numbers '{ $left }' and '{ $right }'. Try using parentheses or a '*' symbol.
shared-calculator-error-and-type-error = Cannot apply { $symbol } to { $symbol1 } and { $symbol2 }.
shared-calculator-error-ans-undefined = The previous expression didn't define any value for ans.
shared-calculator-error-assignments-unsupported = This calculator does not support defining variables.
shared-calculator-error-bad-implicit-call = Use parentheses around the argument of '{ $symbol }'.
shared-calculator-error-bad-integral-bound-dependency = Integration bounds can't depend on integration variable '{ $symbol }'.
shared-calculator-error-bad-list-comprehension-input-dependency = List comprehension input list can't depend on input variable '{ $symbol }'.
shared-calculator-error-bad-log-exponent = Only { $form } is supported. Otherwise, use parens.
shared-calculator-error-bad-product-bound-dependency = Product bounds can't depend on product index '{ $symbol }'.
shared-calculator-error-bad-sample-size = Sample size must be a finite, non-negative number.
shared-calculator-error-bad-sum-bound-dependency = Summation bounds can't depend on summation index '{ $symbol }'.
shared-calculator-error-bad-symbol-context = You can't use '{ $symbol }' in this context.
shared-calculator-error-bad-trig-exponent = Only { $form1 } and { $form2 } are supported. Otherwise, use parens.
shared-calculator-error-bad-tuple-dimensions = Points may only have { $symbol } coordinates.
shared-calculator-error-binary-operator-missing-operand = You need something on both sides of the '{ $symbol }' symbol.
shared-calculator-error-blank-expression = You haven't written anything yet.
shared-calculator-error-boxplot-breadth-invalid = Invalid height. Try using any number.
shared-calculator-error-boxplot-offset-invalid = Invalid offset. Try using any number.
shared-calculator-error-cannot-redefine = You can't redefine '{ $symbol }' because it's already defined.
shared-calculator-error-cannot-redefine-root = You can't define '{ $symbol }' because '{ $symbolRoot }' is already defined.
shared-calculator-error-cannot-subscript = '{ $symbol }' cannot have a subscript.
shared-calculator-error-cdf-max-invalid = Invalid cdf max. Try using any number.
shared-calculator-error-cdf-max-less-than-min = Invalid cdf limits. Min should be less than max.
shared-calculator-error-cdf-min-invalid = Invalid cdf min. Try using any number.
shared-calculator-error-cdf-too-many-arguments = 'cdf' should be called on a distribution with at most two numbers. { $recommendation }
shared-calculator-error-cdf-too-many-arguments-recommendation = For example, try typing: D.cdf(-1,1) where D=normaldist().
shared-calculator-error-cdf-wrong-arity = 'cdf' should be called on a distribution with at least one number. { $recommendation }
shared-calculator-error-cdf-wrong-arity-recommendation = For example, try typing: D.cdf(x) where D=normaldist().
shared-calculator-error-clickable-object-assignment-not-defined = "{ $symbol }" is not defined. Try using a different variable or adding a slider.
shared-calculator-error-clickable-object-assignment-not-identifier = Invalid symbol. Try using a single letter.
shared-calculator-error-clickable-object-invalid-expression = Can't evaluate this. Try a number or simple expression.
shared-calculator-error-colon-missing-condition = The left side of a ':' must be a condition, like 'x>1'.
shared-calculator-error-color-arity = '{ $symbol }' should be called with 3 arguments. { $recommendation }
shared-calculator-error-color-arity-recommendation = For example, try typing: { $recommendation }.
shared-calculator-error-color-not-assigned = To use a color, you must assign it to a variable.
shared-calculator-error-combine-type-error = Cannot combine { $symbol1 } and { $symbol2 }.
shared-calculator-error-comparator-type-error = Cannot compare { $symbol1 } to { $symbol2 }.
shared-calculator-error-complicated-double-inequality = We only support solved double inequalities. Try deleting one side of the inequality.
shared-calculator-error-complicated-polar-implicit = Polar equations must be linear in r.
shared-calculator-error-constant-unsupported = This calculator does not support the constant '{ $symbol }'.
shared-calculator-error-deeply-nested = Definitions are nested too deeply.
shared-calculator-error-dependency-cycle = '{ $symbols }' and '{ $lastSymbol }' can't be defined in terms of each other.
shared-calculator-error-derivative-missing-body = What do you want to take the derivative of?
shared-calculator-error-derivative-type-error = Cannot take the derivative of { $symbol }.
shared-calculator-error-derivative-variable-type-error = Cannot take derivative with respect to '{ $symbol1 }' because it is { $symbol2 }.
shared-calculator-error-differential-with-superscript = Integration variable cannot have a superscript.
shared-calculator-error-distribution-as-function = Cannot call distribution '{ $symbol }' as a function. Try '{ $symbol }.pdf(x)'.
shared-calculator-error-divide-type-error = Cannot divide { $symbol1 } by { $symbol2 }.
shared-calculator-error-domain-max-invalid = Invalid domain max. Try using any number.
shared-calculator-error-domain-max-less-than-min = Invalid domain limits. Min should be less than max.
shared-calculator-error-domain-min-invalid = Invalid domain min. Try using any number.
shared-calculator-error-dot-lhs-type-error = Cannot call '{ $symbol }' on { $type }.
shared-calculator-error-duplicate-update-rules = An action cannot specify multiple update rules for '{ $symbol }'.
shared-calculator-error-empty-paren = Parentheses cannot be empty.
shared-calculator-error-empty-pipe = Absolute value symbol cannot be empty.
shared-calculator-error-empty-radical = Radical cannot be empty.
shared-calculator-error-empty-radical-index = Radical index cannot be empty.
shared-calculator-error-empty-square-bracket = Square brackets cannot be empty.
shared-calculator-error-empty-subscript = Subscripts cannot be empty.
shared-calculator-error-empty-superscript = Superscripts cannot be empty.
shared-calculator-error-equation-required = Try adding an equals sign to turn this into an equation.
shared-calculator-error-equation-required-symbol = Try adding '{ $lhs }' to the beginning of this equation.
shared-calculator-error-equations-unsupported = This calculator does not support this type of equation.
shared-calculator-error-event-handler-type-error = This should be an action. Try '{ $example }'.
shared-calculator-error-exponent-type-error = Cannot raise { $symbol1 } to { $symbol2 }.
shared-calculator-error-feature-unavailable = This feature is not available in the current calculator.
shared-calculator-error-fraction-empty = You need a numerator and denominator for your fraction.
shared-calculator-error-fraction-missing-denominator = You need a denominator for the bottom of your fraction.
shared-calculator-error-fraction-missing-numerator = You need a numerator for the top of your fraction.
shared-calculator-error-function-definition-unsupported = This calculator does not support function definitions.
shared-calculator-error-function-not-defined = Function '{ $dependency }' is not defined.
shared-calculator-error-function-type-error-1 = Function '{ $fn }' cannot be applied to { $arg }.
shared-calculator-error-function-type-error-2 = Function '{ $fn }' cannot be applied to { $arg1 } and { $arg2 }.
shared-calculator-error-function-type-error-many = Function '{ $fn }' cannot be applied to these arguments.
shared-calculator-error-function-unsupported = This calculator does not support the '{ $symbol }' function.
shared-calculator-error-geometry-length-type-error = Function '{ $fn }' cannot be applied to { $arg } in the geometry calculator. Use '{ $alternativeFn }' to find the number of elements in a list.
shared-calculator-error-gpu-function-unsupported = Color functions do not support the '{ $symbol }' function.
shared-calculator-error-gpu-integral-unsupported = Color functions do not support integrals.
shared-calculator-error-gpu-long-product = Color functions do not support products of more than { $maxTermCount } terms.
shared-calculator-error-gpu-long-sum = Color functions do not support sums of more than { $maxTermCount } terms.
shared-calculator-error-gpu-max-list-size = Lists may not have more than { $maxListSize } elements in a color function.
shared-calculator-error-gpu-variable-list-length = List length cannot depend on variable '{ $symbol }' in a color function.
shared-calculator-error-gpu-variable-product = Product bound cannot depend on variable '{ $symbol }' in a color function.
shared-calculator-error-gpu-variable-sum = Sum bound cannot depend on variable '{ $symbol }' in a color function.
shared-calculator-error-heterogeneous-list = All elements of a list must have the same type.
shared-calculator-error-identifier-as-function = '{ $symbol }' is a function. Try using parentheses.
shared-calculator-error-illegal-bin-width = The second argument to '{ $symbol }' must be a positive number.
shared-calculator-error-illegal-dot-call = Function '{ $symbol }' cannot be called with dot notation.
shared-calculator-error-implicits-disabled = Plotting implicit equations and inequalities is disabled.
shared-calculator-error-incorrect-list-comprehension-input = Inputs to a list comprehension must set a variable equal to a list. Try i=[1...10].
shared-calculator-error-incorrect-product-lower-bound = Lower bound of a product must set a variable equal to a number. Try n=1.
shared-calculator-error-incorrect-sum-lower-bound = Lower bound of a sum must set a variable equal to a number. Try n=1.
shared-calculator-error-index-type-error = Cannot index { $symbol1 } with { $symbol2 }.
shared-calculator-error-inequalities-disabled = Plotting inequalities is disabled.
shared-calculator-error-inequalities-unsupported = This calculator does not support inequalities.
shared-calculator-error-inequality-chain-too-long = Cannot chain more than 2 inequalities.
shared-calculator-error-integral-argument-type-error = Cannot take the integral of { $symbol }.
shared-calculator-error-integral-lower-bound-type-error = Lower bound of an integral cannot be { $symbol }.
shared-calculator-error-integral-missing-body = What do you want to take the integral of?
shared-calculator-error-integral-missing-bound = Integrals must have upper and lower bounds.
shared-calculator-error-integral-missing-differential = Integrand must end with an integration variable, like dx.
shared-calculator-error-integral-upper-bound-type-error = Upper bound of an integral cannot be { $symbol }.
shared-calculator-error-invalid-dependent-first-table-column = This column header can't be defined elsewhere in the calculator.
shared-calculator-error-invalid-double-inequality-variables = We only plot double inequalities of x and y.
shared-calculator-error-invalid-first-table-column = First column may not be { $most } or { $last }.
shared-calculator-error-invalid-half-empty-range = Range must have an upper and lower bound.
shared-calculator-error-invalid-implicit-variables = We only support implicit equations of x and y.
shared-calculator-error-invalid-inequality-variables = We only plot inequalities of x and y, or r and \u03B8.
shared-calculator-error-invalid-lhs = Sorry, you can't graph { $symbol } as a function of anything yet.
shared-calculator-error-invalid-operator-name = Operator names may only contain letters.
shared-calculator-error-invalid-regression-parameter = '{ $symbol }' may not be used as a regression parameter. Try using a list.
shared-calculator-error-invalid-subscript = Subscripts may only contain letters and digits. '{ $symbol }' is not allowed.
shared-calculator-error-invalid-table-entry = Table entries must be simple expressions. { $supplement }
shared-calculator-error-invalid-table-header = Table headers must be simple expressions. { $supplement }
shared-calculator-error-list-comprehension-input-type-error = An input to a list comprehension must be a list, but { $identifier } is { $actual }. Try { $identifier }=[1...10].
shared-calculator-error-list-type-error = Cannot store { $symbol1 } in a list.
shared-calculator-error-log-scale-box-plot = Cannot plot a box plot on a log scale.
shared-calculator-error-log-scale-dot-plot = Cannot plot a dot plot on a log scale.
shared-calculator-error-log-scale-histogram = Cannot plot a histogram on a log scale.
shared-calculator-error-log-scale-type-error = Cannot plot { $symbol } on a log scale.
shared-calculator-error-logbase-unsupported = This calculator does not support specifying the base of a logarithm. Try 'log' or 'ln'.
shared-calculator-error-malformed-list = Lists are written like this: [1, 2, 3].
shared-calculator-error-malformed-point = Points are written like this: (1, 2).
shared-calculator-error-matrix-add-dimensions = Cannot add matrices with different dimensions.
shared-calculator-error-matrix-assignment = This calculator does not support this type of variable definition. Try using 'New Matrix'.
shared-calculator-error-matrix-element-type-error = Cannot use { $arg } as an element of a matrix.
shared-calculator-error-matrix-fractional-power = A matrix can only be raised to integer powers.
shared-calculator-error-matrix-invalid-variable = Cannot use '{ $symbol }' as a variable.
shared-calculator-error-matrix-multiply-dimensions = Cannot multiply matrices with incompatible dimensions.
shared-calculator-error-matrix-power-dimensions = Only square matrices can be raised to a power.
shared-calculator-error-matrix-subtract-dimensions = Cannot subtract matrices with different dimensions.
shared-calculator-error-max-list-size = Lists may not have more than { $maxListSize } elements.
shared-calculator-error-method-requires-list = '{ $symbol }' requires a list. For example, try typing: { $recommendation }.
shared-calculator-error-mismatched-braces = Expected '{ $symbol1 }' to match '{ $symbol2 }'.
shared-calculator-error-mismatched-double-inequality = Double inequalities must both go the same way, e.g. { $example }.
shared-calculator-error-multiply-defined = You've defined '{ $dependency }' in more than one place. Try deleting some of the definitions of '{ $dependency }'.
shared-calculator-error-multiply-type-error = Cannot multiply { $symbol1 } by { $symbol2 }.
shared-calculator-error-multiply-type-error-2d = Ambiguous multiplication of { $symbol1 } by { $symbol2 }. Try typing: (1, 2) * (2, 1).
shared-calculator-error-multiply-type-error-3d = Ambiguous multiplication of { $symbol1 } by { $symbol2 }. Try typing: (1, 2, 3) cross (2, 1, 0).
shared-calculator-error-multiply-type-error-cross = Cannot take the cross product of { $symbol1 } and { $symbol2 }.
shared-calculator-error-negative-type-error = Cannot negate { $symbol }.
shared-calculator-error-non-arithmetic-range = Ranges must be arithmetic sequences.
shared-calculator-error-non-list-double-reducer = Both arguments of '{ $symbol }' must be lists. For example, try typing: { $recommendation }.
shared-calculator-error-non-list-parameterized-reducer = The first argument of '{ $symbol }' must be a list. For example, try typing: { $recommendation }.
shared-calculator-error-non-singular-inverse = Singular matrices do not have an inverse.
shared-calculator-error-non-square-determinant = Only square matrices have a determinant.
shared-calculator-error-non-square-inverse = Only square matrices have an inverse.
shared-calculator-error-non-square-trace = Only square matrices have a trace.
shared-calculator-error-optimization-error = We couldn't find any region where this model is defined.
shared-calculator-error-ordered-pair-access-type-error = Cannot access a coordinate of { $symbol }.
shared-calculator-error-parameter-already-defined = You can't use '{ $dependency }' as a parameter of this function because '{ $dependency }' is already defined.
shared-calculator-error-parse-error = Sorry, I don't understand this.
shared-calculator-error-pdf-wrong-arity = 'pdf' should be called on a distribution with a number. { $recommendation }
shared-calculator-error-pdf-wrong-arity-recommendation = For example, try typing: D.pdf(x) where D=normaldist().
shared-calculator-error-percent-missing-of = '%' must be used with 'of'. Try '25% of 12'.
shared-calculator-error-piecewise-branch-length-error = When a piecewise condition depends on a free variable (like "{ $symbol }") and its branches are lists, the lists must have the same length.
shared-calculator-error-piecewise-branch-type-error = Cannot use { $symbol1 } and { $symbol2 } as the branches in a piecewise. Every branch must have the same type.
shared-calculator-error-piecewise-condition-type-error = The condition in a piecewise expression must be { $symbol1 } but was { $symbol2 }.
shared-calculator-error-piecewise-missing-condition = A piecewise expression must have at least one condition.
shared-calculator-error-piecewise-part-missing-condition = Every part of a piecewise expression must have a condition except the last.
shared-calculator-error-point-type-error = Cannot use { $symbol1 } as a coordinate of { $symbol2 }.
shared-calculator-error-points-unsupported = This calculator does not support points.
shared-calculator-error-prime-without-paren = Primed function calls must use parentheses.
shared-calculator-error-primed-function-arity = Prime notation can only be used for functions of a single argument.
shared-calculator-error-product-argument-type-error = Cannot take the product of { $symbol }.
shared-calculator-error-product-infinite-bound-type-error = Product bounds must be finite numbers.
shared-calculator-error-product-lower-bound-type-error = Lower bound of a product cannot be { $symbol }.
shared-calculator-error-product-missing-body = What do you want to take the product of?
shared-calculator-error-product-missing-bound = Products must have upper and lower bounds.
shared-calculator-error-product-upper-bound-type-error = Upper bound of a product cannot be { $symbol }.
shared-calculator-error-random-arity = 'random' should be called with no arguments, or an optional number of samples. For example, try random() or random(10).
shared-calculator-error-random-from-broadcast-distribution = Cannot sample from a list of distributions
shared-calculator-error-regression-type-error = Cannot regress { $symbol1 } against { $symbol2 }.
shared-calculator-error-regressions-unsupported = This calculator does not support regressions.
shared-calculator-error-self-referential-function = The definition of function '{ $symbol }' cannot depend on '{ $symbol }'.
shared-calculator-error-shadowed-index = You can't use '{ $symbol }' as an index because it's already defined.
shared-calculator-error-shadowed-integration-variable = You can't use '{ $symbol }' as an integration variable because it's already defined.
shared-calculator-error-shadowed-list-comprehension-input = You can't use '{ $symbol }' as a list comprehension input because it's already defined.
shared-calculator-error-single-variable-implicit-equations-disabled = Plotting single-variable implicit equations is disabled.
shared-calculator-error-slider-limit-references-export = Slider limits cannot depend on the slider variable '{ $symbol }'.
shared-calculator-error-slider-max-invalid = Invalid slider max. Try using any number.
shared-calculator-error-slider-max-less-than-min = Invalid slider limits. Min should be less than max.
shared-calculator-error-slider-min-invalid = Invalid slider min. Try using any number.
shared-calculator-error-slider-step-invalid = Invalid slider step. Try using any number.
shared-calculator-error-substitution-ambiguous-comma = Ambiguous use of ',' and 'with'. Add parentheses around the 'with' expression.
shared-calculator-error-substitution-body-action = The left hand side of a 'with' substitution cannot be an action.
shared-calculator-error-substitution-body-local-variable-dependency = The left hand side of a 'with' substitution cannot depend on '{ $symbol }' because '{ $symbol }' is locally defined.
shared-calculator-error-substitution-body-regression-parameter-dependency = The left hand side of a 'with' substitution cannot depend on '{ $symbol }' because '{ $symbol }' is a regression parameter.
shared-calculator-error-substitution-duplicate-assignment = A 'with' expression cannot make multiple substitutions for '{ $symbol }'.
shared-calculator-error-substitution-function-lhs = Substituting for '{ $symbol }' is not allowed because it is a function.
shared-calculator-error-substitution-illegal-lhs = Substituting for '{ $symbol }' is not allowed.
shared-calculator-error-substitution-invalid-assignments = 'with' must be followed by one or more variable assignments.
shared-calculator-error-substitution-local-lhs = Substituting for variable '{ $symbol }' is not allowed because it is locally defined.
shared-calculator-error-substitution-nested = Using one 'with' expression inside another 'with' expression is not allowed.
shared-calculator-error-substitution-type-error = Cannot substitute { $actual } for { $expected }.
shared-calculator-error-substitution-undefined-rhs = An expression that depends on the free variable '{ $symbol }' cannot be used on the right hand side of 'with'.
shared-calculator-error-subtract-type-error = Cannot subtract { $symbol2 } from { $symbol1 }.
shared-calculator-error-sum-argument-type-error = Cannot take the sum of { $symbol }.
shared-calculator-error-sum-infinite-bound-type-error = Summation bounds must be finite numbers.
shared-calculator-error-sum-lower-bound-type-error = Lower bound of a sum cannot be { $symbol }.
shared-calculator-error-sum-missing-body = What do you want to take the sum of?
shared-calculator-error-sum-missing-bound = Sums must have upper and lower bounds.
shared-calculator-error-sum-upper-bound-type-error = Upper bound of a sum cannot be { $symbol }.
shared-calculator-error-superscript-with-prime = Superscripts and primes cannot be combined.
shared-calculator-error-table-entry-type-error = Table entry cannot be { $symbol }.
shared-calculator-error-table-equation-supplement = Equations are not allowed.
shared-calculator-error-table-function-definition-supplement = Function definitions are not allowed.
shared-calculator-error-table-generic-supplement = This type of expression is not allowed.
shared-calculator-error-table-header-type-error = Table header cannot be { $symbol }.
shared-calculator-error-table-inequality-supplement = Inequalities are not allowed.
shared-calculator-error-table-list-supplement = Lists are not allowed.
shared-calculator-error-table-regression-supplement = Regressions are not allowed.
shared-calculator-error-tdist-wrong-arity = 'tdist' requires 1 argument. For example, try typing: tdist(1).
shared-calculator-error-ticker-min-step-nonnegative = Min step must evaluate to a non-negative number.
shared-calculator-error-todo-error = [todo] { $msg }
shared-calculator-error-token-with-subscript = Tokens may not have subscripts.
shared-calculator-error-too-many-arguments = '{ $symbol }' accepts at most { $max } arguments.
shared-calculator-error-too-many-variables-many-symbols = Too many variables. Try defining '{ $variables }' or '{ $lastVariable }'.
shared-calculator-error-too-many-variables-no-symbols = Too many variables, I don't know what to do with this.
shared-calculator-error-too-many-variables-one-symbol = Too many variables. Try defining '{ $variable }'.
shared-calculator-error-transformation-definition-expected-types-1 = Try using { $arg }.
shared-calculator-error-transformation-definition-expected-types-2 = Try using { $arg1 } and { $arg2 }.
shared-calculator-error-transformation-definition-type-error-1 = A { $fn } cannot be defined using { $arg }. { $expectedTypeMessage }
shared-calculator-error-transformation-definition-type-error-2 = A { $fn } cannot be defined using { $arg1 } and { $arg2 }. { $expectedTypeMessage }
shared-calculator-error-transformation-definition-type-error-many = A '{ $fn }' cannot be defined with these arguments.
shared-calculator-error-transformation-type-error-1 = Transformation '{ $fn }' cannot be applied to { $arg }.
shared-calculator-error-transformation-type-error-2 = Transformation '{ $fn }' cannot be applied to { $arg1 } and { $arg2 }.
shared-calculator-error-transformation-type-error-many = Transformation '{ $fn }' cannot be applied to these arguments.
shared-calculator-error-ttest-list-too-short = Lists for '{ $symbol }' must have at least 2 elements.
shared-calculator-error-two-numbers-error = Cannot make a polygon from two numbers.
shared-calculator-error-unary-operator-missing-left = You need something before the '{ $symbol }' symbol.
shared-calculator-error-unary-operator-missing-right = You need something after the '{ $symbol }' symbol.
shared-calculator-error-unexpected-for-keyword = 'for' can only be used inside a list. Try [i for i=[1...10]].
shared-calculator-error-unexpected-inequality = Cannot use an inequality here.
shared-calculator-error-unexpected-prime = Sorry, I don't understand this use of prime notation.
shared-calculator-error-unexpected-subscript = Only functions and variables may have subscripts.
shared-calculator-error-unexpected-symbol = Sorry, I don't understand the way that '{ $symbol }' is used here.
shared-calculator-error-unknown = Unknown Error
shared-calculator-error-unplottable-polar-function = We can't plot \u03B8 as a function of r. Try plotting r(\u03B8) instead.
shared-calculator-error-unrecognized-symbol = Sorry, I don't understand the '{ $symbol }' symbol.
shared-calculator-error-update-rule-function-lhs = '{ $symbol }' cannot be updated because it is a function.
shared-calculator-error-update-rule-illegal-lhs = Variable '{ $symbol }' cannot be updated.
shared-calculator-error-update-rule-local-lhs = Variable '{ $symbol }' cannot be updated because it is locally defined.
shared-calculator-error-update-rule-non-identifier-lhs = The left hand side of '{ $arrow }' should be a variable name like '{ $example }'.
shared-calculator-error-update-rule-type-error = Cannot update a variable to { $symbol }.
shared-calculator-error-update-rule-undefined-lhs = Variable '{ $symbol }' must be defined to be updated.
shared-calculator-error-variable-as-function = Variable '{ $dependency }' can't be used as a function.
shared-calculator-error-variable-filter = List filters cannot depend on free variable '{ $symbol }'.
shared-calculator-error-variable-function-free-variable = Function '{ $functionSymbol }' cannot depend on free variable '{ $variableSymbol }'.
shared-calculator-error-variable-length-distribution-list = The length of a list of distributions can't depend on free variable '{ $symbol }'.
shared-calculator-error-variable-length-product-body-depends-on-index = Can't take the product of a list whose length depends on product index '{ $symbol }'.
shared-calculator-error-variable-length-sum-body-depends-on-index = Can't sum a list whose length depends on summation index '{ $symbol }'.
shared-calculator-error-variable-length-top-level-list = Can't plot a list whose length depends on free variable '{ $symbol }'.
shared-calculator-error-variable-list-indices = List indices cannot depend on free variable '{ $symbol }'.
shared-calculator-error-variable-range = Range cannot depend on free variable '{ $symbol }'.
shared-calculator-error-variable-sample-size = Sample size cannot depend on free variable '{ $symbol }'.
shared-calculator-error-variable-seed = Random seed cannot depend on free variable '{ $symbol }'.
shared-calculator-error-variable-unsupported = This calculator does not support the '{ $symbol }' variable.
shared-calculator-error-variables-unsupported = This calculator does not support variables like '{ $variable }'.
shared-calculator-error-write-integral = Type '{ $command }' for { $symbol }.
shared-calculator-error-wrong-arity-many-arg = Function '{ $dependency }' requires { $assignment_arity } arguments. { $supplement }
shared-calculator-error-wrong-arity-single-arg-too-few = Function '{ $dependency }' requires an argument. { $supplement }
shared-calculator-error-wrong-arity-single-arg-too-many = Function '{ $dependency }' requires only 1 argument. { $supplement }
shared-calculator-error-wrong-arity-supplement = For example, try typing: { $recommendation }.
shared-calculator-error-wrong-two-arg-arity = Function '{ $symbol }' requires 2 arguments. For example, try typing: { $recommendation }.
shared-calculator-error-zero-arg-reducer = Function '{ $symbol }' requires at least one argument. For example, try typing: { $symbol }(1, 2).
shared-calculator-heading-function-table-column-header = Function
shared-calculator-heading-keyboard-shortcuts = Keyboard Shortcuts
shared-calculator-heading-keyboard-shortcuts-audio-tracing = Audio Tracing
shared-calculator-heading-keyboard-shortcuts-braille = Braille
shared-calculator-heading-keyboard-shortcuts-common-actions = Common Actions
shared-calculator-heading-keyboard-shortcuts-common-symbols = Common Symbols
shared-calculator-heading-keyboard-shortcuts-desmos-com-only = Desmos.com Only
shared-calculator-heading-keyboard-shortcuts-expression-entry-and-navigation = Expression Entry and Navigation
shared-calculator-heading-keyboard-shortcuts-interactive-points = Interactive Points
shared-calculator-heading-keyboard-shortcuts-slider-trace = Slider Trace
shared-calculator-heading-keyboard-shortcuts-sliders = Sliders
shared-calculator-heading-keyboard-shortcuts-symbols = Symbols
shared-calculator-heading-keyboard-shortcuts-tables = Tables
shared-calculator-heading-mac-table-column-header = Mac Shortcut
shared-calculator-heading-shortcut-table-column-header = Shortcut
shared-calculator-heading-windows-chrome-table-column-header = Windows / ChromeOS Shortcut
shared-calculator-label-accessibility = Accessibility
shared-calculator-label-error-saving = Error saving.
shared-calculator-label-os = Operating System
shared-calculator-label-saved = Saved!
shared-calculator-label-saving = Saving...
shared-calculator-label-settings-display = Display
shared-calculator-label-toast-learn-more = Learn more
shared-calculator-label-toast-undo = Undo
shared-calculator-label-tooltip-convert-to-decimal = Convert to decimal.
shared-calculator-label-tooltip-convert-to-fraction = Convert to fraction.
shared-calculator-label-value-type-action = an action
shared-calculator-label-value-type-angle = an angle
shared-calculator-label-value-type-any = an unknown object
shared-calculator-label-value-type-arc = an arc
shared-calculator-label-value-type-bool = a true/false value
shared-calculator-label-value-type-circle = a circle
shared-calculator-label-value-type-color = a color
shared-calculator-label-value-type-directed-angle = a directed angle
shared-calculator-label-value-type-distribution = a distribution
shared-calculator-label-value-type-empty-list = an empty list
shared-calculator-label-value-type-error = an error object
shared-calculator-label-value-type-line = a line
shared-calculator-label-value-type-list-of-3d-points = a list of 3D points
shared-calculator-label-value-type-list-of-angles = a list of angles
shared-calculator-label-value-type-list-of-any = a list of unknown objects
shared-calculator-label-value-type-list-of-arcs = a list of arcs
shared-calculator-label-value-type-list-of-bool = a list of true/false values
shared-calculator-label-value-type-list-of-circles = a list of circles
shared-calculator-label-value-type-list-of-colors = a list of colors
shared-calculator-label-value-type-list-of-directed-angles = a list of directed angles
shared-calculator-label-value-type-list-of-distributions = a list of distributions
shared-calculator-label-value-type-list-of-lines = a list of lines
shared-calculator-label-value-type-list-of-numbers = a list of numbers
shared-calculator-label-value-type-list-of-points = a list of points
shared-calculator-label-value-type-list-of-polygons = a list of polygons
shared-calculator-label-value-type-list-of-rays = a list of rays
shared-calculator-label-value-type-list-of-segment3d = a list of 3d segments
shared-calculator-label-value-type-list-of-segments = a list of segments
shared-calculator-label-value-type-list-of-sphere3d = a list of 3d sphere
shared-calculator-label-value-type-list-of-transformations = a list of transformations
shared-calculator-label-value-type-list-of-triangle3d = a list of 3d triangles
shared-calculator-label-value-type-matrix = a matrix
shared-calculator-label-value-type-number = a number
shared-calculator-label-value-type-point = a point
shared-calculator-label-value-type-point3d = a 3d point
shared-calculator-label-value-type-polygon = a polygon
shared-calculator-label-value-type-ray = a ray
shared-calculator-label-value-type-seed = a string
shared-calculator-label-value-type-segment = a segment
shared-calculator-label-value-type-segment3d = a 3d segment
shared-calculator-label-value-type-sphere3d = a 3d sphere
shared-calculator-label-value-type-transformation = a transformation
shared-calculator-label-value-type-triangle3d = a 3d triangle
shared-calculator-narration-braille-mode = Braille Mode
shared-calculator-narration-control-toggle-switch-to-default = { $toggled } selected. Press Enter to switch to { $default }.
shared-calculator-narration-control-toggle-switch-to-toggled = { $default } selected. Press Enter to switch to { $toggled }.
shared-calculator-narration-display-as-decimal = Displaying as fraction. Press Enter to display as Decimal
shared-calculator-narration-display-as-fraction = Displaying as decimal. Press Enter to display as Fraction
shared-calculator-narration-evaluation = equals { $answer }
shared-calculator-narration-expression = Expression
shared-calculator-narration-expression-index = Expression { $index }
shared-calculator-narration-hotkey-braille-mode-nemeth = Braille mode Nemeth
shared-calculator-narration-hotkey-braille-mode-off = Braille mode off
shared-calculator-narration-hotkey-braille-mode-ueb = Braille mode UEB
shared-calculator-narration-input-error = input has an error
shared-calculator-narration-item-selected = { $item } selected
shared-calculator-narration-item-unselected = { $item } unselected
shared-calculator-narration-keypad = keypad
shared-calculator-narration-keypad-controlbar = Control Bar
shared-calculator-narration-keypad-key-10-n = Times ten to the power of
shared-calculator-narration-keypad-key-abs = Absolute Value
shared-calculator-narration-keypad-key-action-to = Set Value To
shared-calculator-narration-keypad-key-action-with = Substitute With
shared-calculator-narration-keypad-key-alpha = Alpha
shared-calculator-narration-keypad-key-angle = Angle
shared-calculator-narration-keypad-key-angles = Angles
shared-calculator-narration-keypad-key-ans = Answer
shared-calculator-narration-keypad-key-arc = Arc
shared-calculator-narration-keypad-key-arccos = Inverse Cosine
shared-calculator-narration-keypad-key-arccot = Inverse Cotangent
shared-calculator-narration-keypad-key-arccsc = Inverse Cosecant
shared-calculator-narration-keypad-key-arcsec = Inverse Secant
shared-calculator-narration-keypad-key-arcsin = Inverse Sine
shared-calculator-narration-keypad-key-arctan = Inverse Tangent
shared-calculator-narration-keypad-key-area = Area
shared-calculator-narration-keypad-key-backspace = Backspace
shared-calculator-narration-keypad-key-beta = Beta
shared-calculator-narration-keypad-key-binomialdist = Binomial Distribution
shared-calculator-narration-keypad-key-boxplot = Box Plot
shared-calculator-narration-keypad-key-ceil = Ceiling
shared-calculator-narration-keypad-key-center = Center
shared-calculator-narration-keypad-key-circle = Circle
shared-calculator-narration-keypad-key-corr = Correlation
shared-calculator-narration-keypad-key-cos = Cosine
shared-calculator-narration-keypad-key-cosh = Hyperbolic Cosine
shared-calculator-narration-keypad-key-cot = Cotangent
shared-calculator-narration-keypad-key-coterminal = Coterminal
shared-calculator-narration-keypad-key-coth = Hyperbolic Cotangent
shared-calculator-narration-keypad-key-cov = Co Variance
shared-calculator-narration-keypad-key-covp = Population Co Variance
shared-calculator-narration-keypad-key-csc = Cosecant
shared-calculator-narration-keypad-key-csch = Hyperbolic Cosecant
shared-calculator-narration-keypad-key-cubed = Cubed
shared-calculator-narration-keypad-key-decimal = Decimal
shared-calculator-narration-keypad-key-dilation = Dilation
shared-calculator-narration-keypad-key-directed-angle = Directed Angle
shared-calculator-narration-keypad-key-directed-angles = Directed Angles
shared-calculator-narration-keypad-key-distance = Distance
shared-calculator-narration-keypad-key-divide = Divide
shared-calculator-narration-keypad-key-dotplot = Dot Plot
shared-calculator-narration-keypad-key-enter = Enter
shared-calculator-narration-keypad-key-erf = Error Function
shared-calculator-narration-keypad-key-exp = Exponent
shared-calculator-narration-keypad-key-factorial = Factorial
shared-calculator-narration-keypad-key-floor = Floor
shared-calculator-narration-keypad-key-fraction = A over B
shared-calculator-narration-keypad-key-glider = Glider
shared-calculator-narration-keypad-key-histogram = Histogram
shared-calculator-narration-keypad-key-int = Integral
shared-calculator-narration-keypad-key-intersection = Intersection
shared-calculator-narration-keypad-key-inversecdf = Inverse CDF function
shared-calculator-narration-keypad-key-ittest = Independent T Test
shared-calculator-narration-keypad-key-left-arrow = Left Arrow
shared-calculator-narration-keypad-key-left-bracket = Left Bracket
shared-calculator-narration-keypad-key-left-paren = Left Parenthesis
shared-calculator-narration-keypad-key-line = Line
shared-calculator-narration-keypad-key-ln = Natural Log
shared-calculator-narration-keypad-key-log = Log
shared-calculator-narration-keypad-key-loga = Log A
shared-calculator-narration-keypad-key-mean = Mean
shared-calculator-narration-keypad-key-median = Median
shared-calculator-narration-keypad-key-midpoint = Midpoint
shared-calculator-narration-keypad-key-minus = Minus
shared-calculator-narration-keypad-key-normaldist = Normal Distribution
shared-calculator-narration-keypad-key-nthroot = Nth Root
shared-calculator-narration-keypad-key-parallel = Parallel
shared-calculator-narration-keypad-key-pdf = Probability Density Function
shared-calculator-narration-keypad-key-percent-of = Percent Of
shared-calculator-narration-keypad-key-perimeter = Perimeter
shared-calculator-narration-keypad-key-perpendicular = Perpendicular
shared-calculator-narration-keypad-key-pi = Pi
shared-calculator-narration-keypad-key-plus = Plus
shared-calculator-narration-keypad-key-poissondist = Poisson Distribution
shared-calculator-narration-keypad-key-polygon = Polygon
shared-calculator-narration-keypad-key-prime = Function derivative
shared-calculator-narration-keypad-key-product = Product
shared-calculator-narration-keypad-key-quantile = Quantile
shared-calculator-narration-keypad-key-quartile = Quartile
shared-calculator-narration-keypad-key-radius = Radius
shared-calculator-narration-keypad-key-random = Random Number
shared-calculator-narration-keypad-key-ray = Ray
shared-calculator-narration-keypad-key-reciprocal = Reciprocal
shared-calculator-narration-keypad-key-reflection = Reflection
shared-calculator-narration-keypad-key-right-arrow = Right Arrow
shared-calculator-narration-keypad-key-right-bracket = Right Bracket
shared-calculator-narration-keypad-key-right-paren = Right Parenthesis
shared-calculator-narration-keypad-key-rotation = Rotation
shared-calculator-narration-keypad-key-round = Round
shared-calculator-narration-keypad-key-sec = Secant
shared-calculator-narration-keypad-key-segment = Segment
shared-calculator-narration-keypad-key-segments = Segments
shared-calculator-narration-keypad-key-shift = Shift
shared-calculator-narration-keypad-key-sin = Sine
shared-calculator-narration-keypad-key-sinh = Hyperbolic Sine
shared-calculator-narration-keypad-key-spearman = Spearman Rank Correlation
shared-calculator-narration-keypad-key-sqrt = Square Root
shared-calculator-narration-keypad-key-squared = Squared
shared-calculator-narration-keypad-key-stats = Summary statistics
shared-calculator-narration-keypad-key-stdev = Standard Deviation
shared-calculator-narration-keypad-key-stdevp = Standard Deviation of Population
shared-calculator-narration-keypad-key-subscript = Subscript
shared-calculator-narration-keypad-key-sum = Sum
shared-calculator-narration-keypad-key-superscript = Superscript
shared-calculator-narration-keypad-key-supplement = Supplement
shared-calculator-narration-keypad-key-tan = Tangent
shared-calculator-narration-keypad-key-tanh = Hyperbolic Tangent
shared-calculator-narration-keypad-key-tau = Tau
shared-calculator-narration-keypad-key-tdist = Student-t Distribution
shared-calculator-narration-keypad-key-theta = Theta
shared-calculator-narration-keypad-key-times = Times
shared-calculator-narration-keypad-key-toggle-audio-trace = Toggle Audio Trace
shared-calculator-narration-keypad-key-toggle-letters = Toggle Letters
shared-calculator-narration-keypad-key-toggle-numbers = Toggle Numbers
shared-calculator-narration-keypad-key-translation = Translation
shared-calculator-narration-keypad-key-tscore = T Score
shared-calculator-narration-keypad-key-ttest = T Test
shared-calculator-narration-keypad-key-uniformdist = Uniform Distribution
shared-calculator-narration-keypad-key-vertices = Vertices
shared-calculator-narration-keypad-key-ythroot = Yth Root
shared-calculator-narration-keypad-plus-minus = Plus-Minus
shared-calculator-narration-math-input-error-message = expression has error
shared-calculator-narration-redo = redo
shared-calculator-narration-settings-display-size = Display Size
shared-calculator-narration-settings-display-size-default = Display size: default
shared-calculator-narration-settings-display-size-large = Display size: large
shared-calculator-narration-show-as-decimal = Show as Decimal
shared-calculator-narration-show-as-fraction = Show as Fraction
shared-calculator-narration-six-key-mode-off = Six Key Braille Input off
shared-calculator-narration-six-key-mode-on = Six Key Braille Input on
shared-calculator-narration-table-cell-coordinates = Row { $rowNumber } Column { $columnNumber }
shared-calculator-narration-undo = undo
shared-calculator-text-keyboard-shortcut-add-expression = Add an Expression
shared-calculator-text-keyboard-shortcut-add-folder = Add a Folder
shared-calculator-text-keyboard-shortcut-add-image = Add an Image
shared-calculator-text-keyboard-shortcut-add-note = Add a Note
shared-calculator-text-keyboard-shortcut-add-table = Add a Table
shared-calculator-text-keyboard-shortcut-adjust-playback-speed = Adjust Playback Speed (1 = slowest, 5 = fastest)
shared-calculator-text-keyboard-shortcut-announce-slider-animations = Announce Active Slider Animations
shared-calculator-text-keyboard-shortcut-beginning-of-block = Beginning of Current Block
shared-calculator-text-keyboard-shortcut-beginning-of-expression = Beginning of Current Expression
shared-calculator-text-keyboard-shortcut-close-a-dialog = Close a Dialog
shared-calculator-text-keyboard-shortcut-collapse-all-folders = Collapse All Folders
shared-calculator-text-keyboard-shortcut-collapse-folder = Collapse Selected Folder
shared-calculator-text-keyboard-shortcut-decrease-volume = Decrease Volume
shared-calculator-text-keyboard-shortcut-decrease-x = Decrease X
shared-calculator-text-keyboard-shortcut-decrease-x-larger = Decrease X by Larger Amount
shared-calculator-text-keyboard-shortcut-decrease-y = Decrease Y
shared-calculator-text-keyboard-shortcut-decrease-y-larger = Decrease Y by Larger Amount
shared-calculator-text-keyboard-shortcut-degrees-toggle = Toggle Between Degrees and Radians
shared-calculator-text-keyboard-shortcut-delete-expression = Delete the Focused Expression
shared-calculator-text-keyboard-shortcut-delete-selection = Delete Selection
shared-calculator-text-keyboard-shortcut-describe-axes = Describe the graph axes
shared-calculator-text-keyboard-shortcut-end-of-block = End of Current Block
shared-calculator-text-keyboard-shortcut-end-of-expression = End of Current Expression
shared-calculator-text-keyboard-shortcut-exit-block = Exit Current Block
shared-calculator-text-keyboard-shortcut-expand-all-folders = Expand All Folders
shared-calculator-text-keyboard-shortcut-expand-folder = Expand Selected Folder
shared-calculator-text-keyboard-shortcut-first-point = First Point
shared-calculator-text-keyboard-shortcut-focus-expression-list = Focus the Expression List
shared-calculator-text-keyboard-shortcut-focus-first-interactive-point = Focus First Interactive Point On Screen
shared-calculator-text-keyboard-shortcut-hear-graph = Hear Graph
shared-calculator-text-keyboard-shortcut-hear-specific-branch = Hear Only Branch 1 Through 10
shared-calculator-text-keyboard-shortcut-increase-selection-left = Increase Selection Left
shared-calculator-text-keyboard-shortcut-increase-selection-right = Increase Selection Right
shared-calculator-text-keyboard-shortcut-increase-volume = Increase Volume
shared-calculator-text-keyboard-shortcut-increase-x = Increase X
shared-calculator-text-keyboard-shortcut-increase-x-larger = Increase X by Larger Amount
shared-calculator-text-keyboard-shortcut-increase-y = Increase Y
shared-calculator-text-keyboard-shortcut-increase-y-larger = Increase Y by Larger Amount
shared-calculator-text-keyboard-shortcut-last-point = Last Point
shared-calculator-text-keyboard-shortcut-move-to-denominator = Move to Denominator Within Fraction
shared-calculator-text-keyboard-shortcut-move-to-numerator = Move to Numerator Within Fraction
shared-calculator-text-keyboard-shortcut-move-to-origin = Move to Origin
shared-calculator-text-keyboard-shortcut-nemeth-mode = Switch to Nemeth
shared-calculator-text-keyboard-shortcut-next-character = Next Character
shared-calculator-text-keyboard-shortcut-next-curve = Move to Next Curve
shared-calculator-text-keyboard-shortcut-next-expression = Move to Next Expression
shared-calculator-text-keyboard-shortcut-next-interactive-point = Go to Next Interactive Point
shared-calculator-text-keyboard-shortcut-next-poi = Next Point of Interest
shared-calculator-text-keyboard-shortcut-next-point = Next Point
shared-calculator-text-keyboard-shortcut-open-a-graph = Open a Graph
shared-calculator-text-keyboard-shortcut-open-expression-options = Open Options for the Focused Expression
shared-calculator-text-keyboard-shortcut-open-shortcuts-dialog = Open Keyboard Shortcuts Dialog
shared-calculator-text-keyboard-shortcut-previous-character = Previous Character
shared-calculator-text-keyboard-shortcut-previous-curve = Move to Previous Curve
shared-calculator-text-keyboard-shortcut-previous-expression = Move to Previous Expression
shared-calculator-text-keyboard-shortcut-previous-interactive-point = Go to Previous Interactive Point
shared-calculator-text-keyboard-shortcut-previous-poi = Previous Point of Interest
shared-calculator-text-keyboard-shortcut-previous-point = Previous Point
shared-calculator-text-keyboard-shortcut-print-a-graph = Print a Graph
shared-calculator-text-keyboard-shortcut-print-mode = Switch to Print
shared-calculator-text-keyboard-shortcut-redo = Redo
shared-calculator-text-keyboard-shortcut-remove-empty-expression = Remove Selected Empty Expression
shared-calculator-text-keyboard-shortcut-save-a-graph = Save a Graph
shared-calculator-text-keyboard-shortcut-select-all = Select All
shared-calculator-text-keyboard-shortcut-show-answer-as-decimal-or-fraction = Show Answer as Decimal or Fraction
shared-calculator-text-keyboard-shortcut-show-or-hide-expression-list = Show or Hide the Expression List
shared-calculator-text-keyboard-shortcut-slider-decrease = Decrease Value
shared-calculator-text-keyboard-shortcut-slider-decrease-larger = Decrease Value by Larger Increment
shared-calculator-text-keyboard-shortcut-slider-increase = Increase Value
shared-calculator-text-keyboard-shortcut-slider-increase-larger = Increase Value by Larger Increment
shared-calculator-text-keyboard-shortcut-slider-maximum = Highest Value
shared-calculator-text-keyboard-shortcut-slider-minimum = Lowest Value
shared-calculator-text-keyboard-shortcut-slider-trace-decrease = Decrease Value of Selected Slider When in Slider Trace
shared-calculator-text-keyboard-shortcut-slider-trace-decrease-larger = Decrease Value of Selected Slider by Larger Increment When in Slider Trace
shared-calculator-text-keyboard-shortcut-slider-trace-increase = Increase Value of Selected Slider When in Slider Trace
shared-calculator-text-keyboard-shortcut-slider-trace-increase-larger = Increase Value of Selected Slider by Larger Increment When in Slider Trace
shared-calculator-text-keyboard-shortcut-slider-trace-maximum = Move to Highest Value of Selected Slider When in Slider Trace
shared-calculator-text-keyboard-shortcut-slider-trace-minimum = Move to Lowest Value of Selected Slider When in Slider Trace
shared-calculator-text-keyboard-shortcut-slider-trace-next-slider = Select Next Slider When in Slider Trace
shared-calculator-text-keyboard-shortcut-slider-trace-previous-slider = Select Previous Slider When in Slider Trace
shared-calculator-text-keyboard-shortcut-speak-answer = Speak Answer
shared-calculator-text-keyboard-shortcut-speak-branch = Speak Branch
shared-calculator-text-keyboard-shortcut-speak-color = Speak Color
shared-calculator-text-keyboard-shortcut-speak-focused-block = Speak Focused Block
shared-calculator-text-keyboard-shortcut-speak-label = Speak Label
shared-calculator-text-keyboard-shortcut-speak-left-adjacent-block = Speak Left-Adjacent Block
shared-calculator-text-keyboard-shortcut-speak-parent-block = Speak Parent Block
shared-calculator-text-keyboard-shortcut-speak-poi-count = Speak Point of Interest Count
shared-calculator-text-keyboard-shortcut-speak-point-type = Speak Type of Selected Point
shared-calculator-text-keyboard-shortcut-speak-right-adjacent-block = Speak Right-Adjacent Block
shared-calculator-text-keyboard-shortcut-speak-selection = Speak Selection
shared-calculator-text-keyboard-shortcut-speak-x = Speak X Coordinate
shared-calculator-text-keyboard-shortcut-speak-y = Speak Y Coordinate
shared-calculator-text-keyboard-shortcut-summarize-graph = Summarize Selected Curve
shared-calculator-text-keyboard-shortcut-table-first-column = First Column in Row
shared-calculator-text-keyboard-shortcut-table-first-row = First Row in Column
shared-calculator-text-keyboard-shortcut-table-last-column = Last Column in Row
shared-calculator-text-keyboard-shortcut-table-last-row = Last Row in Column
shared-calculator-text-keyboard-shortcut-table-next-cell = Next Cell
shared-calculator-text-keyboard-shortcut-table-next-column = Next Column
shared-calculator-text-keyboard-shortcut-table-next-row = Next Row
shared-calculator-text-keyboard-shortcut-table-previous-cell = Previous Cell
shared-calculator-text-keyboard-shortcut-table-previous-column = Previous Column
shared-calculator-text-keyboard-shortcut-table-previous-row = Previous Row
shared-calculator-text-keyboard-shortcut-table-speak-column-header = Speak Column Header
shared-calculator-text-keyboard-shortcut-toggle-account-menu = Open or Close the Account Menu
shared-calculator-text-keyboard-shortcut-toggle-audio-trace = Enable or Disable Audio Trace Mode
shared-calculator-text-keyboard-shortcut-toggle-braille-typing = Turn Braille Typing On or Off
shared-calculator-text-keyboard-shortcut-toggle-edit-list-mode = Turn Edit List Mode On or Off
shared-calculator-text-keyboard-shortcut-toggle-graph-settings-menu = Open or Close the Graph Settings Menu
shared-calculator-text-keyboard-shortcut-toggle-help-menu = Open or Close the Help Menu
shared-calculator-text-keyboard-shortcut-toggle-language-menu = Open or Close the Language Menu
shared-calculator-text-keyboard-shortcut-toggle-share-menu = Open or Close the Share Menu
shared-calculator-text-keyboard-shortcut-toggle-slider-trace = Toggle Slider Trace Mode
shared-calculator-text-keyboard-shortcut-ueb-mode = Switch to UEB
shared-calculator-text-keyboard-shortcut-undo = Undo
shared-calculator-text-keyboard-shortcut-usually = usually
shared-calculator-text-keyboard-shortcut-zoom-fit = Zoom to Fit
shared-calculator-text-keyboard-shortcut-zoom-in = Zoom In
shared-calculator-text-keyboard-shortcut-zoom-out = Zoom Out
shared-calculator-text-keyboard-shortcut-zoom-restore-default = Restore Default Viewport
shared-label-email = Email
shared-label-family-name = Last Name (optional)
shared-label-given-name-or-nickname = First Name or Nickname
shared-label-name = Name
shared-label-name-or-nickname = Name or Nickname
shared-label-new-email-address = New Email Address
shared-label-password = Password
shared-message-account-reactivated = You previously requested to delete your account, but because you logged back in within 30 days, we will not delete your account. Welcome back!
shared-message-change-password-email-sent = We will send a link to your email address ({ $emailAddress }) so you can change your password.
shared-message-check-email-for-delete-link = Please check your email ({ $emailAddress }) for the link to delete your account.
shared-message-check-email-for-link = Please check { $emailAddress } for the Change Email link.
shared-message-check-email-for-password-link = Please check your email ({ $emailAddress }) for the link to change your password.
shared-message-check-email-for-password-recovery-link = Message sent. Please check your email for a password recovery link.
shared-message-consent-delete-information = If you don't want Desmos to hold onto this information, you may delete your account from the Account Settings menu at any time.
shared-message-consent-information = When you created your Desmos account, you gave us your name, email address, and password (unless you signed in with Google, in which case you gave us access to the name and email address associated with that account). You also gave us access to your saved work. To continue using your Desmos account, please consent below to the collection of this information.
shared-message-consent-text = I agree to let Desmos store and maintain the information I provide (e.g. login credentials, saved work) in order to provide and improve its service. To withdraw consent, you may delete your account at any time.
shared-message-cookie-notice = <1>Note:</1> Desmos uses cookies to enable persistence when you are signed in. If you do not wish to use cookies, please use Desmos without logging in. <2>Learn More.</2>
shared-message-delete-account-notice = When you delete your account, <1>we will retain your data for 30 days.</1> You can reactivate your account at any time during those 30 days by logging back in. If there's something about Desmos we can improve, please <2>let us know.</2>
shared-message-delete-account-will-send-email = We will send you a link to your email address ({ $email }) so you can delete your account.
shared-message-email-sent = Email sent
shared-message-email-settings-will-send-email = We will send a Change Email link to { $emailAddress }.
shared-message-google-login-not-available = Google Login is not available on this device.
shared-message-information-saved = Saved!
shared-message-or-login-with-desmos = Or log in with Desmos
shared-message-please-review-name = We tried to split your name into first and last name. Please review your name below and edit any mistakes.
shared-message-privacy-notice = I have read, understand, and accept the <1>Terms of Service</1> and <2>Privacy Policy</2>{"."}
shared-message-set-new-email-address = Set a new email address and password.
shared-narration-privacy-policy-agreement = Checkbox to indicate agreement to privacy policy (desmos.com/privacy) and terms of service (desmos.com/terms).
shared-prompt-already-have-account = Already have a Desmos account?
shared-prompt-enter-email-for-password-recovery-link = Enter your email address to get a password recovery link.
shared-prompt-forgot-your-password = Forgot your password?
shared-prompt-new-to-desmos-sign-up-here = New to Desmos? <1>Sign up</1>{"."}
shared-prompt-new-to-desmos-teacher-or-student = New to Desmos? <1>Sign up!</1>
shared-prompt-please-consent-to-sign-up-with-apple = Please consent above to sign up with Apple
shared-prompt-please-consent-to-sign-up-with-google = Please consent above to sign up with Google
shared-prompt-sign-up-with-apple = Sign up with Apple
shared-prompt-sign-up-with-google = Sign up with Google
shared-title-account-reactivated = Your account has been reactivated.
shared-title-account-settings = Account Settings
shared-title-change-email-address = Change your Desmos email address
shared-title-change-password-narrow = Password
shared-title-change-password-wide = Change Password
shared-title-consent = We value your privacy
shared-title-delete-account = Are you sure you want to delete your account?
shared-title-email-settings = Email
shared-title-language-menu = Language
shared-title-login = Log In
shared-title-profile-information-narrow = Profile
shared-title-profile-information-wide = Profile Information
shared-title-recover-password = Recover Password
shared-title-signup = Sign-Up
### Strings for the graphing calculator and other tools


### 3103 English words, 926 English strings

basic-calculator-button-controlbar-abc = abc
basic-calculator-button-controlbar-clear = clear
basic-calculator-button-controlbar-clear-all = clear all
basic-calculator-button-controlbar-func = func
basic-calculator-button-controlbar-main = main
basic-calculator-button-turn-braille-mode-off = Turn { $mode } off
basic-calculator-error-fractions-unavailable = Fractions are not available in the current calculator.
basic-calculator-heading-braille-table-type-this = Type this
basic-calculator-heading-braille-table-typeset = Typeset
basic-calculator-heading-page-title-florida = Desmos | Florida Calculator
basic-calculator-heading-page-title-four-function = Desmos | 4-Function Calculator
basic-calculator-heading-title-scientific = Desmos | Scientific Calculator
basic-calculator-label-answer-hint = Your answers show up on this side.
basic-calculator-label-controlbar-deg = deg
basic-calculator-label-controlbar-rad = rad
basic-calculator-label-convert-to-decimal = Convert to decimal.
basic-calculator-label-convert-to-fraction = Convert to fraction.
basic-calculator-label-reverse-contrast = Reverse Contrast
basic-calculator-label-six-key-input = Six Key Braille Input
basic-calculator-link-download-braille-equations = Download Braille Equations
basic-calculator-link-help = Help
basic-calculator-link-privacy-policy = Privacy Policy
basic-calculator-link-terms-of-service = Terms of Service
basic-calculator-link-view-braille-examples = View more examples
basic-calculator-narration-calc-description-fourfunction = Desmos Four-Function Calculator
basic-calculator-narration-calc-description-scientific = Desmos Scientific Calculator
basic-calculator-narration-controlbar-abc = A B C
basic-calculator-narration-controlbar-backspace = backspace
basic-calculator-narration-controlbar-clear = clear
basic-calculator-narration-controlbar-clear-all = clear all
basic-calculator-narration-controlbar-degrees = Degrees
basic-calculator-narration-controlbar-functions = Functions
basic-calculator-narration-controlbar-main = main
basic-calculator-narration-controlbar-radians = Radians
basic-calculator-narration-controlbar-redo = Redo
basic-calculator-narration-controlbar-settings = settings
basic-calculator-narration-controlbar-undo = Undo
basic-calculator-narration-convert-to-decimal = Displaying as fraction. Press Enter to display as Decimal
basic-calculator-narration-convert-to-fraction = Displaying as decimal. Press Enter to display as Fraction
basic-calculator-narration-expression-list = Expression List
basic-calculator-narration-hotkey-six-key-input-off = Six Key Braille Input off
basic-calculator-narration-hotkey-six-key-input-on = Six Key Braille Input on
basic-calculator-narration-keypad = keypad
basic-calculator-narration-reverse-contrast = Reverse Contrast
basic-calculator-narration-six-key-input = Six Key Braille Input
basic-calculator-text-4fn-page-description = A beautiful, free 4-Function Calculator from Desmos.com.
basic-calculator-text-braille-mode-is-on = { $mode } is on!
basic-calculator-text-how-to-type-braille = Use a Refreshable Braille display, or just type Braille with a keyboard.
basic-calculator-text-scientific-page-description = A beautiful, free online scientific calculator with advanced features for evaluating percentages, fractions, exponential functions, logarithms, trigonometry, statistics, and more.
geometry-label-example-construction-centroid = Centroid
geometry-label-example-construction-circumcenter = Circumcenter
geometry-label-example-construction-equilateral-triangle = Equilateral Triangle
geometry-label-example-construction-orthocenter = Orthocenter
geometry-label-example-construction-perpendicular-bisector = Perpendicular Bisector
geometry-label-example-construction-pythagorean-theorem = Pythagorean Theorem
graphing-calculator-button-audio-trace-hear-graph = Hear Graph
graphing-calculator-button-audio-trace-stop-graph = Stop Graph
graphing-calculator-button-change-image = Change Image
graphing-calculator-button-clear-graph = Delete All
graphing-calculator-button-done = Done
graphing-calculator-button-draggable = Draggable
graphing-calculator-button-edit-graph-on-desmos-logo = edit graph on
graphing-calculator-button-editable-math = Editable Math
graphing-calculator-button-editable-text = Editable Text
graphing-calculator-button-find-cdf = Find Cumulative Probability (CDF)
graphing-calculator-button-funcs = funcs
graphing-calculator-button-functions = functions
graphing-calculator-button-functions-menu-custom-colors = Custom Colors
graphing-calculator-button-functions-menu-number-theory = Number Theory
graphing-calculator-button-functions-menu-special-characters = Special Characters
graphing-calculator-button-hide-folder-from-students = Hide this folder from students
graphing-calculator-button-hide-folder-from-students-2 = Hide this folder from students.
graphing-calculator-button-keypad-audio-trace-off = Audio Trace Off
graphing-calculator-button-keypad-describe-axes = Describe Axes
graphing-calculator-button-keypad-describe-curve = Describe Curve
graphing-calculator-button-keypad-describe-curve-short = Curve
graphing-calculator-button-keypad-describe-point = Describe Point
graphing-calculator-button-keypad-describe-point-short = Point
graphing-calculator-button-label = Label
graphing-calculator-button-label-editable = Editable
graphing-calculator-button-label-show-on-hover = Show on hover
graphing-calculator-button-label-text-outline = Text outline
graphing-calculator-button-load-image-retry = Retry.
graphing-calculator-button-place-image-behind-graphs = Place behind graphs
graphing-calculator-button-regression-log-mode = Log Mode
graphing-calculator-button-regression-plot-residuals = plot
graphing-calculator-button-replace = Replace
graphing-calculator-button-reset-graph = Reset
graphing-calculator-button-settings-2d = 2D
graphing-calculator-button-settings-3d = 3D
graphing-calculator-button-settings-degrees = Degrees
graphing-calculator-button-settings-radians = Radians
graphing-calculator-button-settings-zoom-square = Zoom Square
graphing-calculator-button-share-graph-link-copy = Copy
graphing-calculator-button-show-all-table-rows = Show all
graphing-calculator-button-slider-add-all-variables = all
graphing-calculator-button-visual-parameters-binned = Binned
graphing-calculator-button-visual-parameters-center = Center
graphing-calculator-button-visual-parameters-count = Count
graphing-calculator-button-visual-parameters-density = Density
graphing-calculator-button-visual-parameters-exact = Exact
graphing-calculator-button-visual-parameters-exclude-outliers = Exclude Outliers
graphing-calculator-button-visual-parameters-left = Left
graphing-calculator-button-visual-parameters-relative = Relative
graphing-calculator-error-equation-contains-unresolved-details = This equation contains fine detail that has not been fully resolved.
graphing-calculator-error-expression-replacement = Replacement must be a valid function or variable name.
graphing-calculator-error-expression-search = Can only rename a valid function or variable name.
graphing-calculator-error-failed-to-load-image = Failed to load image.
graphing-calculator-error-image-invalid-angle = Invalid angle. Try using any number.
graphing-calculator-error-image-invalid-center = Invalid center. Try, for example, (0,0).
graphing-calculator-error-image-invalid-file = The file "{ $file }" is not an image
graphing-calculator-error-image-invalid-height = Invalid height. Try using any number.
graphing-calculator-error-image-invalid-opacity = Invalid opacity. Try using any number.
graphing-calculator-error-image-invalid-width = Invalid width. Try using any number.
graphing-calculator-error-log-axes-image = Cannot plot images on a log scale.
graphing-calculator-heading-advanced = Advanced
graphing-calculator-heading-arrows = Arrows
graphing-calculator-heading-audio-trace-describe = Describe
graphing-calculator-heading-audio-trace-navigation = Navigation
graphing-calculator-heading-audio-trace-screen-reader = Screen Reader
graphing-calculator-heading-calculus = Calculus
graphing-calculator-heading-clickable = Clickable
graphing-calculator-heading-dist-tab-distributions = Distributions
graphing-calculator-heading-dist-tab-visualizations = Visualizations
graphing-calculator-heading-drag = Drag
graphing-calculator-heading-fill = Fill
graphing-calculator-heading-functions-menu-advanced = Advanced
graphing-calculator-heading-geometry = Geometry
graphing-calculator-heading-geometry-measurements = Properties & Measurements
graphing-calculator-heading-geometry-tools = Geometry Tools
graphing-calculator-heading-geometry-transformations = Transformations
graphing-calculator-heading-hyperbolic-trig = Hyperbolic Trig Functions
graphing-calculator-heading-image-opacity = Opacity
graphing-calculator-heading-inverse-trig = Inverse Trig Functions
graphing-calculator-heading-keypad-audio-trace-point-of-interest = <1>Point</1><2>of Interest</2>
graphing-calculator-heading-label = Label
graphing-calculator-heading-label-orientation = Orientation
graphing-calculator-heading-lines = Lines
graphing-calculator-heading-lists = List Operations
graphing-calculator-heading-mygraphs-examples = Examples
graphing-calculator-heading-on-every-update = On Every Update:
graphing-calculator-heading-points = Points
graphing-calculator-heading-regression-parameters = Parameters
graphing-calculator-heading-regression-residuals = Residuals
graphing-calculator-heading-regression-statistics = Statistics
graphing-calculator-heading-slider-animation-mode = Animation Mode
graphing-calculator-heading-slider-speed = Speed
graphing-calculator-heading-stat-tests = Statistical Tests
graphing-calculator-heading-stats = Statistics
graphing-calculator-heading-style = Style
graphing-calculator-heading-surfaces = Surfaces
graphing-calculator-heading-title = Graphing Calculator
graphing-calculator-heading-title-desmos = Desmos | Graphing Calculator
graphing-calculator-heading-title-untitled = Untitled Graph
graphing-calculator-heading-trig = Trig Functions
graphing-calculator-heading-visual-parameters-bar-heights = Bar Heights
graphing-calculator-heading-visual-parameters-bin-alignment = Bin Alignment
graphing-calculator-heading-visual-parameters-display-properties = Display Properties
graphing-calculator-heading-visual-parameters-x-values = X Values
graphing-calculator-label-add-depressed-image-tooltip = Add Depressed Image
graphing-calculator-label-add-hovered-image-tooltip = Add Hovered Image
graphing-calculator-label-add-item-tooltip = Add Item
graphing-calculator-label-add-slider = add slider:
graphing-calculator-label-angle-tooltip = Angle
graphing-calculator-label-animation-properties-tooltip = Animation Properties
graphing-calculator-label-audio-trace-curve = Curve
graphing-calculator-label-audio-trace-need-screen-reader = Your Screen Reader needs to be on to hear these.
graphing-calculator-label-audio-trace-point = Point
graphing-calculator-label-audio-trace-speed = Speed
graphing-calculator-label-audio-trace-volume = Volume
graphing-calculator-label-axes = Axes
graphing-calculator-label-braille-size-etc11 = ETC Romeo/Juliet (11.5 x 11 in)
graphing-calculator-label-braille-size-etc8 = ETC Romeo/Juliet (8.5 x 11 in)
graphing-calculator-label-braille-size-vpmax11 = VP Max (11.5 x 11 in)
graphing-calculator-label-braille-size-vpmax8 = VP Max (8.5 x 11 in)
graphing-calculator-label-cdf-maximum = Max:
graphing-calculator-label-cdf-minimum = Min:
graphing-calculator-label-change-depressed-image-tooltip = Change Depressed Image
graphing-calculator-label-change-hovered-image-tooltip = Change Hovered Image
graphing-calculator-label-checkers = Number of checkers on a side
graphing-calculator-label-convert-to-table-tooltip = Convert to Table
graphing-calculator-label-create-table = Create Table
graphing-calculator-label-depressed = Depressed
graphing-calculator-label-drop-image-here = Drop Image Here
graphing-calculator-label-duplicate-expression-tooltip = Duplicate
graphing-calculator-label-edit-list-tooltip = Edit List
graphing-calculator-label-evaluation-list = { $count } element list
graphing-calculator-label-example-graph-3d-conic-sections-circle = Conic Sections: Circle
graphing-calculator-label-example-graph-3d-conic-sections-ellipse = Conic Sections: Ellipse
graphing-calculator-label-example-graph-3d-conic-sections-hyperbola = Conic Sections: Hyperbola
graphing-calculator-label-example-graph-3d-conic-sections-parabola = Conic Sections: Parabola
graphing-calculator-label-example-graph-3d-f-rtheta = Function of r,\u03B8
graphing-calculator-label-example-graph-3d-f-xy = Function of x,y
graphing-calculator-label-example-graph-3d-goursat = Goursat's Tangle
graphing-calculator-label-example-graph-3d-implicit = Implicit surface
graphing-calculator-label-example-graph-3d-octahedron = Octahedron
graphing-calculator-label-example-graph-3d-osculating-circle = Osculating circle
graphing-calculator-label-example-graph-3d-parametric = Parametric curves
graphing-calculator-label-example-graph-3d-world = 3D World
graphing-calculator-label-example-graph-calculus-derivatives = Calculus: Derivatives
graphing-calculator-label-example-graph-calculus-fundamental-theorem-of-calculus = Calculus: Fundamental Theorem of Calculus
graphing-calculator-label-example-graph-calculus-integral-with-adjustable-bounds = Calculus: Integral with adjustable bounds
graphing-calculator-label-example-graph-calculus-integrals = Calculus: Integrals
graphing-calculator-label-example-graph-calculus-secant-line = Calculus: Secant Line
graphing-calculator-label-example-graph-calculus-tangent-line = Calculus: Tangent Line
graphing-calculator-label-example-graph-calculus-taylor-expansion-of-sin-x = Calculus: Taylor Expansion of sin(x)
graphing-calculator-label-example-graph-checkerboard-inversion = Checkerboard Inversion
graphing-calculator-label-example-graph-conic-sections-circle = Conic Sections: Circle
graphing-calculator-label-example-graph-conic-sections-ellipse-with-foci = Conic Sections: Ellipse with Foci
graphing-calculator-label-example-graph-conic-sections-hyperbola = Conic Sections: Hyperbola
graphing-calculator-label-example-graph-conic-sections-parabola-and-focus = Conic Sections: Parabola and Focus
graphing-calculator-label-example-graph-fastest-path-to-a-point = Fastest Path to a Point
graphing-calculator-label-example-graph-fireworks = Fireworks!
graphing-calculator-label-example-graph-fractal-valentine = Fractal Valentine
graphing-calculator-label-example-graph-lines-point-slope-form = Lines: Point Slope Form
graphing-calculator-label-example-graph-lines-slope-intercept-form = Lines: Slope Intercept Form
graphing-calculator-label-example-graph-lines-two-point-form = Lines: Two Point Form
graphing-calculator-label-example-graph-lists-curve-stitching = Lists: Curve Stitching
graphing-calculator-label-example-graph-lists-family-of-sin-curves = Lists: Family of sin Curves
graphing-calculator-label-example-graph-lists-plotting-a-list-of-points = Lists: Plotting a List of Points
graphing-calculator-label-example-graph-outstretched-arm = Outstretched Arm
graphing-calculator-label-example-graph-pac-man = Pac Man
graphing-calculator-label-example-graph-parabolas-standard-form = Parabolas: Standard Form
graphing-calculator-label-example-graph-parabolas-standard-form-plus-tangent = Parabolas: Standard Form + Tangent
graphing-calculator-label-example-graph-parabolas-vertex-form = Parabolas: Vertex Form
graphing-calculator-label-example-graph-parametric-cycloid = Parametric: Cycloid
graphing-calculator-label-example-graph-parametric-introduction = Parametric: Introduction
graphing-calculator-label-example-graph-polar-conic-sections = Polar: Conic Sections
graphing-calculator-label-example-graph-polar-limacon = Polar: Limacon
graphing-calculator-label-example-graph-polar-logarithmic-spiral = Polar: Logarithmic Spiral
graphing-calculator-label-example-graph-polar-rose = Polar: Rose
graphing-calculator-label-example-graph-pride-flag = PRIDE flag
graphing-calculator-label-example-graph-regular-sine-wave = Regular Sine Wave?
graphing-calculator-label-example-graph-stats-anscombes-quartet = Statistics: Anscombe's Quartet
graphing-calculator-label-example-graph-stats-fourth-order-polynomial = Statistics: 4th Order Polynomial
graphing-calculator-label-example-graph-stats-linear-regression = Statistics: Linear Regression
graphing-calculator-label-example-graph-transformations-inverse-of-a-function = Transformations: Inverse of a Function
graphing-calculator-label-example-graph-transformations-scaling-a-function = Transformations: Scaling a Function
graphing-calculator-label-example-graph-transformations-translating-a-function = Transformations: Translating a Function
graphing-calculator-label-example-graph-trig-period-and-amplitude = Trigonometry: Period and Amplitude
graphing-calculator-label-example-graph-trig-phase = Trigonometry: Phase
graphing-calculator-label-example-graph-trig-unit-circle = Trigonometry: Unit Circle
graphing-calculator-label-example-graph-trig-wave-interference = Trigonometry: Wave Interference
graphing-calculator-label-expression = Expression
graphing-calculator-label-expression-delete-tooltip = Delete
graphing-calculator-label-expression-lowercase = expression
graphing-calculator-label-folder-lowercase = folder
graphing-calculator-label-geometry-lowercase = geometry
graphing-calculator-label-geometry-tool-options = { $tool } options
graphing-calculator-label-geometry-tools = Geometry Tools
graphing-calculator-label-hide-expression-list-tooltip = Hide Expression List
graphing-calculator-label-hide-keypad = Hide Keypad
graphing-calculator-label-hovered = Hovered
graphing-calculator-label-image-angle = Angle:
graphing-calculator-label-image-center = Center:
graphing-calculator-label-image-height = Height:
graphing-calculator-label-image-lowercase = image
graphing-calculator-label-image-opacity = Opacity:
graphing-calculator-label-image-width = Width:
graphing-calculator-label-label-size-tooltip = Label Scale Factor
graphing-calculator-label-line-thickness-3d-tooltip = Line Thickness
graphing-calculator-label-line-thickness-tooltip = Line Thickness (px)
graphing-calculator-label-list-index = Use <1>index</1> to reference the clicked index in the list.
graphing-calculator-label-lock-expression-tooltip = Prevent Editing
graphing-calculator-label-more-viewport-options = More Options
graphing-calculator-label-new-transformation = New Transformation
graphing-calculator-label-note-lowercase = note
graphing-calculator-label-opacity-tooltip = Opacity (0 to 1)
graphing-calculator-label-open-graph-tooltip = Open Graph (ctrl+o)
graphing-calculator-label-poi-unknown = unknown coordinates
graphing-calculator-label-point-size-3d-tooltip = Point Size
graphing-calculator-label-point-size-tooltip = Point Size (px)
graphing-calculator-label-powered-by = powered by
graphing-calculator-label-randomize-tooltip = Randomize
graphing-calculator-label-recent-transformations = Recent Transformations
graphing-calculator-label-redo-tooltip = Redo (ctrl+y)
graphing-calculator-label-reference-count =
    { $count ->
        [one] (1 reference)
       *[other] ({ $count } references)
    }
graphing-calculator-label-regression-log-mode-help-tooltip = Log mode help
graphing-calculator-label-regression-parameters-not-exact = Parameters might not be exact. Click to learn more.
graphing-calculator-label-regression-what-is-rmse-tooltip = What is RMSE? Click to learn more.
graphing-calculator-label-regression-why-is-negative-tooltip = Why is this negative? Click to learn more.
graphing-calculator-label-remove-depressed-image = Remove depressed image
graphing-calculator-label-remove-hovered-image = Remove hovered image
graphing-calculator-label-rename = rename
graphing-calculator-label-replace-expressions = Replace with
graphing-calculator-label-resolution-tooltip = 3D Grid Sample Resolution
graphing-calculator-label-search-expressions = Search this graph
graphing-calculator-label-settings-add-label = add a label
graphing-calculator-label-settings-arrows = Arrows
graphing-calculator-label-settings-axis-3d = 3D axes
graphing-calculator-label-settings-axis-labels-3d = 3D axis labels
graphing-calculator-label-settings-axis-numbers = Axis Numbers
graphing-calculator-label-settings-box-3d = 3D box
graphing-calculator-label-settings-domain-plane = 2D plane
graphing-calculator-label-settings-grid = Grid
graphing-calculator-label-settings-lock-viewport = Lock Viewport
graphing-calculator-label-settings-minor-gridlines = Minor Gridlines
graphing-calculator-label-settings-reverse-contrast = Reverse Contrast
graphing-calculator-label-settings-six-key-braille = Six Key Braille Input
graphing-calculator-label-settings-step = Step:
graphing-calculator-label-settings-x-axis = X-Axis
graphing-calculator-label-settings-y-axis = Y-Axis
graphing-calculator-label-settings-z-axis = Z-Axis
graphing-calculator-label-show-keypad = Show Keypad
graphing-calculator-label-slider-disabled-while-ticker-playing = Sliders are disabled while the ticker is running.
graphing-calculator-label-slider-step = Step:
graphing-calculator-label-table-lowercase = table
graphing-calculator-label-ticker-close = cancel
graphing-calculator-label-ticker-help-tooltip = On slow computers, this might run slower. Use local variable "dt" to capture the actual update speed.
graphing-calculator-label-ticker-lowercase = ticker
graphing-calculator-label-ticker-min-step = Min Step Time
graphing-calculator-label-ticker-pause = pause
graphing-calculator-label-ticker-play = play
graphing-calculator-label-tooltip-geometry-settings = Geometry Settings
graphing-calculator-label-tooltip-graph-settings = Graph Settings
graphing-calculator-label-tooltip-open-graph = Open Graph
graphing-calculator-label-tooltip-reset = Reset
graphing-calculator-label-tooltip-show-list = Show List
graphing-calculator-label-tooltip-viewport-default = Default Viewport
graphing-calculator-label-tooltip-zoom-default-orientation = Default Orientation
graphing-calculator-label-tooltip-zoom-in = Zoom In
graphing-calculator-label-tooltip-zoom-out = Zoom Out
graphing-calculator-label-undo-tooltip = Undo (ctrl+z)
graphing-calculator-label-unlock-expression-tooltip = Allow Editing
graphing-calculator-label-update-on-click = On click:
graphing-calculator-link-audio-trace-keyboard-shortcuts = Keyboard Shortcuts
graphing-calculator-link-audio-trace-shortcuts = Shortcuts
graphing-calculator-link-edit-on-desmos = edit graph on
graphing-calculator-link-learn-more = Learn more.
graphing-calculator-link-view-braille-examples = View examples
graphing-calculator-narration-add-expression = Add expression
graphing-calculator-narration-add-folder = Add folder
graphing-calculator-narration-add-image = Add image
graphing-calculator-narration-add-item-menu = Add Item Menu
graphing-calculator-narration-add-note = Add note
graphing-calculator-narration-add-slider-prompt = Add slider for { $vars }
graphing-calculator-narration-add-table = Add table
graphing-calculator-narration-add-ticker = Add Ticker
graphing-calculator-narration-all-folders-collapsed = all folders collapsed
graphing-calculator-narration-all-folders-expanded = all folders expanded
graphing-calculator-narration-arrow-mode-both = Bi-directional arrow
graphing-calculator-narration-arrow-mode-one = Positive directional arrow
graphing-calculator-narration-audio-instructions-enter-audio-trace-mac = Press OPTION+T for audio trace.
graphing-calculator-narration-audio-instructions-enter-audio-trace-windows = Press ALT+T for audio trace.
graphing-calculator-narration-audio-trace-branch-not-found = Branch { $branch } does not exist.
graphing-calculator-narration-audio-trace-cannot-change-slider-value = Unable to adjust slider
graphing-calculator-narration-audio-trace-description-branch-count = Branches: { $branches }.
graphing-calculator-narration-audio-trace-description-color = Color: { $color }.
graphing-calculator-narration-audio-trace-description-multiple-extrema = { $count } extrema.
graphing-calculator-narration-audio-trace-description-multiple-intercepts = { $count } intercepts.
graphing-calculator-narration-audio-trace-description-multiple-intersections = { $count } intersections.
graphing-calculator-narration-audio-trace-description-multiple-labels = { $count } point labels.
graphing-calculator-narration-audio-trace-description-multiple-roots = { $count } zero crossings.
graphing-calculator-narration-audio-trace-description-no-curve-selected = No curve selected.
graphing-calculator-narration-audio-trace-description-no-visible-axes = No visible axes.
graphing-calculator-narration-audio-trace-description-one-extremum = 1 extremum.
graphing-calculator-narration-audio-trace-description-one-intercept = 1 intercept.
graphing-calculator-narration-audio-trace-description-one-intersection = 1 intersection.
graphing-calculator-narration-audio-trace-description-one-label = 1 point label.
graphing-calculator-narration-audio-trace-description-one-root = 1 zero crossing.
graphing-calculator-narration-audio-trace-description-shading-above = Shading above.
graphing-calculator-narration-audio-trace-description-shading-below = Shading below.
graphing-calculator-narration-audio-trace-description-shading-in-regions = Shading in regions.
graphing-calculator-narration-audio-trace-description-shading-left = Shading on the left.
graphing-calculator-narration-audio-trace-description-shading-right = Shading on the right.
graphing-calculator-narration-audio-trace-description-visible-grid = Grid lines are visible.
graphing-calculator-narration-audio-trace-description-visible-x-axis = X axis visible.
graphing-calculator-narration-audio-trace-description-visible-x-axis-and-label = X axis visible and is labeled { $label }.
graphing-calculator-narration-audio-trace-description-visible-x-axis-range = X axis visible from { $xmin } to { $xmax }.
graphing-calculator-narration-audio-trace-description-visible-x-axis-range-and-label = X axis visible from { $xmin } to { $xmax } and is labeled { $label }.
graphing-calculator-narration-audio-trace-description-visible-y-axis = Y axis visible.
graphing-calculator-narration-audio-trace-description-visible-y-axis-and-label = Y axis visible and is labeled { $label }.
graphing-calculator-narration-audio-trace-description-visible-y-axis-range = Y axis visible from { $ymin } to { $ymax }.
graphing-calculator-narration-audio-trace-description-visible-y-axis-range-and-label = Y axis visible from { $ymin } to { $ymax } and is labeled { $label }.
graphing-calculator-narration-audio-trace-expression-with-column = Expression { $index } column { $column }
graphing-calculator-narration-audio-trace-first-point = First point
graphing-calculator-narration-audio-trace-first-slider = First slider.
graphing-calculator-narration-audio-trace-instructions-disable-mac = To disable audio trace, press OPTION+T.
graphing-calculator-narration-audio-trace-instructions-disable-windows = To disable audio trace, press ALT+T.
graphing-calculator-narration-audio-trace-instructions-expression-navigation-mac = To move between expressions, press COMMAND+Up-Arrow or COMMAND+Down-Arrow.
graphing-calculator-narration-audio-trace-instructions-expression-navigation-windows = To move between expressions, press ALT+Up-Arrow or ALT+Down-Arrow.
graphing-calculator-narration-audio-trace-instructions-hear-graph = To hear the graph, press H.
graphing-calculator-narration-audio-trace-instructions-use-arrow-keys = Use Arrow keys to navigate.
graphing-calculator-narration-audio-trace-last-point = Last point
graphing-calculator-narration-audio-trace-last-slider = Last slider.
graphing-calculator-narration-audio-trace-multiple-sliders-paused = { $sliders } animating sliders were paused.
graphing-calculator-narration-audio-trace-no-more-pois = No more points of interest
graphing-calculator-narration-audio-trace-no-sliders-paused = No animating sliders were paused.
graphing-calculator-narration-audio-trace-one-slider-paused = One animating slider was paused.
graphing-calculator-narration-audio-trace-playback-speed = Graph playback speed { $speed }
graphing-calculator-narration-audio-trace-poi-count = Points of interest, { $x }.
graphing-calculator-narration-audio-trace-point-type-definition = Definition
graphing-calculator-narration-audio-trace-point-type-extremum = Extremum
graphing-calculator-narration-audio-trace-point-type-intercept = Intercept
graphing-calculator-narration-audio-trace-point-type-intersection = Intersection
graphing-calculator-narration-audio-trace-point-type-intersection-with-curves = Intersection with { $curves }
graphing-calculator-narration-audio-trace-point-type-label = Label
graphing-calculator-narration-audio-trace-point-type-not-a-poi = Not a P O I
graphing-calculator-narration-audio-trace-point-type-root = Zero
graphing-calculator-narration-audio-trace-point-type-trace = Trace
graphing-calculator-narration-audio-trace-property-branch-number = Branch { $branch }.
graphing-calculator-narration-audio-trace-property-type-before-coordinates = { $type } at
graphing-calculator-narration-audio-trace-property-x = X: { $x }.
graphing-calculator-narration-audio-trace-property-y = Y: { $y }.
graphing-calculator-narration-audio-trace-secret-expression = Secret expression { $index }
graphing-calculator-narration-audio-trace-slider-value-unknown = Unable to determine slider value
graphing-calculator-narration-audio-trace-sound-effects-disabled = Sound effects have been disabled.
graphing-calculator-narration-audio-trace-traceable-curves =
    { $sketchCount ->
        [one] 1 audio traceable curve.
       *[other] { $sketchCount } audio traceable curves.
    }
graphing-calculator-narration-audio-trace-tracing-different-expression = Tracing { $expression }.
graphing-calculator-narration-audio-trace-unable-to-play = Unable to play audio.
graphing-calculator-narration-audio-trace-unable-to-trace-this-expression = Unable to audio trace this expression.
graphing-calculator-narration-audio-trace-unsupported-expression = { $expression } cannot be audio traced.
graphing-calculator-narration-audio-trace-volume = Volume { $volume } percent
graphing-calculator-narration-cdf-maximum = Max
graphing-calculator-narration-cdf-minimum = Min
graphing-calculator-narration-click-action = Click Action
graphing-calculator-narration-clickable-image-options = Clickable Image Options
graphing-calculator-narration-clickable-object-description = clickable object
graphing-calculator-narration-collapse-folder = Collapse Folder
graphing-calculator-narration-color-unknown = unknown
graphing-calculator-narration-computed-cell-role-description = computed cell
graphing-calculator-narration-description-collapsed-folder = Collapsed Folder
graphing-calculator-narration-description-collapsed-secret-folder = Collapsed Secret Folder
graphing-calculator-narration-description-folder = Folder
graphing-calculator-narration-description-hidden-collapsed-folder = Hidden Collapsed Folder
graphing-calculator-narration-description-hidden-collapsed-secret-folder = Hidden Collapsed Secret Folder
graphing-calculator-narration-description-hidden-folder = Hidden Folder
graphing-calculator-narration-description-hidden-secret-folder = Hidden Secret Folder
graphing-calculator-narration-description-secret-folder = Secret Folder
graphing-calculator-narration-dist-tab-distributions = Distributions
graphing-calculator-narration-dist-tab-visualizations = Visualizations
graphing-calculator-narration-domain-maximum = domain Maximum:
graphing-calculator-narration-domain-minimum = domain Minimum:
graphing-calculator-narration-domain3d-maximum = domain { $term } Maximum:
graphing-calculator-narration-domain3d-minimum = domain { $term } Minimum:
graphing-calculator-narration-drag-mode-x = X
graphing-calculator-narration-drag-mode-xy = X and Y
graphing-calculator-narration-drag-mode-y = Y
graphing-calculator-narration-draggable-image-description = draggable image
graphing-calculator-narration-draggable-image-off-screen-prompt = { " " }not completely visible on screen
graphing-calculator-narration-draggable-label-description = draggable label
graphing-calculator-narration-edit-action = Edit Action
graphing-calculator-narration-edit-expression-list = Edit Expression List
graphing-calculator-narration-edit-graph-on-desmos = Edit graph on Desmos
graphing-calculator-narration-edit-list-mode-off = Edit list mode off.
graphing-calculator-narration-edit-list-mode-on = Edit list mode on.
graphing-calculator-narration-edit-on-desmos = Edit graph on Desmos
graphing-calculator-narration-edit-slider-variable-limits = Edit { $variable } Limits
graphing-calculator-narration-editable-label-mode = Editable label mode
graphing-calculator-narration-editable-point-label-at-coordinates = Editable point label at { $coordinates }
graphing-calculator-narration-expression-audio-trace-mac = To audio trace, press OPTION+T.
graphing-calculator-narration-expression-audio-trace-windows = To audio trace, press ALT+T.
graphing-calculator-narration-expression-bar = Expression Bar
graphing-calculator-narration-expression-evaluation-has-graph = Has graph.
graphing-calculator-narration-expression-evaluation-has-graph-and-regression = Has graph and regression. To access statistics, press Tab.
graphing-calculator-narration-expression-evaluation-has-regression = Has regression. To access statistics, press Tab.
graphing-calculator-narration-expression-evaluation-is-distribution = is distribution.
graphing-calculator-narration-expression-evaluation-is-t-test = is T test. To access statistics, press Tab.
graphing-calculator-narration-expression-hidden-label = Hidden { $label }
graphing-calculator-narration-expression-index-table = Expression { $index } table
graphing-calculator-narration-expression-label = Label
graphing-calculator-narration-expression-list = Expression list
graphing-calculator-narration-expression-search-results =
    { $count ->
        [zero] No results
        [one] 1 result
       *[other] { $count } results
    }
graphing-calculator-narration-fill-opacity = Fill Opacity:
graphing-calculator-narration-fill-visible = Fill visible
graphing-calculator-narration-folder-collapsed = folder collapsed
graphing-calculator-narration-folder-expanded = folder expanded
graphing-calculator-narration-folder-has-items = { $folder } has { $count } items
graphing-calculator-narration-functions = Functions
graphing-calculator-narration-geometry-added-object-type = Added { $type }.
graphing-calculator-narration-geometry-added-object-type-and-point = Added { $type } and 1 point.
graphing-calculator-narration-geometry-added-object-type-and-points = Added { $type } and { $points } points.
graphing-calculator-narration-geometry-added-object-type-with-label = Added { $type } with label { $label }.
graphing-calculator-narration-geometry-added-points = Added { $points } points.
graphing-calculator-narration-geometry-angle-at-coordinates-through-points = { $itemDescription } through { $parent1 }, { $parent2 }, and { $parent3 } at { $x1 } { $y1 }
graphing-calculator-narration-geometry-angle-of-polygon-at-coordinates = { $itemDescription } of { $parent } at { $x } { $y }
graphing-calculator-narration-geometry-angle-with-assignment = Angle { $assignment }
graphing-calculator-narration-geometry-angle-with-measurement-and-assignment = { $measurementText } Angle { $assignment }
graphing-calculator-narration-geometry-arc-with-assignment = Arc { $assignment }
graphing-calculator-narration-geometry-circle-with-assignment = Circle { $assignment }
graphing-calculator-narration-geometry-construction-role-description = construction
graphing-calculator-narration-geometry-deselect-all = Deselect All
graphing-calculator-narration-geometry-dilated-item = dilated { $item }
graphing-calculator-narration-geometry-directed-angle-with-assignment = Directed Angle { $assignment }
graphing-calculator-narration-geometry-directed-angle-with-measurement-and-assignment = { $measurementText } Directed Angle { $assignment }
graphing-calculator-narration-geometry-edge-of-polygon = Edge { $polygonEdge } of { $item }
graphing-calculator-narration-geometry-glider-with-assignment = GliderW { $assignment }
graphing-calculator-narration-geometry-hidden-construction-description = Hidden { $description }
graphing-calculator-narration-geometry-intersection-with-assignment = Intersection { $assignment }
graphing-calculator-narration-geometry-item-at-coordinates = { $itemDescription } at { $x } { $y }
graphing-calculator-narration-geometry-item-at-coordinates-and-intersection = { $itemDescription } intersecting { $parent1 } and { $parent2 } at { $x } { $y }
graphing-calculator-narration-geometry-item-at-coordinates-and-parent = { $itemDescription } of { $parent } at { $x } { $y }
graphing-calculator-narration-geometry-item-at-coordinates-to-coordinates = { $itemDescription } from { $x1 } { $y1 } to { $x2 } { $y2 }
graphing-calculator-narration-geometry-item-at-coordinates-with-middle-and-end = { $itemDescription } starting at { $x1 } { $y1 } middle at { $x2 } { $y2 } and end at { $x3 } { $y3 }
graphing-calculator-narration-geometry-item-at-coordinates-with-radius = { $itemDescription } at { $x } { $y } with radius { $radius }.
graphing-calculator-narration-geometry-item-to-line-passing-through-point-at-coordinates-to-coordinates = { $itemDescription } to { $parent1 } passing through { $parent2 } from { $x1 } { $y1 } to { $x2 } { $y2 }
graphing-calculator-narration-geometry-item-unknown = Unknown
graphing-calculator-narration-geometry-item-with-list-index = index { $listIndex } of { $item }
graphing-calculator-narration-geometry-line-with-assignment = Line { $assignment }
graphing-calculator-narration-geometry-midpoint-with-assignment = Midpoint { $assignment }
graphing-calculator-narration-geometry-moved-to-coordinates = Moved to x: { $x }, y: { $y }.
graphing-calculator-narration-geometry-near-item = Near { $item }.
graphing-calculator-narration-geometry-not-a-construction = Selected item is not a construction.
graphing-calculator-narration-geometry-nothing-selected = Nothing selected.
graphing-calculator-narration-geometry-parallel-with-assignment = Parallel { $assignment }
graphing-calculator-narration-geometry-perpendicular-with-assignment = Perpendicular { $assignment }
graphing-calculator-narration-geometry-point-with-assignment = Point { $assignment }
graphing-calculator-narration-geometry-polygon-with-assignment = Polygon { $assignment } with { $sideCount } sides
graphing-calculator-narration-geometry-quadrilateral-with-assignment = Quadrilateral { $assignment }
graphing-calculator-narration-geometry-ray-with-assignment = Ray { $assignment }
graphing-calculator-narration-geometry-reflected-item = reflected { $item }
graphing-calculator-narration-geometry-rotated-item = rotated { $item }
graphing-calculator-narration-geometry-segment-with-assignment = Segment { $assignment }
graphing-calculator-narration-geometry-tool-cancelled = Cancelled.
graphing-calculator-narration-geometry-transformed-item = reflected { $item }
graphing-calculator-narration-geometry-translated-item = translated { $item }
graphing-calculator-narration-geometry-triangle-with-assignment = Triangle { $assignment }
graphing-calculator-narration-geometry-unable-to-move = Unable to move.
graphing-calculator-narration-geometry-unlabeled-angle = Angle { $index }
graphing-calculator-narration-geometry-unlabeled-angle-with-measurement = { $measurementText } Angle
graphing-calculator-narration-geometry-unlabeled-arc = Arc { $index }
graphing-calculator-narration-geometry-unlabeled-circle = Circle { $index }
graphing-calculator-narration-geometry-unlabeled-directed-angle = Directed Angle { $index }
graphing-calculator-narration-geometry-unlabeled-directed-angle-with-measurement = { $measurementText } Directed Angle
graphing-calculator-narration-geometry-unlabeled-glider = Glider { $index }
graphing-calculator-narration-geometry-unlabeled-intersection = Intersection { $index }
graphing-calculator-narration-geometry-unlabeled-line = Line { $index }
graphing-calculator-narration-geometry-unlabeled-midpoint = Midpoint { $index }
graphing-calculator-narration-geometry-unlabeled-parallel = Parallel { $index }
graphing-calculator-narration-geometry-unlabeled-perpendicular = Perpendicular { $index }
graphing-calculator-narration-geometry-unlabeled-point = Point { $index }
graphing-calculator-narration-geometry-unlabeled-polygon = Polygon { $index } with { $sideCount } sides
graphing-calculator-narration-geometry-unlabeled-quadrilateral = Quadrilateral { $index }
graphing-calculator-narration-geometry-unlabeled-ray = Ray { $index }
graphing-calculator-narration-geometry-unlabeled-segment = Segment { $index }
graphing-calculator-narration-geometry-unlabeled-triangle = Triangle { $index }
graphing-calculator-narration-graph-settings-controls = Graph Settings Controls
graphing-calculator-narration-graphpaper-label = graph paper
graphing-calculator-narration-hide-animation-properties = Hide Animation Properties
graphing-calculator-narration-hide-expression = Hide Expression
graphing-calculator-narration-hide-expression-list = Hide expression list
graphing-calculator-narration-hide-folder = Hide Folder
graphing-calculator-narration-hide-image = Hide Image
graphing-calculator-narration-hide-keypad = Hide Keypad
graphing-calculator-narration-hide-options = Hide Options
graphing-calculator-narration-hide-table-column = Hide Column
graphing-calculator-narration-image-styles = Styles
graphing-calculator-narration-items-deleted =
    { $count ->
        [one] { $count } item deleted.
       *[other] { $count } items deleted.
    }
graphing-calculator-narration-keypad-key-next-curve = Next Curve
graphing-calculator-narration-keypad-key-next-poi = Next Point of Interest
graphing-calculator-narration-keypad-key-next-point = Next Point
graphing-calculator-narration-keypad-key-previous-curve = Previous Curve
graphing-calculator-narration-keypad-key-previous-poi = Previous Point of Interest
graphing-calculator-narration-keypad-key-previous-point = Previous Point
graphing-calculator-narration-keypad-key-speed-down = Speed Down
graphing-calculator-narration-keypad-key-speed-up = Speed Up
graphing-calculator-narration-keypad-key-volume-down = Volume Down
graphing-calculator-narration-keypad-key-volume-up = Volume Up
graphing-calculator-narration-label-angle = Label Angle:
graphing-calculator-narration-label-size = Label Size:
graphing-calculator-narration-label-text = Label Text
graphing-calculator-narration-label-visible = Label visible
graphing-calculator-narration-line-opacity = Line Opacity:
graphing-calculator-narration-line-style-dashed = Dashed
graphing-calculator-narration-line-style-dotted = Dotted
graphing-calculator-narration-line-style-solid = Solid
graphing-calculator-narration-lines-visible = Lines visible
graphing-calculator-narration-main-desmos-geometry = Desmos Geometry
graphing-calculator-narration-main-desmos-graphing-calculator = Desmos Graphing Calculator
graphing-calculator-narration-make-clickable = make clickable
graphing-calculator-narration-menu-arrows-enabled = Arrows Enabled
graphing-calculator-narration-menu-drag-enabled = Drag Enabled
graphing-calculator-narration-movable-point-description = movable point
graphing-calculator-narration-movable-point-off-screen-prompt = { " " }not visible on screen
graphing-calculator-narration-movable-point-prefix = Graph point
graphing-calculator-narration-movable-point-suffix-usage-instructions = { " " }is movable. Press Arrows or Shift+Arrows to adjust.
graphing-calculator-narration-no-interactive-points = No interactive points on screen
graphing-calculator-narration-open-graph = Open Graph
graphing-calculator-narration-options-menu = Options Menu
graphing-calculator-narration-options-menu-closed = Options menu closed.
graphing-calculator-narration-options-menu-open = Options menu open.
graphing-calculator-narration-orientation-restore-default = Restore Default Orientation
graphing-calculator-narration-pause-variable-animation = Pause { $variable } Animation
graphing-calculator-narration-play-variable-animation = Play { $variable } Animation
graphing-calculator-narration-poi-graph-point = Graph point
graphing-calculator-narration-point-description = point
graphing-calculator-narration-point-opacity = Point Opacity:
graphing-calculator-narration-point-size = Point Size:
graphing-calculator-narration-point-style-cross = Cross
graphing-calculator-narration-point-style-open = Open
graphing-calculator-narration-point-style-point = Point
graphing-calculator-narration-points-visible = Points visible
graphing-calculator-narration-powered-by-desmos = Powered by DevGraph
graphing-calculator-narration-redo = Redo
graphing-calculator-narration-run-action-icon = Run Action
graphing-calculator-narration-settings-angle = Angle Settings
graphing-calculator-narration-settings-cartesian-grid = Cartesian Grid
graphing-calculator-narration-settings-dimension = 2D vs 3D Mode
graphing-calculator-narration-settings-polar-grid = Polar Grid
graphing-calculator-narration-settings-show-both = Show Both
graphing-calculator-narration-settings-show-positive = Show Positive
graphing-calculator-narration-settings-x-axis-label = add x-axis label
graphing-calculator-narration-settings-x-axis-logarithmic-scale = make x-axis scale logarithmic
graphing-calculator-narration-settings-x-axis-max = X Axis Maximum:{ " " }
graphing-calculator-narration-settings-x-axis-min = X Axis Minimum:{ " " }
graphing-calculator-narration-settings-x-axis-step = X Axis Step Size:{ " " }
graphing-calculator-narration-settings-y-axis-label = add y-axis label
graphing-calculator-narration-settings-y-axis-logarithmic-scale = make y-axis scale logarithmic
graphing-calculator-narration-settings-y-axis-max = Y Axis Maximum:{ " " }
graphing-calculator-narration-settings-y-axis-min = Y Axis Minimum:{ " " }
graphing-calculator-narration-settings-y-axis-step = Y Axis Step Size:{ " " }
graphing-calculator-narration-settings-z-axis-label = add z-axis label
graphing-calculator-narration-settings-z-axis-max = Z Axis Maximum:{ " " }
graphing-calculator-narration-settings-z-axis-min = Z Axis Minimum:{ " " }
graphing-calculator-narration-settings-z-axis-step = Z Axis Step Size:{ " " }
graphing-calculator-narration-share-graph-link = Link to this graph
graphing-calculator-narration-share-graph-link-copied = Link copied
graphing-calculator-narration-share-graph-link-unable-to-copy = Unable to copy link
graphing-calculator-narration-show-animation-properties = Show Animation Properties
graphing-calculator-narration-show-expression = Show Expression
graphing-calculator-narration-show-expression-list = Show expression list
graphing-calculator-narration-show-image = Show Image
graphing-calculator-narration-show-keypad = Show Keypad
graphing-calculator-narration-show-options = Show Options
graphing-calculator-narration-show-table-column = Show Column
graphing-calculator-narration-slider-animate-faster = Animate Faster
graphing-calculator-narration-slider-animate-slower = Animate Slower
graphing-calculator-narration-slider-animating-at-speed = Animating at { $speed }x
graphing-calculator-narration-slider-loop-forwards-and-backwards = Loop forwards and backwards
graphing-calculator-narration-slider-maximum = Slider Maximum:
graphing-calculator-narration-slider-minimum = Slider Minimum:
graphing-calculator-narration-slider-play-indefinitely = Play indefinitely
graphing-calculator-narration-slider-play-once = Play once
graphing-calculator-narration-slider-repeat-one-direction = Repeat in one direction
graphing-calculator-narration-slider-step = Slider Step Size:
graphing-calculator-narration-slider-trace-no-sliders = No sliders to trace.
graphing-calculator-narration-slider-trace-off = Slider trace off.
graphing-calculator-narration-slider-trace-on = Slider trace on.
graphing-calculator-narration-slider-variable-paused = { $variable } paused
graphing-calculator-narration-slider-variable-playing = { $variable } playing
graphing-calculator-narration-slider-variable-restarted = { $variable } restarted
graphing-calculator-narration-surfaces-visible = Surfaces visible
graphing-calculator-narration-table-column-header = Column header { $column }
graphing-calculator-narration-table-no-column-header = No column header
graphing-calculator-narration-table-row-column = Row { $row } Col { $column }
graphing-calculator-narration-tick-action = Tick Action
graphing-calculator-narration-toggle-audio-trace = Toggle Audio Trace
graphing-calculator-narration-toggle-letters = Toggle Letters
graphing-calculator-narration-transformations-menu = Transformations Menu
graphing-calculator-narration-unable-to-activate-account-menu = Unable to activate account menu
graphing-calculator-narration-unable-to-activate-help-menu = Unable to activate help menu
graphing-calculator-narration-unable-to-activate-language-menu = Unable to activate language menu
graphing-calculator-narration-unable-to-activate-share-menu = Unable to activate share menu
graphing-calculator-narration-unable-to-add-expression = Unable to add expression
graphing-calculator-narration-unable-to-add-note = Unable to add note
graphing-calculator-narration-unable-to-add-table = Unable to add table
graphing-calculator-narration-undo = Undo
graphing-calculator-narration-viewport-default = Graph viewport default
graphing-calculator-narration-viewport-restore-default = Restore Default Viewport
graphing-calculator-narration-viewport-updated = Graph viewport updated.
graphing-calculator-narration-viewport-zoom-in = Graph zoom in
graphing-calculator-narration-viewport-zoom-out = Graph zoom out
graphing-calculator-narration-viewport-zoom-square = Graph zoom square
graphing-calculator-narration-visual-parameters-height = Height
graphing-calculator-narration-visual-parameters-offset = Offset
graphing-calculator-narration-visual-parameters-width = Width
graphing-calculator-narration-x-percentage-coordinate = { $x } percent from left.
graphing-calculator-narration-y-percentage-coordinate = { $y } percent from top.
graphing-calculator-text-add-screen-reader-label-placeholder = Add screen reader label
graphing-calculator-text-audio-trace-no-implicit-support = Sorry, but I can't trace implicit curves yet.
graphing-calculator-text-audio-trace-no-parametric-support = Sorry, but I can't trace parametric curves yet.
graphing-calculator-text-audio-trace-no-polar-support = Sorry, but I can't trace polar curves yet.
graphing-calculator-text-audio-trace-off = Audio trace off.
graphing-calculator-text-audio-trace-on = Audio trace on.
graphing-calculator-text-color-black = black
graphing-calculator-text-color-blue = blue
graphing-calculator-text-color-gray = gray
graphing-calculator-text-color-green = green
graphing-calculator-text-color-orange = orange
graphing-calculator-text-color-purple = purple
graphing-calculator-text-color-red = red
graphing-calculator-text-color-unknown = color unknown
graphing-calculator-text-enter-note-placeholder = Enter a note...
graphing-calculator-text-enter-pareneter = Enter the { $param }.
graphing-calculator-text-export-braille-email-accessibility = Feedback? Email <1>accessibility@desmos.com</1>{"."}
graphing-calculator-text-geometry-delete-selected-objects =
    { $count ->
        [one] Delete 1 object
       *[other] Delete { $count } objects
    }
graphing-calculator-text-geometry-glider = glider
graphing-calculator-text-geometry-hide-objects =
    { $count ->
        [one] Hide
       *[other] Hide all
    }
graphing-calculator-text-geometry-intersection = intersection
graphing-calculator-text-geometry-multi-select-more-dropdown = More
graphing-calculator-text-geometry-multi-select-transform = Transform
graphing-calculator-text-geometry-select-hint = Select a { $type }
graphing-calculator-text-geometry-selected-objects =
    { $count ->
        [one] 1 object selected
       *[other] { $count } objects selected
    }
graphing-calculator-text-geometry-show-objects =
    { $count ->
        [one] Show
       *[other] Show all
    }
graphing-calculator-text-geometry-tool-angle-display-name = Angle
graphing-calculator-text-geometry-tool-angle-hint-1 = Choose a point (one leg)
graphing-calculator-text-geometry-tool-angle-hint-2 = Choose a point (vertex)
graphing-calculator-text-geometry-tool-angle-hint-3 = Choose a point (other leg)
graphing-calculator-text-geometry-tool-angles-display-name = Angles
graphing-calculator-text-geometry-tool-angles-hint-1 = Choose a polygon
graphing-calculator-text-geometry-tool-arc-display-name = Arc
graphing-calculator-text-geometry-tool-arc-hint-1 = Choose a point (start)
graphing-calculator-text-geometry-tool-arc-hint-2 = Choose a point (middle)
graphing-calculator-text-geometry-tool-arc-hint-3 = Choose a point (end)
graphing-calculator-text-geometry-tool-box-selection-display-name = Box Select
graphing-calculator-text-geometry-tool-circle-display-name = Circle
graphing-calculator-text-geometry-tool-circle-hint-center = Choose a point (center)
graphing-calculator-text-geometry-tool-circle-hint-radius = Choose a point (radius)
graphing-calculator-text-geometry-tool-compass-display-name = Compass
graphing-calculator-text-geometry-tool-compass-hint-center = Choose a point (center)
graphing-calculator-text-geometry-tool-compass-hint-segment = Choose a segment (radius)
graphing-calculator-text-geometry-tool-dilate-display-name = Dilate
graphing-calculator-text-geometry-tool-dilation-hint-center = Choose point (center)
graphing-calculator-text-geometry-tool-dilation-hint-scale-factor = Scale factor
graphing-calculator-text-geometry-tool-directedangle-display-name = Directed angle
graphing-calculator-text-geometry-tool-line-display-name = Line
graphing-calculator-text-geometry-tool-line-hint-end = Choose a 2nd point
graphing-calculator-text-geometry-tool-line-hint-start = Choose a 1st point
graphing-calculator-text-geometry-tool-midpoint-display-name = Midpoint
graphing-calculator-text-geometry-tool-midpoint-hint = Choose a segment
graphing-calculator-text-geometry-tool-parallel-display-name = Parallel
graphing-calculator-text-geometry-tool-parallel-hint-point = Choose a point to set location
graphing-calculator-text-geometry-tool-parallel-hint-straight-line = Choose a line to set slope
graphing-calculator-text-geometry-tool-perpendicular-display-name = Perpendicular
graphing-calculator-text-geometry-tool-perpendicular-hint-point = Choose a point to set location
graphing-calculator-text-geometry-tool-perpendicular-hint-straight-line = Choose a line to set slope
graphing-calculator-text-geometry-tool-point-display-name = Point
graphing-calculator-text-geometry-tool-point-hint = Select or create a point
graphing-calculator-text-geometry-tool-polygon-display-name = Polygon
graphing-calculator-text-geometry-tool-polygon-hint-finish-point = Choose another point, or click an existing point to finish
graphing-calculator-text-geometry-tool-polygon-hint-first-point = Choose a point
graphing-calculator-text-geometry-tool-polygon-hint-next-point = Choose another point
graphing-calculator-text-geometry-tool-ray-display-name = Ray
graphing-calculator-text-geometry-tool-ray-hint-end = Choose a point (direction)
graphing-calculator-text-geometry-tool-ray-hint-start = Choose a point (vertex)
graphing-calculator-text-geometry-tool-reflect-display-name = Reflect
graphing-calculator-text-geometry-tool-reflection-hint-choose-line = Choose line of reflection
graphing-calculator-text-geometry-tool-rotate-display-name = Rotate
graphing-calculator-text-geometry-tool-rotation-hint-angle = Choose angle
graphing-calculator-text-geometry-tool-rotation-hint-center = Choose point (center)
graphing-calculator-text-geometry-tool-segment-display-name = Segment
graphing-calculator-text-geometry-tool-segment-hint-end = Choose another point
graphing-calculator-text-geometry-tool-segment-hint-start = Choose a point
graphing-calculator-text-geometry-tool-selection-display-name = Select
graphing-calculator-text-geometry-tool-translate-display-name = Translate
graphing-calculator-text-geometry-tool-translation-hint-from = Choose start point
graphing-calculator-text-geometry-tool-translation-hint-to = Choose end point
graphing-calculator-text-geometry-tool-vector-display-name = Vector
graphing-calculator-text-geometry-tool-vector-hint-end = Choose an ending point
graphing-calculator-text-geometry-tool-vector-hint-start = Choose a starting point
graphing-calculator-text-image-enter-note-placeholder = Enter a note...
graphing-calculator-text-label-orientation-above = Above
graphing-calculator-text-label-orientation-above-left = Above Left
graphing-calculator-text-label-orientation-above-right = Above Right
graphing-calculator-text-label-orientation-below = Below
graphing-calculator-text-label-orientation-below-left = Below Left
graphing-calculator-text-label-orientation-below-right = Below Right
graphing-calculator-text-label-orientation-default = Default
graphing-calculator-text-label-orientation-left = Left
graphing-calculator-text-label-orientation-right = Right
graphing-calculator-text-loading-image = Loading image...
graphing-calculator-text-note-placeholder = Enter a note...
graphing-calculator-text-page-description = Explore math with our beautiful, free online graphing calculator. Graph functions, plot points, visualize algebraic equations, add sliders, animate graphs, and more.
graphing-calculator-text-parameter-name-binwidth = Bin Width
graphing-calculator-text-parameter-name-data = Data Set
graphing-calculator-text-parameter-name-dof = Degrees of Freedom
graphing-calculator-text-parameter-name-height = Height
graphing-calculator-text-parameter-name-max = Maximum
graphing-calculator-text-parameter-name-mean = Mean
graphing-calculator-text-parameter-name-min = Minimum
graphing-calculator-text-parameter-name-offset = Offset
graphing-calculator-text-parameter-name-probsuccess = Success Probability
graphing-calculator-text-parameter-name-stddev = Standard Deviation
graphing-calculator-text-parameter-name-trials = Trials
graphing-calculator-text-refreshable-braille-display-note = Use a refreshable Braille display, or just type Braille with a keyboard.
graphing-calculator-text-regression-potentially-inaccurate-parameters = Some parameters may be too large or small to represent accurately.
graphing-calculator-text-share-graph-link = Link to this graph
graphing-calculator-text-table-created = Table created.
graphing-calculator-text-table-more-rows = { $rowCount } more rows
graphing-calculator-text-toast-choose-one-file = You can only choose one file as a replacement
graphing-calculator-text-toast-error-importing-graph = Error importing graph. Check the URL?
graphing-calculator-text-toast-error-no-folders = Only graphs without folders can be inserted into a folder.
graphing-calculator-text-toast-expression-size-limit = Maximum expression size reached.
graphing-calculator-text-toast-graph-cleared = Graph cleared.
graphing-calculator-text-toast-graph-reset = Graph reset.
graphing-calculator-text-toast-image-upload-failed = Image upload failed.
graphing-calculator-text-toast-imported-graph = Graph imported!
graphing-calculator-text-toast-importing-graph = Importing graph...
graphing-calculator-text-toast-no-file-selected = You did not select a file
graphing-calculator-text-toast-undo-cmd-z = Press CMD+Z to undo.
graphing-calculator-text-toast-undo-ctrl-z = Press CTRL+Z to undo.
graphing-calculator-text-toast-uploading-images = Uploading images...
graphing-calculator-text-toast-zoom-to-fit = We zoomed to fit your data.
graphing-calculator-text-zoom-fit = Zoom Fit
graphing-tours-heading-advanced-tables = Advanced Tables
graphing-tours-heading-derivatives = Derivatives
graphing-tours-heading-folders = Folders
graphing-tours-heading-lists = Lists
graphing-tours-heading-regressions = Regressions
graphing-tours-heading-restrictions = Restrictions
graphing-tours-heading-sliders = Sliders
graphing-tours-heading-tables = Tables
graphing-tours-label-advanced-tables-continue = Click here to continue editing this table.
graphing-tours-label-advanced-tables-convert = Convert this to a table.
graphing-tours-label-advanced-tables-create = Click here to generate a table.
graphing-tours-label-advanced-tables-dots = Click here to only show the dots.
graphing-tours-label-advanced-tables-edit-list = Click the "Edit List" button.
graphing-tours-label-advanced-tables-graph = Start by graphing a function.
graphing-tours-label-advanced-tables-new-column = Move right to add a new column.
graphing-tours-label-advanced-tables-options = Click and hold on this icon until the options menu opens up.
graphing-tours-label-advanced-tables-start = Let's make a function. First: click here to create a new blank expression.
graphing-tours-label-advanced-tables-type-function = Try typing { $sample_expression }
graphing-tours-label-advanced-tables-wizard = You're a table wizard!
graphing-tours-label-awesome = Awesome!
graphing-tours-label-brilliant = Brilliant!
graphing-tours-label-derivative-graph-derivative = To graph its derivative: { $equation }
graphing-tours-label-derivative-hint-type-derivative = Hint: To get the derivative operator, just type d/dx.
graphing-tours-label-derivative-one-more = Let's try one more: { $equation }
graphing-tours-label-derivative-start-function = Start with a function: { $equation }
graphing-tours-label-derivative-start-graph = Let's graph a derivative!
graphing-tours-label-folders-collapse = Now we\u2019ll explore some folder functionality. Click here to collapse the folder.
graphing-tours-label-folders-did-you-know = Did You Know...
graphing-tours-label-folders-grab = Now grab this equation by its left edge and drag it into the folder.
graphing-tours-label-folders-great-start = That\u2019s a great start!
graphing-tours-label-folders-hide = You can hide everything in the folder with one click. Click here to try.
graphing-tours-label-folders-indicator = Hint: The gray line will show you if the expression is in the folder.
graphing-tours-label-folders-name = Give your folder a name.
graphing-tours-label-folders-new-equation = Let's make a new equation. For example, type: { $equation }
graphing-tours-label-folders-option = ... and select the "folder" option.
graphing-tours-label-folders-start = Let's make a folder!
graphing-tours-label-great-job = Great job!
graphing-tours-label-last-thing = Last thing!
graphing-tours-label-list-computation = You can do a computation on a list. For example: { $equation }
graphing-tours-label-lists-are-powerful = Lists are powerful. Let's see.
graphing-tours-label-lists-begin-equation = Begin by typing { $equation }
graphing-tours-label-lists-count-by = If you want to count by 5 instead, just write something like this: { $equation }
graphing-tours-label-lists-create-range = You can create lists of integers even more easily. Try this: { $equation }
graphing-tours-label-lists-graph-equation = Graph: { $equation }
graphing-tours-label-lists-graph-points = Let's graph a few points.
graphing-tours-label-lists-hint-abc = Hint: press the 'A B C' button on the keypad to find the [ ] buttons
graphing-tours-label-lists-hint-plot-points = Hint: this will plot a point for each item of b.
graphing-tours-label-lists-hint-superscript = Hint: you can type { $suggestion1 } or use the { $suggestion2 } button on the keypad below.
graphing-tours-label-lists-point-equation = Try this: { $equation }
graphing-tours-label-lists-put-to-work = Nice. Let's put that list to work.
graphing-tours-label-new-item = Click here to add a new item.
graphing-tours-label-nice = Nice!
graphing-tours-label-regressions-better-fit = Edit this equation to find a better fit. Try, for example:<br>{ $equation }
graphing-tours-label-regressions-check-model = Nice. Let's check the model.
graphing-tours-label-regressions-data = First, let's get some data.
graphing-tours-label-regressions-data-2 = Let's start with some data!
graphing-tours-label-regressions-docs = Head over to Google Docs and copy and paste this { $sample_data_link }.
graphing-tours-label-regressions-equation = Now type: { $equation }
graphing-tours-label-regressions-expression-option = ... and select the "expression" option.
graphing-tours-label-regressions-fill-sample-data = Fill in the sample data:
graphing-tours-label-regressions-hint-1 = Hint #1: to get { $y_1 } type { $y1 }.
graphing-tours-label-regressions-hint-2 = Hint #2: { $twiddle } is in our onscreen keypad in the 'A B C' section.
graphing-tours-label-regressions-keep-exploring = Nice work &ndash; Keep exploring!
graphing-tours-label-regressions-new-model = Now, let's try a new model.
graphing-tours-label-regressions-new-table = Click here to add a new table.
graphing-tours-label-regressions-own-data = Note: you can add your own data instead by clicking the { $plus_icon } button.
graphing-tours-label-regressions-residuals = Residuals are the difference between your data and your model. Click here to add them to your table and plot them on the graph.
graphing-tours-label-regressions-sample-data = sample data
graphing-tours-label-require-expressions-visible = Click to show the list of expressions.
graphing-tours-label-require-not-edit-list-mode = Click to return to your expressions.
graphing-tours-label-require-resources-not-open = Click to return to this graph.
graphing-tours-label-restrictions-abc = Hint: press the 'A B C' button on the keypad to find the { $buttons } buttons
graphing-tours-label-restrictions-blank-expression = Click here to make a new blank expression.
graphing-tours-label-restrictions-change-equation = Change this equation to { $sample_expression }
graphing-tours-label-restrictions-domain = Restrict the domain of this line by adding { $sample_expression } to the end.
graphing-tours-label-restrictions-dont-forget = Don't forget the "y="!
graphing-tours-label-restrictions-graph-parabola = Now graph: { $sample_expression }
graphing-tours-label-restrictions-move-parabola = Move the parabola.
graphing-tours-label-restrictions-new-expression = Click here to create a new expression.
graphing-tours-label-restrictions-range = Now let's restrict the range. Add { $sample_expression } to the end.
graphing-tours-label-restrictions-star = You're a restrictions star!
graphing-tours-label-restrictions-start = Let's get started!
graphing-tours-label-restrictions-straight-line = Try graphing a straight line, like { $sample_expression }
graphing-tours-label-restrictions-type-all = Try typing all of { $sample_expression }
graphing-tours-label-restrictions-typing-hint = Hint: you can type { $suggestion1 }, or use the { $suggestion2 } button on the keypad below.
graphing-tours-label-self-destruct = This message will self-destruct in { $seconds }...
graphing-tours-label-sliders-add = Now click here to add the sliders.
graphing-tours-label-sliders-blank-expression = Click here to create a new blank expression.
graphing-tours-label-sliders-change-value = Type in here to change the value.
graphing-tours-label-sliders-drag-handle = Drag the handle to change the value.
graphing-tours-label-sliders-hands-free = Go "Hands-free"
graphing-tours-label-sliders-make-sliders = Let's make some sliders!
graphing-tours-label-sliders-press-play = Press play to animate the slider.
graphing-tours-label-sliders-pro = You're a slider pro!
graphing-tours-label-sliders-try-typing = Try typing { $sample_expression }
graphing-tours-label-tables-back = Click back to continue editing.
graphing-tours-label-tables-close-options = Click anywhere to close the drawing options.
graphing-tours-label-tables-dots = Click here to connect the dots.
graphing-tours-label-tables-enter = Now try pressing Enter.
graphing-tours-label-tables-fill-another = Just fill in one more...
graphing-tours-label-tables-fill-cell = Fill it in.
graphing-tours-label-tables-fill-row = Fill in this whole row.
graphing-tours-label-tables-last-trick = Last trick!
graphing-tours-label-tables-next-row = Go down to the next row to add more data.
graphing-tours-label-tables-open-options = Click and hold on this icon until the options menu opens up.
graphing-tours-label-tables-select-table = ... and select the "table" option.
graphing-tours-label-tables-start = Let's make a table!
graphing-tours-label-tables-type-number = Type any number here.
graphing-tours-label-tables-valid-number = Uh-oh! Type a valid number here.
graphing-tours-label-tables-whiz = You're a tables whiz!
matrix-calculator-button-new = New Matrix
matrix-calculator-button-settings = settings
matrix-calculator-heading-edit-matrix = Edit Matrix { $variable }
matrix-calculator-label-columns = Columns
matrix-calculator-label-rows = Rows
matrix-calculator-narration-add-column = Add Column
matrix-calculator-narration-add-row = Add Row
matrix-calculator-narration-evaluation = equals { $rowCount } by { $columnCount } matrix.
matrix-calculator-narration-evaluation-row = Row { $rowNumber }: { $values }.
matrix-calculator-narration-keypad-key-det = Determinant
matrix-calculator-narration-keypad-key-inverse = Inverse
matrix-calculator-narration-keypad-key-rref = Reduced row echelon form
matrix-calculator-narration-keypad-key-trace = Trace
matrix-calculator-narration-keypad-key-transpose = Transpose
matrix-calculator-narration-matrix-with-variable = Matrix { $variable }
matrix-calculator-narration-matrix-without-variable = Matrix
matrix-calculator-narration-new-dimensions = Matrix size: { $rows } by { $cols }
matrix-calculator-narration-remove-column = Remove Column
matrix-calculator-narration-remove-row = Remove Row
matrix-calculator-narration-resize-controls = Resize Matrix Controls
matrix-calculator-narration-settings-menu = Settings Menu
matrix-calculator-narration-title = Desmos Matrix Calculator
### String for curriculum marketing


### 254 English words, 37 English strings

curriculum-info-button-no = No
curriculum-info-button-request-form-submit = Request More Information
curriculum-info-button-yes = Yes
curriculum-info-error-request-form-contact-info-email = Please enter a valid email address.
curriculum-info-error-request-form-contact-info-first-name = Please enter your first name.
curriculum-info-error-request-form-contact-info-last-name = Please enter your last name.
curriculum-info-error-request-form-enter-role = Please enter your role.
curriculum-info-error-request-form-site-name = Please enter the name of your school or district.
curriculum-info-heading-end-of-page-info = Want to learn more?
curriculum-info-heading-grade-level-interest = Which grades are you interested in?
curriculum-info-heading-partners-logos = Some of Our Partner Schools and Districts
curriculum-info-heading-request-form = Request more information about the curriculum.
curriculum-info-heading-request-form-contact-info = Your contact information:
curriculum-info-heading-request-form-this-fall-interest = Are you looking to use the Desmos Curriculum this fall?
curriculum-info-heading-testimonials = What are people saying?
curriculum-info-heading-whats-in-the-curriculum = What's in Desmos Math 6\u2013A1?
curriculum-info-label-grade-6-interest = Grade 6
curriculum-info-label-grade-7-interest = Grade 7
curriculum-info-label-grade-8-interest = Grade 8
curriculum-info-label-request-form-contact-info-email = Email
curriculum-info-label-request-form-contact-info-first-name = First Name
curriculum-info-label-request-form-contact-info-last-name = Last Name
curriculum-info-label-request-form-enter-role = What is your role?
curriculum-info-label-request-form-enter-role-placeholder = Role
curriculum-info-label-request-form-select-role = Select your role:
curriculum-info-label-request-form-site-name = Name of school or district:
curriculum-info-label-request-form-site-name-placeholder = School or District Name
curriculum-info-label-role-administrator = Administrator
curriculum-info-label-role-coach = Math Coach
curriculum-info-label-role-other = Other
curriculum-info-label-role-teacher = Teacher
curriculum-info-label-try-this-activity = Try an activity!
curriculum-info-narration-ipad-with-student-screen = An iPad with a student screen. On the screen, the student sketches planets and explores what happens when the drawing is sent through different machines. Behind the iPad, there is a paper version of the activity where the student has sketched scaled copies of a shape on a grid.
curriculum-info-narration-laptop-with-student-screen = A laptop with a student screen. On the screen, the student describes what he notices and wonder while changing the scale factor of a mosaic pattern he created.
curriculum-info-narration-screen-with-teacher-dashboard = A computer screen with two windows open. The first window shows the teacher screen for Grade 7, Unit 5. The second window, to the right of the first, shows a teacher dashboard with square patterns created by students in the class.
curriculum-info-text-request-sent-confirmation = Thank you, { $firstName }! An email with more information is on the way.
curriculum-info-text-request-sent-other-follow-up-email-subject = I have a question about the Desmos Curriculum
### Strings for desmos.com homepage


### 4816 English words, 410 English strings

frontpage-button-braille-print-examples = Print these examples
frontpage-button-main-join-class = Join
frontpage-error-something-went-wrong-try-again-later = Sorry! Something went wrong. Please try again later.
frontpage-heading-about-desmos-classroom = About Desmos Classroom
frontpage-heading-about-desmos-studio = About Desmos Studio
frontpage-heading-art-contest-guest-judges = Guest Judges
frontpage-heading-braille-examples = Braille Examples
frontpage-heading-braille-table-type-this = Type this
frontpage-heading-braille-table-typeset = Typeset
frontpage-heading-braille-view-examples-in = View examples in:
frontpage-heading-equity-as-we-do-this-work = As we do this work, we ask ourselves...
frontpage-heading-equity-disrupt-systemic-inequities = III.  We want to disrupt systemic inequities and conditions of marginalization in education.
frontpage-heading-equity-more-equitable-workplace = II. We want to work continuously towards an equitable workplace.
frontpage-heading-equity-next-steps = Next Steps and an Invitation
frontpage-heading-equity-principles = Equity Principles
frontpage-heading-equity-serve-all-students-and-teachers = I.  We want our products to serve all students and teachers.
frontpage-heading-footer-company = Company
frontpage-heading-footer-legal = Legal
frontpage-heading-footer-products = Products
frontpage-heading-footer-resources = Resources
frontpage-heading-guiding-build-for-real-classrooms = Build for Real Classrooms
frontpage-heading-guiding-champion-teachers = Champion Teachers
frontpage-heading-guiding-design-for-delight = Design for Delight
frontpage-heading-guiding-principles = Guiding Principles
frontpage-heading-guiding-works-every-time = Works Every Time
frontpage-heading-header-maintenance-mode = Desmos is currently undergoing scheduled maintenance, and accounts are temporarily unavailable.
frontpage-heading-keyboard-shortcuts-four-function = Four Function Calculator Keyboard Shortcuts
frontpage-heading-keyboard-shortcuts-graphing = Graphing Calculator Keyboard Shortcuts
frontpage-heading-keyboard-shortcuts-scientific = Scientific Calculator Keyboard Shortcuts
frontpage-heading-main-global-art-contest-back = The Desmos Global Art Contest is back!
frontpage-heading-main-global-art-contest-finalists-2020 = Global Math Art Contest 2020 Finalists
frontpage-heading-main-global-art-contest-finalists-2021 = Global Math Art Contest 2021 Finalists
frontpage-heading-main-global-art-contest-gallery-2022 = Global Math Art Contest 2022 Gallery
frontpage-heading-main-global-thank-you = Thank you for joining our Global Math Art Contest, { $name }!
frontpage-heading-main-lets-learn-together = Let's learn together.
frontpage-heading-main-our-partners = Our Partners
frontpage-heading-main-students = Students
frontpage-heading-main-teachers = Teachers
frontpage-heading-main-using-desmos-classroom = Using Desmos Classroom?
frontpage-heading-partners-accessibility-out-of-box = Accessibility Out of the Box
frontpage-heading-partners-anywhere-any-device = Anywhere, Any Device
frontpage-heading-partners-constant-improvements = Constant Improvements
frontpage-heading-partners-global-scale = Global Scale
frontpage-heading-partners-rock-solid-reliability = Rock-Solid Reliability
frontpage-heading-partners-want-to-embed = Want to partner with Desmos Studio PBC?
frontpage-heading-shared-contact-us = Contact Us
frontpage-heading-team-job-title-ceo = CEO
frontpage-heading-team-job-title-coaching = Coaching
frontpage-heading-team-job-title-copy-editing = Copy Editing
frontpage-heading-team-job-title-data = Data
frontpage-heading-team-job-title-engineering = Engineering
frontpage-heading-team-job-title-faculty = Faculty
frontpage-heading-team-job-title-interaction-developer = Interaction Developer
frontpage-heading-team-job-title-localization = Localization
frontpage-heading-team-job-title-operations = Operations
frontpage-heading-team-job-title-partnerships = Partnerships
frontpage-heading-team-job-title-product = Product
frontpage-heading-team-job-title-support = Support
frontpage-heading-team-meet-the-team = Meet the Team
frontpage-heading-team-partnerships-programs-and-operations = Partnerships, Programs, and Operations
frontpage-heading-team-product-and-engineering = Product and Engineering
frontpage-heading-team-teaching = Teaching
frontpage-heading-testmode-about-desmos-test-mode = About Desmos Test Mode
frontpage-heading-testmode-about-tab = About
frontpage-heading-testmode-android-tab = Android (Beta)
frontpage-heading-testmode-chromebooks-tab = Chromebooks
frontpage-heading-testmode-feedback-tab = Feedback
frontpage-heading-testmode-ipads-and-iphones-tab = iPads and iPhones
frontpage-heading-testmode-practice-tab = Practice
frontpage-heading-title-404 = Error 404: Page not found
frontpage-heading-title-about = About Us
frontpage-heading-title-art-contest = Art Contest Finalists
frontpage-heading-title-curriculum = Curriculum
frontpage-heading-title-equity = Equity Principles
frontpage-heading-title-frontpage = Let's learn together.
frontpage-heading-title-guiding-principles = Guiding Principles
frontpage-heading-title-partners = Partners
frontpage-heading-title-team = Team
frontpage-label-about-meet-the-team = Meet the Team
frontpage-label-art-contest-certificate = View your Certificate
frontpage-label-art-contest-feedback = Share your Feedback
frontpage-label-art-contest-finalists-2020 = Finalists 2020
frontpage-label-art-contest-finalists-2021 = Finalists 2021
frontpage-label-art-contest-from-artist = From the artist:
frontpage-label-art-contest-from-judges = From the judges:
frontpage-label-art-contest-photo-vernon-1st = 1st Place
frontpage-label-art-contest-photo-vernon-2nd = 2nd Place
frontpage-label-art-contest-photo-vernon-3rd = 3rd Place
frontpage-label-art-contest-trailblazer = Trailblazer
frontpage-label-main-classcode-placeholder = Code
frontpage-link-art-contest-age-range-13-14 = Ages 13-14
frontpage-link-art-contest-age-range-15-16 = Ages 15-16
frontpage-link-art-contest-age-range-17-18 = Ages 17-18
frontpage-link-art-contest-age-range-19 = Ages 19+
frontpage-link-curriculum-schedule-call = Request More Info
frontpage-link-curriculum-try-it = Try It for Free
frontpage-link-footer-classroom-activities = Classroom Activities
frontpage-link-footer-contact-twitter = Twitter
frontpage-link-footer-partnerships = Partnerships
frontpage-link-header-classroom = Classroom
frontpage-link-header-math-tools = Math Tools
frontpage-link-header-resources = Resources
frontpage-link-header-team-desmos = Team Desmos
frontpage-link-main-browse-activities = Browse Activities
frontpage-link-main-for-students = For Students
frontpage-link-main-for-teachers = For Teachers
frontpage-link-main-go-to-student-homepage = Go to Student Homepage
frontpage-link-main-view-the-winners = See all of the featured graphs!
frontpage-link-read-equity-principles = Read our Equity Principles
frontpage-link-read-guiding-principles = Read our Guiding Principles
frontpage-link-shared-about-us = About Us
frontpage-link-shared-account-settings = Account Settings
frontpage-link-shared-api-documentation = API Docs
frontpage-link-shared-assessments = Assessments
frontpage-link-shared-blog = Des-Blog
frontpage-link-shared-careers = Careers
frontpage-link-shared-contact-us = Contact Us
frontpage-link-shared-curriculum = Desmos Math 6\u2013A1
frontpage-link-shared-equity-principles = Equity Principles
frontpage-link-shared-four-function-calculator = Four-Function Calculator
frontpage-link-shared-geometry-tool = Geometry Tool
frontpage-link-shared-graphing-calculator = Graphing Calculator
frontpage-link-shared-guiding-principles = Guiding Principles
frontpage-link-shared-help-center = Help Center
frontpage-link-shared-hiring = We're hiring!
frontpage-link-shared-log-in = Log In
frontpage-link-shared-log-out = Log Out
frontpage-link-shared-matrix-calculator = Matrix Calculator
frontpage-link-shared-scientific-calculator = Scientific Calculator
frontpage-link-shared-sign-up = Sign Up
frontpage-link-shared-store = Desmos Store
frontpage-link-shared-test-practice = Test Practice
frontpage-link-testmode-learn-more-screen-pinning-mode = Learn more about using Screen Pinning on your Android device.
frontpage-narration-art-contest-image-of-graph = Image of { $graphTitle }
frontpage-narration-art-contest-image-of-graph-by = Image of graph by { $name }
frontpage-narration-art-contest-photo-boaler = Photo of Jo Boaler
frontpage-narration-art-contest-photo-bousso = Photo of Diarra Bousso
frontpage-narration-art-contest-photo-sanderson = Photo of Grant Sanderson
frontpage-narration-art-contest-photo-vernon = Photo of Natalie Vernon
frontpage-narration-art-contest-photo-woo = Photo of Eddie Woo
frontpage-narration-main-partner-logo = { $name } logo
frontpage-narration-shared-desmos-logo = Desmos Logo
frontpage-narration-shared-image-of-graph = Image of { $graphTitle }
frontpage-narration-team-collapse-biography = Collapse Biography
frontpage-narration-team-picture-of-name = Picture of { $name }
frontpage-narration-testmode-im-done-timer-ios = The I'm Done button and timer on the iOS closing screen
frontpage-narration-testmode-ipad-opening-screen = The Start Test button on the iPad opening screen
frontpage-narration-testmode-opening-screen = The opening screen of Test Mode
frontpage-text-about-build-a-world = Desmos wants to build a world where every student learns math and loves learning math, where a student\u2019s access to the power and beauty of math doesn't depend on their place of birth, race, ethnicity, gender, or any other aspect of their identity.
frontpage-text-about-classroom = Desmos Classroom is now part of Amplify Education! <1>Learn more</1>{"."}
frontpage-text-about-classroom-curriculum = In 2020, we turned those experiences into <1>a core middle school math program</1>, combining a problem-based curriculum from Illustrative Mathematics, scalable support models from Amplify, and Desmos Classroom's intuitive technology and humanizing pedagogy.
frontpage-text-about-classroom-join-us = Want to learn more? Preview <1>Desmos Math 6-A1</1>, join the Desmos Educators <2>Facebook Community</2>, or find a <3>career with Desmos Classroom</3> at Amplify!
frontpage-text-about-classroom-pedagogy = Desmos Classroom invites, celebrates, and develops student brilliance through <1>free digital classroom activities</1>, thoughtfully designed by teachers for teachers. Those activities are guided by our <2>our pedagogical philosophy</2> and help students to explore concepts deeply, collaborate with their peers on problem-solving, and apply knowledge creatively as mathematicians.
frontpage-text-about-desmos-studio-pbc = Desmos Studio is a Public Benefit Corporation with a goal of helping everyone learn math, love math, and grow with math. We believe that everyone has an inner mathematician and that some people haven\u2019t been given the opportunity, encouragement, or tools to discover theirs. So we prioritize <1>equity</1> and <2>accessibility</2> at every level of our work.
frontpage-text-about-math-tools = Our free suite of math tools, including our Graphing Calculator, is used annually by over 75 million people around the world. Those tools help people represent their ideas mathematically, connect different representations dynamically, make conjectures, and then develop entirely new ideas. They also result in some <1>pretty spectacular art</1>{"."}
frontpage-text-about-partners = We partner with the world's most popular curricula and learning software, and with <1>the majority of U.S. state-level assessments and digital college entrance exams</1>{"."}
frontpage-text-about-studio-join-us = Want to learn more? <1>Play with the calculator</1>, connect with us on <2>Twitter</2>, or find a <3>career with Desmos Studio</3>!
frontpage-text-art-contest-3rd-annual = 3rd Annual Global Math Art Contest
frontpage-text-art-contest-certificate-of-participation = Certificate of Participation
frontpage-text-art-contest-couldnt-find-certificate = We're having trouble finding a submission for the associated with this email address ({ $email }). Try reloading the page or signing in with another account?
frontpage-text-art-contest-date-of-issue = Date of Issue
frontpage-text-art-contest-enter = Learn more about Desmos's Global Art Contest 2021
frontpage-text-art-contest-featured-graph = Featured Graph, { $age }
frontpage-text-art-contest-finalist-title = \u201C{ $graphTitle }\u201D by { $name }
frontpage-text-art-contest-globe-alt-text = Illustration of Earth with a red ribbon around it.
frontpage-text-art-contest-name-and-country = by { $name }, { $country }
frontpage-text-art-contest-page-description-2020 = Desmos's first Global Math Art Contest in 2020 featured over 4,000 graphs from over 100 countries around the world. Here are the winners and finalists, chosen from countless examples of incredible effort, artistry, ingenuity, and creativity.
frontpage-text-art-contest-page-description-2021 = More than 10,000 students from around the world participated in the second annual Global Math Art Contest! Here are the winners and finalists, chosen from countless examples of incredible effort, artistry, ingenuity, and creativity.
frontpage-text-art-contest-page-description-2022 = For our 3rd annual art contest, we decided it was too hard to choose winners from the thousands of amazing graphs submitted in each age category. So we picked 20 to feature from each! Browse these graphs below, and click on any of them to learn more.
frontpage-text-art-contest-please-log-in-for-certificate = Please log in to see your Certificate of Participation.
frontpage-text-braille-examples-calculator-information = Use a Braille display? You can read and write equations in the <1>Four-Function</1> <2>(www.desmos.com/fourfunction)</2>, <3>Scientific</3> <4>(www.desmos.com/scientific)</4>, and <5>Graphing</5> <6>(www.desmos.com/calculator)</6> calculators as well as <7>classroom activities</7> <8>(teacher.desmos.com)</8> using the two most common mathematical Braille codes in North America: Nemeth and Unified English Braille (UEB).
frontpage-text-braille-examples-page-screen-reader-information = Your screen reader should be set for Computer Braille input and output to minimize the risk of translation errors. Check out <1>the help center accessibility page.</1> for more information about using Braille in the Desmos calculators.
frontpage-text-description-about = Desmos is a math ed tech company building calculators, digital classroom tools, math activities, and curriculum for classrooms around the world.
frontpage-text-description-art-contest = The Desmos Math Art Contest is open yearly to students ages 13\u2060\u2013\u206018 to showcase their graphing calculator skills, creativity, and love of math.
frontpage-text-description-equity = Our goal is to support the development of a more equitable math education system and tech industry. We use these principles as our guide.
frontpage-text-description-frontpage = Desmos offers best-in-class calculators, digital math activities, and curriculum to help every student love math and love learning math.
frontpage-text-description-guiding-principles = We have five Guiding Principles. These principles help us make tough decisions. They provide accountability for the outcomes of those decisions. And they help other people make decisions about us, by representing our values to people and organizations who are deciding if we\u2019d be good partners in their work.
frontpage-text-description-team = Our team works across 7 time zones, 2 hemispheres, and 18 states with 1 goal: to help every student learn math and love learning math.
frontpage-text-equity-as-a-us-based-team = As a primarily U.S.-based team, our focus for applying these principles has typically centered on injustices within our country. However, as our team, community of users, and partnerships continue to expand internationally, we seek to learn how we can apply these principles to strive for equitable math education worldwide.
frontpage-text-equity-everyone-understands = Our workplace should be one where everyone understands how they contribute to the company\u2019s mission and feels valued in their contribution. If we don\u2019t intentionally foster diversity and inclusion internally, we remain a part of the broader systemic inequities driving the need for these principles. Equally important, having a diverse group of colleagues is essential to serving a diverse external community. To do this, we must critically examine and address bias in our own processes and interactions.
frontpage-text-equity-goal-more-equitable-math-education-system = Our goal is to support the development of a more equitable math education system and tech industry. We use these principles as guides towards achieving this goal.
frontpage-text-equity-gratitude = We also want to express our gratitude to the many folks who have influenced and pushed our thinking in this area, especially but certainly not limited to <1>Lauren Baucom</1>, <2>Christelle Rocha</2>, <3>Ayanna Perry</3>, and Rochelle Gutierrez.
frontpage-text-equity-how-can-we-measure-impact = How can we measure the impact of our work on communities we aim to serve?
frontpage-text-equity-how-can-we-uphold-values = How can we uphold our values when selecting partners and services?
frontpage-text-equity-how-might-we-attend-to-safety = How might we attend to the mental, emotional, and physical safety of our employees?
frontpage-text-equity-how-might-we-continue-to-prioritize-equity = How might we continue to prioritize a drive for equity as our company changes over time?
frontpage-text-equity-how-might-we-examine-biases = How might we examine and reduce our individual biases?
frontpage-text-equity-how-might-we-share-our-thinking = How might we share our current thinking and get feedback?
frontpage-text-equity-how-might-we-support-access = How might we support the ACCESS and ACHIEVEMENT of the communities we serve?
frontpage-text-equity-how-might-we-support-identity = How might we support the IDENTITY and POWER of the communities we serve?
frontpage-text-equity-how-might-we-sustain-ourselves = How might we sustain ourselves in our day-to-day work?
frontpage-text-equity-how-might-work-disrupt-white-supremacy = How might our work disrupt white supremacy and the oppressive results of dominant culture?
frontpage-text-equity-how-will-it-help = How might this work help the communities we aim to serve? How might it harm these communities?
frontpage-text-equity-on-a-mission = We're on a mission to help every student learn math and love learning math. To achieve our mission, we must acknowledge past and present injustices in our communities and take intentional action to make change.
frontpage-text-equity-tag-or-email = We would love to hear ways these principles may be underdeveloped or ways in which these principles shifted your thinking. If you want to respond publicly, tag us <1>@desmos</1>{"."} If you want to respond privately, feel free to email <2>equity@desmos.com</2>{"."}
frontpage-text-equity-we-have-a-responsibility = We have a responsibility to continuously learn about how systemic inequity is embedded in education and to use this knowledge to drive our decision-making. As we learn and put our learning into practice, we share our work with the hope that others will listen, learn, and push us further.
frontpage-text-equity-we-recognize-creating-adopting = We recognize that creating and adopting a set of equity principles is just one foundational step that helps us orient the work that comes next. We are also aware that our team members\u2019 identities, experiences, and biases limit our ability to help every student or to see ways in which our systems and structures bias some groups over others.
frontpage-text-equity-what-voices-can-we-amplify = What underrepresented voices can we learn from and amplify?
frontpage-text-equity-which-communities-to-learn-from = Which communities do we need to learn from and serve?
frontpage-text-equity-who-serves-harms = Who might each internal process serve? Who might this process harm?
frontpage-text-equity-without-taking-intentional-steps = Without taking intentional steps, our work will not serve all groups well. Therefore, we must focus on identifying and attending to the needs of marginalized and excluded communities. This means learning from and with these teachers and students, and using their needs to shape our work and measure our success.
frontpage-text-footer-copyright-studio = Copyright { $copyrightSign } { $year } Desmos Studio, PBC
frontpage-text-global-thank-you = We were amazed going through all of the incredible graphs. We hope that you had as much fun being a part of the contest as we had running it. If you want to, you can:
frontpage-text-guiding-building-for-real-classrooms = Building for real classrooms requires listening to teachers and striving to understand the operations of their classrooms\u2014the features that make whole-group or small-group discussions <1>successful</1>, for example, or the way unreliable technology can ruin a lesson. Building for real classrooms also requires us to understand the inequities in the way schools are resourced. Knowing that many students and teachers operate with limited devices and connectivity motivates our team to prioritize building performant, low-bandwidth systems.
frontpage-text-guiding-footnote-danny-martin = <1>1</1> <2>Danny Martin</2>, for example, entreats us to consider the brilliance of Black children as an axiom, a statement that is self-evidently true.
frontpage-text-guiding-honor-students-brilliance = Honor Students' Brilliance
frontpage-text-guiding-once-students-realize = Once students realize we are encouraging their agency and creativity, we hope they will seek delight in every corner of our work. Therefore, we're constantly redesigning for delight and updating to respond to all the student creativity we didn\u2019t anticipate.
frontpage-text-guiding-principles-gratitude = All errors in this document are our own, but we are particularly grateful to Desmos Fellows <1>Lauren Baucom</1> and <2>Christelle Rocha</2> for their feedback on earlier drafts of these principles.
frontpage-text-guiding-principles-introduction = We have five Guiding Principles. These principles help us make tough decisions, and provide accountability for the outcomes of those decisions. And they help other people make decisions about us by representing our values to the people and organizations who are deciding if we\u2019d be good partners in their work.
frontpage-text-guiding-remove-barriers = We also try to remove barriers that might prevent certain students from showcasing their brilliance by focusing on equity in our business models and accessibility in our products.
frontpage-text-guiding-so-we-champion = So we champion teachers. We start by listening and learning from and with teachers and researchers. We ask how we can best support each stage of a teacher\u2019s career. We also work to oppose any effort to devalue or deprofessionalize teaching.
frontpage-text-guiding-there-are-a-number = There are a number of reasons that a product might not \u201Cwork\u201D for a user. It could just break, as technology so often does. It could be confusing for a subset of users, perhaps those who are less confident using technology. It could be that someone uses it in a way that we didn\u2019t anticipate. Whatever the reason, even a product that works 99% of the time will interrupt the learning in 1 of 3 classrooms. As a result, we prioritize reliability and usability, even at the expense of development speed. We strive for backwards compatibility, and still open graphs made in the first week of our calculator\u2019s launch. We also aim to design software and lessons that work for a wide variety of inputs. We believe that it\u2019s not our job to enforce rigid syntax, but rather to interpret, as well as we can, anything a user does.
frontpage-text-guiding-to-honor-students = To honor students\u2019 brilliance, we must first create opportunities for students to express their brilliance. We design tools and lessons that invite creativity and welcome multiple approaches. We build features to help teachers showcase student thinking, for example with our <1>dashboard tools</1> that support the <2>5 Practices</2>{"."} We seek to provide meaningful <3>task-oriented</3> feedback on students\u2019 thinking.
frontpage-text-guiding-to-support-real-students = To support real students and real teachers, we need to design for their real and disparate environments.
frontpage-text-guiding-we-are-not-uncritical = We are not uncritical or passive champions. We recognize that teachers can both help and harm. We instead consider ourselves partners, supporters, and advocates in the critical work of building joyful classrooms and honoring the brilliance of every student. Excellence in teaching takes years of training and practice, and supporting such excellence is one of our most powerful levers for achieving our goals.
frontpage-text-guiding-we-believe-that-students = We believe that students are creative, knowledgeable, and brilliant. We recognize that students in math classes are not always treated as such, and that students of certain genders, races, or backgrounds are disproportionately affected.
frontpage-text-guiding-we-cant-enact = We can't enact any of our principles without teachers. We believe that teachers are\u2014and should remain\u2014an integral part of the learning process, and we know that they wield enormous power in their students\u2019 learning experiences.
frontpage-text-guiding-we-know-that-software = We know that software will inevitably break or students will do things we don\u2019t anticipate. We believe that reliability doesn't come from avoiding every possible way something can go wrong, but from reacting quickly, carefully, and <1>blamelessly</1> when it does.
frontpage-text-guiding-we-prioritize-delight = We prioritize delight in our products even at the cost of development time. We would rather release a delightful product or lesson tomorrow than an adequate one today. We aim for delight not just in the user experience but in the learning experience as well. For example, students experience joy in "<1>being the cause</1>," so we try to create tools and lessons that respond to their interesting thinking. We relish surprises from students and try to surprise them in turn by coming along as they go off trail.
frontpage-text-guiding-we-reject-the-idea = We reject the idea that these students are more or less capable and recognize that we must learn from and with marginalized and excluded communities<1>1</1> in order to counter these narratives.
frontpage-text-guiding-we-want-to-help = We want to help all students learn math, but we see little value in their learning math if they don't also find something to <1>love</1> about math as well.
frontpage-text-header-app-links = Download our apps in the <1>Google Play Store</1> and <2>iOS App Store</2>{"."}
frontpage-text-main-interactive-and-creative-activities = Interactive and creative activities for your math class.
frontpage-text-main-join-your-classmates = Join your classmates!
frontpage-text-main-on-a-mission = We're on a mission to help every student learn math and love learning math.
frontpage-text-main-partners-benefits = As a partner of Desmos Studio PBC, you benefit from our continual work to make Desmos Tools more powerful, faster, and easier to use. We release a new version of the API annually in April as a free upgrade for all of our partners. <1>Read our Changelog</1>{"."}
frontpage-text-main-partners-information = Our tools power <1>assessments</1> and major curricula. <2>Learn more</2>
frontpage-text-partners-accessible-api = We believe everyone deserves access to powerful math tools, including those who are blind or visually impaired. Desmos's API is WCAG 2.1 compliant at the AA level. We support fully blind users by converting graphs to sound and connecting with screen readers. <1>Learn More</1>{"."}
frontpage-text-partners-desmos-opening-paragraph = Partner with us to embed the power of Desmos Tools right into your platform, website, or app! Desmos Tools (Graphing, Scientific, Four Function, and Matrix calculators) are available for partners with the Desmos API.
frontpage-text-partners-desmos-runs-on-modern-browser = Desmos Tools run on any modern browser with no downloads or installs. We also run seamlessly on iPhones, iPads, Android phones and tablets, Chromebooks, and Windows touch devices. We've seen just about every combination. We make sure our software runs on any modern browser, in nearly any configuration.
frontpage-text-partners-desmos-used-by-millions = Desmos is used by millions of students and teachers in nearly every country in the world and has been translated into 30 languages.
frontpage-text-partners-desmos-used-by-millions = Desmos Tools are used by millions of people globally, and are translated into a <1>variety of languages</1>{"."}
frontpage-text-partners-uptime = One of the Desmos Studio values is "Works every time." This extends to the Desmos API. With greater than 99.99% uptime over the last 3 years, Desmos Tools provide the reliability your app or website needs. Better yet, we\u2019ll deliver regular library builds that you can host on your own infrastructure.
frontpage-text-team-about-us = Our team works across 7 time zones, 2 hemispheres, and 18 states with 1 goal: to help every student learn math and love learning math. Want to join us? <1>We're hiring!</1>
frontpage-text-testmod-administer-test = <1>To administer a Secure Test:</1><2><3>Have students pin the app.</3><4>Tell the students not unpin the app.</4><5>At the end of the test, confirm that the screen was pinned for the entire test by checking the in-app clock.</5></2>
frontpage-text-testmod-feedback = We work to continuously improve our Test Mode apps, and we welcome your feedback on how we can support the best possible experience for your students and colleagues. Please email us at <1>feedback@desmos.com</1> with any questions or comments!
frontpage-text-testmode-android = Our <1>Android app</1> (currently in Beta testing) allows for offline practice.
frontpage-text-testmode-app-self-lock-mode-colors = While in App Self-Lock mode, the top bar of the calculator will change color according to the calculator in use: green for graphing, purple for scientific, blue for four function. There will also be a badge next to the Desmos logo.
frontpage-text-testmode-chromebooks = Our Chrome app allows for offline practice. You can download the Chrome app by visiting <1>bit.ly/desmos-test-mode-chrome-app</1> on the device. The <2>Chrome browser</2> must be installed on the device to use the Chrome Test Mode app.
frontpage-text-testmode-enable-guided-access = <1>To enable Guided Access:</1><2><3>Go to Settings > General > Accessibility > Guided Access.</3><4>Pick a passcode that needs to be entered.</4><5>Open up the Test Mode app.</5><6>Triple-click the Side or Home button.</6></2><7>This will lock the device to that app and won't allow the student to leave it without a code.</7>
frontpage-text-testmode-enable-screen-pinning = <1>To enter Screen Pinning:</1><2><3>Disable WiFi on your phone.</3><4>Enter Airplane Mode on your phone.</4><5>A "Start Test" button will appear. Click it.</5></2>
frontpage-text-testmode-exit-guided-access = <1>To exit Guided Access:</1><2><3>Triple-click the Side or Home button.</3><4>Enter the passcode that you chose.</4></2>
frontpage-text-testmode-four-function-calculator-app-self-lock-mode-caption = Four function calculator in App Self-Lock mode with a blue top bar.
frontpage-text-testmode-four-function-calculator-blue-top-bar = The secure four function calculator has a blue top bar.
frontpage-text-testmode-four-function-calculator-caption = Four function calculator in kiosk mode with a blue top bar.
frontpage-text-testmode-graphing-calculator-app-self-lock-mode-caption = Graphing calculator in App Self-Lock mode with a green top bar.
frontpage-text-testmode-graphing-calculator-kiosk-mode-caption = Graphing calculator in kiosk mode with a green top bar.
frontpage-text-testmode-guided-access = For additional security, you can lock the student into the app using <1>Guided Access</1>{"."}
frontpage-text-testmode-ipads-and-iphones = Our <1>iPad and iPhone app</1> allows for offline practice. The app also supports additional levels of security.
frontpage-text-testmode-kiosk-mode = Kiosk mode provides an extra level of security by preventing other apps from being used while the calculator is open. Students will be locked into the calculator configuration they choose before pressing "Start Test". Before you sign in, click \u201CApps\u201D on the bottom bar and then select Desmos Test Mode. To exit kiosk mode, turn the Chromebook off.
frontpage-text-testmode-kiosk-mode-colors = While in kiosk mode, the top bar of the calculator will change color according to the calculator in use: green for graphing, purple for scientific, blue for four function. There will also be a badge next to the Desmos logo.
frontpage-text-testmode-levels-of-security = This page describes the various levels of security available through our apps, along with instructions for installation and usage.
frontpage-text-testmode-low-stakes-assessments = Each app lets you administer low-stakes, proctored assessments with security features to help enforce your school's or classroom's policies.
frontpage-text-testmode-partners = Desmos partners with high-stakes test providers in <1>over 35 states and on several national and international exams</1> to provide access to our calculators on testing day.
frontpage-text-testmode-practice = Students can practice using the calculators on our <1>Practice Page</1>{"."} We also provide free apps for <2>Chromebooks,</2> <3>iPads, and iPhones</3> to support practice.
frontpage-text-testmode-practice-apps-match-test-day = Our practice apps match the configuration that students will encounter on test day. Students can practice for a specific assessment by selecting "Choose Assessment" on the opening screen.
frontpage-text-testmode-scientific-calculator-app-self-lock-mode-caption = Scientific calculator in App Self-Lock mode with a purple top bar.
frontpage-text-testmode-scientific-calculator-caption = Scientific calculator in kiosk mode with a purple top bar.
frontpage-text-testmode-scientific-calculator-purple-top-bar = The secure scientific calculator has a purple top bar.
frontpage-text-testmode-screen-pinning-mode = Screen Pinning mode provides an extra level of security by preventing other apps from being used while the calculator is open.
frontpage-text-testmode-secure-graphing-calculator-green-top-bar = The secure graphing calculator has a green top bar.
frontpage-text-testmode-students-can-leave-app-self-lock-mode = Please note that students can leave App Self-Lock by clicking "I'm Done" before the end of the test. You can monitor appropriate usage by looking at the log at the conclusion of the test. It will show how long the student was continuously in the application.
frontpage-text-testmode-students-can-leave-chromebook-app = Please note that students can leave the app by powering down their Chromebook and restarting it. You can monitor appropriate usage by looking at the log at the conclusion of the test. It will show how long the student was continuously in the application.
frontpage-text-testmode-students-can-opt-into-app-self-lock = Students can opt into App Self-Lock by pressing the "Start Test" button. While in App Self-Lock, students will be locked into the calculator they selected before pressing "Start Test". They will not be able to switch calculators nor leave the app until they leave App Self-Lock.
frontpage-text-testmode-to-help-teachers-and-students-prepare = To help students and teachers prepare for assessments, and to support ongoing instruction and formative assessment needs, Desmos has developed a suite of Test Mode apps.
practice-button-sc-info-pdf = { $stateName } PDF
practice-button-state-info-pdf = { $stateName } Information PDF
practice-heading-is-desmos-on-test = Is Desmos on your test?
practice-heading-national-international-assessments = National and International Assessments
practice-heading-practice = Practice
practice-heading-privacy = Privacy
practice-heading-questions-and-feedback = Additional Questions and Feedback
practice-heading-state-assessments = State Assessments
practice-heading-title-test-mode = Test Mode
practice-heading-title-testing = Testing
practice-label-desmos-on-test = Desmos is on the test!
practice-label-desmos-on-test-apply-nysed = Apply to NYSED to use Desmos!
practice-label-desmos-on-test-partial = Desmos can be used on the test
practice-label-desmos-on-tests = Desmos is on the tests!
practice-label-ib-middle-years = International Baccalaureate\xAE (IB) Middle Years Programme (MYP)
practice-label-nwea-map-growth = NWEA MAP\xAE Growth\u2122
practice-label-sample = Sample
practice-label-sbac = Smarter Balanced
practice-label-state-test = State Test:
practice-label-state-tests = State Tests:
practice-label-states-ak-four-function-grades = Grades 5, 8 (Science)
practice-label-states-ak-graphing-grades = Grade 9 (Math)
practice-label-states-ak-scientific-grades = Grades 6-9 (Math), Grade 10 (Science)
practice-label-states-al-four-function-grades = Grades 6-8 (Math), Grade 8 (Science)
practice-label-states-al-scientific-grades = Grades 6-8 (Math), Grade 8 (Science)
practice-label-states-az-four-function-grades = Grade 5 (Science)
practice-label-states-az-graphing-grades = High School Math
practice-label-states-az-scientific-grades = Grade 7-8 (Math), 8 & High School (Sci)
practice-label-states-ca-four-function-grades = Grade 6 (Math), Grade 5 (Science)
practice-label-states-ca-graphing-grades = Grade 11 (Math)
practice-label-states-ca-scientific-grades = Grades 7-8 (Math), Grade 8, High School (Science)
practice-label-states-ct-four-function-grades = Grade 6 (Math) Grade 5 (Sci)
practice-label-states-ct-graphing-grades = High School
practice-label-states-ct-scientific-grades = Grades 7-8 (Math), Grade 8 (Sci)
practice-label-states-de-four-function-grades = Grade 6
practice-label-states-de-graphing-grades = High School
practice-label-states-de-scientific-grades = Grades 7-8
practice-label-states-fl-scientific-grades = Grades 7-8
practice-label-states-ga-four-function-grades = Grades 6-7
practice-label-states-ga-graphing-grades = Grade 8 & High School
practice-label-states-ga-scientific-grades = Grades 6-8 & High School
practice-label-states-hi-four-function-grades = Grade 6 (Math), Grade 5 (Science)
practice-label-states-hi-graphing-grades = Grade 11 (Math, Biology)
practice-label-states-hi-scientific-grades = Grades 7-8 (Math), Grade 8 (Science)
practice-label-states-ia-four-function-grades = Grades 3-6 (Mathematics), Grade 5 (Science)
practice-label-states-ia-scientific-grades = Grades 7-11 (Mathematics), Grades 8 & 10 (Science)
practice-label-states-id-four-function-grades = Grade 6 (Math), Grade 5 (Science)
practice-label-states-id-graphing-grades = Grade 11 (Math), High School (Science)
practice-label-states-id-scientific-grades = Grades 7-8 (Math), Grade 8 (Science)
practice-label-states-in-four-function-grades = Grade 6 (Math) Grades 4, 6 (Sci), I AM
practice-label-states-in-graphing-grades = High School (SAT Math)
practice-label-states-in-scientific-grades = Grades 7-8 (Math), Biology
practice-label-states-ky-four-function-grades = High School (Mathematics)
practice-label-states-ky-graphing-grades = High School (Mathematics and Science)
practice-label-states-ky-scientific-grades = High School (Mathematics)
practice-label-states-la-graphing-grades = High School
practice-label-states-ma-graphing-grades = Grades 8 & 10 (Mathematics)
practice-label-states-ma-scientific-grades = High School (Introductory Physics)
practice-label-states-md-four-function-grades = Grade 5 (Science), Grades 3-7 (Mathematics)
practice-label-states-md-graphing-grades = High School (Mathematics)
practice-label-states-md-scientific-grades = Grade 8 (Mathematics), Grade 8 (Science)
practice-label-states-mi-four-function-grades = Grade 6
practice-label-states-mi-scientific-grades = Grade 7
practice-label-states-mo-four-function-grades = Grades 6-8 (Mathematics), Grade 5 & 8 (Science)
practice-label-states-mo-graphing-grades = Grades 6-8 (Mathematics), Algebra I, Algebra II, Geometry, Grade 8 (Science), Physical Science, and Biology
practice-label-states-mo-scientific-grades = Grades 6-8 (Mathematics), Grade 8 (Science)
practice-label-states-ms-graphing-grades = Algebra 1
practice-label-states-mt-four-function-grades = Grade 6 (Math), Grade 5 (Science)
practice-label-states-mt-graphing-grades = Grade 11 (Math)
practice-label-states-mt-scientific-grades = Grades 7-8 (Math), Grade 8 (Science)
practice-label-states-nc-four-function-grades = Grades 3-5
practice-label-states-nc-graphing-grades = Grade 8, Math 1, and above
practice-label-states-nc-scientific-grades = Grades 6-8
practice-label-states-nd-four-function-grades = Grade 6 (Math), Grade 4 (Science)
practice-label-states-nd-graphing-grades = Grade 10 (Math, Science)
practice-label-states-nd-scientific-grades = Grades 7-8 (Math) Grades8 (Science)
practice-label-states-ne-four-function-grades = Grade 6
practice-label-states-ne-scientific-grades = Grades 7-8 (Math), Biology
practice-label-states-nh-graphing-grades = High School (Math)
practice-label-states-nh-scientific-grades = Grades 6-8 (Math) Grades 5, 8, High School (Science)
practice-label-states-nv-four-function-grades = Grade 5 (Science), Grade 6 (Mathematics)
practice-label-states-nv-scientific-grades = Grades 7-8 (Mathematics), Grade 8, High School (Science)
practice-label-states-ny-graphing-grades = High School (Mathematics)
practice-label-states-oh-graphing-grades = High School
practice-label-states-oh-scientific-grades = Grades 3-8
practice-label-states-or-four-function-grades = Grade 6 (Math), Grade 5 (Science)
practice-label-states-or-graphing-grades = Grade 11 (Math, Science)
practice-label-states-or-scientific-grades = Grades 7-8 (Math), Grade 8 (Science)
practice-label-states-pa-four-function-grades = Mathematics (Grades 4-8, Algebra 1), Science (Grades 4 and 8, Biology, CDT)
practice-label-states-pa-graphing-grades = Mathematics (Algebra I, CDT)
practice-label-states-pa-scientific-grades = Mathematics (Grades 6-8), Science (Grade 8, Biology, CDT)
practice-label-states-ri-graphing-grades = Grade 8 (Mathematics), Grade 11 (Science)
practice-label-states-sc-alt-four-function-grades = Grade 6, Alternate Assessments
practice-label-states-sc-alt-scientific-grades = Grades 7, 8, 11, Alternate Assessments
practice-label-states-sc-std-four-function-grades = Grades 6 (Math, Science)
practice-label-states-sc-std-graphing-grades = Grades 7-8 (Math), Algebra 1, Biology
practice-label-states-sc-std-scientific-grades = Grades 6 (Math, Science), 7-8 (Math), Algebra 1, Biology
practice-label-states-sd-four-function-grades = Grade 6 (Math), Grade 5 (Science)
practice-label-states-sd-graphing-grades = Grade 11 (Math), High School (Science)
practice-label-states-sd-scientific-grades = Grades 7-8 (Math), Grade 8 (Science)
practice-label-states-tn-graphing-grades = Algebra I\u2013II, Geometry, Integrated Math I\u2013III, and Biology
practice-label-states-tn-scientific-grades = Grades 6-8 (Math and Science)
practice-label-states-tx-four-function-grades = Grade 8 Science, Biology
practice-label-states-tx-graphing-grades = Grade 8 Science, Biology, Grade 8 Math, Algebra 1, Algebra 2
practice-label-states-tx-scientific-grades = Grade 8 Science, Biology
practice-label-states-ut-graphing-grades = Grades 9-10 (Mathematics)
practice-label-states-ut-scientific-grades = Grades 9-10 (Science)
practice-label-states-va-four-function-grades = Grades 4-5
practice-label-states-va-graphing-grades = High School
practice-label-states-va-scientific-grades = Grades 6-8
practice-label-states-vi-four-function-grades = Grade 6
practice-label-states-vi-graphing-grades = Grades 10-11
practice-label-states-vi-scientific-grades = Grades 7-8
practice-label-states-vt-four-function-grades = Grade 6 (Math), Grade 5 (Science)
practice-label-states-vt-graphing-grades = High School (Math, Science)
practice-label-states-vt-scientific-grades = Grades 7-8 (Math), Grade 8 (Science)
practice-label-states-wa-four-function-grades = Grade 6 (Math), Grade 5 (Science)
practice-label-states-wa-graphing-grades = Grade 11 (Math), Grade 8, High School (Science)
practice-label-states-wa-scientific-grades = Grades 7-8 (Math)
practice-label-states-wv-four-function-grades = Grade 6
practice-label-states-wv-graphing-grades = High School
practice-label-states-wv-scientific-grades = Grades 7-8
practice-label-states-wy-four-function-grades = Grade 6
practice-label-states-wy-graphing-grades = High School
practice-label-states-wy-scientific-grades = Grades 7-8
practice-link-four-function = Four Function Calculator
practice-link-graphing = Graphing Calculator
practice-link-scientific = Scientific Calculator
practice-narration-close-details = Close Details About { $stateName }
practice-text-accessibility-information = Desmos is committed to helping every student love learning math. We are proud to say that the Desmos calculators are <1>WCAG 2.1 AA compliant. </1>The accessibility improvements we've made ensure students who are blind or visually impaired have the same opportunities as their peers to discover the joy of learning math. Please read more about this at <2>www.desmos.com/accessibility</2>{"."}
practice-text-calculator-note = These calculators differ from the ones on our site. You can find more information in the PDF.
practice-text-data-privacy = Additional rules apply for data privacy when dealing with children under 13. The <1>Four-Function</1> and <2>Scientific</2> calculators, which will be used by students under the age of 13, never request student data as there is no way to log in.
practice-text-description-test-mode = Learn how to configure Test Mode to use Desmos calculators on assessments.
practice-text-description-testing = Is Desmos on your test? Find out if the Desmos calculators are on your state assessments.
practice-text-different-calculators-ib = Please note that these calculators differ from the ones on our site. You can find more information in <1>our overview PDF</1>{"."} Students can practice on the sample <2>Scientific Calculator</2>{"."}
practice-text-different-calculators-nwea = Please note that these calculators differ from the ones on our site. You can find more information in <1>our overview PDF</1>{"."} Students can practice on the sample <2>Four Function</2> or <3>Scientific Calculator</3>{"."}
practice-text-different-calculators-sbac = Desmos calculators are available on Smarter Balanced assessments. Please note that these calculators differ from the standard ones on our site. Students who reside in a Smarter Balanced member state or U.S. territory can practice with the calculators configured for specific test settings available below.
practice-text-more-information = Interested in learning more about Desmos calculator found on your state or national assessment? Check out our <1>professional learning and development offerings</1>{"."}
practice-text-national-international-assessments = Desmos is now available on national and international assessments! These assessments include:
practice-text-practice-information = To help students and teachers prepare for assessments, and to support ongoing instruction and formative assessment needs, Desmos has developed a suite of Test Mode apps. Our practice apps match the configuration that students will encounter on test day. You can learn more at <1>www.desmos.com/test-mode</1>{"."}
practice-text-privacy = During test administrations, Desmos will not receive any data about students. Vendors will host the Desmos technology directly on their servers and will not exchange any data with Desmos's servers. Furthermore, students do not need to sign in or provide any personal information about themselves to be able to practice with Desmos calculators before the test.
practice-text-questions = We know this change may prompt additional questions from teachers, parents, and administrators. Please don't hesitate to email questions or feedback to <1>support@desmos.com</1>{"."}
practice-text-state-assessments = Desmos is also available on a range of state assessments! Find your state below to learn more.
practice-text-state-not-listed = If Desmos isn't on your state assessment yet, and you're interested in changing that, <1>please let us know!</1>
practice-text-students-create-accounts = While practicing for the test, some 11th-grade students using <1>desmos.com/calculator</1> may choose to create accounts to be able to save work for a later time. We encourage everyone to review the <2>Desmos Privacy Policy</2>, which describes what information we collect from these users who are over the age of 13 and what we do with that information.
`;var Th=class{constructor(e){this.value=e}valueOf(){return this.value}},fn=class extends Th{constructor(e="???"){super(e)}toString(e){return`{${this.value}}`}},Na=class extends Th{constructor(e,r={}){super(e),this.opts=r}toString(e){try{return e.memoizeIntlObject(Intl.NumberFormat,this.opts).format(this.value)}catch(r){return e.reportError(r),this.value.toString(10)}}},Td=class extends Th{constructor(e,r={}){super(e),this.opts=r}toString(e){try{return e.memoizeIntlObject(Intl.DateTimeFormat,this.opts).format(this.value)}catch(r){return e.reportError(r),new Date(this.value).toISOString()}}};var jL=100,s8="\u2068",a8="\u2069";function l8(t,e,r){if(r===e||r instanceof Na&&e instanceof Na&&r.value===e.value)return!0;if(e instanceof Na&&typeof r=="string"){let i=t.memoizeIntlObject(Intl.PluralRules,e.opts).select(e.value);if(r===i)return!0}return!1}function JL(t,e,r){return e[r]?rg(t,e[r].value):(t.reportError(new RangeError("No default")),new fn)}function CV(t,e){let r=[],i=Object.create(null);for(let n of e)n.type==="narg"?i[n.name]=Hf(t,n.value):r.push(Hf(t,n));return{positional:r,named:i}}function Hf(t,e){switch(e.type){case"str":return e.value;case"num":return new Na(e.value,{minimumFractionDigits:e.precision});case"var":return c8(t,e);case"mesg":return d8(t,e);case"term":return h8(t,e);case"func":return p8(t,e);case"select":return u8(t,e);default:return new fn}}function c8(t,{name:e}){let r;if(t.params)if(Object.prototype.hasOwnProperty.call(t.params,e))r=t.params[e];else return new fn(`$${e}`);else if(t.args&&Object.prototype.hasOwnProperty.call(t.args,e))r=t.args[e];else return t.reportError(new ReferenceError(`Unknown variable: $${e}`)),new fn(`$${e}`);if(r instanceof Th)return r;switch(typeof r){case"string":return r;case"number":return new Na(r);case"object":if(r instanceof Date)return new Td(r.getTime());default:return t.reportError(new TypeError(`Variable type not supported: $${e}, ${typeof r}`)),new fn(`$${e}`)}}function d8(t,{name:e,attr:r}){let i=t.bundle._messages.get(e);if(!i)return t.reportError(new ReferenceError(`Unknown message: ${e}`)),new fn(e);if(r){let n=i.attributes[r];return n?rg(t,n):(t.reportError(new ReferenceError(`Unknown attribute: ${r}`)),new fn(`${e}.${r}`))}return i.value?rg(t,i.value):(t.reportError(new ReferenceError(`No value: ${e}`)),new fn(e))}function h8(t,{name:e,attr:r,args:i}){let n=`-${e}`,o=t.bundle._terms.get(n);if(!o)return t.reportError(new ReferenceError(`Unknown term: ${n}`)),new fn(n);if(r){let a=o.attributes[r];if(a){t.params=CV(t,i).named;let l=rg(t,a);return t.params=null,l}return t.reportError(new ReferenceError(`Unknown attribute: ${r}`)),new fn(`${n}.${r}`)}t.params=CV(t,i).named;let s=rg(t,o.value);return t.params=null,s}function p8(t,{name:e,args:r}){let i=t.bundle._functions[e];if(!i)return t.reportError(new ReferenceError(`Unknown function: ${e}()`)),new fn(`${e}()`);if(typeof i!="function")return t.reportError(new TypeError(`Function ${e}() is not callable`)),new fn(`${e}()`);try{let n=CV(t,r);return i(n.positional,n.named)}catch(n){return t.reportError(n),new fn(`${e}()`)}}function u8(t,{selector:e,variants:r,star:i}){let n=Hf(t,e);if(n instanceof fn)return JL(t,r,i);for(let o of r){let s=Hf(t,o.key);if(l8(t,n,s))return rg(t,o.value)}return JL(t,r,i)}function DV(t,e){if(t.dirty.has(e))return t.reportError(new RangeError("Cyclic reference")),new fn;t.dirty.add(e);let r=[],i=t.bundle._useIsolating&&e.length>1;for(let n of e){if(typeof n=="string"){r.push(t.bundle._transform(n));continue}if(t.placeables++,t.placeables>jL)throw t.dirty.delete(e),new RangeError(`Too many placeables expanded: ${t.placeables}, max allowed is ${jL}`);i&&r.push(s8),r.push(Hf(t,n).toString(t)),i&&r.push(a8)}return t.dirty.delete(e),r.join("")}function rg(t,e){return typeof e=="string"?t.bundle._transform(e):DV(t,e)}var mv=class{constructor(e,r,i){this.dirty=new WeakSet,this.params=null,this.placeables=0,this.bundle=e,this.errors=r,this.args=i}reportError(e){if(!this.errors)throw e;this.errors.push(e)}memoizeIntlObject(e,r){let i=this.bundle._intls.get(e);i||(i={},this.bundle._intls.set(e,i));let n=JSON.stringify(r);return i[n]||(i[n]=new e(this.bundle.locales,r)),i[n]}};function YL(t,e){let r=Object.create(null);for(let[i,n]of Object.entries(t))e.includes(i)&&(r[i]=n.valueOf());return r}var g8=["unitDisplay","currencyDisplay","useGrouping","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits"];function XL(t,e){let r=t[0];if(r instanceof fn)return new fn(`NUMBER(${r.valueOf()})`);if(r instanceof Na||r instanceof Td)return new Na(r.valueOf(),__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['b']({},r.opts),YL(e,g8)));throw new TypeError("Invalid argument to NUMBER")}var m8=["dateStyle","timeStyle","fractionalSecondDigits","dayPeriod","hour12","weekday","era","year","month","day","hour","minute","second","timeZoneName"];function QL(t,e){let r=t[0];if(r instanceof fn)return new fn(`DATETIME(${r.valueOf()})`);if(r instanceof Na||r instanceof Td)return new Td(r.valueOf(),__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['b']({},r.opts),YL(e,m8)));throw new TypeError("Invalid argument to DATETIME")}var zf=class{constructor(e,{functions:r,useIsolating:i=!0,transform:n=o=>o}={}){this._terms=new Map,this._messages=new Map,this._intls=new WeakMap,this.locales=Array.isArray(e)?e:[e],this._functions=__dcg_shared_module_exports__['b']({NUMBER:XL,DATETIME:QL},r),this._useIsolating=i,this._transform=n}hasMessage(e){return this._messages.has(e)}getMessage(e){return this._messages.get(e)}addResource(e,{allowOverrides:r=!1}={}){let i=[];for(let n=0;n<e.body.length;n++){let o=e.body[n];if(o.id.startsWith("-")){if(r===!1&&this._terms.has(o.id)){i.push(new Error(`Attempt to override an existing term: "${o.id}"`));continue}this._terms.set(o.id,o)}else{if(r===!1&&this._messages.has(o.id)){i.push(new Error(`Attempt to override an existing message: "${o.id}"`));continue}this._messages.set(o.id,o)}}return i}formatPattern(e,r=null,i=null){if(typeof e=="string")return this._transform(e);let n=new mv(this,i,r);try{return DV(n,e).toString(n)}catch(o){if(n.errors)return n.errors.push(o),new fn().toString(n);throw o}}};var SV=/^(-?[a-zA-Z][\w-]*) *= */gm,ZL=/\.([a-zA-Z][\w-]*) *= */y,f8=/\*?\[/y,EV=/(-?[0-9]+(?:\.([0-9]+))?)/y,y8=/([a-zA-Z][\w-]*)/y,eP=/([$-])?([a-zA-Z][\w-]*)(?:\.([a-zA-Z][\w-]*))?/y,b8=/^[A-Z][A-Z0-9_-]*$/,fv=/([^{}\n\r]+)/y,w8=/([^\\"\n\r]*)/y,tP=/\\([\\"])/y,rP=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{6})/y,x8=/^\n+/,iP=/ +$/,v8=/ *\r?\n/g,C8=/( *)$/,D8=/{\s*/y,nP=/\s*}/y,S8=/\[\s*/y,E8=/\s*] */y,k8=/\s*\(\s*/y,G8=/\s*->\s*/y,V8=/\s*:\s*/y,I8=/\s*,?\s*/y,M8=/\s+/y,ig=class{constructor(e){this.body=[],SV.lastIndex=0;let r=0;for(;;){let P=SV.exec(e);if(P===null)break;r=SV.lastIndex;try{this.body.push(l(P[1]))}catch(K){if(K instanceof SyntaxError)continue;throw K}}function i(P){return P.lastIndex=r,P.test(e)}function n(P,K){if(e[r]===P)return r++,!0;if(K)throw new K(`Expected ${P}`);return!1}function o(P,K){if(i(P))return r=P.lastIndex,!0;if(K)throw new K(`Expected ${P.toString()}`);return!1}function s(P){P.lastIndex=r;let K=P.exec(e);if(K===null)throw new SyntaxError(`Expected ${P.toString()}`);return r=P.lastIndex,K}function a(P){return s(P)[1]}function l(P){let K=d(),$=c();if(K===null&&Object.keys($).length===0)throw new SyntaxError("Expected message value or attributes");return{id:P,value:K,attributes:$}}function c(){let P=Object.create(null);for(;i(ZL);){let K=a(ZL),$=d();if($===null)throw new SyntaxError("Expected attribute value");P[K]=$}return P}function d(){let P;if(i(fv)&&(P=a(fv)),e[r]==="{"||e[r]==="}")return u(P?[P]:[],1/0);let K=O();return K?P?u([P,K],K.length):(K.value=y(K.value,x8),u([K],K.length)):P?y(P,iP):null}function u(P=[],K){for(;;){if(i(fv)){P.push(a(fv));continue}if(e[r]==="{"){P.push(p());continue}if(e[r]==="}")throw new SyntaxError("Unbalanced closing brace");let R=O();if(R){P.push(R),K=Math.min(K,R.length);continue}break}let $=P.length-1,U=P[$];typeof U=="string"&&(P[$]=y(U,iP));let J=[];for(let R of P)R instanceof yv&&(R=R.value.slice(0,R.value.length-K)),R&&J.push(R);return J}function p(){o(D8,SyntaxError);let P=g();if(o(nP))return P;if(o(G8)){let K=w();return o(nP,SyntaxError),__dcg_shared_module_exports__['b']({type:"select",selector:P},K)}throw new SyntaxError("Unclosed placeable")}function g(){if(e[r]==="{")return p();if(i(eP)){let[,P,K,$=null]=s(eP);if(P==="$")return{type:"var",name:K};if(o(k8)){let U=b();if(P==="-")return{type:"term",name:K,attr:$,args:U};if(b8.test(K))return{type:"func",name:K,args:U};throw new SyntaxError("Function names must be all upper-case")}return P==="-"?{type:"term",name:K,attr:$,args:[]}:{type:"mesg",name:K,attr:$}}return k()}function b(){let P=[];for(;;){switch(e[r]){case")":return r++,P;case void 0:throw new SyntaxError("Unclosed argument list")}P.push(x()),o(I8)}}function x(){let P=g();return P.type!=="mesg"?P:o(V8)?{type:"narg",name:P.name,value:k()}:P}function w(){let P=[],K=0,$;for(;i(f8);){n("*")&&($=K);let U=E(),J=d();if(J===null)throw new SyntaxError("Expected variant value");P[K++]={key:U,value:J}}if(K===0)return null;if($===void 0)throw new SyntaxError("Expected default variant");return{variants:P,star:$}}function E(){o(S8,SyntaxError);let P;return i(EV)?P=S():P={type:"str",value:a(y8)},o(E8,SyntaxError),P}function k(){if(i(EV))return S();if(e[r]==='"')return T();throw new SyntaxError("Invalid expression")}function S(){let[,P,K=""]=s(EV),$=K.length;return{type:"num",value:parseFloat(P),precision:$}}function T(){n('"',SyntaxError);let P="";for(;;){if(P+=a(w8),e[r]==="\\"){P+=V();continue}if(n('"'))return{type:"str",value:P};throw new SyntaxError("Unclosed string literal")}}function V(){if(i(tP))return a(tP);if(i(rP)){let[,P,K]=s(rP),$=parseInt(P||K,16);return $<=55295||57344<=$?String.fromCodePoint($):"\uFFFD"}throw new SyntaxError("Unknown escape sequence")}function O(){let P=r;switch(o(M8),e[r]){case".":case"[":case"*":case"}":case void 0:return!1;case"{":return L(e.slice(P,r))}return e[r-1]===" "?L(e.slice(P,r)):!1}function y(P,K){return P.replace(K,"")}function L(P){let K=P.replace(v8,`
`),$=C8.exec(P)[1].length;return new yv(K,$)}}},yv=class{constructor(e,r){this.value=e,this.length=r}};var A8=["ae","ar","arc","bcc","bqi","ckb","dv","fa","glk","he","ku","mzn","nqo","pnb","ps","sd","ug","ur","yi"],ks=class{constructor(e){this.value=e}},ng=class{constructor(e,r){this.bundles=e;this.onError=r}static fromSources(e,r,i){let n=[];for(let{lang:o,source:s}of e){let a=o.split("-")[0],l=new zf(o,__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},i),{useIsolating:A8.indexOf(a)>=0}));l.addResource(new ig(s),{allowOverrides:!1}),l.addResource(new ig(`
l10n-internal-date-day-month-year = {DATETIME($d, month: "short", day: "numeric", year: "numeric")}
l10n-internal-date-day-month = {DATETIME($d, month: "short", day: "numeric")}
l10n-internal-time = {DATETIME($d, minute: "numeric", hour: "numeric")}
      `),{allowOverrides:!1}),n.push(l)}return new ng(n,r)}format(e,r){for(let i of this.bundles){if(!i.hasMessage(e))continue;let n=i.getMessage(e);if(!(n!=null&&n.value))return;let o=[],s=i.formatPattern(n.value,this.coerceNumericVariables(r),o);for(let a of o)this.onError(`Error formatting ${e} for locale ${i.locales.join(",")}: ${a}`);return s}this.onError(`Couldn't find message for key ${e} for locales ${this.getLocales().join(",")}`)}formatDate(e,r){return r.showYear?this.format("l10n-internal-date-day-month-year",{d:e}):this.format("l10n-internal-date-day-month",{d:e})}formatTime(e){let r=this.format("l10n-internal-time",{d:e});return this.getLocales()[0]==="en"?r==null?void 0:r.toLowerCase():r}hasTranslation(e,r){for(let i of this.bundles)if(i.locales.indexOf(r)>=0)return i.hasMessage(e);return!1}coerceNumericVariables(e){let r={};for(let i in e){let n=e[i];n instanceof ks?r[i]=n.value:typeof n=="number"?r[i]=`${n}`:r[i]=n}return r}getLocales(){return this.bundles.reduce((e,r)=>e.concat(r.locales),[])}};var bv="",kV={},oP={},GV={},L8=["ar","hy-AM","hi","tr","xx-XX"];function wv(t){bv=t||""}function VV(t){for(let e in t)delete GV[e],oP[e]=t[e]}function IV(t,e){let r=e!=null?e:bv;return aP(r).hasTranslation(t,r)}function ca(t,e){if(e)for(var r in e)e.hasOwnProperty(r)&&(t=t.split("__"+r+"__").join(e[r]));return t}function Yo(t,e,r){return sP(t,e!=null?e:{},r!=null?r:bv)}function zl(t){return function(r,i){return sP(r,i!=null?i:{},t())}}function P8(t){let e={};for(let r in t){let i=t[r];i!==void 0&&(e[r]=i)}return e}function sP(t,e,r){let n=aP(r).format(t,P8(e));return n==null?(__dcg_shared_module_exports__['M'].warn(`Could not format string ${t}`),""):n}function aP(t){let e=GV[t];if(!e){kV[t]||(kV[t]=gv([t]));let r=[];for(let n of kV[t]){let o=oP[n];o&&r.push({lang:n,source:o})}let i={};t==="xx-XX"&&(i.transform=n=>n.replace(/[a-z]/gi,"\u2666")),e=GV[t]=ng.fromSources([...r,{lang:"en",source:WL}],n=>{__dcg_shared_module_exports__['M'].warn(n)},i)}return e}function MV(){return bv}function TV(t){return Ra.hasOwnProperty(t)||__dcg_shared_module_exports__['p'](L8,t)}function Ah(t,e){if(t==null)return"";if(typeof t=="string")return t;if(typeof t=="number")return""+t;let r=t.vars,i;if(r){i={};for(let n in r)r.hasOwnProperty(n)&&(i[n]=Ah(r[n],e))}return Yo(t.key,i,e)}var O8=function(){return typeof Desmos!="undefined"&&Desmos.localeData?Desmos.localeData:{}}();function $f(){for(var t=gv([mi("language"),navigator.userLanguage,navigator.language]),e=0;e<t.length;e++){var r=t[e];if(TV(r))return r}return"en"}function og(t){var e=I.Deferred();if(typeof Desmos=="undefined")return e.reject(),e.promise();if(Desmos.supportedLanguages||(Desmos.supportedLanguages=[]),Desmos.supportedLanguages.indexOf(t)>=0||t==="en"||t==="xx-XX")return wv(t),e.resolve(!0),e.promise();if(!TV(t)){let r=t.indexOf("-")!==-1?t.split("-")[0]:t;for(let i in Ra)if(r===i.split("-")[0]&&Ra[i].useAsRoot){t=i;break}}return I.get(`/api/v1/calculator/language/${t}.ftl`,Bc,function(r){Desmos.localeData||(Desmos.localeData={}),Desmos.supportedLanguages||(Desmos.supportedLanguages=[]),Desmos.localeData[t]=r[t],Desmos.supportedLanguages.push(t),VV(Desmos.localeData),wv(t),e.resolve(!0)}).fail(function(r){r.status===404&&__dcg_shared_module_exports__['M'].warn(t+" is not an available language."),e.reject()}),e.promise()}VV(O8);wv($f());Oe();var AV={showGrid:!0,showXAxis:!0,showYAxis:!0,xAxisStep:0,yAxisStep:0,xAxisScale:"linear",yAxisScale:"linear",xAxisMinorSubdivisions:0,yAxisMinorSubdivisions:0,xAxisArrowMode:"NONE",yAxisArrowMode:"NONE",xAxisLabel:"",yAxisLabel:"",xAxisNumbers:!0,yAxisNumbers:!0,polarMode:!1,polarNumbers:!0,degreeMode:!1,randomSeed:"",restrictGridToFirstQuadrant:!1,userLockedViewport:!1},lP={threeDMode:!1,worldRotation3D:[],axis3D:[0,0,1],speed3D:0,showPlane3D:!0,plane3dOpacity:"",backgroundColor3d:"#FFF",showAxis3D:!0,showAxisLabels3D:!0,showBox3D:!0},_8={squareAxes:!0},F8=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['b']({},lP),_8),{product:"graphing"});function cP(t){return t in lP}var Fp=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['b']({},AV),F8),dP=Object.keys(AV);function hP(t){return t in AV}var sg=t=>isFinite(t)&&(t>0||t===0);var $l=class extends Lr{constructor(){super();this.highlightPropertyMultipliers={};this.stateProperties=[],this.cloneProperties=[],this.highlightPropertyMultipliers={},this.config=new Lr;for(var r in Fp)Fp.hasOwnProperty(r)&&this.addStateProperty(r,Fp[r]);this.labelHangingColor="rgba(150,150,150,1)",this.lastChangedAxis="x",this.addDynamicProperties()}addDynamicProperties(){var r=this;function i(o,s,a){r.cloneProperties.push(o);function l(){r.setProperty(o,r.config.projectorMode?a:s)}r.config.observe("projectorMode",l),l()}function n(o,s,a,l,c){r.cloneProperties.push(o);function d(){var p;r.config.projectorMode?p=r.highlight?c:l:p=r.highlight?a:s,r.setProperty(o,p)}var u=[s,a,l,c];r.highlightPropertyMultipliers[o]=u.map(function(p){return p/u[0]}),r.observe("highlight",d),r.config.observe("projectorMode",d),d()}i("labelSize",14,19),i("majorAxisOpacity",.4,1),i("minorAxisOpacity",.12,.25),i("axisOpacity",.9,.9),i("axisLineWidth",1.5,2),i("axisLineOffset",.25,0),i("pixelsPerLabel",80,120),n("curveOpacity",.7,1,.7,1),i("globalCurveColor",void 0,void 0),i("disableFill",!1,!1),n("graphLineWidth",2.5,3.5,5,7),n("pointLineWidth",9,11,15,17)}setController(r){this.controller=r}getHighlightPropertyMultiplier(r,i){var n=i?1:0;return this.config.projectorMode?this.highlightPropertyMultipliers[r][2+n]:this.highlightPropertyMultipliers[r][n]}getFillOpacityMultiplier(){return this.highlight&&this.controller&&this.controller.isGeometry()?2:1}addStateProperty(r,i){this[r]=i,this.stateProperties.push(r),this.cloneProperties.push(r)}static fromObject(r){var i=new $l;return i.cloneProperties.forEach(function(n){r.hasOwnProperty(n)&&i.setProperty(n,r[n])}),i}registerCallbacks(r){var i=this,n=function(){r.redrawAllLayers()};this.stateProperties.forEach(function(o){i.observe(o,n)}),this.config.observe("backgroundColor",n),this.config.observe("textColor",n),this.config.observe("invertedColors",n),this.observe("backgroundColor",function(){r.redrawAllLayers()}),this.observe("textColor",function(){r.redrawAllLayers()}),this.config.observe("enableTabindex",function(){r.redrawAllLayers()}),this.config.observeAndSync("projectorMode",function(){r.redrawAllLayers()})}_validateSetting(r,i){var n;switch(r){case"xAxisMinorSubdivisions":case"yAxisMinorSubdivisions":n=Math.round(Math.min(Math.max(0,i),5)),i!==n&&__dcg_shared_module_exports__['M'].warn("minorSubdivisions must be an integer between 0 and 5. You provided "+i+", which we changed to "+n+".");break;case"degreeMode":case"projectorMode":case"showGrid":case"showXAxis":case"showYAxis":case"xAxisNumbers":case"yAxisNumbers":case"polarNumbers":case"enableTabindex":case"invertedColors":n=i==="false"?!1:!!i,i!==n&&__dcg_shared_module_exports__['M'].warn(r+" must be a Boolean. You provided "+i+" ("+typeof i+"), which we changed to "+n+" ("+typeof n+").");break;case"xAxisStep":case"yAxisStep":n=parseFloat(i),isFinite(i)||(n=0,__dcg_shared_module_exports__['M'].warn(r+" must be a number. You provided "+i+", which we changed to "+n+"."));break;case"xAxisScale":case"yAxisScale":n=i,!this.config.logScales&&i==="logarithmic"?(n="linear",__dcg_shared_module_exports__['M'].warn("Must set logScales: true to set "+r+" to 'logarithmic'.")):i!=="linear"&&i!=="logarithmic"&&(n="linear",__dcg_shared_module_exports__['M'].warn(r+' must be "linear" or "logarithmic". You provided '+i+", which we changed to "+n+"."));break;case"xAxisArrowMode":case"yAxisArrowMode":n=__dcg_shared_module_exports__['O'][i],n!==i&&(n="NONE",__dcg_shared_module_exports__['M'].warn(`unknown AxisArrowMode. Allowed values are: 
`+__dcg_shared_module_exports__['C'](__dcg_shared_module_exports__['O']).join(`
`)));break;case"xAxisLabel":case"yAxisLabel":n=i,typeof i!="string"&&(n="",__dcg_shared_module_exports__['M'].warn(r+" must be a string. you provided a "+typeof i+"."));break;case"randomSeed":n=i,typeof i!="string"&&(n=""+i,__dcg_shared_module_exports__['M'].warn("randomSeed must be a string. you provided a "+typeof i+"."));break;case"backgroundColor":n=i,typeof i!="string"&&(n="",__dcg_shared_module_exports__['M'].warn(r+" must be a string. you provided a "+typeof i+".")),n||(n="#fff"),n[0]!=="#"&&(n="#"+n);break;case"textColor":n=i,typeof i!="string"&&(n="",__dcg_shared_module_exports__['M'].warn(r+" must be a string. you provided a "+typeof i+".")),n||(n="#000"),n[0]!=="#"&&(n="#"+n);break;case"fontSize":n=i,typeof i!="number"&&(n=parseInt(n,10),__dcg_shared_module_exports__['M'].warn("fontSize must be a number. Attempted to convert "+i+" to "+n+"."));break;case"language":n=i,typeof i!="string"&&(n="",__dcg_shared_module_exports__['M'].warn(r+" must be a string. you provided a "+typeof i+".")),window.Desmos&&window.Desmos.supportedLanguages.indexOf(i)<0&&i!=="en"&&(n="en",__dcg_shared_module_exports__['M'].warn(i+" is not currently an available language."));break;default:n=i;break}return n}validateSettings(r){var i={},n=!1;for(var o in r)this.stateProperties.indexOf(o)>=0?i[o]=this._validateSetting(o,r[o]):(__dcg_shared_module_exports__['M'].warn('Invalid graph setting "'+o+'".'),n=!0);return n&&__dcg_shared_module_exports__['M'].warn(`Available graph settings are: 
`+this.stateProperties.join(`
`)),i}getBackgroundColor(){var r=__dcg_shared_module_exports__['P'](this.config.backgroundColor||"#fff");return this.config.invertedColors&&r!=="#ffffff"?__dcg_shared_module_exports__['S'](r):r}getTextColor(){var r=__dcg_shared_module_exports__['P'](this.config.textColor||"#000");return this.config.invertedColors&&r!=="#000000"?__dcg_shared_module_exports__['S'](r):r}};var EQ=__dcg_shared_module_exports__['i'](pP());Oe();var uP=["exp|exponent ln|natural-log log","total length mean median quantile quartile nCr nPr stats","stdev|standard-deviation stddev|standard-deviation","stdDev|standard-deviation stdevp|standard-deviation-population","stddevp|standard-deviation-population stdDevP|standard-deviation-population mad var|variance","varp|variance-population variance cov|co-variance covp|co-variance-population corr|correlation spearman","lcm mcm gcd mcd gcf mod ceil|ceiling floor round abs|absolute-value min max sign|signum signum sgn","sin|sine cos|cosine tan|tangent csc|co-secant sec|secant cot|co-tangent","sinh|hyperbolic-sine cosh|hyperbolic-cosine tanh|hyperbolic-tangent csch|hyperbolic-co-secant","sech|hyperbolic-secant coth|hyperbolic-co-tangent","arcsin|arc-sine arccos|arc-cosine arctan|arc-tangent arccsc|arc-co-secant arcsec|arc-secant","arccot|arc-co-tangent","arcsinh|hyperbolic-arc-sine arccosh|hyperbolic-arc-cosine arctanh|hyperbolic-arc-co-tangent","arccsch|hyperbolic-arc-co-secant arcsech|hyperbolic-arc-secant","arccoth|hyperbolic-arc-co-tangent","arsinh|hyperbolic-ar-sine arcosh|hyperbolic-ar-cosine artanh|hyperbolic-ar-co-tangent","arcsch|hyperbolic-ar-co-secant arsech|hyperbolic-ar-secant","arcoth|hyperbolic-ar-co-tangent","polygon","distance midpoint","sort shuffle join unique","erf|error-function","TTest|t-test ttest|t-test TScore|t-score tscore|t-score","iTTest|independent-t-test ittest|independent-t-test IndependentTTest","TScore|t-score Tscore|t-score tscore|t-score","normaldist|normal-distribution tdist|t-distribution poissondist|poisson-distribution","binomialdist|binomial-distribution","uniformdist|uniform-distribution","pdf cdf random inverseCdf inversecdf","histogram dotplot boxplot","pdf cdf","rgb hsv","for","width height","with"].join(" "),R8=["det|determinant","inv|inverse","transpose","rref|reduced-row-echelon-form","trace"].join(" ");uP+=" "+R8;var N8="alpha beta sqrt theta phi pi tau nthroot cbrt sum prod integral percent infinity infty cross";function Kc(t){t||(t={});let e=[N8];return t.disallowAns||e.push("ans"),t.disallowFrac||e.push("frac"),t.additionalCommands&&(e=e.concat(t.additionalCommands)),e.join(" ")}function da(t){t||(t={});let e=uP;return t.additionalOperators&&t.additionalOperators.length&&(e=`${e} ${t.additionalOperators.join(" ")}`),t.includeGeometryFunctions&&(e+=" "+Object.keys(__dcg_shared_module_exports__['V']).join(" ")),t.include3DFunctions&&(e+=" "+Object.keys(__dcg_shared_module_exports__['W']).join(" ")),e}var gP=window.MathQuill.noConflict().getInterface(3);gP.config({leftRightIntoCmdGoes:"up",sumStartsWithNEquals:!0,supSubsRequireOperand:!0,charsThatBreakOutOfSupSub:"+-=<>*",autoCommands:Kc(),autoSubscriptNumerals:!0,restrictMismatchedBrackets:!0,typingPercentWritesPercentOf:!0,substituteTextarea:function(){return!cv&&(kh||Qu)?I('<span class="dcg-mathquill-input-span" tabindex=0 role="textbox" style="display:inline-block;height:1px;width:1px">')[0]:ML&&TL?I('<textarea readonly inputmode="none" autocorrect="off" autocapitalize="none" spellcheck="false" autocomplete="off">').on("keydown",function(){this.readOnly=!1,this.select()}).on("blur",function(){this.readOnly=!0})[0]:I('<textarea inputmode="none" autocorrect="off" autocapitalize="none" spellcheck="false" autocomplete="off">')[0]},autoOperatorNames:da(),quietEmptyDelimiters:"( [",resetCursorOnBlur:!0,enableDigitGrouping:!0,disableAutoSubstitutionInSubscripts:!0,interpretTildeAsSim:!0});var dl=gP;Oe();var K8=function(){{var t=function(e,r,i){var n,o=r.height(),s=e.outerHeight(),a=e.offset(),l=r.offset();if(!a||!l)return!1;var c=r[0].scrollTop,d=a.top+c-l.top,u=d-i,p=s+d+i-o;return u>=p?n=Math.min(Math.max(c,p),u):n=.5*(u+p),n!==c?(r[0].scrollTop=n,r[0].scrollTop!=c):!1};return{scrollVisible:t}}}();var{scrollVisible:Ba}=K8;Wl();var Cv=class{constructor(e){this.settings=e}ensureTripBlock(){if(this.$tripBlock)return;let e=['<div class="trip-block">','<div class="trip-interior">','<a class="trip-close">&times;</a>','<div class="trip-content"></div>',"</div>",'<div class="trip-arrow"></div>',"</div>"].join("");var r=this.$tripBlock=I(e);r.css({top:"-100px"}),I("body").append(r),r.find(".trip-close").on("dcg-tap",i=>{i.preventDefault(),this.stop()}),this.bindKeyEvents()}cleanup(){return this.unbindKeyEvents(),this.hideTripBlock(),!1}bindKeyEvents(){I(document).on({"keydown.Trip":e=>{this.keyEvent(e)}})}unbindKeyEvents(){I(document).off("keydown.Trip")}keyEvent(e){e.which===27&&this.stop()}stop(){this.hideTripBlock(),this.settings.onTripStop()}exitTourBecauseOfError(e,r){var i="",n=r;do i=n.selector+i;while(n=n.prevObject);this.stop(),Co("TourError: could not find $sel.offset()",{metaData:{message:e,selector:i}})}showTripBlock(e,r){if(this.ensureTripBlock(),e.type==="do-not-update")return;let i=(typeof e.sel=="string"?I(e.sel):e.sel).filter(":visible");e.scrollContainer&&Ba(i,e.scrollContainer,0);var n=this.$tripBlock;e.type==="final"?n.find(".trip-content").html(r||""):n.find(".trip-content").html(e.content),n.toggleClass("trip-hidden",!!e.hidden);let o=i.outerWidth()||0,s=i.outerHeight()||0,a=n.outerWidth()||0,l=n.outerHeight()||0,c=10,d=10,u=I(window).width()||0,p=i.offset();if(p)this.__cachedMissingSelTime=void 0;else{this.__cachedMissingSelTime?Date.now()-this.__cachedMissingSelTime>1e3&&(e.type==="final"?this.stop():this.exitTourBecauseOfError(e.content,i)):this.__cachedMissingSelTime=Date.now();return}n.removeClass("trip-e trip-s trip-w trip-n");var g=0;switch(e.position){case"e":n.addClass("trip-e"),n.css({left:p.left+o+d,top:p.top-(l-s)/2});break;case"s":n.addClass("trip-s");var b=p.left+(o-a)/2;n.css({left:b,top:p.top+s+c}),b+a>u-1&&(g=u-1-b-a),b<1&&(g=1-b);break;case"w":n.addClass("trip-w"),n.css({left:p.left-(d+a),top:p.top-(l-s)/2});break;default:n.addClass("trip-n"),n.css({left:p.left+(o-a)/2,top:p.top-c-l});break}n.find(".trip-interior").css("transform","translate("+g+"px, 0)"),n.css({display:"inline-block"}),n.find(".trip-math:not(.dcg-mq-math-mode)").each(function(){dl.StaticMath(this)})}fadeInTripBlock(){this.ensureTripBlock();var e=this.$tripBlock;setTimeout(function(){e.addClass("trip-is-loaded")},0)}hideTripBlock(){this.$tripBlock&&this.$tripBlock.removeClass("trip-is-loaded")}};var Dv=class{constructor(){this.tripManager=new Cv({onTripStop:this.stopTour.bind(this)}),this.currentStep=void 0,this.currentTour=void 0}_tripLoop(){clearTimeout(this.__tripLoopTimeout),this.running&&(this._advanceTrip(),this.__tripLoopTimeout=setTimeout(this._tripLoop.bind(this),200))}getContent(e){return e.type==="do-not-update"?"":e.type==="final"?e.endingMsg:e.content}_advanceTrip(){var e=this.currentTour.update(),r=new Date().getTime();if(e&&this.currentStep&&this.currentStep.type!=="do-not-update"&&e.type!=="do-not-update"&&this.getContent(e)!==this.getContent(this.currentStep)){if(this.currentStep.delayBeforeExit){if(this.throttleTimer&&r-this.throttleTimer<this.currentStep.delayBeforeExit)return;if(!this.throttleTimer){this.throttleTimer=r;return}}e.delayBeforeEnter&&(this.currentStep=e,this.throttleTimer=r)}if(!(e&&this.currentStep&&this.getContent(this.currentStep)===this.getContent(e)&&this.throttleTimer&&this.throttleTimer<this.currentStep.delayBeforeEnter)&&(this.throttleTimer=null,e&&e.type!=="do-not-update")){if(this.currentStep=e,e.type==="final"){this.finishTour(e,5);return}this.tripManager.showTripBlock(e)}}startTour(e){this.running||(this.currentTour=e,this.running=!0,this._tripLoop(),this.tripManager.fadeInTripBlock())}closingMsg(e,r){return"<b>"+e+"</b><br>This message will self-destruct in "+r+"..."}finishTour(e,r){if(clearTimeout(this.__tripLoopTimeout),this.running=!1,r<0){this.tripManager.stop();return}e.type==="final"?this.tripManager.showTripBlock(e,this.closingMsg(e.endingMsg,r)):this.tripManager.showTripBlock(e),setTimeout(()=>this.finishTour(e,r-1),1e3)}stopTour(){this.running=!1,this.currentStep=void 0,this.currentTour=void 0}};Oe();function mP(t,e){var r=__dcg_shared_module_exports__['na'](t),i=__dcg_shared_module_exports__['na'](e);if(__dcg_shared_module_exports__['ea'](r.n/r.d,t)&&__dcg_shared_module_exports__['ea'](i.n/i.d,e)){var n=__dcg_shared_module_exports__['pa'](r.d,i.d),o=r.n*(n/r.d),s=i.n*(n/i.d),a=s-o;return{nstart:o,nstep:a,lcm:n}}}var fP={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};function yP(t){var e=[],r=t.toLowerCase();if(r.slice(0,3)==="rgb")try{e=r.replace(/[^\d,]/g,"").split(",").slice(0,3).map(function(n){return parseInt(n,10)})}catch(n){LV(t)}else if(r[0]==="#"){var i=/^#?([a-f\d])([a-f\d])([a-f\d])$/;r=r.replace(i,function(n,o,s,a){return o+o+s+s+a+a});try{e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/.exec(r).slice(1).map(function(n){return parseInt(n,16)})}catch(n){LV(t)}}else e=fP[r];return U8(e)||LV(t),{R:e[0],G:e[1],B:e[2]}}function U8(t){return!__dcg_shared_module_exports__['H'](t)||t.length!==3?!1:__dcg_shared_module_exports__['n'](t,function(e){return Number.isInteger(e)&&e>=0&&e<=255})}function LV(t){throw new Error("Invalid color string: "+t)}function bP(t){var e=t.R,r=t.G,i=t.B,n=[];return n[0]=.49*e+.31*r+.2*i,n[1]=.17697*e+.8124*r+.01063*i,n[2]=.01*r+.99*i,n=__dcg_shared_module_exports__['l'](n,function(o){return o/.17697}),{X:n[0],Y:n[1],Z:n[2]}}function wP(t){var e=95.047,r=100,i=108.883,n=t.X,o=t.Y,s=t.Z,a=[];return a[0]=116*Jf(o/r)-16,a[1]=500*(Jf(n/e)-Jf(o/r)),a[2]=200*(Jf(o/r)-Jf(s/i)),{L:a[0],a:a[1],b:a[2]}}function Jf(t){var e=.20689655172413793;return t>Math.pow(e,3)?Math.pow(t,1/3):t/(3*e*e)+4/29}function q8(t,e){var r=1,i=.045,n=.015,o=1,s=1,a=1,l=t.L,c=t.a,d=t.b,u=e.L,p=e.a,g=e.b,b=l-u,x=Math.sqrt(c*c+d*d),w=Math.sqrt(p*p+g*g),E=x-w,k=c-p,S=d-g,T=Math.sqrt(k*k+S*S-E*E),V=1+i*x,O=1+n*x,y=b/(r*a),L=E/(o*V),P=T/(s*O);return Math.sqrt(y*y+L*L+P*P)}function PV(t,e){var r=wP(bP(yP(t))),i=wP(bP(yP(e)));return q8(r,i)}function xP(t,e){var r=__dcg_shared_module_exports__['l'](e,function(n){return PV(t,n)}),i=__dcg_shared_module_exports__['s'](r);return e[r.indexOf(i)]}function OV(t,e){if(typeof t!="string"||!t)return!1;try{return e?PV(t,"#000")<120:PV(t,"#FFF")<20}catch(r){return!1}}function yn(t,e){var r=/^\s*(\-|\+)?([0-9]+(\.[0-9]+)?)\s*$/;if(r.test(t))return parseFloat(t);var i=Object.create(__dcg_shared_module_exports__['Mb']);return i.trigAngleMultiplier=new __dcg_shared_module_exports__['Ab'](e?Math.PI/180:1),+__dcg_shared_module_exports__['fc'](t).tryGetConcreteTree(__dcg_shared_module_exports__['Nb'],i).asValue()}function fi(t,e){if(!isFinite(t))return t;if(!isFinite(e))return e;var r=__dcg_shared_module_exports__['$'](t,e);if(t>0!=e>0||t===0||e===0)return 0;var i=t>0?1:-1,n=Math.abs(t).toExponential().split("e"),o=Math.abs(e).toExponential().split("e"),s=n[0],a=o[0],l=n[1],c=o[1];if(c!==l)return i*Math.pow(10,Math.max(parseFloat(l),parseFloat(c)));if(s[0]!==a[0])return parseFloat(r.toPrecision(1));for(var d=1,u=2;u<Math.min(s.length,a.length)&&(d++,s[u]===a[u]);u++);return parseFloat(r.toPrecision(d))}var{color:H8}=__dcg_shared_module_exports__['ia'];function z8(t){return H8(t)!==null}var lg=z8;function Yf(t){let e=__dcg_shared_module_exports__['fc'](t);if(e.type!=="Assignment")return NaN;if(e._expression.type!=="Constant")return NaN;if(!new __dcg_shared_module_exports__['nc']({enableGeometry:!1,enable3d:!1,beta3d:!1,scales:void 0}).validLHS(e._symbol))return NaN;if(__dcg_shared_module_exports__['Mb'][e._symbol])return NaN;let i=e._expression.asValue();return typeof i=="number"?i:NaN}function $8(t){return t.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&")}function W8(t){return t.replace(/\\\\right\\(\\*[})\]|])/g,".*\\\\right\\$1").replace(/ ?\\([}\]])/g,".*\\$1")}function SP(t){let e=W8($8(t));return new RegExp(e)}function j8(t){switch(t.type){case"TokenNode":case"Letter":return!0;case"OperatorName":{for(let e of t.arg.args)if(e.type!=="Letter")return!1;return!0}case"Cmd":{let e=__dcg_shared_module_exports__['cc'][t.val];return e===void 0?!0:e==="Ln"||e==="Log"||e==="Trig"}default:return!1}}function _V(t){let e;try{e=__dcg_shared_module_exports__['_b'](t)}catch(n){return}if(e.args.length===0||e.args.length>2)return;let r=e.args[0];if(!j8(r))return;let i;if(e.args.length>1){let n=e.args[1];if(n.type!=="SupSub")return;let{sup:o,sub:s}=n;if(o!==void 0||s===void 0)return;for(let a of s.args)if(a.type!=="Letter"&&a.type!=="Digit")return;i=s}return{base:r,subscript:i}}function ha(t){return _V(t)!==void 0}function CP(t){return t.replace(/^(\\? )+|(\\? )+$/g,"")}function Qf(t){let e=t.indexOf("=");if(e===-1)return;let r=CP(t.slice(0,e));if(ha(r))return r;try{let i=__dcg_shared_module_exports__['_b'](`${r}=0`),n=__dcg_shared_module_exports__['ec'](i);if(n.type==="Equals"&&__dcg_shared_module_exports__['dc'](n.args[0])){let o=t.indexOf("\\left(");if(o===-1&&(o=t.indexOf("(")),o===-1)return;let s=CP(t.slice(0,o));if(ha(s))return s}}catch(i){}}function Sv(t,e){let r=_V(e);if(r===void 0)return[];let i=[],n;try{n=__dcg_shared_module_exports__['_b'](t)}catch(o){return i}return Xf(n,r,i,{wrapInBraces:!1}),i}function jl(t,e){return Sv(t,e).length!==0}function Ev(t,e,r){return _V(r)===void 0?t:FV(t,e,r)}function FV(t,e,r){let i=Sv(t,e);if(i.length===0)return t;let n="",o=0;for(let s of i){if(n+=t.slice(o,s.base.start),s.wrapInBraces&&(n+="{"),n+=r,o=s.base.end,s.subscript){let a=0,l=0;for(let c=s.subscript.start;c>=0;c--)if(t[c]==="{"&&(a+=1),t[c]==="_"){l=c;break}n+=t.slice(o,l),o=s.subscript.end;for(let c=s.subscript.end;c<t.length&&!(a<=0);c++)t[c]==="}"&&(a-=1,o=c+1)}s.wrapInBraces&&(n+="}")}return n+=t.slice(o,t.length),n}function DP(t,e){if(t.args.length!==e.args.length)return!1;for(let r=0;r<t.args.length;r++){let i=t.args[r],n=e.args[r];if(!(i.type==="Letter"&&n.type==="Letter"&&i.val===n.val)&&!(i.type==="Digit"&&n.type==="Digit"&&i.val===n.val))return!1}return!0}function J8(t,e,r){let i=t.arg.args,n=e.arg.args;if(i.length===n.length){for(let o=0;o<i.length;o++){let s=i[o],a=n[o];if(s.type!=="Digit"||s.type!==a.type||s.val!==a.val)return}r.push({base:e.span,wrapInBraces:!1})}}function Xf(t,e,r,{wrapInBraces:i}){let{base:n,subscript:o}=e;for(let s=0;s<t.args.length;s++){let a=t.args[s],l;if(s+1<t.args.length){let c=t.args[s+1];c.type==="SupSub"&&c.sub!==void 0&&(l=c.sub)}switch(a.type){case"Letter":case"Cmd":if(n.type!==a.type||n.val!==a.val)break;o&&l&&DP(o,l)?r.push({base:a.span,subscript:l.span,wrapInBraces:i}):!o&&!l&&r.push({base:a.span,wrapInBraces:i});break;case"OperatorName":{if(n.type!==a.type||n.arg.args.length!==a.arg.args.length)break;let c=!0;for(let d=0;d<n.arg.args.length;d++){let u=n.arg.args[d],p=a.arg.args[d];if(u.type!=="Letter"||p.type!=="Letter"||u.val!==p.val){c=!1;break}}if(!c)break;o&&l&&DP(o,l)?r.push({base:a.span,subscript:l.span,wrapInBraces:i}):!o&&!l&&r.push({base:a.span,wrapInBraces:i});break}case"Digit":case"Symbol":case"EscapedSymbol":break;case"LeftRight":case"Sqrt":Xf(a.arg,e,r,{wrapInBraces:!1});break;case"Frac":Xf(a.num,e,r,{wrapInBraces:!1}),Xf(a.den,e,r,{wrapInBraces:!1});break;case"SupSub":if(a.sup){let c=!1;for(let d=a.sup.span.start;d>=0;d--){let u=a.sup.span.input[d];if(u==="^")break;u==="{"&&(c=!0)}Xf(a.sup,e,r,{wrapInBraces:!c})}break;case"TokenNode":{if(n.type!==a.type)break;J8(n,a,r)}break;default:{let c=a;throw new Error("Unexpected token type: "+c.type)}}}}function NV(t){return t===void 0?NaN:+t}var kP={smallCutoff:1e-6,bigCutoff:1e9,digits:12};function GP(t){let e=t.formula;return e?t.controller.isDecimalToFractionEnabled()&&e.hasOwnProperty("constant_value")&&__dcg_shared_module_exports__['Db'](NV(e.constant_value)):!1}function pl(t){return!!(t.formula&&t.formula.is_graphable)}function BV(t){let e=t.formula;if(!e)return!1;let r=e.is_evaluable&&e.zero_values&&e.zero_values.length>0&&typeof e.zero_values[0].val!="boolean",i=GP(t)&&_h(t),n=!!e.rgb_value&&t.formula.assignment;return r||i||n}function KV(t){let e=t.formula;return BV(t)?e.zero_values&&e.zero_values.length?e.zero_values[0].val:e.rgb_value?e.rgb_value:e.constant_value:GP(t)?t.formula.constant_value:NaN}function cg(t){var e=t.formula.ttest_results;if(!(!e||!isFinite(e.lessThan)))return{lessThan:e.lessThan,greaterThan:e.greaterThan,notEqual:e.notEqual}}function dg(t){var e=t.formula.stats_results;if(!(!e||!isFinite(e.min)))return{min:e.min,q1:e.q1,median:e.median,q3:e.q3,max:e.max}}function Ph(t,e){if(!isFinite(e))return t;let r=t.indexOf("=")+1;return yn(t.slice(r),!1)===e?t:t.slice(0,r)+__dcg_shared_module_exports__['lc'](e)}function ua(t){var e=t.latex||"",r=t.label||"",i=e+r;return i.split(" ").join("")===""}function X8(t){var e=t.dragMode==="AUTO"&&t.formula.default_drag_mode!==void 0?t.formula.default_drag_mode:t.dragMode;t.controller.isThreeDMode()&&(e="NONE"),t.dragMode==="AUTO"&&yy(t)&&(e="NONE"),t.reconciledDragMode=__dcg_shared_module_exports__['Na'](e,t.formula.move_strategy),t.interactiveLabel&&t.reconciledDragMode!=="NONE"&&fy(t,!1)}function hl(t,e,r){if(!t.sliderExists)return NaN;let i=Ka(t),n=Jl(t),o=ul(t);if(r&&r.overwriteStep!==void 0&&(o=r.overwriteStep),e=__dcg_shared_module_exports__['Rb']({target:e,hardMin:t.slider.hardMin?i:void 0,hardMax:t.slider.hardMax?n:void 0,step:o}),!r||!r.ignoreSoftLimits){if(!t.slider.hardMin&&e<i)return i;if(!t.slider.hardMax&&e>n)return n}return e}function UV(t,e,r={}){if(!t.sliderExists)return NaN;let i=Ns(t),n=Ka(t),o=Jl(t),s=ul(t);r.overwriteStep===void 0&&(r.overwriteStep=s||(o-n)/20);var a=0;switch(e){case"min":return hl(t,n);case"max":return hl(t,o);case"up":a=1;break;case"down":a=-1;break;case"bigup":a=5;break;case"bigdown":a=-5;break;default:return e}let l=i;for(var c=0;c<20;c++){let d=c/3*r.overwriteStep,u=i;if(a>0)i=hl(t,l+d,r),i>u&&(a-=1);else if(a<0)i=hl(t,l-d,r),i<u&&(a+=1);else break}return i}function Gv(t,e){if(t.sliderExists){t.slider.isPlaying&&ga(t,!1);var r=hl(t,e,{ignoreSoftLimits:!0});t.latex=Ph(t.latex,r)}}function VP(t,e,r){if(t.sliderExists){t.slider.isPlaying&&ga(t,!1),ug(t);var i=UV(t,e,r);t.latex=Ph(t.latex,i)}}function IP(t,e){if(t.sliderExists){t.slider.isPlaying&&ga(t,!1);var r=hl(t,e);t.latex=Ph(t.latex,r)}}function MP(t,e){if(!t.sliderExists||t.resetSliderAnimationTargetValue)return;var r=t.sliderLastTickTime;if(t.sliderLastTickTime=e,r===void 0)return;var i=e-r;let n=Ka(t),o=Jl(t),s=ul(t),a=t.slider.animationPeriod,l=t.slider.loopMode;if(isNaN(t.sliderAnimationTargetValue)){var c=Ns(t);isNaN(c)||(t.sliderAnimationTargetValue=c)}var d=s?s/2:0;if(l==="LOOP_FORWARD_REVERSE")t.sliderAnimationTargetValue>=o?Fo(t,{playDirection:-1}):t.sliderAnimationTargetValue<=n&&Fo(t,{playDirection:1});else if(l==="LOOP_FORWARD")Fo(t,{playDirection:1}),t.sliderAnimationTargetValue>=o+d&&(t.sliderAnimationTargetValue=n-d);else if(l==="PLAY_ONCE")Fo(t,{playDirection:1});else if(l==="PLAY_INDEFINITELY")Fo(t,{playDirection:1});else throw new Error("Unexpected slider loop mode: "+l);isFinite(i)||(i=0);var u,p;if(l==="PLAY_INDEFINITELY")u=i/(a/4),s&&(u*=s),t.sliderAnimationTargetValue+=u,p=t.sliderAnimationTargetValue,s||(p=fi(p-u*.1,p+u*.1)),p=hl(t,p,{ignoreSoftLimits:!0}),t.latex=Ph(t.latex,p);else{if(i=Math.min(i,a/10),u=(o-n)*i/a,t.sliderAnimationTargetValue+=u*t.slider.playDirection,t.sliderAnimationTargetValue=Math.max(n-d,Math.min(o+d,t.sliderAnimationTargetValue)),p=t.sliderAnimationTargetValue,!s){let g=u/i*16.666666666666668;p=fi(p-g*.1,p+g*.1)}p=hl(t,p),t.latex=Ph(t.latex,p)}}function Vv(t){let e=t.formula;return e?e.is_single_identifier?[]:e.variables||[]:[]}function qV(t,e){t.formula=e,t.error=e.error,t.unresolved=!1,e.is_slider?(!t.sliderExists||t.resetSliderAnimationTargetValue)&&(t.sliderAnimationTargetValue=Ns(t),t.sliderDragging=!1,t.sliderExists=!0):t.sliderExists=!1,t.resetSliderAnimationTargetValue=!1;var r={};e.is_regression&&(r=e.regression.parameters,t.residualVariable=e.regression.residualVariable,t.controller.areLogModeRegressionsForced()&&(t.isLogModeRegression=!0)),__dcg_shared_module_exports__['F'](t.regressionParameters,r)||(t.regressionParameters=r)}function Q8(t){let e=ma(t);e&&e.hidden||t.formula.expression_type&&qp(t)?t.shouldGraph=!1:t.shouldGraph=!yy(t)}function Z8(t){let e=t.formula&&t.formula.raw_slider_latex;if(!t.sliderExists||t.latex!==e){t.cachedDisplayLatex={storedLatex:t.latex,valueLatex:t.latex};return}let{latex:r}=t;if(t.cachedDisplayLatex.storedLatex!==r){t.cachedDisplayLatex={storedLatex:t.latex,valueLatex:t.latex};return}let i=LP(t);if(isFinite(i)){let n=t.controller.getFocusLocation();n&&n.type==="expression"&&n.id===t.id||(t.cachedDisplayLatex.valueLatex=Ph(t.latex,i))}}function ey(t){return t.cachedDisplayLatex.valueLatex}function TP(t){return __dcg_shared_module_exports__['Bb'](t).latex}function Iv(t){return t.slider.hardMin?t.slider.min:TP(Ka(t))}function AP(t){return t.slider.hardMax?t.slider.max:TP(Jl(t))}function Ka(t){if(t.slider.hardMin){let e=t.formula.slider_min_number;return isFinite(e)?e:NaN}else{let e=t.controller.isDegreeMode(),r=yn(t.slider.min,e),i=Ns(t),n=ul(t),o=t.slider.hardMax?t.formula.slider_max_number:void 0,s=-10;if(r<s&&(s=r),i<s&&(s=i),o<s&&(s=o),n){let a=__dcg_shared_module_exports__['Rb']({target:s,hardMin:void 0,hardMax:o,step:n});a<=s?s=a:s=a-n}return s}}function Jl(t){if(t.slider.hardMax){let e=t.formula.slider_max_number;return isFinite(e)?e:NaN}else{let e=t.controller.isDegreeMode(),r=yn(t.slider.max,e),i=Ns(t),n=ul(t),o=t.slider.hardMin?t.formula.slider_min_number:void 0;return __dcg_shared_module_exports__['Sb']({storedMax:r,sliderValue:i,step:n,hardMin:o})}}function ul(t){return t.formula.slider_step_number}function LP(t){if(!t.formula||!t.formula.is_slider)return;let e=t.formula.constant_value;if(e!==void 0)return+e}function Ns(t){let e=t.formula&&t.formula.raw_slider_latex;if(t.latex!==e)return Yf(t.latex);let r=LP(t);return isFinite(r)?r:NaN}function HV(t){return t.slider.loopMode!=="PLAY_ONCE"?!1:Ns(t)>=Jl(t)}function PP(t,e){return t.formula.viz_valids?!!t.formula.viz_valids[e]:!1}function Ld(t,e){return t.vizProps[e]}function OP(t,e,r){t.vizProps=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},t.vizProps),{[e]:r})}function _P(t,e,r){t.clickableInfo=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},t.clickableInfo),{[e]:r})}function Mv(t,e){t.clickableInfo=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},t.clickableInfo),{latex:e})}function Uc(t){return!!(t.clickableInfo.enabled&&lI(t)&&t.formula.click_handler&&t.formula.click_handler.status==="maybe-valid")}function FP(t){return!!t.__workerNeedsDotplotXMode}function Tv(t){return!!(t.formula&&t.formula.slider_min_valid)}function Av(t){return!!(t.formula&&t.formula.slider_max_valid)}function Lv(t){return!!(t.formula&&t.formula.slider_step_valid)}function RP(t){if(!t.formula)return NaN;if(t.formula.expression_type==="SURFACE_xyz_uv"||t.formula.expression_type==="SURFACE_r_\u03B8\u03C6"||t.formula.expression_type==="SURFACE_r_\u03B8\u03C6_AMBIGUOUS"||t.formula.expression_type==="SURFACE_z_r\u03B8")return 0;if(Rh(t)&&isFinite(t.__workerSampledDomainMin))return t.__workerSampledDomainMin;let e=t.formula.domain_min_number;return isFinite(e)?e:NaN}function NP(t,e=""){if(!t.formula)return NaN;if(t.formula.expression_type==="SURFACE_xyz_uv")return 1;if(t.formula.expression_type==="SURFACE_r_\u03B8\u03C6"||t.formula.expression_type==="SURFACE_r_\u03B8\u03C6_AMBIGUOUS"){if(e==="\\theta")return Math.PI*2;if(e==="\\phi")return Math.PI}if(t.formula.expression_type==="SURFACE_z_r\u03B8"){if(e==="r")return 10;if(e==="\\theta")return Math.PI*2}if(Rh(t)&&isFinite(t.__workerSampledDomainMax))return t.__workerSampledDomainMax;let r=t.formula.domain_max_number;return isFinite(r)?r:NaN}function BP(t,e){switch(e){case"u":return!!(t.formula&&t.formula.domain_min_u_valid);case"r":return!!(t.formula&&(pa(t)&&t.formula.domain_min_u_valid||t.formula.domain_min_valid));case"\\theta":return!!(t.formula&&(Ua(t)&&t.formula.domain_min_u_valid||pa(t)&&t.formula.domain_min_v_valid||t.formula.domain_min_valid));case"v":case"\\phi":return!!(t.formula&&t.formula.domain_min_v_valid)}return!!(t.formula&&t.formula.domain_min_valid)}function KP(t,e){switch(e){case"u":return!!(t.formula&&t.formula.domain_max_u_valid);case"r":return!!(t.formula&&(pa(t)&&t.formula.domain_max_u_valid||t.formula.domain_max_valid));case"\\theta":return!!(t.formula&&(Ua(t)&&t.formula.domain_max_u_valid||pa(t)&&t.formula.domain_max_v_valid||t.formula.domain_max_valid));case"v":case"\\phi":return!!(t.formula&&t.formula.domain_max_v_valid)}return!!(t.formula&&t.formula.domain_max_valid)}function Bp(t,e){var r=t.cachedViewState;if((!e.stripDefaults||t.parametricDomain.min!==""||t.parametricDomain.max!=="")&&(r=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},r),{domain:{min:t.parametricDomain.min===""?"0":t.parametricDomain.min,max:t.parametricDomain.max===""?"1":t.parametricDomain.max}})),e.stripDefaults)return __dcg_shared_module_exports__['Uc'](r);if(r.points===void 0||r.lines===void 0||r.fill===void 0||r.surfaces===void 0){let i=__dcg_shared_module_exports__['N'](r);return i.points===void 0&&delete i.points,i.lines===void 0&&delete i.lines,i.fill===void 0&&delete i.fill,i.surfaces===void 0&&delete i.surfaces,i}return r}function e4(t){let e=t.cachedViewState;e&&__dcg_shared_module_exports__['Wc'](e,t)&&e.folderId===t.folderId&&e.color===t.color&&e.latex===t.latex&&e.showLabel===t.showLabel&&e.label===t.label&&e.hidden===t.hidden&&e.secret===t.secret&&e.readonly===t.readonly&&e.fill===t.fill&&e.points===t.points&&e.lines===t.lines&&e.surfaces===t.surfaces&&e.lineStyle===t.lineStyle&&e.arrowMode===t.arrowMode&&e.pointStyle===t.pointStyle&&e.dragMode===t.dragMode&&e.labelSize===t.labelSize&&e.labelOrientation===t.labelOrientation&&e.suppressTextOutline===t.suppressTextOutline&&e.interactiveLabel===t.interactiveLabel&&e.editableLabelMode===t.editableLabelMode&&e.residualVariable===t.residualVariable&&e.regressionParameters===t.regressionParameters&&e.isLogModeRegression===t.isLogModeRegression&&e.displayEvaluationAsFraction===t.displayEvaluationAsFraction&&e.slider===t.slider&&e.strictIntersection===t.strictIntersection||(t.cachedViewState=__dcg_shared_module_exports__['b']({type:t.type,id:t.id,folderId:t.folderId,color:t.color,latex:t.latex,showLabel:t.showLabel,label:t.label,hidden:t.hidden,secret:t.secret,readonly:t.readonly,points:t.points,lines:t.lines,surfaces:t.surfaces,lineStyle:t.lineStyle,arrowMode:t.arrowMode,pointStyle:t.pointStyle,fill:t.fill,dragMode:t.dragMode,labelSize:t.labelSize,labelOrientation:t.labelOrientation,suppressTextOutline:t.suppressTextOutline,interactiveLabel:t.interactiveLabel,editableLabelMode:t.editableLabelMode,residualVariable:t.residualVariable,regressionParameters:t.regressionParameters,isLogModeRegression:t.isLogModeRegression,displayEvaluationAsFraction:t.displayEvaluationAsFraction,slider:t.slider,strictIntersection:t.strictIntersection},__dcg_shared_module_exports__['Vc'](t)))}function zV(t,e){e&&ug(t),t.draggingOnGraphpaper=e}function t4(t){var e=t.memoizedUndoRedoStateParams,r=t.cachedViewState,i=t.preTransientState;if(t.cachedUndoRedoFullState=r,e&&e.viewState===r&&e.preTransientState===i)return;t.memoizedUndoRedoStateParams={viewState:r,preTransientState:i};let n;i?n=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},r),{latex:i.latex,slider:__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['b']({},r.slider),i.slider)}):n=__dcg_shared_module_exports__['b']({},r),delete n.regressionParameters,delete n.residualVariable,t.cachedUndoRedoDiffState=n}function Pv(t,e){let r=__dcg_shared_module_exports__['N'](__dcg_shared_module_exports__['Tc'](t)),{color:i}=r;return(!i||!lg(i))&&(i=e.getNextColor()),__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['b']({},r),$c(e)),{labelDropdownOpen:!1,formula:{error:void 0,operator:"=",variables:[]},geoOverrideHidden:void 0,error:void 0,unresolved:!1,color:i,pointStyle:r.pointStyle,lineStyle:r.lineStyle,arrowMode:r.arrowMode,displayEvaluationAsFraction:r.displayEvaluationAsFraction,shouldGraph:void 0,sliderDragging:void 0,sliderAnimationTargetValue:void 0,resetSliderAnimationTargetValue:!1,sliderLastTickTime:void 0,draggingOnGraphpaper:!1,cachedUndoRedoDiffState:void 0,cachedUndoRedoFullState:void 0,cachedParsableState:void 0,cachedViewState:void 0,cachedDisplayLatex:{storedLatex:"",valueLatex:""}})}function r4(t){let e=ma(t),r=!!(e&&e.hidden),i=t.cachedViewState,n=t.index,o=t.showLabel&&!r,s=t.shouldGraph,a=t.memoizedParsableStateParams;if(a&&a.viewState===i&&a.index===n&&a.showLabel===o&&a.shouldGraph===s)return;t.memoizedParsableStateParams={viewState:i,index:n,showLabel:o,shouldGraph:s};let l=__dcg_shared_module_exports__['Xc'](i);l.index=n,l.showLabel=o,l.shouldGraph=s,l.isInConstructionsFolder=(e==null?void 0:e.id)===__dcg_shared_module_exports__['Oc'],t.cachedParsableState=l}function Ov(t,e){e(t.latex,"latex",t),e(t.clickableInfo.latex,"clickableInfoLatex",t),e(t.lineWidth,"lineWidth",t),e(t.fillOpacity,"fillOpacity",t),e(t.lineOpacity,"lineOpacity",t),e(t.pointOpacity,"pointOpacity",t),e(t.pointSize,"pointSize",t),e(t.labelSize,"labelSize",t),e(t.labelAngle,"labelAngle",t),e(t.colorLatex,"colorLatex",t),Fh(t)&&(e(t.parametricDomain.min,"parametricDomainMin",t),e(t.parametricDomain.max,"parametricDomainMax",t)),(jv(t)||Ua(t))&&(e(t.parametricDomain3Du.min,"parametricDomain3DuMin",t),e(t.parametricDomain3Du.max,"parametricDomain3DuMax",t),e(t.parametricDomain3Dv.min,"parametricDomain3DvMin",t),e(t.parametricDomain3Dv.max,"parametricDomain3DvMax",t)),(Rh(t)||bg(t))&&(e(t.polarDomain.min,"polarDomainMin",t),e(t.polarDomain.max,"polarDomainMax",t)),(rI(t)||tI(t))&&e(t.resolution,"resolution",t),zc(t)&&(e(t.cdf.min,"cdfMin",t),e(t.cdf.max,"cdfMax",t)),t.sliderExists&&(e(t.slider.min,"sliderMin",t),e(t.slider.max,"sliderMax",t),e(t.slider.step,"sliderStep",t)),t.residualVariable&&e(t.residualVariable,"residualVariable",t)}function so(t){return t.formula&&t.formula.assignment}function $V(t){return t.formula&&t.formula.shader}function hs(t){let e=t.cachedAssignmentOrFunctionName;if(e&&e.latex===t.latex)return e.result;let r=Qf(t.latex),i=r?{latex:r,identifier:__dcg_shared_module_exports__['Jb'](r)}:void 0;return t.cachedAssignmentOrFunctionName={latex:t.latex,result:i},i}function UP(t){var r,i;let e=(i=(r=t.formula)==null?void 0:r.typed_constant_value)==null?void 0:i.valueType;return e==null?!1:__dcg_shared_module_exports__['ub'](e)}function WV(t){var i;let e=(i=hs(t))==null?void 0:i.latex;var r=e==null?void 0:e.match(/^(\\token\{\d+\})$/);if(r)return r[1]}function _v(t){var r,i;let e=(i=(r=t.formula)==null?void 0:r.typed_constant_value)==null?void 0:i.valueType;if(e==null||(__dcg_shared_module_exports__['ub'](e)&&(e=__dcg_shared_module_exports__['vb'](e)),!__dcg_shared_module_exports__['wb'](e)))return"unknown";switch(e){case __dcg_shared_module_exports__['Ta']:return"point";case __dcg_shared_module_exports__['bb']:case __dcg_shared_module_exports__['jb']:case __dcg_shared_module_exports__['hb']:return"line";case __dcg_shared_module_exports__['fb']:case __dcg_shared_module_exports__['db']:return"circle";case __dcg_shared_module_exports__['lb']:return"angle";case __dcg_shared_module_exports__['nb']:return"directedangle";case __dcg_shared_module_exports__['$a']:return"polygon";case __dcg_shared_module_exports__['pb']:return"transformation";default:return e}return"unknown"}function qP(t){return t.indexOf("\\token{")!==-1}function HP(t){var r,i;let e=(i=(r=t.formula.geometry)==null?void 0:r.call)==null?void 0:i.symbol;return e&&e!=="apply"?e:_v(t)}function i4(t){return!!(t.sliderExists&&(t.slider.isPlaying||t.sliderDragging)||t.draggingOnGraphpaper)}function zP(t){return!!(t.sliderExists&&t.sliderDragging||t.draggingOnGraphpaper)}function jV(t){var e=i4(t);e?t.preTransientState||(t.preTransientState={latex:t.latex,slider:{min:t.slider.min,max:t.slider.max,playDirection:t.slider.playDirection}}):delete t.preTransientState,(!t.sliderExists||!t.slider.isPlaying)&&(t.sliderLastTickTime=void 0),Wc(t),Q8(t),X8(t),e4(t),t4(t),r4(t),Z8(t)}var n4=__dcg_shared_module_exports__['b']({id:!1,type:!1,color:!0,folderId:!0,latex:!0,showLabel:!0,label:!0,hidden:!0,secret:!0,readonly:!0,points:!0,lines:!0,lineStyle:!0,arrowMode:!0,pointStyle:!0,fill:!0,dragMode:!0,labelSize:!0,labelOrientation:!0,suppressTextOutline:!0,interactiveLabel:!0,editableLabelMode:!0,residualVariable:!0,regressionParameters:!0,isLogModeRegression:!0,displayEvaluationAsFraction:!0,slider:!0,strictIntersection:!0,angleType:!0,showAngleDirection:!0},__dcg_shared_module_exports__['Lc'](__dcg_shared_module_exports__['Qc']));function $P(t,e){__dcg_shared_module_exports__['Ic']({from:e,to:t,props:n4}),t.resetSliderAnimationTargetValue=!0,t.sliderAnimationTargetValue=void 0}function hg(t,e){e?Fo(t,{hardMin:!0,min:e}):Fo(t,{hardMin:!1,min:"-10"})}function pg(t,e){e?Fo(t,{hardMax:!0,max:e}):Fo(t,{hardMax:!1,max:"10"})}function Fo(t,e){t.slider=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['b']({},t.slider),e)}function ga(t,e){!t||t.slider.isPlaying===e||(Fo(t,{isPlaying:e}),e&&(ug(t),t.sliderAnimationTargetValue=Ns(t)))}function ug(t){if(!t.slider.hardMin){let e=__dcg_shared_module_exports__['kc'](Ka(t));e!==t.slider.min&&Fo(t,{min:e})}if(!t.slider.hardMax){let e=__dcg_shared_module_exports__['kc'](Jl(t));e!==t.slider.max&&Fo(t,{max:e})}}function Bs(t,e){var r=Yf(e);if(isFinite(r)){let i=__dcg_shared_module_exports__['Qb']({target:r,step:ul(t),hardMin:t.slider.hardMin?Ka(t):void 0,hardMax:t.slider.hardMax?Jl(t):void 0});i.min||Fo(t,{hardMin:!1,min:"-10"}),i.max||Fo(t,{hardMax:!1,max:"10"}),i.step||Fo(t,{step:""})}t.latex=e}function WP(t,e){Fo(t,{loopMode:e,playDirection:1}),e==="PLAY_INDEFINITELY"&&Fo(t,{hardMin:!1,hardMax:!1,min:"",max:""}),t.sliderAnimationTargetValue=Ka(t)}function ty(t,e){e&&ug(t),t.sliderDragging=e}function ry(t,e){Fo(t,{step:e})}function jP(t,e){Fo(t,{animationPeriod:e})}function _h(t){return t.displayEvaluationAsFraction}function JP(t,e){t.displayEvaluationAsFraction=e}function Pd(t,e){t.label=e}function Kp(t,e){t.showLabel=e}function YP(t,e){t.description=e}function iy(t,e){t.polarDomain=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},t.polarDomain),{min:e})}function ny(t,e){t.parametricDomain=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},t.parametricDomain),{min:e})}function oy(t,e){t.parametricDomain3Du=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},t.parametricDomain3Du),{min:e})}function sy(t,e){t.parametricDomain3Dv=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},t.parametricDomain3Dv),{min:e})}function ay(t,e){t.polarDomain=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},t.polarDomain),{max:e})}function ly(t,e){t.parametricDomain=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},t.parametricDomain),{max:e})}function cy(t,e){t.parametricDomain3Du=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},t.parametricDomain3Du),{max:e})}function dy(t,e){t.parametricDomain3Dv=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},t.parametricDomain3Dv),{max:e})}function JV(t,e){t.isLogModeRegression=e}function Fv(t,e){lg(e)&&(t.color=e,t.colorLatex="")}function YV(t,e){t.fill=e}function hy(t,e){t.fillOpacity!==e&&(t.fillOpacity=e)}function gg(t,e){t.lineOpacity!==e&&(t.lineOpacity=e)}function py(t,e){t.pointOpacity!==e&&(t.pointOpacity=e)}function uy(t,e){t.pointSize!==e&&(t.pointSize=e)}function mg(t,e){t.lineWidth!==e&&(t.lineWidth=e)}function Rv(t,e){t.resolution!==e&&(t.resolution=e)}function Nv(t,e){t.checkers!==e&&(t.checkers=e)}function XP(t,e){t.polarCoordinateSystem!==e&&(t.polarCoordinateSystem=e)}function gy(t,e){t.colorLatex!==e&&(t.colorLatex=e)}function QP(t,e){t.labelDropdownOpen=e}function Up(t,e){t.dragMode!==e&&(t.dragMode=e)}function XV(t,e){t.points=e}function QV(t,e){t.pointStyle!==e&&(t.pointStyle=e,e!=="POINT"&&(t.dragMode="NONE"))}function ZV(t,e){t.lines=e}function ZP(t,e){t.surfaces=e}function Bv(t,e){t.lineStyle!==e&&(t.lineStyle=e)}function eO(t,e){t.arrowMode=e===tO(t)?"DEFAULT":e}function tO(t){return"NONE"}function Kv(t){return by(t)?t.arrowMode==="DEFAULT"?tO(t):t.arrowMode:"NONE"}function my(t,e){t.labelSize=e}function Uv(t,e){t.labelAngle=e}function eI(t,e){t.labelOrientation=e}function rO(t,e){t.suppressTextOutline=e}function fy(t,e){t.interactiveLabel=e}function qv(t,e){t.editableLabelMode=e}function iO(t){return t.editableLabelMode}function fg(t){let{editableLabelMode:e}=t;return e==="MATH"||e==="TEXT"}function nO(t,e){t.strictIntersection=e}function oO(t){return!!(t.reconciledDragMode!=="NONE"&&t.hidden)}function sO(t,e){t.hidden=e,!e&&qp(t)&&(t.lines=t.points=t.fill=t.surfaces=void 0)}function yy(t){return t.geoOverrideHidden!==void 0?t.geoOverrideHidden:t.hidden}function qp(t){if(Hc(t))return!1;let{points:e,lines:r,fill:i,surfaces:n}=t,o=__dcg_shared_module_exports__['pc'](t.formula.expression_type,{points:e,lines:r,fill:i,surfaces:n});return!o.points&&!o.lines&&!o.fill&&!o.surfaces}function Hv(t){return Fh(t)||Rh(t)||bg(t)}function zv(t){return jv(t)||Ua(t)||pa(t)}function aO(t){return t.polarDomain.min}function lO(t){return t.polarDomain.max}function cO(t){return t.parametricDomain.min}function dO(t){return t.parametricDomain3Du.min}function hO(t){return t.parametricDomain3Dv.min}function pO(t){return t.parametricDomain.max}function uO(t){return t.parametricDomain3Du.max}function gO(t){return t.parametricDomain3Dv.max}function yg(t){return!!t.formula.action_value&&Object.keys(t.formula.action_value).length>0}function mO(t){return!!t.sliderExists}function qc(t){return t.formula.expression_type==="POLYGON"}function Hc(t){return!!t.formula.is_inequality}function $v(t){return!!t.formula.is_regression}function Fh(t){return t.formula.expression_type==="PARAMETRIC"||t.formula.expression_type==="CURVE3D_xyz_t"&&t.latex.indexOf("segment")===-1}function fO(t){return t.formula.expression_type==="POINT3D"}function tI(t){return t.formula.expression_type==="CURVE3D_xyz_t"}function rI(t){switch(t.formula.expression_type){case"SURFACE_xyz_uv":case"SURFACE_z_r\u03B8":case"SURFACE_r_\u03B8z":case"SURFACE_r_\u03B8z_AMBIGUOUS":case"SURFACE_r_\u03B8\u03C6":case"SURFACE_r_\u03B8\u03C6_AMBIGUOUS":case"SURFACE":case"SURFACE_AMBIGUOUS":case"IMPLICIT_SURFACE":case"IMPLICIT_SURFACE_AMBIGUOUS":return!0;default:return!1}}function yO(t){return t.formula.expression_type==="IMPLICIT_SURFACE"||t.formula.expression_type==="IMPLICIT_SURFACE_AMBIGUOUS"}function bO(t){return!t.formula.is_inequality&&(t.formula.expression_type==="X_OR_Y"||t.formula.expression_type==="IMPLICIT"||t.formula.expression_type==="SURFACE_AMBIGUOUS"||t.formula.expression_type==="IMPLICIT_SURFACE_AMBIGUOUS")}function Wv(t){return!t.formula.is_inequality&&(t.formula.expression_type==="POLAR"||t.formula.expression_type==="SURFACE_r_\u03B8z_AMBIGUOUS"||t.formula.expression_type==="SURFACE_r_\u03B8\u03C6_AMBIGUOUS")}function Rh(t){return t.formula.expression_type==="POLAR"}function bg(t){return t.formula.expression_type==="SURFACE_r_\u03B8z"||t.formula.expression_type==="SURFACE_r_\u03B8z_AMBIGUOUS"}function pa(t){return t.formula.expression_type==="SURFACE_z_r\u03B8"}function Ua(t){return t.formula.expression_type==="SURFACE_r_\u03B8\u03C6"||t.formula.expression_type==="SURFACE_r_\u03B8\u03C6_AMBIGUOUS"}function jv(t){return t.formula.expression_type==="SURFACE_xyz_uv"}function wO(t){let e=t.formula.typed_constant_value;if(!e)return!1;let r=e.valueType;return r===__dcg_shared_module_exports__['lb']||r===__dcg_shared_module_exports__['mb']||r===__dcg_shared_module_exports__['nb']||r===__dcg_shared_module_exports__['ob']}function xO(t){if(gl(t))return!0;let e=t.formula.typed_constant_value;if(!e)return!1;let r=e.valueType;return r===__dcg_shared_module_exports__['bb']||r===__dcg_shared_module_exports__['cb']||r===__dcg_shared_module_exports__['lb']||r===__dcg_shared_module_exports__['mb']||r===__dcg_shared_module_exports__['nb']||r===__dcg_shared_module_exports__['ob']}function Ks(t){return t.formula.expression_type==="SINGLE_POINT"}function vO(t){return t.formula.expression_type==="POINT_LIST"}function gl(t){return t.formula.expression_type==="POINT_LIST"||t.formula.expression_type==="SINGLE_POINT"}function Nh(t){let e=qa(t);return!!(e&&e.type==="visualization"&&e.symbol==="boxplot")}function Od(t){let e=qa(t);return!!(e&&e.type==="visualization"&&e.symbol==="dotplot")}function Hp(t){let e=qa(t);return!!(e&&e.type==="visualization"&&e.symbol==="histogram")}function Jv(t){var e=Nh(t)||Od(t)||Hp(t);return e}function Yv(t){return t.formula.expression_type==="TTEST"}function CO(t){return t.formula.expression_type==="STATS"}function Bh(t){let e=qa(t);return!!(e&&e.type==="distribution")}function DO(t){let{formula:e}=t;return e?!!e.is_discrete_distribution:!1}function by(t){var r,i;let e=(i=(r=t.formula)==null?void 0:r.geometry)==null?void 0:i.valueType;if(e!==void 0)return __dcg_shared_module_exports__['yb'](e,__dcg_shared_module_exports__['bb'])}function qa(t){if(t.controller.areDistributionsEnabled()&&t.latex)return(!t.cachedParseToplevelFunction||t.cachedParseToplevelFunction.latex!==t.latex)&&(t.cachedParseToplevelFunction={latex:t.latex,spec:__dcg_shared_module_exports__['jc'](t.latex)}),t.cachedParseToplevelFunction.spec}function iI(t){return wy(t)&&Bh(t)}function wy(t){return!!t.formula.expression_type}function nI(t){return!!t.formula.is_concrete_list}function zc(t){return!iI(t)||nI(t)?!1:t.cdf.show}function xy(t){return t.cdf.min}function vy(t){return t.cdf.max}function SO(t){var e=NV(t.formula.cdf_min_default);return e===-1/0?"-\\infty":isFinite(e)?e+"":"-\\infty"}function EO(t){var e=NV(t.formula.cdf_max_default);return e===1/0?"\\infty":isFinite(e)?e+"":"\\infty"}function kO(t,e){t.cdf=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},t.cdf),{show:e})}function Xv(t,e){t.cdf=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},t.cdf),{min:e})}function Qv(t,e){t.cdf=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},t.cdf),{max:e})}function Cy(t){return!!t.formula&&t.formula.cdf_min_valid!==!1}function Dy(t){return!!t.formula&&t.formula.cdf_max_valid!==!1}function oI(t){return!!t.formula&&t.formula.fill_opacity_valid!==!1}function GO(t){return!!t.formula&&t.formula.line_opacity_valid!==!1}function VO(t){return!!t.formula&&t.formula.point_opacity_valid!==!1}function sI(t){return!!t.formula&&t.formula.label_size_valid!==!1}function aI(t){return!!t.formula&&t.formula.label_angle_valid!==!1}function Zv(t){return!!t.formula&&t.formula.point_size_valid!==!1}function eC(t){return!!t.formula&&t.formula.line_width_valid!==!1}function IO(t){return!!t.formula&&t.formula.checkers_valid!==!1}function tC(t){return!!t.formula&&t.formula.resolution_valid!==!1}function MO(t){return!!t.formula&&t.formula.color_latex_valid!==!1}function TO(t){return t.formula&&t.formula.color_latex_value}function AO(t){return t.formula&&t.formula.label_angle_value}function rC(t){var e=t.formula&&t.formula.cdf_evaluation;return isFinite(e)?e:0}function lI(t){return!(!__dcg_shared_module_exports__['qc'](t.formula.expression_type)||t.reconciledDragMode&&t.reconciledDragMode!=="NONE")}function LO(t){t.showLabel=__dcg_shared_module_exports__['Rc'].showLabel,t.label=__dcg_shared_module_exports__['Rc'].label,t.hidden=__dcg_shared_module_exports__['Rc'].hidden,t.dragMode=__dcg_shared_module_exports__['Rc'].dragMode,t.fill=__dcg_shared_module_exports__['Rc'].fill,t.points=__dcg_shared_module_exports__['Rc'].points,t.pointStyle=__dcg_shared_module_exports__['Rc'].pointStyle,t.lines=__dcg_shared_module_exports__['Rc'].lines,t.lineStyle=__dcg_shared_module_exports__['Rc'].lineStyle,t.slider=__dcg_shared_module_exports__['Sc'],t.latex="",t.labelSize="",t.labelOrientation="default",t.displayEvaluationAsFraction=__dcg_shared_module_exports__['Rc'].displayEvaluationAsFraction,t.strictIntersection=__dcg_shared_module_exports__['Rc'].strictIntersection,t.suppressTextOutline=!1,t.interactiveLabel=!1,t.editableLabelMode=__dcg_shared_module_exports__['Rc'].editableLabelMode,__dcg_shared_module_exports__['Jc'](__dcg_shared_module_exports__['Qc'],t)}function PO(t){return!!t.formula.move_strategy}function iC(t,e){var r=t.cachedViewState;return e.stripDefaults?__dcg_shared_module_exports__['Nc'](r):r}function o4(t){t.cachedViewState={type:t.type,id:t.id,title:t.title,hidden:t.hidden,readonly:t.readonly,collapsed:t.collapsed,secret:t.secret}}function s4(t){t.cachedUndoRedoDiffState=t.cachedViewState,t.cachedUndoRedoFullState=t.cachedViewState}function OO(t,e){let r=__dcg_shared_module_exports__['N'](__dcg_shared_module_exports__['Mc'](t));return __dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['b']({},r),$c(e)),{cachedUndoRedoDiffState:{},cachedUndoRedoFullState:{},cachedViewState:{}})}function _O(t){a4(t),Wc(t),o4(t),s4(t)}function a4(t){var e=t.controller,r=e.getAllSelectedItems();t.collapsedChildIsSelected=t.collapsed&&__dcg_shared_module_exports__['o'](r,i=>i.type!=="folder"&&i.folderId===t.id)}var l4={id:!1,type:!1,hidden:!0,secret:!0,collapsed:!0,title:!0,readonly:!0};function FO(t,e){__dcg_shared_module_exports__['Ic']({from:e,to:t,props:l4})}function wg(t,e){t.collapsed=e}function RO(t,e){t.title=e}function NO(t,e){t.hidden=e}var KO={folderId:"",text:"",secret:!1,readonly:!1};function UO(t){return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['b']({},KO),t)}function qO(t){return __dcg_shared_module_exports__['Fc'](KO,t)}function HO(t,e){t.text=e}function zO(t,e){let r=__dcg_shared_module_exports__['N'](UO(t));return __dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['b']({},r),$c(e)),{cachedUndoRedoDiffState:{},cachedUndoRedoFullState:{},cachedViewState:{}})}function $O(t){Wc(t),d4(t),h4(t)}var c4={id:!1,type:!1,folderId:!0,text:!0,secret:!0,readonly:!0};function WO(t,e){__dcg_shared_module_exports__['Ic']({from:e,to:t,props:c4})}function oC(t,e){var r=t.cachedViewState;return e.stripDefaults?qO(r):r}function d4(t){t.cachedViewState={type:t.type,id:t.id,folderId:t.folderId,text:t.text,secret:t.secret,readonly:t.readonly}}function h4(t){t.cachedUndoRedoDiffState=t.cachedViewState,t.cachedUndoRedoFullState=t.cachedViewState}var p4=0;function u4(){return"helper_item_"+p4++}function JO(t){return __dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},t),{formula:__dcg_shared_module_exports__['oc'](),guid:u4(),cachedParsableState:{type:"statement",id:t.id,latex:t.latex,shouldGraph:!1}})}function YO(t,e,r){var l;e.formula=r;let i=e.proxy,n={numericValue:i.numericValue,listValue:i.listValue},{constant_value:o,zero_values:s}=r,a=o!=null?o:(l=(s||[])[0])==null?void 0:l.val;i.numericValue=__dcg_shared_module_exports__['J'](a)?a:NaN,i.listValue=__dcg_shared_module_exports__['H'](a)&&__dcg_shared_module_exports__['n'](a,__dcg_shared_module_exports__['J'])?a.slice(0):void 0,__dcg_shared_module_exports__['F'](i.numericValue,n.numericValue)||t.runAfterDispatch(()=>{i.notifyPropertyChange("numericValue")}),__dcg_shared_module_exports__['F'](i.listValue,n.listValue)||t.runAfterDispatch(()=>{i.notifyPropertyChange("listValue")})}Oe();var cI={enabled:!1,latex:"",hoveredImage:"",depressedImage:""},sC={center:"\\left(0,0\\right)",angle:"0",width:"10",height:"10",opacity:"1",clickableInfo:cI,description:"",draggable:!1},XO=__dcg_shared_module_exports__['b']({folderId:"",hidden:!1,secret:!1,readonly:!1,foreground:!1,name:""},sC);function QO(t){return __dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['b']({},XO),t),{clickableInfo:__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['b']({},cI),t.clickableInfo)})}function ZO(t){var e=__dcg_shared_module_exports__['Fc'](XO,t),r=__dcg_shared_module_exports__['Gc'](cI,t.clickableInfo);return r===void 0?delete e.clickableInfo:e.clickableInfo=r,e}function dI(t){return __dcg_shared_module_exports__['Kc'](t,sC)}function e_(t){return __dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({type:"image",id:t.id},dI(t)),{guid:"",index:0,color:"",shouldGraph:t.hidden,showPoints:!1})}function t_(t,e){t.hidden=e}function ya(t,e,r){t[e]=r}function r_(t,e){return t[e]}function i_(t,e){t.description=e}function n_(t,e){t.name=e}function hI(t,e){t.draggable=e}function xg(t){if(t.formula){var e=t.formula.center_reference_id,r=t.formula.center_reference_symbol;if(!(!e||!r)){var i=t.controller.getItemModel(e);if(!(!i||i.type!=="expression")&&i.formula.assignment===r&&Ks(i))return i}}}function m4(t){var e=xg(t);if(!e)return!1;var r=e.reconciledDragMode;return!(!r||r==="NONE")}function jc(t){return t.draggable?m4(t):!1}function o_(t){if(!t.formula||!t.formula.center_is_point_literal)return!1;var e=t.formula.move_strategy;if(!e)return!1;var r=e[2],i=e[3],n=r&&r.type!=="none",o=i&&i.type!=="none";return!!(n||o)}function s_(t,e){t.opacity=e}function pI(t,e){t.foreground=e}function a_(t,e){t.image_url=e}function lC(t,e){e(t.opacity,"imageOpacity",t),e(t.center,"imageCenter",t),e(t.height,"imageHeight",t),e(t.width,"imageWidth",t),e(t.angle,"imageAngle",t)}function f4(t){let e=e_(t);e.color=t.color,e.index=t.index,e.guid=t.guid,e.shouldGraph=t.shouldGraph,e.showPoints=t.showPoints,t.cachedParsableState=e}function l_(t){t.draggingOnGraphpaper?t.preTransientState||(t.preTransientState={center:t.center,width:t.width,height:t.height}):delete t.preTransientState,Wc(t);let e=ma(t);t.shouldGraph=e&&e.hidden?!1:!t.hidden,t.showPoints=t.shouldGraph&&Ha(t)&&t.loadStatus==="loaded"&&!jc(t)&&t.controller.isTraceEnabled(),b4(t),w4(t),f4(t)}function c_(t,e){t.formula=e,t.error=y4(t)}function cC(t){return t.formula?t.formula.variables||[]:[]}function y4(t){var e={scale:t.controller.s("graphing-calculator-error-log-axes-image"),center:t.controller.s("graphing-calculator-error-image-invalid-center"),angle:t.controller.s("graphing-calculator-error-image-invalid-angle"),width:t.controller.s("graphing-calculator-error-image-invalid-width"),height:t.controller.s("graphing-calculator-error-image-invalid-height"),opacity:t.controller.s("graphing-calculator-error-image-invalid-opacity")};for(var r in t.formula.errorMap){var i=t.formula.errorMap[r];if(i)return e[r]}}function d_(t,e){return!t.formula||!t.formula.errorMap?!1:!!t.formula.errorMap[e]}function dC(t,e){var r=t.cachedViewState;return e.stripDefaults?ZO(r):r}function b4(t){var e=t.cachedViewState.clickableInfo,r=!0,i=!0;if(e&&(e.depressedImage===t.clickableInfo.depressedImage&&(i=!1),e.hoveredImage===t.clickableInfo.hoveredImage&&(r=!1)),r&&(t.hoveredImageObj&&(I(t.hoveredImageObj).off("load"),delete t.hoveredImageObj),t.clickableInfo.hoveredImage)){t.hoveredImageObj=new Image;var n=function(){var s=t.controller.getGrapher();s&&s.redrawAllLayers()},o=function(){};aC(t.hoveredImageObj,t.clickableInfo.hoveredImage,n,o)}if(i&&(t.depressedImageObj&&(I(t.depressedImageObj).off("load"),delete t.depressedImageObj),t.clickableInfo.depressedImage)){t.depressedImageObj=new Image;var n=function(){var l=t.controller.getGrapher();l&&l.redrawAllLayers()},o=function(){};aC(t.depressedImageObj,t.clickableInfo.depressedImage,n,o)}if(t.cachedViewState.image_url!==t.image_url){I(t.imageObj).off("load"),t.imageObj=new Image;let s=function(){t.controller.dispatch({type:"image-load-success",id:t.id})},a=function(){t.controller.dispatch({type:"image-load-error",id:t.id})};aC(t.imageObj,t.image_url,s,a)}t.cachedViewState=__dcg_shared_module_exports__['b']({type:t.type,id:t.id,folderId:t.folderId,image_url:t.image_url,name:t.name,hidden:t.hidden,foreground:t.foreground,secret:t.secret,readonly:t.readonly},dI(t))}function uI(t,e){t.draggingOnGraphpaper=e}function w4(t){var e=t.cachedViewState;t.cachedUndoRedoFullState=t.cachedViewState,t.preTransientState&&(e=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['b']({},e),t.preTransientState)),t.cachedUndoRedoDiffState=e}function x4(t){var e=document.createElement("canvas");e.width=2,e.height=2;var r=e.getContext("2d");return r.drawImage(t,0,0,2,2),e.toDataURL()}function aC(t,e,r,i){I(t).on("load.initial-image-load",function(){var n=t.width,o=t.height;n===1&&o===1?(I(t).off(".initial-image-load"),I(t).on("load",r),t.src=x4(t)):r()}).on("error",i),/^data:/.test(e)||(t.crossOrigin="anonymous"),t.src=e}function h_(t,e){let r=__dcg_shared_module_exports__['N'](QO(t));return __dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['b']({},r),$c(e)),{color:__dcg_shared_module_exports__['T'].BLUE,loadStatus:"loading",failures:0,imageObj:new Image,hoveredImageObj:void 0,depressedImageObj:void 0,shouldGraph:void 0,showPoints:void 0,error:void 0,formula:void 0,draggingOnGraphpaper:!1,cachedViewState:{},cachedParsableState:{},cachedUndoRedoDiffState:{},cachedUndoRedoFullState:{}})}var v4=__dcg_shared_module_exports__['b']({id:!1,type:!1,image_url:!0,name:!0,folderId:!0,hidden:!0,secret:!0,readonly:!0,foreground:!0},__dcg_shared_module_exports__['Lc'](sC));function p_(t,e){__dcg_shared_module_exports__['Ic']({from:e,to:t,props:v4})}function u_(t){let{controller:e,files:r,id:i}=t,n={errors:[],tokens:[]};for(let o=0;o<r.length;o++){let s=r[o];if(!s.type.match("image/*")){n.errors.push(e.s("graphing-calculator-error-image-invalid-file",{file:s.name}));continue}n.tokens.push(D4({controller:e,file:s,id:i}))}return n}var C4=0;function D4(t){let{controller:e,file:r,id:i}=t,n=""+C4++;return e.getGraphSettings().config.imageUploadCallback(r,(o,s)=>{setTimeout(()=>{if(o)e.dispatch({type:"image-upload-error",token:n,error:o});else{let a=new Image;aC(a,s,function(){var d=a.width,u=a.height,p=Math.max(d,u)/Math.min(d,u);d<u?(u=10,d=Math.round(10*u/p)/10):(d=10,u=Math.round(10*d/p)/10),e.dispatch({type:"image-upload-success",token:n,url:s,width:d+"",height:u+"",name:r.name,id:i})},function(){e.dispatch({type:"image-upload-error",token:n,error:!0})})}})}),n}function hC(t,e){t.loadStatus=e,e==="loaded"&&(t.failures=0),e==="failed"&&(t.failures+=1)}function gI(t){t.imageObj.src=t.imageObj.src,hC(t,"loading")}function pC(t,e,r){t.clickableInfo=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},t.clickableInfo),{[e]:r})}function g_(t,e){t.clickableInfo=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},t.clickableInfo),{latex:e})}function uC(t){return!!(t.clickableInfo.enabled&&t.formula&&t.formula.click_handler&&t.formula.click_handler.status==="maybe-valid")}var Cg={handlerLatex:"",minStepLatex:"",open:!1,playing:!1};function m_(t){return __dcg_shared_module_exports__['Gc'](Cg,t)}function f_(t){return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['b']({},Cg),t)}var y_="dcg_ticker_guid_internal",S4=y_;function b_(){return mI(Cg)}function E4(t){t.cachedParsableState={type:"ticker",id:t.id,handlerLatex:t.handlerLatex,minStepLatex:t.minStepLatex,shouldGraph:!1}}function w_(t,e){return e.stripDefaults?m_(t.cachedViewState):t.cachedViewState}function x_(t){return t.cachedUndoRedoDiffState}function v_(t){return t.cachedUndoRedoFullState}function k4(t){t.cachedViewState={handlerLatex:t.handlerLatex,minStepLatex:t.minStepLatex,playing:t.playing,open:t.open}}function G4(t){var e=t.cachedViewState;t.cachedUndoRedoDiffState=e,t.cachedUndoRedoFullState=e}function mI(t){let e=f_(t);return __dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},e),{type:"ticker",guid:y_,id:S4,avgDelta:0,lastTickTime:void 0,cachedViewState:{},cachedParsableState:{},cachedUndoRedoDiffState:{},cachedUndoRedoFullState:{},filteredBySearch:!1})}function C_(t,e){__dcg_shared_module_exports__['Jc'](e,t)}function D_(t,e){t.formula=e}function S_(t){k4(t),G4(t),E4(t)}function E_(t,{currentFrameTime:e,previousFrameTime:r}){var s,a;if(!t.playing||((s=t.formula)==null?void 0:s.handler.status)!=="maybe-valid")return!1;if(t.lastTickTime==null||r==null)return!0;if(((a=t.formula)==null?void 0:a.minStep.status)!=="valid")return!1;let i=t.formula.minStep.value,n=t.lastTickTime+i;if(e>=n)return!0;let o=e-r;return n-e<o/2}function k_(t,e){t.lastTickTime=e}function G_(t){if(t.formula)return t.formula.handler.status==="error"?t.formula.handler.error:void 0}function V_(t){if(t.formula)return t.formula.minStep.status==="error"?t.formula.minStep.error:void 0}function Sy(t){var e;return((e=t.formula)==null?void 0:e.variables)||[]}function gC(t,e){e(t.handlerLatex,"tickerHandler",t),e(t.minStepLatex,"tickerMinStep",t)}var kg="**dcg_geo_expression_edit_tool_preview**";function I_(t){return{controller:t,__itemModelArray:[],__itemIdToModel:{},__helperIdToModel:{},__toolPreviewIdToModel:{},__anyDependsOnRandomSeed:!1,__anyIsAction:!1,selectedItemMap:{},drawOrder:[],colorIdx:0,expressionAnalysis:{},nextDisplayIndex:1,ticker:b_()}}function M_(t){for(var e=0;e<t.__itemModelArray.length;e++){var r=t.__itemModelArray[e];if(r.type==="image"&&r.loadStatus==="loading")return!0}return!1}function T_(t){var e=__dcg_shared_module_exports__['m'](__dcg_shared_module_exports__['D'](t.controller.getColors()),i=>i!=__dcg_shared_module_exports__['T'].ORANGE),r=e[t.colorIdx];return t.colorIdx=(t.colorIdx+1)%e.length,r}function Gg(t,e){return t.__itemModelArray[e]}function Vg(t){for(let e=0;e<t.__itemModelArray.length;e++){let r=t.__itemModelArray[e];if(Ig(r))return r}}function yC(t){for(let e=t.__itemModelArray.length-1;e>=0;e--){let r=t.__itemModelArray[e];if(Ig(r))return r}}function zp(t,e){var r;do{if(e--,e===-1)return;r=Gg(t,e)}while(r&&!Ig(r));return r}function $p(t,e){var r,i=ky(t);do{if(e++,e===i)return;r=Gg(t,e)}while(r&&!Ig(r));return r}function ma(t){if(t.type!=="folder"&&t.folderId){let e=t.controller.getListModel(),r=Xl(e,t.folderId);if(r&&r.type==="folder")return r}}function A_(t,e){let r=Xl(t,e);if(!r||r.type!=="folder")return 0;let i=0,n=t.__itemModelArray.length;for(var o=r.index+1;o<n;o++){let s=t.__itemModelArray[o];if(s.type==="folder"||s.folderId!==e)break;i+=1}return i}function L_(t,e){let r=Xl(t,e);if(!r||r.type!=="folder")return[];let i=[],n=t.__itemModelArray.length;for(var o=r.index+1;o<n;o++){let s=t.__itemModelArray[o];if(s.type==="folder"||s.folderId!==e)break;i.push(s.id)}return i}function P_(t,e){let r=[],i=Xl(t,e);if(!i||i.type!=="folder")return r;let n=t.__itemModelArray.length;for(let o=i.index+1;o<n;o++){let s=t.__itemModelArray[o];if(s.type==="folder"||s.folderId!==e)break;r.push(s)}return r}function fI(t){return!!(t&&t.readonly)}function Ey(t){if(!t)return!1;if(t.secret)return!0;let e=ma(t);return!!(e&&e.secret)}function Ig(t){return!yI(t)}function O_(t){return t.id===__dcg_shared_module_exports__['Oc']||t.type!=="folder"&&t.folderId===__dcg_shared_module_exports__['Oc']}function yI(t){if(!t||t.filteredBySearch||O_(t))return!0;if(t.controller.isItemBeingDragged(t.id))return!!t.controller.shouldRenderDraggedItemAsToken();if(!t.controller.shouldShowAuthorFeatures()&&Ey(t))return!0;let r=ma(t);return!!(r&&r.collapsed&&!t.controller.getExpressionSearchStr())}function bI(t){return t.__itemModelArray}function __(t){return __dcg_shared_module_exports__['D'](t.__helperIdToModel)}function Mg(t){return __dcg_shared_module_exports__['D'](t.__toolPreviewIdToModel)}function Tg(t,e){for(var r=0;r<t.__itemModelArray.length;r++){var i=t.__itemModelArray[r];Sg(i,e)}for(var n in t.__toolPreviewIdToModel)Sg(t.__toolPreviewIdToModel[n],e);t.ticker.open&&(e(t.ticker.handlerLatex,"tickerHandler",t.ticker),e(t.ticker.minStepLatex,"tickerMinStep",t.ticker))}function Sg(t,e){switch(t.type){case"expression":Ov(t,e);break;case"table":DC(t,e);break;case"image":lC(t,e);break;case"ticker":gC(t,e);break;case"folder":case"text":break;default:return t}}function Dg(t,e){return!!t.replace(/([_^])([a-z0-9])/gi,"$1{$2}").match(e)}function F_(t,e){if(!ha(e))return!1;let i=!1;return Tg(t,n=>{jl(n,e)&&(i=!0)}),i}function R_(t,e){let r=0,i=ha(e);t.ticker.filteredBySearch=t.ticker.open&&!jl(t.ticker.handlerLatex,e)&&!jl(t.ticker.minStepLatex,e);for(let n of t.__itemModelArray){if(!i){n.filteredBySearch=!1,r++;continue}switch(n.filteredBySearch=!0,n.type){case"expression":Ov(n,s=>{jl(s,e)&&(n.filteredBySearch=!1,r++)}),n.label&&n.showLabel&&n.label.match(fC(e))&&(n.filteredBySearch=!1,r++);break;case"table":DC(n,s=>{jl(s,e)&&(n.filteredBySearch=!1,r++)});break;case"image":lC(n,s=>{jl(s,e)&&(n.filteredBySearch=!1,r++)});break;case"folder":case"text":break;default:return n}!n.filteredBySearch&&n.type!=="folder"&&n.folderId&&(t.__itemIdToModel[n.folderId].filteredBySearch=!1,r++)}return r}function N_(t,e){let r=0,i=SP(e);t.ticker.filteredBySearch=t.ticker.open&&!Dg(t.ticker.handlerLatex,i)&&!Dg(t.ticker.minStepLatex,i);for(var n=0;n<t.__itemModelArray.length;n++){if(!e){t.__itemModelArray[n].filteredBySearch=!1;continue}var o=t.__itemModelArray[n];switch(o.filteredBySearch=!0,o.type){case"expression":Ov(o,a=>{Dg(a,i)&&(o.filteredBySearch=!1,r++)}),o.label&&o.showLabel&&(e==="\\operatorname{label}"||e.length>1&&"label".indexOf(e)===0||Dg(o.label,i))&&(o.filteredBySearch=!1,r++);break;case"table":DC(o,a=>{Dg(a,i)&&(o.filteredBySearch=!1,r++)});break;case"image":lC(o,a=>{Dg(a,i)&&(o.filteredBySearch=!1,r++)});break;case"folder":o.title&&o.title.indexOf(e)>=0&&(o.filteredBySearch=!1,r++);break;case"text":o.text.indexOf(e)>=0&&(o.filteredBySearch=!1,r++);break;default:return o}!o.filteredBySearch&&o.type!=="folder"&&o.folderId&&(t.__itemIdToModel[o.folderId].filteredBySearch=!1,r++)}return r}function fC(t,e){return new RegExp("\\$\\{"+t.replace("{","\\{?").replace("}","\\}?").replace("_","\\_?")+"\\}",e)}function B_(t,e){let r=0;for(var i=0;i<t.__itemModelArray.length;i++){var n=t.__itemModelArray[i];if(n.type==="expression"&&n.showLabel&&n.label){let o=n.label.match(fC(e,"g"));o&&(r+=o.length)}}return Tg(t,o=>{r+=Sv(o,e).length}),r}function Kh(t,e,r,i){r=r.trim().replace(/_\{([a-zA-Z0-9])\}/g,"_$1");for(var n=0;n<t.__itemModelArray.length;n++){var o=t.__itemModelArray[n];o.type==="expression"&&o.showLabel&&o.label&&o.label.match(fC(e))&&Pd(o,o.label.replace(fC(e,"g"),"${"+r.trim()+"}"))}Tg(t,(s,a,l,c)=>{if(i&&i.limitToItem!==void 0&&i.limitToItem!==l.id||i&&i.limitToFolder!==void 0&&(l.type==="ticker"||l.type==="folder"||i.limitToFolder!==l.folderId))return;let d=Ev(s,e,r);if(d!==s){let u;switch(c&&l.columnModels&&(u=l.columnModels[c.cellLocation.column].id),a){case"latex":{Bs(l,d);break}case"cdfMin":{Xv(l,d);break}case"cdfMax":{Qv(l,d);break}case"colorLatex":{gy(l,d);break}case"lineWidth":{mg(l,d);break}case"resolution":{Rv(l,d);break}case"checkers":{Nv(l,d);break}case"clickableInfoLatex":{Mv(l,d);break}case"fillOpacity":{hy(l,d);break}case"lineOpacity":{gg(l,d);break}case"pointOpacity":{py(l,d);break}case"pointSize":{uy(l,d);break}case"labelAngle":{Uv(l,d);break}case"labelSize":{my(l,d);break}case"polarDomainMin":{iy(l,d);break}case"polarDomainMax":{ay(l,d);break}case"parametricDomainMin":{ny(l,d);break}case"parametricDomain3DuMin":{oy(l,d);break}case"parametricDomain3DvMin":{sy(l,d);break}case"parametricDomainMax":{ly(l,d);break}case"parametricDomain3DuMax":{cy(l,d);break}case"parametricDomain3DvMax":{dy(l,d);break}case"sliderMin":{hg(l,d);break}case"sliderMax":{pg(l,d);break}case"sliderStep":{ry(l,d);break}case"imageOpacity":{ya(l,"opacity",d);break}case"imageCenter":{ya(l,"center",d);break}case"imageHeight":{ya(l,"height",d);break}case"imageWidth":{ya(l,"width",d);break}case"imageAngle":{ya(l,"angle",d);break}case"tickerHandler":{l.handlerLatex=d;break}case"tickerMinStep":{l.minStepLatex=d;break}case"tableHeader":case"tableCellValue":if(!c||l.type!=="table")break;Fd(l,c.cellLocation,d);break;case"tableColumnColorLatex":{u&&VC(l,u,d);break}case"tableColumnPointSize":{u&&kC(l,u,d);break}case"tableColumnPointOpacity":{u&&GC(l,u,d);break}case"tableColumnLineWidth":{u&&SC(l,u,d);break}case"tableColumnLineOpacity":{u&&EC(l,u,d);break}case"residualVariable":break;default:{let p=a;throw new Error(`Unexpected latex location ${p}`)}}}})}function bC(t){var e=[];Tg(t,function(n){if(!(n.indexOf("~")!==-1||n.indexOf("\\sim")!==-1))for(var o=/_(\d)|_\{(?:\s|\\space)*(\d+)(?:\s|\\space)*\}/g;;){var s=o.exec(n);if(!s)break;e.push(parseInt(s[1]||s[2],10))}}),e.sort(function(n,o){return n-o});for(var r=1,i=0;i<e.length;i++)e[i]===r&&r++;return r}function K_(t){var e=0;return Tg(t,function(r){for(var i=/\\token\{(\d+)\}/g;;){var n=i.exec(r);if(!n)break;var o=parseInt(n[1],10);o>e&&(e=o)}}),e}function U_(t){var e={};return Tg(t,function(r){if(!(r.indexOf("~")!==-1||r.indexOf("\\sim")!==-1))for(var i=/(\\?[a-zA-Z]+)_(\d)|(\\?[a-zA-Z]+)_\{(?:\s|\\space)*(\d+)(?:\s|\\space)*\}/g;;){var n=i.exec(r);if(!n)break;var o=n[1]||n[3],s=n[2]||n[4];o[0]!=="\\"&&(o=o[o.length-1]);var a=parseInt(s,10);e[o]||(e[o]=0),a>e[o]&&(e[o]=a)}}),e}function q_(t,e){var r=[],i={points:[],angles:[],polygons:[],other:[]};function n(o){if(!(M4(t,o.id)&&e!=="actual")&&!(o.id===kg&&e!=="preview")){if(o.type==="expression"&&o.folderId===__dcg_shared_module_exports__['Oc']){gl(o)?i.points.push(o.id):wO(o)?i.angles.push(o.id):qc(o)?i.polygons.push(o.id):i.other.push(o.id);return}o.type==="table"?__dcg_shared_module_exports__['k'](o.columnModels,function(s){r.push(s.id)}):r.push(o.id)}}t.__itemModelArray.forEach(n),Mg(t).forEach(n),r.push.apply(r,i.polygons),r.push.apply(r,i.other),r.push.apply(r,i.angles),r.push.apply(r,i.points),t.drawOrder=r}function Xl(t,e,r){let i=t.__itemIdToModel[e];if(i)return i;if(r&&r.includePreviewItems)return t.__toolPreviewIdToModel[e]}function Ag(t,e){var o;for(var r=[],i=0;i<t.__itemModelArray.length;i++){var n=t.__itemModelArray[i];n.type==="expression"&&((o=hs(n))==null?void 0:o.identifier)===e&&r.push(n)}return r}function V4(t,e){return t.__helperIdToModel[e]}function H_(t,e){var r=JO(e);t.__helperIdToModel[r.id]=r}function wI(t){t.__anyDependsOnRandomSeed=!1;for(var e=0;e<t.__itemModelArray.length;e++){var r=t.__itemModelArray[e];if(r&&"formula"in r&&r.formula&&r.formula.depends_on_random_seed){t.__anyDependsOnRandomSeed=!0;return}}}function z_(t){t.__anyIsAction=!1}function wC(t){if(!t.__anyIsAction){if(t.ticker.open){t.__anyIsAction=!0;return}for(var e=0;e<t.__itemModelArray.length;e++){var r=t.__itemModelArray[e];if(r&&"formula"in r&&r.formula){if(r.type!=="expression"&&r.type!=="image")continue;let{formula:i}=r;if(i.hasOwnProperty("action_value")||i.hasOwnProperty("click_handler")){t.__anyIsAction=!0;return}}}}}function Wp(t){for(var e=!t.controller.shouldShowAuthorFeatures(),r=1,i=1,n=0;n<t.__itemModelArray.length;n++){var o=t.__itemModelArray[n];o.index=n,o.displayIndex=r,Ey(o)&&(o.secretIndex=i,i+=1),!O_(o)&&(!e||!Ey(o))&&(r+=1)}for(var s in t.selectedItemMap)t.__itemIdToModel[s]||delete t.selectedItemMap[s];t.nextDisplayIndex=r}function I4(t){t.__itemModelArray=[],t.__itemIdToModel={},t.__helperIdToModel={},t.__toolPreviewIdToModel={},t.__anyDependsOnRandomSeed=!1}function xI(t,e){let r={},i=[];return e.forEach(n=>{let o=t.__itemIdToModel[n];if(o&&!fI(o)){let s=Og(t,n);for(let a of s)r[a.id]||(r[a.id]=!0,i.push(a))}}),i}function ky(t){return t.__itemModelArray.length}function $_(t){return t.nextDisplayIndex===1}function W_(t){for(var e=[],r=0;r<t.__itemModelArray.length;r++){var i=t.__itemModelArray[r];i.type==="expression"&&i.sliderExists&&e.push(i)}return e}function Lg(t){var e;for(var r in t.selectedItemMap){if(e!==void 0)return;e=r}if(e!==void 0)return t.__itemIdToModel[e]}function M4(t,e){return!!t.selectedItemMap[e]}function j_(t){return __dcg_shared_module_exports__['b']({},t.selectedItemMap)}function xC(t){var e=[];for(var r in t.selectedItemMap)e.push(t.__itemIdToModel[r]);return e}function J_(t){return{list:t.__itemModelArray.map(function(e){return e.cachedUndoRedoDiffState}),ticker:x_(t.ticker)}}function vI(t){return{list:t.__itemModelArray.map(function(e){return e.cachedUndoRedoFullState}),ticker:v_(t.ticker)}}function Y_(t,e){let r={list:t.__itemModelArray.map(function(n){switch(n.type){case"expression":return Bp(n,e);case"image":return dC(n,e);case"table":return _g(n,e);case"folder":return iC(n,e);case"text":return oC(n,e);default:return n}})},i=w_(t.ticker,e);return i&&(r.ticker=i),r}function X_(t){let e=0,r=/^[0-9]+$/;for(var i=t.list.length-1;i>=0;i--){var n=t.list[i];let o=n.id;if(r.test(o)){let s=parseInt(o,10);s>e&&(e=s)}if(n.type==="table"&&n.columns){for(let s=n.columns.length-1;s>=0;s--)if(o=n.columns[s].id,r.test(o)){let a=parseInt(o,10);a>e&&(e=a)}}}return e}function Q_(t,e,r){r||(r={});var i,n;for(t.colorIdx=0,I4(t),t.expressionAnalysis={},i=0;i<e.list.length;i++){if(n=Eg(t,e.list[i]),r.remapColors&&"color"in n&&n.color){var o=__dcg_shared_module_exports__['D'](t.controller.getColors());__dcg_shared_module_exports__['p'](o,n.color)||(n.color=xP(n.color,o))}t.__itemModelArray.push(n),t.__itemIdToModel[n.id]=n}if(t.ticker=mI(e.ticker),Wp(t),t.nextDisplayIndex===1){var s=Eg(t,{type:"expression",id:t.controller.generateId(),color:t.controller.getNextColor()});za(t,s,t.__itemModelArray.length)}}function Eg(t,e){switch(e.type){case"expression":return Pv(e,t.controller);case"table":return aF(e,t.controller);case"image":return h_(e,t.controller);case"folder":return OO(e,t.controller);case"text":return zO(e,t.controller);default:return e}}function Z_(t,e){var r,i;let n=t.__itemIdToModel;for(t.__itemModelArray=[],t.__itemIdToModel={},r=0;r<e.list.length;r++){var o=e.list[r];if(i=n[o.id],i&&i.type===o.type)switch(i.type){case"expression":if(o.type!==i.type)throw new Error("invalid restoration");$P(i,o);break;case"table":if(o.type!==i.type)throw new Error("invalid restoration");sF(i,o);break;case"image":if(o.type!==i.type)throw new Error("invalid restoration");p_(i,o);break;case"folder":{if(o.type!==i.type)throw new Error("invalid restoration");FO(i,o)}break;case"text":if(o.type!==i.type)throw new Error("invalid restoration");WO(i,o);break;default:return i}else i=Eg(t,o);t.__itemModelArray.push(i),t.__itemIdToModel[i.id]=i}e.ticker&&C_(t.ticker,e.ticker),wI(t),wC(t),Wp(t)}function eF(t,e,r){let i=r[0]&&r[0].tableId,n=Xl(t,i||e);if(!n)return;let o;switch(n.type){case"expression":let s=!1;n.__workerNeedsDotplotXMode=!1;for(let c=0;c<r.length;c++){let d=r[c];if(d.graphMode===15){n.error=d.error;continue}"resolved"in d&&!d.resolved&&(s=!0),"boundingBox"in d&&d.boundingBox&&(o||(o=[]),o.push(d.boundingBox)),d.needsDotplotXMode&&(n.__workerNeedsDotplotXMode=!0)}n.unresolved=s,n.boundingBoxes=o;let a=1/0,l=-1/0;for(let c of r){if(c.graphMode!==6)continue;let d=c.sampledDomain;d&&(a=Math.min(a,d.min),l=Math.max(l,d.max))}isFinite(a)&&(n.__workerSampledDomainMin=a),isFinite(l)&&(n.__workerSampledDomainMax=l);return;case"table":for(let c=0;c<r.length;c++){let d=r[c];"boundingBox"in d&&d.boundingBox&&(o||(o=[]),o.push(d.boundingBox))}o&&lF(n,e,o);return;default:return}}function tF(t,e){var r,i,n,o=__dcg_shared_module_exports__['N'](t.expressionAnalysis);for(r in e){if(!e.hasOwnProperty(r))continue;n=e[r],i=Xl(t,r);let s={isGraphable:!!n.is_graphable,isError:!!n.error,errorMessage:n.error?t.controller.unpack(n.error):void 0};if(i)switch(i.type){case"expression":if(qV(i,n),n.zero_values&&n.zero_values.length===1){let c=n.zero_values[0].val;__dcg_shared_module_exports__['J'](c)&&(s.evaluation={type:"Number",value:c},s.evaluationDisplayed=!0),__dcg_shared_module_exports__['H'](c)&&c.every(__dcg_shared_module_exports__['J'])&&(s.evaluation={type:"ListOfNumber",value:c.slice()},s.evaluationDisplayed=!0)}else n.hasOwnProperty("constant_value")&&__dcg_shared_module_exports__['J'](n.constant_value)&&(s.evaluation={type:"Number",value:n.constant_value},s.evaluationDisplayed=!1);break;case"image":c_(i,n);break;case"table":oF(i,n);break;case"folder":case"text":break;default:return i}else r===t.ticker.id&&D_(t.ticker,n);let a=V4(t,r);if(a)YO(t.controller,a,n);else{let l=t.__toolPreviewIdToModel[r];l&&qV(l,n)}r!==t.ticker.id&&(o[r]=s)}wI(t),wC(t),t.expressionAnalysis=o}function ri(t,e){if(t.selectedItemMap={},!!e){if(e.type==="image"&&e.folderId){let r=Xl(t,e.folderId);r&&r.type==="folder"&&r.collapsed&&(e=r)}t.selectedItemMap[e.id]=!0}}function CI(t,e){t.selectedItemMap[e]?delete t.selectedItemMap[e]:t.selectedItemMap[e]=!0}function DI(t,e){t.selectedItemMap=__dcg_shared_module_exports__['b']({},e)}function Uh(t,e,r,i){if(e===r)return;let n=t.__itemModelArray.splice(e,i);e<r&&(r=r-i+1),t.__itemModelArray.splice.apply(t.__itemModelArray,[r,0,...n]),Wp(t)}function za(t,e,r){var i=String(e.id);if(t.__itemIdToModel.hasOwnProperty(i))throw Error("Item with id '"+i+"' is already in list");t.__itemIdToModel[i]=e,t.__itemModelArray.splice(r,0,e),Wp(t)}function Ql(t,e){za(t,e,ky(t))}function Pg(t,e){let r=[];var i=t.__itemModelArray[e];if(i.type==="folder"){let o=0,s=e+1;for(let a=s;a<t.__itemModelArray.length;a++){var n=t.__itemModelArray[a];if(n.type==="folder"||n.folderId!==i.id)break;Ha(n)&&ri(t,void 0),n.readonly?(a>s&&(t.__itemModelArray[a]=t.__itemModelArray[s],t.__itemModelArray[s]=n),No(n,""),s+=1):(delete t.__itemIdToModel[n.id],delete t.expressionAnalysis[i.id],o+=1)}o>0&&r.push(...t.__itemModelArray.splice(s,o))}return Ha(i)&&ri(t,void 0),r.push(...t.__itemModelArray.splice(e,1)),delete t.__itemIdToModel[i.id],delete t.expressionAnalysis[i.id],wI(t),Wp(t),r}function rF(t){return t.__anyDependsOnRandomSeed}function iF(t){return t.__anyIsAction}function Og(t,e){let r=Xl(t,e);return r?Pg(t,r.index):[]}function vC(t){let e=Lg(t);if(!e)return!1;let r=zp(t,e.index);return r?(ri(t,r),r.index===ky(t)-1&&e.type==="expression"&&ua(e)&&Pg(t,r.index),!0):!1}function CC(t){let e=Lg(t);if(!e)return!1;let r=$p(t,e.index);return r?(ri(t,r),!0):!1}function Ha(t){return!!t.controller.getListModel().selectedItemMap[t.id]}function Gy(t,e){t.dragState=e}function Vy(t){switch(t.type){case"expression":return Vv(t);case"image":return cC(t);case"table":return[];case"text":return[];case"folder":return[];default:return t}}function nF(t,e){for(let r of bI(t))r.type==="folder"&&wg(r,e)}var T4=30,A4=10,IC=__dcg_shared_module_exports__['T'].RED,MC=__dcg_shared_module_exports__['T'].BLUE,TC=__dcg_shared_module_exports__['T'].GREEN,AC=__dcg_shared_module_exports__['T'].PURPLE,LC=__dcg_shared_module_exports__['T'].ORANGE,PC=__dcg_shared_module_exports__['T'].BLACK;function Rd(t,e){switch(e){case __dcg_shared_module_exports__['T'].RED:return t.s("graphing-calculator-text-color-red");case __dcg_shared_module_exports__['T'].BLUE:return t.s("graphing-calculator-text-color-blue");case __dcg_shared_module_exports__['T'].GREEN:return t.s("graphing-calculator-text-color-green");case __dcg_shared_module_exports__['T'].PURPLE:return t.s("graphing-calculator-text-color-purple");case __dcg_shared_module_exports__['T'].ORANGE:return t.s("graphing-calculator-text-color-orange");case __dcg_shared_module_exports__['T'].BLACK:return t.s("graphing-calculator-text-color-black");case __dcg_shared_module_exports__['T'].GRAY:return t.s("graphing-calculator-text-color-gray");default:return t.s("graphing-calculator-text-color-unknown")}}var SI=t=>{if(!Array.isArray(t))return[t];let e=Array(Math.min(t.length,A4));for(let r=0;r<e.length;r++)e[r]=t[Math.round(r*t.length/e.length)];return e};function OC(t,e){switch(t.type){case"single-color":case"color-array":return SI(t.value).every(i=>OV(i,e));case"gradient_u":case"gradient_v":case"checkers":case"shader":case"image":return!1;default:let r=t;throw new Error("Unexpected ColorSwatchSpec type: "+r.type)}}function qh(t,e){switch(t.type){case"single-color":case"color-array":return SI(t.value).some(i=>OV(i,e));case"gradient_u":case"gradient_v":case"checkers":case"shader":case"image":return!0;default:let r=t;throw new Error("Unexpected ColorSwatchSpec type: "+r.type)}}var Fg=t=>{switch(t.type){case"single-color":return t.value;case"color-array":let e=SI(t.value);if(e.length===0)return __dcg_shared_module_exports__['T'].BLACK;if(e.length===1)return t.value[0];let r=T4/e.length;return`linear-gradient(to right${e.reduce((n,o,s)=>`${n}, ${o} ${s*r}px, ${o} ${(s+1)*r}px`,"")})`;case"gradient_u":return"linear-gradient(90deg,hsl(0, 100%, 50%),hsl(30, 100%, 50%),hsl(60, 100%, 50%),hsl(90, 100%, 50%),hsl(120, 100%, 50%),hsl(150, 100%, 50%),hsl(180, 100%, 50%),hsl(210, 100%, 50%),hsl(240, 100%, 50%),hsl(270, 100%, 50%),hsl(300, 100%, 50%),hsl(330, 100%, 50%),hsl(360, 100%, 50%)";case"gradient_v":return"linear-gradient(180deg,hsl(0, 100%, 50%),hsl(30, 100%, 50%),hsl(60, 100%, 50%),hsl(90, 100%, 50%),hsl(120, 100%, 50%),hsl(150, 100%, 50%),hsl(180, 100%, 50%),hsl(210, 100%, 50%),hsl(240, 100%, 50%),hsl(270, 100%, 50%),hsl(300, 100%, 50%),hsl(330, 100%, 50%),hsl(360, 100%, 50%)";case"checkers":return"repeating-conic-gradient(#808080 0% 25%, transparent 0% 50%) 50% / 16px 16px";case"shader":return"#808080";case"image":return'url("'+t.value+'")';default:let i=t;throw new Error("Unexpected ColorSwatchSpec type: "+i.type)}};var L4=0;function P4(){return"abstract_item_"+L4++}function $c(t){return{guid:P4(),controller:t,index:-1,displayIndex:-1,secretIndex:-1,isHiddenFromUI:!0,renderShell:!0}}function EI(t,e){t.secret=e}function _C(t,e){t.readonly=e}function No(t,e){t.type!=="folder"&&(t.folderId=e)}function Wc(t){t.isHiddenFromUI=yI(t)}function FC(t){return t.isHiddenFromUI||t.filteredBySearch?"none":t.renderShell?"shell":"render"}function Zl(t){let e=Iy(t),r=e.type==="color-array"?{type:"single-color",value:e.value[0]}:e;return Fg(r)}function Iy(t){if(!t.colorLatex)return{type:"single-color",value:t.color};switch(t.colorLatex){case"gradient_u":case"gradient_v":case"checkers":return{type:t.colorLatex};default:if(/^data:image/.test(t.colorLatex))return{type:"image",value:t.colorLatex};let e,r;return t.type==="expression"?(e=TO(t),r=MO(t)):t.type==="table-column"&&(e=hF(t),r=dF(t)),r&&e?Array.isArray(e)?{type:"color-array",value:e}:{type:"single-color",value:e}:{type:"single-color",value:t.color}}}var pF={folderId:"",secret:!1,readonly:!1},RC={latex:"",color:"",hidden:!1,values:[],points:!0,lines:!1,dragMode:"NONE",pointStyle:"POINT",lineStyle:"SOLID",colorLatex:"",lineOpacity:"",lineWidth:"",pointOpacity:"",pointSize:""};function NC(t){let e=(t.columns||[]).map(function(r){return __dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['b']({},RC),r)});return __dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['b']({},pF),t),{columns:e})}function uF(t){return t=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},t),{columns:t.columns.map(function(e){return __dcg_shared_module_exports__['Fc'](RC,e)})}),__dcg_shared_module_exports__['Fc'](pF,t)}function BC(t){return{type:"table",id:t.id,columns:t.columns.map(function(e){return __dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},e),{tableId:t.id})})}}function _4(t){return isFinite(t)?__dcg_shared_module_exports__['Gb'](t,{digits:8,bigCutoff:1e6,smallCutoff:.001}):"\\mathrm{undefined}"}function F4(t,e,r){let i=t.columnModels[e];i.error=r.error,i.discrete=r.discrete,i.disabled=r.dependent,i.draggable=!r.error&&!r.dependent,i.packedErrors=[],i.computedValues=[];let n=r.values;for(let o=n.length-1;o>=0;o--){let s=n[o];typeof s=="number"?i.computedValues[o]=_4(s):(i.computedValues[o]="",i.packedErrors[o]=s)}}function mF(t){let e=Do(t);if(!e)return;let r=Jp(t);if(!r){t.isExpanded||Rg(t,!0);return}e.row>=r.min&&e.row<r.max&&Rg(t,!0)}function Jp(t){if(t.isExpanded)return;let e=Us(t);if(!(e<30))return{min:8,max:e-4}}function fF(t,e){let r=t.columnModels[e];return{values:r.values.slice(),dragMode:r.dragMode,hidden:r.hidden,id:r.id,color:r.color,points:r.points,lines:r.lines,pointStyle:r.pointStyle,lineStyle:r.lineStyle,latex:r.latex,colorLatex:r.colorLatex,lineOpacity:r.lineOpacity,lineWidth:r.lineWidth,pointSize:r.pointSize,pointOpacity:r.pointOpacity}}var R4=0;function N4(){return"table_guid_"+R4++}function B4(t,e,r){t.columnModels[e].values.splice(r,0,"")}function K4(t,e,r){t.columnModels[e].values.splice(r,1)}function yF(t,e,r){let{color:i}=r;(!i||!lg(i))&&(i=t.controller.getNextColor());let n=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},r),{type:"table-column",guid:N4(),index:e,error:void 0,table:t,color:i,packedErrors:[],computedValues:[],discrete:void 0,shouldGraph:void 0,disabled:void 0,draggable:void 0});return e===0&&(n.hidden=!0),n}function My(t,e){var r=t.table.formula;if(!r)return!1;var i=r.column_data[t.index];return i?!!i[e]:!1}function dF(t){return My(t,"color_latex_valid")}function bF(t){return My(t,"line_opacity_valid")}function wF(t){return My(t,"line_width_valid")}function xF(t){return My(t,"point_size_valid")}function vF(t){return My(t,"point_opacity_valid")}function hF(t){var e=t.table.formula;if(e){var r=e.column_data[t.index];if(r)return r.color_latex_value}}function CF(t){t.draggingOnGraphpaper?t.preTransientState||(t.preTransientState={columns:_g(t,{stripDefaults:!1}).columns}):delete t.preTransientState,Wc(t);let e=ma(t);var r=e&&e.hidden;__dcg_shared_module_exports__['k'](t.columnModels,function(i){i.shouldGraph=!r&&!i.hidden}),q4(t),H4(t),U4(t)}function Us(t){let e=2,r,i=Do(t);return i&&i.row>e&&(e=i.row),t.columnModels.forEach(n=>{r=n.disabled?n.computedValues.length:n.values.length+1,r>e&&(e=r)}),e}function KC(t){return t.columnModels.length}function oF(t,e){t.formula=e;for(let i=0;i<e.column_data.length&&i<KC(t);i++){let n=e.column_data[i];F4(t,i,n)}let r=t.columnModels[t.columnModels.length-1];r.disabled=!0,r.error=void 0}function kI(t,e){for(let r=0;r<t.columnModels.length;r++)B4(t,r,e)}function DF(t,e){let r=Jp(t);r&&e===r.max-1&&Rg(t,!0);for(var i=0;i<t.columnModels.length;i++)K4(t,i,e),i>0&&_F(t.columnModels[i])}function UC(t,e){let r={id:t.controller.generateId(),latex:e?e.latex:"",color:t.controller.getNextColor()},i=e?e.columnIndex:t.columnModels.length,n=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['b']({},RC),r),{values:[]});var o=yF(t,i,n);t.columnModels.splice(i,0,o);for(var s=i+1;s<t.columnModels.length;s++)t.columnModels[s].index=s}function SF(t,e){t.columnModels.splice(e,1);for(var r=e;r<t.columnModels.length;r++)t.columnModels[r].index=r}function EF(t,e){var r,i=t.columnModels.length,n=[];for(r=0;r<i;r++)n.push("");var o=t.columnModels[0].values;if(e>1){var s=t.controller.isDegreeMode(),a=yn(o[0],s),l=yn(o[1],s);if(isFinite(a)&&isFinite(l)){var c=mP(a,l);if(c){var d=c.nstart,u=d/c.lcm;for(r=0;r<e;r++){var p=yn(o[r],s);if(!__dcg_shared_module_exports__['ea'](p,u))return n;d+=c.nstep,u=d/c.lcm}(""+a).length<8&&(""+l).length<8?n[0]=""+u:n[0]="\\frac{"+d+"}{"+c.lcm+"}"}}}return n}function DC(t,e){for(let n=0;n<t.columnModels.length;n++){let o=t.columnModels[n],s={cellLocation:{column:n,row:0}};e(o.latex,"tableHeader",t,s),e(o.colorLatex,"tableColumnColorLatex",t,s),e(o.pointSize,"tableColumnPointSize",t,s),e(o.pointOpacity,"tableColumnPointOpacity",t,s),e(o.lineWidth,"tableColumnLineWidth",t,s),e(o.lineOpacity,"tableColumnLineOpacity",t,s);for(var r=t.columnModels[n],i=0;i<r.values.length;i++)r.values[i]&&e(r.values[i],"tableCellValue",t,{cellLocation:{column:n,row:i+1}})}}function U4(t){let e=BC({type:"table",id:t.id,secret:t.secret,readonly:t.readonly,folderId:t.folderId,columns:t.columnModels.map(function(i){return fF(t,i.index)})});for(var r=0;r<e.columns.length;r++)e.columns[r].hidden=!t.columnModels[r].shouldGraph;t.cachedParsableState=e}function kF(t){return t.slice(0,t.length-1)}function _g(t,e){let r=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},t.cachedViewState),{columns:kF(t.cachedViewState.columns)});return e.stripDefaults?uF(r):r}function q4(t){var e=t.columnModels.map(function(r,i){return fF(t,i)});t.cachedViewState={id:t.id,type:t.type,folderId:t.folderId,columns:e,secret:t.secret,readonly:t.readonly}}function GI(t,e){t.draggingOnGraphpaper=e}function H4(t){let e=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},t.cachedViewState),{columns:kF(t.cachedViewState.columns)});t.cachedUndoRedoFullState=e,t.preTransientState&&(e=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['b']({},e),t.preTransientState)),t.cachedUndoRedoDiffState=e}var z4={id:!1,type:!1,columns:!1,folderId:!0,secret:!0,readonly:!0};function sF(t,e){__dcg_shared_module_exports__['Ic']({from:e,to:t,props:z4}),GF(t,e.columns)}function aF(t,e){let r=__dcg_shared_module_exports__['N'](NC(t)),i=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['b']({},r),$c(e)),{columnModels:void 0,formula:void 0,draggingOnGraphpaper:!1,cachedViewState:{},cachedParsableState:{},cachedUndoRedoDiffState:{},cachedUndoRedoFullState:{},isExpanded:!1});return GF(i,r.columns),i}function GF(t,e){t.columnModels=e.map(function(r,i){return yF(t,i,r)}),UC(t)}var gF=["x","y","z","u","v","w"];function VI(t,e,r){for(var i=[],n=Math.min(e.length,gF.length),o=0;o<n;o++)i.push({id:r.generateId(),latex:__dcg_shared_module_exports__['Hb'](gF[o]+"_"+t),values:e[o],color:r.getNextColor(),hidden:!1,points:!0,lines:!1,dragMode:"NONE",pointStyle:"POINT",lineStyle:"SOLID",colorLatex:"",lineWidth:"",lineOpacity:"",pointOpacity:"",pointSize:""});return{id:r.generateId(),type:"table",folderId:"",secret:!1,readonly:!1,columns:i}}function VF(t,e){let r=_g(t,{stripDefaults:!1});if(!r.columns||!e.columns)return e;for(var i=0;i<e.columns.length;i++){var n=r.columns[i],o=e.columns[i];if(n)for(var s in n)n.hasOwnProperty(s)&&(o.hasOwnProperty(s)||(o[s]=n[s]))}return e}function Do(t){var e=t.controller.getFocusLocation();if(e&&e.type==="table"&&e.id===t.id)return e.location}function Bo(t,e){for(var r=0;r<t.columnModels.length;r++){let i=t.columnModels[r];if(i.id===e)return i}}function II(t,e,r){let i=Bo(t,e);i&&(i.points=r,r||(i.dragMode="NONE"))}function IF(t,e,r){let i=Bo(t,e);i&&(i.pointStyle=r)}function MF(t,e,r){let i=Bo(t,e);i&&(i.lines=r)}function TF(t,e,r){let i=Bo(t,e);i&&(i.lineStyle=r)}function SC(t,e,r){let i=Bo(t,e);i&&(i.lineWidth=r)}function EC(t,e,r){let i=Bo(t,e);i&&(i.lineOpacity=r)}function kC(t,e,r){let i=Bo(t,e);i&&(i.pointSize=r)}function GC(t,e,r){let i=Bo(t,e);i&&(i.pointOpacity=r)}function AF(t,e,r){let i=Bo(t,e);i&&(i.dragMode=r,r!=="NONE"&&!i.points&&(i.points=!0))}function LF(t,e,r){let i=Bo(t,e);!i||!lg(r)||(i.color=r,i.colorLatex="")}function VC(t,e,r){let i=Bo(t,e);i&&(i.colorLatex=r)}function Rg(t,e){t.isExpanded=e}function PF(t,e,r){let i=Bo(t,e);i&&(i.hidden=r,r&&OF(t))}function lF(t,e,r){let i=Bo(t,e);i&&(i.boundingBoxes=r,OF(t))}function OF(t){let e=[];t.columnModels.forEach(r=>{r.boundingBoxes&&!r.hidden&&(e=e.concat(r.boundingBoxes))}),t.boundingBoxes=e}function qC(t,e){let r=Bo(t,e);return r?!r.points&&!r.lines:!0}function Fd(t,e,r){if(e.row===0){let o=t.columnModels[e.column].id,s=Bo(t,o);if(!s)return;s.latex=r,e.column>=t.columnModels.length-1&&UC(t);return}for(var i=t.columnModels[e.column],n=i.values.length;n<e.row-1;n++)i.values[n]="";t.columnModels[i.index].values[e.row-1]=r,e.column>0&&_F(t.columnModels[i.index])}function _F(t){for(;t.values.length>0&&!t.values[t.values.length-1];)t.values.pop()}function FF(t,e){return!!t.columnModels[e.column]&&e.row>=0}function RF(t){let e;if(t.values){for(e of t.values)if(e!=="")return!1}if(t.computedValues){for(e of t.computedValues)if(e!=="")return!1}return!0}function Ty(t,e,r){let i=t.columnModels[r];return i.disabled?i.computedValues[e]||"":i.values[e]||""}function NF(t){let e=Us(t),r=KC(t);for(let i=0;i<r;i++)if(Ty(t,e-1,i)!=="")return!1;return!0}function MI(t){var e=t&&t.id;if(t&&t.type==="table"){var r=Do(t);if(r){var i=t.columnModels[r.column];e=i?i.id:void 0}else e=void 0}return e}function BF(t,e,r){var i=t.getAllSelectedItems(),n={};for(var o of i){var s=MI(o);s!==void 0&&(n[s]=!0,r[s]||e.selectSketch(s))}for(let a in r)n[a]||e.deselectSketch(a);return n}var $4=1,W4=2,j4=4,J4=8,zC=15,UF=12,qF=3,HF=1,zF=2,$F=3,WF=4,zh=5,Bg=6;function Nd(t,e,r){let i=[],n=t.length;if(r===zh)for(let o=0;o<n;o+=2){let s=e.mapX(t[o]),a=e.mapY(t[o+1]);i.push(s,a)}else if(r===Bg)for(let o=0;o<n;o+=2){let s=e.mapX(t[o+1]),a=e.mapY(t[o]);i.push(s,a)}else if(r===HF)for(let o=0;o<t.length;o+=2){let s=t[o],a=t[o+1],l=e.mapX(a*Math.cos(s)),c=e.mapY(a*Math.sin(s));i.push(l,c)}else if(r===zF)for(let o=0;o<t.length;o+=2){let s=t[o],a=t[o+1];a<0&&(a=0);let l=e.mapX(a*Math.cos(s)),c=e.mapY(a*Math.sin(s));i.push(l,c)}else if(r===$F)for(let o=0;o<t.length;o+=2){let s=t[o]*Math.PI/180,a=t[o+1],l=e.mapX(a*Math.cos(s)),c=e.mapY(a*Math.sin(s));i.push(l,c)}else if(r===WF)for(let o=0;o<t.length;o+=2){let s=t[o]*Math.PI/180,a=t[o+1];a<0&&(a=0);let l=e.mapX(a*Math.cos(s)),c=e.mapY(a*Math.sin(s));i.push(l,c)}return i}function Ay(t,e,r){let[i,n,o,s]=t,{x:a,y:l}=e.mathToPixels.mapPoint({x:i,y:n}),{x:c,y:d}=e.mathToPixels.mapPoint({x:o,y:s}),u=__dcg_shared_module_exports__['ea'](a,c,2)?0:c-a,p=__dcg_shared_module_exports__['ea'](l,d,2)?0:d-l,g=(0-a)/u,b=(e.screen.width-a)/u,x=(0-l)/p,w=(e.screen.height-l)/p,E=1/0;isFinite(g)&&g<E&&(E=g),isFinite(b)&&b<E&&(E=b),isFinite(x)&&x<E&&(E=x),isFinite(w)&&w<E&&(E=w);let k=-1/0;isFinite(g)&&g>k&&(k=g),isFinite(b)&&b>k&&(k=b),isFinite(x)&&x>k&&(k=x),isFinite(w)&&w>k&&(k=w);let S,T,V,O;r===17?(S=a,T=l,V=c,O=d):r===19?(S=a,T=l,V=(1-k)*a+k*c,O=(1-k)*l+k*d):(S=(1-E)*a+E*c,T=(1-E)*l+E*d,V=(1-k)*a+k*c,O=(1-k)*l+k*d);let y=3;return{mapped:[a,l,c,d],clipped:Ly([S,T,V,O],{xmin:-y,ymin:-y,xmax:e.screen.width+y,ymax:e.screen.height+y})}}function Ly(t,e){return $C(t,e,zC,!0)}function HC(t,e,r,i){let n=[],o,s,a,l;i?(s=t[0],a=t[1],o=2,l=e(s,a),l&&n.push(s,a)):(s=t[t.length-2],a=t[t.length-1],o=0,l=e(s,a));for(var c=o;c<t.length;c+=2){let d=s,u=a,p=l;s=t[c],a=t[c+1],l=e(s,a),!(!l&&!p)&&(l&&p&&n.push(s,a),l&&!p&&(Array.prototype.push.apply(n,r(s,a,d,u)),n.push(s,a)),!l&&p&&Array.prototype.push.apply(n,r(d,u,s,a)))}return n}function $C(t,e,r,i){let n=e.xmin,o=e.xmax,s=e.ymin,a=e.ymax,l=function(E,k){return E>=n},c=function(E,k){return E<=o},d=function(E,k){return k>=s},u=function(E,k){return k<=a},p=function(E,k,S,T){E=E,k=k,S=S,T=T;let V=T-k;return[n,k+V*(n-E)/(S-E)]},g=function(E,k,S,T){E=E,k=k,S=S,T=T;let V=T-k;return[o,k+V*(o-E)/(S-E)]},b=function(E,k,S,T){E=E,k=k,S=S,T=T;let V=S-E;return[E+V*(s-k)/(T-k),s]},x=function(E,k,S,T){E=E,k=k,S=S,T=T;let V=S-E;return[E+V*(a-k)/(T-k),a]},w=t;return r&j4&&(w=HC(t,l,p,i)),r&W4&&(w=HC(w,d,b,i)),r&J4&&(w=HC(w,c,g,i)),r&$4&&(w=HC(w,u,x,i)),w}function jF(t,e,r){let i=[],n=t[0],o=n+r,s=[];i.push(s);for(let a=0;a<t.length;a+=2){let l=t[a],c=t[a+1];if(c<0&&(c=0),l>=o){for(s=[],i.push(s),n=t[a-2],o=n;l>=o;)o+=r;a-=4}else s.push(l,c)}if(e===0)for(let a=0;a<i.length;a++)i[a].push(0,0);else{let a=r/16,l=e;for(let c=0;c<i.length;c++){let d=i[c];n=d[0],o=d[d.length-2];for(let u=o;u>n;u-=a)d.push(u,l);d.push(n,l)}}return i}function TI(t,e){return t=t.slice(),t.push(t[t.length-2],e),t.push(t[0],e),[t]}function Py(t,e,r){switch(t){case 1:return Bg;case 8:case 5:case 2:return zh;case 6:return r.degreeMode?e?WF:$F:e?zF:HF}}var us=class{constructor(e,r,i){this.pattern=i,this.replen=this.pattern[0]+this.pattern[1],r/this.replen>1e3&&(this.pattern[0]=r*this.pattern[0]/this.replen/1e3,this.pattern[1]=r*this.pattern[1]/this.replen/1e3),this.pstate=0,this.dstaccum=0,this.px=null,this.py=null,this.ctx=e}static getDashedPattern(e,r){let i=e.lineWidth*11/(r?3.5:2.5),n=i*7/11;return[i,n]}static getDottedPattern(e,r,i){let n=.5*e.lineWidth*.1/(i?3.5:2.5),o=n*8/.1;return r&&(o*=2),[n,o]}static getTotalSegmentLength(e){if(e.length<4)return 0;let r=0,i=0,n=e[0],o=e[1];for(;isNaN(n)||isNaN(o);){if(i+=2,i>=e.length)return 0;n=e[i],o=e[i+1]}let s,a;for(i+=2;i<e.length;i+=2)s=e[i],a=e[i+1],!(isNaN(s)||isNaN(a))&&(r+=__dcg_shared_module_exports__['_'](s-n,a-o),n=s,o=a);return r}start(e,r){this.px=e,this.py=r}next(e,r){if(this.px===null||this.py===null)throw new Error("Must call start before calling next");let i=this.pattern[this.pstate],n=Math.sqrt(Math.pow(e-this.px,2)+Math.pow(r-this.py,2));if(n>1e-5){for(;n+this.dstaccum>=i;){let o=e-this.px,s=r-this.py,a=i-this.dstaccum;o*=a/n,s*=a/n,this.pstate===0&&(this.ctx.moveTo(this.px,this.py),this.ctx.lineTo(this.px+o,this.py+s)),this.dstaccum=0,this.px+=o,this.py+=s,this.pstate=this.pstate===0?1:0,i=this.pattern[this.pstate],n-=a}this.pstate===0&&(this.ctx.moveTo(this.px,this.py),this.ctx.lineTo(e,r))}this.px=e,this.py=r,this.dstaccum+=n}close(){this.pstate=0,this.dstaccum=0,this.px=null,this.py=null}drawSegment(e){let r=0,i=e[0],n=e[1];for(;isNaN(i)||isNaN(n);){if(r+=2,r>=e.length)return;i=e[r],n=e[r+1]}this.start(i,n);let o,s;for(r+=2;r<e.length;r+=2)o=e[r],s=e[r+1],!(isNaN(o)||isNaN(s))&&this.next(o,s);this.close()}};var $h=10,Wh=3;function LI(t,e){return t+1e-8*(e-t)>t&&e-t>1e-300&&e-t<1e300}function YF(t,e){return t>1e-300&&LI(t,e)}var an=class{constructor(e=-10,r=10,i=-10,n=10,o=-2,s=2){this.xmin=e,this.xmax=r,this.ymin=i,this.ymax=n,this.zmin=o,this.zmax=s}static fromObject({xmin:e,xmax:r,ymin:i,ymax:n,zmin:o,zmax:s}){return new an(e,r,i,n,o,s)}toObject(){return{xmin:this.xmin,ymin:this.ymin,zmin:this.zmin,xmax:this.xmax,ymax:this.ymax,zmax:this.zmax}}equals(e){return!(this.xmin!==e.xmin||this.ymin!==e.ymin||this.zmin!==e.zmin||this.xmax!==e.xmax||this.ymax!==e.ymax||this.zmax!==e.zmax)}isXValid(e){return e==="linear"?LI(this.xmin,this.xmax):YF(this.xmin,this.xmax)}isYValid(e){return e==="linear"?LI(this.ymin,this.ymax):YF(this.ymin,this.ymax)}isZValid(){return!0}isValid(e){return this.isXValid(e.xAxisScale)&&this.isYValid(e.yAxisScale)&&this.isZValid()}isSquare(e,r){return Math.abs(e.height-e.width*this.aspectRatio(r))<1}aspectRatio(e){let r=$h/Wh,i=e.yAxisScale==="linear"?this.ymax-this.ymin:Math.log10(this.ymax/this.ymin)*r,n=e.xAxisScale==="linear"?this.xmax-this.xmin:Math.log10(this.xmax/this.xmin)*r;return i/n}getSquaredAxisLimits({axis:e,screen:r,settings:i}){let[n,o,s,a,l]=e==="y"?[{min:this.ymin,max:this.ymax},{min:this.xmin,max:this.xmax},r.height/r.width,i.yAxisScale,i.xAxisScale]:[{min:this.xmin,max:this.xmax},{min:this.ymin,max:this.ymax},r.width/r.height,i.xAxisScale,i.yAxisScale];if(a==="logarithmic"){let g=Math.log(n.max)-Math.log(n.min),b=l==="logarithmic"?Math.log(o.max)-Math.log(o.min):(o.max-o.min)*Wh/($h*Math.LOG10E),w=.5*(s*b-g);return{min:Math.exp(Math.log(n.min)-w),max:Math.exp(Math.log(n.max)+w)}}let c=n.max-n.min,p=.5*((l==="logarithmic"?(Math.log10(o.max)-Math.log10(o.min))*$h/Wh:o.max-o.min)*s-c);return{min:n.min-p,max:n.max+p}}squareXAxis(e,r){let{min:i,max:n}=this.getSquaredAxisLimits({axis:"x",screen:e,settings:r}),o=new an(i,n,this.ymin,this.ymax);return o.isXValid(r.xAxisScale)?o:this}squareYAxis(e,r){let{min:i,max:n}=this.getSquaredAxisLimits({axis:"y",screen:e,settings:r}),o=new an(this.xmin,this.xmax,i,n);return o.isYValid(r.yAxisScale)?o:this}squareCrop(e,r){return this.aspectRatio({xAxisScale:r.xAxisScale,yAxisScale:r.yAxisScale})>e.height/e.width?this.squareYAxis(e,r):this.squareXAxis(e,r)}polarDiameter(){let e=Math.abs(this.xmax),r=Math.abs(this.xmin),i=Math.abs(this.ymax),n=Math.abs(this.ymin);return 1.5*Math.max(e,r,i,n)}largestR(){return Math.sqrt(Math.pow(Math.max(-this.xmin,this.xmax),2)+Math.pow(Math.max(-this.ymin,this.ymax),2))}smallestR(){return this.xmin<=0&&this.xmax>=0&&this.ymin<=0&&this.ymax>=0?0:this.xmin<=0&&this.xmax>=0?Math.min(Math.abs(this.ymin),Math.abs(this.ymax)):this.ymin<=0&&this.ymax>=0?Math.min(Math.abs(this.xmin),Math.abs(this.xmax)):Math.sqrt(Math.pow(Math.max(this.xmin,-this.xmax),2)+Math.pow(Math.max(this.ymin,-this.ymax),2))}};function Ki(t,e){let r=t;r._dcgSaveClassName&&r._dcgSaveClassName(e)}function Ei(t){let e=t;e._dcgRestoreClassName&&e._dcgRestoreClassName()}var Bd;function XF(t,e){if(Bd&&Bd.color===e&&Bd.img===t)return Bd.canvas;Bd?(Bd.color=e,Bd.img=t):Bd={color:e,img:t,canvas:document.createElement("canvas")};var r=Bd.canvas;r.width=0,r.width=t.width,r.height=t.height;var i=r.getContext("2d");return i.drawImage(t,0,0),i.fillStyle=e,i.globalCompositeOperation="source-atop",i.fillRect(0,0,t.width,t.height),r}function WC(t,e,r){let i=t.formula;if(!i||!i.dimensions.x)return;let n=i.dimensions;for(var o=0;o<n.x.length;o++){var s=n.x[o],a=n.y[o],l=n.width[o],c=n.height[o],d=n.radianAngle[o];if(!(!isFinite(s)||!isFinite(a)||!isFinite(l)||!isFinite(c)||!isFinite(d))){Ki(e,"dcg-svg-image"),e.save(),Ei(e),e.globalAlpha=n.opacity[o];var u=r.mapy(c)-r.mapy(0),p=r.mapx(l)-r.mapx(0),g=d===0?1:Math.abs(p/l*(c/u)),b=r.mapx(s),x=r.mapy(a),w=b-p/2,E=x+u*g/2,k=c<0?-1:1,S=l<0?-1:1,T=w*S,V=E*k,O=Math.abs(p),y=Math.abs(u);d!==0&&(e.translate(b,x),e.scale(1,1/g),e.rotate(d),e.translate(-b,-x)),e.scale(S,k);var L=!1,P=!1,K=t.controller.getGrapher();K&&K.type==="2d"&&(L=K.clickableObjectsLayer.shouldDrawHovered(t.id,o),P=K.clickableObjectsLayer.shouldDrawPressed(t.id,o));var $=t.imageObj,U=$;P?t.depressedImageObj?U=t.depressedImageObj:U=XF($,"rgba(50,50,50,0.2)"):L&&(t.hoveredImageObj?U=t.hoveredImageObj:U=XF($,"rgba(200,200,200,0.2)")),e.drawImage(U,T,V,O,y*g),Ha(t)&&t.controller.isTraceEnabled()&&(e.beginPath(),e.rect(T,V,O,y*g),e.restore(),e.save(),e.strokeStyle="#6993C7",e.lineWidth=2,e.stroke()),e.restore()}}}function gs(t,e){let r=t;r._dcgStartNamedGroup&&r._dcgStartNamedGroup(e)}function Oy(t,e){let r=t;r._dcgSetTitle&&r._dcgSetTitle(e)}function ms(t){let e=t;e._dcgEndNamedGroup&&e._dcgEndNamedGroup()}var YC={};function e2(t={}){return Object.keys(t).length}function JC(t,e={}){return e2(e)===0?t:t.filter((r,i)=>!e[i])}function QF(t,e){let r=[];for(let i=0;i<t;i++)r.push(e);return r}function Z4(){return!!Object.keys(YC).length}var OI=function(t,e){let r=3;return e&&(r+=e),new an(-r,t.width+r,-r,t.height+r)},bn=class{constructor(e,r,i){if(this.controller=e,this.getExpressionAriaLabel=i,r.config.plaidMode){let n=["RED","BLUE","GREEN","PURPLE","ORANGE","BLACK"];for(let o of n)YC[__dcg_shared_module_exports__['T'][o]]=document.createElement("img"),YC[__dcg_shared_module_exports__['T'][o]].setAttribute("src","/assets/img/april-fools/"+o.toLowerCase()+".png")}}redrawToCtx(e,r,i,n,o,s,a,l){gs(e,"expressions");let c=r.settings.highlight,d=this.controller.isGeometry();o.forEach(u=>{let p=i[u],g=n[u];p!==void 0&&(d&&r.settings.setProperty("highlight",p.showHighlight),gs(e,"sketch"),r.settings.takingScreenshot&&Oy(e,this.getExpressionAriaLabel(u)),bn.drawSketchToCtx({sketch:i[u],ctx:e,projection:r,poiLabelsLayer:s,clickableObjectsLayer:a,geometryContext:this.controller.getGeoModel(),showMovablePoints:l==null?void 0:l.showMovablePoints}),ms(e)),g&&g.shouldGraph&&g.foreground&&WC(g,e,r)}),ms(e),r.settings.setProperty("highlight",c)}static eachSegment(e,r){for(let i of e.branches)if(i.graphMode!==15)for(let n of i.segments)r(i,n)}static drawSketchToCtx({sketch:e,ctx:r,projection:i,poiLabelsLayer:n,clickableObjectsLayer:o,geometryContext:s,showMovablePoints:a}){var b,x;if(!e.branches||!e.branches.length)return;let l=r.lineWidth,c=r.globalAlpha,d=i.settings.globalCurveColor?i.settings.globalCurveColor:e.color,u=YC[d];if(u&&u.complete&&u.naturalWidth>0){let w=r.createPattern(u,"repeat");r.fillStyle=w}else r.fillStyle=d;r.strokeStyle=d,r.lineJoin="round",r.lineCap="round";let p=!!i.settings.takingScreenshot,g=!!a;for(let w of e.branches){if(w.graphMode===3||w.graphMode===4||w.graphMode===15||w.graphMode===22)continue;let E=1;o.shouldDrawHovered(e.id,w.listIndex)&&(E=1.2),o.shouldDrawPressed(e.id,w.listIndex)&&(E=1.4),E*=(b=s==null?void 0:s.getToolFadeOpacity(e.id))!=null?b:1,E*=i.settings.getFillOpacityMultiplier(),w.color&&!i.settings.globalCurveColor&&!Z4()&&(r.fillStyle=w.color),w.graphMode!==6&&(r.desmos_batching=!0,r.beginPath());for(let k of w.segments){let S=(x=w.graphMode)!=null?x:2;if(S===7&&!i.settings.disableFill)bn.fillPolygonToCtx(r,i,k,w.fillOpacity===void 0?NaN:w.fillOpacity*E);else if(S!==8){let T=w.operator,V=!i.settings.disableFill&&(T=="<"||T==">"||T=="<="||T==">="),O=T=="<="||T=="<";V&&bn.fillGraphStrokeToCtx(r,i,k,O,S)}}r.globalAlpha=bn._clampedOpacity(w.fillOpacity===void 0?NaN:w.fillOpacity*E,.4),w.graphMode!==6&&(r.fill(),r.desmos_batching=!1),r.globalAlpha=1}bn.eachSegment(e,function(w,E){var J,R,q;if(w.graphMode===3||w.graphMode===4||w.graphMode===15||w.graphMode===22)return;let k=2;w.graphMode&&(k=w.graphMode);let S=E,T=w.lineWidth!==void 0,V=w.lineWidth,O=2.5,y=(J=w.arrowMode)!=null?J:"DEFAULT";if(r.strokeStyle=w.color,r.fillStyle=w.color,T&&(V<=0||!isFinite(V)))return;r.lineWidth=T?V:O;let L=i.settings.graphLineWidth/O;e.tokenSelected?L*=2:e.tokenHovered&&(L*=1.5),r.lineWidth*=L,r.globalAlpha*=i.settings.curveOpacity,r.globalAlpha=bn._clampedOpacity(i.settings.curveOpacity===1?1:w.lineOpacity,.9);let P=w.operator,K="default";P==="<"||P===">"||P==="!="?K="DASHED":P==="<="||P===">="?K="SOLID":e.style==="DASHED"||w.style==="DASHED"?K="DASHED":(e.style==="DOTTED"||w.style==="DOTTED")&&(K="DOTTED",T&&(r.lineWidth*=2)),r.globalAlpha*=(R=s==null?void 0:s.getToolFadeOpacity(e.id))!=null?R:1;let $=!w.isIntersectionExtension&&o.shouldDrawHovered(e.id,w.listIndex),U=!w.isIntersectionExtension&&o.shouldDrawPressed(e.id,w.listIndex);(U||$)&&(r.save(),r.lineWidth+=4.5,U?r.globalAlpha*=.5:r.globalAlpha*=.3,bn.drawGraphStrokeToCtx(r,i,S,{type:K,graphMode:k,op:P,arrowMode:y,opacityMultiplier:U?.5:.3}),r.restore()),bn.drawGraphStrokeToCtx(r,i,S,{type:K,graphMode:k,op:P,arrowMode:y,opacityMultiplier:(q=s==null?void 0:s.getToolFadeOpacity(e.id))!=null?q:1})}.bind(this)),r.lineWidth=l,r.globalAlpha=c,bn.eachSegment(e,function(w,E){var k;if(w.graphMode===3&&w.showPoint||w.graphMode===4&&p){let S=E,T=[],V;if(w.interactiveLabel&&e.labels)for(let R=0,q=e.labels.length;R<q;R++){let _=e.labels[R];if(_.type==="poi"){let A=n.isOpenPOI(_.poi),z=n.getHoveredPOI()===_.poi;T.push(A||z),!A&&z&&(V=R)}}let O=w.graphMode===4&&p&&!g&&w.pointOpacity===1,y=1;typeof w.pointSize=="number"?y=w.pointSize/9:Array.isArray(w.pointSize)&&(y=w.pointSize.map(function(R){return R/9}));let L;Array.isArray(w.color)&&(L=w.color);let P=o.getHoveredObjectById(e.id),K=o.shouldDrawHovered(e.id,void 0),$=o.getPressedObject(),U=o.shouldDrawPressed(e.id,$==null?void 0:$.listIndex),J=w.droppedIndices;if(K||U){let R=S.length;J&&(R+=e2(J));let q=QF(R,0),_=Array.isArray(y)?y.slice():QF(R,y);U&&$?$.listIndex===void 0?(q=q.map(()=>.5),_=_.map(A=>A*1.5)):(q[$.listIndex]=.5,_[$.listIndex]*=1.5):K&&P&&(q=q.map((A,z)=>P.listIndexes===void 0||P.listIndexes[z]?.3:A),_=_.map((A,z)=>P.listIndexes===void 0||P.listIndexes[z]?A*1.5:A)),bn.drawPointsToCtx({ctx:r,projection:i,segment:S,style:w.style,sizeOverrideIdxs:T,opacityOverrideIdx:V,sizeFactor:_,opacityFactor:q,colorOverrides:L,baseOpacity:w.pointOpacity,droppedIndices:J,sketch:e}),r.restore()}bn.drawPointsToCtx({ctx:r,projection:i,segment:S,style:w.style,sizeOverrideIdxs:T,opacityOverrideIdx:V,sizeFactor:y,opacityFactor:(k=s==null?void 0:s.getToolFadeOpacity(e.id))!=null?k:1,colorOverrides:L,baseOpacity:O?.9:w.pointOpacity,droppedIndices:J,sketch:e})}}.bind(this))}static drawGraphStrokeToCtx(e,r,i,n){let{type:o,graphMode:s,op:a,arrowMode:l}=n;if(s===20||s===21){let[g,b,x]=i,w=r.mathToPixels.mapX(g),E=r.mathToPixels.mapY(b),k=r.mathToPixels.dangerouslyGetXScaleFactor(),S=r.mathToPixels.dangerouslyGetYScaleFactor(),T=Math.abs(x*k),V=Math.abs(x*S),O,y;if(s===21?(O=-i[3],y=-i[4]):(O=0,y=2*Math.PI),e.save(),Ki(e,"dcg-svg-curve"),e.desmos_batching||e.beginPath(),o==="DASHED"){let L=us.getDashedPattern(e,!!r.settings.highlight);e.setLineDash(L)}else if(o==="DOTTED"){let L=us.getDottedPattern(e,!!r.settings.config.projectorMode,!!r.settings.highlight);e.setLineDash(L)}e.ellipse(w,E,T,V,0,O,y,O>y),e.desmos_batching||e.stroke(),Ei(e),e.restore();return}else if(s===23){let[g,b,x,w,E]=i,k=$g(w,r),S=r.mathToPixels.mapX(g),T=r.mathToPixels.mapY(b),V=r.mathToPixels.dangerouslyGetXScaleFactor(),O=r.mathToPixels.dangerouslyGetYScaleFactor(),y=V>O?V/O:1,L=V>O?1:O/V,P=Math.abs(y*k),K=Math.abs(L*k);if(e.save(),Ki(e,"dcg-svg-curve"),e.globalAlpha=.4*n.opacityMultiplier,e.desmos_batching||e.beginPath(),e.moveTo(S,T),e.lineTo(S+P*Math.cos(-x),T+K*Math.sin(-x)),e.ellipse(S,T,P,K,0,-x,-x-w,w>0),e.lineTo(S,T),!e.desmos_batching&&!E&&e.fill(),e.globalAlpha=n.opacityMultiplier,e.desmos_batching||e.beginPath(),e.ellipse(S,T,P,K,0,-x,-x-w,w>0),E){let $=-x-w,U=S+P*Math.cos($),J=T+K*Math.sin($);FI(e,U,J,-x,-w,10,P)}e.globalAlpha=n.opacityMultiplier,e.desmos_batching||e.stroke(),e.lineWidth=1.5,e.globalAlpha=.2*n.opacityMultiplier,e.moveTo(S+1.5*P*Math.cos(-x),T+1.5*K*Math.sin(-x)),e.lineTo(S,T),e.lineTo(S+1.5*P*Math.cos(-x-w),T+1.5*K*Math.sin(-x-w)),e.stroke(),Ei(e),e.restore()}else if(s===17||s===18||s===19){let{clipped:g,mapped:b}=Ay(i,r,s),[x,w,E,k]=g,[S,T,V,O]=b;e.save(),Ki(e,"dcg-svg-curve");let y;if(e.desmos_batching||e.beginPath(),o=="DASHED"?(y=new us(e,us.getTotalSegmentLength(g),us.getDashedPattern(e,!!r.settings.highlight)),y.drawSegment(g)):o=="DOTTED"?(y=new us(e,us.getTotalSegmentLength(g),us.getDottedPattern(e,!!r.settings.config.projectorMode,!!r.settings.highlight)),y.drawSegment(g)):(e.moveTo(x,w),e.lineTo(E,k)),s===17){let L=rq(o)*e.lineWidth,{startArrow:P,endArrow:K}=tq(eq(s,l));P&&Jc(e,V,O,S,T,L),K&&Jc(e,S,T,V,O,L)}e.desmos_batching||e.stroke(),Ei(e),e.restore();return}let c=Py(s,a!=="=",r.settings),d=Nd(i,r.mathToPixels,c),u=Ly(d,OI(r.screen,e.lineWidth));if(u.length===0)return;e.save(),Ki(e,"dcg-svg-curve");let p;if(e.desmos_batching||e.beginPath(),o=="DASHED")p=new us(e,us.getTotalSegmentLength(u),us.getDashedPattern(e,!!r.settings.highlight)),p.drawSegment(u);else if(o=="DOTTED")p=new us(e,us.getTotalSegmentLength(u),us.getDottedPattern(e,!!r.settings.config.projectorMode,!!r.settings.highlight)),p.drawSegment(u);else if((o==="SOLID"||o==="default")&&e.lineWidth===1)if(u.length>4||u[0]!==u[2]&&u[1]!==u[3]){e.moveTo(u[0],u[1]);for(let b=0;b<u.length;b+=2)e.lineTo(u[b],u[b+1])}else{e.moveTo(__dcg_shared_module_exports__['fa'](u[0]),__dcg_shared_module_exports__['fa'](u[1]));for(let b=0;b<u.length;b+=2)e.lineTo(__dcg_shared_module_exports__['fa'](u[b]),__dcg_shared_module_exports__['fa'](u[b+1]))}else{e.moveTo(u[0],u[1]);for(let g=0;g<u.length;g+=2)e.lineTo(u[g],u[g+1])}e.desmos_batching||e.stroke(),Ei(e),e.restore()}static mapPointToScreen(e,r,i){let o=e.mapx(r);if(o<-20||o>e.screen.width+20)return null;let s=e.mapy(i);return s<-20||s>e.screen.height+20?null:{x:o,y:s}}static drawPointToCtx(e,r,i,n,o,s,a,l,c,d,u){let p=e.lineWidth,g=e.fillStyle,b=e.strokeStyle,x=bn.mapPointToScreen(r,n,o);if(!x||c!==void 0&&(c<=0||!isFinite(c)))return!1;Ki(e,"dcg-svg-point"),s!==void 0?e.globalAlpha=s:e.globalAlpha=.9,d!==void 0&&(e.globalAlpha*=d),e.desmos_batching||e.beginPath();let w=r.settings.pointLineWidth;if(l&&(w=r.settings.config.projectorMode?17:11,e.lineWidth=w),i.tokenSelected?c?c*=2:c=2:i.tokenHovered&&(c?c*=1.5:c=1.5),c!==void 0&&(w*=c,e.lineWidth=w),u&&(e.fillStyle=u,e.strokeStyle=u),a==="CROSS"){let E=w*.4;e.moveTo(x.x-E,x.y-E),e.lineTo(x.x+E,x.y+E),e.moveTo(x.x+E,x.y-E),e.lineTo(x.x-E,x.y+E),e.lineWidth=w*.3}else if(a==="OPEN"){let E=w*.42;e.moveTo(x.x+E,x.y),e.arc(x.x,x.y,E,0,Math.PI*2,!0),e.closePath(),e.fillStyle="white",e.lineWidth=w*.25,e.fill()}else e.moveTo(x.x-.1,x.y-.1),e.lineTo(x.x-.1,x.y+.1),e.lineTo(x.x+.1,x.y+.1),e.lineTo(x.x+.1,x.y-.1);return e.desmos_batching||e.stroke(),e.globalAlpha=1,e.lineWidth=p,e.fillStyle=g,e.strokeStyle=b,Ei(e),!0}static drawPointsToCtx(e){let{ctx:r,projection:i,segment:n,style:o,sizeOverrideIdxs:s,opacityOverrideIdx:a,sizeFactor:l,opacityFactor:c,colorOverrides:d,baseOpacity:u,droppedIndices:p}=e,g=r.lineWidth;r.lineWidth=i.settings.pointLineWidth;let b;Array.isArray(u)?(b=u.map(function(x){return bn._clampedOpacity(x,.9)}.bind(this)),b=JC(b,p)):b=bn._clampedOpacity(u,.9),Array.isArray(l)&&(l=JC(l,p)),Array.isArray(c)&&(c=JC(c,p)),d&&(d=JC(d,p));for(let x=0;x<n.length;x++)bn.drawPointToCtx(r,i,e.sketch,n[x][0],n[x][1],a===x?.6:Array.isArray(b)?b[x]:b,o,s[x],Array.isArray(l)?l[x]:l,Array.isArray(c)?c[x]:c,d&&d[x]);r.lineWidth=g}static fillGraphStrokeToCtx(e,r,i,n,o){e.globalAlpha=o===6?.2:.4;let s=null,a=null,l;if(o===6){a=zC;let d=n?0:r.viewport.polarDiameter(),u=r.settings.degreeMode?180:2*Math.PI;s=jF(i,d,u)}else o===2?(a=qF,l=n?r.viewport.ymin:r.viewport.ymax,s=TI(i,l)):o===1&&(a=UF,l=n?r.viewport.xmin:r.viewport.xmax,s=TI(i,l));if(s===null||a===null)return;let c=OI(r.screen);for(let d of s){let u=Py(o,!0,r.settings),p=Nd(d,r.mathToPixels,u),g=$C(p,c,a,!1);if(g.length>=6){Ki(e,"dcg-svg-region"),e.desmos_batching||e.beginPath(),e.moveTo(g[0],g[1]);for(let b=2;b<g.length;b+=2)e.lineTo(g[b],g[b+1]);e.lineTo(g[0],g[1]),e.desmos_batching||e.fill(),Ei(e)}}e.globalAlpha=1}static _clampedOpacity(e,r){return typeof e!="number"?r:e<0?0:e>1?1:isFinite(e)?e:r}static fillPolygonToCtx(e,r,i,n){let o=OI(r.screen);e.globalAlpha=bn._clampedOpacity(n*r.settings.getFillOpacityMultiplier(),.4);let s=Nd(i,r.mathToPixels,zh),a=$C(s,o,zC,!1);if(a.length>=6){Ki(e,"dcg-svg-region"),e.desmos_batching||e.beginPath(),e.moveTo(a[0],a[1]);for(let l=2;l<a.length;l+=2)e.lineTo(a[l],a[l+1]);e.desmos_batching||e.fill(),Ei(e)}e.globalAlpha=1}};function eq(t,e){return t===17?e==="DEFAULT"?"NONE":e:"NONE"}function tq(t){switch(t){case"NONE":return{startArrow:!1,endArrow:!1};case"POSITIVE":return{startArrow:!1,endArrow:!0};case"BOTH":return{startArrow:!0,endArrow:!0};default:let e=t;throw new Error("Unexpected arrowMode: "+e)}}function rq(t){switch(t){case"default":case"SOLID":case"DASHED":return 4;case"DOTTED":return 2;default:let e=t;throw new Error("Unexpected line style "+e)}}function Jc(t,e,r,i,n,o){let s=Math.atan2(n-r,i-e),a=i-o*Math.cos(s-Math.PI/9),l=n-o*Math.sin(s-Math.PI/9),c=i-o*Math.cos(s+Math.PI/9),d=n-o*Math.sin(s+Math.PI/9),u=i-(o-2)*Math.cos(s-Math.PI/18),p=n-(o-2)*Math.sin(s-Math.PI/18),g=i-(o-2)*Math.cos(s+Math.PI/18),b=n-(o-2)*Math.sin(s+Math.PI/18);t.moveTo(i,n),t.lineTo(a,l),t.lineTo(c,d),t.lineTo(i,n),t.lineTo(u,p),t.lineTo(g,b),t.lineTo(i,n)}function FI(t,e,r,i,n,o,s){let a=i+n,l=o*Math.min(1,Math.max(.5,Math.abs(n)/.8)),c=n<=0,d=Math.PI/2;s<25?d+=.25:d+=.1,c||(d*=-1);let u=e+Math.cos(a+d),p=r+Math.sin(a+d);Jc(t,u,p,e,r,l)}function $g(t,e){let r=20;return e.settings.config.projectorMode&&(r*=1.4),r}var XC=class{constructor(e){this.savedPOI=[],this.controller=e}redrawToCtx(e,r,i,n,o,s){let a=[];for(var l=0;l<s.length;l++){var c=s[l],d=i[c];if(d){d.showHighlight&&!this.controller.isGeometry()&&this.drawSketchHighlight({sketch:d,ctx:e,projection:r,poiLabelsLayer:n,clickableObjectsLayer:o,geometryContext:this.controller.getGeoModel()});var u=d.getPOI();(d.showPOI||u.length&&u[0].isAttachedToPlottedPoint())&&a.push.apply(a,this.drawPOIs(u,e,"#AAAAAA",r))}}this.savedPOI=a}getDrawnPOI(){return this.savedPOI}drawSketchHighlight(e){e.projection.settings.setProperty("highlight",!0),bn.drawSketchToCtx(e),e.projection.settings.setProperty("highlight",!1)}drawPOIs(e,r,i,n){r.lineWidth=n.settings.pointLineWidth,r.strokeStyle=i||"#AAAAAA",r.fillStyle=i||"#AAAAAA",r.lineJoin="round",r.lineCap="round";var o=r.globalAlpha;r.globalAlpha=.01;var s=[],a,l=e.length,c;if(l&&e[0].isAttachedToPlottedPoint())for(a=0;a<l;a++)c=e[a],bn.mapPointToScreen(n,c.x,c.y)&&s.push(c);else for(a=0;a<l;a++)c=e[a],bn.drawPointToCtx(r,n,c.sketch,c.x,c.y)&&s.push(c);return r.globalAlpha=o,s}};var QC=class{redrawToCtx(e,r,i){if(i){e.save(),e.lineWidth=2,e.fillStyle="rgba(0,0,0,.15)",e.strokeStyle="rgba(0,0,0,.4)";var n=r.mapx(i.left),o=r.mapy(i.top),s=r.mapx(i.right),a=r.mapy(i.bottom),l=s-n,c=a-o;e.fillRect(n,o,l,c),e.strokeRect(n,o,l,c),e.restore()}}};var qd=__dcg_shared_module_exports__['i'](Z());var{If:pH}=qd.Components,sD=class extends qd.Class{init(){this.controller=this.props.grapher().controller,this.poiController=this.props.grapher().poiController}template(){return qd.createElement(pH,{predicate:this.bindFn(this.showCursor)},()=>qd.createElement("div",{class:qd.const("dcg-geo-keyboard-cursor"),style:()=>({top:`${this.getPosition().y}px`,left:`${this.getPosition().x}px`})}))}getPosition(){let e=this.poiController.getGeoKeyboardPt(),r=this.props.grapher().getProjection();return{x:r.mapx(e.x),y:r.mapy(e.y)}}showCursor(){return this.controller.isVirtualMouseAllowed()}};var Yg,xt,qy,tM,eM;function Is(t,e){var r=Object.keys(e),i;for(i=0;i<r.length;i++)t=t.replace(new RegExp("\\{"+r[i]+"\\}","gi"),e[r[i]]);return t}function aD(t){var e,r,i;if(!t)throw new Error("cannot create a random attribute name for an undefined object");e="ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz",r="";do for(r="",i=0;i<12;i++)r+=e[Math.floor(Math.random()*e.length)];while(t[r]);return r}function uH(t,e){var r,i,n={},o,s;for(t=t.split(","),e=e||10,r=0;r<t.length;r+=2)i="&"+t[r+1]+";",o=parseInt(t[r],e),n[i]="&#"+o+";";return n["\\xa0"]="&#160;",n}function gH(t){var e={left:"start",right:"end",center:"middle",start:"start",end:"end"};return e[t]||e.start}eM=uH("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32);Yg={strokeStyle:{svgAttr:"stroke",canvas:"#000000",svg:"none",apply:"stroke"},fillStyle:{svgAttr:"fill",canvas:"#000000",svg:null,apply:"fill"},lineCap:{svgAttr:"stroke-linecap",canvas:"butt",svg:"butt",apply:"stroke"},lineJoin:{svgAttr:"stroke-linejoin",canvas:"miter",svg:"miter",apply:"stroke"},miterLimit:{svgAttr:"stroke-miterlimit",canvas:10,svg:4,apply:"stroke"},lineWidth:{svgAttr:"stroke-width",canvas:1,svg:1,apply:"stroke"},globalAlpha:{svgAttr:"opacity",canvas:1,svg:1,apply:"fill stroke"},font:{canvas:"10px sans-serif"},shadowColor:{canvas:"#000000"},shadowOffsetX:{canvas:0},shadowOffsetY:{canvas:0},shadowBlur:{canvas:0},textAlign:{canvas:"start"},textBaseline:{canvas:"alphabetic"},lineDash:{svgAttr:"stroke-dasharray",canvas:[],svg:null,apply:"stroke"}};qy=function(t,e){this.__root=t,this.__ctx=e};qy.prototype.addColorStop=function(t,e){var r=this.__ctx.__createElement("stop"),i,n;r.setAttribute("offset",t),e.indexOf("rgba")!==-1?(i=/rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?\.?\d*)\s*\)/gi,n=i.exec(e),r.setAttribute("stop-color",Is("rgb({r},{g},{b})",{r:n[1],g:n[2],b:n[3]})),r.setAttribute("stop-opacity",n[4])):r.setAttribute("stop-color",e),this.__root.appendChild(r)};tM=function(t,e){this.__root=t,this.__ctx=e};xt=function(t){var e={width:500,height:500,enableMirroring:!1},r;if(arguments.length>1?(r=e,r.width=arguments[0],r.height=arguments[1]):t?r=t:r=e,!(this instanceof xt))return new xt(r);this._randomPostfix="-"+function(){return"xxxxxxxx".replace(/x/g,function(n){return(Math.random()*16|0).toString(16)})}(),this._svgClassNames=[],this.width=r.width||e.width,this.height=r.height||e.height,this.enableMirroring=r.enableMirroring!==void 0?r.enableMirroring:e.enableMirroring,this.canvas=this,this.__document=r.document||document,r.ctx?this.__ctx=r.ctx:(this.__canvas=this.__document.createElement("canvas"),this.__ctx=this.__canvas.getContext("2d")),this.__setDefaultStyles(),this.__stack=[this.__getStyleState()],this.__groupStack=[],this.__root=this.__document.createElementNS("http://www.w3.org/2000/svg","svg"),this.__root.setAttribute("version",1.1),this.__root.setAttribute("xmlns","http://www.w3.org/2000/svg"),this.__root.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),this.__root.setAttribute("width",this.width),this.__root.setAttribute("height",this.height),this.__ids={},this.__defs=this.__document.createElementNS("http://www.w3.org/2000/svg","defs"),this.__root.appendChild(this.__defs),this.__currentElement=this.__document.createElementNS("http://www.w3.org/2000/svg","g"),this.__root.appendChild(this.__currentElement)};xt.prototype.__createElement=function(t,e,r){typeof e=="undefined"&&(e={});var i=this.__document.createElementNS("http://www.w3.org/2000/svg",t),n=Object.keys(e),o,s;for(r&&(i.setAttribute("fill","none"),i.setAttribute("stroke","none")),o=0;o<n.length;o++)s=n[o],i.setAttribute(s,e[s]);var a=this._svgClassNames&&this._svgClassNames[this._svgClassNames.length-1];return a&&i.setAttribute("class",a),i};xt.prototype.__setDefaultStyles=function(){var t=Object.keys(Yg),e,r;for(e=0;e<t.length;e++)r=t[e],this[r]=Yg[r].canvas};xt.prototype.__applyStyleState=function(t){var e=Object.keys(t),r,i;for(r=0;r<e.length;r++)i=e[r],this[i]=t[i]};xt.prototype.__getStyleState=function(){var t,e={},r=Object.keys(Yg),i;for(t=0;t<r.length;t++)i=r[t],e[i]=this[i];return e};xt.prototype.__applyStyleToCurrentElement=function(t){var e=this.__currentElement,r=this.__currentElementsToStyle;r&&(e.setAttribute(t,""),e=r.element,r.children.forEach(function(g){g.setAttribute(t,"")}));var i=Object.keys(Yg),n,o,s,a,l,c;for(n=0;n<i.length;n++)if(o=Yg[i[n]],s=this[i[n]],o.apply){if(s instanceof tM){if(s.__ctx)for(;s.__ctx.__defs.childNodes.length;)a=s.__ctx.__defs.childNodes[0].getAttribute("id"),this.__ids[a]=a,this.__defs.appendChild(s.__ctx.__defs.childNodes[0]);e.setAttribute(o.apply,Is("url(#{id})",{id:s.__root.getAttribute("id")}))}else if(s instanceof qy)e.setAttribute(o.apply,Is("url(#{id})",{id:s.__root.getAttribute("id")}));else if(o.apply.indexOf(t)!==-1&&o.svg!==s)if((o.svgAttr==="stroke"||o.svgAttr==="fill")&&s.indexOf("rgba")!==-1){l=/rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?\.?\d*)\s*\)/gi,c=l.exec(s),e.setAttribute(o.svgAttr,Is("rgb({r},{g},{b})",{r:c[1],g:c[2],b:c[3]}));var d=c[4],u=this.globalAlpha;u!=null&&(d*=u),e.setAttribute(o.svgAttr+"-opacity",d)}else{var p=o.svgAttr;if(i[n]==="globalAlpha"&&(p=t+"-"+o.svgAttr,e.getAttribute(p)))continue;e.setAttribute(p,s)}}};xt.prototype.__closestGroupOrSvg=function(t){return t=t||this.__currentElement,t.nodeName==="g"||t.nodeName==="svg"?t:this.__closestGroupOrSvg(t.parentNode)};xt.prototype.getSerializedSvg=function(t){var e=new XMLSerializer().serializeToString(this.__root),r,i,n,o,s,a;if(a=/xmlns="http:\/\/www\.w3\.org\/2000\/svg".+xmlns="http:\/\/www\.w3\.org\/2000\/svg/gi,a.test(e)&&(e=e.replace('xmlns="http://www.w3.org/2000/svg','xmlns:xlink="http://www.w3.org/1999/xlink')),t)for(r=Object.keys(eM),i=0;i<r.length;i++)n=r[i],o=eM[n],s=new RegExp(n,"gi"),s.test(e)&&(e=e.replace(s,o));return e};xt.prototype.getSvg=function(){return this.__root};xt.prototype._dcgStartNamedGroup=function(t){var e=this.__createElement("g");e.setAttribute("id",t+this._randomPostfix);var r=this.__closestGroupOrSvg();this.__groupStack.push(r),r.appendChild(e),this.__currentElement=e};xt.prototype._dcgEndNamedGroup=function(){this.__currentElement=this.__groupStack.pop(),this.__currentElement||(this.__currentElement=this.__root.childNodes[1])};xt.prototype._dcgSaveClassName=function(t){this._svgClassNames.push(t),this.__currentElement&&this.__currentElement.tagName==="path"&&!this.__currentDefaultPath&&(this.__currentElement.getAttribute("class")||this.__currentElement.setAttribute("class",t))};xt.prototype._dcgRestoreClassName=function(){this._svgClassNames.pop()};xt.prototype.save=function(){var t=this.__createElement("g"),e=this.__closestGroupOrSvg();this.__groupStack.push(e),e.appendChild(t),this.__currentElement=t,this.__stack.push(this.__getStyleState())};xt.prototype.restore=function(){this.__currentElement=this.__groupStack.pop(),this.__currentElementsToStyle=null,this.__currentElement||(this.__currentElement=this.__root.childNodes[1]);var t=this.__stack.pop();this.__applyStyleState(t)};xt.prototype.__addTransform=function(t){var e=this.__closestGroupOrSvg();if(e.childNodes.length>0){this.__currentElement.nodeName==="path"&&(this.__currentElementsToStyle||(this.__currentElementsToStyle={element:e,children:[]}),this.__currentElementsToStyle.children.push(this.__currentElement),this.__applyCurrentDefaultPath());var r=this.__createElement("g");e.appendChild(r),this.__currentElement=r}var i=this.__currentElement.getAttribute("transform");i?i+=" ":i="",i+=t,this.__currentElement.setAttribute("transform",i)};xt.prototype.scale=function(t,e){e===void 0&&(e=t),this.__addTransform(Is("scale({x},{y})",{x:t,y:e}))};xt.prototype.rotate=function(t){var e=t*180/Math.PI;this.__addTransform(Is("rotate({angle},{cx},{cy})",{angle:e,cx:0,cy:0}))};xt.prototype.translate=function(t,e){this.__addTransform(Is("translate({x},{y})",{x:t,y:e}))};xt.prototype.transform=function(t,e,r,i,n,o){this.__addTransform(Is("matrix({a},{b},{c},{d},{e},{f})",{a:t,b:e,c:r,d:i,e:n,f:o}))};xt.prototype.beginPath=function(){var t,e;this.__currentDefaultPath="",this.__currentPosition={},t=this.__createElement("path",{},!0),e=this.__closestGroupOrSvg(),e.appendChild(t),this.__currentElement=t};xt.prototype.__applyCurrentDefaultPath=function(){var t=this.__currentElement;t.nodeName==="path"?t.setAttribute("d",this.__currentDefaultPath):console.error("Attempted to apply path command to node",t.nodeName)};xt.prototype.__addPathCommand=function(t){this.__currentDefaultPath+=" ",this.__currentDefaultPath+=t};xt.prototype.moveTo=function(t,e){this.__currentElement.nodeName!=="path"&&this.beginPath(),this.__currentPosition={x:t,y:e},this.__addPathCommand(Is("M {x} {y}",{x:t,y:e}))};xt.prototype.closePath=function(){this.__currentDefaultPath&&this.__addPathCommand("Z")};xt.prototype.lineTo=function(t,e){this.__currentPosition={x:t,y:e},this.__currentDefaultPath.indexOf("M")>-1?this.__addPathCommand(Is("L {x} {y}",{x:t,y:e})):this.__addPathCommand(Is("M {x} {y}",{x:t,y:e}))};xt.prototype.bezierCurveTo=function(t,e,r,i,n,o){this.__currentPosition={x:n,y:o},this.__addPathCommand(Is("C {cp1x} {cp1y} {cp2x} {cp2y} {x} {y}",{cp1x:t,cp1y:e,cp2x:r,cp2y:i,x:n,y:o}))};xt.prototype.quadraticCurveTo=function(t,e,r,i){this.__currentPosition={x:r,y:i},this.__addPathCommand(Is("Q {cpx} {cpy} {x} {y}",{cpx:t,cpy:e,x:r,y:i}))};var ZI=function(t){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]);return[t[0]/e,t[1]/e]};xt.prototype.arcTo=function(t,e,r,i,n){var o=this.__currentPosition&&this.__currentPosition.x,s=this.__currentPosition&&this.__currentPosition.y;if(!(typeof o=="undefined"||typeof s=="undefined")){if(n<0)throw new Error("IndexSizeError: The radius provided ("+n+") is negative.");if(o===t&&s===e||t===r&&e===i||n===0){this.lineTo(t,e);return}var a=ZI([o-t,s-e]),l=ZI([r-t,i-e]);if(a[0]*l[1]===a[1]*l[0]){this.lineTo(t,e);return}var c=a[0]*l[0]+a[1]*l[1],d=Math.acos(Math.abs(c)),u=ZI([a[0]+l[0],a[1]+l[1]]),p=n/Math.sin(d/2),g=t+p*u[0],b=e+p*u[1],x=[-a[1],a[0]],w=[l[1],-l[0]],E=function(T){var V=T[0],O=T[1];return O>=0?Math.acos(V):-Math.acos(V)},k=E(x),S=E(w);this.lineTo(g+x[0]*n,b+x[1]*n),this.arc(g,b,n,k,S)}};xt.prototype.stroke=function(){this.__currentElement.nodeName==="path"&&this.__currentElement.setAttribute("paint-order","fill stroke markers"),this.__applyCurrentDefaultPath(),this.__applyStyleToCurrentElement("stroke")};xt.prototype.fill=function(){this.__currentElement.nodeName==="path"&&this.__currentElement.setAttribute("paint-order","stroke fill markers"),this.__applyCurrentDefaultPath(),this.__applyStyleToCurrentElement("fill")};xt.prototype.rect=function(t,e,r,i){this.__currentElement.nodeName!=="path"&&this.beginPath(),this.moveTo(t,e),this.lineTo(t+r,e),this.lineTo(t+r,e+i),this.lineTo(t,e+i),this.lineTo(t,e),this.closePath()};xt.prototype.fillRect=function(t,e,r,i){var n,o;n=this.__createElement("rect",{x:t,y:e,width:r,height:i},!0),o=this.__closestGroupOrSvg(),o.appendChild(n),this.__currentElement=n,this.__applyStyleToCurrentElement("fill")};xt.prototype.strokeRect=function(t,e,r,i){var n,o;n=this.__createElement("rect",{x:t,y:e,width:r,height:i},!0),o=this.__closestGroupOrSvg(),o.appendChild(n),this.__currentElement=n,this.__applyStyleToCurrentElement("stroke")};xt.prototype.__clearCanvas=function(){for(var t=this.__closestGroupOrSvg(),e=t.getAttribute("transform"),r=this.__root.childNodes[1],i=r.childNodes,n=i.length-1;n>=0;n--)i[n]&&r.removeChild(i[n]);this.__currentElement=r,this.__groupStack=[],e&&this.__addTransform(e)};xt.prototype.clearRect=function(t,e,r,i){if(t===0&&e===0&&r===this.width&&i===this.height){this.__clearCanvas();return}var n,o=this.__closestGroupOrSvg();n=this.__createElement("rect",{x:t,y:e,width:r,height:i,fill:"#FFFFFF"},!0),o.appendChild(n)};xt.prototype.createLinearGradient=function(t,e,r,i){var n=this.__createElement("linearGradient",{id:aD(this.__ids),x1:t+"px",x2:r+"px",y1:e+"px",y2:i+"px",gradientUnits:"userSpaceOnUse"},!1);return this.__defs.appendChild(n),new qy(n,this)};xt.prototype.createRadialGradient=function(t,e,r,i,n,o){var s=this.__createElement("radialGradient",{id:aD(this.__ids),cx:i+"px",cy:n+"px",r:o+"px",fx:t+"px",fy:e+"px",gradientUnits:"userSpaceOnUse"},!1);return this.__defs.appendChild(s),new qy(s,this)};xt.prototype.__parseFont=function(){var t=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-,\'\"\sa-z0-9]+?)\s*$/i,e=t.exec(this.font),r={style:e[1]||"normal",size:e[4]||"10px",family:e[6]||"sans-serif",weight:e[3]||"normal",decoration:e[2]||"normal",href:null};return this.__fontUnderline==="underline"&&(r.decoration="underline"),this.__fontHref&&(r.href=this.__fontHref),r};xt.prototype.__wrapTextLink=function(t,e){if(t.href){var r=this.__createElement("a");return r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",t.href),r.appendChild(e),r}return e};xt.prototype.__applyText=function(t,e,r,i){var n=this.__parseFont(),o=this.__closestGroupOrSvg(),s=this.__createElement("text",{"font-family":n.family,"font-size":n.size,"font-style":n.style,"font-weight":n.weight,"text-decoration":n.decoration,x:e,y:r,"text-anchor":gH(this.textAlign)},!0);s.appendChild(this.__document.createTextNode(t)),this.__currentElement=s,this.__applyStyleToCurrentElement(i),o.appendChild(this.__wrapTextLink(n,s))};xt.prototype.fillText=function(t,e,r){this.__applyText(t,e,r,"fill")};xt.prototype.strokeText=function(t,e,r){this.__applyText(t,e,r,"stroke")};xt.prototype.measureText=function(t){return this.__ctx.font=this.font,this.__ctx.measureText(t)};xt.prototype.arc=function(t,e,r,i,n,o){if(i!==n){i=i%(2*Math.PI),n=n%(2*Math.PI),i===n&&(n=(n+2*Math.PI-.001*(o?-1:1))%(2*Math.PI));var s=t+r*Math.cos(n),a=e+r*Math.sin(n),l=t+r*Math.cos(i),c=e+r*Math.sin(i),d=o?0:1,u=0,p=n-i;p<0&&(p+=2*Math.PI),o?u=p>Math.PI?0:1:u=p>Math.PI?1:0,this.lineTo(l,c),this.__addPathCommand(Is("A {rx} {ry} {xAxisRotation} {largeArcFlag} {sweepFlag} {endX} {endY}",{rx:r,ry:r,xAxisRotation:0,largeArcFlag:u,sweepFlag:d,endX:s,endY:a})),this.__currentPosition={x:s,y:a}}};xt.prototype.clip=function(){var t=this.__closestGroupOrSvg(),e=this.__createElement("clipPath"),r=aD(this.__ids),i=this.__createElement("g");this.__applyCurrentDefaultPath(),t.removeChild(this.__currentElement),e.setAttribute("id",r),e.appendChild(this.__currentElement),this.__defs.appendChild(e),t.setAttribute("clip-path",Is("url(#{id})",{id:r})),t.appendChild(i),this.__currentElement=i};xt.prototype.drawImage=function(){var t=Array.prototype.slice.call(arguments),e=t[0],r,i,n,o,s=0,a=0,l,c,d,u,p,g,b,x,w,E,k;if(t.length===3)r=t[1],i=t[2],l=e.width,c=e.height,n=l,o=c;else if(t.length===5)r=t[1],i=t[2],n=t[3],o=t[4],l=e.width,c=e.height;else if(t.length===9)s=t[1],a=t[2],l=t[3],c=t[4],r=t[5],i=t[6],n=t[7],o=t[8];else throw new Error("Invalid number of arguments passed to drawImage: "+arguments.length);d=this.__closestGroupOrSvg(),b=this.__currentElement;var S="translate("+r+", "+i+")";if(e instanceof xt){if(u=e.getSvg().cloneNode(!0),u.childNodes&&u.childNodes.length>1){for(p=u.childNodes[0];p.childNodes.length;)k=p.childNodes[0].getAttribute("id"),this.__ids[k]=k,this.__defs.appendChild(p.childNodes[0]);if(g=u.childNodes[1],g){var T=g.getAttribute("transform"),V;T?V=T+" "+S:V=S,g.setAttribute("transform",V),d.appendChild(g)}}}else(e.nodeName==="CANVAS"||e.nodeName==="IMG")&&(x=this.__createElement("image"),x.setAttribute("width",n),x.setAttribute("height",o),x.setAttribute("opacity",this.globalAlpha),x.setAttribute("preserveAspectRatio","none"),(s||a||l!==e.width||c!==e.height)&&(w=this.__document.createElement("canvas"),w.width=n,w.height=o,E=w.getContext("2d"),E.drawImage(e,s,a,l,c,0,0,n,o),e=w),x.setAttribute("transform",S),x.setAttribute("xlink:href",e.nodeName==="CANVAS"?e.toDataURL():e.getAttribute("src")),d.appendChild(x))};xt.prototype.createPattern=function(t,e){var r=this.__document.createElementNS("http://www.w3.org/2000/svg","pattern"),i=aD(this.__ids),n;return r.setAttribute("id",i),r.setAttribute("width",t.width),r.setAttribute("height",t.height),t.nodeName==="CANVAS"||t.nodeName==="IMG"?(n=this.__document.createElementNS("http://www.w3.org/2000/svg","image"),n.setAttribute("width",t.width),n.setAttribute("height",t.height),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",t.nodeName==="CANVAS"?t.toDataURL():t.getAttribute("src")),r.appendChild(n),this.__defs.appendChild(r)):t instanceof xt&&(r.appendChild(t.__root.childNodes[1]),this.__defs.appendChild(r)),new tM(r,this)};xt.prototype.setLineDash=function(t){t&&t.length>0?this.lineDash=t.join(","):this.lineDash=null};xt.prototype.ellipse=function(t,e,r,i,n,o,s,a){if(o!==s){o=o%(2*Math.PI),s=s%(2*Math.PI),o===s&&(s=(s+2*Math.PI-.001*(a?-1:1))%(2*Math.PI));var l=t+Math.cos(-n)*r*Math.cos(s)+Math.sin(-n)*i*Math.sin(s),c=e-Math.sin(-n)*r*Math.cos(s)+Math.cos(-n)*i*Math.sin(s),d=t+Math.cos(-n)*r*Math.cos(o)+Math.sin(-n)*i*Math.sin(o),u=e-Math.sin(-n)*r*Math.cos(o)+Math.cos(-n)*i*Math.sin(o),p=a?0:1,g=0,b=s-o;b<0&&(b+=2*Math.PI),a?g=b>Math.PI?0:1:g=b>Math.PI?1:0,this.lineTo(d,u),this.__addPathCommand(Is("A {rx} {ry} {xAxisRotation} {largeArcFlag} {sweepFlag} {endX} {endY}",{rx:r,ry:i,xAxisRotation:n*(180/Math.PI),largeArcFlag:g,sweepFlag:p,endX:l,endY:c})),this.__currentPosition={x:l,y:c}}};xt.prototype._dcgSetTitle=function(t){var e=this.__currentElement,r=!1,i,n=e.getElementsByTagName("title");n.length>0?i=n[0]:(i=this.__document.createElementNS("http://www.w3.org/2000/svg","title"),r=!0),i.textContent=t,r&&e.appendChild(i)};xt.prototype.drawFocusRing=function(){};xt.prototype.createImageData=function(){};xt.prototype.getImageData=function(){};xt.prototype.putImageData=function(){};xt.prototype.globalCompositeOperation=function(){};xt.prototype.setTransform=function(){};var Z2=xt;Oe();var Hd=document.createElement("canvas").getContext("2d"),Qo=class{constructor(e,r){this._label=e,this._fontSize=r,this._layout=mH(e,r)}getRect(){return this.getRectWhenCenteredAt({x:0,y:0})}getRectWhenCenteredAt(e){return{left:this._layout.left+e.x,right:this._layout.right+e.x,top:this._layout.top+e.y,bottom:this._layout.bottom+e.y}}getBoundsWhenCenteredAt(e,r){switch(r){case"x":return{lower:this._layout.left+e,upper:this._layout.right+e};case"y":return{lower:this._layout.top+e,upper:this._layout.bottom+e};default:let i=r;throw new Error(`Unknown axis: ${i}`)}}getWidth(){return this._layout.right-this._layout.left}getHeight(){return this._layout.bottom-this._layout.top}getDimensionAlongAxis(e){switch(e){case"x":return this.getWidth();case"y":return this.getHeight();default:let r=e;throw new Error(`Unknown axis: ${r}`)}}clampBoundsWithinRect(e,r){let i,n;return e.x+this._layout.left<r.left?i=r.left-this._layout.left:e.x+this._layout.right>r.right?i=r.right-this._layout.right:i=e.x,e.y+this._layout.top<r.top?n=r.top-this._layout.top:e.y+this._layout.bottom>r.bottom?n=r.bottom-this._layout.bottom:n=e.y,{x:i,y:n}}getValue(){return this._label.value}getMinusWidth(){return this.getValue()<0?(Qo.setCtxFontSize(Hd,this._fontSize),Hd.measureText("-1").width-Hd.measureText("1").width):0}getString(){return this._label.superscript?this._label.mantissa+"^"+this._label.superscript:this._label.string}drawCenteredAt(e,r,i){let n=r.x,o=Qo.computeBaselineFromCenter(r.y,this._fontSize);i&&Ki(e,i),e.save(),i&&Ei(e),Qo.setCtxFontSize(e,this._fontSize),this._label.superscript?(e.strokeText(this._label.mantissa,this._layout.mantissa_x+n,this._layout.mantissa_y+o),e.strokeText(this._label.superscript,this._layout.superscript_x+n,this._layout.superscript_y+o),e.fillText(this._label.mantissa,this._layout.mantissa_x+n,this._layout.mantissa_y+o),e.fillText(this._label.superscript,this._layout.superscript_x+n,this._layout.superscript_y+o)):(e.strokeText(this._label.string,this._layout.mantissa_x+n,this._layout.mantissa_y+o),e.fillText(this._label.string,this._layout.mantissa_x+n,this._layout.mantissa_y+o)),e.restore()}static computeBaselineFromCenter(e,r){return e+.272*r}static setCtxFontSize(e,r){e.font=r+"px Arial",e.textAlign="center"}};function mH(t,e){if(t.superscript){let r=e;Qo.setCtxFontSize(Hd,r);let i=Hd.measureText(t.mantissa).width,n=Math.round(.8*e);Qo.setCtxFontSize(Hd,n);let o=Hd.measureText(t.superscript).width,s=0,a=e/5,l=i/2+o/2,c=-e/4,d=c-n/2,u=a+r/2,p=s-i/2,g=l+o/2;return{top:d,bottom:u,left:p,right:g,mantissa_height:r,mantissa_width:i,mantissa_x:s,mantissa_y:a,superscript_height:n,superscript_width:o,superscript_x:l,superscript_y:c}}else{let r=e;Qo.setCtxFontSize(Hd,e);let i=Hd.measureText(t.string).width,n=0,o=0,s=o-r/2,a=o+r/2,l=n-i/2,c=n+i/2;return{top:s,bottom:a,left:l,right:c,mantissa_height:r,mantissa_width:i,mantissa_x:n,mantissa_y:o}}}function fH(t,e,r,i){let n=Math.ceil(t/r),o=Math.floor(e/r),s=1/r;if(!(n>o)&&!(o-n>1e4))for(let a=n;a<=o;a++)i(a/s)}var rM={base:10,major:[1,2,5],minor:[5,4,5]},yH={base:10,major:[Math.PI,2*Math.PI,5*Math.PI],minor:[4,4,5]},bH={base:2,major:[Math.PI/3],minor:[3]};function wH(t){return t?{base:10,major:[t,2*t,5*t],minor:[4,4,5]}:rM}function iM(t,e){let{major:r,minor:i,base:n}=e,o=1/0,s=1/0;for(let a=0;a<r.length;a++){let l=r[a],c=Math.ceil(Math.log(t/l)/Math.log(n)),d=l*Math.pow(n,c);if(d<o){o=d;let u=i[a];s=o/u}}return{major:o,minor:s}}function xH(t,e,r){return 1+(e-t)/r}function eR(t){let e=t.screen.width,r=t.screen.height,i=t.viewport.xmax-t.viewport.xmin,n=t.viewport.ymax-t.viewport.ymin,o=t.settings.pixelsPerLabel;return{majorStepX:o/e*i,majorStepY:o/r*n}}function Jh(t){let e=l=>{let[c,d,u,p,g]=l==="x"?[t.viewport.xmin,t.viewport.xmax,t.settings.xAxisStep,t.settings.xAxisNumbers,t.settings.xAxisMinorSubdivisions]:[t.viewport.ymin,t.viewport.ymax,t.settings.yAxisStep,t.settings.yAxisNumbers,t.settings.yAxisMinorSubdivisions],b=d-c,x=Math.abs(u!=null?u:NaN),w=0,E=0;if(x&&x!==Math.PI){let k=xH(c,d,x);if(k>=3&&k<100){let S=0;if(p){let V=0;fH(c,d,x,function(O){let y=new Qo(__dcg_shared_module_exports__['Bb'](O,b),t.settings.labelSize);V=Math.max(y.getDimensionAlongAxis(l),V)}),S=V+10}else S=g===1?8:20;let T=l==="x"?"width":"height";k*S<=t.screen[T]&&(w=x,x===3||x===5?E=1:E=x/4)}}if(!w){let k=eR(t)[l==="x"?"majorStepX":"majorStepY"],S=iM(k,__dcg_shared_module_exports__['Bb'](x,b).string.indexOf("\u03C0")>=0?k>=1?yH:bH:wH(x));w=S.major,E=S.minor}return{majorStep:w,minorStep:E}},r=()=>{var l,c;if(Math.abs((l=t.settings.xAxisStep)!=null?l:NaN)===Math.abs((c=t.settings.yAxisStep)!=null?c:NaN)){let{xmin:p,xmax:g,ymin:b,ymax:x}=t.viewport,w=t.screen.width/(g-p),E=t.screen.height/(x-b),k=w/E;if(k>=1&&k<=2){let{majorStep:S,minorStep:T}=e("y");return{x:{majorStep:S,minorStep:T},y:{majorStep:S,minorStep:T}}}if(k<=1&&k>=.5){let{majorStep:S,minorStep:T}=e("x");return{x:{majorStep:S,minorStep:T},y:{majorStep:S,minorStep:T}}}}return{x:e("x"),y:e("y")}},i=()=>{let{xAxisScale:l,yAxisScale:c}=t.settings,d=l==="logarithmic",u=c==="logarithmic";return!d&&!u?r():{x:d?{majorStep:NaN,minorStep:NaN}:e("x"),y:u?{majorStep:NaN,minorStep:NaN}:e("y")}},{x:n,y:o}=i(),{xAxisMinorSubdivisions:s=0,yAxisMinorSubdivisions:a=0}=t.settings;return{majorStepX:n.majorStep,minorStepX:s>0?n.majorStep/s:n.minorStep,majorStepY:o.majorStep,minorStepY:a>0?o.majorStep/a:o.minorStep}}function tR(t){let e=eR(t),r=iM(e.majorStepX,rM),i=iM(e.majorStepY,rM),n=r.major>i.major?r:i;return{majorStepR:n.major,minorStepR:n.minor}}Oe();ql();var Xg,lD=[],rR="",iR=oo();function Kn(){Xg!==void 0&&Xg.empty()}function Nt(t){lD.push(t)}function me(t){if(t!==void 0&&Nt(t),Xg!==void 0&&lD.length>0){let e=lD.join(" ").replace(/ +(?= )/g,"");Xg.attr("aria-relevant",rR===e&&Zr?"all":"additions text"),e&&iR.logAria&&__dcg_shared_module_exports__['M'].log(e),Xg.empty().text(e),rR=e}lD.length=0}function vH(){document.documentElement.addEventListener("focus",t=>{let e=t.target;if(e instanceof Element){let r=e.getAttribute("aria-label");r&&__dcg_shared_module_exports__['M'].log(r)}},!0)}iR.logAria&&vH();I(()=>{let t=".dcg-aria-alert";I(t).length===0&&I("body").append("<p aria-live='assertive' aria-atomic='true' class='dcg-aria-alert'></p>"),Xg=I(t)});var ic=__dcg_shared_module_exports__['i'](Z());var CH=/`[^`]*`/g,DH=/^[\+\-]?[\d]*(\.\d+)?$/,SH=t=>{if(t!=null){let e=t.match(/`/g);return(e!=null&&e.length||0)%2==0}return!0},EH=t=>{let e=[];if(t==null||t.length==0)return e;let r=0,i;for(;i=CH.exec(t);){let o=t.slice(r,i.index);o.length>0&&e.push({from:r,to:i.index,type:"text",text:o}),r=i.index+i[0].length,e.push({from:i.index,to:r,type:"math",text:i[0].slice(1,-1)})}let n=t.slice(r);return n.length>0&&e.push({from:r,to:t.length,type:"text",text:n}),e},nR=dl.StaticMath(document.createElement("span"));function Eo(t){let e="",r=[];SH(t)?r=EH(t):r=[{from:0,to:t.length,type:"text",text:t}];for(let i of r)e+=i.type==="text"?i.text:fs(i.text);return e}function fs(t){let e="";return DH.test(t)?(/^\+/.test(t)?(e="positive ",t=t.slice(1)):/^\-/.test(t)&&(e="negative ",t=t.slice(1)),e+=t.replace(/(\.)([0-9]+)/g,(r,i,n)=>i+n.split("").join(" ").trim())):(nR.latex(t),e=nR.mathspeak().trim()),e}Oe();var yi=__dcg_shared_module_exports__['i'](Z());Oe();var kH=1,zd=class{constructor(e,r,i,n,o,s,a){this.x=e,this.y=r,this.type=i,this.sketch=n,this.branch=o,this.pointIdxOnBranch=s,this.bareLabel=a===void 0?!1:a,this.id=kH++}getLabel(){let e=this.sketch&&this.sketch.branches[this.branch];return e&&"labels"in e&&e.labels&&e.labels[this.pointIdxOnBranch]||""}getGraphMode(){return this.sketch.branches[this.branch].graphMode}getCompiledFunction(){let e=this.sketch.branches[this.branch];if(!(!("compiled"in e)||!e.compiled))return e.compiled.fn}isAttachedToPlottedPoint(){return this.type===1006||this.type===1008}isMovable(){return this.getGraphMode()===4}isPersistent(){return this.type===1008}getLabelSize(){let e=this.sketch&&this.sketch.branches[this.branch];return this.type===1008&&e&&"labelSize"in e?e.labelSize===void 0?1:e.labelSize:1}getLabelRotation(){let e=this.sketch&&this.sketch.branches[this.branch];return this.type===1008&&e&&"labelAngle"in e?e.labelAngle===void 0?0:e.labelAngle:0}getPointOpacity(){let e=this.sketch&&this.sketch.branches[this.branch];if(e&&"pointOpacity"in e){let r=e.pointOpacity;if(r!==void 0){let i;return Array.isArray(r)?i=r[this.pointIdxOnBranch]:i=r,isFinite(i)?Math.max(0,Math.min(1,i)):.9}}return this.isMovable()?1:.9}getPointSize(){let e=this.sketch&&this.sketch.branches[this.branch];if(this.isMovable())return 22;if(e&&"pointSize"in e){let r=e.pointSize;if(r!==void 0){let i;return Array.isArray(r)?i=r[this.pointIdxOnBranch]:i=r,isFinite(i)?Math.max(0,i):9}}return 9}getTextOutline(){if(this.hasEditableLabel())return!1;let e=this.sketch&&this.sketch.branches[this.branch];return this.type===1008&&e&&"suppressTextOutline"in e?!e.suppressTextOutline:!0}hasInteractiveLabel(){let e=this.sketch&&this.sketch.branches[this.branch];return e&&"interactiveLabel"in e?!!e.interactiveLabel:!1}hasEditableLabel(){let e=this.sketch&&this.sketch.branches[this.branch];return e&&"editableLabel"in e?!!e.editableLabel:!1}isBareLabel(){return this.bareLabel}getMovablePoint(){return this.sketch.getMovablePointByIndex(this.pointIdxOnBranch)}isSelected(){return this.sketch.showHighlight}};function cD(t,e,r){return Math.max(e,Math.min(r,t))}var Qg=class{constructor(e){let r=e.data,i=e.width,n=e.height;this.imageData=e;for(let l=1;l<i;l++)r[l]+=r[l-1];for(let l=1;l<n;l++)r[l*i]+=r[l*i-i];let o=i*n-i-n+1,s=i-1;for(var a=0;a<o;a++){let l=1+a%s,d=(1+Math.floor(a/s))*i,u=l-1+d,p=l+d-i,g=l-1+d-i;r[d+l]+=r[u]+r[p]-r[g]}}getSumForValidRect(e){let r=e.left-1,i=e.right-1,n=e.top-1,o=e.bottom-1,s=this.imageData.width,a=this.imageData.data,l=a[r+n*s],c=a[i+n*s],d=a[r+o*s],u=a[i+o*s];return r>=0&&n>=0?u-c-d+l:r>=0?u-d:n>=0?u-c:u}getSum(e){let r={left:cD(Math.floor(e.left),0,this.imageData.width),right:cD(Math.ceil(e.right),0,this.imageData.width),top:cD(Math.floor(e.top),0,this.imageData.height),bottom:cD(Math.ceil(e.bottom),0,this.imageData.height)};return r.left>=r.right||r.top>=r.bottom?0:this.getSumForValidRect(r)}};var Xh=1/2,Yh=document.createElement("canvas"),sM=[];function GH(t,e){if(!(e.width*e.height>0))return new Qg({width:0,height:0,data:[]});Yh.width=0,Yh.width=Math.round(e.width*Xh),Yh.height=Math.round(e.height*Xh);let i=Yh.getContext("2d");i.save(),i.scale(Yh.width/t.canvas.width,Yh.height/t.canvas.height),i.drawImage(t.canvas,0,0),i.restore();var n=i.getImageData(0,0,Yh.width,Yh.height),o=n.data;o.length/4,sM.length,sM=new Array(o.length/4);for(var s=sM,a=0;a<s.length;a++)s[a]=o[a*4+3];var l=new Qg({width:n.width,height:n.height,data:s});return l}function oR(t){for(var e=0;e<t.length;e++){var r=VH(e,t);t[e]=[r]}return t.map(function(i){return i[0]})}function VH(t,e){var r=1/0,i=-1,n=e[t];if(n.length===1)return n[0];for(var o=0;o<n.length;o++){var s=e[t][o].staticScore,a=IH(t,o,e),l=s+a;(i===-1||l<r)&&(r=l,i=o)}return n[i]}function IH(t,e,r){for(var i=0,n=r[t][e],o=0;o<r.length;o++)if(o!==t){for(var s=0,a=r[o],l=a.length-1;l>=0;l--){var c=a[l],d=Math.max(0,Math.min(n.right,c.right)-Math.max(n.left,c.left)),u=Math.max(0,Math.min(n.bottom,c.bottom)-Math.max(n.top,c.top));s+=d*u}i+=s/a.length}return i}function MH(t,e){var r=e.getSum({left:t.left*Xh,right:t.right*Xh,top:t.top*Xh,bottom:t.bottom*Xh});return r/=200,r/=Xh*Xh,r}function TH(t,e){var r=0;return e.forEach(function(i){r+=sR(t,i)}),r}function AH(t,e){var r=sR(t,e);return 10*(t.width*t.height-r)}function sR(t,e){var r=Math.max(0,Math.min(t.right,e.right)-Math.max(t.left,e.left)),i=Math.max(0,Math.min(t.bottom,e.bottom)-Math.max(t.top,e.top));return r*i}function aR(t,e,r){let i;return()=>(i||(i={domObstructions:r,viewport:{left:0,right:e.width,top:0,bottom:e.height},integralImage:GH(t,e)}),i)}function dD(t,e){if(!(e.length<=1)){var r=t();for(var i of e)i.staticScore+=AH(i,r.viewport),i.staticScore+=TH(i,r.domObstructions),i.staticScore+=MH(i,r.integralImage)}}function lR(t,e){var r=e.nakedLabel?0:e.pt_radius,i=Math.round(r/Math.sqrt(2)),n=[],o=e.pt_x,s=e.pt_y,a=e.width,l=e.height,c=400;n.push({cx_s:0,cy_s:0,cx_a:0,cy_a:0,staticScore:c,orientation:"center",matches:{default:1,center:1,center_auto:1,auto_center:1}}),n.push({cx_s:.5,cx_a:r+3,cy_s:0,cy_a:0,staticScore:c,orientation:"right",matches:{default:1,right:1,center_auto:1,auto_right:1}}),n.push({cx_s:-.5,cx_a:-r-3,cy_s:0,cy_a:0,staticScore:c,orientation:"left",matches:{default:1,left:1,center_auto:1,auto_left:1}}),n.push({cx_s:0,cx_a:0,cy_s:-.5,cy_a:-r,staticScore:c,orientation:"above",matches:{default:1,above:1,auto_center:1,above_auto:1}}),n.push({cx_s:-.5,cx_a:-i,cy_s:-.5,cy_a:-i,staticScore:c,orientation:"tl",matches:{default:1,above_left:1,above_auto:1,auto_left:1}}),n.push({cx_s:.5,cx_a:i,cy_s:-.5,cy_a:-i,staticScore:c,orientation:"tr",matches:{default:1,above_right:1,above_auto:1,auto_right:1}}),n.push({cx_s:0,cx_a:0,cy_s:.5,cy_a:r,staticScore:c,orientation:"below",matches:{default:1,below:1,auto_center:1,below_auto:1}}),n.push({cx_s:-.5,cx_a:-i,cy_s:.5,cy_a:i,staticScore:c,orientation:"bl",matches:{default:1,below_left:1,below_auto:1,auto_left:1}}),n.push({cx_s:.5,cx_a:i,cy_s:.5,cy_a:i,staticScore:c,orientation:"br",matches:{default:1,below_right:1,below_auto:1,auto_right:1}});var d=Math.cos(e.rotation),u=Math.sin(e.rotation),p=n.map(function(g){var b=g.cx_s*a+g.cx_a,x=g.cy_s*l+g.cy_a;let w=b*d-x*u,E=x*d+b*u,k=`calc(${g.cx_s*100-50}% + ${g.cx_a}px)`,S=`calc(${g.cy_s*100-50}% + ${g.cy_a}px)`,T=-a/2,V=a/2,O=-l/2,y=l/2;if(e.rotation){let L=LH([{x:T*d-O*u,y:O*d+T*u},{x:T*d-y*u,y:y*d+T*u},{x:V*d-O*u,y:O*d+V*u},{x:V*d-y*u,y:y*d+V*u}]);T=L.left,V=L.right,O=L.top,y=L.bottom}return T=Math.round(o+w+T),V=Math.round(o+w+V),O=Math.round(s+E+O),y=Math.round(s+E+y),{pt_x:Math.round(o),pt_y:Math.round(s),left:T,right:V,top:O,bottom:y,width:V-T,height:y-O,transform:`translate(${k},${S})`,staticScore:e.priorOrientation===g.orientation?g.staticScore-20:g.staticScore,orientation:g.orientation,matches:g.matches}});return e.enforceOrientation&&e.enforceOrientation!=="default"?p=__dcg_shared_module_exports__['m'](p,function(g){return!!g.matches[e.enforceOrientation]}):e.nakedLabel?p=__dcg_shared_module_exports__['m'](p,function(g){return g.orientation==="center"}):e.keepOrientation&&e.priorOrientation?p=__dcg_shared_module_exports__['m'](p,function(g){return g.orientation===e.priorOrientation}):p=__dcg_shared_module_exports__['m'](p,function(g){return g.orientation!=="center"}),dD(t,p),p}function cR(t,e){var r=[],i=e.width,n=e.height,o=i/2,s=n/2,a=e.pt_x1,l=e.pt_y1,c=e.pt_x2,d=e.pt_y2,u=5,p=(d-l)/(c-a),g=Math.atan2(d-l,c-a)+Math.PI/2,b=u*Math.cos(g),x=u*Math.sin(g),w=Math.min(l,d)-Math.abs(x)-n,E=Math.max(l,d)+Math.abs(x),k=[.5,.4,.6,.2,.8],S=[0,20,20,40,40],T=[];for(let K of k)T.push({x:a*(1-K)+c*K,y:l*(1-K)+d*K});for(let K=0;K<T.length;K++){let $=T[K];var V,O,y,L;if(p>=2||p<=-2){y=L=$.y-s;let q=Math.abs((c-a)/(d-l)*s)+Math.abs(b);V=$.x+q,O=$.x-q-i}else if(p<=.05&&p>=-.05){V=O=$.x-o;let q=Math.abs(p*o)+Math.abs(x);y=$.y-q-n,L=$.y+q}else b>0?(V=$.x+b,O=$.x-b-i):(V=$.x+b-i,O=$.x-b),x>0?(y=$.y+x,L=$.y-x-n):(y=$.y+x-n,L=$.y-x);y<w?y=w:y>E&&(y=E),L<w?L=w:L>E&&(L=E);let U=(c-a)*(y-l)-(d-l)*(V-a)>0,J=K.toString()+(U?"-a":"-b");r.push({pt_x:$.x,pt_y:$.y,left:V,top:y,staticScore:S[K],orientation:J,matches:{[J]:1}});let R=K.toString()+(U?"-b":"-a");r.push({pt_x:$.x,pt_y:$.y,left:O,top:L,staticScore:S[K],orientation:R,matches:{[R]:1}})}var P=r.map(function(K){let $=Math.round(K.left),U=Math.round(K.left+i),J=Math.round(K.top),R=Math.round(K.top+n);return{pt_x:Math.round(K.pt_x),pt_y:Math.round(K.pt_y),transform:`translate(${K.left-K.pt_x}px,${K.top-K.pt_y}px)`,left:$,right:U,top:J,bottom:R,width:U-$,height:R-J,staticScore:e.priorOrientation===K.orientation?K.staticScore-20:K.staticScore,orientation:K.orientation,matches:K.matches}});return e.keepOrientation&&e.priorOrientation&&(P=__dcg_shared_module_exports__['m'](P,function(K){return K.orientation===e.priorOrientation})),dD(t,P),P}function dR(t,e){var r=[],i=e.pt_x,n=e.pt_y,o=e.width,s=e.height;let a=-(e.startAngle+e.deltaAngle/2),l=e.isRightAngle?e.radius*Math.sqrt(2):e.radius+4,c=l+Math.sqrt(e.width*e.width/4+e.height*e.height/4),d=[],u=c*Math.sin(a);u>l+1/2*s&&(u=l+1/2*s),u<-l-1/2*s&&(u=-l-1/2*s),d.push({x:i+c*Math.cos(a)-o/2,y:n+u-s/2});for(let g=0;g<d.length;g++){let b=d[g],x=g.toString()+"-a";r.push({pt_x:b.x,pt_y:b.y,left:b.x,top:b.y,staticScore:0,orientation:x,matches:{[x]:1}})}var p=r.map(function(g){let b=Math.round(g.left),x=Math.round(g.left+o),w=Math.round(g.top),E=Math.round(g.top+s);return{pt_x:Math.round(g.pt_x),pt_y:Math.round(g.pt_y),transform:`translate(${g.left-g.pt_x}px,${g.top-g.pt_y}px)`,left:b,right:x,top:w,bottom:E,width:x-b,height:E-w,staticScore:e.priorOrientation===g.orientation?g.staticScore-20:g.staticScore,orientation:g.orientation,matches:g.matches}});return e.keepOrientation&&e.priorOrientation&&(p=__dcg_shared_module_exports__['m'](p,function(g){return g.orientation===e.priorOrientation})),dD(t,p),p}function hR(t,e){for(var r=[],i=e.width,n=e.height,o=10,s=Math.round(o/Math.sqrt(2)),a=0,l=50,c=0,d=0,u=0,p=0;p<e.path.length-2;p+=2)u+=1,c+=e.path[p],d+=e.path[p+1];var g=c/u,b=d/u;r.push({left:g-i/2,top:b-n/2,staticScore:a,orientation:"center",matches:{center:1}}),r.push({left:g+o+3,top:b-n/2,staticScore:l,orientation:"right",matches:{right:1}}),r.push({left:g-(o+i)-3,top:b-n/2,staticScore:l,orientation:"left",matches:{left:1}}),r.push({left:g-i/2,top:b-(n+o),staticScore:l,orientation:"top",matches:{top:1}}),r.push({left:g-(i+s),top:b-(n+s),staticScore:l,orientation:"tl",matches:{tl:1}}),r.push({left:g+s,top:b-(n+s),staticScore:l,orientation:"tr",matches:{tr:1}}),r.push({left:g-i/2,top:b+o,staticScore:l,orientation:"bottom",matches:{bottom:1}}),r.push({left:g-(i+s),top:b+s,staticScore:l,orientation:"bl",matches:{bl:1}}),r.push({left:g+s,top:b+s,staticScore:l,orientation:"br",matches:{br:1}});var x=r.map(function(w){let E=Math.round(w.left),k=Math.round(w.left+i),S=Math.round(w.top),T=Math.round(w.top+n);return{pt_x:Math.round(g),pt_y:Math.round(b),transform:`translate(${w.left-g}px,${w.top-b}px)`,left:E,right:k,top:S,bottom:T,width:k-E,height:T-S,staticScore:e.priorOrientation===w.orientation?w.staticScore-20:w.staticScore,orientation:w.orientation,matches:w.matches}});return e.keepOrientation&&e.priorOrientation&&(x=__dcg_shared_module_exports__['m'](x,function(w){return w.orientation===e.priorOrientation})),dD(t,x),x}function LH(t){let e=t[0].x,r=t[0].x,i=t[0].y,n=t[0].y;for(var o=t.length-1;o>=1;o--){let{x:s,y:a}=t[o];s<e&&(e=s),s>r&&(r=s),a<i&&(i=a),a>n&&(n=a)}return{left:e,right:r,top:i,bottom:n}}var hD=__dcg_shared_module_exports__['i'](Z());Oe();var et=class extends hD.Class{template(){return this.children.length===1?this.children[0]:hD.createElement("div",{didMount:t=>this.didMountMathquill(t)})}didMount(){this.children.length===1&&this.didMountMathquill(this.findRootNode())}didMountMathquill(t){this.staticMath=dl.StaticMath(t,__dcg_shared_module_exports__['b']({},this.props.config())),I(t).addClass("dcg-static-mathquill-view"),this.updateMathquill()}didUpdate(){this.updateMathquill()}updateMathquill(){this.updateMathquillAria(),this.updateMathquillLatex()}updateMathquillLatex(){if(!this.staticMath)return;let t=this.props.latex();this.lastLatex!==t&&(this.staticMath.latex(t),this.lastLatex=t,this.props.onReflow&&this.props.onReflow())}updateMathquillAria(){if(!this.staticMath||!this.props.getAriaLabel)return;let t=this.props.getAriaLabel();t!==this.staticMath.getAriaLabel()&&this.staticMath.setAriaLabel(t)}};Oe();var zie=function(){{var t="_*_";I.Event.prototype.wasHandled=function(e){e=e||t;var r=this.originalEvent,i=r&&r.handledBy;if(i&&i[e])return!0;if(e!==t)return!1;var n=I(this.target).closest("[handleEvent]");return n.length&&n[0]!==this.currentTarget?n.attr("handleEvent")!=="false":!1},I.Event.prototype.handle=function(e){e=e||t;var r=this.originalEvent;if(r){var i=r.handledBy;i||(i=r.handledBy={}),i[e]=!0}}}}();var Hs=__dcg_shared_module_exports__['i'](Z());Oe();function Zg(t){let e=__dcg_shared_module_exports__['Xb'](t),r=0;for(;!__dcg_shared_module_exports__['Zb'](e);)r+=1,e=__dcg_shared_module_exports__['Yb'](e);return r}var Ts=__dcg_shared_module_exports__['i'](Z());function yt(t){return{shouldBeFocused:()=>zy(t),onFocusedChanged:e=>{aM(t,e)}}}function zy(t){let e=t.predicate;if(e&&!e())return!1;let r=t.controller.getFocusLocation();return r&&__dcg_shared_module_exports__['F'](r,t.location)}function aM(t,e){let r=t.predicate;r&&!r()||(e?t.controller.dispatch({type:"set-focus-location",location:t.location}):t.controller.dispatch({type:"blur-focus-location",location:t.location}))}var{If:lM}=Ts.Components,td=class extends Ts.Class{init(){this.controller=this.props.controller()}template(){return Ts.createElement("span",{class:()=>{let e=this.parentOrChildHovered();return{"dcg-geo-token-view":!0,"dcg-selected-token":this.isTokenSelected(),"dcg-hidden-token":this.isHidden(),"dcg-token-has-label":this.hasLabel(),"dcg-child-of-hovered-token":e==="child","dcg-parent-of-hovered-token":e==="parent","dcg-assignment-token":!!this.getAssignment()}},style:()=>({color:this.getColor()}),role:()=>this.props.insideGroup()?"option":"button","aria-roledescription":()=>this.props.insideGroup()?void 0:this.controller.s("graphing-calculator-narration-geometry-construction-role-description"),"aria-label":this.bindFn(this.getAriaLabel),"aria-selected":this.bindFn(this.isTokenSelected),tabindex:()=>this.props.putInTabOrder()?0:-1,manageFocus:()=>this.props.focusLocation?yt({controller:this.controller,location:this.props.focusLocation()}):void 0,onTapStart:this.bindFn(this.onTapStart),onTap:this.bindFn(this.onTap),onPointerOver:this.bindFn(this.onPointerOver),onPointerOut:this.bindFn(this.onPointerOut)},Ts.createElement("span",{class:Ts.const("dcg-token-background")}),Ts.createElement("span",{class:()=>({"dcg-token-icon":!0,[`dcg-token-${this.getIconType()}`]:!this.getAssignment(),"dcg-token-is-list":this.getIsList()&&!this.getAssignment()})},Ts.createElement(lM,{predicate:()=>!!this.getIcon()},()=>Ts.createElement("i",{class:this.bindFn(this.getIcon)}))),Ts.createElement(lM,{predicate:()=>!!this.getAssignment()},()=>Ts.createElement(et,{latex:this.bindFn(this.getAssignment),config:this.const({})})),Ts.createElement(lM,{predicate:()=>this.hasLabel()},()=>Ts.createElement("span",{class:()=>({"dcg-token-label":!0})},()=>this.getLabel())))}getIdFromParentRef(e){if(e)return this.controller.getExpressionIdForIdentifier(e[0])}parentOrChildHovered(){var c,d,u,p,g,b;if(!this.props.showParentChildrenHover||!this.props.showParentChildrenHover())return!1;let e=this.controller.getHoveredTokenIdentifier();if(!e)return!1;let r=this.controller.getExpressionIdForIdentifier(e),i=this.props.identifier(),n=this.props.controller().getExpressionIdForIdentifier(i)||"";if(!r)return!1;let o=this.controller.getItemModel(r),s=this.controller.getItemModel(n);if(!o||o.type!=="expression"||!s||s.type!=="expression")return!1;let a=((u=(d=(c=o.formula)==null?void 0:c.geometry)==null?void 0:d.call)==null?void 0:u.parents)||[],l=((b=(g=(p=s.formula)==null?void 0:p.geometry)==null?void 0:g.call)==null?void 0:b.parents)||[];for(let x=0;x<a.length;x++)if(this.getIdFromParentRef(a[x])===n)return"parent";for(let x=0;x<l.length;x++)if(this.getIdFromParentRef(l[x])===r)return"child";return!1}willUnmount(){this.implicitMouseOut()}didUpdate(){let e=this.props.identifier();this.currentlyActiveIdentifier&&e!==this.currentlyActiveIdentifier&&this.implicitMouseOut()}implicitMouseOut(){this.currentlyActiveIdentifier&&this.controller.runAfterDispatch(()=>{let e=this.currentlyActiveIdentifier;e&&(this.currentlyActiveIdentifier=void 0,this.controller.dispatch({type:"unset-active-token",identifier:e,style:"hovered"}))})}isHidden(){var e=this.getTokenInfo();return e.overrideHidden!==void 0?e.overrideHidden:e.isHidden}getIcon(){if(this.getAssignment())return;let e=this.getTokenInfo();if(!e||e.hasError)return"dcg-icon-error";switch(e.iconType){case"point":case"glider":case"intersection":case"strictintersection":case"midpoint":return"dcg-icon-point";case"translate":return"dcg-icon-translation";case"dilate":return"dcg-icon-dilation";case"rotate":return"dcg-icon-rotation";case"reflect":return"dcg-icon-reflection";case"transformation":return"dcg-icon-title";case"angle":case"angles":case"directedangle":case"directedangles":return"dcg-icon-angle";case"polygon":return"dcg-icon-polygon-solid";default:return}}hasLabel(){return!!this.getLabel()}getLabel(){if(this.getAssignment())return"";let e=this.getTokenInfo().label.trim();return e.length<=2?e:""}getAssignment(){let e=this.props.identifier();return e[0]!=="$"?__dcg_shared_module_exports__['Hb'](e):""}getAriaLabel(){let{description:e}=this.getTokenInfo();return this.isHidden()?this.controller.s("graphing-calculator-narration-geometry-hidden-construction-description",{description:e}):e}isTransformation(){var e;return((e=this.getTokenInfo())==null?void 0:e.groupType)==="transformation"}getColor(){if(this.getAssignment())return;if(this.isTransformation())return"#aaa";let e=this.getTokenInfo();return this.isHidden()&&!e.hasError?"#aaa":e.color}getIconType(){return this.getTokenInfo().iconType}getIsList(){return this.getTokenInfo().isList}getTokenInfo(){let e=this.props.identifier();return this.controller.getTokenRenderInfoByIdentifier(e)}onPointerOver(e){e.pointerType==="mouse"&&(this.currentlyActiveIdentifier=this.props.identifier(),this.controller.dispatch({type:"set-active-token",identifier:this.currentlyActiveIdentifier,style:"hovered"}))}onPointerOut(e){e.pointerType==="mouse"&&this.currentlyActiveIdentifier&&(this.controller.dispatch({type:"unset-active-token",identifier:this.currentlyActiveIdentifier,style:"hovered"}),this.currentlyActiveIdentifier=void 0)}onTapStart(e){e.handle()}onTap(e){e.handle(),this.controller.dispatch({type:"select-expression-that-defines-token",identifier:this.props.identifier(),toggle:this.isTokenSelected(),multiSelectMode:this.controller.isMultiSelectEnabled()&&!!e.shiftKey})}isTokenSelected(){let e=this.getTokenInfo();return!!(e&&e.isSelected)}};var{If:OH}=Hs.Components,em=500,Xe=class extends Hs.Class{constructor(){super(...arguments),this.lastLatexProp="",this.wasFocusedLastUpdate=!1}init(){this.props.tokenController&&(this.tokenController=this.props.tokenController())}template(){return Hs.createElement("div",{class:Hs.const("dcg-mq-container")},Hs.createElement(OH,{predicate:()=>this.getPlaceholder().trim().length>0},()=>Hs.createElement("span",{class:Hs.const("dcg-mq-placeholder")},Hs.createElement(et,{config:()=>this.props.config(),latex:()=>this.getPlaceholder()}))),Hs.createElement("div",{class:()=>({"dcg-math-field":!0,"dcg-no-fadeout":this.props.noFadeout&&this.props.noFadeout(),"dcg-invalid":this.props.hasError(),"dcg-focus":this.props.isFocused()}),didMount:e=>this.didMountMathquill(e),"data-dcg-label":()=>this.props.dataLabelAttributeValue?this.props.dataLabelAttributeValue():void 0}))}didMount(){this.children.length===1&&this.didMountMathquill(this.findRootNode())}willUnmount(){this.$mathField.off(".view"),this.mathField=void 0}getPlaceholder(){return!this.props.placeholder||this.props.isFocused()||this.props.latex()?"":this.props.placeholder()}didMountMathquill(e){let r=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.props.config()),{handlers:{reflow:i=>{this.props.onReflow&&this.mathField&&this.props.onReflow(i)}},onCut:()=>{this.mathField&&this.props.onUserChangedLatex(this.mathField.latex())},onPaste:()=>{this.mathField&&this.props.onUserChangedLatex(this.mathField.latex())},overrideTypedText:i=>{this.mathField&&this.viewCanAcceptText(i)&&(this.props.onUserTypedText?this.props.onUserTypedText(i):(this.mathField.typedText(i),this.props.onUserChangedLatex(this.mathField.latex())))},overrideKeystroke:(i,n)=>{if(i==="Backspace"&&n.preventDefault(),!this.mathField)return;if(i==="Spacebar"&&this.props.disableSpace&&this.props.disableSpace())return n.preventDefault();let o=Te(n);if(o==="Up"||o==="Down"||o==="Left"||o==="Right"||o==="Esc"){let s=[];n.ctrlKey&&s.push("Ctrl"),n.metaKey&&s.push("Meta"),n.altKey&&s.push("Alt"),n.shiftKey&&s.push("Shift"),s.length?(s.push(o),i=s.join("-")):i=o}this.scheduleOnSelectionChange(),this.props.onUserPressedKey?this.props.onUserPressedKey(i,n):(this.mathField.keystroke(i,n),this.props.onUserChangedLatex(this.mathField.latex()))}});this.props.needsSystemKeypad&&this.props.needsSystemKeypad()&&(r.substituteTextarea=()=>I('<textarea autocorrect="off" autocapitalize="none" spellcheck="false" autocomplete="off">')[0]),this.$mathField=I(e),this.mathField=dl.MathField(e,r),e._mqMathFieldInstance=this.mathField,e._mqViewInstance=this,this.$mathField.on("focusin.view focusout.view",i=>this.onFocusEvent(i)).on("paste.view",i=>this.onPasteEvent(i)),!cv&&(kh||Qu)&&this.$mathField.on("keypress.view",i=>this.onKeypressEvent(i)),this.hookupMQTapTouch(),this.updateMathquill()}didUpdate(){this.updateMathquill()}updateMathquill(){this.updateMathquillAria(),this.updateMathquillLatex(),this.updateMathquillFocused(),this.updateMathquillPostLabel(),this.renderTokens()}onFocusEvent(e){let r=this.isFocused();r!==this.shouldBeFocused()&&this.props.onFocusedChanged(r,e)}onPasteEvent(e){let r="",i=window.clipboardData,n=e.originalEvent;i&&i.getData?r=i.getData("Text"):n&&n.clipboardData&&n.clipboardData.getData&&(r=n.clipboardData.getData("text/plain"));var o=this.viewCanAcceptText(r);return!o&&this.props.onExpressionSizeExceeded&&this.props.onExpressionSizeExceeded(),o}viewCanAcceptText(e){return Xe.canAcceptText(this.mathField,this.props.capExpressionSize(),e)}renderTokens(){if(!this.$mathField)return;var e=this.tokenController;if(!e)return;var r=this.props.latex();if(!this.lastTokenInfo||this.lastTokenInfo.latex!==r)if(!e.doesLatexContainToken(r))this.lastTokenInfo={latex:r,tokens:[]};else{let o=[];this.$mathField.find(".dcg-mq-token").each(function(s,a){o.push(a)}),this.lastTokenInfo={latex:r,tokens:o}}let i=this.lastTokenInfo.tokens;for(let o of i){var n=o.dcgTokenView;if(n)n.update();else{let s=o.getAttribute("data-dcg-mq-token")||"",a=Hs.mountToNode(td,o,{controller:this.const(e),identifier:this.const("$"+s),insideMQ:this.const(!0),insideGroup:this.const(!1),putInTabOrder:this.const(!1)});o.dcgTokenView=a}}}static canAcceptText(e,r,i){if(!e)return!1;if(!r)return!0;let n=e.latex();return Zg(n)+Zg(i)<=em}onKeypressEvent(e){if(e.stopPropagation(),e.preventDefault(),!!this.mathField){var r=e.key&&e.key.length===1?e.key:void 0;r&&this.viewCanAcceptText(r)&&(this.props.onUserTypedText?this.props.onUserTypedText(r):(this.mathField.typedText(r),this.props.onUserChangedLatex(this.mathField.latex())))}}hookupMQTapTouch(){this.$mathField.on("dcg-tap.view",e=>{let r="dcg-tapend.mathquill-selection-change";if(I(document).on(r,()=>{this.scheduleOnSelectionChange(),I(document).off(r)}),e.device!=="touch"||e.wasHandled()||!this.mathField)return;let i=e.changedTouches[0];this.mathField.clickAt(i.clientX,i.clientY,i.target),this.isFocused()||this.mathField.focus();let n;setTimeout(function(){n=Date.now()},0),this.mathField.ignoreNextMousedown(function(){return n===void 0?!0:Date.now()-n<500})})}updateMathquillAria(){if(!this.mathField)return;let e=this.props.getAriaLabel();e!==this.mathField.getAriaLabel()&&this.mathField.setAriaLabel(e)}updateMathquillPostLabel(){this.mathField&&this.mathField.setAriaPostLabel(this.props.getAriaPostLabel(),this.props.hasError()?5e3:1e3)}updateMathquillLatex(){let e=this.props.latex();this.mathField&&this.lastLatexProp!==e&&(this.props.capExpressionSize()&&Zg(e)>em||(this.lastLatexProp=e,this.mathField.latex()!==e&&this.mathField.latex(e)))}updateMathquillFocused(){if(!this.mathField)return;let e=this.isFocused(),r=this.shouldBeFocused();r&&r!==this.wasFocusedLastUpdate&&this.props.selectOnFocus&&this.props.selectOnFocus()&&this.mathField.select(),this.wasFocusedLastUpdate=r,e!==r&&(r?this.mathField.focus():this.mathField.blur())}isFocused(){return!!(document.activeElement&&I(document.activeElement).closest(this.$mathField).length)}shouldBeFocused(){return this.props.isFocused()}scheduleOnSelectionChange(){let e=this.props.onSelectionChanged;e&&(this.notifySelectionTimeout&&clearTimeout(this.notifySelectionTimeout),this.notifySelectionTimeout=setTimeout(()=>{if(clearTimeout(this.notifySelectionTimeout),!this.mathField)return;let r=this.mathField.selection();__dcg_shared_module_exports__['F'](r,this.lastSelection)||(this.lastSelection=r,e(r))},1))}static getFocusedMathquill(){if(!document.activeElement)return;let e=I(document.activeElement).closest(".dcg-mq-editable-field")[0];if(e)return e._mqMathFieldInstance}static getMQViewInstance(e){let r=e.el();if(r)return r._mqViewInstance}static applyArrowKeyAndReturnIfWasAtBounds(e,r,i){var n=e.selection();let o=n.startIndex===0&&n.endIndex===n.latex.length;if((r==="Up"||r==="Down")&&o)return e.keystroke(r,i),!0;e.keystroke(r,i);var s=e.selection(),a=s.latex!==n.latex||s.startIndex!==n.startIndex||s.endIndex!==n.endIndex;return!a}static simulateKeypress(e,r){var i=Xe.getMQViewInstance(e);i&&(i.scheduleOnSelectionChange(),i.props.onUserPressedKey?i.props.onUserPressedKey(r):(e.keystroke(r),i.props.onUserChangedLatex(e.latex())))}static simulateUserChangedLatex(e){var r=Xe.getMQViewInstance(e);r&&r.mathField&&r.props.onUserChangedLatex(r.mathField.latex())}static handleKeystrokeAndDecideIfSpecialEvent(e,r,i){return r==="Enter"||r==="Delete"&&e.latex()===""||r==="Backspace"&&e.latex()===""?!0:r==="Up"||r==="Down"||r==="Left"||r==="Right"?Xe.applyArrowKeyAndReturnIfWasAtBounds(e,r,i):(e.keystroke(r,i),!1)}};function pR(t,e){t.translate(e.left,e.top)}function _H(t,e){var r=document.createRange();r.selectNode(t);var i=r.getBoundingClientRect(),n=i.width>0&&i.height>0;if(!n)return;var o=window.getComputedStyle(t.parentElement),s=t.nodeValue||"";if(!s)return;var a=parseFloat(o.fontSize);let l=-.228*a,c=o.fontStyle+" "+o.fontWeight+" "+o.fontSize+" "+o.fontFamily;return{type:"text",rect:{left:i.left-e.pointCenterX,right:i.right-e.pointCenterY,top:i.top-e.pointCenterY,bottom:i.bottom-e.pointCenterY},text:s,color:o.color||"#000",font:c,y:i.height+l,hasOutline:e.hasOutline}}function uR(t,e,r){t.save(),t.font=e.font,r?(t.strokeStyle="#FFF",t.lineWidth=3,t.miterLimit=2,t.strokeText(e.text,0,e.y)):(t.fillStyle=e.color,t.fillText(e.text,0,e.y)),t.restore()}function gR(t,e,r){t.save(),r?(t.strokeStyle="#FFF",t.lineWidth=3):(e.fillColor&&(t.fillStyle=e.fillColor),e.strokeColor&&(t.strokeStyle=e.strokeColor)),t.beginPath();for(let i of e.instructions)switch(i.type){case"moveTo":t.moveTo(i.x,i.y);break;case"lineTo":t.lineTo(i.x,i.y);break;case"arcTo":t.arcTo(i.cx,i.cy,i.x,i.y,i.radius);break;case"ellipse":t.ellipse(i.centerX,i.centerY,i.radiusX,i.radiusY,i.rotation,i.startAngle,i.endAngle,i.anticlockwise);break}t.closePath(),r?t.stroke():(e.strokeColor&&t.stroke(),e.fillColor&&t.fill()),t.restore()}function FH(t,e){var r=t.getBoundingClientRect(),i=r.width>0&&r.height>0;if(i){var n=5,o=3,s=-n,a=r.width+n,l=-n,c=r.height+n,d=[{type:"moveTo",x:s+o,y:l},{type:"lineTo",x:a-o,y:l},{type:"arcTo",cx:a,cy:l,x:a,y:l+o,radius:o},{type:"lineTo",x:a,y:c-o},{type:"arcTo",cx:a,cy:c,x:a-o,y:c,radius:o},{type:"lineTo",x:s+o,y:c},{type:"arcTo",cx:s,cy:c,x:s,y:c-o,radius:o},{type:"lineTo",x:s,y:l+o},{type:"arcTo",cx:s,cy:l,x:s+o,y:l,radius:o}];return{type:"path",disableGlow:!0,rect:{left:r.left-e.pointCenterX,right:r.right-e.pointCenterX,top:r.top-e.pointCenterY,bottom:r.bottom-e.pointCenterY},instructions:d,strokeColor:"#C2C2C2",fillColor:"rgba(255,255,255,.75)"}}}function RH(t,e,r){var i=t.getBoundingClientRect(),n=i.width>0&&i.height>0;if(n){var o=i.width,s=parseFloat(e.borderTopWidth||"1px"),a=e.borderTopColor||"#000",l=[{type:"moveTo",x:0,y:0},{type:"lineTo",x:o,y:0},{type:"lineTo",x:o,y:s},{type:"lineTo",x:0,y:s}];return{type:"path",rect:{left:i.left-r.pointCenterX,right:i.right-r.pointCenterX,top:i.top-r.pointCenterY,bottom:i.bottom-r.pointCenterY},instructions:l,fillColor:a}}}function mR(t,e){var r=Math.sqrt(t[0]*t[0]+t[1]*t[1]),i=Math.sqrt(e[0]*e[0]+e[1]*e[1]),n=t[0]*e[0]+t[1]*e[1],o=Math.acos(n/(r*i));return t[0]*e[1]-t[1]*e[0]<0&&(o*=-1),o}function NH(t,e,r,i,n,o,s,a,l){var c=Math.cos(n),d=Math.sin(n),u=(t-a)/2,p=(e-l)/2,g=c*u+d*p,b=-d*u+c*p,x=r*r,w=i*i,E=g*g,k=b*b,S=Math.sqrt((x*w-x*k-w*E)/(x*k+w*E));o===s&&(S*=-1);var T=S*r*b/i,V=-S*i*g/r,O=(t+a)/2,y=(e+l)/2,L=c*T-d*V+O,P=d*T+c*V+y,K=[1,0],$=[(g-T)/r,(b-V)/i],U=[(-g-T)/r,(-b-V)/i],J=mR(K,$),R=mR(K,U);return{centerX:L,centerY:P,radiusX:r,radiusY:i,startAngle:J,endAngle:R,rotation:n,anticlockwise:s===0}}var fR={};function BH(t,e){var r=t+"-"+e,i=fR[r];if(i)return i;i=[],fR[r]=i;var n=e.split(" ");if(n.length!==4)return i;var o=parseFloat(n[0]),s=parseFloat(n[2]),a=parseFloat(n[1]),l=parseFloat(n[3]),c=s-o,d=l-a;function u(O){return(O-o)/c}function p(O){return(O-a)/d}var g="[0-9-.]+",b="(M"+g+" "+g+")",x="(L"+g+" "+g+")",w="(A"+g+" "+g+" "+g+" "+g+" "+g+" "+g+" "+g+")",E=new RegExp(b+"|"+x+"|"+w,"g"),k=t.match(E);if(!k||!k.length)return i;var S=NaN,T=NaN;for(let O of k){var V=O.substr(1).split(" ").map(parseFloat);switch(O[0]){case"M":S=u(V[0]),T=p(V[1]),i.push({type:"moveTo",x:S,y:T});break;case"L":S=u(V[0]),T=p(V[1]),i.push({type:"lineTo",x:S,y:T});break;case"A":let y=V[0]/c,L=V[1]/d,P=V[2],K=V[3],$=V[4],U=u(V[5]),J=p(V[6]),R=NH(S,T,y,L,P,K,$,U,J);S=U,T=J,i.push(__dcg_shared_module_exports__['b']({type:"ellipse"},R));break}}return i}function KH(t,e){var r=t.childNodes[0];if(!(!r||r.nodeName!=="path")){var i=t.getBoundingClientRect(),n=i.width>0&&i.height>0;if(n){var o=r.getAttribute("d")||"",s=t.getAttribute("viewBox")||"",a=BH(o,s),l=window.getComputedStyle(t),c=i.width,d=i.height;a=__dcg_shared_module_exports__['N'](a);for(let u of a)switch(u.type){case"moveTo":case"lineTo":u.x*=c,u.y*=d;break;case"arcTo":u.x*=c,u.y*=d,u.cx*=c,u.cy*=d,u.radius*=c;break;case"ellipse":u.centerX*=c,u.centerY*=d,u.radiusX*=c,u.radiusY*=d;break;default:return u}return{type:"path",rect:{left:i.left-e.pointCenterX,right:i.right-e.pointCenterX,top:i.top-e.pointCenterY,bottom:i.bottom-e.pointCenterY},fillColor:l.color||"#000",instructions:a}}}}function yR(t,e,r){var i=window.getComputedStyle(t);if(i.borderTopWidth!=="0px"){let a=RH(t,i,e);a&&r.push(a)}for(var n=t.childNodes,o=0;o<n.length;o++){var s=n[o];if(s.nodeType===3){let a=_H(s,e);a&&r.push(a)}else if(s.nodeName==="svg"){let a=KH(s,e);a&&r.push(a)}else s.nodeType===1&&yR(s,e,r)}}function pD(t,e){let r=[];if(e.hasBorder){let i=FH(t,e);i&&r.push(i)}return yR(t,e,r),r}function uD(t,e){Ki(e,"dcg-svg-label"),e.save(),Ei(e);for(let r of t){switch(e.save(),pR(e,r.rect),r.type){case"path":r.disableGlow||gR(e,r,!0);break;case"text":r.hasOutline&&uR(e,r,!0);break;default:return r}e.restore()}for(let r of t){switch(e.save(),pR(e,r.rect),r.type){case"path":gR(e,r,!1);break;case"text":uR(e,r,!1);break;default:return r}e.restore()}e.restore()}var{Input:UH}=yi.Components,{For:bR,Switch:qH,IfElse:HH}=yi.Components;function zH(t,e){return e?e.getPOIById(t):null}function Zp(t,e){return 1e3*(t.pixelsToMath.mapX(t.mathToPixels.mapX(e)+.5)-t.pixelsToMath.mapX(t.mathToPixels.mapX(e)-.5))}function mD(t,e){return 1e3*(t.pixelsToMath.mapY(t.mathToPixels.mapY(e)+.5)-t.pixelsToMath.mapY(t.mathToPixels.mapY(e)-.5))}function $H(t,{x:e,y:r}){let i=Zp(t,e),n=mD(t,r);return{xscale:i,yscale:n}}function WH(t,e){var r,i=!1;let n="",o="";if(t.type==="poi"){let u=t.poi,{xscale:p,yscale:g}=$H(e,u);r=u.getLabel();let b=u.getGraphMode(),x;var s=u.type===1007&&u.getCompiledFunction();if(s){var a=b===1,l=a?u.y:u.x;if(x=__dcg_shared_module_exports__['Cb'](l,p,g,s),a){var c=x[0];x[0]=x[1],x[1]=c}}else x=[__dcg_shared_module_exports__['Bb'](u.x,p),__dcg_shared_module_exports__['Bb'](u.y,g)];i=!isFinite(x[1].value),n=x[0].superscript?x[0].mantissa+"^{"+x[0].superscript+"}":x[0].string,o=x[1].superscript?x[1].mantissa+"^{"+x[1].superscript+"}":x[1].string,n==="undefined"&&(n="\\mathrm{undefined}"),o==="undefined"&&(o="\\mathrm{undefined}")}else r=t.text;var d=r&&__dcg_shared_module_exports__['Zc'](r);return r?d==="latex"?{is_hole:i,type:"latex",text:r.substr(1,r.length-2)}:d==="text"?{is_hole:i,type:"text",text:r}:{is_hole:i,type:"mixed",text:r}:t.type==="poi"?t.poi.hasEditableLabel()?{is_hole:i,type:"text",text:""}:{is_hole:i,type:"latex",text:"\\left("+n+",\\space "+o+"\\right)"}:{is_hole:i,type:"text",text:"?"}}function wR(t,e,r){let i=t.s("graphing-calculator-label-poi-unknown"),n=e.getProjection();return!n||!n.viewport||r&&(i=eu(t,r.x,r.y)),i}var tm=class extends yi.Class{constructor(){super(...arguments),this.labelsDirty=!1}init(){this.grapher=this.props.grapher(),this.controller=this.grapher.controller,this.cachedLabelDict={},this.cachedLabelOrder=[],this.hoveredPOI=void 0,this.openedPOI2Sketch={},this.takingScreenshot=!1}template(){return yi.createElement(bR,{each:()=>this.cachedLabelOrder},yi.createElement("div",{class:yi.const("dcg-graph-outer"),style:this.const({"z-index":0}),didMount:this.bindFn(this.didMountRoot)},e=>yi.createElement("div",{class:()=>this.getLabelClasses(e),style:()=>this.getLabelStyles(e),didMount:r=>this.linkLabelContainerNode(e,r)},yi.createElement("div",{class:yi.const("dcg-pt"),style:()=>this.getDotStyles(e)}),yi.createElement("div",{class:yi.const("dcg-label"),didMount:r=>this.linkLabelDOMNode(e,r)},this.renderLabelContent(e)))))}renderLabelContent(e){return yi.createElement(qH,{key:()=>this.getLabelContent(e).type},r=>r==="text"?yi.createElement("span",{class:yi.const("dcg-label-raw-text")},()=>this.getLabelContent(e).text):r==="latex"?yi.createElement(et,{latex:()=>this.getLabelContent(e).text,config:this.bindFn(this.getMQConfig)}):r==="mixed"?yi.createElement(bR,{each:()=>__dcg_shared_module_exports__['_c'](this.getLabelContent(e).text),key:(i,n)=>`${i}${n}`},yi.createElement("span",null,i=>HH(()=>__dcg_shared_module_exports__['Zc'](i)==="latex",{true:()=>yi.createElement(et,{latex:()=>i.substr(1,i.length-2),config:this.bindFn(this.getMQConfig)}),false:()=>yi.createElement("span",{class:yi.const("dcg-label-raw-text")},()=>i)}))):r==="MATH"?yi.createElement("div",{class:()=>({"dcg-editable-label-border":!0,"dcg-do-not-blur":!0,"dcg-focus":this.shouldEditableLabelBeFocused(e),"dcg-empty-label":this.getEditableLabelText(e).trim().length===0}),style:()=>({"border-color":__dcg_shared_module_exports__['R'](this.getEditableLabelTextColor(e),.3)})},yi.createElement(Xe,{latex:()=>this.getEditableLabelText(e),placeholder:()=>"",isFocused:()=>this.shouldEditableLabelBeFocused(e),capExpressionSize:()=>!!this.controller.getGraphSettings().config.capExpressionSize,selectOnFocus:yi.const(!1),config:this.bindFn(this.getMQConfig),getAriaLabel:()=>this.controller.s("graphing-calculator-narration-editable-point-label-at-coordinates",{coordinates:wR(this.controller,this.grapher,this.cachedLabelDict[e])}),getAriaPostLabel:this.const(""),onUserChangedLatex:i=>this.onLabelInput(i,e),onExpressionSizeExceeded:()=>this.controller.dispatch({type:"expression-size-exceeded"}),onFocusedChanged:i=>this.onEditableLabelFocusChange(i,e),hasError:this.const(!1),noFadeout:this.const(!0),needsSystemKeypad:()=>!this.controller.isKeypadEnabled()})):yi.createElement("div",{class:()=>({"dcg-resizing-text-input-container":!0,"dcg-editable-label-border":!0,"dcg-focus":this.shouldEditableLabelBeFocused(e),"dcg-empty-label":this.getEditableLabelText(e).trim().length===0}),style:()=>({"border-color":__dcg_shared_module_exports__['R'](this.getEditableLabelTextColor(e),.3)}),onScroll:i=>{i.target&&(i.target.scrollLeft=0)}},yi.createElement(UH,{"aria-label":()=>this.controller.s("graphing-calculator-narration-editable-point-label-at-coordinates",{coordinates:wR(this.controller,this.grapher,this.cachedLabelDict[e])}),onInput:i=>this.onLabelInput(i,e),value:()=>this.getEditableLabelText(e),onFocus:()=>this.onEditableLabelFocusChange(!0,e),onBlur:()=>this.onEditableLabelFocusChange(!1,e)}),yi.createElement("span",{class:yi.const("dcg-text-input-content")},()=>this.getEditableLabelText(e)||" ")))}getSketchIdFromLabelId(e){var r=this.cachedLabelDict[e];if(r)return r.sketchId}getEditableLabelTextColor(e){let r=this.getSketchIdFromLabelId(e);if(!r)return"#000";let i=this.controller.getItemModel(r);return!i||i.type!=="expression"?"#000":Zl(i)}onEditableLabelFocusChange(e,r){let i=this.getSketchIdFromLabelId(r);i&&(e?this.controller.dispatch({type:"set-focus-location",location:{type:"editable-label",id:i}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"editable-label",id:i}}),this.update())}shouldEditableLabelBeFocused(e){let r=this.getSketchIdFromLabelId(e),i=this.controller.getFocusLocation();return!(!i||i.type!=="editable-label"||!r||i.id!==r)}onLabelInput(e,r){let i=this.getSketchIdFromLabelId(r);if(!i)return;let n=this.controller.getItemModel(i);if(!n||n.type!=="expression")return;let o=e;this.controller.getItemEditableLabelMode(i)==="MATH"&&o.length>0&&(o="`"+o+"`"),this.controller.dispatch({type:"set-item-label",id:i,label:o})}getEditableLabelText(e){let r=this.getSketchIdFromLabelId(e);if(!r)return"";let i=this.controller.getItemModel(r);return!i||i.type!=="expression"?"":this.controller.getItemEditableLabelMode(r)==="MATH"?i.label.substr(1,i.label.length-2):i.label}linkLabelDOMNode(e,r){var i=this.cachedLabelDict[e];i&&(i.labelDOM=r)}linkLabelContainerNode(e,r){var i=this.cachedLabelDict[e];i&&(i.containerDOM=r)}getLabelClasses(e){var r=this.cachedLabelDict[e];return r?r.classes:{}}getLabelStyles(e){var r=this.cachedLabelDict[e];return r?r.styles:{}}getDotStyles(e){var r=this.cachedLabelDict[e];return r?r.dotStyles:{}}getLabelContent(e){var r=this.cachedLabelDict[e];if(r){let i=this.getSketchIdFromLabelId(e);if(!i)return{is_hole:!1,type:"text",text:""};let n=this.controller.getItemEditableLabelMode(i);return r.classes["dcg-editable-label"]&&n!==void 0&&n!=="NONE"?{is_hole:!1,type:n,text:""}:r.content}return{is_hole:!1,type:"text",text:""}}didMountRoot(e){this.node=e}computeHoveredLabel(e,r){var i;this.hoveredPOI?this.isOpenPOI(this.hoveredPOI)?this.grapher.setLayerClass("hoveredPOI","dcg-mouse-over-opened-poi"):(i=this.computeLabel({poi:this.hoveredPOI,type:"poi"},e,r,"hovered"),this.grapher.setLayerClass("hoveredPOI","dcg-mouse-over-closed-poi")):this.grapher.setLayerClass("hoveredPOI",void 0);var n=this.getHoveredInteractiveLabel();n&&!n.bareLabel?this.grapher.setLayerClass("interactiveLabel","dcg-mouse-over-opened-poi"):this.grapher.setLayerClass("interactiveLabel",void 0),i&&this.saveLabelToCache(i)}computeTraceLabel(e,r){if(this.traceInfo){var i=this.traceInfo.pt;if(i){var n=new zd(i.x,i.y,1007,this.traceInfo.branchInfo.sketch,this.traceInfo.branchInfo.branch,0),o=this.computeLabel({poi:n,type:"poi"},e,r,"trace");o&&this.saveLabelToCache(o)}}}computeLabel(e,r,i,n){var o=e.type==="poi"?e.poi.id+"":e.id;n==="trace"&&(o="*trace*");var s=e.poi,a=r.mapx(s.x),l=r.mapy(s.y),c=a,d=l;if(e.type!=="poi"&&(a=0,l=0),r.coordsAreOnscreen(a,l,20)){if(this.isHiddenInteractiveLabel(s))return;var u=!1,p=void 0,g=s.sketch,b=g&&g.branches[0];b&&(u=!!("nakedLabel"in b&&b.nakedLabel),p="labelOrientation"in b?b.labelOrientation:void 0);var x=g.id,w=this.controller.getItemModel(x);if(s.hasEditableLabel()&&w&&w.type==="expression"&&!Ks(w))return;var E=WH(e,r),k=s.pointIdxOnBranch,S=s.getLabelSize();Array.isArray(S)&&(S=S[k]);var T=s.getLabelRotation();Array.isArray(T)&&(T=T[k]);var V=s.getPointOpacity()*this.controller.getGeoModel().getToolFadeOpacity(x),O=!!s.getTextOutline(),y=s.isPersistent(),L=s.isAttachedToPlottedPoint(),P=s.hasInteractiveLabel(),K=s.hasEditableLabel()&&!this.takingScreenshot,$=!!(w&&w.type==="expression"&&Uc(w)),U=g.color;if($){if(this.grapher.clickableObjectsLayer.shouldDrawPressed(x,s.pointIdxOnBranch)){var J=__dcg_shared_module_exports__['ha'](U);J.l>.2?J.l-=.2:J.l+=.1,U=J.toString()}else if(this.grapher.clickableObjectsLayer.shouldDrawHovered(x,s.pointIdxOnBranch)){var J=__dcg_shared_module_exports__['ha'](U);J.l>.2?J.l-=.1:J.l+=.2,U=J.toString()}}var R=!y,q=!!L;P&&(q=!0,R=!0),n==="trace"&&(q=!1,R=!0);var _=i[o],A=_&&_.labelDOM,z=_&&_.containerDOM,Q=_&&_.width,fe=_&&_.height,ie=_&&_.orientation,Le={"dcg-poi-label":!0,"dcg-tracept":n==="trace","dcg-opened":n==="opened","dcg-hole":E.is_hole,"dcg-show-border":R,"dcg-hide-dot":q,"dcg-editable-label":K,"dcg-has-outline":O,"dcg-underlined-label":!!($&&w&&w.type==="expression"&&w.hidden)};isFinite(S)||(S=1);var pe=Math.round(S*1100)/10,ae={left:a+"px",top:l+"px","font-size":pe+"%"};T&&!this.takingScreenshot&&(ae.transform=`rotate(${T}rad)`),y&&U&&(ae.color=U),ae.opacity=`${Math.min(.99,V)}`;var ye={};return n==="trace"&&(ye["background-color"]=U,ye["border-color"]=U),{id:o,sketchId:x,poi:s,x:s.x,y:s.y,screenX:a,screenY:l,top:d,left:c,width:Q,height:fe,labelDOM:A,containerDOM:z,forcedOrientation:p,isNakedLabel:u,isClickable:$,orientation:ie,rotation:T,classes:Le,styles:ae,dotStyles:ye,content:E,hasBorder:s.hasEditableLabel(),opacity:V,hasOutline:O||s.hasEditableLabel(),objectSpec:e.type!=="poi"?e.type==="angle"?{type:e.type,segments:[r.mapx(e.segments[0]),r.mapy(e.segments[1]),e.segments[2],e.segments[3]]}:{type:e.type,segments:r.map_xy_pairs(e.segments)}:void 0}}}computeAllLabels(e,r){var i={},n,o,s=this.grapher.graphSketches;this.grapher.getSketchOrder().forEach(c=>{var d=s[c];if(d){var u=d.labels;if(u.length)for(var p=0;p<u.length;p++){let g=u[p],b=this.computeLabel(g,e,r,"opened");b&&(Array.isArray(d.color)&&(b.styles.color=d.color[p]),this.saveLabelToCache(b))}}});var a={};for(n in this.openedPOI2Sketch){var l=zH(n,s[this.openedPOI2Sketch[n]]);l&&(a[n]=l.sketch.id,o=this.computeLabel({poi:l,type:"poi"},e,r,"opened"),o&&this.saveLabelToCache(o))}return this.openedPOI2Sketch=a,i}saveLabelToCache(e){var r=e.id;this.cachedLabelDict[r]||this.cachedLabelOrder.push(r),this.cachedLabelDict[r]=e}markLabelsDirty(){this.labelsDirty=!0}getInteractiveLabelUnderPoint(e){let r;for(var i=this.cachedLabelOrder.length-1;i>=0;i--){let n=this.cachedLabelOrder[i],o=this.cachedLabelDict[n];if(!o||!o.width||!o.height)continue;let s=o.screenX,a=o.screenY,{left:l,top:c,width:d,height:u}=o;if(d>0&&u>0&&e.x>s+l&&e.x<s+l+d&&e.y>a+c&&e.y<a+c+u){let p=this.getSketchIdFromLabelId(n);if(p===void 0)continue;let g=this.controller.getItemModel(p);if(!g||g.type!=="expression")continue;if(fg(g))return{type:"editable",model:g};!r&&oO(g)?r={type:"draggable",label:{model:g,x:o.x,y:o.y}}:!r&&o.isClickable&&(r={type:"clickable",model:g,poi:o.poi})}}return r}positionLabels(e,r,i,n,o){var s=!this.labelsDirty;this.labelsDirty=!1;var a=[];r.forEach(u=>{var p=i[u];if(!p||!p.labelDOM)return;let g,b=this.getSketchIdFromLabelId(u);if(b!==void 0){let O=this.grapher.getGraphSketch(b);O&&O.branches&&(g=O.branches[0].pointSize)}(g===void 0||typeof g!="number"||g<0)&&(g=9);let w=(this.grapher.settings.config.projectorMode?14:10)*g/9;var E=p.screenX,k=p.screenY,S=p.labelDOM.clientWidth,T=p.labelDOM.clientHeight;if(!(S>0&&T>0))return;let V=0;this.takingScreenshot&&p.hasBorder&&(V=5),a.push({renderedLabel:p,pt_x:E,pt_y:k,pt_radius:w+V,rotation:p.rotation,nakedLabel:p.isNakedLabel,width:S,height:T,keepOrientation:s,priorOrientation:p.orientation,enforceOrientation:p.forcedOrientation})});var l=aR(e,n,o),c=a.map(function(u){if(u.renderedLabel.objectSpec){if(u.renderedLabel.objectSpec.type==="segment")return cR(l,{pt_x1:u.renderedLabel.objectSpec.segments[0],pt_y1:u.renderedLabel.objectSpec.segments[1],pt_x2:u.renderedLabel.objectSpec.segments[2],pt_y2:u.renderedLabel.objectSpec.segments[3],pt_radius:10,width:u.width,height:u.height,keepOrientation:u.keepOrientation,priorOrientation:u.priorOrientation||""});if(u.renderedLabel.objectSpec.type==="polygon")return hR(l,{path:u.renderedLabel.objectSpec.segments,pt_radius:10,width:u.width,height:u.height,keepOrientation:u.keepOrientation,priorOrientation:u.priorOrientation||""});if(u.renderedLabel.objectSpec.type==="angle"){let p=u.renderedLabel.objectSpec.segments;return dR(l,{pt_x:p[0],pt_y:p[1],startAngle:p[2],deltaAngle:p[3],isRightAngle:!1,radius:20,pt_radius:10,width:u.width,height:u.height,keepOrientation:u.keepOrientation,priorOrientation:u.priorOrientation||""})}}else return lR(l,u);return[]}),d=oR(c);d.forEach(function(u,p){var g=a[p].renderedLabel;g.orientation=u.orientation;let b=u.left-u.pt_x,x=u.top-u.pt_y;g.left=b,g.top=x,g.width=u.width,g.height=u.height;var w=g.labelDOM;if(w){w.style.transform=u.transform,I(w).data("orientation",u.orientation);var E=g.containerDOM;E&&(E.style.left=u.pt_x+"px",E.style.top=u.pt_y+"px"),setTimeout(()=>w.classList.add("dcg-enable-transition"),1)}})}copyToCtx(e){gs(e,"labels");var r=this.node.getBoundingClientRect();this.cachedLabelOrder.forEach(i=>{var n=this.cachedLabelDict[i];if(!n)return;var o=n.labelDOM;if(!o)return;let s={pointCenterX:n.screenX,pointCenterY:n.screenY,hasOutline:!!n.hasOutline,hasBorder:!!n.hasBorder};var a=this.computeRotatedCenter(s.pointCenterX,s.pointCenterY,n.rotation);let l=pD(o,s);e.save(),e.globalAlpha=n.opacity,e.rotate(n.rotation),e.translate(a.x-r.left,a.y-r.top),uD(l,e),e.restore()}),ms(e)}computeRotatedCenter(e,r,i){var n=Math.cos(-i),o=Math.sin(-i),s=e*n-r*o,a=r*n+e*o;return{x:s,y:a}}drawForScreenshot(e,r,i,n,o){this.takingScreenshot=!0,this.redraw(e,r,n,o),this.takingScreenshot=!1,this.copyToCtx(i)}redraw(e,r,i,n){var o=this.cachedLabelDict;this.cachedLabelDict={},this.cachedLabelOrder=[],this.computeAllLabels(e,o),this.computeHoveredLabel(e,o),this.computeTraceLabel(e,o),this.update(),this.positionLabels(r,this.cachedLabelOrder,this.cachedLabelDict,i,n)}clearOpenedPOI(){this.openedPOI2Sketch={}}closePOI(e){delete this.openedPOI2Sketch[e.id]}openPOI(e){this.openedPOI2Sketch[e.id]=e.sketch.id}isOpenPOI(e){return this.openedPOI2Sketch.hasOwnProperty(e.id)}isOpenInteractiveLabel(e){return this.isOpenPOI(e)?e.hasInteractiveLabel():!1}isHiddenInteractiveLabel(e){return!e||!e.hasInteractiveLabel()?!1:!this.isOpenPOI(e)&&this.getHoveredPOI()!==e}setHoveredPOI(e){this.hoveredPOI=e}getHoveredPOI(){return this.hoveredPOI}getHoveredInteractiveLabel(){var e=this.getHoveredPOI();if(e&&e.hasInteractiveLabel())return e}setTraceInfo(e){this.traceInfo=e}isTracing(){return!!this.traceInfo}getTraceInfo(){return this.traceInfo}getMQConfig(){return this.controller.getMathquillConfig({})}};var{For:jH}=ic.Components;function fD(t,e){let r=t[e];return Array.isArray(r)&&t.tableInfo?r[t.tableInfo.rowIndex]:r}var $y=class extends ic.Class{init(){this.grapher=this.props.grapher(),this.renderedPointsIdOrder=[],this.renderedPoints={}}template(){return ic.createElement(jH,{each:()=>this.renderedPointsIdOrder},ic.createElement("div",{class:ic.const("dcg-graph-outer"),style:this.const({"z-index":0}),onFocusin:()=>this.requestRedrawNextFrame(),onFocusout:()=>this.requestRedrawNextFrame(),didMount:this.bindFn(this.didMountRoot)},e=>ic.createElement("div",{class:this.const({"dcg-tabbable-point":!0,"dcg-movable-point":this.renderedPoints[e].type==="movable"}),style:()=>({transform:this.getTransform(e)}),role:ic.const("button"),"aria-roledescription":()=>this.renderedPoints[e].type==="movable"?this.grapher.controller.s("graphing-calculator-narration-movable-point-description"):this.renderedPoints[e].type==="draggable-label"?this.grapher.controller.s("graphing-calculator-narration-draggable-label-description"):this.grapher.controller.s("graphing-calculator-narration-point-description"),"dcg-mp-id":this.const(e),tabindex:()=>this.getTabIndex(e),"aria-label":()=>this.getAriaLabel(e),"aria-hidden":this.bindFn(this.getAriaHidden)})))}redraw(e,r,i){var n=this.grapher.graphSketches,o=this.renderedPoints;this.renderedPoints={},this.renderedPointsIdOrder=[];var s=this.getFocusedPointId(),a=x=>{var w=this.processPOI(e,r,x,o[x.id],i,s);w&&(this.renderedPoints[x.id]=w,this.renderedPointsIdOrder.push(x.id))};this.grapher.getSketchOrder().forEach(x=>{var w=n[x];w&&(w.getMovablePoints().forEach(a),w.getStaticLabeledPoints().forEach(a))});var l=this.renderedPoints[this.hoveredPointId],c=this.renderedPoints[this.pressedPointId],d=l&&l.poi,u=c&&c.poi;d||this.setHoveredPointId(void 0),u||this.setPressedPointId(void 0);var p=u||d,g,b;p?(g=p.type==="movable-point"&&p.tableInfo&&p.tableInfo.dragX,b=p.type==="movable-point"&&p.tableInfo&&p.tableInfo.dragY,g&&b||!g&&!b?this.grapher.setLayerClass("movablePoints","dcg-mouse-over-movable-point"):g?this.grapher.setLayerClass("movablePoints","dcg-mouse-over-movable-point-ew"):this.grapher.setLayerClass("movablePoints","dcg-mouse-over-movable-point-ns")):this.grapher.setLayerClass("movablePoints",void 0),this.update(),this.speakAriaAlert()}_clampedOpacity(e){return e<0?0:e>1?1:__dcg_shared_module_exports__['K'](e)?e:1}drawForScreenshot(e,r,i,n){var o=this.grapher.graphSketches;for(let c in o){var s=o[c],a=s.branches[0],l;a.graphMode===4&&(l=a.pointOpacity),s.getMovablePoints().forEach(d=>{var u={screenX:r.mapx(d.x),screenY:r.mapy(d.y),color:d.color,pointOpacity:l,animationPercent:0};this.drawMovablePointOnCtx(e,d.sketch,u,i,n)})}}processPOI(e,r,i,n,o,s){var a=i.id,l=i.x,c=i.y,d=r.mapx(l),u=r.mapy(c),p=s===a,g=r.coordsAreOnscreen(d,u,20);if(!(!g&&!p)){if(!n){var b=i.sketch?this.grapher.controller.getItemModel(i.sketch.id):void 0;i.type==="movable-point"?n={type:"movable",id:a,pointOnScreen:g,poi:i,projection:r,screenX,screenY,color:fD(i,"color"),pointOpacity:fD(i,"pointOpacity"),pointIsHovered:!1,pointIsPressed:!1,lastHoverActionTime:0,animationPercent:0}:b&&b.type==="expression"&&b.label!==void 0&&b.showLabel&&b.reconciledDragMode!=="NONE"?n={type:"draggable-label",id:a,pointOnScreen:g,poi:i,projection:r,screenX,screenY}:n={type:"static",id:a,pointOnScreen:g,poi:i,projection:r,screenX,screenY}}return n.pointOnScreen=g,n.poi=i,n.projection=r,n.screenX=d,n.screenY=u,n.type==="movable"&&(n.color=fD(n.poi,"color"),n.pointOpacity=fD(n.poi,"pointOpacity"),this.updateMovablePointAnimation(n),this.drawMovablePointOnCtx(e,n.poi.sketch,n,o)),n}}drawMovablePointOnCtx(e,r,i,n,o){var g;var s;o?s=o:s=this.grapher.settings.config.projectorMode?13.5:10.5,r.tokenSelected?s*=2:r.tokenHovered?s*=1.5:r.showHighlight&&(s*=1.2);var a=Array.isArray(i.color)?i.color[0]:i.color,l=i.screenX,c=i.screenY,d=i.animationPercent||0;n.push({left:l-s,right:l+s,top:c-s,bottom:c+s}),e.save();var u=e.globalAlpha,p=this._clampedOpacity(i.pointOpacity);p*=(g=this.grapher.controller.getGeoModel().getToolFadeOpacity(r.id))!=null?g:1,e.fillStyle=a,e.globalAlpha=.35*p,e.beginPath(),e.moveTo(l+s,c),e.arc(l,c,s,0,Math.PI*2,!0),e.closePath(),e.fill(),e.globalAlpha=p,s*=.3+.7*d,e.beginPath(),e.moveTo(l+s,c),e.arc(l,c,s,0,Math.PI*2,!0),e.closePath(),e.fill(),e.globalAlpha=u,e.restore()}updateMovablePointAnimation(e){var r=Date.now(),i=e.id,n=this.hoveredPointId===i,o=this.pressedPointId===i;e.pointIsPressed=o,n!==e.pointIsHovered&&(e.pointIsHovered=n,e.lastHoverActionTime=r);var s=e.animationPercent||0,a=r-e.lastHoverActionTime,l=.004*a;o?s=1:n?(s+=l,s>=1?s=1:this.requestRedrawNextFrame()):(s-=l,s<=0?s=0:this.requestRedrawNextFrame()),e.animationPercent=s}getTransform(e){var r=this.renderedPoints[e];if(r)return AL(r.screenX,r.screenY)}getTabIndex(e){if(this.grapher.controller.getActiveTool()!=="selection")return-1;let r=this.renderedPoints[e];if(!r)return-1;let i=r.poi,n=this.grapher.controller.getItemEditableLabelMode(i.sketch.id),o=this.grapher.controller.getItemModel(i.sketch.id),s=o&&o.type==="expression"&&!Uc(o)&&(r.type==="movable"||n===void 0||n==="NONE");var a=this.grapher.settings;let l=a.config.graphpaper&&a.config.enableTabindex;return s&&l?0:-1}getAriaHidden(){var e=this.grapher.settings;return!e.config.graphpaper}getAriaLabel(e){var r=this.getAriaAlert({id:e,includeUsageInstructions:!1});return r&&r.completeMessage}speakAriaAlert(){let e=this.getFocusedPointId();if(e){let i=this.renderedPoints[e];if(!i||i.type==="static")return}var r=this.getAriaAlert({id:e,lastAriaAlert:this.lastAriaAlert,includeUsageInstructions:!0});this.lastAriaAlert=r,r&&r.completeMessage&&me(r.completeMessage)}getAriaAlert(e){let{id:r,lastAriaAlert:i,includeUsageInstructions:n}=e;if(!r)return;var o=this.renderedPoints[r];if(!o)return;i&&i.id!==r&&(i=void 0);var s=o.poi,a=o.pointOnScreen,l=o.projection;if(!s||!l)return;var c=l.viewport;if(!c)return;var d=i&&i.label,u=s.ariaLabel,p=d!==u,g=i&&i.coordX,b=i&&i.coordY,x=s.x,w=s.y,E=x!==g||w!==b,k=eu(this.grapher.controller,x,w);let{controller:S}=this.grapher;var T=u||S.s("graphing-calculator-narration-movable-point-prefix"),V=(o.type==="movable"||o.type==="draggable-label")&&n?S.s("graphing-calculator-narration-movable-point-suffix-usage-instructions"):"",O=a?"":S.s("graphing-calculator-narration-movable-point-off-screen-prompt"),y;return i?p?y=T+O:E?y=k+O:y="":y=T+". "+k+V+O,{id:r,coordX:x,coordY:w,label:u,completeMessage:y}}setHoveredPointId(e){e!==this.hoveredPointId&&(this.hoveredPointId=e,this.requestRedrawNextFrame())}isMovingPoint(){return!!this.pressedPointId}setPressedPointId(e){e!==this.pressedPointId&&(this.pressedPointId=e,this.requestRedrawNextFrame())}getFocusedPointId(){if(document.activeElement&&I.contains(this.rootNode,document.activeElement)){var e=I(document.activeElement);return e.attr("dcg-mp-id")}}getFocusedPoint(){var e=this.getFocusedPointId();if(e){var r=this.renderedPoints[e];if(r){var i=r.poi;return i}}}didMountRoot(e){this.rootNode=e}requestRedrawNextFrame(){this.grapher.redrawAllLayers()}};function eu(t,e,r){return Xi(t,e)+" "+Qi(t,r)}function Xi(t,e){var o;let r=t.getGraphSettings().showXAxis,i=(o=t.getGrapher())==null?void 0:o.getProjection();if(!i)return"";let{width:n}=i.screen;return r?t.s("graphing-calculator-narration-audio-trace-property-x",{x:fs(__dcg_shared_module_exports__['Bb'](e,Zp(i,e)).latex)}):t.s("graphing-calculator-narration-x-percentage-coordinate",{x:Math.round(i.mathToPixels.mapX(e)/n*1e3)/10})}function Qi(t,e){var o;let r=t.getGraphSettings().showYAxis,i=(o=t.getGrapher())==null?void 0:o.getProjection();if(!i)return"";let{height:n}=i.screen;return r?t.s("graphing-calculator-narration-audio-trace-property-y",{y:fs(__dcg_shared_module_exports__['Bb'](e,Zp(i,e)).latex)}):t.s("graphing-calculator-narration-y-percentage-coordinate",{y:Math.round(i.mathToPixels.mapY(e)/n*1e3)/10})}var JH=Math.hypot&&Math.hypot(1/0,NaN)===1/0;function xR(t){return t===1/0||t===-1/0}var tu=JH?Math.hypot:function(t,e){if(xR(t)||xR(e))return 1/0;if(isNaN(t)||isNaN(e))return NaN;if(t===0&&e===0)return 0;if(Math.abs(t)>Math.abs(e)){let r=e/t;return Math.abs(t)*Math.sqrt(r*r+1)}else{let r=t/e;return Math.abs(e)*Math.sqrt(r*r+1)}};function rm(t){let e=[[t.x0,t.y0],[t.x1,t.y1],[t.x2,t.y2]],[r,i]=__dcg_shared_module_exports__['ra'](e),n=__dcg_shared_module_exports__['X'](t.x0-r,t.y0-i);return{x:r,y:i,radius:n}}function yD(t){let e=[[t.x0,t.y0],[t.x1,t.y1],[t.x2,t.y2]],[r,i]=__dcg_shared_module_exports__['ra'](e);return{startAngle:Math.atan2(t.y0-i,t.x0-r),deltaAngle:__dcg_shared_module_exports__['sa'](e)}}var vR=(t,e)=>({x:t.x-e.x,y:t.y-e.y}),YH=(t,e)=>t.x*e.x+t.y*e.y;function wD(t,e){return tu(t.x-e.x,t.y-e.y)}function CR(t,e){let r={x:t.x1,y:t.y1},i={x:t.x2,y:t.y2},n=vR(e,r),o=vR(i,r),s=wD(r,i),a=s*s;return YH(n,o)/a}function hM(t){return[{x1:t.left,y1:t.top,x2:t.left,y2:t.bottom,extendStart:!1,extendEnd:!1},{x1:t.left,y1:t.top,x2:t.right,y2:t.top,extendStart:!1,extendEnd:!1},{x1:t.right,y1:t.top,x2:t.right,y2:t.bottom,extendStart:!1,extendEnd:!1},{x1:t.left,y1:t.bottom,x2:t.right,y2:t.bottom,extendStart:!1,extendEnd:!1}]}function XH(t){let{angle:e,width:r,height:i,center:n}=t,o=n.x,s=n.y,a=Math.cos(-e),l=Math.sin(-e),c=r/2,d=i/2,u={x:o+a*-c-l*-d,y:s+l*-c+a*-d},p={x:o+a*c-l*-d,y:s+l*c+a*-d},g={x:o+a*c-l*d,y:s+l*c+a*d},b={x:o+a*-c-l*d,y:s+l*-c+a*d};return[{x1:u.x,y1:u.y,x2:p.x,y2:p.y,extendStart:!1,extendEnd:!1},{x1:p.x,y1:p.y,x2:g.x,y2:g.y,extendStart:!1,extendEnd:!1},{x1:g.x,y1:g.y,x2:b.x,y2:b.y,extendStart:!1,extendEnd:!1},{x1:b.x,y1:b.y,x2:u.x,y2:u.y,extendStart:!1,extendEnd:!1}]}function QH(t,e){let r=hM(t);return!!(xD(e,r[0])||xD(e,r[1])||xD(e,r[2])||xD(e,r[3]))}function ZH(t,e){let r=hM(t);return!!(rd(e,r[0],!1)||rd(e,r[1],!1)||rd(e,r[2],!1)||rd(e,r[3],!1)||rd(e,r[0],!0)||rd(e,r[1],!0)||rd(e,r[2],!0)||rd(e,r[3],!0))}function e6(t,e){let r=hM(t);return!!(Qh(e,r[0],!1)||Qh(e,r[1],!1)||Qh(e,r[2],!1)||Qh(e,r[3],!1)||Qh(e,r[0],!0)||Qh(e,r[1],!0)||Qh(e,r[2],!0)||Qh(e,r[3],!0))}function t6(t,e){return t.left<=e.left&&t.right>=e.right&&t.top<=e.top&&t.bottom>=e.bottom}function r6(t,e){return t.left<=e.x&&e.x<=t.right&&t.top<=e.y&&e.y<=t.bottom}function vD(t,e){if(!e.extendStart){let r=t.left<=e.x1&&e.x1<=t.right,i=t.top<=e.y1&&e.y1<=t.bottom;if(r&&i)return!0}return QH(t,e)}function VR(t,e){let r={x:e.x0,y:e.y0};return!!(r6(t,r)||e6(t,e))}function IR(t,e){let r={left:e.x-e.radius,right:e.x+e.radius,top:e.y-e.radius,bottom:e.y+e.radius};return!!(t6(t,r)||ZH(t,e))}function i6(t,e){let r=t.x-e.center.x,i=t.y-e.center.y,n=Math.atan2(i,r),o=tu(r,i),s={x:o*Math.cos(n+e.angle),y:o*Math.sin(n+e.angle)};return Math.abs(s.x)<=e.width/2&&Math.abs(s.y)<=e.height/2}function MR(t,e){if(e.length<4)return!1;let r={x1:NaN,y1:NaN,x2:e[0],y2:e[1],extendStart:!1,extendEnd:!1};for(var i=2;i<e.length;i+=2)if(r.x1=r.x2,r.y1=r.y2,r.x2=e[i],r.y2=e[i+1],vD(t,r))return!0;return!1}function TR(t,e){var r=XH(e);for(let i of r)if(vD(t,i))return!0;return!!i6({x:t.left,y:t.top},e)}function n6(t,e,r){let i=e.x1-t.x,n=e.x2-t.x,o=e.y1-t.y,s=e.y2-t.y,a=t.radius,l=n-i,c=s-o,d=l*l+c*c,u=i*s-n*o,p=Math.sqrt(a*a*d-u*u);if(p<0)return;if(c>=0)var g=1;else var g=-1;let b=r?-1*g:1*g;return{x:t.x+(u*c+b*g*l*p)/d,y:t.y+(-u*l+b*Math.abs(c)*p)/d}}function o6(t,e){let r=t.y2-t.y1,i=t.x1-t.x2,n=e.y2-e.y1,o=e.x1-e.x2,s=r*t.x1+i*t.y1,a=n*e.x1+o*e.y1,l=r*o-n*i;if(l!==0)return{x:(o*s-i*a)/l,y:(r*a-n*s)/l}}function dM(t,e){let r=CR(e,t);return!(isNaN(r)||r<0&&!e.extendStart||r>1&&!e.extendEnd)}function s6(t,e){let{x:r,y:i}=rm(e),{startAngle:n,deltaAngle:o}=yD(e),s=Math.atan2(t.y-i,t.x-r);return __dcg_shared_module_exports__['Z'](s,n,o)}function rd(t,e,r){let i=n6(t,e,r);if(i!=null&&dM(i,e))return i}function Qh(t,e,r){let i=rd(rm(t),e,!1)||SR,n=ER(r,kR(t,i),GR(e));if(n||(i=rd(rm(t),e,!0)||SR,n=ER(r,kR(t,i),GR(e))),n&&s6(i,t))return i}var SR={x:NaN,y:NaN};function xD(t,e){let r=o6(t,e);if(r!=null&&dM(r,t)&&dM(r,e))return r}function ER(t,e,r){let i=e.x*r.y-e.y*r.x;return i>0&&t||i<0&&!t}function kR(t,e){let{x:r,y:i}=rm(t),{deltaAngle:n}=yD(t);return n>0?{x:i-e.y,y:e.x-r}:{x:e.y-i,y:r-e.x}}function GR(t){return{x:t.x2-t.x1,y:t.y2-t.y1}}var wr=__dcg_shared_module_exports__['i'](Z());var Un=__dcg_shared_module_exports__['i'](Z());Oe();var{IfElse:l6,Switch:c6}=Un.Components,d6=500,Zo=5,pM=class extends Un.Class{init(){this.latexKey=0}template(){return Un.createElement("div",{class:()=>({[this.getCustomClassName()]:!0,"dcg-tooltip-positioning-container":!0,"dcg-latex-tooltip-positioning-container":!!this.props.renderAsLatex,"dcg-tooltip-gravity-ne-se":this.props.gravity()==="ne"||this.props.gravity()==="se","dcg-tooltip-gravity-nw-sw":this.props.gravity()==="nw"||this.props.gravity()==="sw","dcg-tooltip-gravity-n-s":this.props.gravity()==="n"||this.props.gravity()==="s","dcg-tooltip-gravity-e-w":this.props.gravity()==="e"||this.props.gravity()==="w"}),style:()=>({top:`${this.props.hitAreaRect().top+(this.props.offset().top||0)}px`,left:`${this.props.hitAreaRect().left+(this.props.offset().left||0)}px`,width:`${this.props.hitAreaRect().width}px`,height:`${this.props.hitAreaRect().height}px`})},Un.createElement("div",{role:Un.const("tooltip"),class:Un.const("dcg-tooltip-message-container"),style:this.bindFn(this.getMessageStyle)},l6(()=>!!this.props.renderAsLatex,{true:()=>Un.createElement("div",{class:()=>({"dcg-tooltip-message":!0,"dcg-latex":!0,"dcg-sticky-not-stuck":this.props.isStickyAndNotStuck(),"dcg-tooltip-overflow":this.messageOverflows()}),style:()=>({"max-width":`${this.getMaxWidth()}px`}),didMount:e=>{this.tooltipMessage=e}},Un.createElement(c6,{key:()=>this.latexKey},()=>this.props.renderAsLatex().view(this.props.tooltip()))),false:()=>Un.createElement("div",{class:Un.const("dcg-tooltip-message"),style:()=>({background:this.getBackgroundColor(),cursor:this.props.isStickyAndNotStuck()?"pointer":"default"})},this.props.tooltip)})),Un.createElement("div",{class:()=>({"dcg-tooltip-arrow":!0,[`dcg-tooltip-gravity-${this.props.gravity()[0]}`]:!0}),style:()=>this.props.renderAsLatex?this.getArrowWithBorderStyle():this.getSolidArrowStyle()}))}willUpdate(){this.latexKey++}getCustomClassName(){return this.props.class?this.props.class():""}messageOverflows(){return this.tooltipMessage&&this.tooltipMessage.getBoundingClientRect().width>=this.getMaxWidth()}getArrowWithBorderStyle(){let e=this.props.gravity(),r="10px",i=this.getBackgroundColor(),n="#bbb",o=this.props.isStickyAndNotStuck()?".95":"1",s="8px",a={width:s,height:s,border:`1px solid ${n}`,background:i,opacity:o};switch(e){case"s":return __dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},a),{top:"100%",left:"50%","margin-top":"1px","border-right":"0","border-bottom":"0"});case"sw":return __dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},a),{top:"100%",right:r,"margin-top":"1px","border-right":"0","border-bottom":"0"});case"se":return __dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},a),{top:"100%",left:r,"margin-top":"1px","border-right":"0","border-bottom":"0"});case"n":return __dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},a),{bottom:"100%",left:"50%","margin-bottom":"1px","border-left":"0","border-top":"0"});case"nw":return __dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},a),{bottom:"100%",right:r,"margin-bottom":"1px","border-left":"0","border-top":"0"});case"ne":return __dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},a),{bottom:"100%",left:r,"margin-bottom":"1px","border-left":"0","border-top":"0"});case"e":return __dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},a),{top:"50%",left:"100%","margin-left":"1px","border-right":"0","border-top":"0"});case"w":return __dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},a),{top:"50%",right:"100%","margin-right":"1px","border-left":"0","border-bottom":"0"});default:return e}}getSolidArrowStyle(){let e=this.props.gravity(),r=`${this.props.hitAreaRect().width/2}px`,i=this.getBackgroundColor(),n=`transparent transparent ${i} transparent`,o=`${i} transparent transparent transparent`,s=`transparent ${i} transparent transparent`,a=`transparent transparent transparent ${i}`,l=`-${Zo}px`;switch(e){case"s":return{top:"100%",left:"50%",border:`${Zo}px solid transparent`,"border-color":n,"margin-top":l,"margin-left":l};case"sw":return{top:"100%",right:r,border:`${Zo}px solid transparent`,"border-color":n,"margin-top":l,"margin-right":l};case"se":return{top:"100%",left:r,border:`${Zo}px solid transparent`,"border-color":n,"margin-top":l,"margin-left":l};case"n":return{bottom:"100%",left:"50%",border:`${Zo}px solid transparent`,"border-color":o,"margin-bottom":l,"margin-left":l};case"nw":return{bottom:"100%",right:r,border:`${Zo}px solid transparent`,"border-color":o,"margin-bottom":l,"margin-right":l};case"ne":return{bottom:"100%",left:r,border:`${Zo}px solid transparent`,"border-color":o,"margin-bottom":l,"margin-left":l};case"e":return{top:"50%",left:"100%",border:`${Zo}px solid transparent`,"border-color":s,"margin-left":`-${Zo}px`,"margin-top":l};case"w":return{top:"50%",right:"100%",border:`${Zo}px solid transparent`,"border-color":a,"margin-right":l,"margin-top":l};default:return e}}getBackgroundColor(){return this.props.renderAsLatex?"#fff":this.props.isStickyAndNotStuck()?"#666":"#000"}getMaxWidth(){let r=this.props.gravity(),i=this.props.hitAreaRect().left+(this.props.offset().left||0),n=i+this.props.hitAreaRect().width,o=.5*this.props.hitAreaRect().width+i,s=5,a=window.innerWidth-5;switch(r){case"se":case"ne":case"e":return a-i;case"sw":case"nw":case"w":return n-s;case"s":case"n":return Math.min(a-o,o-s)*2;default:return r}}getMessageStyle(){let e=this.props.hitAreaRect(),r=this.props.gravity(),i=this.props.maxWidth();switch(r){case"s":return{top:"100%",width:`${i}px`,transform:"translate(-50%, 0)",left:`${.5*e.width}px`,"margin-top":`${Zo}px`,"text-align":"center"};case"sw":return{top:"100%",width:`${i}px`,right:"0","margin-top":`${Zo}px`,"text-align":"right"};case"se":return{top:"100%",width:`${i}px`,"margin-top":`${Zo}px`,"text-align":"left"};case"n":return{bottom:"100%",width:`${i}px`,transform:"translate(-50%, 0)",left:`${.5*e.width}px`,"margin-bottom":`${Zo}px`,"text-align":"center"};case"nw":return{bottom:"100%",right:"0",width:`${i}px`,"margin-bottom":`${Zo}px`,"text-align":"right"};case"ne":return{bottom:"100%",width:`${i}px`,"margin-bottom":`${Zo}px`,"text-align":"left"};case"e":return{transform:"translate(0, -50%)",left:"100%",width:`${i}px`,top:`${.5*e.height}px`,"margin-left":`${Zo}px`,"text-align":"left"};case"w":return{transform:"translate(0, -50%)",right:"100%",width:`${i}px`,top:`${.5*e.height}px`,"margin-right":`${Zo}px`,"text-align":"right"};default:return r}}};function h6(){return document.fullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||document.webkitFullscreenElement}var Pe=class extends Un.Class{init(){this.uuid=__dcg_shared_module_exports__['L']()}template(){return Un.createElement("div",{class:Un.const("dcg-tooltip-hit-area-container"),handleevent:Un.const("true"),didMount:e=>{this.isMounted=!0,this.hitAreaNode=e,this.setupEventListeners(this.hitAreaNode)},onTap:()=>{if(this.shouldStickOnTargetClick())if(this.isStuck)this.clearTimeouts(),this.hideTooltip();else{if(this.props.disabled&&this.props.disabled())return;this.showTooltip(),this.stickTooltip()}else if(this.shouldShowOnTapstart()){if(this.props.disabled&&this.props.disabled())return;this.showTooltip(),this.setUpHideOnExternalMousedown()}}},this.children)}shouldShowOnTapstart(){return this.props.showOnTapstart&&this.props.showOnTapstart()}didUpdate(){this.updateTooltip()}updateTooltip(){if(!this.wrapperRef)return;if(!this.props.tooltip()){this.hideTooltip();return}let e=this.hitAreaNode.getBoundingClientRect(),r=this.wrapperRef.elt.getBoundingClientRect(),{originalTop:i,originalLeft:n}=this.wrapperRef,o=e.top-r.top,s=e.left-r.left;Math.abs(o-i)>3||Math.abs(s-n)>3?this.hideTooltip():this.wrapperRef.view.update()}handleShowEvent(e){if(this.props.disabled&&this.props.disabled())return;let r=this.props.delay?this.props.delay():d6;this.clearTimeouts(),this.showTooltipTimeout=setTimeout(e,r)}handleHideEvent(){this.clearTimeouts(),this.hideTooltipTimeout=setTimeout(this.bindFn(this.hideTooltip),150)}setupEventListeners(e){I(e).on("tipsyshow",r=>{r.target===e&&this.handleShowEvent(()=>{this.showTooltip()})}).on("tipsyhide",r=>{r.target!==e||this.isStuck||this.handleHideEvent()})}willUnmount(){this.clearTimeouts(),this.isMounted=!1,this.hideTooltip()}setUpHideOnExternalMousedown(){I(document).on(`mousedown.dcg-tooltip-${this.uuid} touchstart.dcg-tooltip-${this.uuid} pointerdown.dcg-tooltip-${this.uuid}`,e=>{this.wrapperRef&&(I(e.target).closest(this.hitAreaNode).length||I(e.target).closest(this.wrapperRef.elt).length||this.hideTooltip())})}stickTooltip(){this.isMounted&&this.wrapperRef&&(this.isStuck||(this.setUpHideOnExternalMousedown(),this.isStuck=!0,this.updateTooltip()))}clearTimeouts(){clearTimeout(this.showTooltipTimeout),clearTimeout(this.hideTooltipTimeout)}showTooltip(){if(!this.isMounted||this.wrapperRef||!this.props.tooltip())return;let e=this.hitAreaNode.getBoundingClientRect(),r=document.createElement("div");r.className="dcg-tooltip-mount-pt";let i=I(this.hitAreaNode).closest(".dcg-tap-container")[0],n=h6();(!!n&&I(this.hitAreaNode).closest(n).length>0&&I(n).closest(".dcg-tap-container").length>0?n:i).appendChild(r);let s=r.getBoundingClientRect(),a=e.left-s.left,l=e.top-s.top,c=Math.min(200,this.props.maxParentWidthOverflow?e.width+2*this.props.maxParentWidthOverflow():1/0),d={tooltip:this.props.tooltip,class:this.props.class,isStickyAndNotStuck:()=>this.shouldStickOnTargetClick()&&!this.isStuck,offset:()=>this.props.offset?this.props.offset():{},gravity:()=>this.props.gravity?this.props.gravity():"s",renderAsLatex:this.props.renderAsLatex,maxWidth:()=>c,hitAreaRect:()=>({top:l||0,left:a||0,width:e.width||0,height:e.height||0})};this.setupEventListeners(r),I(r).on("dcg-tap",()=>{this.shouldStickOnTargetClick()&&this.stickTooltip()});let u=Un.mountToNode(pM,r,d);I(document).on(`keydown.dcg-tooltip-${this.uuid}`,g=>{Te(g)===jn&&this.hideTooltip()});let p=()=>this.updateTooltip();window.addEventListener("scroll",p,!0),this.wrapperRef={elt:r,view:u,originalLeft:a,originalTop:l,onScroll:p}}hideTooltip(){this.clearTimeouts(),this.wrapperRef&&(this.isStuck=!1,I(document).off(`.dcg-tooltip-${this.uuid}`),window.removeEventListener("scroll",this.wrapperRef.onScroll,!0),Un.unmountFromNode(this.wrapperRef.elt),this.wrapperRef.elt.parentNode&&this.wrapperRef.elt.parentNode.removeChild(this.wrapperRef.elt),this.wrapperRef=void 0)}shouldStickOnTargetClick(){return!!this.props.sticky&&this.props.sticky()}};var $d=__dcg_shared_module_exports__['i'](Z());var CD=class extends $d.Class{template(){return $d.createElement("div",{class:$d.const("dcg-dot-dot-dropdown")},$d.createElement("span",null),$d.createElement("span",null),$d.createElement("span",null))}};var wa=__dcg_shared_module_exports__['i'](Z());var im=class extends wa.Class{template(){return wa.createElement("span",{class:wa.const("dcg-navigate-back"),onTap:this.props.onBack,"aria-label":this.props.ariaLabel,role:wa.const("button"),tabindex:wa.const("0"),handleEvent:wa.const("true"),manageFocus:this.const(yt({controller:this.props.controller(),location:{type:"geo-header-back-link"}}))},wa.createElement("i",{class:wa.const("dcg-icon-chevron-left"),"aria-hidden":wa.const("true")}),wa.createElement("div",{class:wa.const("dcg-navigate-back-message")},this.props.message))}};var{Switch:p6}=wr.Components,DD=class extends wr.Class{init(){this.controller=this.props.controller(),this.focusOrder=[{type:"geo-header-back-link"},{type:"multi-select-delete-icon"},{type:"multi-select-show-hide-icon"},{type:"multi-select-transformations-icon"},{type:"multi-select-more-icon"}]}template(){return wr.createElement("div",{class:wr.const("dcg-multi-select-header dcg-animate-in-after-initial-load"),onKeydown:this.bindFn(this.handleKeydown),onTapStart:this.bindFn(this.clearSelection),role:wr.const("toolbar"),"aria-label":this.bindFn(this.getSelectedCountString)},wr.createElement(im,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-geometry-deselect-all"),controller:this.props.controller,message:this.bindFn(this.getSelectedCountString),onBack:this.bindFn(this.onDone)}),wr.createElement(Pe,{tooltip:this.bindFn(this.getDeleteItemString)},wr.createElement("span",{"aria-label":this.bindFn(this.getDeleteItemString),role:wr.const("button"),tabindex:wr.const("-1"),handleEvent:wr.const("true"),class:wr.const("dcg-multi-select-icon-button dcg-delete-btn"),onTap:this.bindFn(this.deleteSelected),manageFocus:this.const(yt({controller:this.controller,location:{type:"multi-select-delete-icon"}}))},wr.createElement("i",{class:wr.const("dcg-icon-trashcan"),"aria-hidden":wr.const("true")}))),wr.createElement(p6,{key:this.bindFn(this.getSelectedItemsKey)},()=>wr.createElement("div",{class:()=>({"dcg-btn-outline":!0,"dcg-show-hide-btn":!0,"dcg-any-visible-objects":this.anyVisible()}),handleEvent:wr.const("true"),tabindex:wr.const("-1"),role:wr.const("button"),onTap:this.bindFn(this.toggleItemsVisible),manageFocus:this.const(yt({controller:this.controller,location:{type:"multi-select-show-hide-icon"}}))},wr.createElement("div",{"aria-hidden":()=>!this.anyVisible()},()=>this.controller.s("graphing-calculator-text-geometry-hide-objects",{count:new ks(this.getSelectedCount())})),wr.createElement("div",{"aria-hidden":this.bindFn(this.anyVisible)},()=>this.controller.s("graphing-calculator-text-geometry-show-objects",{count:new ks(this.getSelectedCount())})))),wr.createElement("div",{class:()=>({"dcg-btn-outline":!0,"dcg-transformations-button":!0,"dcg-transformations-open":this.isTransformationsMenuOpen()}),handleEvent:wr.const("true"),tabindex:wr.const("-1"),role:wr.const("button"),"dcg-open-menu-guid":()=>Wy(),onTap:this.bindFn(this.toggleTransformationsMenu),manageFocus:this.const(yt({controller:this.controller,location:{type:"multi-select-transformations-icon"}}))},this.bindFn(this.getTransformationsString),wr.createElement("i",{class:wr.const("dcg-icon-caret-down"),"aria-hidden":wr.const("true")})),wr.createElement(Pe,{tooltip:this.bindFn(this.getMoreString)},wr.createElement("span",{"aria-label":this.bindFn(this.getMoreString),role:wr.const("button"),tabindex:wr.const("-1"),handleEvent:wr.const("true"),"aria-expanded":this.bindFn(this.isMoreMenuOpen),class:wr.const("dcg-multi-select-icon-button dcg-more-options"),"dcg-open-menu-guid":()=>ru(),manageFocus:this.const(yt({controller:this.controller,location:{type:"multi-select-more-icon"}})),onTap:this.bindFn(this.toggleMoreMenu)},wr.createElement(CD,null))))}handleKeydown(e){let r=Te(e);if(e.altKey||e.ctrlKey||e.metaKey||e.shiftKey||r!=="Left"&&r!=="Right"&&r!=="Home"&&r!=="End")return;let i=this.controller.getFocusLocation();if(!i)return;let n=__dcg_shared_module_exports__['y'](this.focusOrder,i);if(n===-1)return;e.preventDefault(),e.stopPropagation();let o=n;r==="Left"?o=Math.max(0,n-1):r==="Right"?o=Math.min(this.focusOrder.length-1,n+1):r==="Home"?o=0:r==="End"&&(o=this.focusOrder.length-1),o!==n&&this.controller.dispatch({type:"set-focus-location",location:this.focusOrder[o]})}getSelectedCountString(){return this.controller.s("graphing-calculator-text-geometry-selected-objects",{count:new ks(this.getSelectedCount())})}getDeleteItemString(){return this.controller.s("graphing-calculator-text-geometry-delete-selected-objects",{count:new ks(this.getSelectedCount())})}getMoreString(){return this.controller.s("graphing-calculator-text-geometry-multi-select-more-dropdown")}getTransformationsString(){return this.controller.s("graphing-calculator-text-geometry-multi-select-transform")}getSelectedItemsKey(){let e=this.controller.getAllSelectedItems();return __dcg_shared_module_exports__['q'](e,"id").join("-")}clearSelection(e){e.wasHandled()||this.onDone()}toggleItemsVisible(){this.anyVisible()?this.hideSelected():this.showSelected()}anyVisible(){let e=this.controller.getAllSelectedItems();return __dcg_shared_module_exports__['o'](e,r=>r.shouldGraph)}isFolderMenuOpen(){return this.controller.isItemSettingsMenuOpen(u6())}isMoreMenuOpen(){return this.controller.isItemSettingsMenuOpen(ru())}isTransformationsMenuOpen(){return this.controller.isItemSettingsMenuOpen(Wy())}toggleMoreMenu(e){this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"multi-select-more",guid:ru(),focusFirstOption:e.device==="keyboard"}})}toggleTransformationsMenu(e){this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"multi-select-transformations",guid:Wy(),focusFirstOption:e.device==="keyboard"}})}getSelectedCount(){return this.controller.getAllSelectedItems().length}hideSelected(){this.controller.dispatch({type:"update-all-selected-items",update:{prop:"visible",value:!1}})}showSelected(){this.controller.dispatch({type:"update-all-selected-items",update:{prop:"visible",value:!0}})}onDone(){this.controller.dispatch({type:"set-none-selected"})}deleteSelected(){this.controller.dispatch({type:"delete-all-selected-items"})}};function u6(){return"**multi-select-folder**"}function ru(){return"**multi-select-more**"}function Wy(){return"**multi-select-transformations**"}var SD=class{constructor(e){this.poiController=e,this.controller=e.controller,this.grapher=e.manager}getKeyboardAttention(){return this.objectUnderAttention}setKeyboardAttention(e){this.objectUnderAttention=e}findAllTabbableObjects(e){let r=e==null?void 0:e.calcId,n=this.controller.getGeoModel().getAllChoosableDefsUnordered({mode:"tab"}),o={};n.forEach(d=>{var p;o[d.calcId]||(o[d.calcId]=[]);let u={calcId:d.calcId,listIndex:d.listIndex,polygonEdge:(p=d.polygonEdgeInfo)==null?void 0:p.edgeNumber};o[d.calcId].push(u)});let s=[],a=-1,l=!1;var c=this.grapher.getSketchOrder();for(let d=c.length-1;d>=0;d--){let u=c[d];u===r&&(a=s.length);let p=o[u];if(p){p.sort((g,b)=>g.listIndex!==b.listIndex?g.listIndex===void 0?-1:b.listIndex===void 0?1:g.listIndex-b.listIndex:g.polygonEdge!==b.polygonEdge?g.polygonEdge===void 0?-1:b.polygonEdge===void 0?1:g.polygonEdge-b.polygonEdge:0);for(let g of p)u===r&&(l||(a=s.length),__dcg_shared_module_exports__['F'](g,e)&&(l=!0)),s.push(g)}}return{targets:s,currentTabIndex:a,currentIsTabbable:l}}findNextGeoObjFromKeyboard(e,r){let{targets:i,currentIsTabbable:n,currentTabIndex:o}=this.findAllTabbableObjects(r);if(!i.length)return;let s=!1;if(o===-1)return e==="next"?{wrapped:s,target:i[0]}:{wrapped:s,target:i[i.length-1]};let a=o;return e==="prev"?a-=1:n&&(a+=1),a===-1?(s=!0,a=i.length-1):a>=i.length&&(s=!0,a=0),{wrapped:s,target:i[a]}}focusGeoObjFromKeyboard(e,r){let i=this.findNextGeoObjFromKeyboard(e,this.getKeyboardAttention());i&&(i.wrapped&&this.controller.isVirtualMouseAllowed()?this.resetBackToGeoKeyboardPt():this.updateKeyboardAttention(i.target,{describe:!0},r))}updateKeyboardAttention(e,r,i){let n=this.getKeyboardAttention();__dcg_shared_module_exports__['F'](e,n)||(this.setKeyboardAttention(e),this.poiController.moveGeoKeyboardPtToFocusedItem(r),this.poiController.handleGeoKeyboardPtMove(i),r.describe&&this.poiController.describeFocusedConstruction({includeDetails:!0}))}handleGrapherGainedFocus(){if(this.controller.getGeoModel().speakCurrentGeoToolHint(),this.controller.isVirtualMouseAllowed())this.resetBackToGeoKeyboardPt();else{let r=this.findAllTabbableObjects(void 0).targets;r.length?this.updateKeyboardAttention(r[0],{describe:!0}):me("No inputs exist")}}resetBackToGeoKeyboardPt(){this.updateKeyboardAttention(void 0,{describe:!0}),this.poiController.geoKeyboardPt.x=this.poiController.geoKeyboardPt.lastArrowedX,this.poiController.geoKeyboardPt.y=this.poiController.geoKeyboardPt.lastArrowedY,this.poiController.handleGeoKeyboardPtMove()}};function jy(t){if(!t)return 0;if(t.type==="image"&&t.listIndex)return t.listIndex;if("poi"in t)return t.poi.pointIdxOnBranch;if("branchInfo"in t&&t.branchInfo.sketch){var e=t.branchInfo.branch,r=t.branchInfo.sketch.branches[e];return"listIndex"in r&&r.listIndex||0}return 0}var f6=0,id=class{constructor(e,r){this.geoKeyboardPt={x:NaN,y:NaN,lastArrowedX:NaN,lastArrowedY:NaN};this.grapherIsPressed=!1;this.canceledGeoToolplayWhilePressed=!1;this.manager=e,this.controller=e.controller,this.keyboardAttentionManager=new SD(this),this.graphSettings=r,this.$=this.manager.$,this.id=f6++,!(!this.graphSettings.config.graphpaper||this.graphSettings.config.disableMouseInteractions)&&(this.addTouchEventHandlers(),this.addHoverEventHandler(),this.addKeydownEventHandler(),this.addManualUnhoverListener(),this.addGeoEventHandlers())}remove(){this.removeAllGlobalMouseListeners(),this.removeManualUnhoverListener(),this.removeAllGeoListeners()}addGlobalMouseListener(e,r){for(var i=e.split(" "),n=0;n<i.length;n++){var o=i[n]+".dcg-poiController-"+this.id;I(document).on(o,r)}}removeAllGeoListeners(){I(document).off(".dcg-poiController-geo-"+this.id)}removeAllGlobalMouseListeners(){I(document).off(".dcg-poiController-"+this.id)}getToleranceByDevice(e){return e==="touch"?20:10}addGeoEventHandlers(){var e="keydown.dcg-poiController-geo-"+this.id,r="keyup.dcg-poiController-geo-"+this.id,i=e+" "+r;I(document).on(i,n=>{this.controller.isGeoToolActive()&&this.handleGeoShiftKeyChange(n.shiftKey)}),I(document).on("mouseleave.dcg-poiController-geo-"+this.id,()=>{if(this.controller.isGeoToolActive()&&!this.grapherIsPressed){let n=this.controller.getGeoModel();n.onMouseAction("move",{pt:{x:NaN,y:NaN},shift:!1,tolerance:0}),n.onPreviewChange()}}),I(document).on("dcg-tapmove.dcg-poiController-geo-"+this.id,n=>{this.controller.isGeoToolActive()&&this.handleGeoTapMove(n)}),I(document).on("dcg-tapend.dcg-poiController-geo-"+this.id,n=>{this.controller.isGeoToolActive()&&this.handleGeoTapEnd(n)})}addHoverEventHandler(){this.$.on("dcg-tapmove",e=>{if(e.device!=="touch"){var r=document.elementFromPoint(e.clientX,e.clientY),i=!!r&&!!I(r).closest(".dcg-grapher").length,n=this.manager.poiLabelsLayer,o=this.getMouseRelativeToGrapher(e),s=this.getToleranceByDevice(e.device);if(!this.controller.isGeoToolActive()){var a;i&&(a=this.getFeatureUnderPoint(o,s));var l;if(a&&a.type==="movable-point"){let k=a.poi,S=k&&k.getMovablePoint();l=S&&S.id}var c,d=0;a&&a.isClickable&&!e.shiftKey&&!this.manager.movablePointsLayer.isMovingPoint()&&!this.manager.traceLayer.isTracing()&&(c=a.model,d=jy(a));var u=this.manager.clickableObjectsLayer,p={};c&&(p[c.id]={listIndexes:d===void 0?void 0:{[d]:!0}}),u.setHoveredObjects(p);var g;a&&"poi"in a&&a.poi&&(!a.poi.isAttachedToPlottedPoint()||a.poi.hasInteractiveLabel())&&(g=a.poi),g!==n.getHoveredPOI()&&(this.controller.isTraceEnabled()?n.setHoveredPOI(g):n.setHoveredPOI(void 0),this.manager.redrawAllLayers());var b=!1;if(a&&a.type==="image"){var x=jc(a.model),w=a.isClickable;b=x&&!w}var E=!1;a&&a.type==="draggable-label"&&(E=!0),b||E?this.manager.setLayerClass("extraMoveCursor","dcg-mouse-over-movable-point"):this.manager.setLayerClass("extraMoveCursor",""),this.manager.movablePointsLayer.setHoveredPointId(l)}}})}addManualUnhoverListener(){var e=()=>{var r=this.manager;r.poiLabelsLayer.setHoveredPOI(void 0),r.clickableObjectsLayer.setHoveredObjects({}),r.redrawAllLayers()};I(window).on("blur.dcg-poiController-"+this.id,e),this.$.on("mouseleave",e)}removeManualUnhoverListener(){I(window).off(".dcg-poiController-"+this.id)}addTouchEventHandlers(){this.$.on("touchstart",e=>{if(!this.isViewportLocked()){I(e.target).is(":not(input, textarea)")&&e.preventDefault();return}var r=this.getMouseRelativeToGrapher(e),i=this.getToleranceByDevice(e.device),n=this.getFeatureUnderPoint(r,i);n&&(n.type==="image"&&!Ha(n.model)&&!jc(n.model)||n.type==="sketch-branch"&&this.graphSettings.config.onlyTraceSelected&&!n.sketch.selected||I(e.target).is(":not(input, textarea)")&&e.preventDefault())}),this.$.on("dcg-tapstart",e=>{if(this.controller.isGeoToolActive()){e.handle(),this.handleGeoTapStart(e);return}var r=this.getMouseRelativeToGrapher(e),i=this.getToleranceByDevice(e.device),n=this.getFeatureUnderPoint(r,i);if(!n){this.isBoxSelectActive(e)||this.controller.dispatch({type:"set-none-selected"}),this.isBoxSelectActive(e)?this.startBoxSelect(e):this.manager.viewportController.beginPanning(e);return}if("sketch"in n&&n.sketch){var o=e.shiftKey?void 0:jy(n),s=this.controller.tryInsertTokenIntoMathquill(n.sketch.id,o);if(s){e.handle(),e.preventDefault();return}}if(n.isClickable&&!this.isBoxSelectActive(e)){let p="model"in n&&n.model;p?this.manager.clickableObjectsLayer.setPressedObject({id:p.id,listIndex:jy(n)}):this.manager.clickableObjectsLayer.setPressedObject(void 0)}else this.manager.clickableObjectsLayer.setPressedObject(void 0);if(n.type==="editable-label"){e.handle();return}else ti();if(n.type==="draggable-label"){this.startMovingPoints({poiUnderMouse:void 0,evt:e,points:[{type:"draggable-label",label:n.label,startScreenPt:r}]}),e.handle();return}if(n.type==="clickable-label"&&e.handle(),n.type==="image"&&jc(n.model)&&!this.isBoxSelectActive(e)){var a=!1;if(n.isClickable&&(a=!0),this.startMovingPoints({poiUnderMouse:void 0,evt:e,points:[{type:"image",image:n.model,startScreenPt:r,shouldDelayUntilRealMove:a}]}),!a){e.handle();return}}var l=!1;let c=n.model;if(this.controller.isGeometry()&&c&&c.type==="expression"&&c.formula.geometry){!this.isBoxSelectActive(e)&&!this.controller.isItemSelected(c.id)&&this.controller.dispatch({type:"set-none-selected"});let p;"poi"in n&&(p=n.poi),l=this.startReverseDrag(c.id,e,p),l&&n.type!=="static-point"&&this.manager.clickableObjectsLayer.setPressedObject({id:c.id,listIndex:jy(n)})}if(n.type==="movable-point"&&(e.handle(),e.handle("do-not-clear-poi-labels"),!l)){this.startMovingPoints({poiUnderMouse:n.poi,evt:e,points:[{type:"poi",poi:n.poi,startScreenPt:r}]});return}if(n.type==="static-point"&&(!n.isClickable||this.isBoxSelectActive(e))){let p=n.poi;if(this.controller.isGeometry()){if(p&&p.hasInteractiveLabel()){this._togglePOIUnderPoint(r,i)&&e.handle("do-not-clear-poi-labels");return}}else if(p){this._togglePOIUnderPoint(r,i)&&e.handle("do-not-clear-poi-labels");return}(!n.sketch.selected||this.isBoxSelectActive(e))&&n.model&&this.selectItemIfNotSecret(n.model.id,this.isBoxSelectActive(e));return}if(!l&&this._togglePOIUnderPoint(r,i)){e.handle(),e.handle("do-not-clear-poi-labels");return}if(!l&&n.type==="sketch-branch"&&(!n.isClickable||this.isBoxSelectActive(e))){var d=!this.controller.isTraceEnabled();if(this.graphSettings.config.onlyTraceSelected){if(e.handle("do-not-clear-poi-labels"),!d&&n.sketch.selected&&!this.isBoxSelectActive(e)){this.startTracingBranch(n.branchInfo,r),e.handle();return}}else{var u=!this.controller.isListEnabled();if(d&&u||(this.selectItemIfNotSecret(n.sketch.id,this.isBoxSelectActive(e)),d))return;this.startTracingBranch(n.branchInfo,r),e.handle(),e.handle("do-not-clear-poi-labels");return}}this.addGlobalMouseListener("dcg-tapmove",p=>{this.manager.clickableObjectsLayer.isAnObjectPressed()?r=this.getMouseRelativeToGrapher(p):(this.removeAllGlobalMouseListeners(),this.manager.viewportController.beginPanning(p))}),this.addGlobalMouseListener("dcg-tapend dcg-tapcancel",p=>{this.removeAllGlobalMouseListeners();var g=this.manager.clickableObjectsLayer.getPressedObject(),b=g&&g.id;this.manager.clickableObjectsLayer.setPressedObject(void 0);var x=this.getFeatureUnderPoint(r,i);if(x&&x.isClickable&&!this.isBoxSelectActive(p)){let w="model"in x&&x.model;w&&w.id===b&&!p.wasHandled("dragged-clickable-object")&&this.controller.dispatch({type:"clickable-item-clicked",id:w.id,listIndex:jy(x)});return}if(!l){if(x&&x.type==="sketch-branch"&&(!x.sketch.selected||this.isBoxSelectActive(p))){this.selectItemIfNotSecret(x.model.id,this.isBoxSelectActive(p));return}if(x&&(x.type==="movable-point"||x.type==="static-point")){(!x.sketch.selected||this.isBoxSelectActive(p))&&x.model&&this.selectItemIfNotSecret(x.model.id,this.isBoxSelectActive(p));return}if(x&&x.type==="image"){this.selectItemIfNotSecret(x.model.id,this.isBoxSelectActive(p));return}}})})}isBoxSelectActive(e){if(!this.controller.isMultiSelectEnabled())return!1;let r=this.controller.getActiveTool();return r==="selection"&&e.shiftKey||r==="box-selection"}isViewportLocked(){return this.graphSettings.config.lockViewport||this.graphSettings.userLockedViewport}addKeydownEventHandler(){this.$.on("keydown",e=>{var o;if(!this.manager.getAudioTrace().getAudioTraceActive()){var r=this.manager.movablePointsLayer.getFocusedPoint(),i=Te(e),n=ei(e);if(i==="Up"||i==="Down"||i==="Left"||i==="Right")e.stopPropagation(),e.preventDefault(),r?this.movePointFromKeyboard(r,e):this.controller.isVirtualMouseAllowed()&&this.moveGeoPointFromKeyboard(e);else if(this.controller.isGeoUIActive()){let s,a,l,c,d,u,p=!1;if(e.ctrlKey&&e.shiftKey&&!e.altKey&&!e.metaKey){let g;if(n==="O"?g={type:"multi-select-more",guid:ru(),focusFirstOption:!0,previousFocusLocation:{type:"graph-paper"}}:n==="A"&&(g={type:"multi-select-transformations",guid:Wy(),focusFirstOption:!0,previousFocusLocation:{type:"graph-paper"}}),g){e.preventDefault(),e.stopPropagation();let b=this.keyboardAttentionManager.getKeyboardAttention();this.controller.getActiveTool()!=="box-selection"&&b&&this.controller.getItemModel(b.calcId)&&this.controller.dispatch({type:"set-selected-id",id:b.calcId}),this.controller.dispatch({type:"toggle-item-settings-menu",menu:g})}}else if(!e.altKey&&!e.ctrlKey&&!e.metaKey)if(i==="Enter"||i==="Space")e.preventDefault(),e.stopPropagation(),this.controller.getActiveTool()==="box-selection"?(this.selectItemIfNotSecret(((o=this.keyboardAttentionManager.getKeyboardAttention())==null?void 0:o.calcId)||"",!0),this.describeFocusedConstruction({includeDetails:!1})):this.tapGeoPointFromKeyboard(e);else if(n==="?")e.preventDefault(),e.stopPropagation(),this.controller.getGeoModel().speakCurrentGeoToolHint();else if(n==="D")e.preventDefault(),e.stopPropagation(),this.describeFocusedConstruction({includeDetails:!0});else if(i==="Tab"&&this.controller.getActiveTool()!=="selection"){e.preventDefault(),e.stopPropagation();let g=e.shiftKey?"prev":"next";this.keyboardAttentionManager.focusGeoObjFromKeyboard(g,e)}else if(i==="Backspace"||i==="Del"){e.preventDefault(),e.stopPropagation();let g=this.keyboardAttentionManager.getKeyboardAttention();this.controller.getActiveTool()!=="box-selection"&&g&&this.controller.getItemModel(g.calcId)&&this.controller.dispatch({type:"set-selected-id",id:g.calcId}),this.controller.dispatch({type:"delete-all-selected-items"}),p=!0}else if(n==="-")e.preventDefault(),e.stopPropagation(),s=this.controller.getGeoTools(),l=__dcg_shared_module_exports__['y'](s,{key:this.controller.getActiveTool()}),l===-1?l=0:l===0?l=s.length-1:l-=1,a=s[l],a&&(this.controller.dispatch({type:"select-geo-tool",tool:a.key,clearSelection:!0}),p=!0);else if(n==="=")e.preventDefault(),e.stopPropagation(),s=this.controller.getGeoTools(),l=__dcg_shared_module_exports__['y'](s,{key:this.controller.getActiveTool()}),l===-1?l=s.length-1:l===s.length-1?l=0:l+=1,a=s[l],a&&(this.controller.dispatch({type:"select-geo-tool",tool:a.key,clearSelection:!0}),p=!0);else if(n==="["){if(e.preventDefault(),e.stopPropagation(),s=this.controller.getGeoTools(),l=__dcg_shared_module_exports__['y'](s,{key:this.controller.getActiveTool()}),l===-1||(a=s[l],!a)||(c=a.dropdown||[],c.length===0))return;d=c.indexOf(a.key),d===-1?d=0:d===0?d=c.length-1:d-=1,u=c[d],u&&(this.controller.dispatch({type:"select-geo-tool",tool:u,clearSelection:!0}),p=!0)}else if(n==="]"){if(e.preventDefault(),e.stopPropagation(),s=this.controller.getGeoTools(),l=__dcg_shared_module_exports__['y'](s,{key:this.controller.getActiveTool()}),l===-1||(a=s[l],!a)||(c=a.dropdown||[],c.length===0))return;d=c.indexOf(a.key),d===-1?d=c.length-1:d===c.length-1?d=0:d+=1,u=c[d],u&&(this.controller.dispatch({type:"select-geo-tool",tool:u,clearSelection:!0}),p=!0)}else!e.shiftKey&&n!==void 0&&n>="0"&&n<="9"&&(s=this.controller.getGeoTools(),a=s[e.which-49],a&&(e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"select-geo-tool",tool:a.key,clearSelection:!0}),p=!0));p&&this.handleGeoKeyboardPtMove()}else r&&(n==="X"||n==="Y"||n==="L"||n==="C")&&this.speakPoint(r,n)}})}getMouseRelativeToGrapher(e){var r=this.$[0].getBoundingClientRect(),i=e.touches?e.touches[0]:e,n=i.clientX-r.left,o=i.clientY-r.top;return{x:n,y:o}}_getStyledPointRadiusAdjustments(){return{radiusMultiplier:this.graphSettings.getHighlightPropertyMultiplier("pointLineWidth",!1),selectedRadiusMultiplier:this.graphSettings.getHighlightPropertyMultiplier("pointLineWidth",!0),movablePoint:this.graphSettings.config.projectorMode?30/2:22/2}}_getStyledPointRadiusForPOI(e,r){if(e.isMovable())return r.movablePoint;{let i=e.getPointSize()/2,n=e.isSelected()?r.selectedRadiusMultiplier:r.radiusMultiplier;return i*n}}_getDistanceFromStyledPOI(e,r){var i=this._getStyledPointRadiusForPOI(e,r.adjustments),n=Math.max(0,r.tolerance-i),o=r.projection.map_pt(e),s=__dcg_shared_module_exports__['_'](o.x-r.screenPt.x,o.y-r.screenPt.y),a=Math.max(0,s-i);if(a<=n)return a}_getClosestPoint(e,r,i){for(var n=1/0,o,s={projection:this.manager.getProjection(),adjustments:this._getStyledPointRadiusAdjustments(),screenPt:r,tolerance:i},a=0;a<e.length;a++){var l=e[a],c=this._getDistanceFromStyledPOI(l,s);c!==void 0&&c<n&&(n=c,o=l)}return o}findIdsThatIntersectBox(e){for(var r={},i=this.manager.getSketchOrder(),n=i.length-1;n>=0;n--){var o=i[n],s=this.controller.getItemModel(o);if(s){if(s.type==="expression"){var a=this.manager.getGraphSketch(o);if(!a)continue;var l=a.branches;if(!l||!l.length)continue;for(let d=0;d<l.length;d++)if(this.doesBoxIntersectBranch(l[d],e)){r[s.id]=!0;break}}else if(s.type==="image"){var c=this.manager.getGraphImage(o);if(!c)continue;id.doesBoxIntersectAnyImage(c,e)&&(r[s.id]=!0)}}}return this.manager.poiDotsLayer.getDrawnPOI().forEach(function(d){d.isBareLabel()||(d.isMovable()||d.isAttachedToPlottedPoint())&&id.doesBoxIntersectPOI(d,e)&&(r[d.sketch.id]=!0)}),r}_getStyledLineAdjustments(){return{thicknessMultiplier:this.graphSettings.getHighlightPropertyMultiplier("graphLineWidth",!1),selectedThicknessMultiplier:this.graphSettings.getHighlightPropertyMultiplier("graphLineWidth",!0)}}_getStyledLineThicknessForBranch(e,r,i){var n=Math.max(0,"lineWidth"in e&&e.lineWidth||0)/2;return r?n*i.selectedThicknessMultiplier:n*i.thicknessMultiplier}_getDistanceFromStyledBranch(e,r,i,n){var o=this._getStyledLineThicknessForBranch(e,r,n.adjustments),s=this.calculateDistanceFromBranch(e,n.screenPt,n.projection,i);let a=Math.max(0,s-o),l=Math.max(0,n.tolerance-o);if(a<=l)return a}getFeatureUnderPoint(e,r){var i=this.manager.poiLabelsLayer,n=this.manager.getProjection();if(this.manager.scaleAxis)return;var o=i.getInteractiveLabelUnderPoint(e);if(o)switch(o.type){case"editable":return{type:"editable-label",model:o.model,isClickable:void 0};case"draggable":return{type:"draggable-label",label:o.label,isClickable:void 0};case"clickable":return{type:"clickable-label",model:o.model,poi:o.poi,isClickable:!0}}var s=this.manager.getSketchOrder(),a={},l=1,c;let d={adjustments:this._getStyledLineAdjustments(),projection:n,screenPt:e,tolerance:r};for(var u=s.length-1;u>=0;u--){var p=s[u],g=this.controller.getItemModel(p),b=l;if(a[p]=b,!!g){if(g.type==="expression"){var x=this.manager.getGraphSketch(p);if(!x)continue;var w=x.branches;if(!w||!w.length)continue;if(x.showHighlight&&!this.controller.isGeometry()&&(b=-1/0,a[p]=b),!c||c.stackingContext>=b)for(var E=Uc(g),k=0;k<w.length;k++){var S=w[k],T=this._getDistanceFromStyledBranch(S,x.showHighlight,E,d);if(T!==void 0){var V=!1;c?(b<c.stackingContext||b===c.stackingContext&&T<c.distance-3.5)&&(V=!0):V=!0,V&&(c={type:"sketch-branch",model:g,sketch:x,distance:T,stackingContext:b,branchInfo:{id:x.id,branch:k,sketch:x}})}}}else if(g.type==="image"){var O=this.manager.getGraphImage(p);if(!O)continue;var y=this.getImageInfoUnderMouse(O,n.pixelsToMath.mapPoint(e),r);if(!y)continue;O.foreground?(l+=1,b=l,a[p]=b,l+=1):(b=1/0,a[p]=b),(!c||c.stackingContext>b)&&(c={type:"image",model:O,distance:0,stackingContext:b,listIndex:y.listIndex})}}}var L=[],P=[],K=[],$=[],U=c?c.stackingContext:1/0;this.manager.poiDotsLayer.getDrawnPOI().forEach(z=>{var Q;if(!z.isBareLabel())if(z.isMovable()){let fe=z.sketch.id,ie=this.controller.getItemModel(fe),Le=ie&&ie.type==="expression"&&((Q=ie.formula.geometry)==null?void 0:Q.call);Le&&Le.symbol==="glider"?L.push(z):P.push(z)}else z.isAttachedToPlottedPoint()?a[z.sketch.id]<=U&&K.push(z):$.push(z)});var J=this._getClosestPoint(L,e,r);if(J||(J=this._getClosestPoint(P,e,r)),J)return{type:"movable-point",poi:J,isClickable:void 0,sketch:J.sketch,model:this.controller.getItemModel(J.sketch.id)};var R=this._getClosestPoint($,e,r);if(R)return{type:"poi",poi:R,isClickable:!1,model:void 0};var q=this._getClosestPoint(K,e,r);if(q){var _=this.controller.getItemModel(q.sketch.id);if(_&&_.type==="expression"){var A=Uc(_);if(A)return{type:"static-point",poi:q,sketch:q.sketch,isClickable:!0,model:_}}return{type:"static-point",poi:q,isClickable:!1,sketch:q.sketch,model:_}}if(c){if(c.type==="sketch-branch")return{type:"sketch-branch",branchInfo:c.branchInfo,sketch:c.sketch,model:c.model,isClickable:Uc(c.model),isSelected:this.controller.isItemSelected(c.sketch.id),selectionId:this.controller.isItemSelectable(c.model.id)?c.model.id:void 0};if(c.type==="image")return{type:"image",model:c.model,isClickable:uC(c.model),listIndex:c.listIndex,isSelected:this.controller.isItemSelected(c.model.id),selectionId:this.controller.isItemSelectable(c.model.id)?c.model.id:void 0}}}_togglePOIUnderPoint(e,r){if(this.controller.isTraceEnabled()){var i=this.getFeatureUnderPoint(e,r);if(!i||i.isClickable)return!1;var n="poi"in i&&i.poi;return!n||n.isBareLabel()?!1:(this.manager.poiLabelsLayer.isOpenPOI(n)?(this.manager.poiLabelsLayer.closePOI(n),this.manager.poiLabelsLayer.setHoveredPOI(void 0)):(this.manager.poiLabelsLayer.openPOI(n),this.speakPoint(n)),this.manager.redrawAllLayers(),!0)}}getImageInfoUnderMouse(e,r,i){if(e){var n=e.formula;if(n){var o=n.dimensions;if(!(!o.x||!o.y||!o.width||!o.height||!o.radianAngle||!e.shouldGraph))for(var s=o.x.length-1;s>=0;s--){var a=o.x[s],l=o.y[s],c=o.radianAngle[s],d=a+Math.cos(c)*(r.x-a)-Math.sin(c)*(r.y-l),u=l+Math.sin(c)*(r.x-a)+Math.cos(c)*(r.y-l),p=.5*Math.abs(o.width[s]),g=.5*Math.abs(o.height[s]);if(d>a-p&&d<a+p&&u>l-g&&u<l+g)return{listIndex:s}}}}}doesBoxIntersectBranch(e,r){let i=!1,n=!1;switch(e.graphMode){case 5:case 8:case 2:break;case 6:i=!0;break;case 1:n=!0;break;case 18:case 17:case 19:return vD(r,{x1:e.segments[0][0],y1:e.segments[0][1],x2:e.segments[0][2],y2:e.segments[0][3],extendStart:e.graphMode===18,extendEnd:e.graphMode!==17});case 20:return IR(r,{x:e.segments[0][0],y:e.segments[0][1],radius:e.segments[0][2]});case 21:case 23:{let[d,u]=e.segments[0],[p,g,b]=e.graphMode===21?this.getBoxIntersectArgsForArc(e):this.getBoxIntersectArgsForAngleMarker(e),x=(b-g)/2+g;return VR(r,{x0:d+p*Math.cos(g),y0:u+p*Math.sin(g),x1:d+p*Math.cos(x),y1:u+p*Math.sin(x),x2:d+p*Math.cos(b),y2:u+p*Math.sin(b)})}default:return!1}for(var o=e.segments,s=0;s<o.length;s++){var a=o[s];if(i){let d=a;a=[];for(let u=0;u<d.length;u+=2){var l=d[u],c=d[u+1];a.push(c*Math.cos(l),c*Math.sin(l))}}else if(n){let d=a;a=[];for(let u=0;u<d.length;u+=2)a.push(d[u+1],d[u])}if(MR(r,a))return!0}return!1}getBoxIntersectArgsForArc(e){return[e.segments[0][2],e.segments[0][3],e.segments[0][4]]}getBoxIntersectArgsForAngleMarker(e){let r=e.segments[0][3],i=this.manager.getProjection(),n=$g(r,i),o=i.pixelsToMath.dangerouslyGetXScaleFactor(),s=i.pixelsToMath.dangerouslyGetYScaleFactor();return[Math.abs(Math.min(o,s))*n,e.segments[0][2],e.segments[0][2]+r]}static doesBoxIntersectAnyImage(e,r){var i=e.formula;if(i){var n=i.dimensions;if(!(!n.x||!n.y||!n.width||!n.height||!n.radianAngle||!e.shouldGraph)){for(var o=n.x.length-1;o>=0;o--)if(TR(r,{width:n.width[o],height:n.height[o],angle:n.radianAngle[o],center:{x:n.x[o],y:n.y[o]}}))return!0;return!1}}}static doesBoxIntersectPOI(e,r){return r.left<=e.x&&e.x<=r.right&&r.top<=e.y&&e.y<=r.bottom}calculateDistanceFromBranch(e,r,i,n){if(e&&e.graphMode===7&&(n||this.controller.isGeometry())){var o=e.segments;let l=i.pixelsToMath.mapCoordinatePair([r.x,r.y]);for(var s=0;s<o.length;s++)if(__dcg_shared_module_exports__['ma'](o[s],l))return 0;return 1/0}var a=id.getBranchesDistanceInfo(e,r,i,n,this.controller.isGeometry());return a?a.minDistance:1/0}static getBranchesDistanceInfo(e,r,i,n,o){let s=r.x,a=r.y,{mathToPixels:l,pixelsToMath:c}=i;switch(e.graphMode){case 5:if(!o&&!n)return;break;case 8:if(!n)return;break;case 6:if(!n)return;break;case 2:case 1:break;case 23:{let[Se,Ke,Ae,Ze]=e.segments[0],qe=l.dangerouslyGetXScaleFactor(),At=l.dangerouslyGetYScaleFactor(),[Fe,Lt]=c.mapCoordinatePair([s,a]),_r=$g(Ze,i),Ge=_r/qe,vi=1/0,ht=Lt-Ke,Ee=Fe-Se,bo=Math.atan2(ht,Ee);if(__dcg_shared_module_exports__['Z'](bo,Ae,Ze)){var d=__dcg_shared_module_exports__['_'](ht*At,Ee*qe);d<=_r+7&&(vi=0)}else{let st=__dcg_shared_module_exports__['ba'](Fe,Lt,Se+Ge*Math.cos(Ae),Ke+Ge*Math.sin(Ae),Se,Ke),gt=__dcg_shared_module_exports__['ba'](Fe,Lt,Se+Ge*Math.cos(Ae+Ze),Ke+Ge*Math.sin(Ae+Ze),Se,Ke),ft=__dcg_shared_module_exports__['_'](qe*(st[0]-Fe),At*(st[1]-Lt)),le=__dcg_shared_module_exports__['_'](qe*(gt[0]-Fe),At*(gt[1]-Lt));vi=Math.min(ft,le)}return{closestPoint:{x:s,y:a},minDistance:vi,secondDistance:vi}}break;case 18:case 17:case 19:{var u=l.mapX(e.segments[0][0]),p=l.mapY(e.segments[0][1]),g=l.mapX(e.segments[0][2]),b=l.mapY(e.segments[0][3]),x=e.graphMode===18,w=e.graphMode!==17,E=__dcg_shared_module_exports__['ca'](s,a,u,p,g,b,x,w);if(!E)return null;var k=__dcg_shared_module_exports__['_'](E[0]-s,E[1]-a);return{closestPoint:{x:E[0],y:E[1]},minDistance:k,secondDistance:k}}case 21:case 20:{var S=e.segments[0][0],T=e.segments[0][1],V=e.segments[0][2];let Se=e.graphMode===21?e.segments[0][3]:0,Ke=e.graphMode===21?e.segments[0][4]:Math.PI*2;var O=__dcg_shared_module_exports__['da'](c.mapX(s),c.mapY(a),S,T,V,Se,Ke);if(!O)return null;let Ae=l.mapCoordinatePair(O);var y=__dcg_shared_module_exports__['_'](Ae[0]-s,Ae[1]-a);return{closestPoint:{x:Ae[0],y:Ae[1]},minDistance:y,secondDistance:y}}default:return}for(var L=1/0,P=1/0,K,$,U=0;U<e.segments.length;U++)for(var J=e.segments[U],R=0;R<J.length-3;R+=2){var q=J[R],_=J[R+1],A=J[R+2],z=J[R+3];if(e.graphMode===6){var Q=_,fe=q;q=Q*Math.cos(fe),_=Q*Math.sin(fe);var ie=z,Le=A;A=ie*Math.cos(Le),z=ie*Math.sin(Le)}e.graphMode===1&&([q,_]=[_,q],[A,z]=[z,A]);let[Se,Ke]=l.mapCoordinatePair([q,_]),[Ae,Ze]=l.mapCoordinatePair([A,z]);var pe=__dcg_shared_module_exports__['ba'](0,0,Se-s,Ke-a,Ae-s,Ze-a),ae=__dcg_shared_module_exports__['_'](pe[0],pe[1]);pe[e.graphMode===1?1:0]<0?ae<L&&(L=ae,K=pe):ae<P&&(P=ae,$=pe)}var ye=L<P?K:$;if(ye){var H=ye[0]+s,ge=ye[1]+a;return{closestPoint:{x:H,y:ge},minDistance:Math.min(L,P),secondDistance:Math.max(L,P)}}}static getBranchesTracePoint(e,r,i,n){var o,s=i.pixelsToMath.mapPoint(r);switch(e.graphMode){case 20:case 21:{let P=e.graphMode===21?e.segments[0][3]:0,K=e.graphMode===21?e.segments[0][4]:Math.PI*2;o=__dcg_shared_module_exports__['da'](s.x,s.y,e.segments[0][0],e.segments[0][1],e.segments[0][2],P,K);break}case 18:case 19:case 17:o=__dcg_shared_module_exports__['ca'](s.x,s.y,e.segments[0][0],e.segments[0][1],e.segments[0][2],e.segments[0][3],e.graphMode===18,e.graphMode!==17);break}if(o)return{x:o[0],y:o[1]};if(!e)return;let a="compiled"in e&&e.compiled,l=a&&a.fn;if(!l)return;var c=this.getBranchesDistanceInfo(e,r,i,!1,n);if(!c)return;let{mathToPixels:d,pixelsToMath:u}=i,p,g;e.graphMode===2?(g="x",p="y"):(g="y",p="x",d=new __dcg_shared_module_exports__['Ec'](d.yScale,d.xScale),u=d.inverse());var b=c.minDistance/c.secondDistance;b=b*b;var x=c.closestPoint[g]*(1-b)+r[g]*b,w=.5,E=.5,k=d.mapY(l(u.mapX(x-w))),S=d.mapY(l(u.mapX(x))),T=d.mapY(l(u.mapX(x+w))),V=w*Math.min(1,E/Math.abs(k-S)),O=w*Math.min(1,E/Math.abs(T-S));isFinite(V)||(V=w),isFinite(O)||(O=w);let y=fi(u.mapX(x-V),u.mapX(x+O)),L=l(y);if(!isFinite(d.mapY(L))){let P=d.mapX(y)-w,K=d.mapX(y)+w,$=u.mapX(P),U=u.mapX(K),J=l($),R=l(U),q=d.mapY(J),_=d.mapY(R);Math.abs(q-r[p])<Math.abs(_-r[p])?L=J:L=R}return{x:e.graphMode===2?y:L,y:e.graphMode===2?L:y}}getPointInfo(e){switch(e.type){case"poi":return e.poi.getMovablePoint();case"image":return{sketch:{id:e.image.formula.center_reference_id}};case"draggable-label":return{sketch:{id:e.label.model.id}};default:return e}}startReverseDrag(e,r,i){let n=this.getMouseRelativeToGrapher(r),o=[e].concat(this.controller.getAllSelectedItems().map(d=>d.id));var s=this.controller.getGeoModel().getComputedBoard().computeReversibilityLineages(o),a=[],l=!1;for(let d in s){var c=this.manager.poiDotsLayer.getDrawnPOI().filter(u=>u.isMovable()?d===u.sketch.id:!1);if(!c||c.length!==1){l=!0;break}a.push({type:"poi",poi:c[0],startScreenPt:n,shouldDelayUntilRealMove:!0,transformations:s[d]})}return l?!1:a.length>0?(this.startMovingPoints({poiUnderMouse:i,evt:r,points:a}),!0):!1}startMovingPoints(e){var r=e.evt,i=e.points,n=!1,o=!1,s=i.map(this.getPointInfo),a=this.controller;function l(){o=!0,a.dispatch({type:"start-moving-points",points:s})}var c=!1;for(var d of i)if(d.shouldDelayUntilRealMove){c=!0;break}c||l();let u;e.poiUnderMouse&&e.poiUnderMouse.isMovable()&&(u=e.poiUnderMouse.getMovablePoint().id),this.manager.movablePointsLayer.setPressedPointId(u);var p=i.map(x=>{var w;switch(x.type){case"poi":if(w=x.poi,x.transformations){let k=__dcg_shared_module_exports__['Ma'](x.transformations.forward,[w.x,w.y]);w={x:k[0],y:k[1]}}break;case"image":w={x:x.image.formula.dimensions.x[0],y:x.image.formula.dimensions.y[0]};break;case"draggable-label":w={x:x.label.x,y:x.label.y};break}var E=this.manager.getProjection().map_pt(w);return{x:x.startScreenPt.x-E.x,y:x.startScreenPt.y-E.y}}),g=void 0,b=()=>{if(g){n=!0,o||l();var x=this.manager.getProjection(),w=this.getMouseRelativeToGrapher(g);g=void 0,this.controller.dispatch({type:"on-move-points",points:i.map(this.getPointInfo),screenPts:p.map(function(E){return{x:w.x-E.x,y:w.y-E.y}}),transform:i.map(E=>E.type==="poi"?E.transformations:void 0),previousScreenPts:i.map(E=>E.startScreenPt),projection:x})}};this.manager.registerMovablePointListener(b),this.addGlobalMouseListener("dcg-tapmove",x=>{g=x}),this.addGlobalMouseListener("dcg-tapend dcg-tapcancel",x=>{if(b(),this.manager.deregisterMovablePointListener(),this.removeAllGlobalMouseListeners(),this.manager.movablePointsLayer.setPressedPointId(void 0),o&&(x.handle("dragged-clickable-object"),this.controller.dispatch({type:"stop-moving-points",points:i.map(this.getPointInfo)})),!n){var w=this.getMouseRelativeToGrapher(r),E=this.getToleranceByDevice(r.device),k=this.getFeatureUnderPoint(w,E);if(k&&k.type==="movable-point")if(this.controller.isGeometry())(!k.sketch.selected||this.isBoxSelectActive(x))&&k.model&&this.selectItemIfNotSecret(k.model.id,this.isBoxSelectActive(x));else return;else if(k&&k.type==="sketch-branch"){var S=k.model;S&&S.formula.geometry&&(!k.isClickable||this.isBoxSelectActive(x))&&(!k.sketch.selected||this.isBoxSelectActive(x))&&this.selectItemIfNotSecret(k.model.id,this.isBoxSelectActive(x))}}})}startTracingBranch(e,r){this.manager.markLabelsDirty(),this.lastScreenPt=r;var i=this.manager.getProjection(),n=e.sketch,o=n.branches[e.branch],s=id.getBranchesTracePoint(o,r,i,this.controller.isGeometry());s&&this.speakPoint(s),this.manager.traceLayer.setTraceInfo({pt:s,branchInfo:e}),this.manager.redrawAllLayers(),this.addGlobalMouseListener("dcg-tapmove",this.handleTraceUpdate.bind(this)),this.addGlobalMouseListener("dcg-tapend dcg-tapcancel",this.stopTracingBranch.bind(this))}stopTracingBranch(e){this.manager.markLabelsDirty();var r=this.manager.poiLabelsLayer.getHoveredPOI();r&&!this.manager.poiLabelsLayer.isOpenPOI(r)&&(this.manager.poiLabelsLayer.openPOI(r),this.speakPoint(r),this.manager.redrawAllLayers()),this.lastScreenPt=void 0,this.manager.traceLayer.setTraceInfo(void 0),this.manager.redrawAllLayers(),this.removeAllGlobalMouseListeners()}handleTraceUpdate(e){if(this.manager.traceLayer.traceInfo){var r=this.manager.getProjection(),i;if(e)i=this.getMouseRelativeToGrapher(e),this.lastScreenPt=i,this.manager.markLabelsDirty();else if(this.lastScreenPt)i=this.lastScreenPt;else return;var n=1/0,o=-1,s=this.manager.traceLayer.traceInfo,a=this.manager.graphSketches[s.branchInfo.sketch.id];if(a){s.branchInfo.sketch=a;for(var l=s.branchInfo.sketch.branches,c=0;c<l.length;c++){var d=this.calculateDistanceFromBranch(l[c],i,r,!1);d<n&&(o=c,n=d)}var u=l[o],p=u?id.getBranchesTracePoint(u,i,r,this.controller.isGeometry()):void 0;p&&this.speakPoint(p),this.manager.traceLayer.traceInfo.branchInfo.branch=o,this.manager.traceLayer.traceInfo.pt=p,this.manager.redrawAllLayers()}}}hasNonlinearMoveStrategy(e){if(!e||!e.sketch)return!1;var r=this.controller.getItemModel(e.sketch.id);if(!r||r.type!=="expression"||!r.formula)return!1;var i=r.formula.move_strategy;return!i||!i[0]?!1:i[0].type==="updateSliderNonlinear"}movePointFromKeyboard(e,r){if(r&&!(!e||!e.sketch)){var i=this.controller.getItemModel(e.sketch.id);if(!(!i||i.type!=="expression")){var n=e.type==="movable-point"||i.label!==void 0&&i.showLabel&&i.reconciledDragMode!=="NONE";if(n){var o=this.manager.getProjection(),s=o.map_pt({x:e.x,y:e.y}),a=0,l=0,c=Te(r),d=(o.pixelCoordinates.right-o.pixelCoordinates.left)/40,u=(o.pixelCoordinates.bottom-o.pixelCoordinates.top)/40,p=c==="Up"||c==="Down"?u:d;p=r.shiftKey?p*5:p;var g,b;if(c==="Up"?(b="y",l-=p,g=r.shiftKey?"bigup":"up"):c==="Down"?(b="y",l+=p,g=r.shiftKey?"bigdown":"down"):c==="Left"?(b="x",a-=p,g=r.shiftKey?"bigdown":"down"):c==="Right"&&(b="x",a+=p,g=r.shiftKey?"bigup":"up"),g){var x={x:s.x+a,y:s.y+l},w;b==="x"||this.hasNonlinearMoveStrategy(e)?w={x:g}:b==="y"&&(w={y:g}),this.controller.dispatch({type:"on-move-points",points:[e],screenPts:[x],previousScreenPts:[s],projection:o,keyboardDirection:w})}}}}}getGeoKeyboardPt(){return this.initGeoKeyboardPt(),this.geoKeyboardPt}setGeoKeyboardPt(e){this.geoKeyboardPt=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.geoKeyboardPt),{x:e.x,y:e.y}),e.fromArrowKeys&&(this.geoKeyboardPt.lastArrowedX=e.x,this.geoKeyboardPt.lastArrowedY=e.y),this.manager.redrawAllLayers()}initGeoKeyboardPt(){if(!isNaN(this.geoKeyboardPt.x)&&!isNaN(this.geoKeyboardPt.y))return;let e=this.manager.getProjection();if(!e)return;let r=e.viewport,i=Jh(e),n=i.minorStepX,o=i.minorStepY,s=Math.round((r.xmin+r.xmax)/2/n)*n,a=Math.round((r.ymin+r.ymax)/2/o)*o;this.setGeoKeyboardPt({x:s,y:a})}moveGeoPointFromKeyboard(e){if(!e)return;this.initGeoKeyboardPt();let r=this.manager.getProjection();if(!r)return;let i=r.viewport,n=Jh(r),o=n.minorStepX/4,s=n.minorStepY/4;var a=this.geoKeyboardPt.x,l=this.geoKeyboardPt.y,c=Te(e);if(c==="Down"?e.ctrlKey?l=i.ymin:l=Math.max(Math.round((l-s)/s)*s,i.ymin):c==="Up"?e.ctrlKey?l=i.ymax:l=Math.min(Math.round((l+s)/s)*s,i.ymax):c==="Left"?e.ctrlKey?a=i.xmin:a=Math.max(Math.round((a-o)/o)*o,i.xmin):c==="Right"&&(e.ctrlKey?a=i.xmax:a=Math.min(Math.round((a+o)/o)*o,i.xmax)),a!==this.geoKeyboardPt.x||l!==this.geoKeyboardPt.y){this.setGeoKeyboardPt({x:a,y:l,fromArrowKeys:!0}),this.handleGeoKeyboardPtMove(e),Nt(eu(this.controller,this.geoKeyboardPt.x,this.geoKeyboardPt.y));let d=this.manager.clickableObjectsLayer.getHoveredObjects();for(let u in d){let p=this.controller.getItemModel(u);p!==void 0&&Nt(this.controller.s("graphing-calculator-narration-geometry-near-item",{item:this.controller.getGeoDescription(p,{includeDetails:!1})}))}me()}}handleGeoKeyboardPtMove(e){this.initGeoKeyboardPt();let r=this.controller.getGeoModel(),i=!!(e&&e.shiftKey);r.onMouseAction("move",{pt:this.geoKeyboardPt,shift:i,tolerance:this.getToleranceByDevice("keyboard")}),r.onPreviewChange()}tapGeoPointFromKeyboard(e){var l;this.initGeoKeyboardPt();let r=this.controller.getGeoModel(),i=this.controller.getActiveTool(),n=r.getCurrentTool(),o=(l=n.getSpec)==null?void 0:l.call(n),s=!!e.shiftKey;var a=r.onMouseAction("release",{pt:this.geoKeyboardPt,shift:s,tolerance:this.getToleranceByDevice("keyboard")});a.committed&&this.controller.dispatch(__dcg_shared_module_exports__['b']({type:"commit-geo-objects"},a)),r.onMouseAction("move",{pt:this.geoKeyboardPt,shift:s,tolerance:this.getToleranceByDevice("keyboard")}),r.onPreviewChange(),this.speakReleaseAndUpdate(i,o,a.committed,e)}speakReleaseAndUpdate(e,r,i,n){this.controller.getEvaluator().notifyWhenSynced(()=>{this.speakGeoReleaseAction(e,r,i);let o,s=i&&Object.keys(i)[0];s&&(o=this.controller.getItemModel(s)),o||(o=this.controller.getSelectedItem()),this.keyboardAttentionManager.updateKeyboardAttention(o?{calcId:o.id,listIndex:void 0,polygonEdge:void 0}:void 0,{describe:!1},n)})}speakGeoReleaseAction(e,r,i){var n;if(i!==void 0){let o=Object.keys(i);if(!r)return;let s="";if(e==="point"){for(let a in i){let l=i[a];if(l){if(l.type==="point-reference"){s=this.controller.s("graphing-calculator-text-geometry-tool-point-display-name");break}else if(l.type==="intersection"){s=this.controller.s("graphing-calculator-text-geometry-intersection");break}else if(l.type==="glider"){s=this.controller.s("graphing-calculator-text-geometry-glider");break}}}s===""&&(s=this.controller.s("graphing-calculator-text-geometry-tool-point-display-name"))}else switch((n=r.outputs[0])==null?void 0:n.type){case"arc":s=this.controller.s("graphing-calculator-text-geometry-tool-arc-display-name");break;case"circle":s=this.controller.s("graphing-calculator-text-geometry-tool-circle-display-name");break;case"line":s=this.controller.s("graphing-calculator-text-geometry-tool-line-display-name");break;case"segment":s=this.controller.s("graphing-calculator-text-geometry-tool-segment-display-name");break;case"ray":s=this.controller.s("graphing-calculator-text-geometry-tool-ray-display-name");break;case"parallel":s=this.controller.s("graphing-calculator-text-geometry-tool-parallel-display-name");break;case"perpendicular":s=this.controller.s("graphing-calculator-text-geometry-tool-perpendicular-display-name");break;case"midpoint":s=this.controller.s("graphing-calculator-text-geometry-tool-midpoint-display-name");break;case"polygon":s=this.controller.s("graphing-calculator-text-geometry-tool-polygon-display-name");break;case"angle":s=this.controller.s("graphing-calculator-text-geometry-tool-angle-display-name");break;case"reflect":s=this.controller.s("graphing-calculator-text-geometry-tool-reflect-display-name");break;case"translate":s=this.controller.s("graphing-calculator-text-geometry-tool-translate-display-name");break;case"dilate":s=this.controller.s("graphing-calculator-text-geometry-tool-dilate-display-name");break;case"rotate":s=this.controller.s("graphing-calculator-text-geometry-tool-rotate-display-name");break;default:s=this.controller.s("graphing-calculator-narration-geometry-item-unknown")}o.length===1?me(this.controller.s("graphing-calculator-narration-geometry-added-object-type",{type:s})):s!=="graphing-calculator-text-geometry-point"?o.length===2?me(this.controller.s("graphing-calculator-narration-geometry-added-object-type-and-point",{type:s})):me(this.controller.s("graphing-calculator-narration-geometry-added-object-type-and-points",{type:s,points:o.length-1})):me(this.controller.s("graphing-calculator-narration-geometry-added-points",{points:o.length}))}else this.controller.getGeoModel().speakCurrentGeoToolHint()}describeFocusedConstruction(e){let r=this.keyboardAttentionManager.getKeyboardAttention(),i=this.controller.getItemModel((r==null?void 0:r.calcId)||"");me(this.controller.getGeoDescription(i,{includeDetails:e.includeDetails,listIndex:r==null?void 0:r.listIndex,polygonEdge:r==null?void 0:r.polygonEdge,includeSelectionState:this.controller.getActiveTool()==="box-selection"}))}moveGeoKeyboardPtToFocusedItem(e){let r=this.keyboardAttentionManager.getKeyboardAttention(),i=this.controller.getItemModel((r==null?void 0:r.calcId)||"");if(!i){e.describe&&me(this.controller.s("graphing-calculator-narration-geometry-nothing-selected"));return}if(i.type!=="expression"||!i.latex){e.describe&&me(this.controller.s("graphing-calculator-narration-geometry-not-a-construction"));return}let n=i.formula.typed_constant_value;if(!n){e.describe&&me(this.controller.s("graphing-calculator-narration-geometry-not-a-construction"));return}if(!this.manager.getProjection())return;let s=n.valueType,a=n.value;if(__dcg_shared_module_exports__['ub'](n.valueType)){let u=r==null?void 0:r.listIndex;u&&(s=__dcg_shared_module_exports__['vb'](s),a=a[u-1])}let l=r==null?void 0:r.polygonEdge;if(s===__dcg_shared_module_exports__['$a']&&l!==void 0&&l>=0&&a.length>l){let u=a[l],p=a[(l+1)%a.length];s=__dcg_shared_module_exports__['bb'],a=[u,p]}let c=NaN,d=NaN;s===__dcg_shared_module_exports__['Ta']?(c=a[0],d=a[1]):s===__dcg_shared_module_exports__['hb']||s===__dcg_shared_module_exports__['jb']||s===__dcg_shared_module_exports__['bb']?(c=(a[0][0]+a[1][0])/2,d=(a[0][1]+a[1][1])/2):(c=a[0][0],d=a[0][1]),this.controller.getGeoModel().setObjectHovered({calcId:(r==null?void 0:r.calcId)||"",listIndex:void 0}),!isNaN(c)&&!isNaN(d)?(this.setGeoKeyboardPt({x:c,y:d}),e.describe&&me(this.controller.s("graphing-calculator-narration-geometry-moved-to-coordinates",{x:Xi(this.controller,c),y:Qi(this.controller,d)}))):e.describe&&me(this.controller.s("graphing-calculator-narration-geometry-unable-to-move"))}speakPoint(e,r){if(e){var i=this.manager.getAudioTrace();if(i){var n=this.manager.getProjection();if(n)switch(r){case"X":me(Xi(this.controller,e.x));break;case"Y":me(Qi(this.controller,e.y));break;case"L":"ariaLabel"in e&&e.ariaLabel?me(e.ariaLabel):me(this.controller.s("graphing-calculator-narration-poi-graph-point"));break;case"C":"sketch"in e&&me(Rd(this.controller,e.sketch.color))}}}}selectItemIfNotSecret(e,r){!this.controller.shouldShowAuthorFeatures()&&this.controller.isItemSecret(e)&&!this.controller.isItemInGeoFolder(e)||(!this.controller.isMultiSelectEnabled()||!r?this.controller.dispatch({type:"set-selected-id",id:e}):this.controller.dispatch({type:"toggle-selected-with-multi-select",id:e}))}convertTouchEventToMathPoint(e){let{clientX:r,clientY:i}=e.changedTouches[0],n=this.manager.$[0].getBoundingClientRect();return this.controller.getGeoModel().convertCanvasPixelsToPoint({x:r-n.left,y:i-n.top})}handleGeoTapStart(e){let r=this.controller.getGeoModel();this.grapherIsPressed=!0;let i=!!e.shiftKey,n=this.convertTouchEventToMathPoint(e);this.geoMouse=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},n),{shift:i}),r.onMouseAction("press",{pt:n,shift:i,tolerance:this.getToleranceByDevice(e.device)}),AR(e)?this.handleGeoTapMove(e):(r.onPreviewChange(),this.updateGeoHoveredObjects()),r.getToolMode()==="expression-edit"&&e.preventDefault()}handleGeoShiftKeyChange(e){let r=this.geoMouse;if(!r||r.shift===e)return;r.shift=e;let i=this.controller.getGeoModel();i.onMouseAction("move",{pt:{x:r.x,y:r.y},shift:r.shift,tolerance:this.getToleranceByDevice("mouse")}),i.onPreviewChange()}handleGeoTapMove(e){let r=this.controller.getGeoModel();if(this.isEventWithinInstance(e)||this.grapherIsPressed){let i=this.convertTouchEventToMathPoint(e),n=!!e.shiftKey;this.geoMouse=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},i),{shift:n}),r.onMouseAction("move",{pt:i,shift:n,tolerance:this.getToleranceByDevice(e.device)})}else this.geoMouse=void 0,r.onMouseAction("move",{pt:{x:NaN,y:NaN},shift:!1,tolerance:0});r.onPreviewChange()}replayGeoTapMove(){let e=this.controller.getGeoModel(),r=this.geoMouse;r&&(e.onMouseAction("move",{pt:{x:r.x,y:r.y},shift:r.shift,tolerance:this.getToleranceByDevice("mouse")}),e.onPreviewChange())}handleGeoTapEnd(e){var a;if(!this.grapherIsPressed)return;let r=this.controller.getGeoModel();this.grapherIsPressed=!1,this.geoMouse=void 0;let i=this.canceledGeoToolplayWhilePressed?{committed:void 0}:r.onMouseAction("release",{pt:this.convertTouchEventToMathPoint(e),shift:!!e.shiftKey,tolerance:this.getToleranceByDevice(e.device)});this.canceledGeoToolplayWhilePressed=!1,i.committed&&this.controller.dispatch(__dcg_shared_module_exports__['b']({type:"commit-geo-objects"},i)),this.isEventWithinInstance(e)&&AR(e)?this.handleGeoTapMove(e):r.onPreviewChange();let n=this.controller.getActiveTool(),o=r.getCurrentTool(),s=(a=o.getSpec)==null?void 0:a.call(o);this.speakGeoReleaseAction(n,s,i.committed),r.getToolMode()==="expression-edit"&&e.preventDefault()}isEventWithinInstance(e){return e.target?I(e.target).closest(this.manager.$).length:0}updateGeoHoveredObjects(){let e=this.controller.getGeoModel(),r={};e.getHoveredItems().forEach(i=>{let n;if("tokenId"in i){let o=this.controller.getGeoTokenInfoFromIdentifier(__dcg_shared_module_exports__['Jb'](i.tokenId));n=o&&o.calcId}else n=i.calcId;if(n!==void 0){let o=r[n];o?i.listIndex===void 0?o.listIndexes=void 0:o.listIndexes!==void 0&&(o.listIndexes[i.listIndex-1]=!0):r[n]={listIndexes:i.listIndex===void 0?void 0:{[i.listIndex-1]:!0}}}}),this.manager.clickableObjectsLayer.setHoveredObjects(r)}cancelGeoToolplay(){this.canceledGeoToolplayWhilePressed=this.grapherIsPressed,this.updateGeoHoveredObjects()}startBoxSelect(e){let r={};this.controller.getAllSelectedItems().forEach(o=>r[o.id]=!0);let i=this.manager.getProjection().reverse_map_pt(this.getMouseRelativeToGrapher(e)),n;this.addGlobalMouseListener("dcg-tapmove",o=>{n=this.manager.getProjection().reverse_map_pt(this.getMouseRelativeToGrapher(o));let s={left:Math.min(i.x,n.x),top:Math.min(i.y,n.y),right:Math.max(i.x,n.x),bottom:Math.max(i.y,n.y)};this.manager.setBoxSelectRectangle(s);let a=this.findIdsThatIntersectBox(s);this.controller.dispatch({type:"set-all-selected-ids",ids:__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['b']({},r),a)})}),this.addGlobalMouseListener("dcg-tapend dcg-tapcancel",o=>{this.removeAllGlobalMouseListeners(),this.manager.setBoxSelectRectangle(void 0),n||this.controller.dispatch({type:"set-none-selected"})})}};function AR(t){return t.device==="mouse"}Oe();var nc=class{constructor(e=0,r=0,i=1,n=i){this.tx=e,this.ty=r,this.sx=i,this.sy=n}toJSON(){return{tx:this.tx,ty:this.ty,sx:this.sx,sy:this.sy}}compose(e){return new nc(this.sx*e.tx+this.tx,this.sy*e.ty+this.ty,this.sx*e.sx,this.sy*e.sy)}translate(e,r){let i=r===void 0?e.x:r.x-e.x,n=r===void 0?e.y:r.y-e.y;return new nc(this.tx+i,this.ty+n,this.sx,this.sy)}scale(e,r){return nc.scale(e,r).compose(this)}scaleAtPoint(e,r,i=r){return nc.scaleAtPoint(e,r,i).compose(this)}mapX(e){return this.sx*e+this.tx}mapY(e){return this.sy*e+this.ty}mapPoint(e){return{x:this.mapX(e.x),y:this.mapY(e.y)}}mapRect(e){return{left:this.mapX(e.left),right:this.mapX(e.right),bottom:this.mapY(e.bottom),top:this.mapY(e.top)}}},Wa=nc;Wa.scale=function(e,r=e){return new nc(0,0,e,r)},Wa.translate=function(e,r){return new nc().translate(e,r)},Wa.scaleAtPoint=function(e,r,i=r){return i===void 0&&(i=r),new nc(e.x*(1-r),e.y*(1-i),r,i)},Wa.fromRects=function(e,r){let i=(r.right-r.left)/(e.right-e.left),n=(r.top-r.bottom)/(e.top-e.bottom);return new nc(r.left-i*e.left,r.bottom-n*e.bottom,i,n)},Wa.fromJSON=function(e){return new nc(e.tx,e.ty,e.sx,e.sy)};var oc=class{constructor(e,r,i){this.screen=e,this.viewport=r,this.settings=i,this.mathCoordinates=__dcg_shared_module_exports__['Dc'](r),this.pixelCoordinates=__dcg_shared_module_exports__['Cc'](e),this.updateScalePairs()}updateScalePairs(){let{xAxisScale:e,yAxisScale:r}=this.settings;this.mathToPixels=__dcg_shared_module_exports__['Ec'].fromRects(this.mathCoordinates,this.pixelCoordinates,{xAxisScale:e,yAxisScale:r}),this.pixelsToMath=this.mathToPixels.inverse()}mapx(e){return this.mathToPixels.mapX(e)}mapy(e){return this.mathToPixels.mapY(e)}reverse_mapx(e){return this.pixelsToMath.mapX(e)}reverse_mapy(e){return this.pixelsToMath.mapY(e)}mapAlongAxis(e,r){switch(r){case"x":return this.mapx(e);case"y":return this.mapy(e);default:{let i=r;throw new Error(`Unknown axis: ${i}`)}}}reverseMapAlongAxis(e,r){switch(r){case"x":return this.reverse_mapx(e);case"y":return this.reverse_mapy(e);default:{let i=r;throw new Error(`Unknown axis: ${i}`)}}}map_pt(e){return this.mathToPixels.mapPoint(e)}map_xy_pairs(e){for(var r=[],i=0;i<e.length;i+=2)r.push(this.mapx(e[i])),r.push(this.mapy(e[i+1]));return r}reverse_map_pt(e){return this.pixelsToMath.mapPoint(e)}coordsAreOnscreen(e,r,i=0){return e>-i&&r>-i&&e<this.screen.width+i&&r<this.screen.height+i}closestPointOnScreen(e){let r=this.pixelCoordinates;return{x:Math.min(Math.max(e.x,r.left),r.right),y:Math.min(Math.max(e.y,r.top),r.bottom)}}};Oe();var LR=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],ED="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],y6=Array.prototype.slice,uM,Wd;if(I.event.fixHooks)for(gM=LR.length;gM;)I.event.fixHooks[LR[--gM]]=I.event.mouseHooks;var gM,fM=I.event.special.mousewheel={version:"3.1.9",setup:function(){if(this.addEventListener)for(var t=ED.length;t;)this.addEventListener(ED[--t],mM,!1);else this.onmousewheel=mM;I.data(this,"mousewheel-line-height",fM.getLineHeight(this)),I.data(this,"mousewheel-page-height",fM.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var t=ED.length;t;)this.removeEventListener(ED[--t],mM,!1);else this.onmousewheel=null},getLineHeight:function(t){return parseInt(I(t)["offsetParent"in I.fn?"offsetParent":"parent"]().css("fontSize"),10)},getPageHeight:function(t){return I(t).height()},settings:{adjustOldDeltas:!0}};I.fn.extend({mousewheel:function(t){return t?this.bind("mousewheel",t):this.trigger("mousewheel")},unmousewheel:function(t){return this.unbind("mousewheel",t)}});function mM(t){var e=t||window.event,r=y6.call(arguments,1),i=0,n=0,o=0,s=0;if(t=I.event.fix(e),t.type="mousewheel","detail"in e&&(o=e.detail*-1),"wheelDelta"in e&&(o=e.wheelDelta),"wheelDeltaY"in e&&(o=e.wheelDeltaY),"wheelDeltaX"in e&&(n=e.wheelDeltaX*-1),"axis"in e&&e.axis===e.HORIZONTAL_AXIS&&(n=o*-1,o=0),i=o===0?n:o,"deltaY"in e&&(o=e.deltaY*-1,i=o),"deltaX"in e&&(n=e.deltaX,o===0&&(i=n*-1)),!(o===0&&n===0)){if(e.deltaMode===1){var a=I.data(this,"mousewheel-line-height");i*=a,o*=a,n*=a}else if(e.deltaMode===2){var l=I.data(this,"mousewheel-page-height");i*=l,o*=l,n*=l}return s=Math.max(Math.abs(o),Math.abs(n)),(!Wd||s<Wd)&&(Wd=s,PR(e,s)&&(Wd/=40)),PR(e,s)&&(i/=40,n/=40,o/=40),i=Math[i>=1?"floor":"ceil"](i/Wd),n=Math[n>=1?"floor":"ceil"](n/Wd),o=Math[o>=1?"floor":"ceil"](o/Wd),t.deltaX=n,t.deltaY=o,t.deltaFactor=Wd,t.deltaMode=0,r.unshift(t,i,n,o),uM&&clearTimeout(uM),uM=setTimeout(b6,200),(I.event.dispatch||I.event.handle).apply(this,r)}}function b6(){Wd=null}function PR(t,e){return fM.settings.adjustOldDeltas&&t.type==="mousewheel"&&e%120===0}var{log10:kD}=Math;function yM(t,e){var r=e.x-t.x,i=e.y-t.y,n=.5*(t.x+e.x),o=.5*(t.y+e.y),s=.5*__dcg_shared_module_exports__['_'](r,i);return{center:sc(n,o),radius:s}}function OR(t,e){var r={x:2*t.x-e.x,y:2*t.y-e.y};return yM(e,r)}function _R(t,e){for(var r=[],i=0;i<t.length;i++)r.push(sc(t[i].pageX-e.left,t[i].pageY-e.top));return r}function sc(t,e){return{x:t,y:e}}function FR(t){return sc(.5*(t.left+t.right),.5*(t.bottom+t.top))}var v6=0,GD=class{constructor(e,r){this.s=zl(()=>this.grapher.settings.config.language);this.grapher=e,this.$=e.$,this.id=v6++,this.controller=r,this.isScalingEnabled=!1,this.mousePt=sc(0,0),this.lastScrollZoom=Date.now(),this.preventScrollZoom=!1,this.addMouseWheelEventHandler(),this.addTouchEventHandler()}remove(){I(window).off(".viewportcontroller-"+this.id)}getViewport(){return this.grapher.getProjection().viewport}getProjection(){return this.grapher.getProjection()}isViewportLocked(){var e=this.getProjection().settings;return e.config.lockViewport||e.userLockedViewport}updateMouse(e){var r=this.$[0].getBoundingClientRect();this.mousePt=sc(e.clientX-r.left,e.clientY-r.top)}updateScaleAxis(){this.isMouseInViewport()&&(this.isMouseNearYAxis()?this.grapher.scaleAxis="y":this.isMouseNearXAxis()?this.grapher.scaleAxis="x":this.grapher.scaleAxis="both"),this.updateCursor(),this.grapher.redrawAllLayers()}updateCursor(){this.$.toggleClass("dcg-scale-horizontal",this.grapher.scaleAxis==="x"),this.$.toggleClass("dcg-scale-vertical",this.grapher.scaleAxis==="y"),this.$.toggleClass("dcg-scale-both",this.grapher.scaleAxis==="both")}isMouseNearOrigin(){var e=this.getProjection(),r=e.mathToPixels.mapPoint(sc(0,0));return Math.abs(this.mousePt.x-r.x)<50&&Math.abs(this.mousePt.y-r.y)<50}isMouseNearXAxis(){var e=this.getProjection(),r=e.pixelCoordinates,i=e.mathToPixels.mapY(0);return i=Math.min(Math.max(r.top,i),r.bottom),Math.abs(this.mousePt.y-i)<40&&e.settings.showXAxis}isMouseNearYAxis(){var e=this.getProjection(),r=e.pixelCoordinates,i=e.mathToPixels.mapX(0);return i=Math.min(Math.max(r.left,i),r.right),Math.abs(this.mousePt.x-i)<40&&e.settings.showYAxis}isMouseInViewport(){var e=this.getProjection(),r=e.mathCoordinates,i=e.pixelsToMath.mapPoint(this.mousePt);return i.x>=r.left&&i.x<=r.right&&i.y>=r.bottom&&i.y<=r.top}_setViewportWithoutCancellingAnimation(e){if(e.isValid(this.controller.getAxisScaleSettings())&&!e.equals(this.getViewport())){var i=this.getProjection();this.grapher._setProjection(new oc(i.screen,e,i.settings))}}setViewport(e){this.cancelAnimation(),this._setViewportWithoutCancellingAnimation(e)}setScreen(e){var r=this.getProjection();let i=r.settings.squareAxes?r.viewport.squareYAxis(e,r.settings):r.viewport;var n=new oc(e,i,r.settings);this.grapher._setProjection(n)}getTransformedViewport(e){let{pixelCoordinates:r,mathCoordinates:i,settings:n}=this.getProjection(),{xAxisScale:o,yAxisScale:s}=n,a=e.mapRect(r);var l=__dcg_shared_module_exports__['Ec'].fromRects(i,a,{xAxisScale:o,yAxisScale:s}).inverse().mapRect(r);return new an(l.left,l.right,l.bottom,l.top)}transformViewport(e){this.setViewport(this.getTransformedViewport(e)),(this.grapher.scaleAxis==="x"||this.grapher.scaleAxis==="y")&&this.controller.markSquareAxesAfterUserEditedViewport()}animateToViewport(e){this.cancelAnimation();let r=this.getProjection(),i=r.viewport,n=r.mathToPixels;var o=0,s,a=l=>{s||(s=l);var c=(l-s)/500;if(o+=c,o<1){this.__animationTimeout=requestAnimationFrame(a);let d=n.interpolateX(i.xmin,e.xmin,o),u=n.interpolateX(i.xmax,e.xmax,o),p=n.interpolateY(i.ymin,e.ymin,o),g=n.interpolateY(i.ymax,e.ymax,o);this._setViewportWithoutCancellingAnimation(new an(d,u,p,g)),this.grapher.debounceUserRequestedViewportChange()}else this.setViewport(an.fromObject(e)),this.grapher.debounceUserRequestedViewportChange(),this.controller.markSquareAxesAfterUserEditedViewport()};this.__animationTimeout=requestAnimationFrame(a)}cancelAnimation(){cancelAnimationFrame(this.__animationTimeout)}addMouseWheelEventHandler(){var e=!1,r,i;I(window).on("scroll.viewportcontroller-"+this.id,function(s){e=!0}),I(window).on("mousewheel.viewportcontroller-"+this.id,function(s){r=s.clientX,i=s.clientY}),I(window).on("mousemove.viewportcontroller-"+this.id,function(s){if(e){var a=s.clientX-r,l=s.clientY-i,c=a*a+l*l;c<100||(e=!1)}});var n=0,o=(s,a)=>{var l=Date.now();let c=l-this.lastScrollZoom;if(this.preventScrollZoom&&c>50&&(this.preventScrollZoom=!1),this.lastScrollZoom=l,this.preventScrollZoom)return;var d=this.getProjection();if(this.isViewportLocked())return;var u=d.mathToPixels;if(e)return;s.preventDefault(),this.updateMouse(s);var p=u.mapPoint(sc(0,0)),g=this.isMouseNearOrigin()&&a>0?p:this.mousePt;if(n>0)return;n+=1,requestAnimationFrame(function(){n--}),a=a>0?1:-1;let{xAxisScale:b,yAxisScale:x}=d.settings,w=.0625;(b==="logarithmic"||x==="logarithmic")&&c<25&&(w*=Math.max(10,c)/25);var E=a>0?1+w:1/(1+w),k=this.grapher.scaleAxis,S=k==="x"||k==="both"||!k?E:1,T=k==="y"||k==="both"||!k?E:1;let V=Wa.scaleAtPoint(g,S,T),O=this.getTransformedViewport(V);a==-1&&this.tooBig(O)||(this.transformViewport(V),this.grapher.debounceUserRequestedViewportChange())};this.$.mousewheel(o)}applyPanTouchChanges(e,r){if(!this.isViewportLocked()&&!this.isScalingEnabled){var i=sc(r[0].x-e[0].x,r[0].y-e[0].y);this.transformViewport(Wa.translate(i)),this.grapher.debounceUserRequestedViewportChange()}}chooseDragScaleCenter(){var e=this.getProjection(),r=e.pixelCoordinates,i=e.mathToPixels.mapX(0),n=e.mathToPixels.mapY(0);return i=Math.min(Math.max(r.left,i),r.right),n=Math.min(Math.max(r.top,n),r.bottom),sc(i,n)}applyScaleTouchChanges(e,r){if(this.isViewportLocked())return;var i=this.grapher.scaleAxis,n,o;if(e.length===2&&r.length===2)n=yM(e[0],e[1]),o=yM(r[0],r[1]);else if(r.length===1){var s=this.chooseDragScaleCenter();n=OR(s,e[0]),o=OR(s,r[0])}else return;var a=o.radius/n.radius,l=i==="y"?1:a,c=i==="x"?1:a,d=Wa.scaleAtPoint(n.center,l,c).translate(n.center,o.center);let u=this.getTransformedViewport(d);a<1&&this.tooBig(u)||(this.transformViewport(d),this.grapher.debounceUserRequestedViewportChange())}addTouchEventHandler(){var e=[],r=!1,i=!0,n=!0,o=g=>{r||this.isViewportLocked()||(this.updateMouse(g),this.isScalingEnabled&&this.updateScaleAxis())};I(window).on("mousemove.viewportcontroller-"+this.id,o),this.beginPanning=g=>{var b=this.getProjection();if(!this.isViewportLocked()&&!r&&g.touches.length===g.changedTouches.length){r=!0,this.grapher.isDragging=!0,this.updateMouse(g);var x=b.mathToPixels.mapPoint(sc(0,0)),w=this.grapher.scaleAxis;(w==="x"||w==="both")&&(i=this.mousePt.x>x.x),(w==="y"||w==="both")&&(n=this.mousePt.y>x.y),this.controller.dispatch({type:"grapher/drag-start"}),I(document).on("dcg-tapmove.graphdrag",u),I(document).on("dcg-tapstart.graphdrag dcg-tapend.graphdrag dcg-tapcancel.graphdrag",p)}};var s=g=>{if(!(g.length<2)){var b=this.grapher.getProjection(),x=b.pixelCoordinates,w=b.mathToPixels.mapX(0),E=b.mathToPixels.mapY(0),k=40;w=Math.min(Math.max(x.left,w),x.right),E=Math.min(Math.max(x.top,E),x.bottom);var S=g[1].x-g[0].x,T=g[1].y-g[0].y;return Math.abs(g[0].x-w)<k&&Math.abs(g[1].x-w)<k&&Math.abs(T)>3*Math.abs(S)&&b.settings.showYAxis?"y":Math.abs(g[0].y-E)<k&&Math.abs(g[1].y-E)<k&&Math.abs(S)>3*Math.abs(T)&&b.settings.showXAxis?"x":"both"}},a=g=>(this.grapher.scaleAxis||(this.grapher.scaleAxis=s(g)),this.grapher.scaleAxis),l=()=>{this.grapher.scaleAxis&&(this.grapher.scaleAxis=void 0,this.grapher.redrawAllLayers(),this.updateCursor())},c=()=>{this.isScalingEnabled=!1,this.preventScrollZoom=!0,l()},d=g=>g.altKey||g.ctrlKey||g.metaKey,u=g=>{if(r&&!this.isViewportLocked()){var b=_R(g.touches,this.$.offset());if(e.length===2&&b.length===2)a(b),this.applyScaleTouchChanges(e,b);else if(e.length===1&&this.isScalingEnabled){this.updateMouse(g);var x=this.grapher.scaleAxis,w=this.getProjection(),E=w.mathToPixels.mapPoint(sc(0,0)),k,S,T=5,V=i?1:-1,O=n?1:-1;if((x==="x"||x==="both")&&(k=this.mousePt.x>E.x+T*V),(x==="y"||x==="both")&&(S=this.mousePt.y>E.y+T*O),x==="x"&&i!==k||x==="y"&&n!==S||x==="both"&&i!==k&&n!==S)return;this.applyScaleTouchChanges(e,b)}else l();e.length===1&&this.applyPanTouchChanges(e,b),this.controller.dispatch({type:"grapher/drag-move"}),e=b}},p=g=>{r&&(this.cancelAnimation(),e=_R(g.touches,this.$.offset()),g.touches.length===0&&(r=!1,this.grapher.isDragging=!1,I(document).off(".graphdrag"),this.grapher.debounceUserRequestedViewportChange(),this.controller.dispatch({type:"grapher/drag-end"})),(g.touches.length===0||g.touches.length===1&&!this.isScalingEnabled)&&l())};I(window).on("keydown.viewportcontroller-"+this.id,g=>{this.controller.isGeoToolActive()||this.isViewportLocked()||(Te(g)===Rf&&!d(g)&&this.shouldAllowShiftScaling()?(this.isScalingEnabled=!0,this.grapher.scaleAxis||this.updateScaleAxis()):c())}),I(window).on("keyup.viewportcontroller-"+this.id+" blur.viewportcontroller-"+this.id,c)}shouldAllowShiftScaling(){return!this.controller.isGeometry()}zoom(e){var r=this.getProjection().pixelCoordinates;if(e==="in")this.animateToViewport(this.getTransformedViewport(Wa.scaleAtPoint(FR(r),2))),me(this.s("graphing-calculator-narration-viewport-zoom-in"));else if(e==="out"){let n=this.getTransformedViewport(Wa.scaleAtPoint(FR(r),.5));this.tooBig(n)||this.animateToViewport(n),me(this.s("graphing-calculator-narration-viewport-zoom-out"))}else if(e==="square"){var i=this.getSquareViewport();this.getProjection().settings.setProperty("squareAxes",!0),this.animateToViewport(i),me(this.s("graphing-calculator-narration-viewport-zoom-square"))}else e==="default"&&this.setDefaultViewport()}tooBig(e){let r=this.getProjection(),{xAxisScale:i,yAxisScale:n}=r.settings,{xmin:o,xmax:s,ymin:a,ymax:l}=e;return i==="logarithmic"&&kD(s)-kD(o)>60||n==="logarithmic"&&kD(l)-kD(a)>60}zoomSquareImmediately(){this.setViewport(this.getSquareViewport())}zoomCustom(e){this.animateToViewport(e),me(this.s("graphing-calculator-narration-viewport-updated"))}setDefaultViewport(){let e=this.controller.getDefaultViewport();this.animateToViewport(e),me(this.s("graphing-calculator-narration-viewport-default"))}isDefaultViewportRestored(){let e=this.getProjection(),{xAxisScale:r,yAxisScale:i}=e.settings,n=r==="linear",o=i==="linear",s=e.viewport,a=this.controller.getDefaultViewport(),l=n?s.xmax-s.xmin:Math.log(s.xmax/s.xmin),c=o?s.ymax-s.ymin:Math.log(s.ymax/s.ymin),d=n?s.xmin-a.xmin:Math.log(s.xmin/a.xmin),u=n?s.xmax-a.xmax:Math.log(s.xmax/a.xmax),p=o?s.ymin-a.ymin:Math.log(s.ymin/a.ymin),g=o?s.ymax-a.ymax:Math.log(s.ymax/a.ymax),b=.025;return Math.abs(d/l)<b&&Math.abs(u/l)<b&&Math.abs(p/c)<b&&Math.abs(g/c)<b}getSquareViewport(){let e=this.getProjection();return e.settings.lastChangedAxis==="y"?e.viewport.squareXAxis(e.screen,e.settings):e.viewport.squareYAxis(e.screen,e.settings)}};var ip=__dcg_shared_module_exports__['i'](Z());Oe();var nd=class{constructor(e,r){this.width=e,this.height=r}};var VD=class{constructor(e,r){this.color="#000000",this.style="normal",this.showPOI=!1,this.showHighlight=!1,this.selected=!1,this.tokenHovered=!1,this.tokenSelected=!1,this.labels=[],this.id=e,this.branches=r!==void 0?r:[],this.getPOI().forEach(i=>{i.type===1008&&this.labels.push({type:"poi",poi:i})}),r.forEach((i,n)=>{if(i.graphMode===22){if(i.objectType===17){let o=new zd(0,0,1008,this,n,0,!1);this.labels.push({id:"label-"+e+"-"+(i.listIndex||0),type:"segment",poi:o,segments:i.segments[0],text:i.labels&&i.labels[0]||""})}else if(i.objectType===16){let o=new zd(0,0,1008,this,n,0,!1);this.labels.push({id:"label-"+e+"-"+(i.listIndex||0),type:"polygon",poi:o,segments:i.segments[0],text:i.labels&&i.labels[0]||""})}else if(i.objectType===23){let o=new zd(0,0,1008,this,n,0,!1);this.labels.push({id:"label-"+e+"-"+(i.listIndex||0),type:"angle",poi:o,segments:i.segments[0],text:i.labels&&i.labels[0]||""})}}})}getPOI(){if(this.__cachedPOI)return this.__cachedPOI;this.__cachedPOI=[],this.__cachedPOIIds={};for(let e=0;e<this.branches.length;e++){let r=this.branches[e];if(r.graphMode===1||r.graphMode===2){let i=r.poi;i.zeros&&this._pushPOI(i.zeros,e,1002),i.intercept&&this._pushPOI(i.intercept,e,1003),i.extrema&&this._pushPOI(i.extrema,e,1004),i.intersections&&this._pushPOI(i.intersections,e,1001)}else if(r.graphMode===3||r.graphMode===4){let i=r.poi,n=r.graphMode===3&&r.interactiveLabel===!0;if(r.showLabel===!0||n){let o=r.nakedLabel;i.defined&&this._pushPOI(i.defined,e,1008,o)}else i.defined&&this._pushPOI(i.defined,e,1006)}}return this.__cachedPOI}getBranchPOI(e){return this.getPOI().filter(r=>r.branch===e)}getMovablePoints(){if(this.__cachedMovablePoints)return this.__cachedMovablePoints;this.__cachedMovablePoints=[];let e=this.branches[0];if(e&&e.segments.length===1&&e.graphMode===4){let r=e.segments[0];for(let i=0;i<r.length;i++){let n;e.tableId&&(n={tableId:e.tableId,columnId:this.id,rowIndex:e.movablePointInfo[i].index,dragX:e.movablePointInfo[i].dragX,dragY:e.movablePointInfo[i].dragY});let o=e.scaleFactors?e.scaleFactors[0][i]:void 0,s=n?n.rowIndex:i,a=e.segments.length===1&&e.labels&&e.labels[i]?e.labels[i]:void 0,l=e.hasOwnProperty("pointOpacity")?e.pointOpacity:1;this.__cachedMovablePoints.push({type:"movable-point",id:"movable:["+this.id+","+s+"]",sketch:this,color:this.color,pointOpacity:l,tableInfo:n,scaleFactor:o,x:r[i][0],y:r[i][1],label:a,ariaLabel:a&&Eo(a)})}}return this.__cachedMovablePoints}getMovablePointByIndex(e){return this.getMovablePoints()[e]}getStaticLabeledPoints(){if(this.__cachedStaticLabeledPoints)return this.__cachedStaticLabeledPoints;let e=this.branches[0];return this.__cachedStaticLabeledPoints=[],this.getPOI().forEach(r=>{if(r.type!==1006&&r.type!==1008||e.graphMode!==3)return;var i=e.showLabel;let n=r.getLabel();!i&&n===""||this.__cachedStaticLabeledPoints.push({type:"static-labeled-point",id:"static["+this.id+","+r.id+"]",x:r.x,y:r.y,sketch:r.sketch,label:n,ariaLabel:n!==""?Eo(n):void 0})}),this.__cachedStaticLabeledPoints}_pushPOI(e,r,i,n=!1){for(let o=0,s=e.x.length;o<s;o++){let a=new zd(e.x[o],e.y[o],i,this,r,o,n);e.intersects&&(a.intersects=e.intersects[o]),this.__cachedPOI.push(a),this.__cachedPOIIds[a.id]=a}}updateIntersections(e){for(let i=0,n=this.branches.length;i<n;i++){let o=this.branches[i];o.graphMode!==15&&o.graphMode!==22&&(o.poi.intersections=e[i])}let r=this.__cachedPOI;this.__cachedPOI=[],r.forEach(i=>{i.type!==1001?this.__cachedPOI.push(i):delete this.__cachedPOIIds[i.id]});for(let i=0;i<this.branches.length;i++){let n=this.branches[i];if(n.graphMode===1||n.graphMode===2){let o=n.poi;o.intersections&&this._pushPOI(o.intersections,i,1001)}}}getPOIById(e){return this.__cachedPOIIds[e]}updateFrom(e){if(!e)return;this.showPOI=e.showPOI,this.showHighlight=e.showHighlight,this.selected=e.selected,this.tokenSelected=e.tokenSelected,this.tokenHovered=e.tokenHovered;let r=this.branches[0].graphMode;if(r===3||r===4){let i=!0;for(let n=0;n<this.__cachedPOI.length;n++){let o=e.__cachedPOI[n],s=this.__cachedPOI[n];if(!o||o.type!==s.type){i=!1;break}}if(i)for(let n=0;n<this.__cachedPOI.length;n++){let o=e.__cachedPOI[n],s=this.__cachedPOI[n];delete this.__cachedPOIIds[s.id],this.__cachedPOIIds[o.id]=s,s.id=o.id}}}};var D6={};__dcg_shared_module_exports__['h'](D6,{default:()=>bM});var bM=__dcg_shared_module_exports__['j']("//tQxAAAAAAAAAAAAAAAAAAAAAAASW5mbwAAAA8AAAAIAAAHVwAgICAgICAgICAgICBAQEBAQEBAQEBAQEBgYGBgYGBgYGBgYGBggICAgICAgICAgICAoKCgoKCgoKCgoKCgoMDAwMDAwMDAwMDAwODg4ODg4ODg4ODg4OD///////////////8AAAA5TEFNRTMuOThyAaUAAAAALmcAABRAJAiwQgAAQAAAB1cctrbdAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP/7UMQAAAjsKyK0YYABp52xtx8wAgAgBd34IAhAgnsECEe7QIAAgsPxACDgcBAEHQfD/g+D4PggCAIf///ghLny4Pg+D5+sHz/wf+XPwfB8H3iMHwfwffUCYPvz/Y7Hg/H4/H4/H4HAwADcoDwAP7XfuAFtXrhzjsjOXP8iCYM4IBVoH2DGAhQR2hm5vikA2IVEPX9nQaITi6IiLCKX/fxcg/DdGmS5BP7fIGQ0hw7DQi5Q//8midImXygdJ0tlz/1NAgXIANV6MA2Vy2y27jv/+1LEBIALOHOTvGGAMXWhbnTxGZ+LOa2FNMsDtj9/jUmPqqqARrNvlVjDDoGZqq0T11A0DVqeEnlQk8q4sVEp0FcqdxLoEJ0RPYWvIlQkbGA0Anw6VJJgqRKw1NJaAXkR4ag0/FwCCABbbdbJA0fzVgdvgvu5Px6Rwiv3VllZVDREqmWntLyBDka3sz951iTve+ddHP0/M3P/+ydU4zbqOZOeop5jfu1kwk8VezPeGc1hRMbWrJNv6SO/fH0Mc15KYvKqAAAAdrdsrbBDuBpp4v/7UsQGgguVE2ekjNP5aSBo6YSNgKAQUoCZEBJK8q73G/nhJFFmLY5dNc4b7gjBRyEs5yjJokY9TBoU/pXQBglyNjeiA87V8vkzaw019YTu2fxY0t6gteLMI37f9fYw7UVnWoE4NJOSpQBu3GfVAIVACgw+IikZZAnB7UKlLGnha4PDbIhsBhk4RYmlE2hYZ8NrQ5HnyEUvZxDyVG1hM33ZZH0OlrJV5///3/51qTGtJgxhREVLEfoO1w6686eRAAAAUicksbA1qegZCe2AuEgJ//tSxAkCDF0XSaw8ailyn+l1h4w1BvVY04S56fYY5nGkBZHMGLBjHDUMlORG4wcCT9R6RB+3vM8jVMU1hmlOoXIOMKqotE2HxWYNJq/7EZ2l63NJ+Z2aTA4Yq+7t0PhOxCz9WP1mA3DJZZGDkRfq+qFAGwhwHUAVqBfDiMUlypaMWApR1VoWLChfUpJzkBDMCTf85UZr6jyHa1psZnTS5iKatTVKcX/Ker9zMvM1T0okGyiQcreJbU1tc+Yj/ms3395FBIADkjlkjbAZNdiwgRD/+1LEBwAL8Tdbp6Rh+XmT6XWHjCx5U4sTCtlUidNtS9I7oUx7oxdIZlOghkIQYzB0vxtMs6QgCg4WMVakQMM5HRfrsdIEftM0yfOHnNGkiPRMoWCKSsxsChat8/vYw4c4t+CMMB5AAAAXZrftWiEVdbSgnURZoWvK2KhK9GfCkIGnQKxIqbYJ0JCNFJ3St1wuUNRLW4Kw5VhLVGrmgYKhhRe1qzzC7SqFFyjJlIqXcPD6gw//epZ9bwQFw+s+rdVAFtzl0AAAA3I3JK0QJxtCHv/7UsQGAApAM0WssGFpSCKqNYMMvgZph6CwIhKEt0yEiMwFKpnDBBajVc5jbTM7KayRt3I43h8Ag05kd9AtqO0bItmf/+Aevzf7dx28sK0hvP//3/izNwf1pfEAgANutuOJACSqWvuW+SKNLQSpOQKsrX3XxnZxy2Rus0Q1irPy9Mkg4kZGJFRQUax4R+jsACwavqYd2bmRX/6VnKrLk2Z2VGYwQNCIEasJh7/oBScAAMtBNgBWssKw0uCAgKkVpJirpZyBklUCwqaSIkW6BgIY//tSxBIDSYw3Km0kSoEzi9KAliSw9QNAydBqoFQVEQNBwiJYiBWdDqxiwVBUGqg6JgaBoGj3//////huVcFQsIRoPjBXLBGA8AkCwOhcD4KAmFAtEYcR6E8gD2OAXJ2N//uSJVZVJNRdh0gkLCwuKioqz4sLC3//////4sLC31ioqKpAoqKirOgFqkxBTUUzLjk4LjKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqr/+1LEIwPAAAGkAAAAIAAANIAAAASqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqg==");Wl();var Jy=.075,wM=.0015,E6=125,k6=330,G6=2e3,vM=class{suspend(){return new Promise((e,r)=>{if(this.audioContext)this.audioContext.suspend().then(()=>{e()}).catch(i=>{Co(i),r(i)});else{e();return}})}getResumedAudioContext(){return new Promise((e,r)=>{if(!this.audioContext){let i=window.AudioContext||window.webkitAudioContext;if(!i){r();return}try{this.audioContext=new i({latencyHint:"interactive",sampleRate:44100})}catch(n){Co(n),r(n)}}this.audioContext&&(this.audioContext.state==="running"?this.loadPOI().then(()=>{e({audioContext:this.audioContext,poiBuffer:this.poiBuffer})}):this.audioContext.resume().then(()=>this.loadPOI()).then(()=>{e({audioContext:this.audioContext,poiBuffer:this.poiBuffer})}).catch(i=>{Co(i),r(i)}))})}loadPOI(){return new Promise((e,r)=>{if(!this.audioContext){r();return}if(this.poiBuffer){e();return}this.audioContext.decodeAudioData(bM.buffer.slice(0)).then(i=>{this.poiBuffer=i,e()}).catch(i=>{Co(i),r()})})}},Yy=class{constructor({controller:e,audioPointMove:r,animationFinished:i,audioEnabled:n}){this.controller=e,this.audioSpeed=50,this.audioVolume=.5,this.audioPointMove=r,this.animationFinished=i,this.audioEnabled=n,this.audioContextManager=new vM}releaseAudio(){this.playbackSupported&&(this.stop(),this.audioContextManager.suspend())}prepareAudio(){this.audioContextManager.getResumedAudioContext().then(()=>{this.playbackSupported=!0}).catch(()=>{this.playbackSupported=!1})}stop(){this.playTimeout&&(cancelAnimationFrame(this.playTimeout),this.playTimeout=void 0),this.bufferSource&&(this.bufferSource.stop(),this.bufferSource.disconnect(),this.bufferSource=void 0),this.animationFinished()}isAnimating(){return this.playTimeout!==void 0}getAudioSpeed(){return this.audioSpeed}setAudioSpeed(e){this.audioSpeed=e}getAudioVolume(){return this.audioVolume}setAudioVolume(e){this.audioVolume=e,this.gainMaster!==void 0&&(this.gainMaster.gain.value=this.audioVolume)}getPlaybackSupported(){return this.playbackSupported}playBranchByIndex(e,r,i){!this.audioEnabled()||r<0||r>=e.branches.length||this.isAnimating()||ac(e.branches[r])&&this.playBranch(e.branches[r],r,i).then(()=>{this.stop()})}playSketch(e,r){if(!this.audioEnabled())return;let i=e.branches;if(i.length===0)return;let n=-1,o=()=>{for(n+=1;n<i.length&&!ac(i[n]);)n+=1;n<i.length?this.playBranch(i[n],n,r).then(()=>{o()}):this.stop()};o()}playPoint(e,r){!this.audioEnabled()||!A6(e)||this.audioContextManager.getResumedAudioContext().then(i=>{let{audioContext:n,poiBuffer:o}=i,s=n.sampleRate,a=s*Jy,l=n.createBuffer(2,a,s),c=this.audioSpeed/10;O6(l,e,r,o,c),this.connectBuffer(l,n)})}connectBuffer(e,r){if(!this.audioEnabled()||!r)return;this.gainMaster=r.createGain(),this.gainMaster.connect(r.destination),this.gainMaster.gain.value=this.audioVolume;let i=r.createBufferSource();this.bufferSource=i,i.buffer=e,i.connect(this.gainMaster),i.start()}playBranch(e,r,i){return new Promise((n,o)=>{if(!this.audioEnabled()){o();return}this.audioContextManager.getResumedAudioContext().then(s=>{let{viewport:a}=i,{audioContext:l,poiBuffer:c}=s,d=this.audioSpeed/10,u=F6(e,i,d);if(!u.segments.length){o();return}let p=DM(a,u.graphMode),{independentMin:g,independentMax:b}=UR(u),x=u.graphMode===1?i.settings.yAxisScale:i.settings.xAxisScale,w=u.graphMode===1?i.settings.xAxisScale:i.settings.yAxisScale,E=__dcg_shared_module_exports__['yc'](x,[p.independentMin,p.independentMax],[0,d]),k=__dcg_shared_module_exports__['zc'](E,b)-__dcg_shared_module_exports__['zc'](E,g),S=l.sampleRate,T=Math.floor(S*k),V=l.createBuffer(2,T,S);qR(V,u,i,x,w,c),this.connectBuffer(V,l);let O=l.currentTime,y=()=>{if(this.playTimeout!==void 0&&cancelAnimationFrame(this.playTimeout),l.state!=="running"){o();return}let P=l.currentTime-O,K=__dcg_shared_module_exports__['Ac'](x,g,b,P/k);if(this.audioPointMove(r,K),P<k)this.playTimeout=requestAnimationFrame(y);else{n();return}};y(),this.controller.dispatch({type:"render"})}).catch(()=>{o()})})}};function V6(){return{amplitude:0,phase:0,noiseVal:0,lowerOctaveGain:0,upperOctaveGain:0}}function RR(t,e,{independentMin:r,independentMax:i},n){if(t===1)return{left:1,right:1};let o=n(r,i),s=n(r,e),a=Math.abs(s/o);return isFinite(a)||(a=.5),a=Math.max(Math.min(a,1),0),{left:Math.cos(Math.PI/2*a),right:Math.sin(Math.PI/2*a)}}function I6(t,{independent:e,dependent:r},i,n,o){let{phase:s,noiseVal:a,lowerOctaveGain:l,upperOctaveGain:c}=t,d=0,u=0,p=0;return isFinite(i)?(s+=i/n,o<4*wM?(u=0,p=0):(u=.5,p=e>=0?.15:0),r<0&&(a=BR(a),d+=.1*a)):(a=BR(a),d+=.04*a),l+=(u-l)/(n*wM),c+=(p-c)/(n*wM),d+=l*NR(s)+c*NR(2*s),{amplitude:d,phase:s,noiseVal:a,lowerOctaveGain:l,upperOctaveGain:c}}function M6(t){return Math.min(Math.max(k6*Math.pow(2,t),E6),G6)}function NR(t){return .8782*(xM(t)+.25*xM(2*t)+.25*xM(3*t))}function xM(t){return Math.sin(2*Math.PI*t)}function BR(t){let e=Math.random()*2-1;return(t+.2*e)/1.02}function T6(t,e,r,i){let n=t.getChannelData(0),o=e.getChannelData(0),s=e.getChannelData(1);for(let a=0;a<n.length&&a+r<o.length;a++)o[a+r]+=n[a]*i.left,s[a+r]+=n[a]*i.right}function yl(t,e){if(t.isGeoUIActive()&&t.getAllToolPreviewItems().filter(i=>i.id===e.id).length>0)return!1;for(let r of e.branches)if(ac(r))return!0;return!1}function ac(t){switch(t.graphMode){case 1:case 2:case 3:case 4:return t.segments.length>0;default:return!1}}function KR(t){for(let e=0;e<t.branches.length;e++)if(ac(t.branches[e]))return e;return 0}function Xy(t,e){let r=0;for(let i=0;i<=e;i++)ac(t.branches[i])&&(r+=1);return r}function A6(t){switch(t.graphMode){case 1:case 2:case 3:case 4:return!0;default:return!1}}function DM(t,e){switch(e){case 2:case 3:case 4:return{independentMin:t.xmin,independentMax:t.xmax,dependentMin:t.ymin,dependentMax:t.ymax};case 1:return{independentMin:t.ymin,independentMax:t.ymax,dependentMin:t.xmin,dependentMax:t.xmax};default:throw SM(e)}}function UR(t){let e=t.segments[0],r=t.segments[t.segments.length-1];return{independentMin:e[0],independentMax:r[r.length-2]}}function L6(t){switch(t.graphMode){case 2:case 3:case 4:return{independent:t.x,dependent:t.y};case 1:return{independent:t.y,dependent:t.x};default:throw SM(t.graphMode)}}function P6(t,e){if(t===1)return e.y;if(t===2)return e.x;throw SM(t)}function SM(t){return`Unexpected graph mode. Received ${t}`}function qR(t,e,r,i,n,o){let{viewport:s}=r,a=t.sampleRate,l=t.getChannelData(0),c=t.getChannelData(1),d=e.graphMode,{dependentMin:u,dependentMax:p}=DM(s,d),{independentMin:g,independentMax:b}=UR(e),x=0,w=0,E=l.length-1,k=E/a,S=V6(),T=__dcg_shared_module_exports__['yc'](i,[g,b],[0,k]);function V(y,L){return __dcg_shared_module_exports__['zc'](T,L)-__dcg_shared_module_exports__['zc'](T,y)}let O=__dcg_shared_module_exports__['yc'](n,[u,p],[0,1]);for(let y=0;y<l.length;y++){let L=__dcg_shared_module_exports__['Ac'](i,g,b,y/E),P=RR(d,L,{independentMin:g,independentMax:b},V);for(;x<e.segments.length&&e.segments[x][w]<L;)w+=2,w>=e.segments[x].length&&(x+=1,w=0);let K=e.segments[x],$=NaN,U=NaN;if(K&&K.length>2&&w-2>=0&&w+1<K.length){let R=K[K.length-2];U=V(L,R);let q=K[w-2],_=K[w-1],A=K[w],z=K[w+1],Q=V(q,A),fe=V(q,L);$=__dcg_shared_module_exports__['Ac'](n,_,z,fe/Q)}let J=NaN;u<=$&&$<=p&&(J=M6(__dcg_shared_module_exports__['zc'](O,$))),S=I6(S,{independent:L,dependent:$},J,a,U),l[y]+=S.amplitude*P.left,c[y]+=S.amplitude*P.right}if(o&&e.poi&&e.poi.intersections){let y=P6(d,e.poi.intersections);for(let L of y){let P=V(g,b),K=V(g,L),$=Math.round(K/P*E);T6(o,t,$,RR(d,L,{independentMin:g,independentMax:b},V))}}}function O6(t,e,r,i,n){let o=R6(e,r,n),s=e.graphMode===1?r.settings.yAxisScale:r.settings.xAxisScale,a=e.graphMode===1?r.settings.xAxisScale:r.settings.yAxisScale;qR(t,o,r,s,a,i)}function _6(t,e){return t[0]-e[0]}function CM(t,e,r){let i=Nd(t,e.mathToPixels,r),n=Ly(i,{xmin:0,xmax:e.screen.width,ymin:0,ymax:e.screen.height}),o=e.pixelsToMath;return r===Bg&&(o=new __dcg_shared_module_exports__['Ec'](o.yScale,o.xScale)),Nd(n,o,r)}function F6(t,e,r){switch(t.graphMode){case 2:case 1:{let i=[];for(let n of t.segments){let o=t.graphMode===2?zh:Bg,s=CM(n,e,o);s.length>2&&i.push(s)}return{graphMode:t.graphMode,segments:i,poi:t.poi}}case 3:case 4:{let i=t.segments[0].slice();i.sort(_6);let n=[],o=e.settings,{xmin:s,xmax:a}=e.viewport,l=__dcg_shared_module_exports__['yc'](o.xAxisScale,[s,a],[0,r]),c=__dcg_shared_module_exports__['Bc'](l);for(let d=0;d<i.length;d++){let u=i[d],p=d>0?i[d-1][0]:-1/0,g=d<i.length-1?i[i.length-1][0]:1/0,b=__dcg_shared_module_exports__['zc'](l,u[0]),x=Math.max(__dcg_shared_module_exports__['zc'](c,b-.5*Jy),.5*(u[0]+p)),w=Math.min(__dcg_shared_module_exports__['zc'](c,b+.5*Jy),.5*(u[0]+g)),E=[x,u[1],w,u[1]],S=CM(E,e,zh);S.length>2&&n.push(S)}return{graphMode:2,segments:n}}default:throw new Error(`Unimplemented graph mode: ${t.graphMode}`)}}function R6(t,e,r){let{viewport:i}=e,n=DM(i,t.graphMode),{independentMin:o,independentMax:s}=n,{independent:a,dependent:l}=L6(t),c=t.graphMode===1?e.settings.yAxisScale:e.settings.xAxisScale,d=t.graphMode===1?Bg:zh,u=__dcg_shared_module_exports__['yc'](c,[o,s],[0,r]),p=__dcg_shared_module_exports__['Bc'](u),g=__dcg_shared_module_exports__['zc'](u,a),b=__dcg_shared_module_exports__['zc'](p,g-.5*Jy),x=__dcg_shared_module_exports__['zc'](p,g+.5*Jy),E=CM([b,l,x,l],e,d),S={graphMode:t.graphMode===1?1:2,segments:[E]};return t.intersects!==void 0&&(S.poi={intersections:{x:[t.x],y:[t.y]}}),S}function N6(t,e,r){return{x:t.x,y:t.y,branch:t.branch,reportedBranch:r,type:t.type,graphMode:e,intersects:t.intersects}}var nm=101,Qy=class{constructor(e,r,i){this.grapher=i,this.controller=e,this.audiograph=r,this.reset()}reset(){this.currentPoint=void 0,this.resetToFirstBranch(),this.sampledPoints=[],this.pois=[],this.independent=0}resetToFirstBranch(){let e=this.getCurrentSketch();this.branch=e?KR(e):0}getBranchPoints(e){let r=[];if(e>=0)for(let i of this.getSampledPoints())i.branch===e&&r.push(i);return r}resetTracePoint(){this.drawTrace(this.getCurrentPoint())}drawTrace(e){let r=this.getCurrentSketch();if(!e||!r)return;let i=r.branches[this.branch];if(!i||i.graphMode===3)return;let o={x:e.x,y:e.y},s={branchInfo:{branch:e.branch,id:r.id,sketch:r},pt:o};__dcg_shared_module_exports__['F'](s,this.grapher.traceLayer.getTraceInfo())||(this.grapher.traceLayer.setTraceInfo(s),this.grapher.redrawAllLayers())}moveToOrigin(){let e=this.getCurrentSketch();if(!e||!yl(this.controller,e))return;let r=e.branches[this.branch];if(!ac(r))return;let i=r.graphMode;if(i===2)this.setIndependent("x",0);else if(i===1)this.setIndependent("y",0);else if(i===3){let n=this.getSortedPOI()[0];this.setIndependent("x",n?n.x:0)}}getCurrentSketch(){let e,r=this.getSelectedItem();if(r){let i=this.audiograph.getFocusedCell();if(r.type==="table"){if(i&&(e=this.getGraphSketchForTableCell(r,i)),!e){for(let n of r.columnModels)if(e=this.grapher.getGraphSketch(n.id),e!==void 0)break}}else e=this.grapher.getGraphSketch(r.id)}return e}getFirstTraceableSketch(e){let r,i=this.controller.getItemCount(),n=this.controller.shouldAudioTraceReverseExpressions();for(let o=0;o<i;o++){let s=n?i-1-o:o,a=this.controller.getItemModelByIndex(s);if(a&&this.canTrace(a)){let l=n?this.prevTableColumn(a):this.nextTableColumn(a);if(l?(this.audiograph.setFocusedCell(l),r=this.getGraphSketchForTableCell(a,l)):r=this.grapher.getGraphSketch(a.id),r){e&&e.selectAssociatedExpression&&this.controller.dispatch({type:"set-selected-index",index:s});break}}}return r}canTrace(e){if(e.type==="image")return!1;if("shouldGraph"in e){let r=this.grapher.getGraphSketch(e.id);return r?yl(this.controller,r):!1}return!1}getTraceableExpressionCount(){let e=0,r=this.controller.getItemCount();for(let i=0;i<r;i++){let n=this.controller.getItemModelByIndex(i);n&&this.canTrace(n)&&e++}return e}computeStepSizes(){let e=this.grapher.getProjection().viewport;if(!e)return;let r=e.xmin,i=e.xmax,n=e.ymin,o=e.ymax,s=this.getCurrentSketch();if(!s||!yl(this.controller,s))return;let a=s.branches[this.branch];if(!ac(a))return;let l=a.graphMode;if(l===2)this.independent<r?this.independent=r:this.independent>i&&(this.independent=i);else if(l===1)this.independent<n?this.independent=n:this.independent>o&&(this.independent=o);else if(l===3){let c,d;this.independent<r?(d=this.getSortedPOI()[0],this.independent=d&&d.x!==void 0?d.x:0):this.independent>i&&(c=this.getSortedPOI(),d=c[c.length-1],this.independent=d&&d.x!==void 0?d.x:0)}}getPoint(e,r){let i,n=this.getCurrentSketch();if(!n||!yl(this.controller,n))return i;let o,s,a,l=0,c=n.branches[e];if(!c)return;let d=Xy(n,e);"compiled"in c&&c.compiled&&(a=c.compiled.fn),s=c.graphMode;let u=this.grapher.getProjection(),{mathToPixels:p,pixelsToMath:g,screen:b}=u;if(s===2){let x=g.mapX(p.mapX(r)+b.width/(nm-1));o=this.getInterveningPOIs(r,x,e,s)[0],(!o||o.x!==r||o.branch!==e)&&(o=void 0,l=a?a(r):0),o?i={x:o.x,y:o.y,type:o.type,typeChain:o.typeChain,branch:o.branch,reportedBranch:d,graphMode:s,intersects:o.intersects}:a&&(i={x:r,y:l,branch:e,reportedBranch:d,graphMode:s})}else if(s===1){let x=g.mapY(p.mapY(r)-b.height/(nm-1));o=this.getInterveningPOIs(r,x,e,s)[0],(!o||o.y!==r||o.branch!==e)&&(o=void 0,l=a?a(r):0),o?i={x:o.x,y:o.y,type:o.type,typeChain:o.typeChain,branch:o.branch,reportedBranch:d,graphMode:s,intersects:o.intersects}:a&&(i={y:r,x:l,branch:e,reportedBranch:d,graphMode:s})}else if(s===3){let x=g.mapX(p.mapX(r)+b.width/(nm-1));o=this.getInterveningPOIs(r,x,e,s)[0],o&&o.x===r&&o.branch===e?i={x:o.x,y:o.y,type:o.type,typeChain:o.typeChain,branch:o.branch,reportedBranch:d,graphMode:s,intersects:o.intersects}:i={x:r,y:NaN,branch:e,reportedBranch:d,graphMode:s}}return i}getSampledPoints(){return this.sampledPoints.length===0&&this.updateSampledPoints(),this.sampledPoints}updateSampledPoints(){let e=this.getCurrentSketch();if(!e||!yl(this.controller,e))return;let r=[],i=this.grapher.getProjection(),n=i.viewport;for(let o=0;o<e.branches.length;o++){let s=e.branches[o];if(!ac(s))continue;let a=s.graphMode,l=0,c=0,d=[],u;if(a===2||a===3)l=n.xmin,c=n.xmax,u=(p,g,b)=>i.mathToPixels.interpolateX(p,g,b);else if(a===1)l=n.ymin,c=n.ymax,u=(p,g,b)=>i.mathToPixels.interpolateY(p,g,b);else continue;for(let p=0;p<nm;p++){let g=u(l,c,p/(nm-1)),b=__dcg_shared_module_exports__['Bb'](g).value,x=u(l,c,(p+1)/(nm-1)),w=__dcg_shared_module_exports__['Bb'](x).value,E=this.getInterveningPOIs(b,w,o,a);if(E.length>0)d.push.apply(d,E);else{let k=this.getPoint(o,b);k&&d.push(k)}}r.push.apply(r,this.removeDuplicates(d,a))}this.sampledPoints=r}getCurrentPoint(){return this.currentPoint||this.updateCurrentPoint(),this.currentPoint}updateCurrentPoint(e){if(e){this.currentPoint=e;let r=e.graphMode;r===2||r===3?this.independent=e.x!==void 0?e.x:0:r===1&&(this.independent=e.y!==void 0?e.y:0),this.branch=e.branch}else this.currentPoint=this.getPoint(this.branch,this.independent)}prevPoint(){this.moveToPoint(-1)}nextPoint(){this.moveToPoint(1)}firstPoint(){let e=this.getSampledPoints();e.length>0&&this.updateCurrentPoint(e[0])}lastPoint(){let e=this.getSampledPoints();e.length>0&&this.updateCurrentPoint(e[e.length-1])}moveToPoint(e){let r=this.getCurrentPoint();if(!r)return;if(r.graphMode===3){this.moveToPOI(e);return}let i=this.getSampledPoints(),n=this.getClosestPointIndexOnSameBranch(i,r);if(n!==-1){let o=n+e;o<=0?(o=0,Nt(this.controller.s("graphing-calculator-narration-audio-trace-first-point"))):o>=i.length-1&&(o=i.length-1,Nt(this.controller.s("graphing-calculator-narration-audio-trace-last-point")));let s=i[o];this.updateCurrentPoint(s)}}canMoveToPrevPoint(){let e=this.getCurrentPoint();if(!e)return!1;if(e.graphMode===3)return this.canMoveToPrevPOI();let r=this.getSampledPoints(),i=this.getClosestPointIndexOnSameBranch(r,e);return i!==-1&&i>0}canMoveToNextPoint(){let e=this.getCurrentPoint();if(!e)return!1;if(e.graphMode===3)return this.canMoveToNextPOI();let r=this.getSampledPoints(),i=this.getClosestPointIndexOnSameBranch(r,e);return i!==-1&&i<r.length-1}prevPOI(){this.moveToPOI(-1)}nextPOI(){this.moveToPOI(1)}getSortedPOI(){return(!this.pois||this.pois.length===0)&&this.updatePOI(),this.pois}updatePOI(){let e=[],r,i=[],n=this.getCurrentSketch();if(!(!n||!yl(this.controller,n))){for(let o=0;o<n.branches.length;o++){let s=n.branches[o];if(!s)continue;let a=Xy(n,o),l=s.graphMode;if(i=[],r=n.getBranchPOI(o),r.length>0){l===2||l===3?i=__dcg_shared_module_exports__['u'](r,"x"):l===1&&(i=__dcg_shared_module_exports__['u'](r,"y"));let c=[];for(let d of i)c.push(N6(d,l,a));e.push.apply(e,this.removeDuplicates(c,l))}}this.pois=e}}removeDuplicates(e,r){let i=[];for(let n of e){if(n=__dcg_shared_module_exports__['b']({},n),n.graphMode=r,i.length===0){i.push(n);continue}let o=i[i.length-1];__dcg_shared_module_exports__['Bb'](o.x).value===__dcg_shared_module_exports__['Bb'](n.x).value&&__dcg_shared_module_exports__['Bb'](o.y).value===__dcg_shared_module_exports__['Bb'](n.y).value&&o.branch===n.branch?(o.typeChain||(o.typeChain=o.type!==void 0?[o.type]:[]),n.type!==void 0&&o.typeChain.indexOf(n.type)===-1&&o.typeChain.push(n.type),n.type===1001&&n.intersects&&o.intersects===void 0&&(o.intersects=n.intersects)):i.push(n)}return i}getInterveningPOIs(e,r,i,n){let o=[],s=this.getSortedPOI(),a=NaN;for(let l of s)l&&((n===2||n===3)&&!isNaN(l.x)?a=l.x:n===1&&!isNaN(l.y)&&(a=l.y),l.branch===i&&!isNaN(a)&&(e<=a&&a<r||r<=a&&a<e)&&o.push(l));return e>r?o.reverse():o}setIndependent(e,r){let i=this.getSampledPoints();for(let o of i)if(o&&o.hasOwnProperty(e)&&o[e]===r){if(e==="x"){this.independent=o.x!==void 0?o.x:0,this.updateCurrentPoint();return}else if(e==="y"){this.independent=o.y!==void 0?o.y:0,this.updateCurrentPoint();return}}let n=!0;if(i.length>0){let o=Math.floor((i.length-1)/2),s=i[o];s&&(e==="x"?(this.independent=s.x!==void 0?s.x:0,n=!1):e==="y"&&(this.independent=s.y!==void 0?s.y:0,n=!1))}n&&(this.independent=0),this.resetToFirstBranch(),this.updateCurrentPoint()}moveToPOI(e){if(!this.getCurrentPoint())return;let i=this.getSampledPoints(),n=this.getPOIIndexByDirection(e);n===-1?Nt(this.controller.s("graphing-calculator-narration-audio-trace-no-more-pois")):this.updateCurrentPoint(i[n])}getPOIIndexByDirection(e){let r=this.getCurrentPoint();if(!r)return-1;let i=this.getSampledPoints(),n=this.getClosestPointIndexOnSameBranch(i,r),o=-1;if(n!==-1){let s=r.graphMode,a=e===1?i.length-1:0;for(let l=n;l!==a+e;l+=e){let c=i[l];if(((s===2||s===3)&&r.x!==c.x||s===1&&r.y!==c.y)&&c.type!==void 0){o=l;break}}}return o}canMoveToPrevPOI(){return this.getPOIIndexByDirection(-1)!==-1}canMoveToNextPOI(){return this.getPOIIndexByDirection(1)!==-1}getClosestPointIndexOnSameBranch(e,r){let i=-1,n=1/0;if(e.length>0&&r){let o=r.graphMode;for(let s=0;s<e.length;s++){let a=e[s];if(r.branch!==a.branch)continue;let l;o===2||o===3?l=Math.abs(a.x-r.x):l=Math.abs(a.y-r.y),l<n&&(i=s,n=l)}}return i}prevCurve(){this.controller.shouldAudioTraceReverseExpressions()?this.curveDown():this.curveUp()}nextCurve(){this.controller.shouldAudioTraceReverseExpressions()?this.curveUp():this.curveDown()}curveUp(){let e=this.getSelectedItem();if(!e)return;let r=this.prevTableColumn(e);if(r)this.audiograph.setFocusedCell(r);else{let i=e.index,n=this.findPrevTraceableIndex({index:i,focusTableCell:!0});if(n!==-1){let o=this.controller.getItemModelByIndex(n);o&&this.controller.dispatch({type:"set-selected-id",id:o.id})}}(r||this.getSelectedItem()!==e)&&this.audiograph.enterAudioTrace()}curveDown(){let e=this.getSelectedItem();if(!e)return;let r=this.nextTableColumn(e);if(r)this.audiograph.setFocusedCell(r);else{let i=e.index,n=this.findNextTraceableIndex({index:i,focusTableCell:!0});if(n!==-1){let o=this.controller.getItemModelByIndex(n);o&&this.controller.dispatch({type:"set-selected-id",id:o.id})}}(r||this.getSelectedItem()!==e)&&this.audiograph.enterAudioTrace()}canMoveToPrevCurve(){let e=this.getSelectedItem();return e?this.controller.shouldAudioTraceReverseExpressions()?this.findNextTraceableIndex({index:e.index,focusTableCell:!1})!==-1:this.findPrevTraceableIndex({index:e.index,focusTableCell:!1})!==-1:!1}canMoveToNextCurve(){let e=this.getSelectedItem();return e?this.controller.shouldAudioTraceReverseExpressions()?this.findPrevTraceableIndex({index:e.index,focusTableCell:!1})!==-1:this.findNextTraceableIndex({index:e.index,focusTableCell:!1})!==-1:!1}findPrevTraceableIndex(e){let r=e.index,i;do{r--,i=this.controller.getItemModelByIndex(r);let n=i&&this.prevTableColumn(i);if(n)return e.focusTableCell&&this.audiograph.setFocusedCell(n),r}while(i&&!this.canTrace(i));return i?r:-1}findNextTraceableIndex(e){let r=e.index,i;do{r++,i=this.controller.getItemModelByIndex(r);let n=i&&this.nextTableColumn(i);if(n)return e.focusTableCell&&this.audiograph.setFocusedCell(n),r}while(i&&!this.canTrace(i));return i?r:-1}prevTableColumn(e){return this.tableColumn(e,-1)}nextTableColumn(e){return this.tableColumn(e,1)}tableColumn(e,r){let i;if(e&&e.type==="table"){let n=this.audiograph.getFocusedCell(),o,s,a;r===-1?(o=n?Math.max(n.location.column-1,0):NaN,s=n&&n.tableId===e.id&&!isNaN(o)?o:e.columnModels.length-1,a=0):(o=n?Math.min(n.location.column+1,e.columnModels.length-1):NaN,s=n&&n.tableId===e.id&&!isNaN(o)?o:0,a=e.columnModels.length-1);let l=(a-s)/r;if(isFinite(l)&&l>=0)for(let c=s;c!==a;c+=r){let d=e.columnModels[c];if(d&&this.grapher.getGraphSketch(d.id)){i={tableId:e.id,location:{column:c,row:0}};break}}}return i}getGraphSketchForTableCell(e,r){if(!e||e.type!=="table"||!r)return;let i=e.columnModels[r.location.column];if(i)return this.grapher.getGraphSketch(i.id)}getSelectedItem(){let e=this.controller.getSelectedItem();if(e&&e.type==="folder"){var r=MI(e);return r===void 0?void 0:this.controller.getItemModel(r)}return e}};var Zy=[{speed:200,displayedSpeed:"1/4 x"},{speed:100,displayedSpeed:"1/2 x"},{speed:50,displayedSpeed:"1 x"},{speed:25,displayedSpeed:"2 x"},{speed:12.5,displayedSpeed:"4 x"}],eb=class{constructor(e,r){this.grapher=r,this.controller=e,this.audioTraceActive=!1,this.wasFocusInExpressionsView=!1,this.focusedCell=void 0,this.sliderTraceActive=!1,this.sliderIndex=0,this.sliderArray=[],this.lastSpokenBranch=1,this.agNavigator=new Qy(e,this,this.grapher),this.tonegen=new Yy({controller:e,audioPointMove:(i,n)=>{this.agNavigator.drawTrace(this.agNavigator.getPoint(i,n))},animationFinished:()=>{this.recomputePoints(),this.controller.runAfterDispatch(()=>{this.controller.dispatch({type:"render"})})},audioEnabled:()=>this.controller.getAudio()}),this.audioSpeedIndex=2,this.tonegen.releaseAudio()}remove(){}handleKeydown(e){let r=e.altKey||e.metaKey,i=e.altKey&&!e.metaKey&&!e.ctrlKey&&!e.shiftKey,n=e.ctrlKey&&!e.metaKey&&!e.altKey,o=Zr?n:r,s=o&&(e.which===61||e.which===187),a=o&&!e.shiftKey&&(e.which===173||e.which===189),l=o&&!e.shiftKey&&ei(e)==="0";i&&ei(e)==="S"?this.agNavigator.getSelectedItem()&&(this.audioTraceActive||this.isFocusInExpressionsView())&&(e.preventDefault(),e.stopPropagation(),this.describeCurve()):i&&ei(e)==="G"?(this.audioTraceActive||this.isFocusInExpressionsView())&&(e.preventDefault(),e.stopPropagation(),this.describeAxes()):i&&ei(e)==="T"?(e.preventDefault(),e.stopPropagation(),this.toggleAudioTrace()):s?(e.preventDefault(),e.stopPropagation(),this.zoom("in")):a?(e.preventDefault(),e.stopPropagation(),this.zoom("out")):l?(e.preventDefault(),e.stopPropagation(),this.setDefaultViewport()):this.audioTraceActive&&(this.sliderTraceActive?this.sliderTraceKeydown(e):this.audioTraceKeydown(e))}sliderTraceKeydown(e){let r=e.altKey||e.metaKey,i=!r&&!e.ctrlKey&&!e.shiftKey;i&&Te(e)===Rc||ei(e)==="J"?(e.preventDefault(),e.stopPropagation(),this.decrementSliderValue()):i&&Te(e)===Nc||ei(e)==="L"?(e.preventDefault(),e.stopPropagation(),this.incrementSliderValue()):i&&Te(e)===eg?(e.preventDefault(),e.stopPropagation(),this.decrementBigSliderValue()):i&&Te(e)===Zu?(e.preventDefault(),e.stopPropagation(),this.incrementBigSliderValue()):!r&&(Te(e)===Yn||!e.shiftKey&&Te(e)===Oa||ei(e)==="K")?(e.preventDefault(),e.stopPropagation(),this.nextSlider()):!r&&(Te(e)===Jn||e.shiftKey&&Te(e)===Oa||ei(e)==="I")?(e.preventDefault(),e.stopPropagation(),this.prevSlider()):i&&Te(e)===Vh||ei(e)==="U"?(e.preventDefault(),e.stopPropagation(),this.sliderMin()):i&&Te(e)===Gh||ei(e)==="N"?(e.preventDefault(),e.stopPropagation(),this.sliderMax()):(this.stopAnimations(),this.audioTraceKeydown(e))}audioTraceKeydown(e){let r=e.altKey||e.metaKey,i=r&&!e.ctrlKey&&!e.shiftKey,n=!r&&!e.ctrlKey&&!e.shiftKey,o=ei(e);if(Te(e)===Jn&&i)e.preventDefault(),e.stopPropagation(),Kn(),this.agNavigator.prevCurve();else if(Te(e)===Yn&&i)e.preventDefault(),e.stopPropagation(),Kn(),this.agNavigator.nextCurve();else if(n&&Te(e)===Rc||Te(e)===Jn||o==="J")e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"keypad/audio-trace",command:"previous-point"});else if(n&&Te(e)===Nc||Te(e)===Yn||o==="L")e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"keypad/audio-trace",command:"next-point"});else if(!r&&(Te(e)===eg||!e.shiftKey&&Te(e)===Oa||o==="I"))e.preventDefault(),e.stopPropagation(),this.reportAndMoveToNextPOI();else if(!r&&(Te(e)===Zu||e.shiftKey&&Te(e)===Oa||o==="K"))e.preventDefault(),e.stopPropagation(),this.reportAndMoveToPrevPOI();else if(n&&Te(e)===Vh||o==="U")e.preventDefault(),e.stopPropagation(),this.reportAndMoveToFirstPoint();else if(n&&Te(e)===Gh||o==="N")e.preventDefault(),e.stopPropagation(),this.reportAndMoveToLastPoint();else if(n&&o==="X")e.preventDefault(),e.stopPropagation(),this.reportX();else if(n&&o==="P")e.preventDefault(),e.stopPropagation(),this.reportPOICount();else if(n&&o==="Y")e.preventDefault(),e.stopPropagation(),this.reportY();else if(n&&o==="T")e.preventDefault(),e.stopPropagation(),this.reportType();else if(n&&o==="B")e.preventDefault(),e.stopPropagation(),this.reportBranch();else if(n&&o==="O")e.preventDefault(),e.stopPropagation(),this.reportAndMoveToOrigin();else if(n&&o==="H")e.preventDefault(),e.stopPropagation(),this.hearGraph();else if(n&&typeof o=="string"&&o>="0"&&o<="9"){if(e.preventDefault(),e.stopPropagation(),Kn(),!this.controller.getAudio()){me(this.controller.s("graphing-calculator-narration-audio-trace-sound-effects-disabled"));return}this.tonegen.stop();let s=this.agNavigator.getCurrentSketch();if(s){let a;e.which===48?a=9:a=e.which-49;let l=a,c=-1;for(let d=0;d<s.branches.length;d++)if(ac(s.branches[d])&&(l-=1),l<0){c=d;break}c>=0?this.tonegen.getPlaybackSupported()?this.tonegen.playBranchByIndex(s,c,this.grapher.getProjection()):me(this.controller.s("graphing-calculator-narration-audio-trace-unable-to-play")):me(this.controller.s("graphing-calculator-narration-audio-trace-branch-not-found",{branch:a+1}))}else me(this.controller.s("graphing-calculator-narration-audio-trace-description-no-curve-selected"))}else r&&typeof o=="string"&&o>="1"&&o<="5"?(e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"set-audio-trace-speed",speed:parseInt(o,10)-1})):!e.altKey&&!e.ctrlKey&&!e.metaKey&&o==="V"?(e.preventDefault(),e.stopPropagation(),this.controller.getAudio()?e.shiftKey?this.controller.dispatch({type:"keypad/audio-trace",command:"volume-down"}):this.controller.dispatch({type:"keypad/audio-trace",command:"volume-up"}):me(this.controller.s("graphing-calculator-narration-audio-trace-unable-to-play"))):n&&o==="A"?(e.preventDefault(),e.stopPropagation(),Kn(),this.queueAnimatingPoints(!0),me()):n&&o==="S"&&this.controller.isListEnabled()?(e.preventDefault(),e.stopPropagation(),this.toggleSliderTrace()):n&&o==="C"?(e.preventDefault(),e.stopPropagation(),this.reportColor()):n&&this.exitAudioTrace();this.controller.dispatch({type:"render"})}describeCurve(){Kn();let e=this.agNavigator.getCurrentSketch();if(!e){me(this.controller.s("graphing-calculator-narration-audio-trace-description-no-curve-selected"));return}Nt(this.controller.s("graphing-calculator-narration-audio-trace-description-color",{color:Rd(this.controller,e.color)}));let r=Xy(e,e.branches.length-1);r>1&&Nt(this.controller.s("graphing-calculator-narration-audio-trace-description-branch-count",{branches:r}));let i=!1,n=!1;for(let s of e.branches)if(r===1&&s.segments.length>0&&s.hasOwnProperty("operator")){if(s.graphMode===2){if(s.operator===">"||s.operator===">="){Nt(this.controller.s("graphing-calculator-narration-audio-trace-description-shading-above"));break}else if(s.operator==="<"||s.operator==="<="){Nt(this.controller.s("graphing-calculator-narration-audio-trace-description-shading-below"));break}}else if(s.graphMode===1){if(s.operator===">"||s.operator===">="){Nt(this.controller.s("graphing-calculator-narration-audio-trace-description-shading-right"));break}else if(s.operator==="<"||s.operator==="<="){Nt(this.controller.s("graphing-calculator-narration-audio-trace-description-shading-left"));break}}}else r>1&&(s.graphMode===2||s.graphMode===1?(s.operator==="<"||s.operator==="<="||s.operator===">"||s.operator===">=")&&(i=!0):s.graphMode===7&&(n=!0));i&&n&&Nt(this.controller.s("graphing-calculator-narration-audio-trace-description-shading-in-regions"));let o=e.getPOI();if(o.length>0){let s=[];for(let a of o)s[a.type]===void 0?s[a.type]=1:s[a.type]+=1;s.forEach((a,l)=>{l===1001?Nt(a===1?this.controller.s("graphing-calculator-narration-audio-trace-description-one-intersection"):this.controller.s("graphing-calculator-narration-audio-trace-description-multiple-intersections",{count:a})):l===1002?Nt(a===1?this.controller.s("graphing-calculator-narration-audio-trace-description-one-root"):this.controller.s("graphing-calculator-narration-audio-trace-description-multiple-roots",{count:a})):l===1003?Nt(a===1?this.controller.s("graphing-calculator-narration-audio-trace-description-one-intercept"):this.controller.s("graphing-calculator-narration-audio-trace-description-multiple-intercepts",{count:a})):l===1004?Nt(a===1?this.controller.s("graphing-calculator-narration-audio-trace-description-one-extremum"):this.controller.s("graphing-calculator-narration-audio-trace-description-multiple-extrema",{count:a})):l===1008&&Nt(a===1?this.controller.s("graphing-calculator-narration-audio-trace-description-one-label"):this.controller.s("graphing-calculator-narration-audio-trace-description-multiple-labels",{count:a}))})}me()}describeAxes(){Kn(),me(this.getAxesDescription())}getAxesDescription(){let{showGrid:e,showXAxis:r,xAxisNumbers:i,showYAxis:n,yAxisNumbers:o,xAxisLabel:s,yAxisLabel:a}=this.grapher.settings,l=this.grapher.getProjection(),c=l.viewport,d=[],u=fs(__dcg_shared_module_exports__['Bb'](c.xmin,Zp(l,c.xmin)).latex),p=fs(__dcg_shared_module_exports__['Bb'](c.xmax,Zp(l,c.xmax)).latex),g=fs(__dcg_shared_module_exports__['Bb'](c.ymin,mD(l,c.ymin)).latex),b=fs(__dcg_shared_module_exports__['Bb'](c.ymax,mD(l,c.ymax)).latex);r&&(i&&s!==""?d.push(this.controller.s("graphing-calculator-narration-audio-trace-description-visible-x-axis-range-and-label",{xmin:u,xmax:p,label:s})):i&&s===""?d.push(this.controller.s("graphing-calculator-narration-audio-trace-description-visible-x-axis-range",{xmin:u,xmax:p})):!i&&s!==""?d.push(this.controller.s("graphing-calculator-narration-audio-trace-description-visible-x-axis-and-label",{label:s})):!i&&s===""&&d.push(this.controller.s("graphing-calculator-narration-audio-trace-description-visible-x-axis"))),n&&(o&&a!==""?d.push(this.controller.s("graphing-calculator-narration-audio-trace-description-visible-y-axis-range-and-label",{ymin:g,ymax:b,label:a})):o&&a===""?d.push(this.controller.s("graphing-calculator-narration-audio-trace-description-visible-y-axis-range",{ymin:g,ymax:b})):!o&&a!==""?d.push(this.controller.s("graphing-calculator-narration-audio-trace-description-visible-y-axis-and-label",{label:a})):!o&&a===""&&d.push(this.controller.s("graphing-calculator-narration-audio-trace-description-visible-y-axis"))),!r&&!n&&d.push(this.controller.s("graphing-calculator-narration-audio-trace-description-no-visible-axes")),e&&d.push(this.controller.s("graphing-calculator-narration-audio-trace-description-visible-grid"));let x=this.grapher.graphSketches,w=0;for(let E in x)yl(this.controller,x[E])&&(w+=1);return d.push(this.controller.s("graphing-calculator-narration-audio-trace-traceable-curves",{sketchCount:new ks(w)})),d.join(" ")}queueCoordinates(e,r,i=!1){if(!this.grapher.getProjection().viewport||!e)return;let o=this.agNavigator.getCurrentSketch();(e.hasOwnProperty("branch")&&o&&o.branches.length>1&&this.lastSpokenBranch!==e.reportedBranch||r==="branch")&&typeof e.reportedBranch=="number"&&Nt(this.controller.s("graphing-calculator-narration-audio-trace-property-branch-number",{branch:e.reportedBranch})),this.lastSpokenBranch=e.reportedBranch?e.reportedBranch:e.branch+1,e.hasOwnProperty("type")&&!r?Nt(this.controller.s("graphing-calculator-narration-audio-trace-property-type-before-coordinates",{type:this.describePOI(e)})):r==="type"&&Nt(this.describePOI(e)),(!r||r==="x")&&Nt(Xi(this.controller,e.x)),(!r||r==="y")&&Nt(Qi(this.controller,e.y)),i&&me()}describePOI(e){if(e.typeChain){let r=[];for(let i=0;i<e.typeChain.length;i++)r.push(this.poiTypeToText(e,i));return r.join(", ")}else return this.poiTypeToText(e)}poiTypeToText(e,r){switch(r&&e.typeChain?e.typeChain[r]:e.type){case 1001:let n=this.getIntersectingCurves(e);return n!==""?this.controller.s("graphing-calculator-narration-audio-trace-point-type-intersection-with-curves",{curves:n}):this.controller.s("graphing-calculator-narration-audio-trace-point-type-intersection");case 1002:return this.controller.s("graphing-calculator-narration-audio-trace-point-type-root");case 1003:return this.controller.s("graphing-calculator-narration-audio-trace-point-type-intercept");case 1004:return this.controller.s("graphing-calculator-narration-audio-trace-point-type-extremum");case 1006:return this.controller.s("graphing-calculator-narration-audio-trace-point-type-definition");case 1007:return this.controller.s("graphing-calculator-narration-audio-trace-point-type-trace");case 1008:return this.controller.s("graphing-calculator-narration-audio-trace-point-type-label");default:return this.controller.s("graphing-calculator-narration-audio-trace-point-type-not-a-poi")}}getIntersectingCurves(e){return!e||!e.intersects?"":this.getExpressionAriaLabel(e.intersects)}getExpressionAriaLabel(e){let r=this.controller.getItemModel(e);return r?r.type==="expression"&&r.label?Eo(r.label):this.controller.isItemSecret(r.id)?this.controller.s("graphing-calculator-narration-audio-trace-secret-expression",{index:r.secretIndex}):r.type==="table"&&this.focusedCell?this.controller.s("graphing-calculator-narration-audio-trace-expression-with-column",{index:r.displayIndex,column:this.focusedCell.location.column+1}):this.controller.s("shared-calculator-narration-expression-index",{index:r.displayIndex}):""}exitAudioTrace(e){if(this.audioTraceActive){if(this.audioTraceActive=!1,this.controller.isKeypadEnabled()&&this.controller.dispatch({type:"keypad/123"}),e||(e=this.controller.s("graphing-calculator-text-audio-trace-off")),this.controller.dispatch({type:"toast/close"}),this.wasFocusInExpressionsView){let r=this.agNavigator.getSelectedItem();(!r||!this.controller.isItemSelectable(r.id))&&(r=this.controller.getFirstFullyVisibleItem()),r&&this.controller.isItemSelectable(r.id)&&this.controller.dispatch({type:"move-focus-to-item",id:r.id,where:r.type==="table"&&this.focusedCell!==void 0?__dcg_shared_module_exports__['b']({location:"cell"},this.focusedCell.location):"end"})}this.wasFocusInExpressionsView=!1,this.focusedCell=void 0,this.stopAnimations(),this.sliderTraceActive=!1,this.sliderIndex=0,this.tonegen.stop(),this.tonegen.releaseAudio(),this.agNavigator.reset(),this.lastSpokenBranch=1,this.grapher.traceLayer.setTraceInfo(void 0),this.grapher.redrawAllLayers(),me(e),this.resumeAnimations()}}isFocusInExpressionsView(){return!!this.controller.getFocusedItem()}canAudioTraceCurrentExp(){let e=this.agNavigator.getSelectedItem();return e?e.type==="table"?!!this.agNavigator.getCurrentSketch():this.agNavigator.canTrace(e):!1}enterAudioTrace(e){let r=this.agNavigator.getSelectedItem(),i=r&&r.type!=="table"&&!this.agNavigator.canTrace(r)?this.getExpressionAriaLabel(r.id):void 0,n=!1;this.audioTraceActive||(this.wasFocusInExpressionsView=this.isFocusInExpressionsView(),r&&i&&Nt(this.controller.s("graphing-calculator-narration-audio-trace-unsupported-expression",{expression:i})),n=!!i||!this.wasFocusInExpressionsView);let o;if(n)o=this.agNavigator.getFirstTraceableSketch({selectAssociatedExpression:!0});else if(!i){if(r&&r.type==="expression"&&r.formula&&r.formula.error)return this.exitAudioTrace(),this.controller.dispatch({type:"toast/show",toast:{message:this.controller.s("graphing-calculator-narration-audio-trace-description-no-curve-selected")}});if(r&&r.type==="table"){let a=Do(r);(!this.focusedCell||this.focusedCell.tableId!==r.id||a&&(a.column!==this.focusedCell.location.column||a.row!==this.focusedCell.location.row))&&(this.focusedCell=a!==void 0?{tableId:r.id,location:a}:void 0)}else this.focusedCell=void 0;o=this.agNavigator.getCurrentSketch()}if(!o)return this.agNavigator.reset(),this.lastSpokenBranch=1,this.exitAudioTrace(),this.controller.dispatch({type:"toast/show",toast:{message:this.controller.s("graphing-calculator-narration-audio-trace-description-no-curve-selected")}});let s=o.branches[0].graphMode;if(s===8)return this.exitAudioTrace(),this.controller.dispatch({type:"toast/show",toast:{message:this.controller.s("graphing-calculator-text-audio-trace-no-implicit-support")}});if(s===5)return this.exitAudioTrace(),this.controller.dispatch({type:"toast/show",toast:{message:this.controller.s("graphing-calculator-text-audio-trace-no-parametric-support")}});if(s===6)return this.exitAudioTrace(),this.controller.dispatch({type:"toast/show",toast:{message:this.controller.s("graphing-calculator-text-audio-trace-no-polar-support")}});this.agNavigator.reset(),this.agNavigator.computeStepSizes(),this.lastSpokenBranch=1,this.grapher.traceLayer.clearOpenedPOI(),this.grapher.redrawAllLayers(),this.audioTraceActive||(this.controller.isKeypadEnabled()||this.controller.dispatch({type:"toast/show",toast:{message:this.controller.s("graphing-calculator-text-audio-trace-on"),noAria:!0,onHide:()=>this.exitAudioTrace(),hideAfter:0}}),i&&o&&Nt(this.controller.s("graphing-calculator-narration-audio-trace-tracing-different-expression",{expression:this.getExpressionAriaLabel(o.id)})),Nt(this.controller.s("graphing-calculator-text-audio-trace-on")),this.controller.getAudio()||Nt(this.controller.s("graphing-calculator-narration-audio-trace-sound-effects-disabled")),this.pauseAnimations(),this.queueAnimatingPoints(!1),this.tonegen.prepareAudio(),(!e||!e.fromKeypad)&&(Nt(this.controller.s("graphing-calculator-narration-audio-trace-instructions-use-arrow-keys")),this.controller.getAudio()&&Nt(this.controller.s("graphing-calculator-narration-audio-trace-instructions-hear-graph")),this.agNavigator.getTraceableExpressionCount()>1&&(Zr?Nt(this.controller.s("graphing-calculator-narration-audio-trace-instructions-expression-navigation-mac")):Nt(this.controller.s("graphing-calculator-narration-audio-trace-instructions-expression-navigation-windows"))),Zr?Nt(this.controller.s("graphing-calculator-narration-audio-trace-instructions-disable-mac")):Nt(this.controller.s("graphing-calculator-narration-audio-trace-instructions-disable-windows"))),this.wasFocusInExpressionsView&&(this.controller.find$(".dcg-graph-outer").one("focusin",()=>{setTimeout(()=>{me()},0)}),this.controller.dispatch({type:"set-focus-location",location:{type:"graph-paper"}}))),this.agNavigator.moveToOrigin(),Nt(this.getExpressionAriaLabel(o.id)),this.reportAudioTrace({playSound:!1}),this.wasFocusInExpressionsView||me(),this.audioTraceActive=!0,this.controller.isKeypadEnabled()&&this.controller.dispatch({type:"keypad/audio"})}checkIfSelectedItemChanged(e){this.lastSelectedId!==e&&(this.lastSelectedId=e,this.audioTraceActive&&(e?(Nt(this.getExpressionAriaLabel(e)),this.exitSliderTrace(),this.agNavigator.updatePOI(),this.agNavigator.moveToOrigin(),this.reportAudioTrace(),me()):this.exitAudioTrace()))}pauseAnimations(){this.sliderArray.length=0,this.controller.getAllModelsWithSliders().forEach(r=>{r.slider.isPlaying&&(this.controller.dispatch({type:"set-slider-isplaying",id:r.id,isPlaying:!1}),this.sliderArray.push(r))})}resumeAnimations(){if(this.sliderArray.length!==0){for(let e=0;e<this.sliderArray.length;e++){let r=this.sliderArray[e];r.slider.isPlaying!==!0&&this.controller.dispatch({type:"set-slider-isplaying",id:r.id,isPlaying:!0})}this.sliderArray.length=0}}stopAnimations(){this.controller.getAllModelsWithSliders().forEach(r=>{r.slider.isPlaying&&this.controller.dispatch({type:"set-slider-isplaying",id:r.id,isPlaying:!1})})}getAnimatingVars(){let e=[];for(let r=0;r<this.sliderArray.length;r++)e.push('"'+so(this.sliderArray[r])+'"');return e}hasActiveSliders(){let e=this.controller.getAllModelsWithSliders();for(let r=0;r<e.length;r++)if(e[r].slider.isPlaying)return!0;return!1}queueAnimatingPoints(e){this.sliderArray.length===1?Nt(this.controller.s("graphing-calculator-narration-audio-trace-one-slider-paused")):this.sliderArray.length>1?Nt(this.controller.s("graphing-calculator-narration-audio-trace-multiple-sliders-paused",{sliders:this.sliderArray.length})):e&&Nt(this.controller.s("graphing-calculator-narration-audio-trace-no-sliders-paused"))}queueSliderLatex(){this.hasActiveSliders()||this.tonegen.stop();let e=this.getSelectedSlider();e?Nt(e.latex):Nt(this.controller.s("graphing-calculator-narration-audio-trace-slider-value-unknown"))}getSelectedSlider(){let e=this.controller.getAllModelsWithSliders();return this.sliderIndex<=e.length-1?e[this.sliderIndex]:null}incrementSliderValue(){this.adjustSlider("up")}decrementSliderValue(){this.adjustSlider("down")}incrementBigSliderValue(){this.adjustSlider("bigup")}decrementBigSliderValue(){this.adjustSlider("bigdown")}nextSlider(){this.adjustSlider("next")}prevSlider(){this.adjustSlider("prev")}sliderMin(){this.adjustSlider("min")}sliderMax(){this.adjustSlider("max")}adjustSlider(e){let r=this.getSelectedSlider();if(!r){Nt(this.controller.s("graphing-calculator-narration-audio-trace-cannot-change-slider-value"));return}let i=r.latex,n=this.controller.getAllModelsWithSliders().length;switch(e){case"up":case"down":case"bigup":case"bigdown":case"min":case"max":this.controller.dispatch({type:"adjust-slider-by-keyboard",id:r.id,adjustment:e}),this.queueSliderLatex(),me();break;case"next":this.sliderIndex++,this.sliderIndex>=n&&(Nt(this.controller.s("graphing-calculator-narration-audio-trace-last-slider")),this.sliderIndex=n-1),this.queueSliderLatex(),me();return;case"prev":this.sliderIndex--,this.sliderIndex<0&&(Nt(this.controller.s("graphing-calculator-narration-audio-trace-first-slider")),this.sliderIndex=0),this.queueSliderLatex(),me();return}!r.slider.isPlaying&&i!==r.latex&&(this.queueSliderLatex(),me())}toggleAudioTrace(){this.audioTraceActive?this.exitAudioTrace():this.enterAudioTrace()}toggleSliderTrace(){this.sliderTraceActive?this.exitSliderTrace():this.enterSliderTrace()}enterSliderTrace(){if(this.sliderTraceActive)return;this.sliderIndex=0,this.controller.getAllModelsWithSliders().length!==0?(Nt(this.controller.s("graphing-calculator-narration-slider-trace-on")),this.queueSliderLatex(),this.sliderTraceActive=!0):(Nt(this.controller.s("graphing-calculator-narration-slider-trace-no-sliders")),this.sliderTraceActive=!1),me()}exitSliderTrace(){this.sliderTraceActive&&(Nt(this.controller.s("graphing-calculator-narration-slider-trace-off")),this.sliderTraceActive=!1,this.sliderIndex=0,me())}recomputePoints(){this.audioTraceActive&&(this.tonegen.isAnimating()||(this.agNavigator.updatePOI(),this.agNavigator.updateSampledPoints(),this.agNavigator.updateCurrentPoint(),this.agNavigator.resetTracePoint(),this.agNavigator.computeStepSizes()))}reportAndMoveToPrevPoint(){Kn(),this.agNavigator.prevPoint(),this.reportAudioTrace(),this.controller.dispatch({type:"render"})}reportAndMoveToNextPoint(){Kn(),this.agNavigator.nextPoint(),this.reportAudioTrace(),this.controller.dispatch({type:"render"})}reportAndMoveToOrigin(){Kn(),this.agNavigator.moveToOrigin(),this.reportAudioTrace(),this.controller.dispatch({type:"render"})}reportAndMoveToPrevPOI(){Kn(),this.agNavigator.prevPOI(),this.reportAudioTrace(),this.controller.dispatch({type:"render"})}reportAndMoveToNextPOI(){Kn(),this.agNavigator.nextPOI(),this.reportAudioTrace(),this.controller.dispatch({type:"render"})}reportAndMoveToFirstPoint(){Kn(),this.agNavigator.firstPoint(),this.reportAudioTrace(),this.controller.dispatch({type:"render"})}reportAndMoveToLastPoint(){Kn(),this.agNavigator.lastPoint(),this.reportAudioTrace(),this.controller.dispatch({type:"render"})}reportX(){Kn(),this.reportAudioTrace({propToSpeak:"x",playSound:!1})}reportY(){Kn(),this.reportAudioTrace({propToSpeak:"y",playSound:!1})}reportColor(){Kn();let e=this.agNavigator.getCurrentSketch();e?Nt(Rd(this.controller,e.color)):Nt(this.controller.s("graphing-calculator-narration-color-unknown")),me()}reportPOICount(){Kn();let e=this.agNavigator.getCurrentSketch(),r=e?e.getPOI().length:0;me(this.controller.s("graphing-calculator-narration-audio-trace-poi-count",{x:r}))}reportType(){Kn(),this.reportAudioTrace({propToSpeak:"type",playSound:!1})}reportBranch(){Kn(),this.reportAudioTrace({propToSpeak:"branch",playSound:!1})}describePoint(){Kn(),this.reportAudioTrace({playSound:!1}),me()}playCurrentPoint(){let e=this.agNavigator.getCurrentPoint();e&&this.tonegen.playPoint(e,this.grapher.getProjection())}reportAudioTrace(e){let r=this.agNavigator.getCurrentPoint();if(!r)return;let i=e&&e.propToSpeak,n=this.controller.getAudio()&&this.tonegen.getPlaybackSupported()&&(e&&e.playSound!==void 0?e.playSound:!0),o=e&&e.speakCoordinates!==void 0?e.speakCoordinates:!0;this.tonegen.stop(),n&&this.playCurrentPoint(),o&&(this.queueCoordinates(r,i),setTimeout(function(){me()},i?0:100))}adjustPlaybackSpeed(e){if(!this.controller.getAudio()){me(this.controller.s("graphing-calculator-narration-audio-trace-sound-effects-disabled"));return}if(e<0||e>=Zy.length)return;this.audioSpeedIndex=e;let r=Zy[e];return this.tonegen.setAudioSpeed(r.speed),me(this.controller.s("graphing-calculator-narration-audio-trace-playback-speed",{speed:r.displayedSpeed}))}speedUp(){this.adjustPlaybackSpeed(this.audioSpeedIndex+1)}speedDown(){this.adjustPlaybackSpeed(this.audioSpeedIndex-1)}adjustVolume(e){if(Kn(),!this.controller.getAudio()){me(this.controller.s("graphing-calculator-narration-audio-trace-sound-effects-disabled"));return}let r=this.tonegen.getAudioVolume(),i=e==="up"?Math.min(100,Math.round((r+.1)*100)):Math.max(0,Math.round((r-.1)*100));this.tonegen.setAudioVolume(i/100),this.playCurrentPoint(),me(this.controller.s("graphing-calculator-narration-audio-trace-volume",{volume:i}))}zoom(e){this.grapher.viewportController.zoom(e)}setDefaultViewport(){this.grapher.viewportController.setDefaultViewport()}getFocusedCell(){return this.focusedCell}setFocusedCell(e){this.focusedCell=e}getAudioTraceActive(){return this.audioTraceActive}hearGraph(){if(Kn(),!this.controller.getAudio()){me(this.controller.s("graphing-calculator-narration-audio-trace-sound-effects-disabled"));return}if(this.tonegen.getPlaybackSupported()){this.tonegen.stop();let e=this.agNavigator.getCurrentSketch();e&&yl(this.controller,e)?this.tonegen.playSketch(e,this.grapher.getProjection()):me(this.controller.s("graphing-calculator-narration-audio-trace-unable-to-trace-this-expression"))}else me(this.controller.s("graphing-calculator-narration-audio-trace-unable-to-play"))}stopGraph(){this.tonegen.getPlaybackSupported()&&this.tonegen.stop()}getAudioSpeedIndex(){return this.audioSpeedIndex}};var FD=__dcg_shared_module_exports__['i'](ep());var B6=10240;function K6(t,e,r,i,n){let{dotSpacing:o}=t,s=1+o;var a=n.charCodeAt(0)-B6;a&1&&e.fillRect(r,i,1,1),a&2&&e.fillRect(r,i+s,1,1),a&4&&e.fillRect(r,i+2*s,1,1),a&8&&e.fillRect(r+s,i,1,1),a&16&&e.fillRect(r+s,i+s,1,1),a&32&&e.fillRect(r+s,i+2*s,1,1)}function PD(t,e){let{x:r,y:i,width:n,height:o}=e,s=t.getImageData(r,i,n,o).data;for(let a=3;a<s.length;a+=4)if(s[a]!==0)return!1;return!0}function U6(t,e){let{x:r,y:i,width:n,height:o}=e,s=t.getImageData(r,i,n,o).data;for(let a=3;a<s.length;a+=4)if(s[a]===0)return!1;return!0}function kM(t,e,r,i,n){return PD(e,_D(t,r,i,n))}function q6(t,e,r,i,n){let{dotSpacing:o}=t,s=3+2*o;for(var a=0;a<n.length;a++)K6(t,e,r+s*a,i,n[a])}function Jd(t,e){let{dotSpacing:r}=t;return(2+r)*e.length+(1+r)*(e.length-1)}function OD(t,e){let{dotSpacing:r}=t;return 3+2*r}function _D(t,e,r,i){let{cellPadding:n}=t;return{x:e-n,y:r-n,width:Jd(t,i)+2*n,height:OD(t,i)+2*n}}function AD(t,e){if(!t)return e;let r=Math.min(t.x,e.x),i=Math.min(t.y,e.y),n=Math.max(t.x+t.width,e.x+e.width)-r,o=Math.max(t.y+t.height,e.y+e.height)-i;return{x:r,y:i,width:n,height:o}}function HR(t,e,r){return Math.min(Math.max(t,e),r)}function rb(t,e,r,i,n){return{x:HR(r,0,e.canvas.width-Jd(t,n)),y:HR(i,0,e.canvas.height-OD(t,n))}}function ib(t,e,r,i,n){let o=e.fillStyle;e.fillStyle="white";let s=_D(t,r,i,n);e.fillRect(s.x,s.y,s.width,s.height),e.fillStyle="black",q6(t,e,r,i,n),e.fillStyle=o}function GM(t,e,r,i){let{cellPadding:n}=t;return{x:Math.round(e-(Jd(t,i)+n)),y:r}}function H6(t){return t.replace(/\u283C(?!$)/g,"")}function jd(t,e){let r=e==="nemeth"?FD.latexToNemeth(t):FD.latexToUeb(t);return r.isError?"":H6(r.value)}function sm(t,e){return e>=0?t*Math.pow(10,e):t/Math.pow(10,-e)}function $R(t,e,r,i){let[n,o]=r,s=Math.ceil(Math.log(o-n)/Math.LN10)-1,a=s,l=5,c=15;e:for(let u=s;s-u<4;u--)for(let p of[5,2,1]){let g=sm(p,u),b=Math.floor(n/g)+1,x=Math.ceil(o/g)-1;var d=Math.abs(i(g)-i(0));let w=jd(String(sm(b*p,u)),e),E=jd(String(sm(x*p,u)),e);if(d<Jd(t,w)+Jd(t," ")||d<Jd(t,E)+Jd(t," ")||x-b>=c)break e;a=u,l=p}return{int:l,exp:a}}function WR(t,e,r){return $R(t,e,[r.viewport.xmin,r.viewport.xmax],i=>r.mapx(i))}function z6(t,e,r){return r.viewport.isSquare(r.screen,{xAxisScale:r.settings.xAxisScale,yAxisScale:r.settings.yAxisScale})?WR(t,e,r):$R(t,e,[r.viewport.ymin,r.viewport.ymax],i=>r.mapy(i))}function zR(t,e){let{int:r,exp:i}=t,[n,o]=e,s=Math.ceil(n/sm(r,i)),a=Math.floor(o/sm(r,i)),l=[];for(var c=s;c<=a;c++)l.push(sm(c*r,i));return l}function $6(t,e,r){return{x:zR(WR(t,e,r),[r.viewport.xmin,r.viewport.xmax]),y:zR(z6(t,e,r),[r.viewport.ymin,r.viewport.ymax])}}function jR(t,e,r,i,n){if(r.margins===void 0||e===void 0)return;let o=W6(i),s=r.margins,a=__dcg_shared_module_exports__['b']({},e.settings),l=a.showGrid&&j6(i),c=!!a.showXAxis,d=!!a.showYAxis,u=!!a.xAxisNumbers,p=a.xAxisArrowMode,g=!!a.yAxisNumbers,b=a.yAxisArrowMode,x=o.graphLineWidth,w={showGrid:!1,xAxisNumbers:!1,xAxisArrowMode:"NONE",yAxisNumbers:!1,yAxisArrowMode:"NONE",showXAxis:!1,showYAxis:!1,graphLineWidth:x,pointLineWidth:2.5,curveOpacity:1,globalCurveColor:"#000",disableFill:!0};for(let A in w)e.settings[A]=w[A];let E=t.width-s.right-s.left,k=t.height-s.top-s.bottom,S=new nd(E,k),T=e.getProjection().viewport;e.settings.squareAxes&&(T=T.squareCrop(S,e.settings));let V=new oc(S,T,e.settings),O=t.getContext("2d"),y=document.createElement("canvas");y.width=E,y.height=k;let L=y.getContext("2d"),P=document.createElement("canvas");P.width=E,P.height=k;let K=P.getContext("2d"),$=document.createElement("canvas");$.width=E,$.height=k;let U=$.getContext("2d"),J=document.createElement("canvas");J.width=E,J.height=k;let R=J.getContext("2d"),q=document.createElement("canvas");q.width=E,q.height=k;let _=q.getContext("2d");if(O!==null&&R!==null&&L!==null&&U!==null&&_!==null&&K!==null){e.settings.disableFill=!0,e.screenshotToCanvas(J,{width:E,height:k,targetPixelRatio:1,transparentBackground:!0}),e.settings.disableFill=!1,e.screenshotToCanvas(y,{width:E,height:k,targetPixelRatio:1,transparentBackground:!0}),O.fillStyle="white",O.fillRect(0,0,t.width,t.height);let A=Math.round(V.mapx(0)),z=Math.round(V.mapy(0)),Q=a.xAxisLabel!==""?a.xAxisLabel.replace(/ /g,"\\ "):"x",fe=a.yAxisLabel!==""?a.yAxisLabel.replace(/ /g,"\\ "):"y",ie=1;if(c&&V.coordsAreOnscreen(E-6,z-8,0)){let ae=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},o),{cellPadding:o.cellPadding+ie}),ye=2+2*OD(ae,Q),H=E-2,ge=z-ye,Se=jd(Q,n);({x:H,y:ge}=GM(ae,H,ge,Se)),{x:H,y:ge}=rb(ae,L,H,ge,Se),ib(ae,_,H,ge,Se)}if(d&&V.coordsAreOnscreen(A+4,1,0)){let ae=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},o),{cellPadding:o.cellPadding+ie}),ye=A+4,H=1,ge=jd(fe,n);({x:ye,y:H}=rb(ae,L,ye,H,ge)),ib(ae,_,ye,H,ge)}let{x:Le,y:pe}=$6(o,n,V);if(c){let ae;for(let ye of Le){if(ye===0&&d)continue;let H=Math.round(V.mapx(ye));if(!(H<2||H>V.screen.width-2)&&u){let ge=Jd(o,jd("-1",n))-Jd(o,jd("1",n)),Se=ye<0?ge+1:1,Ke=H-Se,Ae=z+4,Ze=jd(""+ye,n);({x:Ke,y:Ae}=rb(o,_,Ke,Ae,Ze)),kM(o,R,Ke,Ae,Ze)&&(ib(o,_,Ke,Ae,Ze),ae=AD(ae,_D(o,Ke,Ae,Ze)))}}o.embossPatternInequalities&&ae&&(ae=AD(ae,{x:0,y:z,width:E,height:0}),U.fillStyle="white",U.fillRect(ae.x,ae.y,ae.width,ae.height))}if(d){let ae;for(let ye of pe){if(ye===0&&c)continue;let H=Math.round(V.mapy(ye));if(H<2||H>V.screen.height-2)continue;let ge=-Math.ceil(OD(o," ")/2);if(g){let Se=A-4,Ke=H+ge,Ae=jd(""+ye,n);({x:Se,y:Ke}=GM(o,Se,Ke,Ae)),{x:Se,y:Ke}=rb(o,_,Se,Ke,Ae),kM(o,R,Se,Ke,Ae)&&(ib(o,_,Se,Ke,Ae),ae=AD(ae,_D(o,Se,Ke,Ae)))}}o.embossPatternInequalities&&ae&&(ae=AD(ae,{x:A,y:0,width:0,height:k}),U.fillStyle="white",U.fillRect(ae.x,ae.y,ae.width,ae.height))}if(c&&d){let ae=A-2,ye=z+2,H=jd(u||g?"0":"o",n);({x:ae,y:ye}=GM(o,ae,ye,H)),V.coordsAreOnscreen(ae,ye,0)&&({x:ae,y:ye}=rb(o,_,ae,ye,H),kM(o,R,ae,ye,H)&&ib(o,_,ae,ye,H))}for(let ae of Le){let ye=Math.round(V.mapx(ae));ye<2||ye>V.screen.width-2||d&&ae===0||l&&nb(U,"white",ye-1,0,k,3)}for(let ae of pe){let ye=Math.round(V.mapy(ae));ye<2||ye>V.screen.height-2||c&&ae===0||l&&ob(U,"white",ye-1,0,E,3)}c&&ob(U,"white",z-3,0,E,7),d&&nb(U,"white",A-3,0,k,7);for(let ae of Le){let ye=Math.round(V.mapx(ae));ye<2||ye>V.screen.width-2||d&&ae===0||(l?nb(U,LD(i),ye,0,k):c&&nb(U,LD(i),ye,z-3,z+2))}for(let ae of pe){let ye=Math.round(V.mapy(ae));ye<2||ye>V.screen.height-2||c&&ae===0||(l?ob(U,LD(i),ye,0,E):d&&ob(U,LD(i),ye,A-3,A+2))}if(c&&ob(U,om(i),z,0,E),d&&nb(U,om(i),A,0,k),b!=="NONE"&&(Q6(U,om(i),A,0),b==="BOTH"&&X6(U,om(i),A,k-1)),p!=="NONE"&&(J6(U,om(i),E-1,z),p==="BOTH"&&Y6(U,om(i),0,z)),o.embossPatternInequalities)for(let ae=0;ae<E;ae+=6)for(let ye=0;ye<k;ye+=6){let H={x:ae,y:ye,width:3,height:3};U6(L,H)&&PD(U,H)&&PD(R,H)&&PD(_,H)&&Z6(K,"black",ae,ye)}o.embossPatternInequalities||O.drawImage(y,s.left,s.top),O.drawImage($,s.left,s.top),O.drawImage(J,s.left,s.top),O.drawImage(q,s.left,s.top),o.embossPatternInequalities&&O.drawImage(P,s.left,s.top)}for(let A in w)e.settings[A]=a[A]}function W6(t){if(t==="etc8"||t==="etc11")return{dotSpacing:0,cellPadding:1,graphLineWidth:1.75,embossPatternInequalities:!0};if(t==="vpmax8"||t==="vpmax11")return{dotSpacing:1,cellPadding:2,graphLineWidth:1,embossPatternInequalities:!1};{let e=t;throw new Error(`Unexpected embosser model ${e}`)}}function j6(t){if(t==="etc8"||t==="etc11")return!1;if(t==="vpmax8"||t==="vpmax11")return!0;{let e=t;throw new Error(`Unexpected embosser model ${e}`)}}function om(t){switch(t){case"vpmax8":case"vpmax11":return"rgb(145, 145, 145)";case"etc8":case"etc11":return"rgb(0, 0, 0)";default:let e=t;throw new Error("Unexpected embosser model: "+e)}}function LD(t){switch(t){case"vpmax8":case"vpmax11":return"rgb(219, 219, 219)";case"etc8":case"etc11":return"rgb(0, 0, 0)";default:let e=t;throw new Error("Unexpected embosser model: "+e)}}function nb(t,e,r,i,n,o=1){let s=t.fillStyle;t.fillStyle=e,t.fillRect(r-1,i,o,n-i),t.fillStyle=s}function ob(t,e,r,i,n,o=1){let s=t.fillStyle;t.fillStyle=e,t.fillRect(i,r-1,n-i,o),t.fillStyle=s}function J6(t,e,r,i){let n=t.fillStyle;t.fillStyle=e;for(var o=-2;o<=2;o++)t.fillRect(r-Math.abs(o),i-1+o,1,1);t.fillStyle=n}function Y6(t,e,r,i){let n=t.fillStyle;t.fillStyle=e;for(var o=-2;o<=2;o++)t.fillRect(r+Math.abs(o),i-1+o,1,1);t.fillStyle=n}function X6(t,e,r,i){let n=t.fillStyle;t.fillStyle=e;for(var o=-2;o<=2;o++)t.fillRect(r-1+o,i-Math.abs(o),1,1);t.fillStyle=n}function Q6(t,e,r,i){let n=t.fillStyle;t.fillStyle=e;for(var o=-2;o<=2;o++)t.fillRect(r-1+o,i+Math.abs(o),1,1);t.fillStyle=n}function Z6(t,e,r,i){let n=t.fillStyle;t.fillStyle=e,t.fillRect(r+1,i,1,1),t.fillRect(r,i+1,1,1),t.fillRect(r+1,i+1,1,1),t.fillRect(r+2,i+1,1,1),t.fillRect(r+1,i+2,1,1),t.fillStyle=n}var tp={};tp.vpmax8={width:170,height:220,margins:{left:5,top:15,right:5,bottom:50},name:t=>t.s("graphing-calculator-label-braille-size-vpmax8")};tp.vpmax11={width:230,height:220,margins:{left:15,top:15,right:5,bottom:5},name:t=>t.s("graphing-calculator-label-braille-size-vpmax11")};tp.etc8={width:96,height:96,margins:{left:5,top:15,right:0,bottom:0},name:t=>t.s("graphing-calculator-label-braille-size-etc8")};tp.etc11={width:132,height:134,margins:{left:10,top:15,right:5,bottom:5},name:t=>t.s("graphing-calculator-label-braille-size-etc11")};var As=__dcg_shared_module_exports__['i'](Z());var{If:t7}=As.Components,RD=class extends As.Class{init(){this.grapher=this.props.grapher(),this.controller=this.grapher.controller,this.width=0,this.height=0,this.devicePixelRatio=window.devicePixelRatio||1}template(){return As.createElement("div",{class:As.const("dcg-graph-outer"),role:As.const("img"),"aria-roledescription":()=>this.controller.s("graphing-calculator-narration-graphpaper-label"),didMount:e=>this.rootNode=e,manageFocus:this.const(yt({controller:this.controller,location:{type:"graph-paper"}}))},As.createElement(t7,{predicate:()=>this.isIOSAndIframe()},()=>As.createElement("div",{style:As.const("width:1px; height:.5px; pointer-events:none; opacity: 0;"),"aria-hidden":As.const("true")},As.const("text"))),As.createElement("canvas",{class:As.const("dcg-graph-inner"),didMount:e=>{this.canvasNode=e,this.ctx=this.canvasNode.getContext("2d"),this.resize(0,0)},style:()=>({position:"relative",display:"block",outline:"none","-webkit-transform":this.isIOSAndIframe()?"translate3d(0,-.25px,0)":void 0})}))}isIOSAndIframe(){return kh&&Id}resize(e,r,i){var n;i=i||this.devicePixelRatio,!(e===this.width&&r===this.height)&&(this.width=e,this.height=r,this.canvasNode.style.width=e+"px",this.canvasNode.style.height=r+"px",this.canvasNode.setAttribute("width",""+e*i),this.canvasNode.setAttribute("height",""+r*i),this.ctx=this.canvasNode.getContext("2d"),(n=this.ctx)==null||n.scale(i,i),this.update())}getAriaLabel(e){if(this.grapher.type==="3d")return"";let r=this.grapher.getAudioTrace();if(!r)return"";let i=this.controller.s("graphing-calculator-narration-graphpaper-label")+". "+r.getAxesDescription();return e===0||r.getAudioTraceActive()||r.agNavigator.getFirstTraceableSketch({selectAssociatedExpression:!1})!==void 0&&(Zr?i+=" "+this.controller.s("graphing-calculator-narration-audio-instructions-enter-audio-trace-mac"):i+=" "+this.controller.s("graphing-calculator-narration-audio-instructions-enter-audio-trace-windows")),i}updateAria(e,r){this.rootNode.setAttribute("aria-hidden",!e||!this.grapher.settings.config.graphpaper?"true":"false"),this.rootNode.setAttribute("tabindex",e&&this.grapher.settings.config.graphpaper&&this.grapher.settings.config.enableTabindex&&(r>0||this.controller.isGeoUIActive())?"0":"-1"),this.rootNode.setAttribute("aria-label",this.getAriaLabel(r)),this.update()}};Oe();var bl=__dcg_shared_module_exports__['i'](Z());var{For:r7}=bl.Components,sb=class extends bl.Class{init(){this.grapher=this.props.grapher(),this.controller=this.grapher.controller,this.renderedTabTargetOrder=[],this.renderedTabTargets={}}template(){return bl.createElement(r7,{each:()=>this.renderedTabTargetOrder},bl.createElement("div",{class:bl.const("dcg-graph-outer"),style:this.const({"z-index":0}),onFocusin:this.bindFn(this.handleFocusChange),onFocusout:this.bindFn(this.handleFocusChange),onKeydown:this.bindFn(this.handleKeydown),didMount:e=>this.rootNode=e},e=>bl.createElement("div",{class:bl.const("dcg-tabbable-draggableimage"),style:()=>this.getStyle(e),role:bl.const("button"),"aria-roledescription":()=>this.controller.s("graphing-calculator-narration-draggable-image-description"),"dcg-draggableimage-id":this.const(e),tabindex:()=>this.getTabIndex(),"aria-hidden":this.bindFn(this.getAriaHidden),"aria-label":()=>this.getAriaLabel(e)})))}redrawToCtx(e,r,i,n){this.renderedTabTargets={},this.renderedTabTargetOrder=[],gs(e,"background-images"),(n===void 0||n.length<__dcg_shared_module_exports__['w'](i))&&(n=__dcg_shared_module_exports__['C'](i));for(let s of n){let a=i[s];a&&a.shouldGraph&&!a.foreground&&WC(a,e,r);var o=this.controller.getItemModel(s);if(o&&o.type==="image"&&o.shouldGraph&&jc(o)){let l=o.formula.dimensions;if(!l||!l.x||!l.y||!l.width||!l.height||!l.radianAngle)continue;for(let c=0;c<l.x.length;c++)if(isFinite(l.x[c])&&isFinite(l.y[c])&&isFinite(l.width[c])&&isFinite(l.height[c])&&isFinite(l.radianAngle[c])){this.renderedTabTargetOrder.push(s),this.renderedTabTargets[s]={id:s,description:this.getComputedDescription(o,c),x:l.x[c],y:l.y[c],radianAngle:l.radianAngle[c],width:l.width[c],height:l.height[c],widthScale:Math.abs(r.mapx(1)-r.mapx(0)),heightScale:Math.abs(r.mapy(1)-r.mapy(0)),screenX:r.mapx(l.x[c]),screenY:r.mapy(l.y[c]),centerId:o.formula.center_reference_id};break}}}ms(e),this.update(),this.speakAriaAlert()}getStyle(e){var r=this.renderedTabTargets[e];if(!r)return;let{screenX:i,screenY:n,radianAngle:o,width:s,height:a,widthScale:l,heightScale:c}=r,d=c/l,u=s*l,p=a*c/d,g=i-u/2,b=n-p/2;var x=`translate(${g}px, ${b}px)`,w=o?` rotate(${o}rad)`:"",E=d===1?"":` scale(1,${d})`;return{position:"absolute",top:0,left:0,transform:x+E+w,width:u+"px",height:p+"px"}}getTabIndex(){if(this.controller.getActiveTool()!=="selection")return-1;var e=this.grapher.settings;return e.config.graphpaper&&e.config.enableTabindex?0:-1}getAriaHidden(){var e=this.grapher.settings;return!e.config.graphpaper}getComputedDescription(e,r){let i=e.formula&&e.formula.computed_description&&e.formula.computed_description[r];return i&&i!==""?Eo(i):this.grapher.getAudioTrace().getExpressionAriaLabel(e.id)}getAriaLabel(e){var r=this.getAriaAlert({id:e,includeUsageInstructions:!1});return r&&r.completeMessage}speakAriaAlert(){let e=this.focusedId;if(!(e&&!this.renderedTabTargets[e])){var r=this.getAriaAlert({id:e,lastAriaAlert:this.lastAriaAlert,includeUsageInstructions:!0});this.lastAriaAlert=r,r&&r.completeMessage&&me(r.completeMessage)}}getAriaAlert(e){let{id:r,lastAriaAlert:i,includeUsageInstructions:n}=e;if(r){var o=this.controller.getItemModel(r);if(!(!o||o.type!=="image")){var s=this.renderedTabTargets[r];if(s){i&&i.id!==r&&(i=void 0);var a=i&&i.label,l=s.description,c=a!==l,d=i&&i.coordX,u=i&&i.coordY,p=s.x,g=s.y,b=p!==d||g!==u,x=this.grapher.getProjection(),w=eu(this.controller,p,g),E=l,k=n?this.controller.s("graphing-calculator-narration-movable-point-suffix-usage-instructions"):"",S=this.isImageFullyVisible(o,x)?"":this.controller.s("graphing-calculator-narration-draggable-image-off-screen-prompt"),T;return i?c?T=E+S:b?T=w+S:T="":T=E+". "+w+k+S,{id:r,coordX:p,coordY:g,label:l,completeMessage:T}}}}}handleFocusChange(){let e;if(document.activeElement&&I.contains(this.rootNode,document.activeElement)){var r=I(document.activeElement);e=r.attr("dcg-draggableimage-id")}this.focusedId!==e&&(this.focusedId=e,this.lastAriaAlert=void 0,this.requestRedrawNextFrame())}requestRedrawNextFrame(){this.grapher.redrawAllLayers()}handleKeydown(e){if(!this.focusedId)return;let r=this.renderedTabTargets[this.focusedId];if(!r)return;let i=Te(e),n=ei(e);i==="Up"||i==="Down"||i==="Left"||i==="Right"?(e.stopPropagation(),e.preventDefault(),this.moveImageFromKeyboard(r,e)):(n==="X"||n==="Y"||n==="L")&&this.speakImageAttribute(r,n)}moveImageFromKeyboard(e,r){if(!(e===void 0||e.centerId===void 0)){var i=this.grapher.getProjection(),n=i.map_pt({x:e.x,y:e.y}),o=0,s=0,a=Te(r),l=(i.pixelCoordinates.right-i.pixelCoordinates.left)/40,c=(i.pixelCoordinates.bottom-i.pixelCoordinates.top)/40,d=a==="Up"||a==="Down"?c:l;d=r.shiftKey?d*5:d;var u,p;if(a==="Up"?(p="y",s-=d,u=r.shiftKey?"bigup":"up"):a==="Down"?(p="y",s+=d,u=r.shiftKey?"bigdown":"down"):a==="Left"?(p="x",o-=d,u=r.shiftKey?"bigdown":"down"):a==="Right"&&(p="x",o+=d,u=r.shiftKey?"bigup":"up"),u){var g={x:n.x+o,y:n.y+s},b;p==="x"||this.hasNonlinearMoveStrategy(e.centerId)?b={x:u}:p==="y"&&(b={y:u}),this.controller.dispatch({type:"on-move-points",points:[{sketch:{id:e.centerId}}],screenPts:[g],previousScreenPts:[n],projection:i,keyboardDirection:b})}}}speakImageAttribute(e,r){if(e){var i=this.grapher.getAudioTrace();if(i){var n=this.grapher.getProjection();if(n)switch(r){case"X":me(Xi(this.controller,e.x));break;case"Y":me(Qi(this.controller,e.y));break;case"L":me(e.description);break}}}}hasNonlinearMoveStrategy(e){if(!e)return!1;var r=this.controller.getItemModel(e);if(!r||r.type!=="expression"||!r.formula)return!1;var i=r.formula.move_strategy;return!i||!i[0]?!1:i[0].type==="updateSliderNonlinear"}isImageFullyVisible(e,r){let i=e.formula.dimensions;if(!i||!i.x||!i.y)return!1;for(var n=0;n<i.x.length;n++)if(!r.coordsAreOnscreen(r.mapx(i.x[n]),r.mapy(i.y[n])))return!1;return!0}};var wl=__dcg_shared_module_exports__['i'](Z());Oe();var{For:i7}=wl.Components;function n7(t,e){return e===void 0&&(e=0),`${t}i${e}`}var ab=class extends wl.Class{constructor(){super(...arguments),this.hoveredObjects={}}init(){this.grapher=this.props.grapher(),this.controller=this.grapher.controller,this.renderedTabTargetOrder=[],this.renderedTabTargets={}}template(){return wl.createElement(i7,{each:()=>this.renderedTabTargetOrder},wl.createElement("div",{class:wl.const("dcg-graph-outer"),style:this.const({"z-index":0}),onFocusin:this.bindFn(this.handleFocusChange),onFocusout:this.bindFn(this.handleFocusChange),didMount:e=>this.rootNode=e},e=>wl.createElement("div",{class:wl.const("dcg-tabbable-clickableobject"),role:wl.const("button"),"aria-roledescription":()=>this.controller.s("graphing-calculator-narration-clickable-object-description"),"dcg-clickableobject-id":()=>this.getModelId(e),tabindex:()=>this.getTabIndex(e),"aria-hidden":this.bindFn(this.getAriaHidden),"aria-label":()=>this.getCachedDescription(e),onTap:()=>{this.controller.dispatch({type:"clickable-item-clicked",id:this.getModelId(e),listIndex:this.getListIndex(e)})}})))}redraw(){this.renderedTabTargets={},this.renderedTabTargetOrder=[];let e=this.grapher.getSketchOrder();for(let r of e){let i=this.controller.getItemModel(r);if(!i)continue;let n=this.grapher.getGraphSketch(r),o=this.grapher.getGraphImage(r);if(n&&i.type==="expression"&&Uc(i))for(let s=0;s<n.branches.length;s++){let a=n.branches[s];if(!a.segments||a.segments.length===0)continue;let l=0;a.graphMode===3||a.graphMode===4?n.getBranchPOI(s).forEach(c=>{l=c.pointIdxOnBranch||0,isFinite(c.x)&&isFinite(c.y)&&this.addClickableObjectToDom(i,l)}):(l="listIndex"in a&&a.listIndex!==void 0?a.listIndex:0,a.segments.length>0&&this.addClickableObjectToDom(i,l))}else if(o&&o.shouldGraph&&i.type==="image"&&uC(i)){let s=i.formula&&i.formula.dimensions;if(!s||!s.x||!s.y||!s.width||!s.height||!s.radianAngle)continue;for(let a=0;a<s.x.length;a++)isFinite(s.x[a])&&isFinite(s.y[a])&&isFinite(s.width[a])&&isFinite(s.height[a])&&isFinite(s.radianAngle[a])&&this.addClickableObjectToDom(i,a)}}Object.keys(this.hoveredObjects).length||this.pressedObject?this.grapher.setLayerClass("clickableObjects","dcg-mouse-over-clickable-object"):this.grapher.setLayerClass("clickableObjects",void 0),this.update()}addClickableObjectToDom(e,r){let i=n7(e.id,r);this.renderedTabTargetOrder.indexOf(i)!==-1||this.renderedTabTargets[i]!==void 0||(this.renderedTabTargetOrder.push(i),this.renderedTabTargets[i]={type:e.type,id:e.id,listIndex:r,description:this.getComputedDescription(e,r)})}getTabIndex(e){if(this.controller.getActiveTool()!=="selection"||!this.renderedTabTargets[e])return-1;let i=this.grapher.settings;return!i.config.graphpaper||!i.config.enableTabindex?-1:0}getAriaHidden(){var e=this.grapher.settings;return!e.config.graphpaper}getCachedDescription(e){var r=this.renderedTabTargets[e];return r.description}getComputedDescription(e,r){let i=e.formula&&e.formula.computed_description&&e.formula.computed_description[r];return i&&i!==""?Eo(i):this.grapher.getAudioTrace().getExpressionAriaLabel(e.id)}getModelId(e){var r=this.renderedTabTargets[e];return r?r.id:""}getListIndex(e){var r=this.renderedTabTargets[e];return r?r.listIndex:0}shouldDrawHovered(e,r){if(!e)return!1;if(e===this.focusedId)return!0;if(this.isAnObjectPressed()&&!this.isObjectPressed(e))return!1;var i=this.getHoveredObjectById(e);return i?i.listIndexes===void 0||r===void 0?!0:!!i.listIndexes[r]:!1}setHoveredObjects(e){__dcg_shared_module_exports__['F'](e,this.hoveredObjects)||(this.hoveredObjects=e,this.requestRedrawNextFrame())}getHoveredObjects(){return this.hoveredObjects}getHoveredObjectById(e){return this.hoveredObjects[e]}shouldDrawPressed(e,r){if(!e)return!1;let i=this.pressedObject;return!i||i.id!==e?!1:r===void 0?!0:i.listIndex===r}isObjectPressed(e){return e===void 0?!1:!!(this.pressedObject&&this.pressedObject.id===e)}setPressedObject(e){!e&&!this.pressedObject||e&&this.pressedObject&&e.id===this.pressedObject.id&&e.listIndex===this.pressedObject.listIndex||(this.pressedObject=e,this.requestRedrawNextFrame())}getPressedObject(){return this.pressedObject}isAnObjectPressed(){return!!this.pressedObject}handleFocusChange(){var e=void 0;if(document.activeElement&&I.contains(this.rootNode,document.activeElement)){var r=I(document.activeElement);e=r.attr("dcg-clickableobject-id")}this.focusedId!==e&&(this.focusedId=e,this.requestRedrawNextFrame())}requestRedrawNextFrame(){this.grapher.redrawAllLayers()}};ql();var o7=oo().reflectionArc;function ND(t){return t.valueType===__dcg_shared_module_exports__['Ta']?t.value:t.valueType===__dcg_shared_module_exports__['Xa']?t.value[0]:void 0}function s7(t){return t.valueType===__dcg_shared_module_exports__['hb']||t.valueType===__dcg_shared_module_exports__['jb']||t.valueType===__dcg_shared_module_exports__['bb']?{segment:t.valueType===__dcg_shared_module_exports__['bb'],value:t.value}:t.valueType===__dcg_shared_module_exports__['ib']||t.valueType===__dcg_shared_module_exports__['kb']||t.valueType===__dcg_shared_module_exports__['cb']?{segment:t.valueType===__dcg_shared_module_exports__['cb'],value:t.value[0]}:void 0}function JR(t){return t.valueType===__dcg_shared_module_exports__['Sa']?t.value:t.valueType===__dcg_shared_module_exports__['Va']?t.value[0]:void 0}var BD=class{constructor(e){this.controller=e}getTransformationPreviewInfoFromItem(e){var r;if(e.type==="expression")return(r=e.formula.geometry)==null?void 0:r.transformation_preview_info}getInprogressTransformation(){let e=this.controller.getAllToolPreviewItems();for(let r of e){let i=this.getTransformationPreviewInfoFromItem(r);if(i)return i}}getHoveredOrSelectedTransformations(){let e=[];this.controller.getAllSelectedItems().forEach(a=>{if(a.type!=="expression")return;let l=this.getTransformationPreviewInfoFromItem(a);l&&e.push(l)});var i=this.controller.getHoveredTokenIdentifier();if(!i)return e;let n=this.controller.getItemsByIdentifier(i);if(n.length!==1)return e;let o=n[0];if(o.type!=="expression")return e;let s=this.getTransformationPreviewInfoFromItem(o);return s&&e.push(s),e}drawTranslationPreview(e,r,i,n){let o=r.mapx(i[0]),s=r.mapy(i[1]),a=r.mapx(n[0]),l=r.mapy(n[1]);e.save(),e.beginPath(),e.strokeStyle="rgba(0,0,0,.2)",e.lineWidth=5,e.moveTo(o,s),e.lineTo(a,l),Jc(e,o,s,a,l,20),e.stroke(),e.restore()}drawReflectionPreview(e,r,i){let n=i.value,o=i.segment,[s,a,l,c]=Ay([n[0][0],n[0][1],n[1][0],n[1][1]],r,18).clipped,d=(s+l)/2,u=(a+c)/2;if(o){let[k,S,T,V]=Ay([n[0][0],n[0][1],n[1][0],n[1][1]],r,17).clipped;d=(k+T)/2,u=(S+V)/2}let p=40,g=p/__dcg_shared_module_exports__['_'](s-l,a-c),b=d+(c-a)*g,x=u-(l-s)*g,w=d-(c-a)*g,E=u+(l-s)*g;if(e.save(),e.beginPath(),e.strokeStyle="rgba(0,0,0,.2)",e.lineWidth=4,e.moveTo(s,a),e.lineTo(l,c),o7){let k=Math.atan2(x-u,b-d),S=p,T=p*.7;e.moveTo(b,x),e.ellipse(d,u,S,T,k,0,Math.PI,!1);let V=.35,O=k+Math.PI/2+V,y=k+Math.PI/2-V;Jc(e,b+Math.cos(O),x+Math.sin(O),b,x,10),Jc(e,w+Math.cos(y),E+Math.sin(y),w,E,10)}else e.moveTo(b,x),e.lineTo(w,E),Jc(e,d,u,b,x,10),Jc(e,d,u,w,E,10);e.stroke(),e.restore()}drawDilationPreview(e,r,i,n){e.save(),e.beginPath(),e.strokeStyle="rgba(0,0,0,.2)",e.lineWidth=3;let o=n<.6||n>1.4&&n<2?6:10,s=r.pixelsToMath.mapX(25)-r.pixelsToMath.mapX(0);[[s,0],[0,s],[-s,0],[0,-s]].forEach(a=>{let l=[i[0]+a[0],i[1]+a[1]],c=__dcg_shared_module_exports__['Ma'](__dcg_shared_module_exports__['Ja'](i,n),l),[d,u]=r.map_xy_pairs(l),[p,g]=r.map_xy_pairs(c);e.moveTo(d,u),e.lineTo(p,g),Jc(e,d,u,p,g,o)}),e.stroke(),e.restore()}drawRotationPreview(e,r,i,n){e.save(),e.beginPath(),e.strokeStyle="rgba(0,0,0,.2)",e.lineWidth=2.5,n*=-1;let o=40,[s,a]=r.map_xy_pairs(i),l=s+o,c=a,d=s+o*Math.cos(n),u=a+o*Math.sin(n),p=n<=0;e.moveTo(l,c),e.arc(s,a,o,0,n,p),FI(e,d,u,0,n,10,o),e.stroke(),e.restore()}redrawToCtx(e,r){if(!this.controller.isGeometry())return;let i=this.getInprogressTransformation(),n=this.getHoveredOrSelectedTransformations();i&&n.push(i);for(let o=0;o<n.length;o++){let s=n[o],a=s.args;switch(s.type){case"translate":{let l=ND(a[0]),c=ND(a[1]);l&&c&&this.drawTranslationPreview(e,r,l,c)}break;case"reflect":{let l=s7(a[0]);l&&this.drawReflectionPreview(e,r,l)}break;case"dilate":{let l=ND(a[0]),c=JR(a[1]);l&&c!==void 0&&isFinite(c)&&c!==1&&this.drawDilationPreview(e,r,l,c)}break;case"rotate":{let l=ND(a[0]),c=JR(a[1]);l&&c!==void 0&&isFinite(c)&&c!==0&&(this.controller.isDegreeMode()&&(c*=Math.PI/180),this.drawRotationPreview(e,r,l,c))}break}}}};var{floor:iu,ceil:nu,round:a7,log10:KD,log2:YR,abs:rp}=Math,HD=class{redrawToCtx(e,r,i){gs(e,"graphpaper");let n=r.settings.showGrid;if(r.settings.polarMode&&n){let o=tR(r);gs(e,"grid"),this.drawPolarGrid(e,r,o),ms(e),gs(e,"axis"),this.drawAxes(e,r,i);let s=this.drawPolarStepNumbers(e,r,o);this.drawLabels(e,r,s),ms(e)}else{let o=Jh(r),s=VM(r);n&&(gs(e,"grid"),this.drawCartesianGrid(e,r,o,s),ms(e));let a=!n;gs(e,"axis"),this.drawAxes(e,r,i);let l=this.drawCartesianStepNumbers(e,r,o,a,s);this.drawLabels(e,r,l),ms(e)}ms(e)}addTextShadow(e,r){e.strokeStyle=r.settings.getBackgroundColor(),e.lineWidth=3,e.miterLimit=2}drawPolarGrid(e,r,i){e.save();let n=r.settings.minorAxisOpacity,s=1-(1-r.settings.majorAxisOpacity)/(1-n),a=__dcg_shared_module_exports__['fa'](r.mapx(0)),l=__dcg_shared_module_exports__['fa'](r.mapy(0)),c=r.screen.height/(r.viewport.ymax-r.viewport.ymin),d=r.screen.width/(r.viewport.xmax-r.viewport.xmin),u=c/d,p=d/c,g=l/u,b=r.viewport.smallestR(),x=r.viewport.largestR(),w=i.minorStepR*Math.max(1,Math.floor(b/i.minorStepR)),E=i.majorStepR*Math.max(1,Math.floor(b/i.majorStepR));e.lineWidth=1,e.strokeStyle="rgba(0, 0 , 0, "+n+")";for(let S of lc(w,x,i.minorStepR)){Ki(e,"dcg-svg-minor-gridline"),e.beginPath(),Ei(e),e.scale(1,u);let T=r.mapx(S)-a;e.moveTo(a+T,g),e.arc(a,g,T,0,2*Math.PI),e.scale(1,p),e.stroke()}let k=b>0?5:15;for(let S of lc(0,359,k)){if((S===0||S===180)&&r.settings.showXAxis||(S===90||S===270)&&r.settings.showYAxis)continue;Ki(e,"dcg-svg-minor-gridline"),e.beginPath(),Ei(e),e.moveTo(a,l);let T=r.mapx(x*Math.cos(S*Math.PI/180)),V=r.mapy(x*Math.sin(S*Math.PI/180));e.lineTo(__dcg_shared_module_exports__['fa'](T),__dcg_shared_module_exports__['fa'](V)),e.stroke()}e.lineWidth=1,e.strokeStyle="rgba(0, 0 , 0, "+s+")";for(let S of lc(E,x,i.majorStepR)){Ki(e,"dcg-svg-major-gridline"),e.beginPath(),Ei(e),e.scale(1,u);let T=r.mapx(S)-a;e.moveTo(a+T,g),e.arc(a,g,T,0,2*Math.PI),e.scale(1,p),e.stroke()}e.restore()}drawCartesianGrid(e,r,i,n=VM(r)){e.save();let{xmin:o,xmax:s,ymin:a,ymax:l}=r.viewport,c=r.screen.width,d=r.screen.height,u=d,p=0;r.settings.restrictGridToFirstQuadrant&&(o=0,a=0,u=r.mapy(0),p=r.mapx(0));let g=r.settings.minorAxisOpacity*n.x.unitOpacity,b=r.settings.minorAxisOpacity*n.y.unitOpacity,x=r.settings.majorAxisOpacity;e.lineWidth=1;let w=R=>{if(R===0&&r.settings.showYAxis)return;let q=__dcg_shared_module_exports__['fa'](r.mapx(R));q===__dcg_shared_module_exports__['fa'](0)||q===__dcg_shared_module_exports__['fa'](c)||(e.beginPath(),e.moveTo(q,0),e.lineTo(q,u),e.stroke())},E=R=>{if(R===0&&r.settings.showXAxis)return;let q=__dcg_shared_module_exports__['fa'](r.mapy(R));q===__dcg_shared_module_exports__['fa'](0)||q===__dcg_shared_module_exports__['fa'](d)||(e.beginPath(),e.moveTo(p,q),e.lineTo(c,q),e.stroke())};Ki(e,"dcg-svg-minor-gridline");let{majorStepX:k,majorStepY:S,minorStepX:T,minorStepY:V}=i,O=r.settings.xAxisScale==="logarithmic",y=r.settings.yAxisScale==="logarithmic",L=O?n.x.minor:lc(o,s,T),P=y?n.y.minor:lc(a,l,V);e.strokeStyle="rgba(0, 0 , 0, "+g+")";for(let R of L)w(R);e.strokeStyle="rgba(0, 0 , 0, "+b+")";for(let R of P)E(R);Ei(e);let K=1-(1-x)/(1-g),$=1-(1-x)/(1-b);Ki(e,"dcg-svg-major-gridline");let U=O?n.x.major:lc(o,s,k),J=y?n.y.major:lc(a,l,S);e.strokeStyle="rgba(0, 0 , 0, "+K+")";for(let R of U)w(R);e.strokeStyle="rgba(0, 0 , 0, "+$+")";for(let R of J)E(R);Ei(e),e.restore()}drawAxes(e,r,i){let n=r.settings.axisLineOffset,o=r.settings.axisOpacity.toString(),s="rgba(127,205,230,"+o+")",a="rgba(0,0,0,"+o+")",l=r.settings.xAxisArrowMode,c=r.settings.yAxisArrowMode,d=r.settings.showXAxis,u=r.settings.showYAxis,p=1,g=Math.round(r.mapx(0))-n,b=Math.round(r.mapy(0))-n,x=r.screen.height,w=r.screen.width;function E(T,V,O){e.save();let y=Math.PI/12,L=8*Math.max(e.lineWidth,1.5);e.lineJoin="round",e.fillStyle=a,e.strokeStyle=a,e.beginPath(),e.moveTo(T,V),e.lineTo(T+Math.cos(O-y)*L,V+Math.sin(O-y)*L),e.lineTo(T+Math.cos(O+y)*L,V+Math.sin(O+y)*L),e.lineTo(T,V),e.lineTo(T+Math.cos(O-y)*L,V+Math.sin(O-y)*L),e.stroke(),e.fill(),e.restore()}let k=x,S=0;r.settings.restrictGridToFirstQuadrant&&(k=b,S=g,l==="BOTH"&&(l="POSITIVE"),c==="BOTH"&&(c="POSITIVE")),u&&(gs(e,"yaxis"),r.settings.takingScreenshot&&Oy(e,r.settings.yAxisLabel||"Y axis"),e.save(),Ki(e,"dcg-svg-axis-line"),e.lineWidth=r.settings.axisLineWidth*(i==="y"?p:1),e.strokeStyle=i==="y"?s:a,c==="BOTH"?(e.beginPath(),e.moveTo(g,2*r.settings.axisLineWidth),e.lineTo(g,x-2*r.settings.axisLineWidth),e.stroke(),E(g,x-r.settings.axisLineWidth,3*Math.PI/2),E(g,r.settings.axisLineWidth,Math.PI/2)):c==="POSITIVE"?(e.beginPath(),e.moveTo(g,2*r.settings.axisLineWidth),e.lineTo(g,k),e.stroke(),E(g,r.settings.axisLineWidth,Math.PI/2)):(e.beginPath(),e.moveTo(g,0),e.lineTo(g,k),e.stroke()),Ei(e),e.restore(),ms(e)),d&&(gs(e,"xaxis"),r.settings.takingScreenshot&&Oy(e,r.settings.xAxisLabel||"X axis"),e.save(),Ki(e,"dcg-svg-axis-line"),e.lineWidth=r.settings.axisLineWidth*(i==="x"?p:1),e.strokeStyle=i==="x"?s:a,l==="BOTH"?(e.beginPath(),e.moveTo(2*r.settings.axisLineWidth,b),e.lineTo(w-2*r.settings.axisLineWidth,b),e.stroke(),E(r.settings.axisLineWidth,b,0),E(w-r.settings.axisLineWidth,b,Math.PI)):l==="POSITIVE"?(e.beginPath(),e.lineTo(S,b),e.lineTo(w-2*r.settings.axisLineWidth,b),e.stroke(),E(w-r.settings.axisLineWidth,b,Math.PI)):(e.beginPath(),e.lineTo(S,b),e.lineTo(w,b),e.stroke()),Ei(e),e.restore(),ms(e))}drawPolarStepNumbers(e,r,i){e.save();let n=r.settings.showGrid,o=r.settings.xAxisNumbers&&r.settings.showXAxis,s=r.settings.yAxisNumbers&&r.settings.showYAxis,a=n&&r.settings.polarNumbers,l=r.viewport.largestR(),c=r.viewport.smallestR(),d=r.viewport.xmin,u=r.viewport.xmax,p=r.viewport.ymin,g=r.viewport.ymax,b=r.screen.width,x=r.screen.height,w={left:3,right:b-3,top:3,bottom:x-3},E=r.settings.labelHangingColor,k=r.settings.getTextColor(),S=r.settings.labelSize,T=S;this.addTextShadow(e,r),e.fillStyle=k;function V(_,A,z){let Q=Math.sqrt(_*_-A*A);p<=Q&&Q<=g&&z.push({x:r.mapx(A),y:r.mapy(Q)}),p<=-Q&&-Q<=g&&z.push({x:r.mapx(A),y:r.mapy(-Q)})}function O(_,A,z){let Q=Math.sqrt(_*_-A*A);d<=Q&&Q<=u&&z.push({x:r.mapx(Q),y:r.mapy(A)}),d<=-Q&&-Q<=u&&z.push({x:r.mapx(-Q),y:r.mapy(A)})}let y=r.mapx(0),L=r.mapy(0),P=p<=0&&0<=g,K=d<=0&&0<=u,$=P&&o,U=K&&s,J="";if(!$&&!U&&n){let _=rp(y),A=rp(y-b),z=rp(L),Q=rp(L-x),fe,ie,Le,pe;_<=A?(fe="left",Le=_):(fe="right",Le=A),z<=Q?(ie="top",pe=z):(ie="bottom",pe=Q),o&&s?J=Le<=pe?fe:ie:s?J=fe:o&&(J=ie)}let R={left:0,right:b,top:L-1,bottom:L+1},q={left:y-1,right:y+1,top:0,bottom:x};for(let _ of lc(0,l,i.majorStepR)){let A=[],z=[],Q=[],fe=new Qo(__dcg_shared_module_exports__['Bb'](_,l),S),ie=fe.getRect();switch(_>0?(U&&p<=_&&_<=g&&z.push({x:y-ie.right-5,y:r.mapy(_)}),U&&p<=-_&&-_<=g&&z.push({x:y-ie.right-5,y:r.mapy(-_)}),$&&d<=_&&_<=u&&A.push({x:r.mapx(_),y:L-ie.top+3}),$&&d<=-_&&-_<=u&&A.push({x:r.mapx(-_),y:L-ie.top+3})):U&&!o&&p<=_&&_<=g?z.push({x:y-ie.right-5,y:r.mapy(_)}):$&&!s&&d<=_&&_<=u&&A.push({x:r.mapx(_),y:L-ie.top+3}),J){case"top":O(_,g,Q);break;case"bottom":O(_,p,Q);break;case"left":V(_,d,Q);break;case"right":V(_,u,Q);break}A.forEach(function(Le){Le=fe.clampBoundsWithinRect(Le,w),fe.drawCenteredAt(e,Le,"dcg-svg-axis-value"),UD(R,fe.getRectWhenCenteredAt(Le))}),z.forEach(function(Le){Le=fe.clampBoundsWithinRect(Le,w),fe.drawCenteredAt(e,Le,"dcg-svg-axis-value"),UD(q,fe.getRectWhenCenteredAt(Le))}),Q.forEach(function(Le){Le=fe.clampBoundsWithinRect(Le,w),fe.drawCenteredAt(e,Le,"dcg-svg-axis-value")})}if(a){let _=Math.ceil(c/i.majorStepR),A=Math.floor(l/i.majorStepR),Q=Math.ceil((_+A)/2)*i.majorStepR,fe=c>0?15:30;for(let ie of lc(0,359,fe)){let Le;r.settings.degreeMode?Le=ie.toString()+"\xB0":Le=__dcg_shared_module_exports__['Bb'](ie*Math.PI/180,2*Math.PI).string;let pe=e.measureText(Le).width/2,ae=Q/1.05,ye=ae*Math.cos(ie*Math.PI/180),H=ae*Math.sin(ie*Math.PI/180);if(ye<d||ye>u||H<p||H>g)continue;let ge=r.mapx(ye),Se=r.mapy(H);ie===0||ie===180?Se-=T:(ie===90||ie===270)&&(ge+=pe+3);let Ke=__dcg_shared_module_exports__['oa'](ge,3+pe,b-3-pe),Ae=__dcg_shared_module_exports__['oa'](Se,3+T,x-3-T);Ae=Qo.computeBaselineFromCenter(Ae,S),Ki(e,"dcg-svg-polar-axis-value"),e.save(),Ei(e),e.fillStyle=E,Qo.setCtxFontSize(e,S),e.strokeText(Le,Ke,Ae),e.fillText(Le,Ke,Ae),e.restore()}}return e.restore(),{x:R,y:q}}drawLabels(e,r,i){let n=r.viewport.xmin,o=r.viewport.xmax,s=r.viewport.ymin,a=r.viewport.ymax,l=r.screen.width,c=r.screen.height,d=(o-n)/l,u=(a-s)/c,p=r.settings.getTextColor(),g=r.mapx(0),b=r.mapy(0),x=r.settings.labelSize,w=15,E=r.settings.showXAxis&&r.settings.xAxisLabel,k=r.settings.showYAxis&&r.settings.yAxisLabel,S=i.x,T=i.y;if(E&&S){Ki(e,"dcg-svg-axis-label"),e.save(),Ei(e),e.fillStyle=p;let V;if(e.__xLabelOffset&&r.settings.isViewportTransient&&qD(e.__xLabelOffset.xscale,d)&&qD(e.__xLabelOffset.yscale,u)&&(V={x:e.__xLabelOffset.x+g,y:e.__xLabelOffset.y+b}),this._setAxisLabelFont(e,E,x,r),!V){let O=e.measureText(E).width,y=l-O-w,L=x;S.bottom+L<c?V={x:y,y:S.bottom+L}:V={x:y,y:S.top-L/2},e.__xLabelOffset={x:V.x-g,y:V.y-b,xscale:d,yscale:u}}e.strokeText(E,V.x,V.y),e.fillText(E,V.x,V.y),e.restore()}else e.__xLabelPosition=null;if(k&&T){Ki(e,"dcg-svg-axis-label"),e.save(),Ei(e),e.fillStyle=p;let V;if(e.__yLabelOffset&&r.settings.isViewportTransient&&qD(e.__yLabelOffset.xscale,d)&&qD(e.__yLabelOffset.yscale,u)&&(V={x:e.__yLabelOffset.x+g,y:e.__yLabelOffset.y+b}),this._setAxisLabelFont(e,k,x,r),!V){let O=e.measureText(k).width,y=x,L=O+5;if(!this._isShortMathyLabel(k)){let K=O;O=y,y=K,L=O*.5}let P=0+w+y;T.left-O>0?V={x:T.left-L,y:P}:V={x:T.right+O,y:P},e.__yLabelOffset={x:V.x-g,y:V.y-b,xscale:d,yscale:u}}e.translate(V.x,V.y),this._isShortMathyLabel(k)||e.rotate(-Math.PI/2),e.strokeText(k,0,0),e.fillText(k,0,0),e.restore()}else e.__yLabelPosition=null}_isShortMathyLabel(e){return e.trim().match(/^([a-zA-Z]?)\(?([a-zA-Z]?)\)?$/)}_setAxisLabelFont(e,r,i,n){this.addTextShadow(e,n),this._isShortMathyLabel(r)?e.font="italic "+Math.round(i*1.4)+"px Times":e.font=Math.round(i*1.2)+"px Arial"}drawCartesianStepNumbers(e,r,i,n,o=VM(r)){e.save();let{showXAxis:s,showYAxis:a}=r.settings,l=s&&r.settings.xAxisNumbers,c=a&&r.settings.yAxisNumbers,{xmin:d,xmax:u,ymin:p,ymax:g}=r.viewport,b=r.screen.width,x=r.screen.height,w={left:3,top:3,right:b-3,bottom:x-3};r.settings.restrictGridToFirstQuadrant&&(d=0,p=0);let E=r.settings.labelHangingColor,k=r.settings.getTextColor(),S=r.mapx(0),T=r.mapy(0),V=r.settings.labelSize;this.addTextShadow(e,r);let O={left:0,right:b,top:T-1,bottom:T+1},y={left:S-1,right:S+1,top:0,bottom:x},L=5,P=!1;if(s&&a&&(l||c)){P=!0,e.fillStyle=k;let R=new Qo(__dcg_shared_module_exports__['Bb'](0,1),V);R.drawCenteredAt(e,{x:S-R.getRect().right-L,y:T-R.getRect().top+L},"dcg-svg-axis-value")}let{majorStepX:K,majorStepY:$}=i,U=[],J=[];if(l){let R=r.settings.xAxisScale==="logarithmic",q=R?o.x.label:lc(d,u,K);for(let _ of q){let A=R?void 0:u-d,z=__dcg_shared_module_exports__['Bb'](_,A,R),Q=new Qo(z,V);Q.getString()==="0"&&P||U.push(Q)}}if(c){let R=r.settings.yAxisScale==="logarithmic",q=R?o.y.label:lc(p,g,$);for(let _ of q){let A=R?void 0:g-p,z=__dcg_shared_module_exports__['Bb'](_,A,R),Q=new Qo(z,V);Q.getString()==="0"&&P||J.push(Q)}}if(n){e.save(),Ki(e,"dcg-svg-tickmark");let R=r.settings.axisLineOffset,_="rgba(0,0,0,"+r.settings.axisOpacity.toString()+")";e.lineWidth=r.settings.axisLineWidth,e.strokeStyle=_;let A=Math.round(r.mapy(0))-R,z=Math.round(r.mapx(0))-R,Q=Math.round(2*e.lineWidth)-R;e.beginPath(),U.forEach(function(fe){let ie=Math.round(r.mapx(fe.getValue()))-R;e.moveTo(ie,A-Q),e.lineTo(ie,A+Q)}),J.forEach(function(fe){let ie=Math.round(r.mapy(fe.getValue()))-R;e.moveTo(z-Q,ie),e.lineTo(z+Q,ie)}),e.stroke(),Ei(e),e.restore()}return U.forEach(function(R){let q={x:r.mapx(R.getValue())-.5*R.getMinusWidth(),y:T-R.getRect().top+L},_=R.clampBoundsWithinRect(q,w);e.fillStyle=q.y===_.y||r.settings.yAxisScale==="logarithmic"?k:E;let A="dcg-svg-axis-value";q.x!==_.x&&(A+=" dcg-svg-offcenter-axis-value"),R.drawCenteredAt(e,_,A),UD(O,R.getRectWhenCenteredAt(_)),Ei(e)}),J.forEach(function(R){let q={x:S-L-R.getRect().right,y:r.mapy(R.getValue())},_=R.clampBoundsWithinRect(q,w);e.fillStyle=q.x===_.x||r.settings.xAxisScale==="logarithmic"?k:E;let A="dcg-svg-axis-value";q.y!==_.y&&(A+=" dcg-svg-offcenter-axis-value"),R.drawCenteredAt(e,_,A),UD(y,R.getRectWhenCenteredAt(_)),Ei(e)}),e.restore(),{x:O,y}}};function lc(t,e,r){let i=Math.ceil(t/r),n=Math.floor(e/r);if(!l7({nmin:i,nmax:n}))return[];let o=[];for(var s=i;s<=n;s++)o.push(s*r);return o}var l7=({nmin:t,nmax:e})=>isFinite(e-t)&&e-t<=1e4;function VM(t){return{x:XR("x",t),y:XR("y",t)}}function XR(t,e){let r=new Set,i=new Set,n=new Set,o=1;function s(pe){return S?e.mapx(pe):e.mapy(pe)}function a(pe,ae){return rp(s(ae)-s(pe))}let l=(pe,ae)=>{let ye=pe*ae,H=(pe+1)*ae;if(ye<T&&H<T||ye>V&&H>V)return;let ge=pe>=5?a(7*ae,8*ae):pe>=2?a(3*ae,4*ae):a(ae,2*ae),Se=ge/a(ye,H);if(ge<40)return;let Ke={settings:{pixelsPerLabel:e.settings.pixelsPerLabel*Se,labelSize:e.settings.labelSize,xAxisNumber:e.settings.xAxisNumbers,yAxisNumber:e.settings.yAxisNumbers},screen:{width:ge,height:ge},viewport:{xmin:ye,ymin:ye,xmax:H,ymax:H}},{minorStepX:Ae,majorStepX:Ze}=Jh(Ke),qe=Math.max(ye,T),At=Math.min(H,V);for(let Fe=iu(qe/Ae);Fe<nu(At/Ae);Fe++)n.add(Fe*Ae);for(let Fe=iu(qe/Ze);Fe<nu(At/Ze);Fe++){let Lt=Fe*Ze;Lt<=ye||Lt>=H||(i.add(Lt),r.add(Lt))}},c={label:[],major:[],minor:[],unitOpacity:1},{xAxisScale:d,yAxisScale:u,pixelsPerLabel:p}=e.settings,{xmin:g,xmax:b,ymin:x,ymax:w}=e.viewport,{width:E,height:k}=e.screen,S=t==="x",[T,V]=S?[g,b]:[x,w],O=S?E:k,y=S?d:u,L=e.settings.xAxisMinorSubdivisions!==0;if(y!=="logarithmic")return c;let P=iu(KD(T)),K=nu(KD(V)),$=nu(KD(V)-KD(T)),U=a(__dcg_shared_module_exports__['a'](10,P),__dcg_shared_module_exports__['a'](10,P+1)),J=15,R=100,q=U>J,_=[];U>6.25*p&&(_=[2,3,4,6,8]),U>12*p&&(_=[2,3,4,5,6,7,8]),U>14*p&&(_=[2,3,4,5,6,7,8,9]);let A=_.length!=0;if(J<=U&&U<=R&&(o=Math.sqrt((U-J)/(R-J))),!isFinite($))return c;let z=iu(O/p),Q=Math.max(1,__dcg_shared_module_exports__['a'](2,a7(YR($/z))));for(let pe=nu(P/Q);pe<=iu(K/Q);pe++)r.add(__dcg_shared_module_exports__['a'](10,pe*Q));i=new Set([...r]);let fe=iu(O/J),ie=Math.max(1,__dcg_shared_module_exports__['a'](2,nu(YR($/fe))));for(let pe=nu(P/ie);pe<=iu(K/ie);pe++)(q?i:n).add(__dcg_shared_module_exports__['a'](10,pe*ie));if(q)for(let pe=P;pe<K;pe++){let ae=__dcg_shared_module_exports__['a'](10,pe);for(let ye of _)r.add(ye*ae);if(A){for(let ye=2;ye<=9;ye++)i.add(ye*ae);for(let ye=1;ye<=9;ye++)l(ye,ae)}else for(let ye=2;ye<=9;ye++)n.add(ye*ae)}L&&(n=new Set);let Le=S?e.reverse_mapx(s(T)+p/4):e.reverse_mapy(s(T)-2*e.settings.labelSize);return{label:[...r].filter(pe=>Le<=pe&&pe<=V),major:[...i].filter(pe=>T<=pe&&pe<=V),minor:[...n].filter(pe=>T<=pe&&pe<=V),unitOpacity:o}}function UD(t,e){e.left<t.left&&(t.left=e.left),e.right>t.right&&(t.right=e.right),e.top<t.top&&(t.top=e.top),e.bottom>t.bottom&&(t.bottom=e.bottom)}function qD(t,e){let r=rp(t),i=rp(e),n=1e-4;return rp(r-i)<=(r<i?i:r)*n}function d7(){return new nd(1024,768)}function QR(t){let{xAxisScale:e,yAxisScale:r}=t;return new an(...e==="linear"?[-$h,$h]:[__dcg_shared_module_exports__['a'](10,-Wh),__dcg_shared_module_exports__['a'](10,Wh)],...r==="linear"?[-$h,$h]:[__dcg_shared_module_exports__['a'](10,-Wh),__dcg_shared_module_exports__['a'](10,Wh)])}var od=class{constructor(e,r,i,n){this.type="2d";this.__screenRequested3D=new nd(384,384);this.lastActiveToken={selected:void 0,hovered:void 0};this._layerClasses={};this.$=e,this.evaluator=n,this.controller=i,this.settings=r;let o=d7(),s=QR(r).squareYAxis(o,r);this.setUserRequestedViewport(s),this.__projection=new oc(o,s,r),this.markLabelsDirty=__dcg_shared_module_exports__['B'](()=>{this.evaluator.notifyWhenSynced(()=>{this.poiLabelsLayer.markLabelsDirty(),this.redrawAllLayers()})},300),this.poiController=new id(this,r),this.viewportController=new GD(this,this.controller),this.showPOIDots=!0,this.$.css("overflow","hidden"),this.graphSketches={},this.graphImages={},this.audioGraph=new eb(i,this);var a=this;this.canvasLayer=ip.mountToNode(RD,this.$[0],{grapher:function(){return a}}),this.boxSelectLayer=new QC,this.$.append(this.canvasLayer.rootNode);var l=I("<div></div>");this.$.append(l),this.imageLayer=ip.mountToNode(sb,l[0],{grapher:function(){return a}}),this.gridLayer=new HD,this.poiDotsLayer=new XC(this.controller),this.graphsLayer=new bn(this.controller,this.settings,g=>this.audioGraph.getExpressionAriaLabel(g)),this.transformationPreviewLayer=new BD(this.controller);var c=I("<div></div>");this.$.append(c),this.clickableObjectsLayer=ip.mountToNode(ab,c[0],{grapher:function(){return a}});var d=I("<div></div>");this.$.append(d),this.movablePointsLayer=ip.mountToNode($y,d[0],{grapher:function(){return a}});var u=I("<div></div>");this.$.append(u),this.poiLabelsLayer=ip.mountToNode(tm,u[0],{grapher:function(){return a}});var p=I("<div></div>");this.$.append(p),this.geoKeyboardCursorLayer=ip.mountToNode(sD,p[0],{grapher:()=>this}),this.traceLayer=this.poiLabelsLayer,this.scaleAxis=void 0,this.__sketchOrder=[],this.__redrawRequested=!1,this.__isRedrawingSlowly=!1,this.events=new Lr}privateGetGridLayer(){return this.gridLayer}static copyGraphProperties(e,r){e=__dcg_shared_module_exports__['Hc'](Fp,e);let i=__dcg_shared_module_exports__['b']({},e);delete i.viewport;let n=r.validateSettings(i);for(let o in n)r.setProperty(o,n[o]);return e}remove(){this.$.remove(),this.poiController.remove(),this.viewportController.remove(),this.audioGraph.remove()}tick(e){this.__redrawRequested&&this._redrawAllLayers(),this.__movablePointListener&&this.__movablePointListener()}registerMovablePointListener(e){this.__movablePointListener=e}deregisterMovablePointListener(){this.__movablePointListener=void 0}setSketchOrder(e){__dcg_shared_module_exports__['F'](this.__sketchOrder,e)||(this.__sketchOrder=e,this.redrawAllLayers())}clear(){this.graphSketches={},this.graphImages={}}getSketchOrder(){return this.__sketchOrder}getGraphSketch(e){return this.graphSketches[e]}getGraphImage(e){return this.graphImages[e]}addGraphSketch(e){this.graphSketches[e.id]=e}removeGraphSketch(e){delete this.graphSketches[e]}addGraphImage(e){e.imageObj.width&&e.imageObj.height?(this.graphImages[e.id]=e,this.redrawAllLayers()):I(e.imageObj).on("load.calc_load",()=>this.addGraphImage(e))}removeGraphImage(e){let r=this.graphImages[e];r&&I(r.imageObj).off("load.calc_load"),delete this.graphImages[e],this.redrawAllLayers()}setBoxSelectRectangle(e){this.boxSelectRectangle=e,this.redrawAllLayers()}getProjection(){return this.__projection}_setProjection(e){this.__projection=e,this.redrawAllLayers()}getAudioTrace(){return this.audioGraph}getDefaultViewport(){let e=this.getProjection();return QR(this.settings).squareYAxis(e.screen,this.settings)}_updateScreenSize(e,r){if(e<=0||r<=0)return;let n=this.getProjection().screen;if(n.width===e&&n.height===r)return;this.$.width(e);let o=new nd(e,r);this.viewportController.setScreen(o)}_setIsVisible(e){e!==this.isVisible&&(this.isVisible=e,e?this.redrawAllLayers():this.canvasLayer.resize(0,0))}getIsVisible(){return this.isVisible}update(){let e=this.controller.computeMajorLayout().grapher;if(e.width>0&&e.height>0){this._setIsVisible(!0);let{width:r,height:i}=this.controller.isThreeDMode()?this.__screenRequested3D:e;this._updateScreenSize(r,i),this.$.css({position:"absolute",left:e.left+"px",top:e.top+"px",width:r+"px",height:i+"px"})}else this._setIsVisible(!1)}setActiveToken(e,r){var i=this.lastActiveToken[r];this.lastActiveToken[r]=e;var n=e&&this.getGraphSketch(e),o=i&&this.getGraphSketch(i);o!==n&&(o&&(r==="selected"?o.tokenSelected=!1:r==="hovered"&&(o.tokenHovered=!1)),n&&(r==="selected"?n.tokenSelected=!0:r==="hovered"&&(n.tokenHovered=!0))),this.redrawAllLayers()}deselectSketch(e){let r=this.getGraphSketch(e);r&&(r.selected=!1,r.showPOI=!1,r.showHighlight=!1)}selectSketch(e){let r=this.getGraphSketch(e);r&&(r.selected=!0,r.showPOI=this.controller.isTraceEnabled(),r.showHighlight=!0)}updateSketch(e,r){let i=this.getGraphSketch(e);if(!r.length){this.removeGraphSketch(e);return}let n=new VD(e,r);r[0].graphMode!==15&&(n.color=r[0].color,r[0].style&&(n.style=r[0].style)),i&&n.updateFrom(i);let o=!!this.controller.getPropagatedSelectedIds()[e];n.selected=o,n.tokenHovered=e===String(this.lastActiveToken.hovered),n.tokenSelected=e===String(this.lastActiveToken.selected),n.showPOI=o&&this.controller.isTraceEnabled(),n.showHighlight=o,this.addGraphSketch(n)}updateIntersections(e,r){let i=this.getGraphSketch(e);i&&i.updateIntersections(r)}redrawAllLayers(){this.__redrawRequested=!0}_clear(){var o;let e=this.getProjection(),r=e.screen,i=this.isDrawingPlaneFor3dMode()&&!((o=this.controller.grapher3d)!=null&&o.transition.isAnimating)&&window.devicePixelRatio<3?4*(window.devicePixelRatio||1):void 0;if(this.canvasLayer.resize(e.screen.width,e.screen.height,i),!!this.canvasLayer.ctx&&(this.canvasLayer.ctx.clearRect(0,0,r.width,r.height),this.controller.isThreeDMode())){var n=Number(this.controller.getGraphSettings().plane3dOpacity);isNaN(n)&&(n=0),n=__dcg_shared_module_exports__['oa'](n,.001961,1),this.canvasLayer.ctx.fillStyle="rgba(255,255,255,"+n+")",this.canvasLayer.ctx.fillRect(0,0,r.width,r.height)}}isDrawingPlaneFor3dMode(){return this.controller.isThreeDMode()&&this.controller.getGraphSettings().showPlane3D}_redrawAllLayers(){this.update(),!(!this.isVisible&&!this.isDrawingPlaneFor3dMode())&&(this.__redrawRequested=!1,this._clear(),this.audioGraph.recomputePoints(),this._recomputeClickableObjects(),this._redrawImageLayer(),this._redrawGridLayer(),this._redrawGraphsLayer(),this._redrawPointsAndLabels(),this._redrawTransformationPreviewLayer(),this._redrawBoxSelectLayer(),this._redrawGeoKeyboardCursorLayer(),this._updateCanvasLayerAria(),this.events.triggerEvent("redraw",void 0),this.isDrawingPlaneFor3dMode()&&this.controller.grapher3d&&this.controller.grapher3d.webglLayer.updatePlaneMap())}_redrawGridLayer(){this.canvasLayer.ctx&&this.gridLayer.redrawToCtx(this.canvasLayer.ctx,this.getProjection(),this.scaleAxis)}_recomputeClickableObjects(){this.clickableObjectsLayer.redraw()}_redrawGraphsLayer(){this.canvasLayer.ctx&&this.graphsLayer.redrawToCtx(this.canvasLayer.ctx,this.getProjection(),this.graphSketches,this.graphImages,this.__sketchOrder,this.poiLabelsLayer,this.clickableObjectsLayer)}_redrawTransformationPreviewLayer(){this.canvasLayer.ctx&&this.transformationPreviewLayer.redrawToCtx(this.canvasLayer.ctx,this.getProjection())}_redrawBoxSelectLayer(){this.canvasLayer.ctx&&this.boxSelectLayer.redrawToCtx(this.canvasLayer.ctx,this.getProjection(),this.boxSelectRectangle)}_redrawGeoKeyboardCursorLayer(){this.geoKeyboardCursorLayer.update()}_updateCanvasLayerAria(){let e=0;for(let r in this.graphSketches)yl(this.controller,this.graphSketches[r])&&(e+=1);this.canvasLayer.updateAria(this.isVisible,e)}_redrawPointsAndLabels(){if(!this.canvasLayer.ctx)return;var e=this.getProjection();let r=[];this.controller.isThreeDMode()||this.movablePointsLayer.redraw(this.canvasLayer.ctx,e,r),this.showPOIDots&&!this.controller.isThreeDMode()&&this.poiDotsLayer.redrawToCtx(this.canvasLayer.ctx,e,this.graphSketches,this.poiLabelsLayer,this.clickableObjectsLayer,this.__sketchOrder);let i=this.$[0].getBoundingClientRect();this.controller.isThreeDMode()?this.poiLabelsLayer.drawForScreenshot(e,this.canvasLayer.ctx,this.canvasLayer.ctx,this.size(),r):(__dcg_shared_module_exports__['k']([this.controller.find$(".dcg-overgraph-pillbox-elements")[0],this.controller.find$(".dcg-graphpaper-branding")[0]],n=>{if(!n)return;let o=n.getBoundingClientRect();r.push({left:o.left-i.left,top:o.top-i.top,right:o.right-i.left,bottom:o.bottom-i.top})}),this.poiLabelsLayer.redraw(e,this.canvasLayer.ctx,this.size(),r))}size(){let e=this.canvasLayer.ctx;if(!e)return{width:0,height:0};let r=e.canvas.getBoundingClientRect();return{width:r.width,height:r.height}}_redrawImageLayer(){this.canvasLayer.ctx&&this.imageLayer.redrawToCtx(this.canvasLayer.ctx,this.getProjection(),this.graphImages,this.__sketchOrder)}_parseScreenshotOpts(e){let r=this.getProjection(),i,n,o,s,a,l;return e?(i=e.width||e.height||r.screen.width,n=e.height||e.width||r.screen.height,o=e.targetPixelRatio||1,o<1&&(o=1),s=(i<256||n<256)&&!e.preserveAxisNumbers,a=$l.fromObject(e.settings||this.settings),l=!!e.transparentBackground):(i=r.screen.width,n=r.screen.height,o=1,s=!1,a=$l.fromObject(this.settings),l=!1),s&&(a.setProperty("xAxisNumbers",!1),a.setProperty("yAxisNumbers",!1),a.setProperty("polarNumbers",!1)),{width:i,height:n,targetPixelRatio:o,settings:a,transparentBackground:l}}_syncScreenshotReturnCanvas(e){var r=document.createElement("canvas");if(e&&e.braille){let{embosserModel:i,brailleMode:n}=e.braille,o=tp[i];r.width=o.width,r.height=o.height,jR(r,this,o,i,n)}else{let i=this._parseScreenshotOpts(e);r.width=i.width*i.targetPixelRatio,r.height=i.height*i.targetPixelRatio,this.screenshotToCanvas(r,e)}return r}screenshot(e){return this._syncScreenshotReturnCanvas(e).toDataURL("image/png")}asyncScreenshot(e,r){let i=!1;!e.transparentBackground&&e.showLabels&&(e=__dcg_shared_module_exports__['N'](e),e.transparentBackground=!0,i=!0);let n=this._syncScreenshotReturnCanvas(e),o=n.getContext("2d"),s=n,a=o;e&&e.format==="svg"&&(i=!1,e.transparentBackground&&(e=__dcg_shared_module_exports__['N'](e),e.transparentBackground=!1),a=new Z2(n.width,n.height),s={getContext:()=>a,width:n.width,height:n.height},this.screenshotToCanvas(s,e));let l=this.makeScreenshotProjection(e),c=[];if(e.showMovablePoints&&this.movablePointsLayer.drawForScreenshot(a,l,c),e.showLabels){var d=l.screen.width,u=l.screen.height,p=l.settings.labelSize||15,g=1;(d<200||u<200)&&(g=.9);let b=p*g+"px",x=I(`<div class="dcg-calculator-api-container">
          <div class="dcg-container">
            <div class="dcg-grapher" style="font-size:${b}"></div>
          </div>
        </div>`).css({width:l.screen.width,height:l.screen.height,position:"fixed",left:"0px",top:"0px"}).appendTo("body"),w=x.find(".dcg-grapher"),E=ip.mountToNode(tm,w[0],{grapher:()=>this}),k={width:l.screen.width,height:l.screen.height};E.drawForScreenshot(l,o,a,k,c),x.remove()}i&&(a.globalCompositeOperation="destination-over",a.fillStyle="#FFF",a.fillRect(0,0,s.width,s.height)),e&&e.format==="svg"?r(a.getSerializedSvg()):r(s.toDataURL("image/png"))}makeScreenshotProjection(e){let{width:r,height:i,settings:n}=this._parseScreenshotOpts(e),o=new nd(r,i),s=this.getProjection().viewport;return this.settings.squareAxes&&(s=s.squareCrop(o,this.settings)),new oc(o,s,n)}screenshotToCanvas(e,r){let i=this._parseScreenshotOpts(r),{targetPixelRatio:n,transparentBackground:o}=i,s=e.getContext("2d");s.scale(n,n);let a=this.makeScreenshotProjection(r);a.settings.takingScreenshot=!0,gs(s,"background"),Ki(s,"dcg-svg-background"),o?s.clearRect(0,0,a.screen.width,a.screen.height):(s.fillStyle="white",s.fillRect(0,0,a.screen.width,a.screen.height)),Ei(s),ms(s),this.imageLayer.redrawToCtx(s,a,this.graphImages,this.__sketchOrder),this.gridLayer.redrawToCtx(s,a),this.graphsLayer.redrawToCtx(s,a,this.graphSketches,this.graphImages,this.__sketchOrder,this.poiLabelsLayer,this.clickableObjectsLayer,r)}getImageData(e,r,i,n){var o;return(o=this.canvasLayer.ctx)==null?void 0:o.getImageData(e,r,i,n)}getState(e){let r=__dcg_shared_module_exports__['b']({},this.getCurrentViewport());this.controller.is3D()||(delete r.zmin,delete r.zmax);let i={viewport:r};return this.settings.stateProperties.forEach(n=>{n!=="randomSeed"&&(!this.controller.is3D()&&cP(n)||(i[n]=this.settings[n]))}),e.stripDefaults&&(i=__dcg_shared_module_exports__['Fc'](Fp,i)),i}getUndoRedoState(){let e={};return this.settings.stateProperties.forEach(r=>{e[r]=this.settings[r]}),e.viewport=this.getUserRequestedViewport(),e}notifyAfterRedraw(e){if(this.__isRedrawingSlowly)requestAnimationFrame(this.notifyAfterRedraw.bind(this,e));else if(!this.__redrawRequested)e();else{this.notifyAfterRedraw_i?this.notifyAfterRedraw_i++:this.notifyAfterRedraw_i=1;let r="redraw.notifyAfterRedraw"+this.notifyAfterRedraw_i;this.events.observeEvent(r,()=>{this.events.unobserveEvent(r),e()})}}getCurrentViewport(){return this.viewportController.getViewport().toObject()}getUserRequestedViewport(){return this._lastUserRequestedViewport}setUserRequestedViewport(e){this._lastUserRequestedViewportUpdateToken||(this._lastUserRequestedViewportUpdateToken=0),this._lastUserRequestedViewportUpdateToken+=1,this._lastUserRequestedViewport=__dcg_shared_module_exports__['N'](e)}debounceUserRequestedViewportChange(){this.__debouncedViewportCommit||(this.__debouncedViewportCommit=__dcg_shared_module_exports__['B']((i,n)=>{if(!this.isDragging&&this._lastUserRequestedViewportUpdateToken===n){if(this._lastUserRequestedViewport){var o=an.fromObject(this._lastUserRequestedViewport),s=this.computeConcreteViewport(o);if(s.equals(i))return}this.controller.dispatch({type:"commit-user-requested-viewport",viewport:i})}},1e3));let e=this.getCurrentViewport();this.__debouncedViewportCommit(e,this._lastUserRequestedViewportUpdateToken)}setGrapherState(e,r){if((!r||!r.doNotClear)&&this.clear(),e=od.copyGraphProperties(e,this.settings),"viewport"in e){let i=an.fromObject(e.viewport);this.setUserRequestedViewport(i);let n=this.computeConcreteViewport(i);this.viewportController.setViewport(n)}this.redrawAllLayers()}computeConcreteViewport(e){let r=this.getProjection().screen;return this.settings.squareAxes&&!e.isSquare(r,this.controller.getAxisScaleSettings())?e.squareYAxis(r,this.settings):e}setLayerClass(e,r){var i=this._layerClasses[e];this._layerClasses[e]=r,i!==r&&(i&&this.$.removeClass(i),r&&this.$.addClass(r))}setCanvasSizeFor3D(e,r){this.__screenRequested3D=new nd(e,r)}};var cb=class{constructor(){this.displayName="graphing-calculator-text-geometry-tool-selection-display-name";this.toolType="selection";this.icon=[{type:"filled-polygon",color:"#000",path:[40,30,58,46,51,47,56,60,53,62,47,49,41,54,40,30]}]}getNumberInputLatex(){return""}clearTentativeOutputs(){}canNextInputBePoint(){return!1}getNecessaryComplexObject(){}getNonPointInputType(){}getHint(){return""}onNumberInput(e){}onPress(){}onMove(e){}tryCommitResults(){return{committed:void 0}}};var Gi=class{constructor(e){this.model=e;this.isDragCreatable=!1;this.s=e.s}createOutput(){return this.model.createCustomToolOutput(this.getSpec())}clearTentativeOutputs(){let e=this.getSpec();var r={},i=this.model.getNonObjectsState().ui.currentTool.idMap;for(let n in i){let o=i[n];!this.model.isObjectALockedToolInput(o)&&this.model.isObjectUncommitted(o)&&(r[n]=o)}this.model.deleteObjectsAndRememberReusableId(r),this.model.tentativelyMatchToolInput(e,""),this.createOutput()}shouldReferenceSpecificItemInList(e,r){return!r}getExpandedReferenceForDef(e,r){return this.shouldReferenceSpecificItemInList(e,r)?e.referenceLatex:e.assignment}getListIndexForHover(e,r){if(this.shouldReferenceSpecificItemInList(e,r))return e.listIndex}_getOrCreatePoint(e,r,i){var c,d;let n=this.model.getOrCreatePointNearMouse(e,i);if(n.type==="def")return{createdNew:!1,def:n.def,reference:this.getExpandedReferenceForDef(n.def,r)};let o=this.createPointDefinition(n.spec,r),s=n.spec.type==="point-reference"?n.spec.targetSpec.parentDefs:n.spec.parentDefs,a=0;for(let u=0;u<s.length;u++){let p=s[u];if(p.polygonEdgeInfo){let g=this.model.createToolInputDependency({type:"polygon-segment",parents:[(c=p.polygonEdgeInfo)==null?void 0:c.polygonDef.referenceLatex],edgeNumber:((d=p.polygonEdgeInfo)==null?void 0:d.edgeNumber)||0},this.getSpec(),a);o.parents[u]=g,a+=1,this.model.setObjectHovered({tokenId:g,listIndex:void 0})}else this.model.setObjectHovered({calcId:p.calcId,listIndex:this.getListIndexForHover(p,r)})}return{createdNew:!0,def:void 0,reference:this.model._createInputObject(o)}}_isReadyToCommit(){return this.model.getNonObjectsState().ui.currentTool.inputIndex>=this.getSpec().inputs.length}_getFirstMissingInput(){let{inputIndex:e}=this.model.getNonObjectsState().ui.currentTool;return this.getSpec().inputs[e]}canNextInputBePoint(){let e=this._getFirstMissingInput();return!!(e&&e.type==="point")}getNonPointInputType(){let e=this._getFirstMissingInput();if(!(!e||e.type==="point"))return e.type==="union"?e:e.type}getNecessaryComplexObject(){if(!this.canNextInputBePoint())return this.getNonPointInputType()}getHint(){let e=this._getFirstMissingInput();return e?e.hint!==void 0?this.s(e.hint):this.s("graphing-calculator-text-geometry-select-hint",{type:e.type}):""}onPress(){this.isDragCreatable&&this.model.getNonObjectsState().ui.currentTool.inputIndex===0&&this.model.attemptLockToolInputIn(this.getSpec())}tryCommitResults(){if(this.model.attemptLockToolInputIn(this.getSpec()),this._isReadyToCommit()){let e=this.model.getUncommittedObjects();for(let i in e)e[i].type==="expression-edit-preview-latex"&&delete e[i];let r=__dcg_shared_module_exports__['b']({},this.model.getNonObjectsState().ui.currentTool.idMap);return this.model.commitObjects(),this.model.deselectAllObjects(),this.model.cancelToolplay(),{committed:e,toolIdToLatex:r}}return{committed:void 0}}onMove(e){var n,o;this.clearTentativeOutputs();let r=this.canNextInputBePoint(),i=this.getNonPointInputType();if(r||i){let s=!1;if(i){let a=this.model.getObjectDefUnderMouse(e.pt,e.tolerance);if(a&&this.model.objectIsInstanceOf(a,i))if(a.polygonEdgeInfo){let l=this.model.createToolInputDependency({type:"polygon-segment",parents:[(n=a.polygonEdgeInfo)==null?void 0:n.polygonDef.referenceLatex],edgeNumber:((o=a.polygonEdgeInfo)==null?void 0:o.edgeNumber)||0},this.getSpec(),0);this.model.setObjectHovered({tokenId:l,listIndex:void 0});let c=l;this.model.tentativelyMatchToolInput(this.getSpec(),c),s=!0}else{let l=this.getExpandedReferenceForDef(a,e.shift);this.model.setObjectHovered({calcId:a.calcId,listIndex:this.getListIndexForHover(a,e.shift)}),this.model.tentativelyMatchToolInput(this.getSpec(),l),s=!0}}if(!s&&r){let a=this._getOrCreatePoint(e.pt,e.shift,e.tolerance);a.def&&!a.createdNew&&this.model.setObjectHovered({calcId:a.def.calcId,listIndex:this.getListIndexForHover(a.def,e.shift)}),this.toolType!=="custom"&&!!this.model.getNonObjectsState().ui.currentTool.lockedIds[a.reference]||this.model.tentativelyMatchToolInput(this.getSpec(),a.reference)}}this.createOutput()}getNumberInputLatex(){let e=this.getSpec(),{idMap:r,inputIndex:i}=this.model.getNonObjectsState().ui.currentTool,n=e.inputs[i];return n&&n.type==="number"&&r[n.id]||""}onNumberInput(e){this.clearTentativeOutputs(),this.model.tentativelyMatchToolInput(this.getSpec(),e),this.createOutput()}createPointDefinition(e,r){let i=e.parentDefs,n;switch(e.type){case"point-reference":{n={type:"point-reference",parents:[this.getExpandedReferenceForDef(i[0],r)]};break}default:{let o=i.map(s=>this.getExpandedReferenceForDef(s,r));n=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},e),{parents:o})}}return n}};function zD(t,e){if(typeof e=="object")return e.valueTypes.some(r=>__dcg_shared_module_exports__['xb'](t,r));switch(e){case"point":return t===__dcg_shared_module_exports__['Ta'];case"straight":return t===__dcg_shared_module_exports__['hb']||t===__dcg_shared_module_exports__['jb']||t===__dcg_shared_module_exports__['bb'];case"angle":return t===__dcg_shared_module_exports__['lb']||t===__dcg_shared_module_exports__['nb'];case"arc":return t===__dcg_shared_module_exports__['fb'];case"circle":return t===__dcg_shared_module_exports__['db'];case"polygon":return t===__dcg_shared_module_exports__['$a'];case"segment":return t===__dcg_shared_module_exports__['bb'];case"number":return t===__dcg_shared_module_exports__['Sa'];default:return e}}var h7="graphing-calculator-text-geometry-tool-point-hint",db=class extends Gi{constructor(r){super(r);this.model=r;this.displayName="graphing-calculator-text-geometry-tool-point-display-name",this.toolName="point",this.toolType="simple",this.icon=[{type:"point",x:50,y:50,size:"large"}]}getSpec(){return{inputs:[{type:"point",id:"1",hint:h7}],outputs:[]}}};var p7="graphing-calculator-text-geometry-tool-line-hint-start",u7="graphing-calculator-text-geometry-tool-line-hint-end",hb=class extends Gi{constructor(r){super(r);this.model=r;this.displayName="graphing-calculator-text-geometry-tool-line-display-name",this.toolType="simple",this.toolName="line",this.isDragCreatable=!0,this.icon=[{type:"stroked-path",path:[78,22,22,78],lineWidth:"large"},{type:"point",x:68,y:32},{type:"point",x:32,y:68}]}getSpec(){return{inputs:[{type:"point",id:"1",hint:p7},{type:"point",id:"2",hint:u7}],outputs:[{id:"3",type:"line",hidden:!1,parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"}]}]}}};var g7="graphing-calculator-text-geometry-tool-segment-hint-start",m7="graphing-calculator-text-geometry-tool-segment-hint-end",pb=class extends Gi{constructor(r){super(r);this.model=r;this.displayName="graphing-calculator-text-geometry-tool-segment-display-name",this.toolName="segment",this.isDragCreatable=!0,this.toolType="simple",this.icon=[{type:"stroked-path",path:[68,32,32,68],lineWidth:"large"},{type:"point",x:68,y:32},{type:"point",x:32,y:68}]}getSpec(){return{inputs:[{type:"point",id:"1",hint:g7},{type:"point",id:"2",hint:m7}],outputs:[{id:"3",type:"segment",hidden:!1,parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"}]}]}}};var f7="graphing-calculator-text-geometry-tool-ray-hint-start",y7="graphing-calculator-text-geometry-tool-ray-hint-end",ub=class extends Gi{constructor(r){super(r);this.model=r;this.displayName="graphing-calculator-text-geometry-tool-ray-display-name",this.toolName="ray",this.isDragCreatable=!0,this.toolType="simple",this.icon=[{type:"stroked-path",path:[78,22,32,68],lineWidth:"large"},{type:"point",x:68,y:32},{type:"point",x:32,y:68}]}getSpec(){return{inputs:[{type:"point",id:"1",hint:f7},{type:"point",id:"2",hint:y7}],outputs:[{id:"3",type:"ray",hidden:!1,parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"}]}]}}};var b7="graphing-calculator-text-geometry-tool-circle-hint-center",w7="graphing-calculator-text-geometry-tool-circle-hint-radius",gb=class extends Gi{constructor(r){super(r);this.model=r;this.displayName="graphing-calculator-text-geometry-tool-circle-display-name",this.toolName="circle",this.isDragCreatable=!0,this.toolType="simple",this.icon=[{type:"circle",x:50,y:50,radius:26},{type:"point",x:50,y:50},{type:"point",x:68,y:32}]}getSpec(){return{inputs:[{type:"point",id:"1",hint:b7},{type:"point",id:"2",hint:w7}],outputs:[{id:"3",type:"circle",hidden:!1,parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"}]}]}}};var x7="graphing-calculator-text-geometry-tool-arc-hint-1",v7="graphing-calculator-text-geometry-tool-arc-hint-2",C7="graphing-calculator-text-geometry-tool-arc-hint-3",mb=class extends Gi{constructor(r){super(r);this.model=r;this.displayName="graphing-calculator-text-geometry-tool-arc-display-name",this.toolName="arc",this.toolType="complex";let i=50,n=80,o=80,s=-3,a=-2.6,l=-1.7;this.icon=[{type:"arc",x:n,y:o,radius:i,startAngle:s,endAngle:l},{type:"point",x:n+i*Math.cos(s),y:o+i*Math.sin(s)},{type:"point",x:n+i*Math.cos(a),y:o+i*Math.sin(a)},{type:"point",x:n+i*Math.cos(l),y:o+i*Math.sin(l)}]}getSpec(){return{inputs:[{type:"point",id:"1",hint:x7},{type:"point",id:"2",hint:v7},{type:"point",id:"3",hint:C7}],outputs:[{id:"4",type:"arc",hidden:!1,parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"},{type:"reference-input",id:"3"}]}]}}};var D7="graphing-calculator-text-geometry-tool-parallel-hint-straight-line",S7="graphing-calculator-text-geometry-tool-parallel-hint-point",fb=class extends Gi{constructor(r){super(r);this.model=r;this.displayName="graphing-calculator-text-geometry-tool-parallel-display-name",this.toolName="parallel",this.toolType="complex",this.icon=[{type:"stroked-path",color:"light",path:[25,50,75,30],lineWidth:"large"},{type:"stroked-path",path:[25,70,75,50],lineWidth:"large"},{type:"point",x:50,y:60,size:"medium"}]}getSpec(){return{inputs:[{type:"straight",id:"1",hint:D7},{type:"point",id:"2",hint:S7}],outputs:[{id:"3",type:"parallel",hidden:!1,parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"}]}]}}};var E7="graphing-calculator-text-geometry-tool-perpendicular-hint-straight-line",k7="graphing-calculator-text-geometry-tool-perpendicular-hint-point",yb=class extends Gi{constructor(r){super(r);this.model=r;this.displayName="graphing-calculator-text-geometry-tool-perpendicular-display-name",this.toolName="perpendicular",this.toolType="complex",this.icon=[{type:"stroked-path",color:"light",path:[40,25,60,75],lineWidth:"large"},{type:"stroked-path",path:[25,60,75,40],lineWidth:"large"},{type:"point",x:50,y:50,size:"medium"}]}getSpec(){return{inputs:[{type:"straight",id:"1",hint:E7},{type:"point",id:"2",hint:k7}],outputs:[{id:"3",type:"perpendicular",hidden:!1,parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"}]}]}}};var IM="graphing-calculator-text-geometry-tool-midpoint-hint",bb=class extends Gi{constructor(r){super(r);this.model=r;this.displayName="graphing-calculator-text-geometry-tool-midpoint-display-name",this.toolName="midpoint",this.toolType="simple",this.icon=[{type:"stroked-path",path:[32,32,68,68]},{type:"point",x:50,y:50,size:"large"}]}canNextInputBePoint(){return!0}getNonPointInputType(){let{inputIndex:r}=this.model.getNonObjectsState().ui.currentTool;if(r===0)return"segment"}getSpec(){let{idMap:r}=this.model.getNonObjectsState().ui.currentTool,i=r[1],n=i&&this.model.findDefsForInputId(i)[0];return n&&n.typedRuntimeValue.valueType==__dcg_shared_module_exports__['Ta']?{inputs:[{type:"point",id:"1",hint:IM},{type:"point",id:"2",hint:IM}],outputs:[{id:"midpoint-output",type:"midpoint",hidden:!1,parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"}]}]}:{inputs:[{type:"segment",id:"1",hint:IM}],outputs:[{id:"midpoint-output",type:"midpoint",hidden:!1,parents:[{type:"reference-input",id:"1"}]}]}}};var G7="graphing-calculator-text-geometry-tool-polygon-hint-first-point",V7="graphing-calculator-text-geometry-tool-polygon-hint-next-point",I7="graphing-calculator-text-geometry-tool-polygon-hint-finish-point",wb=class extends Gi{constructor(r){super(r);this.model=r;this.addExtraPoint=!1;this.mouseOverFirstPoint=!1;this.displayName="graphing-calculator-text-geometry-tool-polygon-display-name",this.toolName="polygon",this.toolType="complex",this.icon=[{type:"filled-polygon",path:[40,30,70,70,30,60,40,30]},{type:"stroked-path",path:[40,30,70,70,30,60,40,30]},{type:"point",x:40,y:30},{type:"point",x:70,y:70},{type:"point",x:30,y:60}]}clearTentativeOutputs(){let r=this.addExtraPoint;this.addExtraPoint=!0,super.clearTentativeOutputs(),this.addExtraPoint=r}getHint(){let r=this.model.getNonObjectsState().ui.currentTool.inputIndex;return r===0?this.s(G7):r<3?this.s(V7):this.s(I7)}canNextInputBePoint(){return!0}getSpec(){let{inputIndex:r}=this.model.getNonObjectsState().ui.currentTool,i=r;this.addExtraPoint&&(i+=1),i<2&&(i=2);for(var n={inputs:[],outputs:[]},o=[],s=0;s<i;s++){let a=s.toString();o.push({type:"reference-input",id:a}),n.inputs.push({type:"point",id:a})}return n.outputs.push({id:"polygon",type:"polygon",hidden:!1,parents:o,connectBorder:!this.addExtraPoint}),n}tryCommitResults(){this.addExtraPoint=!this.mouseOverFirstPoint;let r=this.getSpec();if(this.addExtraPoint=!1,this.model.attemptLockToolInputIn(r),!this.mouseOverFirstPoint)return{committed:void 0};if(this._isReadyToCommit()){this.mouseOverFirstPoint=!1;let i=this.model.getUncommittedObjects(),n=__dcg_shared_module_exports__['b']({},this.model.getNonObjectsState().ui.currentTool.idMap);return this.model.commitObjects(),this.model.deselectAllObjects(),this.model.cancelToolplay(),{committed:i,toolIdToLatex:n}}return{committed:void 0}}onMove(r){this.clearTentativeOutputs(),this.mouseOverFirstPoint=!1;let i=this.model.getObjectDefUnderMouse(r.pt,r.tolerance),{idMap:n}=this.model.getNonObjectsState().ui.currentTool;if(i){let s=this.getExpandedReferenceForDef(i,r.shift);if(this.model.objectIsInstanceOf(i,"point")&&this.model.isObjectALockedToolInput(s)&&n[0]===s){this.mouseOverFirstPoint=!0,i&&this.model.setObjectHovered({calcId:i.calcId,listIndex:this.getListIndexForHover(i,r.shift)}),this.createOutput();return}}this.addExtraPoint=!0;let o=this._getOrCreatePoint(r.pt,r.shift,r.tolerance);this.model.tentativelyMatchToolInput(this.getSpec(),o.reference),o.def&&!o.createdNew&&this.model.setObjectHovered({calcId:o.def.calcId,listIndex:this.getListIndexForHover(o.def,r.shift)}),this.createOutput(),this.addExtraPoint=!1}};var M7="graphing-calculator-text-geometry-tool-compass-hint-segment",T7="graphing-calculator-text-geometry-tool-compass-hint-center",xb=class extends Gi{constructor(r){super(r);this.model=r;this.displayName="graphing-calculator-text-geometry-tool-compass-display-name",this.toolName="compass",this.toolType="complex",this.icon=[{type:"stroked-path",path:[50,50,75,50]},{type:"circle",x:50,y:50,radius:25}]}getSpec(){return{inputs:[{type:"segment",id:"1",hint:M7},{type:"point",id:"2",hint:T7}],outputs:[{id:"3",type:"circle",hidden:!1,parents:[{type:"reference-input",id:"2"},{type:"reference-input",id:"1"}]}]}}};var A7="graphing-calculator-text-geometry-tool-angle-hint-1",L7="graphing-calculator-text-geometry-tool-angle-hint-2",P7="graphing-calculator-text-geometry-tool-angle-hint-3",ZR="graphing-calculator-text-geometry-tool-angles-hint-1",ou=class extends Gi{constructor(r){super(r);this.model=r;this.toolType="complex",this.displayName="graphing-calculator-text-geometry-tool-angle-display-name",this.toolName="angle",this.angleType="angle",this.anglesType="angles",this.icon=[{type:"stroked-path",path:[40,30,30,70,70,70],color:"#CCC"},{type:"angle",x:30,y:70,radius:20,startAngle:-1.325817,deltaAngle:1.325817,isDirected:!1},{type:"point",x:30,y:70},{type:"point",x:40,y:30},{type:"point",x:70,y:70}]}canNextInputBePoint(){return!0}shouldReferenceSpecificItemInList(r,i){return __dcg_shared_module_exports__['yb'](r.typedRuntimeValue.valueType,__dcg_shared_module_exports__['$a'])?!0:super.shouldReferenceSpecificItemInList(r,i)}getNonPointInputType(){let{inputIndex:r}=this.model.getNonObjectsState().ui.currentTool;if(r===0)return"polygon"}getSpec(){let{inputIndex:r,idMap:i}=this.model.getNonObjectsState().ui.currentTool,n=i[1];if(!r&&!n)return{inputs:[{type:"polygon",id:"1",hint:ZR}],outputs:[{id:"2",type:this.anglesType,listAccess:void 0,hidden:!1,showLabel:!0,label:"",parents:[{type:"reference-input",id:"1"}]}]};let o=[];if(n&&this.model.findDefsForInputId(n).forEach(a=>{let l=a.typedRuntimeValue;if(l.valueType===__dcg_shared_module_exports__['$a']){let c=l.value.length;c>0&&o.push({referenceLatex:a.referenceLatex,sides:c})}}),o.length){let s=[],a=2;return o.forEach(l=>{for(var c=0;c<l.sides;c++)s.push({id:a+"",type:this.anglesType,listAccess:c+1,hidden:!1,showLabel:!0,label:"",parents:[{type:"hardcoded",id:l.referenceLatex}]}),a+=1}),{inputs:[{type:"polygon",id:"1",hint:ZR}],outputs:s}}return{inputs:[{type:"point",id:"1",hint:A7},{type:"point",id:"2",hint:L7},{type:"point",id:"3",hint:P7}],outputs:[{id:"4",type:this.angleType,hidden:!1,showLabel:!0,label:"",parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"},{type:"reference-input",id:"3"}]}]}}};var vb=class extends ou{constructor(r){super(r);this.model=r;this.displayName="graphing-calculator-text-geometry-tool-directedangle-display-name",this.toolName="directedangle",this.angleType="directedangle",this.anglesType="directedangles",this.icon=[{type:"stroked-path",path:[40,30,30,70,70,70],color:"#CCC"},{type:"angle",x:30,y:70,radius:20,isDirected:!0,startAngle:-1.325817,deltaAngle:1.325817},{type:"stroked-path",path:[35,50,41,50,37,55,35,50],color:"#000",lineWidth:"medium"},{type:"point",x:30,y:70},{type:"point",x:40,y:30},{type:"point",x:70,y:70}]}};var cc=class extends Gi{generateDefaultName(){return"does not matter"}};var Cb=class extends cc{constructor(r){super(r);this.model=r;this.displayName="graphing-calculator-text-geometry-tool-reflect-display-name",this.toolName="reflection",this.toolType="transformation"}getSpec(){return{inputs:[{type:"straight",id:"1",hint:"graphing-calculator-text-geometry-tool-reflection-hint-choose-line"}],outputs:[{id:"2",type:"reflect",hidden:!1,name:this.generateDefaultName(),parents:[{type:"reference-input",id:"1"}]}]}}};var Db=class extends cc{constructor(r){super(r);this.model=r;this.displayName="graphing-calculator-text-geometry-tool-translate-display-name",this.toolName="translation",this.toolType="transformation"}getSpec(){return{inputs:[{type:"point",id:"1",hint:"graphing-calculator-text-geometry-tool-translation-hint-from"},{type:"point",id:"2",hint:"graphing-calculator-text-geometry-tool-translation-hint-to"}],outputs:[{id:"3",type:"translate",hidden:!1,name:this.generateDefaultName(),parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"}]}]}}};var Sb=class extends cc{constructor(r){super(r);this.model=r;this.displayName="graphing-calculator-text-geometry-tool-rotate-display-name",this.toolName="rotation",this.toolType="transformation"}getSpec(){return{inputs:[{type:"point",id:"1",hint:"graphing-calculator-text-geometry-tool-rotation-hint-center"},{type:"number",id:"2",hint:"graphing-calculator-text-geometry-tool-rotation-hint-angle",defaultLatex:this.model.controller.isDegreeMode()?"90":"\\frac{\\pi}{2}",sliderInfo:{value:this.model.controller.isDegreeMode()?"90":"1.57079632679",min:"0",max:this.model.controller.isDegreeMode()?"360":"2\\pi"}}],outputs:[{id:"3",type:"rotate",hidden:!1,name:this.generateDefaultName(),parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"}]}]}}};var Eb=class extends cc{constructor(r){super(r);this.model=r;this.displayName="graphing-calculator-text-geometry-tool-dilate-display-name",this.toolName="dilation",this.toolType="transformation"}getSpec(){return{inputs:[{type:"point",id:"1",hint:"graphing-calculator-text-geometry-tool-dilation-hint-center"},{type:"number",id:"2",hint:"graphing-calculator-text-geometry-tool-dilation-hint-scale-factor",defaultLatex:"2",sliderInfo:{value:"2",min:"0",max:"5"}}],outputs:[{id:"3",type:"dilate",hidden:!1,name:this.generateDefaultName(),parents:[{type:"reference-input",id:"1"},{type:"reference-input",id:"2"}]}]}}};var kb=class{constructor(){this.displayName="graphing-calculator-text-geometry-tool-box-selection-display-name";this.toolType="selection";this.icon=[{type:"stroked-path",color:"#aaa",path:[35,35,51,35,51,51,35,51,35,35]},{type:"filled-polygon",color:"#000",path:[50,50,63.5,62,58.25,62.75,62,72.5,59.75,74,55.25,64.25,50.75,68,50,50]}]}getNumberInputLatex(){return""}clearTentativeOutputs(){}canNextInputBePoint(){return!1}getNecessaryComplexObject(){}getNonPointInputType(){}getHint(){return""}onNumberInput(e){}onPress(){}onMove(e){}tryCommitResults(){return{committed:void 0}}};var Yd=class extends Gi{constructor(r){super(r);this.model=r;this.toolType="custom",this.toolName="expression-edit"}getSpec(){let r=this.model.controller.getSelectedItem(),i=MM(this.model.controller.getValidCursorContext());return!i||!r||r.type!=="expression"?{inputs:[],outputs:[]}:{inputs:[{type:"union",valueTypes:i,id:"1"}],outputs:[{type:"expression-edit-preview-latex",rhsLatex:this.buildPreviewLatex(),hidden:!1,color:r.color,id:"2",parents:[]}]}}buildPreviewLatex(){let r="",i="",n=this.model.controller.getValidCursorContext();if((n==null?void 0:n.type)==="empty")return"";(n==null?void 0:n.type)==="expression-arguments"&&((n==null?void 0:n.positionWithinArg)==="end"?r=",":(n==null?void 0:n.positionWithinArg)==="start"&&(i=","));let o=this.model.getNonObjectsState().ui.currentTool.idMap,s=r+o[1]+i,a=this.model.controller.getSelectedItem();if((a==null?void 0:a.type)!=="expression")return"";let l=Xe.getFocusedMathquill(),c=l==null?void 0:l.selection();if((c==null?void 0:c.latex)!==a.latex)return"";let d=a.latex.slice(0,c.startIndex)+s+a.latex.slice(c.endIndex);return a.formula.assignment?d.slice(a.latex.indexOf("=")+1):d}canNextInputBePoint(){let r=this.model.controller.getValidCursorContext();if((r==null?void 0:r.type)!=="expression-arguments"||r.expressionType!=="FunctionCall"&&r.expressionType!=="List")return!1;let i=MM(r);if(!i)return!1;let n=!1;for(let o of i){if(__dcg_shared_module_exports__['yb'](o,__dcg_shared_module_exports__['Ra']))return!1;__dcg_shared_module_exports__['yb'](o,__dcg_shared_module_exports__['Ta'])&&(n=!0)}return n}shouldHighlightRelevantObjects(){let r=this.model.controller.getValidCursorContext(),i=MM(r);return!(!i||i.some(n=>__dcg_shared_module_exports__['yb'](n,__dcg_shared_module_exports__['Ra']))||i.every(n=>__dcg_shared_module_exports__['yb'](n,__dcg_shared_module_exports__['Sa'])||__dcg_shared_module_exports__['yb'](n,__dcg_shared_module_exports__['lb'])||__dcg_shared_module_exports__['yb'](n,__dcg_shared_module_exports__['nb'])))}};function MM(t){if((t==null?void 0:t.type)==="empty")return[__dcg_shared_module_exports__['lb'],__dcg_shared_module_exports__['nb'],__dcg_shared_module_exports__['mb'],__dcg_shared_module_exports__['ob']];let e=(t==null?void 0:t.type)==="expression-arguments"?t.allowedTypesForInsertedArg:t==null?void 0:t.allowedTypes;return e==null?void 0:e.filter(r=>!__dcg_shared_module_exports__['yb'](r,__dcg_shared_module_exports__['rb']))}var TM={selection:cb,point:db,line:hb,segment:pb,ray:ub,circle:gb,arc:mb,parallel:fb,perpendicular:yb,midpoint:bb,polygon:wb,compass:xb,angle:ou,directedangle:vb,reflect:Cb,translate:Db,rotate:Sb,dilate:Eb,"box-selection":kb,"expression-edit":Yd};function O7(t,e){var s;if(e.typedRuntimeValue.valueType===__dcg_shared_module_exports__['pb'])return[];let r=e.data.call;if(!r||!r.parents)return[];let i=r.symbol,n=r.parents.map(am),o;switch(i){case"circle":{let[a,l]=n,c=l&&((s=t[l])==null?void 0:s.typedRuntimeValue.valueType);c&&__dcg_shared_module_exports__['yb'](c,__dcg_shared_module_exports__['bb'])?o=[a]:o=[a,l];break}case"apply":{o=[n[1]];break}case"parallel":case"perpendicular":{o=[n[1]];break}case"polygon":{o=n.every(a=>a!==void 0)?n:[];break}default:o=n}return o.filter(tN)}var _7=[[1,0],[0,0],!1],$D=class{constructor(e,r){let i=(e==null?void 0:e.list)||[];r&&(i=i.concat(r)),this.list=i;let n=(e==null?void 0:e.forward)||_7;r&&(n=__dcg_shared_module_exports__['Ka'](n,r.value)),this.forward=n,this.inverse=__dcg_shared_module_exports__['La'](n)}add(e){return new $D(this,e)}equals(e){if(this.list.length!==e.list.length)return!1;for(let r=this.list.length-1;r>=0;r--){let i=this.list[r],n=e.list[r];if(!__dcg_shared_module_exports__['F'](i,n))return!1}return!0}isCompletelyRigid(){return this.list.length===0}},Gb=$D;Gb.COMPLETELY_RIGID=new $D(void 0);function F7(t){var i,n;let e={},r={};for(let o in t){let s=t[o];if(!s)continue;for(let l of((i=s.data.call)==null?void 0:i.parents)||[]){let c=am(l);c&&(e[c]||(e[c]=[]),(n=e[c])==null||n.push(s.assignment))}let a=O7(t,s);r[s.assignment]=a}return{parentToChildren:e,childToReversibilityParents:r}}function eN(t){let e=[],r={},i,n=1,o=2;function s(a){var l;r[a]!==o&&(r[a]=n,(l=t[a])==null||l.forEach(s),r[a]=o,e.unshift(a))}for(let a in t)r[a]===i&&s(a);return e}function AM(t,e){var u,p,g,b,x,w,E,k,S,T;let r={},i={},n={},o={},s={};for(let V of e)s[V]=!0,n[V]=Gb.COMPLETELY_RIGID;let{parentToChildren:a,childToReversibilityParents:l}=F7(t);for(let V of eN(l)){let O=t[V];if(!O)return{};let y=(u=O.data.call)==null?void 0:u.symbol,L=(((p=O.data.call)==null?void 0:p.parents)||[]).map(am).filter(tN);if(n[O.assignment])if(O.typedRuntimeValue.valueType===__dcg_shared_module_exports__['Ta']&&!y)r[O.assignment]=n[O.assignment];else if(y==="glider"&&L.length&&!s[L[0]])i[O.assignment]=n[O.assignment];else{let P=n[O.assignment];if(y==="apply"){let $=(g=t[L[0]])==null?void 0:g.typedRuntimeValue;if(($==null?void 0:$.valueType)!==__dcg_shared_module_exports__['pb'])return{};P=P.add($)}let K=(b=l[O.assignment])!=null?b:[];for(let $ of K)n[$]?P.equals(n[$])||(n[$]=Gb.COMPLETELY_RIGID,o[$]=!0):n[$]=P}}let c={};for(let V in n)c[V]=!0;for(let V of eN(a))if(c[V]){for(let O of a[V]||[])c[O]=!0;if(n[V]){let O=l[V]||[];for(let y of O)o[y]&&(o[V]=!0)}}for(let V in i){let y=(((w=(x=t[V])==null?void 0:x.data.call)==null?void 0:w.parents)||[]).map(am)[0];y&&c[y]&&(o[y]=!0)}for(let V in t){if(!c[V])continue;let O=t[V],y=(E=O==null?void 0:O.data.call)==null?void 0:E.symbol,L=(((k=O==null?void 0:O.data.call)==null?void 0:k.parents)||[]).map(am);if(y==="apply"&&n[V]){let P=L[1],K=L[0];if(!P||!K)return{};let $=(((T=(S=t[K])==null?void 0:S.data.call)==null?void 0:T.parents)||[]).map(am),U=$.some(R=>R&&c[R]);if(n[V].isCompletelyRigid()&&n[P].isCompletelyRigid()||U){o[P]=!0;for(let R of $)R&&(o[R]=!0)}}}let d=[];for(let V in o)s[V]||d.push(V);return d.length?AM(t,e.concat(d)):__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['b']({},r),i)}function am(t){return t?__dcg_shared_module_exports__['Hb'](t[0]):void 0}function tN(t){return t!==void 0}var Vb=class{constructor(){this._nextId=0;this._defs={}}clear(){this._nextId=0,this._defs={}}add(e,r){let i;r?(i=e.assignment,e.listIndex!==void 0&&(i+="\\left["+e.listIndex+"\\right]")):i="**geo-internal-id-"+this._nextId++,this._defs[i]=e}computeReversibilityLineages(e){var a;let r=this.buildAssignmentMap(),i={};for(let l in r){let c=r[l];c&&(i[c.calcId]=c)}let n=[];for(let l of e){let c=i[l];if(!c)return{};n.push(c.assignment)}let o=AM(this.buildAssignmentMap(),n),s={};for(let l in o){let c=(a=r[l])==null?void 0:a.calcId;c&&(s[c]=o[l])}return s}buildAssignmentMap(){let e={};for(let r in this._defs){let i=this._defs[r];i&&(e[i.assignment]=i)}return e}getDepthValues(){var c,d;var e={},r={};let i=this.buildAssignmentMap();for(let u in i){let p=i[u];if(!p)continue;let g=__dcg_shared_module_exports__['Jb'](p.assignment),b=[],x=[];(c=p.data.call)!=null&&c.parents?x=(d=p.data.call)==null?void 0:d.parents:p.data.assignmentRhsReference&&(x=[p.data.assignmentRhsReference]),x.forEach(w=>{let E=w&&w[0];E&&(b.push(E),r[E]||(r[E]=[]),r[E].push(__dcg_shared_module_exports__['Jb'](g)))}),e[g]=b}let n=u=>{if(o[u]!==void 0)return o[u];var p=-1,g=e[u]||[];for(let x=0;x<g.length;x++){let w=n(g[x]);w>p&&(p=w)}let b=p+1;return o[u]=b,b};var o={};for(var s in e)o[s]=n(s);var a={},l={};for(var s in r){let p=o[s],g=1/0;r[s].forEach(b=>{let x=o[b];x>p&&(p=x),x<g&&(g=x)}),a[s]=p,l[s]=g}return{createdDepth:o,lastReferencedDepth:a,firstReferencedDepth:l}}};function rN(t,e,r){let n=.5/(2*r*e);return fi(t-n,t+n)}function Ib(t,e,r,i,n=0){let o=__dcg_shared_module_exports__['aa'](t.x,t.y,0,r[0],r[1],0,i[0],i[1],0);n&&(o+=n);let a=.5/(__dcg_shared_module_exports__['qa'](r,i)*e);return fi(o-a,o+a)}function dc(t,e){for(let r of e)r&&(r.min!==void 0&&t<r.min?t=r.min:r.max!==void 0&&t>r.max&&(t=r.max));return t}function WD(t,e,r,i){if(!r)return 0;var n=t.mapx(1)-t.mapx(0);switch(r.valueType){case __dcg_shared_module_exports__['db']:{let s=e.x-r.value[0][0],a=e.y-r.value[0][1],l=Math.atan2(a,s)/(2*Math.PI);l<0&&(l+=1),l=rN(l,n,r.value[1]);let c=dc(0,[i]),d=dc(1,[i]);if(l>=c&&l<=d)return l;{let u=__dcg_shared_module_exports__['wa'](r.value,c),p=__dcg_shared_module_exports__['wa'](r.value,d),g=__dcg_shared_module_exports__['qa'](u,[e.x,e.y]),b=__dcg_shared_module_exports__['qa'](p,[e.x,e.y]);return g<=b?c:d}}case __dcg_shared_module_exports__['fb']:{let s=__dcg_shared_module_exports__['za'](r.value);if(!s)return 0;if(s.type==="segment"){let a=Ib(e,n,s.start,s.end);return dc(a,[{min:0,max:1},i])}else if(s.type==="rays"){let a=__dcg_shared_module_exports__['qa'](s.start1,[e.x,e.y]),l=__dcg_shared_module_exports__['qa'](s.start2,[e.x,e.y]),c=!i||i.min===void 0?-1/0:i.min,d=!i||i.max===void 0?1/0:i.max;return a<l?c>0?d>=1?1:c:dc(-Ib(e,n,s.start1,s.end1),[{min:void 0,max:0},i]):d<1?c<=0?0:d:dc(Ib(e,n,s.start2,s.end2,1),[{min:1,max:void 0},i])}else if(s.type=="arc"){let[a,l]=s.center,{radius:c,startAngle:d}=s,u=__dcg_shared_module_exports__['sa'](r.value),p=e.x-a,g=e.y-l,b=__dcg_shared_module_exports__['Y'](Math.atan2(g,p),d,u);if(b>=0&&b<=1)b=rN(b,n,c);else{let E=wD(e,{x:a+c*Math.cos(d),y:l+c*Math.sin(d)}),k=wD(e,{x:a+c*Math.cos(d+u),y:l+c*Math.sin(d+u)});E<=k?b=0:b=1}let x=dc(0,[i]),w=dc(1,[i]);if(b>=x&&b<=w)return b;{let E=__dcg_shared_module_exports__['xa'](r.value,x),k=__dcg_shared_module_exports__['xa'](r.value,w),S=__dcg_shared_module_exports__['qa'](E,[e.x,e.y]),T=__dcg_shared_module_exports__['qa'](k,[e.x,e.y]);return S<=T?x:w}}return dc(0,[i])}case __dcg_shared_module_exports__['jb']:case __dcg_shared_module_exports__['bb']:case __dcg_shared_module_exports__['hb']:{let s=Ib(e,n,r.value[0],r.value[1]);return dc(s,[{min:r.valueType===__dcg_shared_module_exports__['hb']?void 0:0,max:r.valueType!==__dcg_shared_module_exports__['bb']?void 0:1},i])}case __dcg_shared_module_exports__['$a']:{let s=r.value,a=1/0,l=dc(0,[i]),c=i&&i.min!==void 0?i.min:-1/0,d=i&&i.max!==void 0?i.max:1/0,u=Math.floor(Math.max(c,0)),p=Math.ceil(Math.min(d,s.length));for(let g=u;g<p;g++){let b=s[g],x=s[(g+1)%s.length],w=dc(Ib(e,n,b,x,g),[{min:g,max:g+1},i]),E=__dcg_shared_module_exports__['ya'](r.value,w),k=__dcg_shared_module_exports__['qa'](E,[e.x,e.y]);k<a&&(a=k,l=w)}return l}case __dcg_shared_module_exports__['Ta']:case __dcg_shared_module_exports__['lb']:case __dcg_shared_module_exports__['nb']:case __dcg_shared_module_exports__['pb']:return 0;default:return r}}function iN(t,e){switch(t.valueType){case __dcg_shared_module_exports__['db']:return __dcg_shared_module_exports__['wa'](t.value,e);case __dcg_shared_module_exports__['fb']:return __dcg_shared_module_exports__['xa'](t.value,e);case __dcg_shared_module_exports__['jb']:return __dcg_shared_module_exports__['va'](t.value,e);case __dcg_shared_module_exports__['bb']:return __dcg_shared_module_exports__['ua'](t.value,e);case __dcg_shared_module_exports__['hb']:return __dcg_shared_module_exports__['ta'](t.value,e);case __dcg_shared_module_exports__['$a']:return __dcg_shared_module_exports__['ya'](t.value,e);case __dcg_shared_module_exports__['Ta']:case __dcg_shared_module_exports__['lb']:case __dcg_shared_module_exports__['nb']:case __dcg_shared_module_exports__['pb']:return[NaN,NaN];default:return t}}function R7(t,e){if(!e)return!1;let{left:r,right:i,top:n,bottom:o}=t.pixelCoordinates,{x:s,y:a}=e.mathPoint;if(e.transform){let l=e.model.formula.typed_constant_value;if((l==null?void 0:l.valueType)!==__dcg_shared_module_exports__['Ta'])throw new Error(`Expected movable point to be a Point but found ${l?__dcg_shared_module_exports__['sb'](l.valueType):void 0} instead`);s=s!=null?s:l.value[0],a=a!=null?a:l.value[1],[s,a]=__dcg_shared_module_exports__['Ma'](e.transform.forward,[s,a])}if(s!==void 0){let l=t.mathToPixels.mapX(s);if(l<r-.5||l>i+.5)return!1}if(a!==void 0){let l=t.mathToPixels.mapY(a);if(l<n-.5||l>o+.5)return!1}return!0}function nN(t,e){if(e.length===1&&!R7(t,e[0]))return!1;let r=!1;for(let i of e){if(i.newPointLatex){let n=i.model.latex;Bs(i.model,i.newPointLatex),r=r||n!==i.model.latex}for(let n in i.sliderUpdates){let{value:o,model:s}=i.sliderUpdates[n];i.commitSliderSoftLimits&&ug(s);let a=s.latex;Gv(s,o),r=r||a!==s.latex}}return r}function oN({projection:t,transform:e,controller:r,strategy:i,mode:n,clampToViewport:o}){var T;let s=r.getItemModel(i.id);if(!s||s.type!=="expression")throw new Error(`Programming error: updateSliderNonlinear move strategy should point to an expression item, but found ${s==null?void 0:s.type}`);let a=n==="up"||n==="bigup",l=((T=s.slider)==null?void 0:T.step)!==""&&(a&&!s.slider.hardMax||!a&&!s.slider.hardMin);i.compiled.fn||__dcg_shared_module_exports__['Wb'](i.compiled);let c=i.compiled.fn;e&&(c=V=>__dcg_shared_module_exports__['Ma'](e.forward,i.compiled.fn(V)));let d=V=>{let[O,y]=c(V);return{x:O,y}=t.mathToPixels.mapPoint({x:O,y}),[O,y]},u=Ns(s),[p,g]=d(u),b=UV(s,n,{ignoreSoftLimits:l}),x=b,[w,E]=d(x),k=__dcg_shared_module_exports__['_'](w-p,E-g);if(k<1){let V=__dcg_shared_module_exports__['la'](d,[p+(w-p)/k,g+(E-g)/k],x,x>u?x:i.min,x<u?x:i.max,1);if(V){let O=fi(V[0],V[1]);(n==="bigup"||n==="bigdown")&&(O=u+(O-u)*5);let y=hl(s,__dcg_shared_module_exports__['ka'](O,i.min,i.max),{ignoreSoftLimits:l}),[L,P]=d(y);__dcg_shared_module_exports__['_'](L-p,P-g)>k&&(b=y)}}o&&(b=aN(t,Ns(s),b,c));let S=c(b);return{mathPoint:{x:S[0],y:S[1]},sliderUpdates:{[i.id]:{model:s,value:b}}}}function sN({controller:t,projection:e,transform:r,strategy:i,targetScreenPoint:n,clampToViewport:o}){let s={mathPoint:{},sliderUpdates:{}},a=t.getItemModel(i.id);if(!a||a.type!=="expression")throw new Error(`Programming error: updateSliderNonlinear move strategy should point to an expression item, but found ${a==null?void 0:a.type}`);i.compiled.fn||__dcg_shared_module_exports__['Wb'](i.compiled);let l=i.compiled.fn;r&&(l=S=>__dcg_shared_module_exports__['Ma'](r.forward,i.compiled.fn(S)));let c=S=>{let[T,V]=l(S);return{x:T,y:V}=e.mathToPixels.mapPoint({x:T,y:V}),[T,V]},d=i.initialValue,u=i.min,p=i.max,g=[n.x,n.y],b=__dcg_shared_module_exports__['la'](c,g,d,u,p,1);if(!b)return s;let x=fi(b[0],b[1]);u!==void 0&&x<u&&(x=u),p!==void 0&&x>p&&(x=p);let w=hl(a,x,{ignoreSoftLimits:!0});o&&(w=aN(e,Ns(a),w,l));let[E,k]=l(w);return s.mathPoint.x=E,s.mathPoint.y=k,s.sliderUpdates[a.id]={value:w,model:a},s}function PM({controller:t,projection:e,transform:r,strategy:i,targetScreenPoint:n}){let o=e.reverse_map_pt(n);if(r){let d=__dcg_shared_module_exports__['Ma'](r.inverse,[o.x,o.y]);o={x:d[0],y:d[1]}}let s=i.type==="updateSliderForGlider"?{min:i.min,max:i.max}:void 0,a=WD(e,o,i.movesOn,s);if(!isFinite(a))return;let l=iN(i.movesOn,a),c={mathPoint:{x:l[0],y:l[1]},newPointLatex:void 0,sliderUpdates:{}};if(i.type==="updateGliderParameter"){let d=i.span;c.newPointLatex=d.input.slice(0,d.start)+__dcg_shared_module_exports__['lc'](a)+d.input.slice(d.end)}else if(i.type==="updateSliderForGlider"){let d=t.getItemModel(i.id);d&&d.type==="expression"&&(c.sliderUpdates[d.id]={value:a,model:d})}return c}function aN(t,e,r,i){let n=d=>{let[u,p]=i(d);return t.mathToPixels.mapPoint({x:u,y:p})},o=({x:d,y:u})=>{let{left:p,right:g,top:b,bottom:x}=t.pixelCoordinates;return d>=p&&d<=g&&u>=b&&u<=x},s=e,a=n(e),l=r,c=n(r);if(o(c)||!o(a))return r;for(;;){let d=a.x-c.x,u=a.y-c.y;if(d*d+u*u<.5)break;let p=__dcg_shared_module_exports__['ja'](s,l);if(p===s||p===l){[s,l]=o(a)?[s,s]:[l,l];break}let g=n(p);o(g)!==o(a)?[l,c]=[p,g]:[s,a]=[p,g]}return fi(s,l)}function OM({controller:t,projection:e,transform:r,formula:i,moveStrategy:n,dragMode:o,targetScreenPoint:s,clampToViewport:a}){if(r){let{x:g,y:b}=e.pixelsToMath.mapPoint(s),[x,w]=__dcg_shared_module_exports__['Ma'](r.inverse,[g,b]);s=e.mathToPixels.mapPoint({x,y:w})}var l=e.pixelsToMath.mapRect({left:s.x-.5,right:s.x+.5,top:s.y+.5,bottom:s.y-.5}),c=[{min:l.left,max:l.right},{min:l.top,max:l.bottom}];let d={mathPoint:{},sliderUpdates:{}},[u,p]=n;if(u.type==="updateCoordinate"||p.type==="updateCoordinate"){let g=N7(i,c,o);if(g){let{latex:b,x,y:w}=g;(x!==void 0||w!==void 0)&&(d.newPointLatex=b,d.mathPoint.x=x!=null?x:d.mathPoint.x,d.mathPoint.y=w!=null?w:d.mathPoint.y)}}for(let g of[0,1]){let b=n[g];if(LM(g,o)&&b.type==="updateSlider"){let x=t.getItemModel(b.id);if(!x||x.type!=="expression")continue;let[w,E]=b.coefficients,k=fi(E*c[g].min+w,E*c[g].max+w),S=hl(x,k,{ignoreSoftLimits:!0}),T=(S-w)/E;if(!a||r){d.mathPoint[g===0?"x":"y"]=T,d.sliderUpdates[x.id]={value:S,model:x};continue}let[V,O]=g===0?[e.mathCoordinates.left,e.mathCoordinates.right]:[e.mathCoordinates.bottom,e.mathCoordinates.top],y=T<V?V:T>O?O:void 0;y!==void 0&&ul(x)===void 0?(d.mathPoint[g===0?"x":"y"]=y,d.sliderUpdates[x.id]={value:E*y+w,model:x}):(d.mathPoint[g===0?"x":"y"]=T,d.sliderUpdates[x.id]={value:S,model:x})}}return d}function N7(t,e,r){if(!t.move_strategy)throw new Error("Programming error: expected move_strategy to be defined.");var i=fi(e[0].min,e[0].max),n=fi(e[1].min,e[1].max);let[o,s]=t.move_strategy,a=!1,l=!1,c,d="",u=0;if(o.type==="updateCoordinate"&&LM(0,r)&&(c=o.inputSpan.input,a=!0,d+=c.slice(u,o.inputSpan.start),d+=__dcg_shared_module_exports__['lc'](i),u=o.inputSpan.end),s.type==="updateCoordinate"&&LM(1,r)&&(c=s.inputSpan.input,l=!0,d+=c.slice(u,s.inputSpan.start),d+=__dcg_shared_module_exports__['lc'](n),u=s.inputSpan.end),c!==void 0)return d+=c.slice(u),{latex:d,x:a?i:void 0,y:l?n:void 0}}function LM(t,e){switch(e){case"X":return t===0;case"Y":return t===1;case"XY":return!0;default:return!1}}function lN(t,e,r){r.forEach(i=>{B7(t,e,i)})}function cN(t,e,r,i,n,o,s){var a=!1,l=e.length===1;let c=[];for(let u=0;u<e.length;u++){let p=e[u];if(p.tableInfo){U7(t,p,i[u],n),a=!0;continue}var d=t.getItemModel(p.sketch.id);if(d){if(d.type==="image")a=a||z7(t,d,p,i[u],n);else if(d.type==="expression"){let g=$7({controller:t,movedExpr:d,currentScreenPoint:r[u],targetScreenPoint:i[u],projection:n,transform:o&&o[u],isOnlyPoint:l,keyboardDirection:s});g&&c.push(g)}}}return a=a||nN(n,c),a}function dN(t,e){e.forEach(r=>{K7(t,r)})}function B7(t,e,r){if(r.tableInfo){ri(e,void 0);let a=t.getItemModel(r.tableInfo.tableId);if(!a||a.type!=="table")return;GI(a,!0)}else{let a=t.getItemModel(r.sketch.id);if(!a||!(a.type==="expression"||a.type==="image")||!a.formula||!a.formula.move_strategy)return;for(var i=a.formula.move_strategy,n=0;n<i.length;n++){let l=i[n];if(i[n].type==="updateCoordinate"||i[n].type==="updateGliderParameter")a.type==="image"?uI(a,!0):a.type==="expression"&&zV(a,!0);else if(l.type==="updateSlider"||l.type==="updateSliderNonlinear"||l.type==="updateSliderForGlider"){var o=t.getItemModel(l.id);if(!o||o.type!=="expression")continue;var s;if(a.type==="expression"?s=a.reconciledDragMode:s=void 0,s==="NONE"||n===0&&s==="Y"||n===1&&s==="X")continue;ty(o,!0)}}}}function K7(t,e){for(let r of t.getAllItemModels())r.type==="table"?r.draggingOnGraphpaper&&GI(r,!1):r.type==="expression"?(r.sliderDragging&&ty(r,!1),r.draggingOnGraphpaper&&zV(r,!1)):r.type==="image"&&r.draggingOnGraphpaper&&uI(r,!1)}function U7(t,e,r,i){var n=e.tableInfo.tableId,o=e.tableInfo.rowIndex,s=e.tableInfo.columnId,a=e.tableInfo.dragX,l=e.tableInfo.dragY,c=t.getItemModel(n);if(!(!c||c.type!=="table")){var d=Bo(c,s);if(d){var u=i.closestPointOnScreen(r),p=i.pixelsToMath.mapRect(hN(u,.5)),g={x:__dcg_shared_module_exports__['kc'](fi(p.left,p.right)),y:__dcg_shared_module_exports__['kc'](fi(p.top,p.bottom))};if(a&&Fd(c,{row:o+1,column:0},g.x),l){let b=d.index;Fd(c,{row:o+1,column:b},g.y)}}}}function hN(t,e){return{left:t.x-e,right:t.x+e,top:t.y+e,bottom:t.y-e}}function q7(t,e,r){if(r[0]===0&&r[1]===0)return{x:e.x,y:e.y,width:t.width,height:t.height};let i=Math.cos(t.radianAngle),n=Math.sin(t.radianAngle),o=e.x-t.x,s=e.y-t.y;if(r[0]===0)return{x:t.x,y:t.y,width:t.width,height:2*r[1]*(i*s+n*o)};if(r[1]===0)return{x:t.x,y:t.y,width:2*r[0]*(i*o-n*s),height:t.height};var a=2*(t.width*r[0]*(i*o-n*s)+t.height*r[1]*(n*o+i*s))/(t.width*t.width+t.height*t.height);return{x:t.x,y:t.y,width:a*t.width,height:a*t.height}}function H7(t,e,r){let i=[{x:e.left,y:e.bottom},{x:e.left,y:e.top},{x:e.right,y:e.top},{x:e.right,y:e.bottom}],n=["x","y","width","height"],o={x:1/0,y:1/0,width:1/0,height:1/0},s={x:-1/0,y:-1/0,width:-1/0,height:-1/0};for(let a of i){let l=q7(t,a,r);for(let c of n)o[c]=Math.min(o[c],l[c]),s[c]=Math.max(s[c],l[c])}return{min:o,max:s}}function Mb(t){return t===void 0?NaN:t[0]}function z7(t,e,r,i,n){var z;var o=e.formula;if(!o||((z=o.move_strategy)==null?void 0:z.length)!==4)return!1;var s=o.dimensions,a={x:Mb(s.x),y:Mb(s.y),width:Mb(s.width),height:Mb(s.height),radianAngle:Mb(s.radianAngle)},l=r.scaleFactor||[0,0],c=l[0]!==0&&l[1]!==0,d=n.closestPointOnScreen(i),u=n.pixelsToMath.mapRect(hN(d,c?.05:.5)),p=H7(a,u,l),g=n.mathToPixels.mapRect({left:a.x-.5*a.width,right:a.x+.5*a.width,top:a.y-.5*a.height,bottom:a.y+.5*a.height}),b=Math.abs(g.right-g.left),x=Math.abs(g.bottom-g.top),w=n.mathToPixels.mapRect({left:p.min.x-.5*p.min.width,right:p.min.x+.5*p.min.width,top:p.min.y-.5*p.min.height,bottom:p.min.y+.5*p.min.height}),E=Math.abs(w.right-w.left),k=Math.abs(w.bottom-w.top);if(E<b&&E<1||k<x&&k<1)return!1;var S=["width","height","x","y"];let T=!1;for(var V=0;V<S.length;V++){var O=S[V],y=o.move_strategy[V];switch(y.type){case"updateCoordinate":var L=fi(p.min[O],p.max[O]),P=y.inputSpan.input,K=__dcg_shared_module_exports__['kc'](L);switch(O){case"width":case"height":ya(e,O,K);break;case"x":if(o.move_strategy[3].type==="updateCoordinate"){let fe=o.move_strategy[3],ie=fi(p.min.y,p.max.y),Le=__dcg_shared_module_exports__['kc'](ie),pe=P.slice(0,y.inputSpan.start)+K+P.slice(y.inputSpan.end,fe.inputSpan.start)+Le+P.slice(fe.inputSpan.end);ya(e,"center",pe)}else{let fe=P.slice(0,y.inputSpan.start)+K+P.slice(y.inputSpan.end);ya(e,"center",fe)}break;case"y":if(o.move_strategy[2].type!=="updateCoordinate"){let fe=P.slice(0,y.inputSpan.start)+K+P.slice(y.inputSpan.end);ya(e,"center",fe)}break;default:return O}T=!0;break;case"updateSlider":var $=t.getItemModel(y.id);if(!$||$.type!=="expression")continue;var U=y.coefficients[0],J=y.coefficients[1],R=J*p.min[O]+U,q=J*p.max[O]+U,_=fi(R,q),A=$.latex;Gv($,_),$.latex!==A&&(T=!0);break}}return T}function $7({controller:t,movedExpr:e,currentScreenPoint:r,targetScreenPoint:i,projection:n,transform:o,isOnlyPoint:s,keyboardDirection:a}){var b,x;let l=e.formula;if(!l||((b=l.move_strategy)==null?void 0:b.length)!==2)return;let c=e.reconciledDragMode||"NONE",[d,u]=l.move_strategy;if(s&&d.type==="updateCoordinate"&&u.type==="updateCoordinate"){let w=n.reverse_map_pt(i),E=_M(n,w);E&&(i=n.map_pt(E))}let p=s?n.closestPointOnScreen(i):i;if(!a){let w;switch(d.type){case"updateSliderNonlinear":w=sN({controller:t,projection:n,transform:o,strategy:d,targetScreenPoint:p,clampToViewport:s});break;case"updateGliderParameter":case"updateSliderForGlider":w=PM({controller:t,projection:n,transform:o,strategy:d,targetScreenPoint:p});break;default:w=OM({controller:t,projection:n,transform:o,formula:l,moveStrategy:l.move_strategy,dragMode:c,targetScreenPoint:p,clampToViewport:s})}return w&&__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},w),{commitSliderSoftLimits:!1,transform:o,model:e})}let g;if(d.type==="updateSliderNonlinear"){if(!(a!=null&&a.x))return;g=oN({projection:n,transform:o,controller:t,strategy:d,mode:a.x,clampToViewport:s})}else if(d.type==="updateGliderParameter"||d.type==="updateSliderForGlider")g=PM({controller:t,projection:n,transform:o,strategy:d,targetScreenPoint:p});else{let w=a.x?0:1,E=a.x?p.x-r.x:p.y-r.y,k=l.move_strategy[w];if(k.type==="updateSlider"){let S=t.getItemModel(k.id);if((S==null?void 0:S.type)!=="expression")throw new Error(`Programming error: updateSlider move strategy should point to an expression item, but found ${S==null?void 0:S.type}`);let T=ul(S);if(T){let V=n.mathToPixels.mapPoint({x:0,y:0}),O=k.coefficients[1],y=Math.abs(w===0?n.mathToPixels.mapX(T/O)-V.x:n.mathToPixels.mapY(T/O)-V.y),L=Math.ceil(1/y);E=y*L*(E>0?1:-1);let P=(x=a.x)!=null?x:a.y;(P==="bigup"||P==="bigdown")&&(E*=5)}}g=OM({controller:t,projection:n,transform:o,formula:l,moveStrategy:l.move_strategy,dragMode:c,targetScreenPoint:{x:r.x+(w===0?E:0),y:r.y+(w===1?E:0)},clampToViewport:s})}return g&&__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},g),{commitSliderSoftLimits:!0,transform:o,model:e})}function _M(t,e){if(!t.settings.showGrid)return;let r=Jh(t),i=r.minorStepX,n=r.minorStepY,o=t.map_pt(e),s=Math.round(e.x/i)*i,a=Math.round(e.y/n)*n,l=5,c={x:s,y:a},d=t.map_pt(c);if(__dcg_shared_module_exports__['_'](d.x-o.x,d.y-o.y)<=l)return c}function gN(t,e){let r={i:0,x:NaN,y:NaN},i={i:1,x:NaN,y:NaN};if(!t||!e)return[r,i];let n=pN(t.typedRuntimeValue),o=pN(e.typedRuntimeValue);if(!n||!o)return[r,i];let s=uN(n,o);return r.x=s[0],r.y=s[1],s=uN(o,n),i.x=s[0],i.y=s[1],[r,i]}function pN(t){switch(t.valueType){case __dcg_shared_module_exports__['bb']:case __dcg_shared_module_exports__['hb']:case __dcg_shared_module_exports__['jb']:return{type:"straight",def:t.value};case __dcg_shared_module_exports__['db']:return{type:"circle",def:t.value};case __dcg_shared_module_exports__['fb']:return{type:"arc",def:t.value}}}function uN(t,e){switch(t.type){case"straight":switch(e.type){case"straight":return __dcg_shared_module_exports__['Da'](t.def,e.def);case"circle":return __dcg_shared_module_exports__['Ba'](t.def,e.def);case"arc":return __dcg_shared_module_exports__['Fa'](t.def,e.def)}case"circle":switch(e.type){case"straight":return __dcg_shared_module_exports__['Ca'](t.def,e.def);case"circle":return __dcg_shared_module_exports__['Aa'](t.def,e.def);case"arc":return __dcg_shared_module_exports__['Ea'](t.def,e.def)}case"arc":switch(e.type){case"straight":return __dcg_shared_module_exports__['Ha'](t.def,e.def);case"circle":return __dcg_shared_module_exports__['Ga'](t.def,e.def);case"arc":return __dcg_shared_module_exports__['Ia'](t.def,e.def)}}return[NaN,NaN]}var mN=[{key:"compass",objects:"Segment + Point"},{key:"midpoint",objects:"Segment"},{key:"parallel",objects:"Line + Point"},{key:"perpendicular",objects:"Line + Point"},{key:"image",objects:"2 Points"}];function hc(t){return __dcg_shared_module_exports__['E'](t)}function pc(t){this.setState(t)}pc.prototype.setState=function(t){this.state=t};pc.prototype.getState=function(){return this.state};pc.prototype.set=function(t,e){if(arguments.length===1){this.state=t;return}else if(typeof t=="string"){this.state=hc(this.state),this.state[t]=e;return}var r=t.length-2,i=t[r+1],n;this.state=n=hc(this.state);for(var o=0;o<=r;o++){var s=t[o];n=n[s]=hc(n[s])}n[i]=e};pc.prototype.deepMutate=function(t,e){if(arguments.length===1){e=t,this.state=__dcg_shared_module_exports__['N'](this.state),e(this.state);return}else if(typeof t=="string"){this.state=hc(this.state),this.state[t]=__dcg_shared_module_exports__['N'](this.state[t]),e(this.state[t]);return}for(var r=t.length-2,i=t[r+1],n=this.state=hc(this.state),o=0;o<=r;o++){var s=t[o];n=n[s]=hc(n[s])}n=n[i]=__dcg_shared_module_exports__['N'](n[i]),e(n)};pc.prototype.shallowMutate=function(t,e){if(arguments.length===1){e=t,this.state=hc(this.state),e(this.state);return}else if(typeof t=="string"){this.state=hc(this.state),this.state[t]=hc(this.state[t]),e(this.state[t]);return}for(var r=t.length-1,i=this.state=hc(this.state),n=0;n<=r;n++){var o=t[n];i=i[o]=hc(i[o])}e(i)};pc.areShallowEqual=function(t,e){};pc.areDeepEqual=function(t,e){};function Tb(t){return t?!!(W7(t)||t==="Circle"||t==="Arc"||t==="Polygon"):!1}function W7(t){if(!t)return!1;switch(t){case"Line":case"Ray":case"Vector":case"Segment":return!0}return!1}function FM(t,e){if(t.indexOf("\\idref_{")===0){let r=t.indexOf("}"),i=t.slice(8,r);return e(i)+t.slice(r+1)}else return t}function RM(t,e,r){let i=s=>r?s.map(a=>FM(a,r)):s;switch(t.type){case"point-reference":return{latex:`${t.id}=${t.parents[0]}`,color:t.color};case"point":var{x:n,y:o}=t;return{latex:t.id+"=\\left("+__dcg_shared_module_exports__['kc'](n)+","+__dcg_shared_module_exports__['kc'](o)+"\\right)",color:t.color};case"glider":return{latex:t.id+"=\\operatorname{glider}\\left("+i(t.parents)[0]+","+__dcg_shared_module_exports__['kc'](t.t)+"\\right)",color:t.color};case"polygon":{let a="";return!e&&t.connectBorder&&(a=","+t.parents[0]),{latex:t.id+"=\\operatorname{"+t.type+"}\\left("+i(t.parents).join(",")+a+"\\right)",color:t.color}}case"circle":case"arc":case"compass":case"segment":case"line":case"ray":case"parallel":case"perpendicular":case"intersection":case"midpoint":return{latex:t.id+"=\\operatorname{"+t.type+"}\\left("+i(t.parents).join(",")+"\\right)",color:t.color};case"translate":case"reflect":case"dilate":case"rotate":{let a=t.type==="dilate"||t.type==="rotate"?[...i([t.parents[0]]),t.parents[1]]:i(t.parents);return{latex:`${t.id}\\left(x\\right)=\\operatorname{${t.type}}\\left(x,${a.join(",")}\\right)`,color:t.color}}case"angle":case"directedangle":return{showLabel:!0,latex:t.id+"=\\operatorname{"+t.type+"}\\left("+i(t.parents).join(",")+"\\right)",color:t.color};case"angles":case"directedangles":return{showLabel:e,latex:t.id+"=\\operatorname{"+t.type+"}\\left("+i(t.parents).join(",")+"\\right)"+(t.listAccess!==void 0?"\\left["+t.listAccess+"\\right]":""),color:t.color};case"polygon-segment":return{latex:t.id+"="+i(t.parents)[0]+(t.listAccess!==void 0?"\\left["+t.listAccess+"\\right]":"")+".\\operatorname{segments}\\left["+(t.edgeNumber+1)+"\\right]",color:t.color};case"slider":return{latex:t.latex,color:t.color,sliderInfo:t.sliderInfo};case"transformed-object":return;case"expression-edit-preview-latex":return t.rhsLatex===""?void 0:{latex:t.id+"="+t.rhsLatex,color:t.color};default:return t}}function NM(t,e){switch(t.valueType){case __dcg_shared_module_exports__['Xa']:t.value.forEach((r,i)=>{e({valueType:__dcg_shared_module_exports__['Ta'],value:r},i+1)});break;case __dcg_shared_module_exports__['eb']:t.value.forEach((r,i)=>{e({valueType:__dcg_shared_module_exports__['db'],value:r},i+1)});break;case __dcg_shared_module_exports__['cb']:t.value.forEach((r,i)=>{e({valueType:__dcg_shared_module_exports__['bb'],value:r},i+1)});break;case __dcg_shared_module_exports__['kb']:t.value.forEach((r,i)=>{e({valueType:__dcg_shared_module_exports__['jb'],value:r},i+1)});break;case __dcg_shared_module_exports__['ib']:t.value.forEach((r,i)=>{e({valueType:__dcg_shared_module_exports__['hb'],value:r},i+1)});break;case __dcg_shared_module_exports__['ab']:t.value.forEach((r,i)=>{e({valueType:__dcg_shared_module_exports__['$a'],value:r},i+1)});break;case __dcg_shared_module_exports__['gb']:t.value.forEach((r,i)=>{e({valueType:__dcg_shared_module_exports__['fb'],value:r},i+1)});break;case __dcg_shared_module_exports__['mb']:t.value.forEach((r,i)=>{e({valueType:__dcg_shared_module_exports__['lb'],value:r},i+1)});break;case __dcg_shared_module_exports__['ob']:t.value.forEach((r,i)=>{e({valueType:__dcg_shared_module_exports__['nb'],value:r},i+1)});break;default:e(t,void 0)}}function Ab(t,e,r={expandLists:!0}){t.getAllItemModels().concat(t.getAllToolPreviewItems()).forEach(n=>{if(n.type!=="expression"||!n.latex)return;let o=n.formula.typed_constant_value;if(!o)return;var s=n.formula.geometry;if(!s)return;let a=s;var l=s.identifier;let c=l?__dcg_shared_module_exports__['Hb'](l):"\\idref_{"+n.id+"}",d=!t.getItemModel(n.id);r.expandLists?NM(o,(u,p)=>{let g=c+(p===void 0?"":"\\left["+p+"\\right]"),b={calcId:n.id,data:a,hidden:yy(n),assignment:c,listIndex:p,typedRuntimeValue:u,referenceLatex:g};e(b,d)}):e({calcId:n.id,data:a,hidden:yy(n),assignment:c,listIndex:void 0,typedRuntimeValue:o,referenceLatex:c},d)})}function j7(t,e){switch(t.valueType){case __dcg_shared_module_exports__['Xa']:return{valueType:__dcg_shared_module_exports__['Ta'],value:t.value[e]};case __dcg_shared_module_exports__['eb']:return{valueType:__dcg_shared_module_exports__['db'],value:t.value[e]};case __dcg_shared_module_exports__['cb']:return{valueType:__dcg_shared_module_exports__['bb'],value:t.value[e]};case __dcg_shared_module_exports__['kb']:return{valueType:__dcg_shared_module_exports__['jb'],value:t.value[e]};case __dcg_shared_module_exports__['ib']:return{valueType:__dcg_shared_module_exports__['hb'],value:t.value[e]};case __dcg_shared_module_exports__['ab']:return{valueType:__dcg_shared_module_exports__['$a'],value:t.value[e]};case __dcg_shared_module_exports__['gb']:return{valueType:__dcg_shared_module_exports__['fb'],value:t.value[e]};case __dcg_shared_module_exports__['mb']:return{valueType:__dcg_shared_module_exports__['lb'],value:t.value[e]};case __dcg_shared_module_exports__['ob']:return{valueType:__dcg_shared_module_exports__['nb'],value:t.value[e]};case __dcg_shared_module_exports__['Za']:case __dcg_shared_module_exports__['Va']:case __dcg_shared_module_exports__['Ua']:case __dcg_shared_module_exports__['qb']:case __dcg_shared_module_exports__['Wa']:case __dcg_shared_module_exports__['_a']:case __dcg_shared_module_exports__['Ya']:throw new Error("Programming Error: unexpected type "+__dcg_shared_module_exports__['tb'](t.valueType));default:throw t.valueType,new Error("Programming Error: expected a list type but found "+__dcg_shared_module_exports__['tb'](t.valueType))}}function BM(t,e){return __dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},t),{referenceLatex:t.assignment+"\\left["+e+"\\right]",typedRuntimeValue:j7(t.typedRuntimeValue,e),listIndex:e})}function fN(t){if(!t)return;switch(t.typedRuntimeValue.valueType){case __dcg_shared_module_exports__['Ta']:return"Point";case __dcg_shared_module_exports__['db']:return"Circle";case __dcg_shared_module_exports__['fb']:return"Arc";case __dcg_shared_module_exports__['$a']:return"Polygon";case __dcg_shared_module_exports__['hb']:return"Line";case __dcg_shared_module_exports__['bb']:return"Segment";case __dcg_shared_module_exports__['jb']:return"Ray";case __dcg_shared_module_exports__['lb']:return"Angle";case __dcg_shared_module_exports__['nb']:return"Angle"}}var J7=!0,Y7=!1,bN="**dcg_geo_tool_output_slider**";function X7(){return{point:__dcg_shared_module_exports__['T'].PURPLE,line:__dcg_shared_module_exports__['T'].BLUE,circle:__dcg_shared_module_exports__['T'].GREEN,polygon:__dcg_shared_module_exports__['T'].BLUE,angle:__dcg_shared_module_exports__['T'].BLACK}}function Q7(t,e){let r=[],i=t.parents;for(let n=0;n<i.length;n++){let o=i[n];o.type==="hardcoded"?r[n]=o.id:r[n]=e[o.id]}return r}var Lb=class{constructor(e){this._nextObjectId=0;this.clear(),this.controller=e,this.s=this.controller.s,this._tools={};for(let r in TM)this._tools[r]=new TM[r](this)}onPreviewChange(){var s,a;var e=this.controller.getToolPreviewJSONState(),r=this.getUncommittedObjects();if(this.getCurrentTool()instanceof Yd&&!this.controller.getValidCursorContext()){r=__dcg_shared_module_exports__['b']({},r);for(let l in e){let c=e[l];c.type==="expression-edit-preview-latex"&&(r[l]=c)}}for(var n in r){var o=r[n];o.type==="polygon"&&this.isObjectHovered(o.parents[0])&&o.parents.push(o.parents[0])}__dcg_shared_module_exports__['F'](e,r)?this.controller.dispatch({type:"render"}):this.controller.dispatch({type:"set-tool-preview-state",state:r}),(a=(s=this.controller.getGrapher())==null?void 0:s.poiController)==null||a.updateGeoHoveredObjects()}peekNextObjectId(){return"\\token{"+this._nextObjectId.toString()+"}"}generateObjectId(){let e=this.peekNextObjectId();return this._nextObjectId+=1,e}updateNextObjectId(e){e>this._nextObjectId&&(this._nextObjectId=e)}clear(){let e={objects:{},ui:{currentTool:{name:"selection",idMap:{},reusableInputIdMap:{},lockedIds:{},inputIndex:0,outputHistory:{}},colors:X7()},hoveredObjects:[],uncommittedIds:{},selectedIds:{},nextSelectionNumber:1,fadeAnimations:{},maxAnimationEndTime:0};this.store?this.store.set(e):this.store=new pc(e)}onMouseAction(e,r){let i=this.getCurrentTool();if(i instanceof Yd&&!this.controller.getValidCursorContext())return{committed:void 0};if(i.getNumberInputLatex())return{committed:void 0};switch(this.updateNextObjectId(this.controller.findLastTokenNumber()+1),this.clearHoveredObjects(),e){case"press":return i.onMove(r),i.onPress(),{committed:void 0};case"move":return i.onMove(r),{committed:void 0};case"release":return i.onMove(r),i.tryCommitResults()}}getNonObjectsState(){return __dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.store.getState()),{objects:void 0})}getCurrentTool(){return this.getTool(this.getToolMode())}getTool(e){return this._tools[e]}defaultColorForObject(e,r){switch(r.type){case"point":case"point-reference":case"midpoint":case"glider":case"intersection":return e.colors.point;case"line":case"segment":case"polygon-segment":case"ray":case"perpendicular":case"parallel":return e.colors.line;case"circle":case"compass":case"arc":return e.colors.circle;case"polygon":return e.colors.polygon;case"angle":case"angles":case"directedangle":case"directedangles":return e.colors.angle;case"dilate":case"translate":case"reflect":case"rotate":return __dcg_shared_module_exports__['T'].GRAY;case"transformed-object":case"slider":return __dcg_shared_module_exports__['T'].BLACK;case"expression-edit-preview-latex":return r.color||__dcg_shared_module_exports__['T'].BLACK;default:return r}}_deselectAll(){this.store.shallowMutate(e=>{e.nextSelectionNumber=1,e.selectedIds={}})}_modifySelection(e){let r=this.getNonObjectsState().nextSelectionNumber;this.store.shallowMutate("selectedIds",i=>{for(let n in e)e[n]?i[n]||(i[n]=r,r+=1):delete i[n]}),this.store.set("nextSelectionNumber",r)}_addObjects(e){this.store.shallowMutate("objects",r=>{for(let i of e)r[i.id]=i})}_deleteObjects(e){if(!e.length)return;let r={};this.store.shallowMutate("objects",i=>{for(let n of e)r[n]=Y7,delete i[n]}),this._modifySelection(r),this.store.shallowMutate("uncommittedIds",i=>{for(let n of e)delete i[n]})}createCustomToolOutput(e){this.generateIdsForNewToolOutputs(e);let{idMap:r}=this.getNonObjectsState().ui.currentTool,i=[],n=this.getNonObjectsState().ui;for(let o of e.outputs){let s=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},o),{id:r[o.id],color:this.defaultColorForObject(n,o),parents:Q7(o,r)});i.push(s)}for(let o of e.inputs)if(o.type==="number"&&o.sliderInfo){let s=r[o.id];ha(s)&&(this.controller.getItemsByIdentifier(__dcg_shared_module_exports__['Jb'](s)).length||i.push({type:"slider",latex:s+"="+o.sliderInfo.value,sliderInfo:o.sliderInfo,id:bN,parents:[],hidden:!1,color:"#000"}))}this._shouldNewObjectsBeMarkedUncommitted()&&this.store.shallowMutate("uncommittedIds",o=>{for(let s of i)o[s.id]=!0}),this._addObjects(i)}_getReusableIdForCurrentInput(e){let r=this.getCurrentTool();if(!r.getSpec)return;let{inputIndex:i,reusableInputIdMap:n}=this.getNonObjectsState().ui.currentTool,s=r.getSpec().inputs[i];if(!s)return;let a=s.id;return e!==void 0&&(a+="-"+e),n[a]}_createInputObject(e,r){let i,n=this._shouldNewObjectsBeMarkedUncommitted();n?i=this._getReusableIdForCurrentInput(r)||this.generateObjectId():i=this.generateObjectId(),n&&this.store.set(["uncommittedIds",i],!0);let o=this.defaultColorForObject(this.getNonObjectsState().ui,e),s=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({hidden:!1},e),{id:i,color:o});return this._addObjects([s]),i}attemptLockToolInputIn(e){let{currentTool:r}=this.getNonObjectsState().ui,i=r.inputIndex,n=e.inputs[i];if(!n)return;let o=n.id,s=r.idMap[o];if(!s){this.getCurrentTool().canNextInputBePoint()||this.controller.dispatch({type:"select-geo-tool",tool:"selection",clearSelection:this.getToolMode()==="expression-edit"});return}this.store.set(["ui","currentTool","inputIndex"],i+1),this.store.set(["ui","currentTool","lockedIds",s],!0);for(var a=0;a<2;a++){let l=o+"-"+a,c=r.idMap[l];c&&this.store.set(["ui","currentTool","lockedIds",c],!0)}this.maybeFillInDefaultNumberInput(e),this.updateFadeAnimations()}maybeFillInDefaultNumberInput(e){let{currentTool:r}=this.getNonObjectsState().ui,i=r.inputIndex,n=e.inputs[i];n&&n.type==="number"&&n.defaultLatex&&!r.idMap[n.id]&&this.getCurrentTool().onNumberInput(n.defaultLatex)}generateIdsForNewToolOutputs(e){let{idMap:r}=this.getNonObjectsState().ui.currentTool,i=!1,n={};for(let o of e.outputs)r[o.id]||(i=!0,n[o.id]=this.generateObjectId());i&&this.store.set(["ui","currentTool","idMap"],__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['b']({},r),n))}tentativelyMatchToolInput(e,r){let{currentTool:i}=this.getNonObjectsState().ui,n=i.inputIndex,o=e.inputs[n];if(!o)return;let s=o.id;this.store.set(["ui","currentTool","idMap",s],r)}createToolInputDependency(e,r,i){let n=this._createInputObject(e,i),{currentTool:o}=this.getNonObjectsState().ui,s=o.inputIndex,a=r.inputs[s];if(!a)throw new Error("programming error: could not find input "+s+" in spec");let l=a.id;return this.store.set(["ui","currentTool","idMap",l+"-"+i],n),n}isObjectALockedToolInput(e){return!!this.getNonObjectsState().ui.currentTool.lockedIds[e]}getEnabledAdditionalTools(){return mN.filter(e=>!0)}getAdditionalTools(){return this.getEnabledAdditionalTools()}isAnyAdditionalToolEnabled(){return this.getAdditionalTools().length>0}setObjectSelected(e){let r={};r[e]=J7,this._modifySelection(r)}setObjectsSelected(e){__dcg_shared_module_exports__['k'](e,r=>{this.setObjectSelected(r)})}deleteSelectedObjects(){let e=this.getSelectedObjectIdsUnsorted();this._deleteObjects(e)}isObjectHovered(e){let r=this.getNonObjectsState().hoveredObjects;for(let i of r)if("calcId"in i&&i.calcId===e)return!0;return!1}isObjectUncommitted(e){return!!this.getNonObjectsState().uncommittedIds[e]}getUncommittedObjectIds(){return Object.keys(this.getNonObjectsState().uncommittedIds)}getUncommittedObjects(){let e={},r=this.store.getState().objects,i=this.getUncommittedObjectIds();for(let n of i)e[n]=r[n];return e}isValidNextInputType(e){let r=this.getCurrentTool(),i=r.getNonPointInputType();return e&&__dcg_shared_module_exports__['ub'](e)&&(e=__dcg_shared_module_exports__['vb'](e)),!!(i&&e&&zD(e,i)||r.canNextInputBePoint()&&e&&zD(e,"point"))}recordCommittedOutput(e){this.store.shallowMutate(["ui","currentTool","outputHistory"],r=>{r[e]=!0})}updateFadeAnimations(){let e=this.controller.getAllItemModels(),r=Date.now(),i=-1/0;this.store.shallowMutate(["fadeAnimations"],n=>{var a,l;let o=this.getCurrentTool(),s=!0;if(o.toolType==="selection"?s=!1:o instanceof Yd&&(s=o.shouldHighlightRelevantObjects()),s)for(let c of e){if(c.type!=="expression"||!c.latex)continue;let d=c.id,u=(a=c.formula)==null?void 0:a.geometry,p;u!=null&&u.unconstructable?p="fade-out":this.isValidNextInputType(__dcg_shared_module_exports__['Ta'])&&(u!=null&&u.valueType)&&!__dcg_shared_module_exports__['yb'](u.valueType,__dcg_shared_module_exports__['lb'])&&!__dcg_shared_module_exports__['yb'](u.valueType,__dcg_shared_module_exports__['nb'])||u!=null&&u.valueType&&__dcg_shared_module_exports__['yb'](u.valueType,__dcg_shared_module_exports__['$a'])&&this.isValidNextInputType(__dcg_shared_module_exports__['bb'])||this.isValidNextInputType(u==null?void 0:u.valueType)||this.store.getState().ui.currentTool.outputHistory[d]?p="fade-in":p="fade-out";let g=this.store.getState().fadeAnimations[d];if(g&&g.type!==p){let b=__dcg_shared_module_exports__['oa'](r-g.start,0,150),x=r+b-150;n[d]={type:p,start:x},i=Math.max(i,x)}else if(p==="fade-out"){let b=(l=g==null?void 0:g.start)!=null?l:r;n[d]={type:"fade-out",start:b},i=Math.max(i,b)}}else{for(let c in n)n[c]={type:"fade-in",start:r-150};i=r-150}}),isFinite(i)&&this.store.set("maxAnimationEndTime",i+150)}getToolFadeOpacity(e){let r=this.controller.getItemModel(e);if((r==null?void 0:r.type)!=="expression")return 1;let i=this.store.getState().fadeAnimations[r.id];if(!i)return 1;let n=Date.now(),o=__dcg_shared_module_exports__['oa']((n-i.start)/150,0,1),s=i.type==="fade-in"?.2:1,a=i.type==="fade-in"?1:.2;return s*(1-o)+a*o}isFading(){return Date.now()<=this.store.getState().maxAnimationEndTime}isObjectSelected(e){return!!this.getNonObjectsState().selectedIds[e]}getSelectedObjectIdsUnsorted(){return Object.keys(this.getNonObjectsState().selectedIds)}getSelectedObjectIdsSorted(){let e=this.getNonObjectsState().selectedIds,r=this.getSelectedObjectIdsUnsorted();return __dcg_shared_module_exports__['u'](r,n=>e[n])}deselectAllObjects(){this._deselectAll()}getToolMode(){return this.getNonObjectsState().ui.currentTool.name}setToolMode(e){let r=this.getToolMode();this.store.set(["ui","currentTool"],{name:e,idMap:{},reusableInputIdMap:{},lockedIds:{},inputIndex:0,outputHistory:e!==r?{}:this.store.getState().ui.currentTool.outputHistory}),this.updateFadeAnimations(),e!==r&&this.controller.isGraphPaperFocused()&&(Nt(this.getCurrentToolDisplayName()+"."),this.speakCurrentGeoToolHint())}resetToolMode(){this.setToolMode(this.getToolMode())}areAnyObjectsHovered(){return!!this.getNonObjectsState().hoveredObjects.length}setObjectHovered(e){this.store.deepMutate(r=>{r.hoveredObjects.push(e)})}objectIsInstanceOf(e,r){let i=e==null?void 0:e.typedRuntimeValue.valueType;if(i)return zD(i,r)}getSelectionBox(){return this.getTool("selection").getSelectionBox()}commitObjects(){this.store.set("uncommittedIds",{}),this.store.set("objects",{})}applyTransformation(e){}getProjection(){return this.controller.getGrapher().getProjection()}_getPixelScaler(){return this.getProjection().mapx(1)-this.getProjection().mapx(0)}_getPixelsFromPoint(e){return this._getPixelScaler()*e-6}_getPixelsAwayFromDef(e,r,i){let n=i.typedRuntimeValue;switch(n.valueType){case __dcg_shared_module_exports__['Ta']:{let u=r.mapx(n.value[0]),p=r.mapy(n.value[1]);return __dcg_shared_module_exports__['_'](e.x-u,e.y-p)-6}case __dcg_shared_module_exports__['hb']:case __dcg_shared_module_exports__['bb']:case __dcg_shared_module_exports__['jb']:{let d=r.mapx(n.value[0][0]),u=r.mapy(n.value[0][1]),p=r.mapx(n.value[1][0]),g=r.mapy(n.value[1][1]);var o=n.valueType===__dcg_shared_module_exports__['hb'],s=n.valueType!==__dcg_shared_module_exports__['bb'],a=__dcg_shared_module_exports__['ca'](e.x,e.y,d,u,p,g,o,s);return a?__dcg_shared_module_exports__['_'](a[0]-e.x,a[1]-e.y):1/0}case __dcg_shared_module_exports__['db']:{let d=n.value[0][0],u=n.value[0][1],p=n.value[1],g=0,b=Math.PI*2,x=r.reverse_mapx(e.x),w=r.reverse_mapy(e.y);var l=__dcg_shared_module_exports__['da'](x,w,d,u,p,g,b);return l?r.screen.width/(r.viewport.xmax-r.viewport.xmin)*__dcg_shared_module_exports__['_'](l[0]-x,l[1]-w):1/0}case __dcg_shared_module_exports__['fb']:{let d=__dcg_shared_module_exports__['za'](n.value);if(!d)return 1/0;let u=(p,g,b,x)=>{let w=r.mapx(p[0]),E=r.mapy(p[1]),k=r.mapx(g[0]),S=r.mapy(g[1]);var T=__dcg_shared_module_exports__['ca'](e.x,e.y,w,E,k,S,b,x);return T?__dcg_shared_module_exports__['_'](T[0]-e.x,T[1]-e.y):1/0};if(d.type==="arc"){let p=r.reverse_mapx(e.x),g=r.reverse_mapy(e.y);var l=__dcg_shared_module_exports__['da'](p,g,d.center[0],d.center[1],d.radius,d.startAngle,d.endAngle);return l?r.screen.width/(r.viewport.xmax-r.viewport.xmin)*__dcg_shared_module_exports__['_'](l[0]-p,l[1]-g):1/0}else return d.type==="segment"?u(d.start,d.end,!1,!1):Math.min(u(d.start1,d.end1,!1,!0),u(d.start2,d.end2,!1,!0))}case __dcg_shared_module_exports__['$a']:{let d=[];return n.value.forEach(u=>{d.push(r.mapx(u[0]),r.mapy(u[1]))}),__dcg_shared_module_exports__['ma'](d,[e.x,e.y])?0:1/0}case __dcg_shared_module_exports__['lb']:case __dcg_shared_module_exports__['nb']:{let d=r.screen.width/(r.viewport.xmax-r.viewport.xmin),u=r.screen.height/(r.viewport.ymax-r.viewport.ymin),[[p,g],b,x]=n.value,w=$g(x,r),E=w/d,k=r.reverse_mapx(e.x),S=r.reverse_mapy(e.y),T=1/0,V=S-g,O=k-p,y=Math.atan2(V,O);if(__dcg_shared_module_exports__['Z'](y,b,x)){var c=__dcg_shared_module_exports__['_'](V*u,O*d);c<=w+7&&(T=0)}else{let L=__dcg_shared_module_exports__['ba'](k,S,p+E*Math.cos(b),g+E*Math.sin(b),p,g),P=__dcg_shared_module_exports__['ba'](k,S,p+E*Math.cos(b+x),g+E*Math.sin(b+x),p,g),K=__dcg_shared_module_exports__['_'](d*(L[0]-k),u*(L[1]-S)),$=__dcg_shared_module_exports__['_'](d*(P[0]-k),u*(P[1]-S));T=Math.min(K,$)}return T}case __dcg_shared_module_exports__['pb']:return 1/0;default:return 1/0}}getAllChoosableDefsUnordered(e){let r=[],i=e.mode==="tab",n=this.getCurrentTool().getNecessaryComplexObject(),o=n===void 0||n==="segment"||n==="straight";if(typeof n=="object")for(let l of n.valueTypes)(__dcg_shared_module_exports__['xb'](__dcg_shared_module_exports__['bb'],l)||__dcg_shared_module_exports__['xb'](__dcg_shared_module_exports__['hb'],l)||__dcg_shared_module_exports__['xb'](__dcg_shared_module_exports__['jb'],l))&&(o=!0);let{lockedIds:s,reusableInputIdMap:a}=this.store.getState().ui.currentTool;return Ab(this.controller,(l,c)=>{let d=l.assignment;for(var u in a)if(a[u]===d&&!s[d])return;if(!l.hidden&&!l.data.unconstructable&&!(this.getToolMode()==="expression-edit"&&l.data.depends_on_selected)&&!(i&&this.isObjectALockedToolInput(l.assignment))&&!(i&&c)){if(i&&this.getToolMode()==="box-selection"){__dcg_shared_module_exports__['yb'](l.typedRuntimeValue.valueType,__dcg_shared_module_exports__['pb'])||r.push(l);return}if(o&&l.typedRuntimeValue.valueType===__dcg_shared_module_exports__['$a']){let g=l;if(g.typedRuntimeValue.valueType===__dcg_shared_module_exports__['$a']){let b=g.typedRuntimeValue.value;for(var p=0;p<b.length;p++){let x=b[p],w=b[(p+1)%b.length],E=g.referenceLatex+".\\operatorname{segments}\\left["+(p+1)+"\\right]",k={calcId:g.calcId,listIndex:g.listIndex,hidden:g.hidden,assignment:E,referenceLatex:E,data:g.data,typedRuntimeValue:{valueType:__dcg_shared_module_exports__['bb'],value:[x,w]},polygonEdgeInfo:{edgeNumber:p,polygonDef:g}};r.push(k)}}}n&&!this.objectIsInstanceOf(l,n)||!n&&i&&!this.objectIsInstanceOf(l,"point")||r.push(l)}}),r}_getObjectsUnderMouse(e,r){let i=this.getAllChoosableDefsUnordered({mode:"mouse"}),n=this.getProjection(),o=[];i.forEach(l=>{let c=this._getPixelsAwayFromDef(e,n,l),d=l.polygonEdgeInfo?-1:0;if(c<=r){let u={def:l,layerNumber:d,pixelsAway:c};o.push(u)}});let s=this.controller.getGrapher().getSketchOrder(),a={};for(let l=0;l<s.length;l++)a[s[l]]=l;return o.sort((l,c)=>{let d=c.layerNumber-l.layerNumber;if(d!==0)return d;let u=l.pixelsAway-c.pixelsAway;if(u!==0)return u;let p=a[l.def.calcId];return a[c.def.calcId]-p}),o}convertCanvasPixelsToPoint(e){return this.getProjection().reverse_map_pt(e)}convertPointToCanvasPixels(e){return this.getProjection().map_pt(e)}deleteObjectsAndRememberReusableId(e){for(let r in e)this._deleteObjects([e[r]]);this._deleteObjects([bN]),this.store.shallowMutate(["ui","currentTool"],r=>r.reusableInputIdMap=e)}getObjectDefUnderMouse(e,r){let i=this.convertPointToCanvasPixels(e),n=this._getObjectsUnderMouse(i,r)[0];return n&&n.def}getOrCreatePointNearMouse(e,r){let i=this.convertPointToCanvasPixels(e),n=this._getObjectsUnderMouse(i,r),o=[];for(let u of n){let p=u.def,g=fN(p);g==="Point"?o.push({def:p,type:g}):g==="Polygon"||Tb(g)&&o.push({def:p,type:g})}let{def:s,type:a}=o[0]||{},{def:l,type:c}=o[1]||{};if(a==="Point")return{type:"def",def:s};if(Tb(a)&&Tb(c)){let u=gN(s,l).map(p=>({x:p.x,y:p.y,i:p.i,pixelsFromPoint:this._getPixelsFromPoint(tu(p.x-e.x,p.y-e.y))}));if(u.sort((p,g)=>p.pixelsFromPoint-g.pixelsFromPoint),u=u.filter(p=>p.pixelsFromPoint<5),u[0]){let p=u[0].i===0?[s,l]:[l,s],g=this.findIncidentPointDef(s,l);if(g!=null&&g.hidden){let b=!1,x;if(NM(g.typedRuntimeValue,(w,E)=>{let[k,S]=w.value,T=this.getProjection().mathToPixels.mapPoint({x:k,y:S});tu(T.x-i.x,T.y-i.y)<r&&(b=!0,x=E)}),b)return x!==void 0&&(g=BM(g,x)),{type:"spec",spec:{type:"point-reference",targetSpec:{type:"intersection",parentDefs:p},parentDefs:[g]}}}return{type:"spec",spec:{type:"intersection",parentDefs:p}}}else return this.makeGliderSpec(e,s)}else if(Tb(a))return this.makeGliderSpec(e,s);let d=this.computeRoundedPt(e);return{type:"spec",spec:{type:"point",x:d.x,y:d.y,parentDefs:[]}}}findIncidentPointDef(e,r){let i=e.typedRuntimeValue.valueType,n=r.typedRuntimeValue.valueType,o={};Ab(this.controller,a=>{if(a.data.identifier&&__dcg_shared_module_exports__['yb'](a.typedRuntimeValue.valueType,__dcg_shared_module_exports__['Ta'])){let l=a.data.identifier;o[l]=a}},{expandLists:!1});let s=__dcg_shared_module_exports__['hc']({getGeometryTree:a=>a.data.call,getValueType:a=>a.typedRuntimeValue.valueType,lookup:a=>o[a],resolvesTo:(a,l)=>a===l.data.identifier},e,i,r,n);if(s){let[a,l]=s,c=o[a];return l===void 0?c:BM(c,l)}}makeGliderSpec(e,r){var i=WD(this.getProjection(),e,r.typedRuntimeValue);return{type:"spec",spec:{type:"glider",t:i,parentDefs:[r]}}}computeRoundedPt(e){var r=this.getProjection(),i=_M(r,e);i&&(e=i);var n=.5/this._getPixelScaler();return{x:fi(e.x-n,e.x+n),y:fi(e.y-n,e.y+n)}}_shouldNewObjectsBeMarkedUncommitted(){return this.getToolMode()!=="selection"}clearHoveredObjects(){this.store.set("hoveredObjects",[])}getHoveredItems(){return this.store.getState().hoveredObjects}cancelToolplay(){this._deleteObjects(this.getUncommittedObjectIds()),this.clearHoveredObjects(),this.resetToolMode()}isToolplayActive(){return this.getNonObjectsState().ui.currentTool.inputIndex>0}getComputedBoard(){let e=new Vb;return Ab(this.controller,(r,i)=>{e.add(r,i)}),e}findDefsForInputId(e){let r=[];return Ab(this.controller,i=>{(i.assignment===e||i.referenceLatex===e)&&r.push(i)}),r}isCreatingNewTransform(){return this.getCurrentTool().toolType==="transformation"}getCurrentToolDisplayName(){return this.controller.s(this.getCurrentTool().displayName)}isCurrentToolComplex(){return this.getCurrentTool().toolType==="complex"}isCurrentToolSingleUse(){return this.getCurrentTool().toolType==="transformation"}getIconInstructionsForTool(e){let r=this.getTool(e);return r?r.icon:[]}getDisplayNameForTool(e){let r=this.getTool(e);return r?this.controller.s(r.displayName):""}getViewportBounds(){return this.controller.getGrapher().getCurrentViewport()}speakCurrentGeoToolHint(){me(this.getCurrentTool().getHint())}};function Z7(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var ez="ID_",sd=function(){function t(){Z7(this,t),this._callbacks={},this._isDispatching=!1,this._isHandled={},this._isPending={},this._lastID=1}return t.prototype.register=function(r){var i=ez+this._lastID++;return this._callbacks[i]=r,i},t.prototype.unregister=function(r){this._callbacks[r]||Pb(!1,"Dispatcher.unregister(...): `%s` does not map to a registered callback.",r),delete this._callbacks[r]},t.prototype.waitFor=function(r){this._isDispatching||Pb(!1,"Dispatcher.waitFor(...): Must be invoked while dispatching.");for(var i=0;i<r.length;i++){var n=r[i];if(this._isPending[n]){this._isHandled[n]||Pb(!1,"Dispatcher.waitFor(...): Circular dependency detected while waiting for `%s`.",n);continue}this._callbacks[n]||Pb(!1,"Dispatcher.waitFor(...): `%s` does not map to a registered callback.",n),this._invokeCallback(n)}},t.prototype.dispatch=function(r){this._isDispatching&&Pb(!1,"Dispatch.dispatch(...): Cannot dispatch in the middle of a dispatch."),this._startDispatching(r);try{for(var i in this._callbacks)this._isPending[i]||this._invokeCallback(i)}finally{this._stopDispatching()}},t.prototype.isDispatching=function(){return this._isDispatching},t.prototype._invokeCallback=function(r){this._isPending[r]=!0,this._callbacks[r](this._pendingPayload),this._isHandled[r]=!0},t.prototype._startDispatching=function(r){for(var i in this._callbacks)this._isPending[i]=!1,this._isHandled[i]=!1;this._pendingPayload=r,this._isDispatching=!0},t.prototype._stopDispatching=function(){delete this._pendingPayload,this._isDispatching=!1},t}();function Pb(t,e,r,i,n,o,s,a){if(e===void 0)throw new Error("invariant requires an error message argument");if(!t){var l;if(e===void 0)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[r,i,n,o,s,a],d=0;l=new Error(e.replace(/%s/g,function(){return c[d++]})),l.name="Invariant Violation"}throw l.framesToPop=1,l}}var Xd=class{constructor(e=100){this.clear(),this._sizeLimit=e}clear(){this._stack=[],this._stackPointer=-1}getState(){return this._stack[this._stackPointer]}serializeForBugsnag(){function e(r){try{return JSON.stringify(r,null,2)}catch(i){return"[[could not jsonify]]"}}return{currentState:e(this._stack[this._stackPointer]),undoState:e(this._stack[this._stackPointer-1]),redoState:e(this._stack[this._stackPointer+1])}}addState(e){this.canRedo()&&this._stack.splice(this._stackPointer+1),this._stack.push(e),this._stack.length>this._sizeLimit&&this._stack.shift(),this._stackPointer=this._stack.length-1}replaceState(e){this.canRedo()&&this._stack.splice(this._stackPointer+1),this.replaceInteriorState(e)}replaceInteriorState(e){this._stack.length===0?(this._stack.push(e),this._stackPointer=0):this._stack[this._stackPointer]=e}canUndo(){return this._stackPointer>0}canRedo(){return this._stackPointer<this._stack.length-1}undo(){this.canUndo()&&(this._stackPointer-=1)}redo(){this.canRedo()&&(this._stackPointer+=1)}};function tz(t){typeof t.min=="number"&&(t.min=""+t.min),typeof t.max=="number"&&(t.max=""+t.max),typeof t.step=="number"&&(t.step=""+t.step)}function rz(t){t.slider&&tz(t.slider),typeof t.id!="string"&&(t.id=""+t.id)}function iz(t){let e=nz(t)+1,r={},i,n;for(let o of t)if(rz(o),o.type==="folder")i=o.id,r[o.id]&&(o.id=""+e,e+=1),n=o.id,r[o.id]=!0,o.hasOwnProperty("folderId")&&delete o.folderId;else{if(i!==void 0&&o.folderId===i?o.folderId=n:(o.folderId&&(o.folderId=""),i=void 0,n=void 0),o.type==="table"&&Array.isArray(o.columns))for(let s of o.columns)r[s.id]&&(s.id=""+e,e+=1),r[s.id]=!0;r[o.id]&&(o.id=""+e,e+=1),r[o.id]=!0}}function wN(t,e){let r=parseFloat(e);return r!==Math.floor(r)?t:Math.max(t,r)}function nz(t){let e=0;for(let r of t)if(e=wN(e,r.id),r.type==="table"&&Array.isArray(r.column))for(let i of r.columns)wN(e,i.id);return e}function jD(t){let e=__dcg_shared_module_exports__['N'](t);return Array.isArray(e.expressions.list)&&iz(e.expressions.list),e}var KM={NONE:"NONE",POSITIVE:"POSITIVE",BOTH:"BOTH"},oz={expression:!0,table:!0,image:!0,folder:!0,text:!0};function sz(t){if(t.type){if(oz.hasOwnProperty(t.type))return t.type;throw new Error("Invalid item type: '"+t.type+"'.")}return t.text!==void 0?"text":t.columns!==void 0||t.headings!==void 0?"table":"expression"}function JD(t){return t.replace(/\\(total|length|mean|median|quantile|stdev|stddev|stdDev|stdevp|stddevp|stdDevP|var|variance|cov|corr|ceil|floor|round|abs|mod|lcm|mcm|mcd|nCr|nPr|signum|sign|arcsinh|arccosh|arctanh|arccsch|arcsech|arccoth|arccsc|arcsec|arccot)/g,"\\operatorname{$1}")}function az(t){var e={};for(var r in t)t.hasOwnProperty(r)&&(r==="latex"?e[r]=JD(t[r]):r==="values"?e[r]=t[r].map(JD):e[r]=t[r]);return e}function lz(t){var e=sz(t),r={},i;switch(e){case"expression":for(i in t)t.hasOwnProperty(i)&&(i==="latex"?r[i]=JD(t[i]):r[i]=t[i]);return r.type=e,r;case"table":for(i in t)t.hasOwnProperty(i)&&(i==="columns"?r[i]=t[i].map(az):r[i]=t[i]);return r.type=e,r;case"image":for(i in t)t.hasOwnProperty(i)&&(i==="width"||i==="height"||i==="x"||i==="y"?r[i]=JD(t[i]):r[i]=t[i]);return r.type=e,r;case"text":case"folder":for(i in t)t.hasOwnProperty(i)&&(r[i]=t[i]);return r.type=e,r}}var xN={none:KM.NONE,both:KM.BOTH,positive:KM.POSITIVE};function cz(t){var e={};for(var r in t)t.hasOwnProperty(r)&&(r==="xAxisArrows"||r==="yAxisArrows"||(e[r]=t[r]));return e.xAxisArrowMode=xN[t.xAxisArrows||"none"],e.yAxisArrowMode=xN[t.yAxisArrows||"none"],e}function vN(t){if(t.version)throw new Error("Unexpected version: "+t.version);var e={};return e.graph=cz(t.graph),e.expressions={list:t.expressions.list.map(lz)},e.version=0,e}var dz=1;function YD(t){return t.replace(/\\(sech|csch)/g,"\\operatorname{$1}")}function hz(t){var e={};for(var r in t)t.hasOwnProperty(r)&&(r==="latex"?e[r]=YD(t[r]):r==="values"?e[r]=t[r].map(YD):e[r]=t[r]);return e}function pz(t){var e=t.type,r={},i;switch(e){case"expression":for(i in t)t.hasOwnProperty(i)&&(i==="latex"?r[i]=YD(t[i]):r[i]=t[i]);return r;case"table":for(i in t)t.hasOwnProperty(i)&&(i==="columns"?r[i]=t[i].map(hz):r[i]=t[i]);return r;case"image":for(i in t)t.hasOwnProperty(i)&&(i==="width"||i==="height"||i==="x"||i==="y"?r[i]=YD(t[i]):r[i]=t[i]);return r;case"text":case"folder":for(i in t)t.hasOwnProperty(i)&&(r[i]=t[i]);return r;default:throw new Error("Unexpected expression type: "+e)}}function CN(t){if(t.version)throw new Error("Unexpected version: "+t.version);var e={};return e.graph=t.graph,e.expressions={list:t.expressions.list.map(pz)},e.version=dz,e}var uz=2,gz="#C0504D",mz="#4F81BD",fz="#9BBB59",yz="#8064A2",bz="#F79646",wz="#000000";function DN(t){switch(t){case gz:return __dcg_shared_module_exports__['T'].RED;case mz:return __dcg_shared_module_exports__['T'].BLUE;case fz:return __dcg_shared_module_exports__['T'].GREEN;case yz:return __dcg_shared_module_exports__['T'].PURPLE;case bz:return __dcg_shared_module_exports__['T'].ORANGE;case wz:return __dcg_shared_module_exports__['T'].BLACK;default:return t}}function xz(t){var e={};for(var r in t)t.hasOwnProperty(r)&&(r==="color"?e[r]=DN(t[r]):e[r]=t[r]);return e}function vz(t){var e=t.type,r={},i;switch(e){case"expression":for(i in t)t.hasOwnProperty(i)&&(i==="color"?r[i]=DN(t[i]):r[i]=t[i]);return r;case"table":for(i in t)t.hasOwnProperty(i)&&(i==="columns"?r[i]=t[i].map(xz):r[i]=t[i]);return r;case"image":case"text":case"folder":for(i in t)t.hasOwnProperty(i)&&(r[i]=t[i]);return r;default:throw new Error("Unexpected expression type: "+e)}}function SN(t){if(t.version>1)throw new Error("Unexpected version: "+t.version);var e={};return e.graph=t.graph,e.expressions={list:t.expressions.list.map(vz)},e.version=uz,e}var Cz=3;function UM(t){if(typeof t=="string")return t;if(t===void 0)return"";var e=t+"";return e=e.replace(/1e\+?([-\d]+)/,"10^{$1}"),e=e.replace(/([-\d\.]+)e\+?([-\d]+)/,"$1\\cdot 10^{$2}"),e}function Dz(t){var e=t.type,r={},i;switch(e){case"expression":for(i in t)t.hasOwnProperty(i)&&(i==="sliderMax"||i==="sliderMin"||i==="sliderInterval"?r[i]=UM(t[i]):i==="domain"?r[i]={max:UM(t[i].max),min:UM(t[i].min)}:r[i]=t[i]);return r.hasOwnProperty("sliderMin")&&r.sliderInterval===void 0&&(r.sliderInterval=""),r;case"image":case"table":case"text":case"folder":for(i in t)t.hasOwnProperty(i)&&(r[i]=t[i]);return r;default:throw new Error("Unexpected expression type: "+e)}}function EN(t){if(t.version>2)throw new Error("Unexpected version: "+t.version);var e={};return e.graph=t.graph,e.expressions={list:t.expressions.list.map(Dz)},e.version=Cz,e}var Sz=4;function kN(t){switch(t){case"point":return"POINT";case"cross":return"CROSS";case"open":return"OPEN";case"normal":return"SOLID";case"dashed":return"DASHED";case"dotted":return"DOTTED";default:return t}}function Ez(t){var e={};for(var r in t)t.hasOwnProperty(r)&&(r==="style"?e[r]=kN(t[r]):e[r]=t[r]);return e}function kz(t){var e=t.type,r={},i;switch(e){case"expression":for(i in t)t.hasOwnProperty(i)&&(i==="style"?r[i]=kN(t[i]):r[i]=t[i]);return r;case"table":for(i in t)t.hasOwnProperty(i)&&(i==="columns"?r[i]=t[i].map(Ez):r[i]=t[i]);return r;case"image":case"text":case"folder":for(i in t)t.hasOwnProperty(i)&&(r[i]=t[i]);return r;default:throw new Error("Unexpected expression type: "+e)}}function GN(t){if(t.version!==3)throw new Error("Unexpected version: "+t.version);var e={};return e.graph=t.graph,e.expressions={list:t.expressions.list.map(kz)},e.version=Sz,e}function Gz(t){var e={},r;for(var i in t)if(t.hasOwnProperty(i))switch(r=t[i],i){case"showAxes":e.showXAxis=r,e.showYAxis=r;break;case"showLabels":e.xAxisNumbers=r,e.yAxisNumbers=r,e.polarNumbers=r;break;case"labelXMode":e.xAxisStep=r==="pi"?Math.PI:0;break;case"labelYMode":e.yAxisStep=r==="pi"?Math.PI:0;break;default:e[i]=r}return e}function Vz(t){var e={};for(var r in t)t.hasOwnProperty(r)&&(r==="showPoints"||r==="showLine"||(e[r]=t[r]));return(t.showPoints!==void 0||t.showLine!==void 0)&&(t.showPoints&&t.showLine?e.columnMode="POINTS_AND_LINES":t.showPoints?e.columnMode="POINTS":t.showLine?e.columnMode="LINES":(e.hidden=!0,e.columnMode="POINTS")),e}function Iz(t){var e=t.type,r={},i;switch(e){case"expression":t.hidden===void 0?t.hasOwnProperty("graphed")?r.hidden=!t.graphed:t.hasOwnProperty("userRequestedGraphing")?r.hidden=t.userRequestedGraphing==="never":r.hidden=!1:r.hidden=t.hidden;for(i in t)if(t.hasOwnProperty(i)&&!(i==="graphed"||i==="userRequestedGraphing"||i==="hidden")&&i!=="slider"){if(i==="color"){typeof t.color=="object"?r.color=t.color.value:r.color=t.color;continue}if(i==="style"){r.style=t.style==="normal"?"SOLID":t.style;continue}if(i==="sliderInterval"){r.sliderInterval=t.sliderInterval==="undefined"?"":t.sliderInterval;continue}r[i]=t[i]}return r;case"table":if(t.headings||t.columns){var n=t.headings?t.headings:t.columns;if(r.columns=n.map(Vz),t.rows)for(var o=0;o<r.columns.length;o++){var s=r.columns[o];s.values=[];for(var a=0;a<t.rows.length;a++)s.values.push(t.rows[a][o])}}for(i in t)t.hasOwnProperty(i)&&(i==="rows"||i==="headings"||i==="columns"||(r[i]=t[i]));return r;case"image":case"text":case"folder":for(i in t)t.hasOwnProperty(i)&&(r[i]=t[i]);return r;default:throw new Error("Unexpected expression type: "+e)}}function VN(t){if(t.version!==4)throw new Error("Unexpected version: "+t.version);var e={version:5,graph:Gz(t.graph),expressions:{list:t.expressions.list.map(Iz)}};return e}var Mz=6;function Tz(t){return t.length<2?!1:t[0]==="`"&&t[t.length-1]==="`"}function Az(t){if(Tz(t))return{raw:t,parts:[t]};for(var e=["[a-zA-Z][0-9]*","[a-zA-Z]_[a-zA-Z0-9]+","[a-zA-Z]_\\{[a-zA-Z0-9]+\\}"],r="({"+e.join("})|({")+"})",i=new RegExp(r,"g"),n=[],o=0,s=0,a;a=i.exec(t);){s=a.index,s>o&&n.push(t.substr(o,s-o));var l=a[0],c=l.replace(/[{}\$]/g,"").replace(/^([a-zA-Z])([0-9]+)$/,"$1_$2");n.push({symbol:c,str:l}),o=a.index+l.length}return o<t.length&&n.push(t.substr(o)),{raw:t,parts:n}}function Lz(t){var e={};for(var r in t)if(t.hasOwnProperty(r)&&r!=="style")if(r==="values"&&(e[r]=t[r].map(function(i){return i?""+i:""})),r==="columnMode"&&!t.hasOwnProperty("points")&&!t.hasOwnProperty("lines"))switch(t[r]){case"LINES":e.points=!1,e.lines=!0;break;case"POINTS_AND_LINES":e.points=!0,e.lines=!0;break;default:e.points=!0,e.lines=!1}else e[r]=t[r];return e.hasOwnProperty("pointStyle")||(e.pointStyle="POINT"),e.hasOwnProperty("lineStyle")||(e.lineStyle="SOLID"),e.id=""+e.id,e}var IN={sliderMin:"min",sliderMax:"max",sliderInterval:"step",sliderHardMin:"hardMin",sliderHardMax:"hardMax",sliderAnimationPeriod:"animationPeriod",sliderLoopMode:"loopMode",sliderPlayDirection:"playDirection",sliderIsPlaying:"isPlaying"};function Pz(t){var e=Az(t),r="";return __dcg_shared_module_exports__['k'](e.parts,function(i){r+=typeof i=="object"&&i.str?"$"+i.str:i}),r}function Oz(t,e){var r=t.latex.split("=");if(r.length===2){var i=yn(r[1],e);if(isFinite(i)){var n=t.slider.hardMin?yn(t.slider.min||"-10",e):void 0,o=t.slider.hardMax?yn(t.slider.max||"10",e):void 0,s=t.slider.step?yn(t.slider.step,e):void 0,a=__dcg_shared_module_exports__['Qb']({target:i,step:s,hardMin:n,hardMax:o});a.min||(delete t.slider.hardMin,delete t.slider.min),a.max||(delete t.slider.hardMax,delete t.slider.max),a.step||delete t.slider.step}}}function _z(t,e,r,i){var n=t.type,o={},s;switch(n){case"folder":for(s in t)t.hasOwnProperty(s)&&(s==="memberIds"||(o[s]=t[s]));break;case"expression":for(s in t)if(t.hasOwnProperty(s)){if(s==="style"&&!t.hasOwnProperty("pointStyle")&&!t.hasOwnProperty("lineStyle")){var a=t[s];__dcg_shared_module_exports__['p'](["POINT","OPEN","CROSS"],a)?(o.pointStyle=a,o.lineStyle="SOLID"):__dcg_shared_module_exports__['p'](["SOLID","DASHED","DOTTED"],a)?(o.pointStyle="POINT",o.lineStyle=a):(o.pointStyle="POINT",o.lineStyle="SOLID");continue}IN.hasOwnProperty(s)?(o.slider=o.slider||{},o.slider[IN[s]]=t[s]):o[s]=t[s],t.label&&(o.label=Pz(t.label))}o.latex&&o.slider&&!o.slider.isPlaying&&Oz(o,i),o.hasOwnProperty("fillOpacity")||(o.fillOpacity=.4),o.label===!1&&(o.label=""),o.labelSize||(o.labelSize="medium"),o.labelOrientation||(o.labelOrientation="default"),o.verticalLabel||(o.verticalLabel=!1),o.interactiveLabel||(o.interactiveLabel=!1);break;case"image":for(s in t)!t.hasOwnProperty(s)||s==="x"||s==="y"||(o[s]=t[s]);o.center="\\left("+(t.x||"0")+","+(t.y||"0")+"\\right)",o.angle=t.angle||"0",o.foreground=!!o.foreground;break;case"text":for(s in t)t.hasOwnProperty(s)&&(o[s]=t[s]);break;case"table":for(s in t)t.hasOwnProperty(s)&&(s==="columns"?o[s]=t[s].map(Lz):o[s]=t[s]);break;default:throw new Error("Unexpected expression type: "+n)}if(o.id=""+o.id,t.type==="folder")e.folderId=o.id,e.memberIds=t.memberIds,o.folderId="";else{var l=r[o.id];e.memberIds&&e.memberIds[l]?o.folderId=e.folderId:(o.folderId="",e.folderId=void 0,e.memberIds=void 0)}return o}function Fz(t){for(var e=0,r=/^[0-9]+$/,i=t.length-1;i>=0;i--){var n=t[i],o=n.id,s;if(r.test(o)&&(s=parseInt(o,10),s>e&&(e=s)),n.type==="table"&&n.columns)for(var a=n.columns.length-1;a>=0;a--)o=n.columns[a].id,r.test(o)&&(s=parseInt(o,10),s>e&&(e=s))}return e+1}function MN(t){if(t.version!==5)throw new Error("Unexpected version: "+t.version);var e=!!(t.graph&&t.graph.degreeMode),r=t.expressions.list,i=-1,n={},o={},s={};return{version:Mz,graph:t.graph,expressions:{list:r.map(function(l){return n[l.id]?(i===-1&&(i=Fz(r)),o[i]=l.id,l=__dcg_shared_module_exports__['N'](l),l.id=i+"",i+=1):o[l.id]=l.id,n[l.id]=!0,_z(l,s,o,e)})}}}function qM(t){if(t.version!==6)throw new Error(`Unexpected version: ${t.version}`);let e=t.expressions.list.map(r=>{if(r.type==="expression"&&r.domain){let i=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},r),{parametricDomain:{min:r.domain.min,max:r.domain.max}});return delete i.domain,i}return r});return{version:7,randomSeed:t.randomSeed,graph:t.graph,expressions:{list:e}}}function Rz(t){return t.length===1?`0${t}`:t}function ad(){let t=new Uint8Array(16);if(typeof crypto!="undefined")crypto.getRandomValues(t);else if(typeof msCrypto!="undefined")msCrypto.getRandomValues(t);else return __dcg_shared_module_exports__['ga'](Date.now().toString()+Math.random().toString());return Array.prototype.slice.call(t).map(r=>Rz(r.toString(16))).join("")}function HM(t){let e=t.split("_");return e.length===2&&e[1]&&e[1].length===1?e[0]+"_{"+e[1]+"}":t}function TN(t){return t=__dcg_shared_module_exports__['N'](t),!t.rules&&(t.assignment||t.expression)&&(t.rules=[{id:"1",assignment:t.assignment||"",expression:t.expression||""}]),delete t.assignment,delete t.expression,t}function Ob(t){let e=/\\operatorname(?:\{stdev\}p|\{stddev\}p|\{stdDev\}P|\{var\}iance)/g;return t.replace(e,r=>{switch(r){case"\\operatorname{stdev}p":return"\\operatorname{stdevp}";case"\\operatorname{stddev}p":return"\\operatorname{stddevp}";case"\\operatorname{stdDev}P":return"\\operatorname{stdDevP}";case"\\operatorname{var}iance":return"\\operatorname{variance}";default:return""}})}function Nz(t){return t.columns?__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},t),{columns:t.columns.map(Bz)}):t}function Bz(t){let{latex:e,values:r}=t,i=__dcg_shared_module_exports__['b']({},t);return e&&(i.latex=Ob(e),i.latex=HM(i.latex)),r&&(i.values=r.map(function(n){return n?Ob(n):""})),i}function zM(t){if(t.version!==7)throw new Error(`Unexpected version: ${t.version}`);let e=t.expressions.list.map(r=>{if(r.type==="image"){let i=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},r),{opacity:""});r.hasOwnProperty("stringOpacity")?i.opacity=r.stringOpacity:r.hasOwnProperty("opacity")?i.opacity=r.opacity+"":delete i.opacity,r.clickableInfo&&(i.clickableInfo=TN(r.clickableInfo)),delete i.stringOpacity;for(let n in r)if(n==="x"||n==="y"||n==="width"||n==="height"){let o=r[n];o&&(i[n]=Ob(o))}return i}else if(r.type==="expression"){let i=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},r),{fillOpacity:"",lineStyle:"SOLID"});if(r.lineStyle==="SINGLE_PIXEL"?i.lineWidth="1":r.hasOwnProperty("lineStyle")?i.lineStyle=r.lineStyle:delete i.lineStyle,i.hasOwnProperty("lineWidth")||(i.lineWidth=""),i.hasOwnProperty("lineOpacity")||(i.lineOpacity=""),i.hasOwnProperty("pointOpacity")||(i.pointOpacity=""),i.hasOwnProperty("pointSize")||(i.pointSize=""),i.hasOwnProperty("colorLatex")||(i.colorLatex=""),typeof r.latex=="string"&&(i.latex=Ob(r.latex)),r.latex&&(i.latex=Ob(r.latex)),r.hasOwnProperty("stringFillOpacity")?i.fillOpacity=r.stringFillOpacity:r.hasOwnProperty("fillOpacity")?i.fillOpacity=r.fillOpacity+"":delete i.fillOpacity,i.slider&&r.slider&&r.slider.newLoopMode&&(i.slider=__dcg_shared_module_exports__['N'](i.slider),i.slider.loopMode=r.slider.newLoopMode,delete i.slider.newLoopMode),i.residualVariable&&(i.residualVariable=HM(i.residualVariable)),i.regressionParameters){i.regressionParameters={};for(let n in r.regressionParameters){let o=HM(n),s=r.regressionParameters[n];i.regressionParameters[o]=s}}return r.clickableInfo&&(i.clickableInfo=TN(r.clickableInfo)),i}else if(r.type==="table")return Nz(r);return r});return{version:8,randomSeed:t.randomSeed||ad(),graph:t.graph,expressions:{list:e}}}function Kz(t,e,r){if(t.verticalLabel)switch(delete e.verticalLabel,r?e.labelAngle="90":e.labelAngle="\\frac{\\pi}{2}",t.labelOrientation){case"above":e.labelOrientation="right";break;case"below":e.labelOrientation="left";break;case"left":e.labelOrientation="above";break;case"right":e.labelOrientation="below";break}t.extendedLabelOrientation&&(e.labelOrientation=t.extendedLabelOrientation,delete e.extendedLabelOrientation)}function Uz(t,e){if(t.vizProps)switch(t.vizProps.dotplotSize){case"small":e.pointSize="9";break;case"large":e.pointSize="20";break}if(t.vizProps){let r=__dcg_shared_module_exports__['b']({},t.vizProps);delete r.dotplotSize,Object.keys(r).length?e.vizProps=r:delete e.vizProps}}function $M(t){return t.filter(({assignment:e,expression:r})=>!!e&&!!r)}function WM(t){return t.map(({assignment:e,expression:r})=>`${e}\\to ${r}`).join(",")||""}function jM(t){let e=JSON.stringify(t),r=/_(\d)|_\{(\d+)\}/g,i,n={};for(;(i=r.exec(e))!==null;){let o=i[1]!==void 0?i[1]:i[2];n[o]=!0}return n}function JM(t,e){for(let r=e+1;;r++)if(!t[r])return r}function AN(t){let e=JSON.stringify(t),r=/"(\d+)"/g,i,n={};for(;(i=r.exec(e))!==null;){let o=i[1]!==void 0?i[1]:i[2];n[o]=!0}return n}function LN(t,e){for(let r=e+1;;r++)if(!t[r])return r}function qz(t){if(/^\d+$/.test(t)){let e=parseInt(t,10);return e===0?"\\infty":""+Math.round(1e3/e)}else return`\\frac{1000}{${t}}`}function Hz(t,e){let r={handlerLatex:t,playing:!0,open:!0};return e!==void 0&&(r.minStepLatex=qz(e)),r}function YM(t){if(t.version!==8)throw new Error(`Unexpected version: ${t.version}`);var e=!1;t.graph&&t.graph.degreeMode&&(e=!0);let r=t.expressions.ticker||Cg,i=0,n,o=0,s,a=[];for(let d of t.expressions.list)switch(d.type){case"expression":{let u=__dcg_shared_module_exports__['b']({},d);Kz(d,u,e),Uz(d,u);let p;if(d.clickableInfo&&d.clickableInfo.rules){let l=d.clickableInfo,{rules:g}=l,x=__dcg_shared_module_exports__['e'](l,["rules"]),w=$M(g),E=WM(w);if(w.length>1){n||(n=jM(t)),i=JM(n,i),s||(s=AN(t)),o=LN(s,o);let k=`A_{${i}}`;x.latex=k,p={type:"expression",id:""+o,latex:`${k}=${E}`},d.folderId!==void 0&&(p.folderId=d.folderId)}else x.latex=E;u.clickableInfo=x}u.clickableInfo&&u.clickableInfo.enabled&&u.hidden&&(u.clickableInfo.enabled=!1),a.push(u),p&&a.push(p);break}case"image":{if(d.clickableInfo&&d.clickableInfo.rules){let u=__dcg_shared_module_exports__['b']({},d),c=d.clickableInfo,{rules:p}=c,b=__dcg_shared_module_exports__['e'](c,["rules"]),x=$M(p),w=WM(x),E;if(x.length>1){n||(n=jM(t)),i=JM(n,i),s||(s=AN(t)),o=LN(s,o);let k=`A_{${i}}`;b.latex=k,E={type:"expression",id:""+o,latex:`${k}=${w}`},d.folderId!==void 0&&(E.folderId=d.folderId)}else b.latex=w;u.clickableInfo=b,a.push(u),E&&a.push(E)}else a.push(d);break}case"simulation":{let u;if(d.clickableInfo&&d.clickableInfo.rules){let g=$M(d.clickableInfo.rules);u=WM(g)}else u="";if(d.isPlaying&&u!==""){n||(n=jM(t)),i=JM(n,i);let g=`A_{${i}}`;u=`${g}=${u}`,r=Hz(g,d.fps)}let p={type:"expression",id:d.id,latex:u};d.folderId!==void 0&&(p.folderId=d.folderId),a.push(p);break}default:a.push(d);break}return{version:9,randomSeed:t.randomSeed||ad(),graph:t.graph,expressions:{list:a,ticker:r}}}function PN(t){t.clickableInfo&&(t.description===void 0&&t.clickableInfo.description!==void 0&&(t.description=t.clickableInfo.description),delete t.clickableInfo.description,Object.keys(t.clickableInfo).length===0&&delete t.clickableInfo)}function zz(t){switch(t.labelSize){case"small":t.labelSize="0.85";break;case"medium":t.labelSize="1";break;case"large":t.labelSize="1.35";break;default:break}}function $z(t){let e=0,r=/^[0-9]+$/;for(var i=t.length-1;i>=0;i--){var n=t[i];let o=n.id;if(r.test(o)){let s=parseInt(o,10);s>e&&(e=s)}if(n.type==="table"&&n.columns){for(let s=n.columns.length-1;s>=0;s--)if(o=n.columns[s].id,!!o&&r.test(o)){let a=parseInt(o,10);a>e&&(e=a)}}}return e}function XM(t){if(t.version!==9)throw new Error(`Unexpected version: ${t.version}`);let e=[],r={},i=$z(t.expressions.list);for(let o of t.expressions.list)switch(o.type){case"expression":{let l=__dcg_shared_module_exports__['b']({},o);PN(l),zz(l),e.push(l);break}case"image":{let l=__dcg_shared_module_exports__['b']({},o);PN(l);let c=l.description;(c===void 0||c==="")&&l.draggable&&l.center!==void 0&&l.center!==""&&(r[l.center]===void 0?r[l.center]=[l]:r[l.center].push(l)),e.push(l);break}case"table":let s=__dcg_shared_module_exports__['b']({},o);if(!s.columns||!ha(s.columns[0].latex)){e.push(s);break}let a=s.columns[0].latex;for(let l=1;l<s.columns.length;l++){let c=s.columns[l];if(!c.lines||!jl(c.latex,a))continue;delete c.lines,i++;let d={type:"expression",latex:"y="+Ev(c.latex,a,"x"),id:`${i}`};c.color&&(d.color=c.color),c.lineStyle&&(d.lineStyle=c.lineStyle),c.lineWidth&&(d.lineWidth=c.lineWidth),c.lineOpacity&&(d.lineOpacity=c.lineOpacity),e.push(d)}e.push(s);break;default:e.push(o);break}for(let o of e){if(o.type!=="expression"||o.latex===void 0||o.latex===""||o.latex.indexOf("=")===-1||o.dragMode===void 0||o.dragMode==="NONE"||o.label===void 0||o.label==="")continue;let s=o.latex.slice(0,o.latex.indexOf("=")),a=r[s];if(a!==void 0)for(let l of a)l.description=o.label}return __dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},t),{version:10,expressions:__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},t.expressions),{list:e})})}function Wz(t){let e=/[ \\]*=[ \\]*\\operatorname\{(dilation|reflection|rotation|translation)\}\\left\(/g;return t.type!=="expression"||!t.latex||(t.latex=t.latex.replace(e,(r,i)=>{switch(i){case"dilation":return"\\left(x\\right)=\\operatorname{dilate}\\left(x,";case"rotation":return"\\left(x\\right)=\\operatorname{rotate}\\left(x,";case"reflection":return"\\left(x\\right)=\\operatorname{reflect}\\left(x,";case"translation":return"\\left(x\\right)=\\operatorname{translate}\\left(x,";default:return""}})),t}function QM(t){if(t.version!==10)throw new Error(`Unexpected version: ${t.version}`);let e=__dcg_shared_module_exports__['b']({},t.graph);delete e.projectorMode;let r=__dcg_shared_module_exports__['b']({},t.expressions);if((e==null?void 0:e.product)==="geometry-calculator"){let i=[];for(let n of r.list)switch(n.type){case"expression":{let o=__dcg_shared_module_exports__['b']({},n);Wz(o),i.push(o);break}default:i.push(n)}r.list=i}return __dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},t),{version:11,graph:e,expressions:r})}function ON(t){return __dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},t),{version:10})}var ZM=[vN,CN,SN,EN,GN,VN,MN,qM,zM,YM,XM,QM];var xl=11;function uc(t){if(t.version>xl)return typeof console!="undefined"&&console.warn&&console.warn("Loading saved state with version "+t.version+" but last known version is "+xl+". States saved in a newer version of the calculator may not load correctly in an older version of the calculator."),jD(t);if(t.hasOwnProperty("version")&&!ZM[t.version])return typeof console!="undefined"&&console.warn&&console.warn("State has invalid version "+t.version+". If a version is present, it should be a non-negative integer less than or equal to "+xl+"."),jD(t);for(t.hasOwnProperty("version")||(t=ZM[0](t));t.version<xl;)t=ZM[t.version+1](t);return jD(t)}function jz(t){return ON(t)}function _N(t){return jz(uc(t))}var FN=t=>({value:"0",min:"0",max:t.degreeMode?"360":"2\\pi"}),Jz={latex:void 0,polarDomainMin:void 0,polarDomainMax:void 0,parametricDomainMin:void 0,parametricDomain3DuMin:void 0,parametricDomain3DvMin:void 0,clickableInfoLatex:void 0,parametricDomainMax:void 0,parametricDomain3DuMax:void 0,parametricDomain3DvMax:void 0,colorLatex:void 0,tableColumnColorLatex:void 0,cdfMin:()=>({value:"0",min:"-10",max:"10"}),cdfMax:()=>({value:"0",min:"-10",max:"10"}),pointSize:()=>({value:9+"",min:"0",max:"10"}),tableColumnPointSize:()=>({value:9+"",min:"0",max:"10"}),labelAngle:FN,labelSize:()=>({value:"1",min:"0",max:"5"}),lineWidth:()=>({value:2.5+"",min:"0",max:"10"}),resolution:()=>({value:"50",min:"2",max:"100",step:"1"}),checkers:()=>({value:__dcg_shared_module_exports__['vc']+"",min:"1",max:"1000"}),tableColumnLineWidth:()=>({value:2.5+"",min:"0",max:"10"}),fillOpacity:()=>({value:.4+"",min:"0",max:"1"}),lineOpacity:()=>({value:.9+"",min:"0",max:"1"}),tableColumnLineOpacity:()=>({value:.9+"",min:"0",max:"1"}),pointOpacity:()=>({value:.9+"",min:"0",max:"1"}),tableColumnPointOpacity:()=>({value:.9+"",min:"0",max:"1"}),sliderMin:void 0,sliderMax:void 0,sliderStep:void 0,residualVariable:void 0,tableHeader:void 0,tableCellValue:void 0,imageOpacity:()=>({value:"1",min:"0",max:"1"}),imageCenter:void 0,imageHeight:()=>({value:"10",min:"-10",max:"10"}),imageWidth:()=>({value:"10",min:"-10",max:"10"}),imageAngle:FN,tickerMinStep:()=>({value:"0",min:"0"}),tickerHandler:void 0},RN={rgb:{paramBounds:t=>({value:"0",min:"0",max:"255",step:"1"})},hsv:{paramBounds:t=>t===0?{value:"0",min:"0",max:"360",step:"1"}:{value:"0.5",min:"0",max:"1"}}};function KN(t,e,r){var i=t.map(function(s){return{location:s.location,parsed:__dcg_shared_module_exports__['fc'](s.latex)}}),n={};for(let s of e)for(let a of i){var o=Yz(s,a,r);o&&o.length&&(n[s]=o[0])}return n}function Yz(t,{parsed:e,location:r},i){if(e.type==="Identifier"&&e._symbol===t){let o=Jz[r];return o?[o(i)]:void 0}e.type==="Assignment"&&(e=e._expression);let n=[];switch(e.type){case"FunctionCall":{let o=e._symbol;if(RN.hasOwnProperty(o)){let s=RN[o];e.args.forEach(function(a,l){if(a.type==="Identifier"&&a._symbol===t){var c=s.paramBounds(l);c&&n.push(c)}})}break}default:return}return n}function Xn(t,e,r){let i=Qz(t,e,r);Pi(t,i)}function Pi(t,e){if(t.focusLocation=e,!e||(e.type==="ticker"&&(t.getListModel().ticker.playing=!1,ri(t.getListModel(),void 0)),e.type==="settings"||e.type==="generic-menu"||e.type==="editable-label"||e.type==="add-item-btn"||e.type==="add-expression-btn"||e.type==="add-note-btn"||e.type==="add-table-btn"||e.type==="add-folder-btn"||e.type==="add-ticker-btn"||e.type==="add-image-btn"||e.type==="edit-list-toggle"||e.type==="hide-expression-list-btn"||e.type==="show-expression-list-btn"||e.type==="zoom-restore-btn"||e.type==="search-expressions"||e.type==="replace-expressions"||e.type==="ticker"||e.type==="geo-token"||e.type==="geo-show-constructions-icon"||e.type==="geo-basic-tool"||e.type==="geo-basic-tool-dropdown"||e.type==="geo-basic-tool-menu-item"||e.type==="multi-select-more-icon"||e.type==="multi-select-transformations-icon"||e.type==="geo-header-back-link"||e.type==="multi-select-delete-icon"||e.type==="multi-select-show-hide-icon"||e.type==="new-transformation-number"||e.type==="label-points-icon"||e.type==="regression-output"||e.type==="graph-paper"))return;let r=t.getItemModel(e.id);if(e.type==="expression-menu"){ri(t.getListModel(),void 0);return}else ri(t.getListModel(),r);r&&r.type==="expression"&&ga(r,!1)}function Qz(t,e,r){let i=t.getItemModel(e);if(!i)return;let n=t.isInEditListMode()||t.isItemReadonly(i.id);switch(i.type){case"expression":return{type:n?"readonly-expression":i.type,id:e};case"folder":case"text":return{type:i.type,id:e};case"table":{let s={row:1,column:0},a=!1;return r&&(r.location==="cell"?s={row:r.row,column:r.column}:r==="end"?s={row:Us(i),column:0}:r==="start"?s={row:0,column:0}:r==="container"&&(a=!0)),a?{type:"table-container",id:e}:{type:i.type,id:e,location:s}}case"image":return{type:i.type,id:e,location:"name"};default:return i}}function UN(t){var e=t.getSelectedItem();if(e&&e.type==="expression"&&!e.readonly){Xn(t,e.id);return}if(e&&e.type==="table"&&t.focusLocation&&!e.readonly)return;var r=t.getFirstFullyVisibleItem();let i=t.getListModel();for(;r&&(r.type!=="expression"||r.readonly);)r=$p(i,r.index);if(r){Xn(t,r.id);return}let n=t.createItemModel({type:"expression",id:t.generateId(),color:t.getNextColor()});Ql(t.getListModel(),n),Xn(t,n.id)}function qN(t){let e=t.focusLocation;if(e&&!(e.type==="settings"||e.type==="generic-menu"||e.type==="editable-label"||e.type==="add-item-btn"||e.type==="add-expression-btn"||e.type==="add-note-btn"||e.type==="add-table-btn"||e.type==="add-ticker-btn"||e.type==="add-folder-btn"||e.type==="add-image-btn"||e.type==="edit-list-toggle"||e.type==="hide-expression-list-btn"||e.type==="show-expression-list-btn"||e.type==="zoom-restore-btn"||e.type==="search-expressions"||e.type==="replace-expressions"||e.type==="ticker"||e.type==="geo-token"||e.type==="geo-show-constructions-icon"||e.type==="geo-basic-tool"||e.type==="geo-basic-tool-dropdown"||e.type==="geo-basic-tool-menu-item"||e.type==="multi-select-more-icon"||e.type==="multi-select-transformations-icon"||e.type==="geo-header-back-link"||e.type==="multi-select-delete-icon"||e.type==="multi-select-show-hide-icon"||e.type==="new-transformation-number"||e.type==="label-points-icon"||e.type==="regression-output"||e.type==="graph-paper"))return t.getItemModel(e.id)}function dm(t,e,r){Pi(t,{type:"table",id:e,location:r})}function zN(t,e,r){var i=t.getItemModel(e);if(!i||i.type!=="table")return;let n=i;var o=Do(n),s=o?o.row:-1,a=o?o.column:-1,l=n.columnModels,c=Us(n),d=l.length,u=(w,E)=>{w===-1?eT(t):w>c?tT(t):(E===-1?(E=d-1,w--):E===d&&(w++,E=0),dm(t,e,{row:w,column:E}))},p=w=>{c>2&&DF(n,s-1),dm(t,e,{row:w,column:a})},g=w=>{a===0||d<=2||(SF(n,a),dm(t,e,{row:s,column:w}))};let b=!!n.columnModels[0].disabled;switch(r){case"Left":u(s,a-1);break;case"Right":u(s,a+1);break;case"Up":u(s-1,a);break;case"Down":u(s+1,a);break;case"Enter":if(s>=c)return nT(t);if(a>0||b)return u(s+1,a);if(s===c-1){let w=EF(n,s);kI(n,s);for(var x=0;x<w.length;x++)Fd(n,{row:s+1,column:x},w[x]);dm(t,e,{row:s+1,column:a});return}kI(n,s),dm(t,e,{row:s+1,column:a});break;case"Backspace":s===0?a===0?rT(t):a===d-1||a===1&&d===3?u(0,a-1):g(a-1):a!==0?u(s,a-1):s===c||b?u(s-1,a):p(s-1);break;case"Delete":s===0?a===0?iT(t):a<d-1&&g(a):s>=c||b||p(s);break}}function eT(t){var e=t.getSelectedItem();!e||t.inAudioTraceMode()||(!vC(t.getListModel())&&t.getTickerOpen()&&Pi(t,{type:"ticker",location:"handler"}),e=t.getSelectedItem(),!e)||Xn(t,e.id,"end")}function tT(t){var r;if(!t.inAudioTraceMode()){if(((r=t.getFocusLocation())==null?void 0:r.type)==="ticker"){let i=Vg(t.getListModel());if(i)return Xn(t,i.id,"start")}if(!CC(t.getListModel())&&!t.isInEditListMode()){let i=t.createItemModel({type:"expression",id:t.generateId(),color:t.getNextColor()});Ql(t.getListModel(),i),ri(t.getListModel(),i)}var e=t.getSelectedItem();e&&Xn(t,e.id,"start")}}function rT(t){if(t.isInEditListMode())return;var e=t.getSelectedItem();if(!e||t.getItemCount()===1&&e.type==="expression")return;var r=e.type==="text";let i=ma(e);if(i){let n=t.getNumberOfItemsInFolder(i.id);if(e.index===i.index+n){No(e,"");return}}if(oT(t,{moveSelection:!0}),r&&La&&Id){ri(t.getListModel(),void 0);return}e=t.getSelectedItem(),e&&Xn(t,e.id,"end")}function iT(t){if(!t.isInEditListMode()){var e=t.getSelectedItem();e&&(t.getItemCount()===1&&e.type==="expression"||(sT(t,{moveSelection:!0}),e=t.getSelectedItem(),e&&Xn(t,e.id,"start")))}}function nT(t){if(!t.isInEditListMode()){var e=t.getSelectedItem();if(e){if(e.type==="text"&&La&&Id){ti(),ri(t.getListModel(),void 0);return}if(Vy(e).length&&t.areSlidersEnabled())return t.createSlidersForItem(e.id,Vy(e).concat(""));var r=t.createItemModel({type:"expression",id:t.generateId(),color:t.getNextColor()}),i=e.index+1;e.type==="folder"&&e.collapsed&&(i+=t.getNumberOfItemsInFolder(e.id)),za(t.getListModel(),r,i),ri(t.getListModel(),r),e.type==="folder"&&!e.collapsed?No(r,e.id):e.type!=="folder"&&e.folderId&&No(r,e.folderId),e=t.getSelectedItem(),e&&Xn(t,e.id)}}}function oT(t,{moveSelection:e}){let r=t.getSelectedItem(),i=t.getListModel();if(!r||r.readonly)return;let n=zp(i,r.index);if(t._removeExpressionSynchronously(r),e){if(!n){let o=Vg(i);o&&(n=o)}ri(i,n)}else ri(i,void 0)}function sT(t,{moveSelection:e}){let r=t.getSelectedItem(),i=t.getListModel();if(!r||r.readonly)return;let n=$p(i,r.index);if(t._removeExpressionSynchronously(r),e){if(!n){let o=yC(i);o&&(n=o)}ri(i,n)}else ri(i,void 0)}function e$(t){switch(t){case"histogram":case"dotplot":return 12;case"boxplot":return 40}return 1/0}function t$(t){return t==="boxplot"||t==="dotplot"||t=="histogram"}function r$(t){return t==="boxplot"?3:.5}function i$(t,e){if(t.type==="dotplot"||t.type==="histogram"){let n=Math.max(1,t.xmax-t.xmin)*80/(t.binWidth?t.binWidth:1),o=.5*(e.screen.width-n)/n;return Math.max(.2,o)}return .5}function n$(t,e,r){t=__dcg_shared_module_exports__['N'](t);let i=1.2;return e&&t.xmax<0&&t.xmin<0&&t.xmax/(t.xmin-t.xmax)<i&&(t.xmax=0),e&&t.xmax>0&&t.xmin>0&&t.xmin/(t.xmax-t.xmin)<i&&(t.xmin=0),r&&t.ymax<0&&t.ymin<0&&t.ymax/(t.ymin-t.ymax)<i&&(t.ymax=0),r&&t.ymax>0&&t.ymin>0&&t.ymin/(t.ymax-t.ymin)<i&&(t.ymin=0),t}function o$(t,e,r,i){let n=t.type,o=i$(t,e),s=r$(n),a,l,c,d;if(t.xmin===t.xmax&&(r?(t.xmin-=.5,t.xmax+=.5):(t.xmin*=.5,t.xmax/=.5)),t.ymin===t.ymax&&(i?(t.ymin-=.5,t.ymax+=.5):(t.ymin*=.5,t.ymax/=.5)),r){let u=(t.xmax-t.xmin)*o;a=t.xmin-u,l=t.xmax+u}else{let u=__dcg_shared_module_exports__['a'](t.xmax/t.xmin,o);a=t.xmin/u,l=t.xmax*u}if(i){let u=(t.ymax-t.ymin)*s;c=t.ymin-u,d=t.ymax+u}else{let u=__dcg_shared_module_exports__['a'](t.ymax/t.ymin,s);c=t.ymin/u,d=t.ymax*u}if(t$(n)){let u=e.screen.height/e.screen.width,p=(l-a)*u;if(p>t.ymax-t.ymin&&p<e$(n)*(t.ymax-t.ymin)){let g=.5*(t.ymax+t.ymin);d=g+.5*p,c=g-.5*p}}return{xmin:a,xmax:l,ymin:c,ymax:d}}function aT(t,e){var r=Fb(t,e);if(!r)return!1;let{xAxisScale:i,yAxisScale:n}=e.settings;if(!an.fromObject(r).isValid({xAxisScale:i,yAxisScale:n}))return!1;var s=e.mapx(r.xmin),a=e.mapx(r.xmax),l=e.mapy(r.ymin),c=e.mapy(r.ymax),d=10,u=Math.abs(s)<=d&&Math.abs(c)<=d&&Math.abs(a-e.screen.width)<=d&&Math.abs(l-e.screen.height)<=d;return!u}function Fb(t,e){let r=1/0,i=-1/0,n=1/0,o=-1/0,s=0,a=t.length,l=e.settings.xAxisScale==="linear",c=e.settings.yAxisScale==="linear";for(let d=0;d<a;d++){let u=n$(t[d],l,c);if(!isFinite(u.xmax-u.xmin)||!isFinite(u.ymax-u.ymin)){s+=1;continue}if(!l&&!(u.xmax>0&&u.xmin>0)||!c&&!(u.ymax>0&&u.ymin>0)){s+=1;continue}let p=o$(u,e,l,c);p.xmin<r&&(r=p.xmin),p.xmax>i&&(i=p.xmax),p.ymin<n&&(n=p.ymin),p.ymax>o&&(o=p.ymax)}if(s!==a)return{xmin:r,xmax:i,ymin:n,ymax:o}}function $N(t){switch(t){case"letters":return"capitalLetters";case"noQwertyLetters":return"noQwertyCapitalLetters";case"noQwertyCapitalLetters":return"noQwertyLetters";default:return"letters"}}function lT(t){return{keypadMinimized:!GL,keypadLayout:"mainNumbers",keypadFunctionsOpen:!1,graphSettingsOpen:!1,addExpressionOpen:!1,expressionsVisible:!!t.expressions,inEditListMode:!1,isFileDraggedOver:!1,expressionsHiddenTime:void 0}}var jN={xmin:"",xmax:"",xstep:"",ymin:"",ymax:"",ystep:"",zmin:"",zmax:""};function JN(t){return t in jN}function s$(t){let e=t.split("\xD7");return(e.length>1&&e[0]==="1"?e.slice(1):e).join("\\cdot")}function su(t,e){let r=__dcg_shared_module_exports__['Bb'](t,e),i="";if(r.mantissa)i=s$(r.mantissa)+"^{"+r.superscript+"}";else{let n=r.string.split("/");n.length===2?n[0][0]==="-"?i="-\\frac{"+n[0].slice(1)+"}{"+n[1]+"}":i="\\frac{"+n[0]+"}{"+n[1]+"}":i=r.string}return i=i.replace(/π/,"\\pi"),i}function a$(t,e){let r=e.xAxisScale==="linear"?t.xmax-t.xmin:void 0,i=e.yAxisScale==="linear"?t.ymax-t.ymin:void 0,n={xmin:su(t.xmin,r),xmax:su(t.xmax,r),ymin:su(t.ymin,i),ymax:su(t.ymax,i)};return t.zmin!==void 0&&t.zmax!==void 0&&(n.zmin=su(t.zmin,t.zmax-t.zmin),n.zmax=su(t.zmax,t.zmax-t.zmin)),n}function WN(t,e){return t===0?"":su(t,e)}function YN(t,e){return __dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},a$(t,e.scales)),{xstep:WN(e.steps.xAxisStep,t.xmax-t.xmin),ystep:WN(e.steps.yAxisStep,t.ymax-t.ymin)})}function cT(){return{limitLatex:__dcg_shared_module_exports__['b']({},jN)}}Oe();Wl();var c$={version:xl,randomSeed:"",graph:{viewport:{xmin:-10,ymin:-13.25,xmax:10,ymax:13.25}},expressions:{list:[{id:"1",type:"expression"}]}},hm=c$;Oe();function XN(t){let e=[],r=t.getAllItemModels();for(let i of r){let n=t.getItemRootNodeById(i.id);n&&e.push(n)}return e}function d$(t){let e=t.getAllItemModels();for(let r=e.length-1;r>=0;r--){let i=e[r];if(i.dcgView)return i.id}}function QN(t,e){let r=XN(t),i=0,n=r.length-1;for(;i<=n;){let o=i+Math.floor((n-i)/2),s=r[o],a=s.getBoundingClientRect();if(a.top>e)n=o-1;else if(a.bottom<e)i=o+1;else return s}}function h$(t,e){let r=XN(t),i=0,n=r.length-1,o;for(;i<=n;){let s=i+Math.floor((n-i)/2),a=r[s];a.getBoundingClientRect().top>e?(n=s-1,o=a):i=s+1}return o}function ZN(t,e){let r=Bb(t);if(!r)return;if(e){let n=t.getItemRootNodeById(e);if(n){let o=n.getBoundingClientRect();if(o.height>0&&o.top<=r.top&&o.bottom>=r.top)return e}}let i=QN(t,r.top);return i?I(i).attr("expr-id"):dT(t)}function eB(t,e){let r=Bb(t);if(!r)return;let i=d$(t);if(!i)return;if(e){let o=t.getItemRootNodeById(e);if(o){let s=o.getBoundingClientRect();if(s.height>0&&s.top<=r.bottom&&s.bottom>=r.bottom||e===i&&s.bottom<=r.bottom)return e}}let n=QN(t,r.bottom);return n&&I(n).attr("expr-id")||i}function dT(t){let e=Bb(t);if(!e)return;let r=h$(t,e.top-2);if(r)return I(r).attr("expr-id")}function Rb(t){return t.find$(".dcg-exppanel")[0]}function Nb(t){let e=Rb(t);if(e)return I(e)}function Bb(t){let e=Rb(t);if(e)return e.getBoundingClientRect()}function tB(t){let e=Rb(t);if(!e)return;let r=e.getBoundingClientRect(),i=e.scrollTop;return r.top-i}function rB(t){let e=t.find$(".dcg-expressionlist");if(e.length!==1)return;let r=e[0].getBoundingClientRect();return{width:r.width,height:r.height}}function iB(t){let e=Nb(t);if(!e)return;let r=e.find(".dcg-drag-container > *");if(r.length!==1)return;let i=r[0].getBoundingClientRect();return{width:i.width,height:i.height}}Oe();var Kb=class{constructor(e){this.active=!1,this.controller=e;let r=Nb(e);r&&(this.$exppanel=r)}startDragging(e){this.active=!0,this.mousePt=e,this.setupEventListeners()}applyDrag(){var S;let r=this.controller.getListModel().dragState;if(!r)return;this.scheduleUpdateScroll();let i=this.measureDOM(r);if(!i)return;let{floatingPreviewRect:n,dragState:o,visibleRects:s}=i,a=this.controller.getItemModel(o.firstItemId);if(!a)return;let l=a.index,c=s[0];if(c&&c.id!==a.id){let T=this.controller.getItemModel(c.id);T&&T.index>l&&(l=T.index-1)}let{cachedNamedAssignmentLatex:d,cachedTokenAssignmentLatex:u}=o;for(let{id:T,rect:V}of s){if(T===a.id)continue;let O=this.controller.getItemModel(T);if(!O)return;if(O.index<a.index){if(n.top<V.top+V.height/2){l=O.index;break}}else n.bottom>V.top+V.height/2&&(l=O.index,O.type==="folder"&&O.collapsed&&(l+=this.controller.getNumberOfItemsInFolder(O.id)))}let p,g;l>a.index?(p=l,g=l+1):l<a.index?(p=l-1,g=l):(p=l-1,g=l+1);let b=this.controller.getItemModelByIndex(p),x=this.controller.getItemModelByIndex(g),w="",E="";b&&(b.type==="folder"?w=b.id:w=b.folderId),x&&(x.type==="folder"?E=x.id:E=x.folderId);let k="";if(w&&(E===w?a.type==="folder"?l=a.index:k=w:a.type!=="folder"&&this.isPreviewTopContainedInFolder(i,w)&&(k=w)),a.type==="expression")if(o.renderType==="token"){if(r.renderType==="expression"&&(d=a.latex,this.controller.convertToTokenAssignment(a,u)),o.dragTarget.type==="token")l=o.dragTarget.originalIndex,k=((S=this.controller.getGeometryFolder())==null?void 0:S.id)||"";else if(o.dragTarget.type==="expression"){let T=this.controller.getGeometryFolder();if(T){let V=this.controller.getNumberOfItemsInFolder(T.id);a.type==="expression"&&a.folderId===T.id&&(V-=1),l=T.index+V+1,k=T.id}}}else o.renderType==="expression"&&r.renderType==="token"&&(u=a.latex,this.controller.convertToNamedAssignment(a,d));return{dragState:__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},o),{cachedNamedAssignmentLatex:d,cachedTokenAssignmentLatex:u}),newIndex:l,folderId:k}}measureDOM(e){let r=tB(this.controller),i=rB(this.controller),n=iB(this.controller);if(r===void 0||!i||!n)return;let o=i.height,s=n.height,a=!1,l=this.controller.getExppanelSelector(),c=l==null?void 0:l.find(".dcg-template-expressioneach")[0],d=c==null?void 0:c.getBoundingClientRect();d&&d.top<=e.mousePt.y&&(a=!0);let u=!1,p=l==null?void 0:l.find(".dcg-geo-show-constructions-pane")[0],g=p==null?void 0:p.getBoundingClientRect();g&&g.bottom>e.mousePt.y&&(u=!0);let b=!1;(e.dragTarget.type==="token"&&!a||e.dragTarget.type==="expression"&&u&&!a&&this.controller.canDraggedItemBeMovedIntoTokenPane())&&(b=!0);let x=e.grabOffset;b?x={x:n.width/2,y:n.height/2}:e.dragTarget.type==="token"&&(x={x:0,y:n.height/2});let w=e.mousePt.y-x.y+2,E=w-r;E=Math.max(E,-s/2),E=Math.min(E,o-s);let k=0;if(b){k=e.mousePt.x-x.x;let L=4;k=Math.min(k,i.width-n.width-L),k=Math.max(k,0),E=Math.max(E,2)}let S={left:k,top:w,bottom:w+s,height:s},T=this.controller.findFirstVisibleItem(),V=this.controller.findLastVisibleItem(),O=[];if(T&&V)for(var y=T.index;y<=V.index;y++){let L=this.controller.getItemModelByIndex(y);if(!L)continue;let P=this.controller.getItemRootNodeById(L.id);if(P&&L.id!==e.firstItemId){let K=P.getBoundingClientRect();O.push({id:L.id,rect:K})}}return{dragState:__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},e),{itemTop:E,itemLeft:k,renderType:b?"token":"expression"}),floatingPreviewRect:S,visibleRects:O}}isPreviewTopContainedInFolder(e,r){let{visibleRects:i,floatingPreviewRect:n}=e;for(let{id:o,rect:s}of i)if(s.top<=n.top&&s.bottom>=n.top){let a=this.controller.getItemModel(o);if(!a)return!1;if(a.type==="folder"&&a.id===r||a.type!=="folder"&&a.folderId===r)return!0}return!1}scheduleUpdateScroll(){this.updateScrollScheduled||(this.updateScrollScheduled=!0,requestAnimationFrame(()=>{this.updateScroll(),this.updateScrollScheduled=!1}))}stop(){this.active=!1,this.tearDownEventListeners(),this.controller.dispatch({type:"stop-dragdrop"})}setupEventListeners(){I(document).on("dcg-tapmove.dragdrop",e=>{this.mousePt.x=e.changedTouches[0].clientX,this.mousePt.y=e.changedTouches[0].clientY,this.controller.dispatch({type:"update-dragdrop",mousePt:this.mousePt})}),I(document).on("dcg-tapend.dragdrop",e=>{this.stop(),e.handle("dragdrop")})}tearDownEventListeners(){I(document).off(".dragdrop")}updateScroll(){if(this.active){var e=this.$exppanel[0].getBoundingClientRect(),r=0;r=Math.min(r,this.mousePt.y-e.top),r=Math.max(r,this.mousePt.y-e.bottom+30),r=r*e.height/900,r&&this.$exppanel.scrollTop(this.$exppanel.scrollTop()+r)}}};var p$={loga:t=>{t.write("\\log_{}"),t.typedText("("),t.keystroke("Left"),t.keystroke("Down")},nthroot:t=>{t.write("\\sqrt[]{}"),t.keystroke("Left"),t.keystroke("Left")},ddx:t=>{t.write("\\frac{d}{dx}")},arcsin:t=>{t.write("sin^{-1}"),t.typedText("(")},arccos:t=>{t.write("cos^{-1}"),t.typedText("(")},arctan:t=>{t.write("tan^{-1}"),t.typedText("(")},arcsec:t=>{t.write("sec^{-1}"),t.typedText("(")},arccsc:t=>{t.write("csc^{-1}"),t.typedText("(")},arccot:t=>{t.write("cot^{-1}"),t.typedText("(")},"A^T":t=>{t.typedText("^T"),t.keystroke("Right")},"A^-1":t=>{t.typedText("^-1"),t.keystroke("Right")},"A^2":t=>{t.typedText("^2"),t.keystroke("Right")},"a^2":t=>{t.typedText("^2"),t.keystroke("Right")},"a^3":t=>{t.typedText("^3"),t.keystroke("Right")},"a/b":t=>{t.write("\\frac{}{}"),t.keystroke("Left")},integral:t=>{t.cmd("integral")}};function pm(t,e){p$[e](t)}Oe();var gc=__dcg_shared_module_exports__['i'](ep()),es=__dcg_shared_module_exports__['i'](Z());var um=__dcg_shared_module_exports__['i'](Z());Oe();var{Input:u$}=um.Components,au=class extends um.Class{init(){this.ASCIICharacters=` A1B'K2L@CIF/MSP"E3H9O6R^DJG>NTQ,*5<-U8V.%[$+X!&;:4\\0Z7(_?W]#Y)=`,this.ASCIITable=[],this.HomeRowCharacters="FDSJKL",this.charCodes=[],this.sixKeyModel={keysDown:0,stickyKeysDown:0};let e;for(e=0;e<this.ASCIICharacters.length;e++)this.ASCIITable.push(this.ASCIICharacters.charCodeAt(e));for(e=0;e<this.HomeRowCharacters.length;e++)this.charCodes.push(this.HomeRowCharacters.charCodeAt(e))}template(){return um.createElement(u$,{class:this.const("dcg-braille-input dcg-do-blur"),tabindex:()=>this.props.tabindex?this.props.tabindex():0,readonly:()=>this.props.isStatic()?"true":void 0,autocomplete:this.const("off"),autocorrect:this.const("off"),autocapitalize:this.const("off"),spellcheck:this.const("false"),onKeydown:this.bindFn(this.onKeydown),onKeyup:this.bindFn(this.onKeyup),onInput:this.bindFn(this.props.onInput),value:()=>this.props.value(),"aria-label":()=>this.props.ariaLabel()||ca(""),didMount:this.bindFn(this.didMount),didUnmount:this.bindFn(this.props.didUnmount),placeholder:()=>this.props.placeholder?this.props.placeholder():"",size:()=>this.props.size&&this.props.size()})}didMount(e){this.rootNode=e,I(this.rootNode).on("focus",r=>{this.props.shouldFocus()||this.props.onFocusedChanged(!0,r.originalEvent||r)}).on("blur",r=>{this.props.shouldFocus()&&this.props.onFocusedChanged(!1,r.originalEvent||r)}),this.props.didMount(e),this.updateFocus()}didUpdate(){this.updateFocus()}updateFocus(){this.rootNode&&(this.props.shouldFocus()&&document.activeElement!==this.rootNode&&this.rootNode.focus(),!this.props.shouldFocus()&&document.activeElement===this.rootNode&&this.rootNode.blur())}onKeydown(e){let r=this.charCodes.indexOf(e.which);!this.props.isStatic()&&this.isSixKeyInput()&&!e.altKey&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey&&r!==-1?(this.sixKeyModel=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.sixKeyModel),{keysDown:this.addKey(this.sixKeyModel.keysDown,r),stickyKeysDown:this.addKey(this.sixKeyModel.stickyKeysDown,r)}),e.preventDefault()):this.props.onKeydown&&this.props.onKeydown(e)}onKeyup(e){let r=this.charCodes.indexOf(e.which),i=!1;return!this.props.isStatic()&&this.isSixKeyInput()&&!e.altKey&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey&&r!==-1?(this.sixKeyModel=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.sixKeyModel),{keysDown:this.removeKey(this.sixKeyModel.keysDown,r)}),this.sixKeyModel.keysDown===0&&(this.addCharacter(this.bitsToASCII(this.sixKeyModel.stickyKeysDown)),this.sixKeyModel=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.sixKeyModel),{stickyKeysDown:0}))):i=!0,i||e.preventDefault(),i}addKey(e,r){return e|1<<r}removeKey(e,r){return e&~(1<<r)}bitsToASCII(e){return String.fromCharCode(this.ASCIITable[e])}addCharacter(e){this.rootNode&&!this.props.isStatic()&&(this.rootNode.setRangeText(e,this.rootNode.selectionStart,this.rootNode.selectionEnd,"end"),this.props.onInput(this.rootNode.value))}isSixKeyInput(){return typeof this.props.sixKeyInput=="function"&&this.props.sixKeyInput()}};var{If:uT}=es.Components,kn=class extends es.Class{init(){this.currentBrailleValue=this.getBrailleFromLatex(this.props.latex()),this.currentBrailleMode=this.props.mode(),this.hasTranslationError=!1,this.currentLatex=this.props.latex()}isFocused(){return this.brailleInput!==void 0&&document.activeElement==this.brailleInput}getBrailleShouldFocus(){return this.props.mode()!=="none"&&this.props.brailleShouldFocus&&this.props.brailleShouldFocus()}isStatic(){return!!this.props.isStatic&&this.props.isStatic()}isInline(){return!!this.props.isInline&&this.props.isInline()}hasError(){return!!this.props.hasError&&this.props.hasError()}willUpdate(){let e=this.currentLatex!==this.props.latex(),r=this.props.mode(),i=r!==this.currentBrailleMode&&r!=="none";this.isFocused()&&!e&&!i||(this.currentLatex=this.props.latex(),(i||!this.hasTranslationError||e||this.isStatic())&&(this.currentBrailleValue=this.getBrailleFromLatex(this.props.latex()),this.hasTranslationError=!1),this.currentBrailleMode=r)}onBrailleInput(e){if(!this.props.onBrailleInput)return;let r=this.getLatexFromBraille(e);this.hasTranslationError=r.isError;let i=this.props.capExpressionSize&&this.props.capExpressionSize();if(!r.isError&&i&&i.exceedsLimit(r.value)){i.onExpressionSizeExceeded();return}this.currentBrailleValue=e,r.isError||(this.currentLatex=r.value,this.props.onBrailleInput(r.value))}getBrailleFromLatex(e,r=!1){let i=g$(e,this.props.mode());return i.isError?"":r?i.value:gc.UnicodeBraille.toExpandedBrailleAscii(i.value)}getLatexFromBraille(e){return m$(gc.UnicodeBraille.coerceToSixDotCells(e),this.props.mode())}getBrailleLabel(e){return this.getBrailleFromLatex(e.replace(/\s/,"\\ "))}shouldShowBraille(){let e=this.props.mode();return e==="nemeth"||e==="ueb"}isOverflowingLeft(){return this.brailleInput?this.brailleInput.scrollLeft>0:!1}isOverflowingRight(){if(!this.brailleInput)return!1;let e=this.brailleInput.getBoundingClientRect().width,r=this.brailleInput.scrollWidth,i=this.brailleInput.scrollLeft;return r>e+i+2}didMountBrailleInput(e){this.brailleInput=e}didUnmountBrailleInput(){this.brailleInput=void 0}getTooltipGravity(){let e=this.props.tooltipOptions&&this.props.tooltipOptions();return e&&e.gravity?e.gravity:"se"}getTooltipDelay(){let e=this.props.tooltipOptions&&this.props.tooltipOptions();return e&&e.delay?e.delay:0}handleBrailleFocusChanged(e,r){this.props.onBrailleFocusedChanged&&this.props.onBrailleFocusedChanged(e,r),this.brailleInput&&(e&&this.props.selectOnFocus&&this.props.selectOnFocus()&&this.brailleInput.select(),this.isStatic()&&this.brailleInput.scrollTo(0,0))}getTooltipText(){let e=this.props.placeholder&&!this.isFocused()?this.props.placeholder():"";return ca(this.props.latex()||e)}template(){return es.createElement("div",{class:es.const("dcg-mathquill-wrapper")},es.createElement(uT,{predicate:()=>this.shouldShowBraille()},()=>es.createElement("div",{class:()=>({"dcg-mathquill-braille":!0,"dcg-focus":this.getBrailleShouldFocus(),"dcg-invalid":this.hasError(),"dcg-mathquill-static-braille":this.isStatic(),"dcg-mathquill-braille-overflow-left":this.isOverflowingLeft(),"dcg-mathquill-braille-overflow-right":this.isOverflowingRight()}),"data-dcg-label":()=>this.props.dataLabelAttributeValue?this.props.dataLabelAttributeValue():void 0},es.createElement(Pe,{class:this.const("dcg-mathquill-braille-tooltip"),renderAsLatex:()=>({view:this.props.tooltipOptions().latexView}),tooltip:()=>this.getTooltipText(),gravity:this.bindFn(this.getTooltipGravity),delay:this.bindFn(this.getTooltipDelay),showOnTapstart:this.const(!0)},es.createElement(uT,{predicate:()=>this.isInline()},()=>es.createElement("span",{class:es.const("dcg-inline-braille")},()=>ca(this.getBrailleFromLatex(this.props.latex(),!0)))),es.createElement(uT,{predicate:()=>!this.isInline()},()=>es.createElement(au,{ariaLabel:()=>ca(this.props.ariaLabel?this.getBrailleLabel(this.props.ariaLabel()):""),didMount:this.bindFn(this.didMountBrailleInput),didUnmount:this.bindFn(this.didUnmountBrailleInput),onFocusedChanged:this.bindFn(this.handleBrailleFocusChanged),shouldFocus:this.bindFn(this.getBrailleShouldFocus),onKeydown:this.props.onBrailleKeydown,onInput:this.bindFn(this.onBrailleInput),sixKeyInput:this.props.sixKeyInput,value:()=>this.currentBrailleValue,placeholder:()=>ca(this.props.placeholder?this.getBrailleFromLatex(this.props.placeholder()):""),tabindex:()=>this.props.tabindex?this.props.tabindex():0,isStatic:this.bindFn(this.isStatic),size:()=>this.currentBrailleValue&&this.currentBrailleValue.length||1}))))),es.createElement("div",{class:es.const("dcg-typeset-math"),style:()=>({display:this.shouldShowBraille()&&!this.isInline()?"none":void 0}),"aria-hidden":()=>this.shouldShowBraille()},this.children))}};function zs(){if(!(!document.activeElement||!I(document.activeElement).hasClass("dcg-braille-input")))return document.activeElement}function gm(t){return!t||I(t).val()===""}function g$(t,e){return e==="nemeth"?gc.latexToNemeth(t):e==="ueb"?gc.latexToUeb(t):{isError:!0,error:"Braille mode should be 'nemeth' or 'ueb'"}}function m$(t,e){return e==="nemeth"?gc.nemethToLatex(t):e==="ueb"?gc.uebToLatex(t):{isError:!0,error:"Braille mode should be 'nemeth' or 'ueb'"}}function f$(t){for(let e in t)return!1;return!0}function y$(t){var i;if(t.type!=="expression")return;let e=t.formula.assignment;return e||((i=t.formula.geometry)==null?void 0:i.identifier)}function b$(t){var r,i;let e={lookupIdentifier:{},lookupCalcId:{}};for(let n of t){let o={calcId:n.id,identifier:y$(n),referencesTheseIdentifiers:{},referencedByTheseCalcIds:{}};e.lookupCalcId[o.calcId]=o,o.identifier&&(e.lookupIdentifier[o.identifier]=o)}for(let n of t){let o=e.lookupCalcId[n.id];if(o){if(n.type==="expression"){n.folderId===__dcg_shared_module_exports__['Oc']&&(o.isGarbageCollectable=!n.readonly,(n.latex.indexOf("\\operatorname{segments}")!==-1||gl(n))&&(o.deleteIfNotReferenced=!0));let s=(i=(r=n.formula.geometry)==null?void 0:r.call)==null?void 0:i.parents;s&&s.forEach(a=>{if(!a)return;let l=a[0];nB(e,o,l)})}Sg(n,s=>{var a=s.match(/(\\token{[0-9]+})/g);if(a)for(let l of a){let c=__dcg_shared_module_exports__['Jb'](l);c!==o.identifier&&nB(e,o,c)}})}}return e}function nB(t,e,r){e.referencesTheseIdentifiers[r]=!0;let i=t.lookupIdentifier[r];i&&(i.referencedByTheseCalcIds[e.calcId]=!0)}function w$(t,e,r){var c;let i=[];for(let d of e){let u=t.lookupCalcId[d];if(u){i.push(u);var n=u.referencesTheseIdentifiers;for(let p in n){let g=t.lookupIdentifier[p];g&&delete g.referencedByTheseCalcIds[u.calcId]}}}var o={};for(let d in r)for(let u of r[d]){let p=t.lookupIdentifier[u];p&&delete p.referencedByTheseCalcIds[d],o[u]=!0}var s={};for(let d of i){let u=d.referencesTheseIdentifiers;for(let g in u)o[g]=!0;let p=d.identifier;if(p){var a=(c=t.lookupIdentifier[p])==null?void 0:c.referencedByTheseCalcIds;if(a)for(let g in a){let b=t.lookupCalcId[g];b&&b.isGarbageCollectable&&(s[g]=!0)}}}for(let d in o){let u=t.lookupIdentifier[d];if(u&&u.deleteIfNotReferenced){var l=u.referencedByTheseCalcIds;u.calcId&&u.isGarbageCollectable&&f$(l)&&(s[u.calcId]=!0)}}for(let d of i)delete t.lookupCalcId[d.calcId],d.identifier&&delete t.lookupIdentifier[d.identifier];return Object.keys(s)}function oB(t,e,r){var c,d;let i=t.getAllItemModels(),n=e.map(u=>u.id),o=b$(i.concat(e));var s={};let a={};for(let u in r){let{nextLatex:p}=r[u],g=t.getItemModel(u);if((g==null?void 0:g.type)!=="expression")continue;let b={};for(let w of((d=(c=g.formula.geometry)==null?void 0:c.call)==null?void 0:d.parents)||[]){if(!w)continue;let[E]=w;b[E]=!0}for(let w in b)jl(p,__dcg_shared_module_exports__['Hb'](w))&&delete b[w];let x=Object.keys(b);x.length&&(a[u]=x)}let l=Object.keys(a).length>0;for(;n.length||l;){l=!1,n=w$(o,n,a);for(let u of n)s[u]=!0}return Object.keys(s)}var sB={version:xl,randomSeed:"",graph:{product:"graphing-3d",threeDMode:!0,viewport:{xmin:-10,ymin:-10,xmax:10,ymax:10,zmin:-10,zmax:10}},expressions:{list:[{id:"1",type:"expression"}]}};var mm={version:xl,randomSeed:"",graph:{viewport:{xmin:-10,ymin:-13.25,xmax:10,ymax:13.25},product:"geometry-calculator",showXAxis:!1,showYAxis:!1,degreeMode:!0},expressions:{list:[{type:"folder",id:__dcg_shared_module_exports__['Oc'],title:"geometry",secret:!0},{id:"1",type:"expression"}]}};function QD(t){return/^\s*https?:\/\/([-a-zA-Z0-9]*\.)?desmos\.com(:[0-9]+)?\/calculator\/./.test(t)}function gT(t){return/^\s*https?:\/\/([-a-zA-Z0-9]*\.)?desmos\.com(:[0-9]+)?\/geometry-beta\/./.test(t)}function x$(t){return/^\s*https?:\/\/([-a-zA-Z0-9]*\.)?desmos\.com(:[0-9]+)?\/3d\/./.test(t)}function mT(t){return/^\s*https?:\/\/([-a-zA-Z0-9]*\.)?desmos\.com(:[0-9]+)?\/geometry\/./.test(t)}function aB(t){return QD(t)?"graphing":gT(t)?"geometry-calculator":mT(t)?"geometry":x$(t)?"graphing-3d":void 0}ql();function lB(t){var e;switch(t.type){case"tick":return!1;case"tick-ticker":return!1;case"on-evaluator-changes":return!!((e=t.eventUpdates)!=null&&e.userAction);default:return!0}}var lu=class{constructor(e){this.__nextItemId=0;this.__pendingImageUploads={};this.__lastSelectedIdsForPropagation={};this.nextSubscription=0;this.subscriptions={};this._queuedCallbacks=[];this._hasUnsavedChanges=!1;this.shouldScrollSelectedItemIntoViewAfterDispatch=!1;this.lastParsableObjects={};this.isExpressionSearchStrValidForReplace=!1;this.isExpressionReplaceStrValidForReplace=!1;this.expressionSearchCount=0;this.expressionSearchOpen=!1;this.geoUIActive=!1;this.showConstructionsOpen=!1;this.activeTool="selection";this.activeTokens={selected:void 0,hovered:void 0};this.geoTools=[{key:"selection",dropdown:["selection","box-selection"],resetOnChange:["box-selection"]},{key:"point",dropdown:["point","midpoint"],resetOnChange:["midpoint"]},{key:"segment",dropdown:["segment","line","ray","parallel","perpendicular"],resetOnChange:["parallel","perpendicular"]},{key:"circle",dropdown:["circle","compass","arc"],resetOnChange:["compass","arc"]},{key:"angle",dropdown:["angle","directedangle"]},{key:"polygon"}];this.apiMethodCallStack=[];this.canShowKeyboardShortcuts=!1;this.toastData={};this.s=zl(()=>this.graphSettings.config.language);this.raw=(e,r)=>ca(e,r);this.hasTranslation=e=>{let r=this.graphSettings.config.language;return IV(e,r)};this.unpack=e=>{let r=this.graphSettings.config.language;return Ah(e,r)};this.dispatch=e=>{if(e.type==="blur-focus-location"&&this.dispatcher.isDispatching()){this.runAfterDispatch(()=>{this.dispatch(e)});return}if(e.type==="set-focus-location"&&this.dispatcher.isDispatching()){this.runAfterDispatch(()=>{this.dispatch(e)});return}if(e.type==="tick"&&this.dispatcher.isDispatching()){this.runAfterDispatch(()=>{this.dispatch(e)});return}e.type==="tick"||Rp("dispatch::"+this.bugsnagContext,{type:e.type}),this.dispatcher.isDispatching()&&Rp("dispatch-in-dispatch::"+this.bugsnagContext,{type:e.type}),this.dispatcher.dispatch(e),this.onEventsEmitted&&this.onEventsEmitted(this.enqueuedEvents);let r;for(;r=this._queuedCallbacks.shift();)r()};this._requiresTickNextFrame=!1;this.cachedGeoTokenDepths={};this.cachedGeoTokenGroups={};this.cachedGeoTokenInfo={};this.toolPreviewJSONState={};this.updateViews=()=>{for(var e in this.subscriptions)this.subscriptions[e]()};this.bugsnagContext="";this.inPrintMode=!1;this.lastInfiniteScrollFirstDOM=void 0;this.lastInfiniteScrollLastDOM=void 0;this.hasDispatchSinceLastInfiniteScrollUpdate=!1;this.stateStack=new Xd;this.isCurrentlyDoingSetState=!1;this.isCurrentlyDoingRestoreState=!1;var r,i;this.graphSettings=e,(i=(r=this.graphSettings).setController)==null||i.call(r,this),this.listModel=I_(this),this.layoutModel=lT(this.graphSettings.config),this.layoutMeasurements={width:0,height:0},this.settingsViewModel=cT(),this.imageRetryState={lastAttemptTime:0,attempts:0},this.makeGeoAPI(),this.setupDispatcher()}hasUnsavedChanges(){return this._hasUnsavedChanges}getExpressionSearchOpen(){return this.expressionSearchOpen}getShowConstructionsOpen(){return this.showConstructionsOpen}isGeoUIActive(){return this.geoUIActive}isGeoToolActive(){return this.activeTool!=="selection"&&this.activeTool!=="box-selection"}getActiveTool(){return this.activeTool}getGeoModel(){return this.geoModel}getGeoTools(){return this.geoTools}getTickerOpen(){return this.areActionsEnabled()?this.listModel.ticker.open:!1}getTickerPlaying(){return this.areActionsEnabled()?this.listModel.ticker.playing:!1}hasVisibleAndUndoableToast(){return typeof this.toastData.undoCallback=="function"}toastUndo(){typeof this.toastData.undoCallback=="function"&&(this.toastData.undoCallback(),this.dispatch({type:"toast/close"}))}runAfterDispatch(e){this.dispatcher.isDispatching()?this._queuedCallbacks.push(e):e()}enqueueEvent(e,r){var n;let i=r&&this.apiMethodCallStack.length===0&&lB(r)||!!((n=this.enqueuedEvents[e])!=null&&n.isUserInitiated)||e==="userMovedPoint";this.enqueuedEvents[e]={isUserInitiated:i}}pushAPIMethodCall(){this.apiMethodCallStack.push(!0)}popAPIMethodCall(){this.apiMethodCallStack.pop()}getGrapherDimensions(){if(!this.grapher)return{width:0,height:0};let{screen:e}=this.grapher.getProjection();return{width:e.width,height:e.height}}setRandomSeed(e){this.graphSettings.setProperty("randomSeed",e)}getRandomSeed(){return this.graphSettings.randomSeed}shouldDispatchTickNextFrame(){return!!this._requiresTickNextFrame}markTickRequiredNextFrame(){this._requiresTickNextFrame=!0}handleTick(e){var r;this.areActionsEnabled()&&E_(this.listModel.ticker,{currentFrameTime:e,previousFrameTime:this.lastFrameTime})?this.dispatch({type:"tick-ticker",time:e}):this.shouldDispatchTickNextFrame()&&this.dispatch({type:"tick",time:e}),this.getGeoModel().isFading()&&((r=this.grapher)==null||r.redrawAllLayers()),this.lastFrameTime=e}setupDispatcher(){this.dispatcher=new sd,this.dispatcher.register(e=>{let r=this.getSelectedItem(),i=this.getFocusLocation();this.shouldScrollSelectedItemIntoViewAfterDispatch=!1;let n;this.enqueuedEvents={change:void 0,graphReset:void 0,clearUnsavedChanges:void 0,openDrawer:void 0,showHotkeysModal:void 0,userMovedPoint:void 0,userClickedObject:void 0,userEditedLabel:void 0},e.type==="tick"&&(this._requiresTickNextFrame=!1),this.isCurrentlyDoingSetState=!1,this.isCurrentlyDoingRestoreState=!1,this.handleDispatchedAction(e),this.constrainMultiSelect(),this.updateTheComputedWorld();var o=this.getImageToRetry();(this.getPlayingSliders().length>0||this.isDragDropActive()||o)&&this.markTickRequiredNextFrame(),o&&this.retryLoadingFailedImage(o),e.type!=="undo"&&e.type!=="redo"&&!this.isDragDropActive()&&this.commitUndoRedoSynchronously(e),this.requestParseForAllItems(),this.isCurrentlyDoingSetState=!1,this.isCurrentlyDoingRestoreState=!1,this.enqueuedEvents.change&&this.grapher&&this.grapher.markLabelsDirty(),this.enqueuedEvents.clearUnsavedChanges?this._hasUnsavedChanges=!1:this.enqueuedEvents.change&&(this._hasUnsavedChanges=!0);let s=this.getSelectedItem();s?(!r||r.guid!==s.guid)&&(this.shouldScrollSelectedItemIntoViewAfterDispatch=!0):this.shouldScrollSelectedItemIntoViewAfterDispatch=!1;let a=this.getFocusLocation();a&&!__dcg_shared_module_exports__['F'](a,i)&&this.getFocusedItem()==s&&(this.shouldScrollSelectedItemIntoViewAfterDispatch=!0),i&&r&&r.type==="table"&&i.type==="table"&&(!a||a.type!=="table"||i.id!==a.id)&&r.isExpanded&&(Rg(r,!1),a||(n=r)),a&&s&&s.type==="table"&&mF(s),(e.type==="adjust-slider-by-dragging-thumb"||e.type==="adjust-slider-by-keyboard")&&(n=this.getItemModel(e.id)),this.updateRenderShellsBeforePaint(),this.updateViews(),n?this.scrollItemIntoView(n):this.shouldScrollSelectedItemIntoViewAfterDispatch&&this.scrollSelectedItemIntoView(),this.updateDragDrop(),this.updateRenderShellsAfterDispatch()})}handleDispatchedAction(e){var u,p,g,b;switch(e.type){case"render":break;case"undo":this.undo();break;case"redo":this.redo();break;case"clear-undoredo-history":this.clearUndoRedoHistory();break;case"on-special-key-pressed":e.key==="Enter"?nT(this):e.key==="Up"?eT(this):e.key==="Down"?tT(this):e.key==="Backspace"?rT(this):e.key==="Delete"&&iT(this);break;case"select-previous-expression":vC(this.listModel);break;case"select-next-expression":CC(this.listModel);break;case"toggle-label-for-all-selected-points":this.toggleLabelForAllSelectedObjects();break;case"update-all-selected-items":{let y=e.update;if(e.update.prop==="folderId"){let L;if(e.update.createFolder){L=this.generateId();let _=this.createItemModel({type:"folder",id:L,title:e.update.value}),A=this.getItemCount()-1,z=Gg(this.listModel,A);z&&z.type==="expression"&&z.latex===""?this._toplevelReplaceItemAt(this.getItemCount()-1,_,!1):Ql(this.listModel,_)}else L=e.update.value;let P=this.getItemModel(L);if(!P||P.type!=="folder")return;let K={},$={};this.getAllSelectedItems().forEach(_=>{var A;if(!(_.type==="folder"||_.folderId===L)&&(K[_.id]=_,_.type==="expression")){let z=(A=_.formula.geometry)==null?void 0:A.call;if(z&&z.symbol==="apply"){let Q=z.parents[0]&&z.parents[0][0];Q&&($[Q]=!0)}}});for(let _ in $){let A=Ag(this.listModel,_);A.length===1&&A[0].folderId!==L&&(K[A[0].id]=A[0])}let U={},J=[];for(let _ in K){let A=K[_];J.push(A)}J.forEach(_=>{if(_.type==="expression"){let A=WV(_);A&&(U[_.id]=A)}}),J.sort((_,A)=>_.index-A.index);let R=this.findLastSubscriptForLetters();J.forEach(_=>{if(_.type==="expression"){var A=U[_.id];if(A){let z=this.getAutonameLatexForExpression(_,R);Kh(this.listModel,A,z)}}}),J.forEach(_=>{Og(this.listModel,_.id)});let q=P.index+this.getNumberOfItemsInFolder(L)+1;J.forEach(_=>{za(this.listModel,_,q),q+=1}),J.forEach(_=>{No(_,L)})}else if(y.prop==="visible")this.getAllSelectedItems().forEach(L=>{this._setItemHidden(L.id,!y.value),y.value===!1&&L.type==="expression"&&Kp(L,!1)});else if(e.update.prop==="color"){let L=e.update.value;this.getAllSelectedItems().forEach(P=>{P.type==="expression"&&Fv(P,L)})}else if(e.update.prop==="colorLatex"){let L=e.update.value;this.getAllSelectedItems().forEach(P=>{P.type==="expression"&&gy(P,L)})}else if(e.update.prop==="showLabel"){let L=e.update.value;this.getAllSelectedItems().forEach(P=>{P.type==="expression"&&Kp(P,L)})}else if(e.update.prop==="label"){let L=e.update.value;this.getAllSelectedItems().forEach(P=>{P.type==="expression"&&Pd(P,L)})}else if(e.update.prop==="dragMode"){let L=e.update.value;this.getAllSelectedItems().forEach(P=>{P.type==="expression"&&Up(P,L)})}else if(e.update.prop==="lineWidth"){let L=e.update.value;this.getAllSelectedItems().forEach(P=>{P.type==="expression"&&mg(P,L)})}else if(e.update.prop==="lineOpacity"){let L=e.update.value;this.getAllSelectedItems().forEach(P=>{P.type==="expression"&&gg(P,L)})}else if(e.update.prop==="lineStyle"){let L=e.update.value;this.getAllSelectedItems().forEach(P=>{P.type==="expression"&&Bv(P,L)})}else if(e.update.prop==="strictIntersection"){let L=e.update.value;this.getAllSelectedItems().forEach(P=>{P.type==="expression"&&nO(P,L)})}}break;case"delete-all-selected-items":let x=xI(this.listModel,Object.keys(this.getSelectedExpressionIds()));this.garbageCollectGeo(x,{}),this.ensureAtLeastOneVisibleItem(),me(this.s("graphing-calculator-narration-items-deleted",{count:new ks(x.length)}));break;case"upward-delete-selected-expression":oT(this,{moveSelection:!1});break;case"downward-delete-selected-expression":sT(this,{moveSelection:!1});break;case"table-show-more-rows":{let y=this.getItemModel(e.id);if(!y||y.type!=="table")return;let L=Jp(y);if(!L)return;ri(this.listModel,y),Rg(y,!0),Pi(this,{type:"table",id:y.id,location:{row:L.min,column:0}})}break;case"navigate-table-by-key":zN(this,e.id,e.key);break;case"delete-item-and-animate-out":this._deleteItemAndAnimateOut(e.id,e.setFocusAfterDelete);break;case"finish-deleting-item-after-animation":this._finishDeletingItemAfterAnimation(e.id,e.setFocusAfterDelete);break;case"expression-zoom-fit":this._expressionZoomFit(e.id,e.focusAfterTap);break;case"set-expression-properties-from-api":this._setExpressionPropertiesFromAPI(e.id,e.properties);break;case"add-item-to-end-from-api":this._addItemToEndFromAPI(this.createItemModel(e.state));break;case"duplicate-expression":{let y=this.getItemModel(e.id);if(!y||y.type==="folder")return;this.copyExpressionToIndex(y,y.index+1)}break;case"duplicate-folder":{let{id:y}=e,L=this.getItemModel(y);if(!L||L.type!=="folder")return;let P=this.createItemModel(__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},iC(L,{stripDefaults:!1})),{id:this.generateId()})),K=this.getNumberOfItemsInFolder(y),$=K+1;this._toplevelInsertItemAt(L.index+$,P,!1,void 0);let U=L.index+1,J=U+K;for(let R=U;R<=J;R++){let q=Gg(this.listModel,R);if(!q||q.type==="folder")return;this.copyExpressionToIndex(q,R+$,P.id)}}break;case"insert-item-at-index":{let y=this.createItemModel(e.state);this._toplevelInsertItemAt(e.index,y,e.focus,e.folderId)}break;case"new-expression-at-end":{this.setGeoTool("selection");let y=this.createItemModel({type:"expression",id:this.generateId(),color:this.getNextColor()});this.setEditListMode(!1),Ql(this.listModel,y),Xn(this,y.id)}break;case"new-expression":{let y=this.createItemModel({type:"expression",id:this.generateId(),color:this.getNextColor()});this.setEditListMode(!1),this._toplevelNewItemAtSelection(y,{shouldFocus:!0}),this._closeAddExpression()}break;case"new-text":{let y=this.createItemModel({id:this.generateId(),type:"text"});this._toplevelNewItemAtSelection(y,{shouldFocus:!0}),this._closeAddExpression()}break;case"new-folder":{let y=this.createItemModel({type:"folder",id:this.generateId()});this._toplevelNewItemAtSelection(y,{shouldFocus:!0}),this._closeAddExpression()}break;case"new-images":this._uploadImagesAndWaitForThemToLoad({files:e.files}),this._closeAddExpression();break;case"change-image":this._uploadImagesAndWaitForThemToLoad({files:e.files,id:e.id});break;case"new-table":{let y=this._createTableItem();this._toplevelNewItemAtSelection(y,{shouldFocus:!0}),this._closeAddExpression()}break;case"paste-table":this._pasteTable(e.data);break;case"insert-several-expressions":this.shouldScrollSelectedItemIntoViewAfterDispatch=!0,this._insertSeveralExpressions(e.expressions);break;case"append-number-list":this._appendNumberList(e.latex);break;case"remove-item-by-id":Og(this.listModel,e.id);break;case"replace-item-at-index":{let y=this.createItemModel(e.state);this._toplevelReplaceItemAt(e.index,y,e.focus)}break;case"create-sliders-for-item":this.createSlidersForItem(e.id,e.variables);break;case"create-sliders-for-ticker":this.createSlidersForTicker(e.variables);break;case"convert-image-to-draggable":this.convertImageToDraggable(e.id);break;case"start-dragdrop":{let y=this.getItemModel(e.dragTarget.calcId);if(!y)return;let L={x:0,y:0},P=this.getItemRootNodeById(y.id);if(P){let U=P.getBoundingClientRect();L.y=e.grabPt.y-U.top,L.x=e.grabPt.x-U.left}this.isItemSelected(y.id)?ri(this.listModel,y):ri(this.listModel,void 0);let K=!1,$=1;y.type==="folder"&&($+=this.getNumberOfItemsInFolder(y.id),y.collapsed||(K=!0,wg(y,!0))),Gy(this.listModel,{firstItemId:y.id,numberOfItems:$,expandFolder:K,grabOffset:L,mousePt:e.mousePt,dragTarget:e.dragTarget,renderType:e.dragTarget.type,itemTop:0,itemLeft:0}),this.dragdrop_expressions.startDragging(e.mousePt)}break;case"update-dragdrop":{let y=this.listModel.dragState;if(!y)return;Gy(this.listModel,__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},y),{mousePt:e.mousePt}))}break;case"stop-dragdrop":{let y=this.listModel.dragState;if(!y)return;let L=this.getItemModel(y.firstItemId);if(!L)return;L.type==="folder"&&y.expandFolder&&wg(L,!1),Gy(this.listModel,void 0),this.ensureAtLeastOneVisibleItem()}break;case"set-selected-id":{let y=this.getItemModel(e.id);ri(this.listModel,y)}break;case"set-all-selected-ids":DI(this.listModel,e.ids);break;case"toggle-selected-with-multi-select":CI(this.listModel,e.id);break;case"set-selected-index":{let y=this.getItemModelByIndex(e.index);ri(this.listModel,y)}break;case"set-none-selected":ri(this.listModel,void 0);break;case"set-focus-location":{let y=e.location?e.location.type:"";if(y==="expression"&&this.setGeoTool("selection"),y==="table"&&(this.layoutModel=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.layoutModel),{inEditListMode:!1})),y==="graph-paper"){this.setGraphPaperFocus({isFocused:!0});break}Pi(this,e.location)}break;case"focus-first-expression":{if(!this.getGraphSettings().config.expressions)return;let y=Vg(this.listModel);if(!y)break;Xn(this,y.id,"end");break}case"move-focus-to-item":Xn(this,e.id,e.where);break;case"blur-focus-location":this.isFocusLocationFocused(e.location)&&Pi(this,void 0),((u=e.location)==null?void 0:u.type)==="graph-paper"&&this.setGraphPaperFocus({isFocused:!1});break;case"set-folder-collapsed":{let y=this.getItemModel(e.id);if(!y||y.type!=="folder")return;wg(y,e.isCollapsed)}break;case"set-all-folders-collapsed":nF(this.listModel,e.isCollapsed);break;case"set-item-secret":{let y=this.getItemModel(e.id);if(!y)return;EI(y,e.isSecret)}break;case"set-item-readonly":{let{id:y,readonly:L}=e,P=this.getItemModel(y);if(!P)return;if(_C(P,L),P.type==="folder")for(let K of P_(this.listModel,y))_C(K,L)}break;case"set-tablecolumn-color":{let y=this.getItemModel(e.tableId);if(!y||y.type!=="table")return;LF(y,e.columnId,e.color)}break;case"set-tablecolumn-colorlatex":{let y=this.getItemModel(e.tableId);if(!y||y.type!=="table")return;VC(y,e.columnId,e.colorLatex)}break;case"set-show-cdf":{let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;kO(y,e.showCDF)}break;case"set-cdf-min":{let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;Xv(y,e.latex)}break;case"set-cdf-max":{let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;Qv(y,e.latex)}break;case"toggle-item-hidden":this._toggleItemHidden(e.id);break;case"toggle-tablecolumn-hidden":this._toggleTableColumnHidden(e.tableId,e.columnId);break;case"toggle-item-settings-menu":this.isItemSettingsMenuOpen(e.menu.guid)?this.closeItemSettingsMenu():(this.listModel.openItemMenu=e.menu,e.menu.focusFirstOption&&(e.menu.type==="geo-tool-dropdown"?Pi(this,{type:"geo-basic-tool-menu-item",tool:e.menu.tools[0]}):e.menu.type==="multi-select-more"||e.menu.type==="multi-select-transformations"?Pi(this,{type:"generic-menu",where:"start"}):Pi(this,{type:"expression-menu",id:e.menu.model.id,location:"start"})));break;case"close-item-settings-menu":this.closeItemSettingsMenu();break;case"toggle-fraction-evaluation":{let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;let L=_h(y);JP(y,!L)}break;case"set-item-label":{let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;Pd(y,e.label),this.enqueueEvent("userEditedLabel",e)}break;case"set-item-showlabel":{let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;Kp(y,e.showLabel),e.showLabel||(fy(y,!1),qv(y,"NONE"))}break;case"set-item-color":{let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;Fv(y,e.color)}break;case"set-item-description":{let y=this.getItemModel(e.id);if(!y||y.type!=="expression"&&y.type!=="image")return;y.type==="expression"?YP(y,e.description):y.type==="image"&&i_(y,e.description)}break;case"set-item-fill":{let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;YV(y,e.fill),this._setItemHidden(y.id,qp(y))}break;case"set-image-opacity":{let y=this.getItemModel(e.id);if(!y||y.type!=="image")return;s_(y,e.opacity),this._setItemHidden(y.id,!1)}break;case"set-image-in-foreground":{let y=this.getItemModel(e.id);if(!y||y.type!=="image")return;pI(y,e.foreground)}break;case"image-upload-error":this.__pendingImageUploads[e.token]&&(delete this.__pendingImageUploads[e.token],this._showToast({message:this.s("graphing-calculator-text-toast-image-upload-failed")}));break;case"image-upload-success":{if(this.__pendingImageUploads[e.token])if(delete this.__pendingImageUploads[e.token],e.id){let y=this.getItemModel(e.id);y&&y.type==="image"&&a_(y,e.url)}else{let y=this.createItemModel({type:"image",id:this.generateId(),width:e.width,height:e.height,image_url:e.url,name:e.name});this._toplevelNewItemAtSelection(y,{shouldFocus:!1})}this.isUploadingImages()||(this.toastData={})}break;case"image-load-success":{let y=this.getItemModel(e.id);if(!y||y.type!=="image")return;hC(y,"loaded"),this.imageRetryState={lastAttemptTime:0,attempts:0}}break;case"image-load-error":{let y=this.getItemModel(e.id);if(!y||y.type!=="image")return;hC(y,"failed")}break;case"image-retry-loading":{let y=this.getItemModel(e.id);if(!y||y.type!=="image")return;gI(y)}break;case"set-item-dragmode":{let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;Up(y,e.dragMode)}break;case"set-tablecolumn-dragmode":{let y=this.getItemModel(e.tableId);if(!y||y.type!=="table")return;AF(y,e.columnId,e.dragMode),e.dragMode!=="NONE"&&this._setTableColumnHidden(e.tableId,e.columnId,!1)}break;case"set-tablecolumn-points":{let y=this.getItemModel(e.tableId);if(!y||y.type!=="table")return;II(y,e.columnId,e.bool),this._setTableColumnHidden(e.tableId,e.columnId,qC(y,e.columnId))}break;case"set-tablecolumn-lines":{let y=this.getItemModel(e.tableId);if(!y||y.type!=="table")return;MF(y,e.columnId,e.bool),this._setTableColumnHidden(e.tableId,e.columnId,qC(y,e.columnId))}break;case"set-tablecolumn-linestyle":{let y=this.getItemModel(e.tableId);if(!y||y.type!=="table")return;TF(y,e.columnId,e.lineStyle),this._setTableColumnHidden(e.tableId,e.columnId,!1)}break;case"set-tablecolumn-linewidth":{let y=this.getItemModel(e.tableId);if(!y||y.type!=="table")return;SC(y,e.columnId,e.lineWidth),this._setTableColumnHidden(e.tableId,e.columnId,!1)}break;case"set-tablecolumn-lineopacity":{let y=this.getItemModel(e.tableId);if(!y||y.type!=="table")return;EC(y,e.columnId,e.lineOpacity),this._setTableColumnHidden(e.tableId,e.columnId,!1)}break;case"set-tablecolumn-pointsize":{let y=this.getItemModel(e.tableId);if(!y||y.type!=="table")return;kC(y,e.columnId,e.pointSize),this._setTableColumnHidden(e.tableId,e.columnId,!1)}break;case"set-tablecolumn-pointopacity":{let y=this.getItemModel(e.tableId);if(!y||y.type!=="table")return;GC(y,e.columnId,e.pointOpacity),this._setTableColumnHidden(e.tableId,e.columnId,!1)}break;case"set-tablecolumn-pointstyle":{let y=this.getItemModel(e.tableId);if(!y||y.type!=="table")return;IF(y,e.columnId,e.pointStyle),this._setTableColumnHidden(e.tableId,e.columnId,!1)}break;case"set-item-points":{let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;XV(y,e.points),this._setItemHidden(e.id,qp(y)),!e.points&&y.dragMode!=="NONE"&&Up(y,"NONE")}break;case"set-item-pointstyle":{let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;QV(y,e.pointStyle),this._setItemHidden(e.id,!1)}break;case"set-item-lines":{let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;ZV(y,e.lines),this._setItemHidden(e.id,qp(y))}break;case"set-item-surfaces":{let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;ZP(y,e.surfaces),this._setItemHidden(e.id,qp(y))}break;case"set-item-linestyle":{let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;Bv(y,e.lineStyle),this._setItemHidden(e.id,!1)}break;case"set-item-arrow-mode":{let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;eO(y,e.value),this._setItemHidden(e.id,!1);break}case"set-item-label-dropdown-open":{let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;QP(y,e.open)}break;case"set-item-fillopacity":{let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;hy(y,e.fillOpacity),this._setItemHidden(e.id,!1)}break;case"set-item-lineopacity":{let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;gg(y,e.lineOpacity),this._setItemHidden(e.id,!1)}break;case"set-item-pointopacity":{let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;py(y,e.pointOpacity),y.showLabel||this._setItemHidden(e.id,!1)}break;case"set-item-pointsize":{let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;uy(y,e.pointSize),this._setItemHidden(e.id,!1)}break;case"set-item-linewidth":{let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;mg(y,e.lineWidth),this._setItemHidden(e.id,!1)}break;case"set-item-resolution":{let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;Rv(y,e.resolution),this._setItemHidden(e.id,!1)}break;case"set-item-checkers":{let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;Nv(y,e.checkers),this._setItemHidden(e.id,!1)}break;case"set-item-polar-coordinate-system":{let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;XP(y,e.polarCoordinateSystem),this._setItemHidden(e.id,!1)}break;case"set-item-colorlatex":{let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;gy(y,e.colorLatex)}break;case"set-item-labelSize":{let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;my(y,e.labelSize)}break;case"set-item-labelangle":{let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;Uv(y,e.labelAngle)}break;case"set-item-label-orientation":{let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;eI(y,e.labelOrientation)}break;case"set-suppress-text-outline":{let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;rO(y,e.suppressTextOutline)}break;case"set-item-interactive-label":{let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;fy(y,e.interactiveLabel),e.interactiveLabel&&qv(y,"NONE")}break;case"set-item-editable-label-mode":{let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;y.editableLabelMode!=="NONE"&&e.editableLabelMode!=="NONE"&&y.editableLabelMode!==e.editableLabelMode&&Pd(y,""),qv(y,e.editableLabelMode),e.editableLabelMode!=="NONE"&&fy(y,!1)}break;case"plot-residuals":{let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;var r=y.formula.regression;if(!r)return;var i=r.residualSuggestionId;if(!i)return;var n=this.getItemModel(i);if(!n)return;UC(n,{latex:__dcg_shared_module_exports__['Hb'](r.residualVariable),columnIndex:n.columnModels.length-1})}break;case"toggle-logmode":{let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;var o=y.isLogModeRegression;JV(y,!o)}break;case"set-item-latex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;let L=e.latex,P=y.latex;if(this.garbageCollectGeo([],{[y.id]:{prevLatex:P,nextLatex:L}}),L==='"'&&this.areNotesEnabled()){let K=this.createItemModel({id:this.generateId(),type:"text"});this._toplevelReplaceItemAt(y.index,K,!0)}else if(L==="")LO(y);else if(L==="ticker"&&this.canAddTicker())this.listModel.ticker.open=!0,this.focusLocation={type:"ticker",location:"handler"},this._removeExpressionSynchronously(y);else if(L==="folder"&&this.areFoldersEnabled()){let K=this.createItemModel({id:this.generateId(),type:"folder"});ma(y)?(this._toplevelNewItemAtSelection(K,{shouldFocus:!0}),Bs(y,"")):this._toplevelReplaceItemAt(y.index,K,!0)}else if(L==="table"){let K=this._createTableItem();this._toplevelReplaceItemAt(y.index,K,!0)}else!this.isGeometry()&&(L==="betchacant"||L==="pride")?this.runAfterDispatch(()=>{this.triggerEasterEgg&&this.triggerEasterEgg(L)}):(Bs(y,L),this.lastUserUpdatedExpressionItem=y)}break;case"set-visualization-prop":{let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;OP(y,e.prop,e.value)}break;case"set-clickableinfo-prop":{let y=this.getItemModel(e.id);if(!y)return;y.type==="expression"?_P(y,e.prop,e.value):y.type==="image"&&pC(y,e.prop,e.value)}break;case"set-clickableinfo-rule-latex":{let y=this.getItemModel(e.id);if(!y)return;y.type==="expression"?Mv(y,e.latex):y.type==="image"&&g_(y,e.latex)}break;case"set-folder-title":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let y=this.getItemModel(e.id);if(!y||y.type!=="folder")return;RO(y,e.title)}break;case"set-image-mq-attribute":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let y=this.getItemModel(e.id);if(!y||y.type!=="image")return;ya(y,e.attribute,e.latex)}break;case"set-image-name":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let y=this.getItemModel(e.id);if(!y||y.type!=="image")return;n_(y,e.name)}break;case"set-image-draggable":{let y=this.getItemModel(e.id);if(!y||y.type!=="image")return;let L=xg(y);if(!L)return;hI(y,e.draggable),e.draggable&&(L.reconciledDragMode==="NONE"||L.dragMode==="AUTO")&&Up(L,"XY")}break;case"set-graph-settings":{let y=!this.isThreeDMode();"threeDMode"in e&&e.threeDMode&&y&&this.grapher.controls.prepareTransitionFrom2Dto3D();for(let P in e)P!=="type"&&(P==="xAxisScale"?this.switchAxisScale("xAxisScale",e.xAxisScale):P==="yAxisScale"?this.switchAxisScale("yAxisScale",e.yAxisScale):this.graphSettings.setProperty(P,e[P]));this.grapher3d&&this.isThreeDMode()&&(this.grapher2d.redrawAllLayers(),this.grapher2d.tick(0),"backgroundColor3d"in e&&this.grapher3d.webglLayer.setBackgroundColor(e.backgroundColor3d)),(y||!("threeDMode"in e))&&this.apply3dProps(e)}break;case"set-polar-mode":this.graphSettings.setProperty("polarMode",e.polarMode),e.polarMode&&(this.graphSettings.xAxisScale==="logarithmic"||this.graphSettings.yAxisScale==="logarithmic")&&this.grapher&&(this.graphSettings.setProperty("xAxisScale","linear"),this.graphSettings.setProperty("yAxisScale","linear"),this.grapher.viewportController.setViewport(this.grapher.getDefaultViewport()),(p=this.grapher)==null||p.getProjection().updateScalePairs());break;case"set-polar-domain-minlatex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;iy(y,e.latex)}break;case"set-polar-domain-maxlatex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;ay(y,e.latex)}break;case"set-parametric-domain-minlatex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;ny(y,e.latex)}break;case"set-parametric-domain3Du-minlatex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;oy(y,e.latex)}break;case"set-parametric-domain3Dv-minlatex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;sy(y,e.latex)}break;case"set-parametric-domain-maxlatex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;ly(y,e.latex)}break;case"set-parametric-domain3Du-maxlatex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;cy(y,e.latex)}break;case"set-parametric-domain3Dv-maxlatex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;dy(y,e.latex)}break;case"set-note-text":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let y=this.getItemModel(e.id);if(!y||y.type!=="text")return;HO(y,e.text)}break;case"set-edit-list-mode":{let y=Lg(this.listModel);if(this.setEditListMode(e.isEditListMode),e.focusExpressionList){if(y===void 0&&(y=this.getItemModelByIndex(0)),!y)return;Xn(this,y.id,y.type==="table"&&e.isEditListMode?"container":"start")}else ri(this.listModel,void 0),Pi(this,void 0)}break;case"set-projector-mode":this.getGraphSettings().config.setProperty("projectorMode",e.value),this.isThreeDMode()&&(this.grapher2d.redrawAllLayers(),this.grapher2d.tick(0));break;case"set-inverted-colors":this.getGraphSettings().config.setProperty("invertedColors",e.value);break;case"set-tablecell-latex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let y=this.getItemModel(e.tableId);if(!y||y.type!=="table")return;Fd(y,e.cell,e.latex)}break;case"set-state":this.externalSetState(e.state,e.opts);break;case"set-blank":this.externalSetState(this.getBlankState({degreeMode:e.degreeMode}),e.opts);break;case"clear-unsaved-changes":this.enqueueEvent("clearUnsavedChanges",e);break;case"reset-graph":{let y=this.getState();this.externalSetState(this.graphSettings.defaultState,{allowUndo:!0});let L=this.getItemModelByIndex(0);L&&Xn(this,L.id,"end"),this._showToast({message:this.s("graphing-calculator-text-toast-graph-reset"),undoCallback:()=>this.dispatch({type:"set-state",state:y,opts:{allowUndo:!0}})}),this.enqueueEvent("graphReset",e)}break;case"clear-graph":{if(this.triggerClearGraph){this.runAfterDispatch(()=>this.triggerClearGraph());return}let y=this.getState();this.externalSetState(this.getBlankState(),{allowUndo:!0});let L=this.getItemModelByIndex(0);L&&Xn(this,L.id,"end"),this._showToast({message:this.s("graphing-calculator-text-toast-graph-cleared"),undoCallback:()=>this.dispatch({type:"set-state",state:y,opts:{allowUndo:!0}})}),this.enqueueEvent("graphReset",e)}break;case"on-evaluator-changes":{if(this.onEvaluatorChangesSpy&&this.onEvaluatorChangesSpy(e.changes,e.timingData,e.graphData,e.eventUpdates),tF(this.listModel,e.changes),!e.graphData)break;if(this.grapher){for(let y in e.graphData.addedGraphs){var s=e.graphData.addedGraphs[y];if(__dcg_shared_module_exports__['Ub'](s)){let L=s.filter(K=>!__dcg_shared_module_exports__['ic'](K.graphMode)),P=s.filter(K=>__dcg_shared_module_exports__['ic'](K.graphMode));this.grapher2d.updateSketch(y,L),(g=this.grapher3d)==null||g.updateSketch(y,P),eF(this.listModel,y,s)}}for(let y in e.graphData.removedGraphs)this.grapher2d.removeGraphSketch(y),(b=this.grapher3d)==null||b.removeGraphSketch(y);if(this.grapher.type==="2d"){for(let y in e.graphData.intersections){let L=e.graphData.intersections[y];__dcg_shared_module_exports__['Ub'](L)&&this.grapher.updateIntersections(y,L)}this.grapher.poiController&&this.grapher.poiController.handleTraceUpdate()}else this.grapher.type==="3d"&&(this.grapher2d.redrawAllLayers(),this.grapher2d.tick(0))}if(e.eventUpdates){let y=!1;for(let L in e.eventUpdates.updates)if(this.doesIdentifierBlockActionUpdate(L)){y=!0;break}if(!y){for(let L in e.eventUpdates.updates)this.updateLatexForIdentifier(L,e.eventUpdates.updates[L]);e.eventUpdates.objectClicked&&this.enqueueEvent("userClickedObject",e),this.onActionUpdatesAppliedSpy&&this.onActionUpdatesAppliedSpy(e.eventUpdates)}}}break;case"add-helper-expression":H_(this.listModel,e.state);break;case"tick":this._tickSliders(e.time);break;case"tick-ticker":this.tickTicker(e.time);break;case"adjust-slider-by-keyboard":{let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;VP(y,e.adjustment)}break;case"adjust-slider-by-dragging-thumb":{let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;IP(y,e.target)}break;case"set-slider-minlatex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;hg(y,e.latex)}break;case"set-slider-maxlatex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;pg(y,e.latex)}break;case"set-slider-steplatex":{this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;ry(y,e.latex)}break;case"set-slider-dragging":{let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;ty(y,e.dragging)}break;case"play-slider-from-min":{let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;let L=Ka(y);if(isNaN(L))return;let P=Ph(y.latex,L);ga(y,!1),Bs(y,P),ga(y,!0)}break;case"set-slider-isplaying":{let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;ga(y,e.isPlaying)}break;case"set-slider-loopmode":{let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;WP(y,e.loopMode)}break;case"set-slider-animationperiod":{let y=this.getItemModel(e.id);if(!y||y.type!=="expression")return;jP(y,e.animationPeriod)}break;case"show-expressions-list":this._showExpressions(e.focusHideIcon);break;case"hide-expressions-list":this._hideExpressions(e.focusShowIcon);break;case"open-drawer":this.enqueueEvent("openDrawer",e);break;case"re-randomize":this.setRandomSeed(ad());break;case"resize-exp-list":this._setExpListWidth(e.expListWidth);break;case"toast/show":this._showToast(e.toast);break;case"toast/close":this.closeToast();break;case"toast/undo":let w=this.toastData.undoCallback;w&&this.runAfterDispatch(w),this.toastData={};break;case"toast/learn-more":let E=this.toastData.learnMoreCallback;E&&this.runAfterDispatch(E),this.toastData={};break;case"start-moving-points":lN(this,this.listModel,e.points);break;case"stop-moving-points":dN(this,e.points);break;case"on-move-points":cN(this,e.points,e.previousScreenPts,e.screenPts,e.projection,e.transform,e.keyboardDirection)&&this.enqueueEvent("userMovedPoint",e);break;case"commit-user-requested-viewport":this._commitUserRequestedViewport(e.viewport);break;case"commit-user-requested-rotation":this.graphSettings.setProperty("worldRotation3D",e.worldRotation3D),this.graphSettings.setProperty("axis3D",e.axis3D),this.graphSettings.setProperty("speed3D",e.speed3D);break;case"toggle-lock-viewport":this.graphSettings.setProperty("userLockedViewport",!this.graphSettings.userLockedViewport);break;case"set-axis-limit-latex":this._setAxisLimitLatex(e.limit,e.latex),this.grapher&&(this.lastDirectlyEditedViewport=this.grapher.getCurrentViewport());break;case"toggle-graph-settings":this.layoutModel=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.layoutModel),{graphSettingsOpen:!this.layoutModel.graphSettingsOpen}),ri(this.listModel,void 0),e.focusOnOpen&&(this.layoutModel.graphSettingsOpen?this.isGeometry()?Pi(this,{type:"settings",location:"reverse-contrast"}):this.getGraphSettings().config.projectorMode?Pi(this,{type:"settings",location:"large-size"}):Pi(this,{type:"settings",location:"default-size"}):Pi(this,{type:"settings",location:"icon"}));break;case"close-graph-settings":this.layoutModel=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.layoutModel),{graphSettingsOpen:!1}),e.focusIconAfterClose&&Pi(this,{type:"settings",location:"icon"});break;case"toggle-add-expression":this.layoutModel=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.layoutModel),{addExpressionOpen:!this.layoutModel.addExpressionOpen}),e.focusOnOpen&&this.layoutModel.addExpressionOpen&&Pi(this,{type:"add-expression-btn"});break;case"close-add-expression":this._closeAddExpression(),e.focusIconAfterClose&&Pi(this,{type:"add-item-btn"});break;case"ui/container-resized":this.layoutMeasurements={width:e.size.width,height:e.size.height},this.shouldScrollSelectedItemIntoViewAfterDispatch=!0;break;case"enter-printmode":this.inPrintMode=!0;break;case"exit-printmode":this.inPrintMode=!1;break;case"expression-size-exceeded":this._showToast({message:this.s("graphing-calculator-text-toast-expression-size-limit")});break;case"keypad/set-layout":this.layoutModel=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.layoutModel),{keypadLayout:e.layout,keypadFunctionsOpen:!1});break;case"keypad/set-minimized":this.layoutModel=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.layoutModel),{keypadMinimized:e.minimized,keypadLayout:"mainNumbers"}),this.shouldScrollSelectedItemIntoViewAfterDispatch=!0,this.needsFakeKeypad()||UN(this);break;case"keypad/type-text":this.layoutModel=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.layoutModel),{keypadFunctionsOpen:!1}),this.runAfterDispatch(()=>{let y=Xe.getFocusedMathquill();y&&Xe.canAcceptText(y,this.getCapExpressionSize(),e.text)&&(y.typedText(e.text),Xe.simulateUserChangedLatex(y))});break;case"keypad/press-key":this.layoutModel=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.layoutModel),{keypadFunctionsOpen:!1}),this.runAfterDispatch(()=>{let y=Xe.getFocusedMathquill();y&&Xe.simulateKeypress(y,e.key)});break;case"keypad/audio-trace":this.handleAudioTraceCommand(e.command);break;case"set-audio-trace-speed":this.setAudioTraceSpeed(e.speed);break;case"keypad/custom-command":this.layoutModel=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.layoutModel),{keypadFunctionsOpen:!1}),this.runAfterDispatch(()=>{let y=Xe.getFocusedMathquill();y&&(pm(y,e.command),Xe.simulateUserChangedLatex(y))});break;case"keypad/shift":this.layoutModel=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.layoutModel),{keypadLayout:$N(this.getKeypadLayout()),keypadFunctionsOpen:!1});break;case"keypad/123":this.layoutModel=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.layoutModel),{keypadLayout:"mainNumbers",keypadFunctionsOpen:!1});break;case"keypad/abc":this.isQwertyKeyboardEnabled()?this.layoutModel=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.layoutModel),{keypadLayout:"letters",keypadFunctionsOpen:!1}):this.layoutModel=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.layoutModel),{keypadLayout:"noQwertyLetters",keypadFunctionsOpen:!1});break;case"keypad/audio":this.layoutModel=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.layoutModel),{keypadMinimized:!1,keypadLayout:"audio",keypadFunctionsOpen:!1});break;case"keypad/functions":this.layoutModel=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.layoutModel),{keypadFunctionsOpen:!this.isKeypadFunctionsPopoverOpen()});break;case"grapher/drag-start":break;case"grapher/drag-move":break;case"grapher/drag-end":break;case"open-on-web":this._openOnWeb();break;case"file-is-dragged-over":this.listModel.openItemMenu=void 0,this.layoutModel=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.layoutModel),{isFileDraggedOver:!0});break;case"file-is-not-dragged-over":this.layoutModel=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.layoutModel),{isFileDraggedOver:!1});break;case"zoom":this.grapher&&this.grapher.viewportController.zoom(e.direction);break;case"set-hovered-image":{let y=this.getItemModel(e.id);if(!y||y.type!=="image")return;pC(y,"hoveredImage",e.url)}break;case"set-depressed-image":{let y=this.getItemModel(e.id);if(!y||y.type!=="image")return;pC(y,"depressedImage",e.url)}break;case"clickable-item-clicked":this.handleClickableItemClicked(e.id,e.listIndex);break;case"action-single-step":{let y=this.getItemModel(e.id);if(!y||y.type!=="expression"||!y.formula.action_value)return;this.evaluator.addActionStepEvent(y.id)}break;case"update-expression-search-str":this.updateExpressionSearchStr(e.str);break;case"update-expression-replace-str":this.updateExpressionReplaceStr(e.str);break;case"rename-identifier-global":this.suggestedIdentifierRename=void 0,Kh(this.listModel,e.search,e.replace);break;case"rename-identifier-in-item":this.suggestedIdentifierRename=void 0;let k=this.getItemModel(e.id);k&&k.type==="folder"?Kh(this.listModel,e.search,e.replace,{limitToFolder:e.id}):Kh(this.listModel,e.search,e.replace,{limitToItem:e.id});break;case"update-ticker-handlerlatex":this.updateTickerHandlerLatex(e.latex);break;case"update-ticker-minsteplatex":this.updateTickerMinStepLatex(e.latex);break;case"set-braille-mode":this.setBrailleMode(e.mode);break;case"set-six-key-input":this.setSixKeyInput(e.useSixKeyInput);break;case"set-show-constructions-open":if(this.showConstructionsOpen=e.open,e.setFocus)if(!e.open)Pi(this,{type:"geo-show-constructions-icon"});else for(let y in this.cachedGeoTokenInfo){let{calcId:L}=this.cachedGeoTokenInfo[y];if(this.getItemModel(L)){Pi(this,{type:"geo-token",identifier:y});break}}break;case"select-geo-tool":this.listModel.openItemMenu=void 0,this.setGeoTool(e.tool),e.clearSelection&&ri(this.listModel,void 0),e.focusGraphPaper&&this.setGraphPaperFocus({isFocused:!0}),this.closeToast();break;case"cancel-geo-toolplay":this.cancelGeoToolplay();break;case"commit-geo-objects":{let y=[],L=[];var a=this.findLastSubscriptForLetters(),l={};let P=J=>{let R=l[J];if(R)return R.assignmentLatex;let q=this.getItemModel(J);if(!q||q.type!=="expression")return J;var _=this._autoNameExpression(q,a);return R=l[J]={model:q,assignmentLatex:_},R.assignmentLatex},K=[];for(let J in e.committed){var c=e.committed[J];__dcg_shared_module_exports__['gc'](c.type)&&K.push(J);var d=RM(c,!0,P);d&&(d.sliderInfo?L.push({latex:d.latex,color:d.color,sliderInfo:d.sliderInfo}):y.push(__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},d),{tokenId:J})))}let $=this.listModel.__toolPreviewIdToModel;if(y.length){let J=this.getGeometryFolder(),R=J?J.index+this.getNumberOfItemsInFolder(J.id)+1:0;y.forEach(q=>{var A;let _;for(let z in $){let Q=$[z];if(((A=hs(Q))==null?void 0:A.latex)===q.tokenId){_=Q;break}}_?(_.latex=q.latex,_.color=q.color,_.showLabel=!!q.showLabel,J&&(_.folderId=J.id)):_=this.createItemModel({id:this.generateId(),type:"expression",showLabel:q.showLabel,latex:q.latex,folderId:J&&J.id,color:q.color}),J?(za(this.listModel,_,R),R+=1):Ql(this.listModel,_),this.getGeoModel().recordCommittedOutput(_.id)})}L.forEach(J=>{let R;for(let q in $){let _=$[q];if(_.latex===J.latex){R=_;break}}R?(R.latex=J.latex,R.color=J.color,hg(R,J.sliderInfo.min),pg(R,J.sliderInfo.max)):R=this.createItemModel({id:this.generateId(),type:"expression",latex:J.latex,color:J.color,slider:{hardMin:!0,hardMax:!0,min:J.sliderInfo.min,max:J.sliderInfo.max}}),za(this.listModel,R,0),this.getGeoModel().recordCommittedOutput(R.id)}),K.length===1&&this.transformAllSelectedItemsByAssignmentLatex(K[0]),this.geoModel.isCurrentToolSingleUse()&&this.setGeoTool("selection");let U=e.toolIdToLatex[1];if(this.geoModel.getToolMode()==="expression-edit"&&U){let J=FM(U,P);this.writeIdentifierIntoCurrentMathquill(J)}this.isGeometry()&&this.getGeoModel().updateFadeAnimations()}break;case"rename-identifier":{let y=e.from,L=e.to,P=__dcg_shared_module_exports__['Jb'](y),K=this.getGeometryFolder();K&&this.getItemsByIdentifier(P).forEach($=>{e.geoFolder&&$.folderId!==K.id?(No($,K.id),Uh(this.listModel,$.index,K.index+1,1)):!e.geoFolder&&$.folderId===K.id&&(Uh(this.listModel,$.index,K.index+this.getNumberOfItemsInFolder(K.id),1),No($,""))}),Kh(this.listModel,y,L)}break;case"set-active-token":this.activeTokens[e.style]=e.identifier;break;case"unset-active-token":this.activeTokens[e.style]===e.identifier&&(this.activeTokens[e.style]=void 0);break;case"select-expression-that-defines-token":{let y=this.getExpressionIdForIdentifier(e.identifier);if(!y)return;this.setGeoTool("selection"),e.multiSelectMode||e.toggle?CI(this.listModel,y):this.tryInsertTokenIntoMathquill(y,void 0)||ri(this.listModel,this.getItemModel(y))}break;case"close-expression-search":this.expressionSearchOpen=!1,this.updateExpressionSearchStr("");let S=this.getItemModelByIndex(0);S&&Xn(this,S.id,"end");break;case"open-expression-search":this.expressionSearchOpen=!0,this.focusLocation={type:"search-expressions"};let T=e.latex;e.rename&&!ha(T)&&(T="");let V=e.rename?T?`\\operatorname{rename}\\ ${T}\\to`:"\\operatorname{rename}\\ ":T;this.updateExpressionSearchStr(V);break;case"open-ticker":this.listModel.ticker.open=!0,this.focusLocation={type:"ticker",location:"handler"},this._closeAddExpression();break;case"close-ticker":this.listModel.ticker.open=!1,this.listModel.ticker.playing=!1,this.listModel.ticker.minStepLatex="",this.listModel.ticker.handlerLatex="";break;case"toggle-ticker":this.listModel.ticker.playing=!this.listModel.ticker.playing,this.listModel.ticker.lastTickTime=void 0,this.pauseAllSliders();break;case"set-tool-preview-state":this.setToolPreviewState(e.state);break;case"apply-transformation-to-selected":this.transformAllSelectedItemsByAssignmentLatex(e.assignmentLatex),this.closeItemSettingsMenu();break;default:return e}}switchAxisScale(e,r){var n;if(!r||r===this.graphSettings[e])return;this.graphSettings.setProperty("polarMode",!1);let i;this.getAllItemModels().forEach(o=>{if(this.isExpressionZoomFit(o)){if(!this.getBoundingBoxesForZoomFit(o))return;i=o.id}}),this.graphSettings.setProperty(e,r),(n=this.grapher)==null||n.getProjection().updateScalePairs(),!(i&&this._expressionZoomFit(i,!1,!0))&&this.enforceAxisLimitsForScale(e)}enforceAxisLimitsForScale(e){if(!this.grapher)return;let r=this.grapher.getDefaultViewport();if(!r)return;e==="xAxisScale"?(this._setAxisLimitLatex("xmin",__dcg_shared_module_exports__['Gb'](r.xmin)),this._setAxisLimitLatex("xmax",__dcg_shared_module_exports__['Gb'](r.xmax))):(this._setAxisLimitLatex("ymin",__dcg_shared_module_exports__['Gb'](r.ymin)),this._setAxisLimitLatex("ymax",__dcg_shared_module_exports__['Gb'](r.ymax))),this.graphSettings.xAxisScale===this.graphSettings.yAxisScale&&(this.graphSettings.setProperty("lastChangedAxis",e==="xAxisScale"?"y":"x"),this.grapher.viewportController.zoomSquareImmediately(),this.markSquareAxesAfterUserEditedViewport());let i=this.grapher.viewportController.getViewport(),n=this.grapher.getProjection(),{xmin:o,xmax:s,ymin:a,ymax:l}=i,c=this.getGraphSettings().config.logScales;if(e==="xAxisScale"&&c){let d=n.mapx(o),u=n.mapx(s),p=fi(n.reverse_mapx(d-.25),n.reverse_mapx(d+.25)),g=fi(n.reverse_mapx(u-.25),n.reverse_mapx(u+.25));this._setAxisLimitLatex("xmin",__dcg_shared_module_exports__['Gb'](p)),this._setAxisLimitLatex("xmax",__dcg_shared_module_exports__['Gb'](g))}if(e==="yAxisScale"&&c){let d=n.mapy(a),u=n.mapy(l),p=fi(n.reverse_mapy(d-.25),n.reverse_mapy(d+.25)),g=fi(n.reverse_mapy(u-.25),n.reverse_mapy(u+.25));this._setAxisLimitLatex("ymin",__dcg_shared_module_exports__['Gb'](p)),this._setAxisLimitLatex("ymax",__dcg_shared_module_exports__['Gb'](g))}this.lastDirectlyEditedViewport=this.grapher.getCurrentViewport()}updateGraphSettingsViewportLimitsLatex(e){this._setAxisLimitLatex("xmin",e.xmin+""),this._setAxisLimitLatex("xmax",e.xmax+""),this._setAxisLimitLatex("ymin",e.ymin+""),this._setAxisLimitLatex("ymax",e.ymax+""),this._setAxisLimitLatex("zmin",e.zmin+""),this._setAxisLimitLatex("zmax",e.zmax+"")}transformAllSelectedItemsByAssignmentLatex(e){var u;let r=xC(this.listModel),i=this.findLastTokenNumber()+1,n=this.findLastSubscriptForLetters(),o=this.getGeometryFolder(),s=o?o.index+this.getNumberOfItemsInFolder(o.id)+1:0,a={};for(let p of r){if(p.type!=="expression")continue;var l=p.formula.geometry;if(!l)continue;var c=(u=p.formula.typed_constant_value)==null?void 0:u.valueType;if(!c||__dcg_shared_module_exports__['yb'](c,__dcg_shared_module_exports__['pb']))continue;var d=l.identifier;let g;d?g=__dcg_shared_module_exports__['Hb'](d):g=this._autoNameExpression(p,n);let b=`\\token{${i}}`;i+=1;let x=`${b}=${e}\\left(${g}\\right)`,w=this.createItemModel({id:this.generateId(),type:"expression",showLabel:p.showLabel&&!p.label,latex:x,folderId:o&&o.id,color:p.color});a[w.id]=!0,o?(za(this.listModel,w,s),s+=1):Ql(this.listModel,w)}Object.keys(a).length&&DI(this.listModel,a)}convertToTokenAssignment(e,r=""){var o;let i=(o=hs(e))==null?void 0:o.latex,n=r?Qf(r)||"":"\\token{"+(this.findLastTokenNumber()+1)+"}";i?Kh(this.listModel,i,n):Bs(e,n+"="+e.latex)}convertToNamedAssignment(e,r=""){let i=WV(e);if(!i)return;let n=r?Qf(r):this.getAutonameLatexForExpression(e);n?Kh(this.listModel,i,n):Bs(e,r)}getAutonameLatexForExpression(e,r){r||(r=this.findLastSubscriptForLetters());var i=_v(e)[0].toUpperCase(),n=(r[i]||0)+1;return r[i]=n,i+"_{"+n+"}"}_autoNameExpression(e,r){let i=this.getAutonameLatexForExpression(e,r);return Bs(e,i+"="+e.latex),i}setGeoTool(e){if(!this.geoUIActive||this.activeTool===e)return;this.geoTools.forEach(i=>{i.dropdown&&i.dropdown.indexOf(e)!==-1?i.key=e:i.dropdown&&i.resetOnChange&&i.resetOnChange.indexOf(i.key)!==-1&&(i.key=i.dropdown[0])}),this.activeTool=e,this.getGeoModel().setToolMode(e),this.cancelGeoToolplay()}cancelGeoToolplay(){var r,i;let e=this.getGeoModel();e.cancelToolplay(),e.deselectAllObjects(),this.setToolPreviewState({}),(i=(r=this.grapher)==null?void 0:r.poiController)==null||i.cancelGeoToolplay()}setToolPreviewState(e){var i;this.toolPreviewJSONState=e;var r=this.listModel.__toolPreviewIdToModel;this.listModel.__toolPreviewIdToModel={};for(let n in e){let o=e[n],s=RM(o,!1);if(!s)continue;let a;for(let l in r){let c=r[o.type==="expression-edit-preview-latex"?kg:l];if(((i=hs(c))==null?void 0:i.latex)===n){a=c;break}}a?(a.latex=s.latex,a.color=s.color,a.showLabel=!!s.showLabel):a=Pv({id:o.type==="expression-edit-preview-latex"?kg:this.generateId(),type:"expression",color:s.color,latex:s.latex,showLabel:!!s.showLabel},this),this.listModel.__toolPreviewIdToModel[a.id]=a}}isGeoItem(e){let r=this.getItemModel(e);return r&&r.type==="expression"&&r.formula&&r.formula.geometry&&!r.formula.error}getSelectedGeoExpression(){var e=this.getSelectedItem();if(e&&this.isGeoItem(e.id)&&e.type==="expression")return e}getGeometryFolder(){let e=this.getItemModel(__dcg_shared_module_exports__['Oc']);return e&&e.type==="folder"?e:void 0}isItemInGeoFolder(e){var r=this.getItemModel(e);return!r||r.type==="folder"?!1:r.folderId===__dcg_shared_module_exports__['Oc']}isGeoFolder(e){return e.id===__dcg_shared_module_exports__['Oc']}pauseAllSliders(){this.getPlayingSliders().forEach(e=>{ga(e,!1)})}countGlobalIdentifierOccurences(e){return B_(this.listModel,e)}handleClickableItemClicked(e,r){var n;let i=this.getItemModel(e);i&&(i.type!=="expression"&&i.type!=="image"||((n=i.formula.click_handler)==null?void 0:n.status)==="maybe-valid"&&this.evaluator.addClickEvent(i.id,r))}canAddTicker(){return!this.getTickerOpen()}countIdentifierAssignments(e){return Ag(this.listModel,e).length}doesIdentifierBlockActionUpdate(e){var r=this.getFocusLocation(),i=Ag(this.listModel,e);for(let n of i)if((r==null?void 0:r.type)==="expression"&&r.id===n.id||zP(n))return!0;return!1}getItemsByIdentifier(e){return Ag(this.listModel,e)}isAtLeastOnePointSelected(){let e=this.getAllSelectedItems();for(var r=0;r<e.length;r++){let i=e[r];if(i.type==="expression"&&gl(i))return!0}return!1}toggleLabelForAllSelectedObjects(){let e=[],r=[];this.getAllSelectedItems().forEach(n=>{n.type==="expression"&&gl(n)&&(n.showLabel?r.push(n):e.push(n))});let i=/^([A-Z])([0-9]*)$/;if(e.length){let n=0;this.getAllItemModels().forEach(o=>{if(o.type!=="expression"||!o.showLabel||!o.label)return;let s=o.label.match(i);if(!s)return;let a=s[1].charCodeAt(0)-65;s[2]&&(a+=parseInt(s[2])*26),a>=n&&(n=a+1)}),e.forEach(o=>{if(!o.label){let s=n;n++;let a=String.fromCharCode(s%26+65),l=Math.floor(s/26),c=l>0?l+"":"";Pd(o,a+c)}Kp(o,!0)})}else r.length&&r.forEach(n=>{i.test(n.label)&&Pd(n,""),Kp(n,!1)})}updateLatexForIdentifier(e,r){var i=Ag(this.listModel,e);if(i.length===1){var n=i[0];n.slider.isPlaying?(ga(n,!1),Bs(n,r),ga(n,!0)):Bs(n,r)}}updateExpressionSearchStr(e){this.rawExpressionSearchStr=e;let r="\\operatorname{rename}";if(e.indexOf(r)===0){let n=e.slice(r.length).replace(/\\ /g,"").split(/\\to(?![a-zA-Z])/);n.length===2?(this.expressionSearchStr=n[0],this.isExpressionSearchStrValidForReplace=ha(this.expressionSearchStr),this.updateExpressionReplaceStr(n[1])):(this.expressionSearchStr=n[0],this.isExpressionSearchStrValidForReplace=!1,this.updateExpressionReplaceStr(""));let o=R_(this.listModel,this.getExpressionSearchStr());this.expressionSearchCount=this.expressionSearchOpen?o:0}else this.expressionSearchStr=e.length>1&&"rename".indexOf(e)===0?"":e,this.isExpressionSearchStrValidForReplace=!1,this.updateExpressionReplaceStr(""),this.filterItemsBySearch()}filterItemsBySearch(){if(!this.getExpressionReplaceStr()){let e=N_(this.listModel,this.getExpressionSearchStr());this.expressionSearchCount=this.expressionSearchOpen?e:0}}updateExpressionReplaceStr(e){this.expressionReplaceStr=e,this.isExpressionReplaceStrValidForReplace=ha(e)}getIsExpressionSearchStrValidForReplace(){return this.isExpressionSearchStrValidForReplace}getIsExpressionReplaceStrValidForReplace(){return this.isExpressionReplaceStrValidForReplace}isSearchReplaceValid(){return this.getIsExpressionSearchStrValidForReplace()&&this.getIsExpressionReplaceStrValidForReplace()}shouldShowReplaceIcon(){return this.isSearchReplaceValid()}updateTickerHandlerLatex(e){this.listModel.ticker.handlerLatex=e}updateTickerMinStepLatex(e){this.listModel.ticker.minStepLatex=e}getRawExpressionSearchStr(){return this.rawExpressionSearchStr||""}getExpressionSearchStr(){return this.expressionSearchStr||""}getExpressionReplaceStr(){return this.expressionReplaceStr||""}getExpressionSearchCount(){return this.expressionSearchCount||0}getTicker(){return this.listModel.ticker}getTickerHandlerLatex(){return this.listModel.ticker.handlerLatex||""}getTickerMinStepLatex(){return this.listModel.ticker.minStepLatex||""}getTickerAvgDelta(){return this.listModel.ticker.avgDelta}getBrailleMode(){return this.graphSettings.config.brailleMode}setBrailleMode(e){this.graphSettings.config.setProperty("brailleMode",e)}getSixKeyInput(){return this.graphSettings.config.sixKeyInput}setSixKeyInput(e){this.graphSettings.config.setProperty("sixKeyInput",e)}getBrailleControls(){return this.graphSettings.config.brailleControls}setBrailleControls(e){this.graphSettings.config.setProperty("brailleControls",e)}getAudio(){return this.graphSettings.config.audio}setAudio(e){this.graphSettings.config.setProperty("audio",e)}setEditListMode(e){this.layoutModel=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.layoutModel),{inEditListMode:e})}generateTableXSubscript(){return bC(this.listModel)}findLastTokenNumber(){return K_(this.listModel)}findLastSubscriptForLetters(){return U_(this.listModel)}_createTableItem(){let e=this.generateTableXSubscript(),r=VI(e,[[],[]],this);return this.createItemModel(r)}_populateSettingsViewLimitLatex(){if(!this.grapher)return;let e=this.grapher.getCurrentViewport();this.isGraphSettingsOpen()&&__dcg_shared_module_exports__['F'](e,this.lastDirectlyEditedViewport)||(this.settingsViewModel=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.settingsViewModel),{limitLatex:YN(e,{steps:this.getAxisStepSettings(),scales:this.getAxisScaleSettings()})}))}getAxisStepSettings(){return{xAxisStep:this.graphSettings.xAxisStep,yAxisStep:this.graphSettings.yAxisStep}}getAxisScaleSettings(){return{xAxisScale:this.graphSettings.xAxisScale,yAxisScale:this.graphSettings.yAxisScale}}getDefaultAxisScaleSettings(){var r,i;let{defaultState:e}=this.graphSettings;return{xAxisScale:((r=e==null?void 0:e.graph)==null?void 0:r.xAxisScale)||"linear",yAxisScale:((i=e==null?void 0:e.graph)==null?void 0:i.yAxisScale)||"linear"}}getSettingsViewModel(){return this.settingsViewModel}getListModel(){return this.listModel}hasBackgroundColor(){return this.getBackgroundColor()!=="#ffffff"}getBackgroundColor(){return this.getGraphSettings().getBackgroundColor()}getTextColor(){return this.getGraphSettings().getTextColor()}getPillboxBackgroundColor(){return __dcg_shared_module_exports__['R'](this.getBackgroundColor(),-.07)}subToChanges(e){let r=this.nextSubscription;return this.nextSubscription+=1,this.subscriptions[r]=e,()=>{delete this.subscriptions[r]}}updateTheComputedWorld(){var x;Wp(this.listModel);let r=this.getSelectedItem()&&this.activeTool==="expression-edit"&&this.listModel.__toolPreviewIdToModel[kg]&&((x=this.grapher)!=null&&x.graphSketches[kg])?"preview":"actual";q_(this.listModel,r),this.grapher&&(this.grapher.setSketchOrder(this.listModel.drawOrder),this.isThreeDMode()&&this.grapher2d&&this.grapher2d.setSketchOrder(this.listModel.drawOrder));var i={};let n=w=>{var k;let E=(k=hs(w))==null?void 0:k.identifier;E&&(E[0]==="$"||w.formula.geometry)&&E&&(i[E]?i[E].multiple=!0:i[E]={model:w,multiple:!1})};for(let w of this.getAllToolPreviewItems())jV(w),n(w);for(let w of this.getAllItemModels())switch(w.type){case"expression":jV(w),n(w);break;case"image":l_(w);break;case"table":CF(w);break;case"folder":_O(w);break;case"text":$O(w);break;default:return w}this.geoUIActive=this.isGeometry()&&!this.getGraphSettings().config.hideGeoUI;var o=this.cachedGeoTokenGroups={};this.cachedGeoTokenInfo={};for(let w in i){var{multiple:s,model:a}=i[w],l="blue";let E="unknown",k="unknown",S=!1,T=!1,V=!1,O=!1;var c=void 0;if(!s&&a?(l=Zl(a),a.hidden&&(O=!0),c=a.geoOverrideHidden,S=UP(a),k=HP(a),E=_v(a),a.error&&(T=!0,l="#")):(l="#fa824c",E="error",T=!0),E&&a){var d=o[E];d||(d=o[E]=[]),d.push({color:l,id:a.id,identifier:w,groupType:E}),this.isItemSelected(a.id)&&(V=!0)}else T=!0;let y=this.getGeoDescription(a,{includeDetails:!1}),L=(a==null?void 0:a.label)||"";this.cachedGeoTokenInfo[w]={groupType:E,iconType:k,isList:S,hasError:T,color:l,isSelected:V,isHidden:O,description:y,label:L,overrideHidden:c,calcId:a&&a.id||""}}this.cachedGeoTokenDepths={};let{createdDepth:u,firstReferencedDepth:p}=this.geoModel.getComputedBoard().getDepthValues();for(let w in this.cachedGeoTokenInfo){let{calcId:E}=this.cachedGeoTokenInfo[w],k=this.getItemModel(E);if(!k)continue;let S=w;if(!(w in u)&&k.type==="expression"&&(E===this.getDraggedItemId()||k===this.getFocusedItem())){let P=k.formula.assignment;P&&P in u&&(S=P)}let T=u[S]||0,V=p[S];V=isFinite(V)?V:0;let O=Math.max(T,V-1)+"",y=this.cachedGeoTokenDepths[O];y||(y=[],this.cachedGeoTokenDepths[O]=y);let L=this.cachedGeoTokenInfo[w];y.push({color:L.color,groupType:L.groupType,identifier:w,calcId:E})}if(S_(this.listModel.ticker),this.isCurrentFocusLocationValid()||Pi(this,void 0),this.listModel.openItemMenu){let w=this.getOpenMenuIcon();document.body&&w&&document.body.contains(w[0])||(this.listModel.openItemMenu=void 0)}let g=this.getSelectedItem();g&&!this.getItemModel(g.id)&&ri(this.listModel,void 0),this._populateSettingsViewLimitLatex(),this.propagateSelection(),this.propagateActiveTokens(),this.isKeypadOpen()||(this.layoutModel=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.layoutModel),{keypadFunctionsOpen:!1})),this.updateSuggestedIdentifierRenameInfo(),this.isGeometry()&&g&&g.type==="expression"?g.formula.cursor_context?(this.setGeoTool("expression-edit"),this.geoModel.updateFadeAnimations()):this.geoModel.getToolMode()==="expression-edit"&&this.setGeoTool("selection"):this.geoModel.getToolMode()==="expression-edit"&&this.setGeoTool("selection");let b=this.getValidCursorContext();this.isGeometry()&&this.getGeoModel().getToolMode()==="expression-edit"&&!__dcg_shared_module_exports__['F'](b,this.lastCursorContext)&&this.runAfterDispatch(()=>{var w,E;(E=(w=this.grapher)==null?void 0:w.poiController)==null||E.replayGeoTapMove()}),this.lastCursorContext=b,this.runAfterDispatch(()=>{this.grapher&&this.grapher.type==="2d"&&this.grapher.audioGraph.checkIfSelectedItemChanged(g?g.id:void 0),this.grapher&&this.grapher.type==="2d"&&this.focusLocation&&this.focusLocation.type!=="graph-paper"&&this.grapher.audioGraph.exitAudioTrace()})}getOpenMenuIcon(){let e=this.getOpenItemMenu();if(!e)return;let r=e.guid,i=this.find$(`[dcg-open-menu-guid="${r}"]`);if(i.length!==0)return i}propagateSelection(){this.grapher?this.__lastSelectedIdsForPropagation=BF(this,this.grapher,this.__lastSelectedIdsForPropagation):this.__lastSelectedIdsForPropagation={}}propagateActiveTokens(){!this.grapher||!(this.grapher instanceof od)||(this.grapher.setActiveToken(this.getExpressionIdForIdentifier(this.activeTokens.selected),"selected"),this.grapher.setActiveToken(this.getExpressionIdForIdentifier(this.activeTokens.hovered),"hovered"))}getHoveredTokenIdentifier(){return this.activeTokens.hovered}doesLatexContainToken(e){return qP(e)}getToolPreviewJSONState(){return this.toolPreviewJSONState}garbageCollectGeo(e,r){if(!this.isGeometry())return;let i=oB(this,e,r);i.length&&xI(this.listModel,i)}ensureAtLeastOneVisibleItem(){if($_(this.listModel)){let e=this.createItemModel({type:"expression",id:this.generateId(),color:this.getNextColor()});Ql(this.listModel,e)}}getExpressionIdForIdentifier(e){if(e){var r=this.getItemsByIdentifier(e);if(r.length===1)return r[0].id}}getValidCursorContext(){var n;let e=this.getSelectedItem();if(!e||e.type!=="expression")return;let r=e.formula.cursor_context,i=(n=Xe.getFocusedMathquill())==null?void 0:n.selection();if((e==null?void 0:e.type)==="expression"&&e.latex===(r==null?void 0:r.selection.input)&&(i==null?void 0:i.startIndex)===(r==null?void 0:r.selection.start)&&(i==null?void 0:i.endIndex)===(r==null?void 0:r.selection.end)&&(i==null?void 0:i.latex)===(r==null?void 0:r.selection.input))return r}tryInsertTokenIntoMathquill(e,r){if(!this.isGeometry()||!e)return!1;var i=this.getItemModel(e);if(!i||i.type!=="expression")return!1;let n=i.formula.typed_constant_value;r===0&&(!n||!__dcg_shared_module_exports__['ub'](n.valueType))&&(r=void 0);var o,s,a=so(i);if(a?s=__dcg_shared_module_exports__['Hb'](a):i.formula.geometry&&(s=this.getAutonameLatexForExpression(i),o=s),!s)return!1;r!==void 0&&(s+="\\left["+(r+1)+"\\right]");var l=this.getFocusLocation();if(!l||!this.seemsLikeInsertingTokenWillImproveThings(n==null?void 0:n.valueType))return!1;var c=l.type==="expression";return c?(o&&(i.reconciledDragMode==="NONE"&&i.dragMode==="AUTO"&&Up(i,"NONE"),Bs(i,o+"="+i.latex)),this.writeIdentifierIntoCurrentMathquill(s),!0):!1}seemsLikeInsertingTokenWillImproveThings(e){let r=this.getValidCursorContext();if(r){if(!e)return!1;let i=__dcg_shared_module_exports__['ub'](e)?__dcg_shared_module_exports__['vb'](e):e;return(r.type==="expression-arguments"?r.allowedTypesForInsertedArg:r.allowedTypes).some(o=>__dcg_shared_module_exports__['xb'](i,o))}return!1}writeIdentifierIntoCurrentMathquill(e){this.runAfterDispatch(()=>{let r=this.getValidCursorContext(),i=Xe.getFocusedMathquill();if(!i)return;let n="",o="";(r==null?void 0:r.type)==="expression-arguments"&&((r==null?void 0:r.positionWithinArg)==="end"?n=",":(r==null?void 0:r.positionWithinArg)==="start"&&(o=","));let s=`${n}${e}${o}`,a=!1;if((r==null?void 0:r.type)==="expression-arguments"&&r.polygonVertices){let{argIndex:l,polygonVertices:c,positionWithinArg:d}=r;(e===c.firstLatex||e===c.lastLatex)&&(d==="end"||d==="start-to-end")&&l===c.vertexCount-1&&(s="",a=!0)}else(r==null?void 0:r.type)==="expression-arguments"&&(a=r.isLastValidArg);Xe.canAcceptText(i,this.getCapExpressionSize(),s)&&(i.write(s),Xe.simulateUserChangedLatex(i),a&&i.keystroke("Right"))})}getSelectedExpressionIds(){return j_(this.listModel)}getPropagatedSelectedIds(){return this.__lastSelectedIdsForPropagation}areParsableObjectsEqual(e,r){return e===r?!0:__dcg_shared_module_exports__['F'](__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},e),{regressionParameters:void 0}),__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},r),{regressionParameters:void 0}))}requestParseForAllItems(){var n,o,s;(this.isCurrentlyDoingSetState||this.isCurrentlyDoingRestoreState)&&(this.lastParsableObjects={},this.evaluator.clearStatementsAndStartCompleteState(),this.isCurrentlyDoingRestoreState&&this.evaluator.markUndoRedoState());var e={},r=this.lastParsableObjects;for(let a of this.getAllItemModels())switch(a.type){case"expression":case"image":case"table":e[a.guid]=a.cachedParsableState;break;case"folder":case"text":break;default:return a}for(let a of __(this.listModel))e[a.guid]=a.cachedParsableState;for(let a of Mg(this.listModel)){let l=this.getSelectedItem(),c=!0;if(this.activeTool==="expression-edit"&&(l==null?void 0:l.type)==="expression"&&((o=(n=l.formula.geometry)==null?void 0:n.call)==null?void 0:o.symbol)==="polygon"&&((s=l.formula.cursor_context)==null?void 0:s.type)==="expression-arguments"){let{positionWithinArg:d,argIndex:u}=l.formula.cursor_context;c=(d==="end"||d==="start-to-end")&&u===l.formula.geometry.call.parents.length-1}e[a.guid]=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},a.cachedParsableState),{shouldOmitLastPolygonSegment:c})}let i=this.getFocusedItem();if((i==null?void 0:i.type)==="expression"){let a=Xe.getFocusedMathquill(),l=a==null?void 0:a.selection();(l==null?void 0:l.latex)===i.latex&&(e[i.guid]=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},i.cachedParsableState),{latexSelection:{start:l.startIndex,end:l.endIndex}}))}this.listModel.ticker.cachedParsableState&&(e[this.listModel.ticker.guid]=this.listModel.ticker.cachedParsableState);for(let a in r){let l=r[a],c=e[a];if(l.type==="image"&&(!c||c.type!==l.type||c.guid!==l.guid)&&this.grapher2d&&this.grapher2d.removeGraphImage(l.id),!c&&(this.evaluator.removeStatement(l.id),l.type==="table"))for(let d of l.columns)this.evaluator.removeStatement(d.id)}for(let a in e){let l=e[a],c=r[a];if(l.type==="image"&&(!c||l.type!==c.type||l.guid!==c.guid)&&this.grapher2d){let d=this.getItemModel(l.id);d&&d.type==="image"&&this.grapher2d.addGraphImage(d)}this.areParsableObjectsEqual(l,c)||(this.grapher2d&&l.type==="statement"&&l.latex===""&&this.grapher2d.removeGraphSketch(l.id),this.evaluator.addStatement(l))}this.lastParsableObjects=e}getViewState(){if(this.grapher){let e=this.grapher.getProjection();return{viewport:e.viewport.toObject(),screen:e.screen,xAxisScale:e.settings.xAxisScale,yAxisScale:e.settings.yAxisScale,degreeMode:e.settings.degreeMode}}else return}getTokenRenderInfoByIdentifier(e){let r=this.cachedGeoTokenInfo[e];return r||(r={iconType:"unknown",isList:!1,hasError:!0,color:"#fa824c",isSelected:!1,groupType:"unknown",isHidden:!1,overrideHidden:void 0,description:"",label:"",calcId:""}),r}setEvaluator(e){this.evaluator=e}getEvaluator(){return this.evaluator}setGrapher2d(e){this.grapher2d=e}setGrapher3d(e){this.grapher3d=e}setGrapher(e){this.grapher=e}getGrapher(){return this.grapher}getBoundingBoxesForZoomFit(e){if(this.grapher&&this.isZoomFitEnabled()&&!(e.type!=="expression"&&e.type!=="table")&&!(e.type==="expression"&&(e.error||!e.shouldGraph||!e.formula.is_graphable)))return e.boundingBoxes}isExpressionZoomFit(e){let r=this.getBoundingBoxesForZoomFit(e);return!this.grapher||!r||!("getProjection"in this.grapher.viewportController)?!1:!aT(r,this.grapher.viewportController.getProjection())&&!!Fb(r,this.grapher.viewportController.getProjection())}showExpressionZoomFitButton(e){if(this.isGeometry()||this.is3D())return!1;let r=this.getBoundingBoxesForZoomFit(e);return!!this.grapher&&!!r&&"getProjection"in this.grapher.viewportController&&aT(r,this.grapher.viewportController.getProjection())}setBugsnagContext(e){this.bugsnagContext=e}getItemRootNodeById(e){let r=this.getItemModel(e);if(r&&r.dcgView)return r.dcgView.findRootNode()}getItemSelectorById(e){let r=this.getItemRootNodeById(e);return r?I(r):void 0}generateId(){var e=this.__nextItemId;return this.__nextItemId+=1,e+""}getNextColor(){return T_(this.listModel)}getNextDisplayIndex(){return this.listModel.nextDisplayIndex}_clearPendingImageUploads(){this.__pendingImageUploads={}}isUploadingImages(){return Object.keys(this.__pendingImageUploads).length>0}getExpressionAnalysis(){return this.listModel.expressionAnalysis}createItemModel(e){return Eg(this.listModel,e)}getItemModel(e,r){return Xl(this.listModel,e,r)}getColorById(e){let r=this.getItemModel(e);return!r||r.type!=="expression"?"":KV(r)}getAllColorAssignments(){let e=[];for(let r of this.getAllItemModels()){if(r.type!=="expression")continue;let i=so(r);if(!i)continue;let n=this.getEvaluationValueForItem(r.id);(typeof n=="string"||Array.isArray(n)&&typeof n[0]=="string")&&e.push({id:r.id,assignmentLatex:__dcg_shared_module_exports__['Hb'](i)})}return e}getAllColorFunctionAssignments(){let e=[];if(!mi("beta3d"))return e;for(let r of this.getAllItemModels()){if(r.type!=="expression")continue;let i=so(r),n=$V(r);!i||!n||e.push({id:"shader",assignmentLatex:"shader:"+__dcg_shared_module_exports__['Hb'](i)})}return e}getShader(e){for(let r of this.getAllItemModels()){if(r.type!=="expression")continue;let i=so(r);if(i&&__dcg_shared_module_exports__['Hb'](i)===e){let n=$V(r);if(n)return n}}return{source:"",shaderFunctions:""}}getAllImages(){let e=[];for(let r of this.getAllItemModels())r.type==="image"&&e.push({id:r.id,url:r.image_url,name:r.name});return e}getItemModelByIndex(e){return Gg(this.listModel,e)}getItemCount(){return ky(this.listModel)}getItemEditableLabelMode(e){let r=this.getItemModel(e);if(!(!r||r.type!=="expression"))return iO(r)}isItemSecret(e){let r=this.getItemModel(e);return r?Ey(r):!1}isItemReadonly(e){let r=this.getItemModel(e);return r?fI(r):!1}isItemSelected(e){let r=this.getItemModel(e);return!!r&&Ha(r)}hasAnyItemsSelected(){return this.getAllSelectedItems().length>0}hasMultipleItemsSelected(){return this.getAllSelectedItems().length>1}isItemSelectable(e){let r=this.getItemModel(e);return r?Ig(r):!1}anyItemDependsOnRandomSeed(){return rF(this.listModel)}areActionsEnabled(){return this.graphSettings.config.actions==="auto"?iF(this.listModel):!!this.graphSettings.config.actions}getAllItemModels(){return bI(this.listModel)}getAllToolPreviewItems(){return Mg(this.listModel)}getAllModelsWithSliders(){return W_(this.listModel)}getGraphSettings(){return this.graphSettings}getAudioGraph(){return this.grapher!==void 0&&this.grapher.type==="2d"?this.grapher.audioGraph:void 0}inAudioTraceMode(){let e=this.getAudioGraph();return!!(e&&e.audioTraceActive)}canAudioTrace(){let e=this.getAudioGraph();return e?e.canAudioTraceCurrentExp():!1}isAudioTracing(){let e=this.getAudioGraph();return e?e.tonegen.isAnimating():!1}expressionsAreFullWidth(){return this.isNarrow()||this.graphSettings.config.graphpaper===!1}getExpListWidthString(){return this.expressionsAreFullWidth()?"100%":this.rootElt?this._getExpListWidth()+"px":"0"}getExpListWidth(){return this.rootElt?this._getExpListWidth():0}findFirstVisibleItem(){let e=ZN(this,this._previousFirstVisibleId);if(this._previousFirstVisibleId=e,e)return this.getItemModel(e)}findLastVisibleItem(){let e=eB(this,this._previousLastVisibleId);if(this._previousLastVisibleId=e,e)return this.getItemModel(e)}updateRenderShellsAfterDispatch(){if(!this.rootElt||!this.isListVisible())return;let e=this.findFirstVisibleItem(),r=this.findLastVisibleItem();var i=e&&this.getItemRootNodeById(e.id),n=r&&this.getItemRootNodeById(r.id);if(i===this.lastInfiniteScrollFirstDOM&&n===this.lastInfiniteScrollLastDOM&&!this.hasDispatchSinceLastInfiniteScrollUpdate)return;this.lastInfiniteScrollFirstDOM=i,this.lastInfiniteScrollLastDOM=n,this.hasDispatchSinceLastInfiniteScrollUpdate=!1;let o=!1,s=e?e.index:1/0,a=r?r.index:1/0,l=this.listModel.dragState&&this.listModel.dragState.firstItemId,c,d=this.getOpenItemMenu();d&&d.type!=="multi-select-more"&&d.type!=="multi-select-transformations"&&d.type!=="geo-tool-dropdown"&&(c=d.model.id);for(let p of this.getAllItemModels()){var u=(p.index<s||p.index>a||p.isHiddenFromUI)&&!(p.type==="expression"&&p.sliderDragging);if(l==p.id&&(u=!1),c===p.id&&(u=!1),p.renderShell!==u&&(p.renderShell=u,o=!0,u)){let g=this.getItemRootNodeById(p.id);if(g){let b=g.getBoundingClientRect().height;b>0&&(p.cachedRenderHeight=b)}}}o&&this.markTickRequiredNextFrame()}updateRenderShellsBeforePaint(){if(this.hasDispatchSinceLastInfiniteScrollUpdate=!0,this.inPrintMode){for(let r of this.getAllItemModels())r.renderShell=!1;return}for(let r of this.getAllItemModels())r.isHiddenFromUI&&(r.renderShell=!0),r.type==="expression"&&r.sliderDragging&&(r.renderShell=!1);let e=this.getSelectedItem();e&&!this.isGeoItem(e.id)&&(e.renderShell=!1)}updateDragDrop(){let e=this.listModel.dragState;if(!e)return;let r=this.getItemModel(e.firstItemId);if(!r)return;let i=this.dragdrop_expressions.applyDrag();i&&(Gy(this.listModel,i.dragState),No(r,i.folderId),r.index!==i.newIndex&&Uh(this.listModel,r.index,i.newIndex,e.numberOfItems))}_tickSliders(e){this.getPlayingSliders().forEach(function(r){MP(r,e)})}tickTicker(e){let r=this.listModel.ticker.lastTickTime===void 0;this.evaluator.addClockTickEvent(this.listModel.ticker.id,r),k_(this.listModel.ticker,e)}stopAllSliders(){for(let e of this.getAllItemModels())e.type==="expression"&&e.slider.isPlaying&&ga(e,!1)}getPlayingSliders(){var e=this.getAllItemModels(),r=[];for(let i of e)i.type==="expression"&&i.sliderExists&&i.slider.isPlaying&&r.push(i);return r}areAnyImagesLoading(){return M_(this.listModel)}_commitUserRequestedViewport(e){this.grapher&&this.grapher.setUserRequestedViewport(e)}_setAxisLimitLatex(e,r){this.settingsViewModel=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.settingsViewModel),{limitLatex:__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.settingsViewModel.limitLatex),{[e]:r})});let n=r===""&&(e==="xstep"||e==="ystep")?0:yn(r,this.graphSettings.degreeMode);switch(e){case"xstep":{if(!sg(n))return;this.graphSettings.setProperty("xAxisStep",n)}break;case"ystep":{if(!sg(n))return;this.graphSettings.setProperty("yAxisStep",n)}break;case"xmin":case"xmax":case"ymin":case"ymax":case"zmin":case"zmax":{if(!this.grapher)return;let o=this.grapher.viewportController.getViewport(),s="xmin";e==="xmin"&&(s="xmax"),e==="ymax"&&(s="ymin"),e==="ymin"&&(s="ymax"),e==="zmax"&&(s="zmin"),e==="zmin"&&(s="zmax");let a=yn(this.settingsViewModel.limitLatex[s]||"",this.graphSettings.degreeMode),l=an.fromObject(__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},o.toObject()),{[e]:n,[s]:a}));if(!l.isValid(this.getAxisScaleSettings()))return;this.grapher.viewportController.setViewport(l);let d;switch(e){case"xmin":case"xmax":d="x";break;case"ymin":case"ymax":d="y";break;case"zmin":case"zmax":d="z";break;default:let u=e;throw new Error(`Invalid limit: ${u}`)}this.graphSettings.setProperty("lastChangedAxis",d),this.markSquareAxesAfterUserEditedViewport()}break}if(this.grapher){let o=this.grapher.viewportController.getViewport().toObject();this._commitUserRequestedViewport(o)}}unmarkLastChangedAxis(){this.graphSettings.setProperty("lastChangedAxis",void 0)}markSquareAxesAfterUserEditedViewport(){if(!this.grapher)return;let e=this.grapher.viewportController.getViewport().isSquare(this.grapher.getProjection().screen,this.getAxisScaleSettings());this.graphSettings.setProperty("squareAxes",e)}getLockViewportConfigSetting(){return this.graphSettings.config.lockViewport}getLockViewportUserSetting(){return this.graphSettings.userLockedViewport}canUserAddExpressions(){return!!this.graphSettings.config.expressions}areNotesEnabled(){return!!this.graphSettings.config.notes}areSlidersEnabled(){return!!this.graphSettings.config.sliders}areLinksEnabled(){return!!this.graphSettings.config.links}areImagesEnabled(){let e=window.FileReader,r=La&&Ff&&Ff[0]===8&&Ff[1]===0&&Ff[2]===0;return!!(this.graphSettings.config.images&&e&&!r)}areFoldersEnabled(){return!!this.graphSettings.config.folders}isDecimalToFractionEnabled(){return!!this.graphSettings.config.decimalToFraction}isTraceEnabled(){return!!this.graphSettings.config.trace}areFunctionsRestricted(){return!!this.graphSettings.config.restrictedFunctions}areGeometryFunctionsForceEnabled(){return!!this.graphSettings.config.forceEnableGeometryFunctions}isQwertyKeyboardEnabled(){return!!this.graphSettings.config.qwertyKeyboard}isZoomFitEnabled(){return!!this.graphSettings.config.zoomFit}canEditOnWeb(){return!!this.graphSettings.config.editOnWeb}hasTransparentBackground(){return!!this.graphSettings.config.transparentBackground}shouldAudioTraceReverseExpressions(){return!!this.graphSettings.config.audioTraceReverseExpressions}hasDefaultState(){return!!this.graphSettings.defaultState}getDefaultViewport(){var r;var e=this.graphSettings.defaultState;return e&&e.graph?e.graph.viewport:(r=this.grapher)==null?void 0:r.getDefaultViewport()}getColors(){return this.graphSettings.config.colors}getImageOpacities(){return["0.2","0.4","0.6","0.8","1"]}getUIDragModes(){return["X","Y","XY"]}getNumberOfItemsInFolder(e){return A_(this.listModel,e)}getEnabledDragModesForItem(e){let r=this.getItemModel(e);if(!r||r.type!=="expression")return[];let i=r.formula,n=[];if(!i.move_strategy)return n;let o=i.move_strategy[0].type!=="none",s=i.move_strategy[1].type!=="none",a=o&&s;return o&&n.push("X"),s&&n.push("Y"),a&&n.push("XY"),n}shouldShowEvaluationForItem(e){let r=this.getItemModel(e);return!r||r.type!=="expression"?!1:BV(r)}getEvaluationValueForItem(e){let r=this.getItemModel(e);return r?r.type!=="expression"?NaN:KV(r):NaN}canDisplayEvaluationForItemAsFraction(e){if(!this.isDecimalToFractionEnabled())return!1;let r=this.getItemModel(e);if(!r||r.type!=="expression"||pl(r))return!1;let i=this.getEvaluationValueForItem(e);return typeof i!="number"?!1:__dcg_shared_module_exports__['Db'](i)}shouldEvaluationForItemDisplayAsFraction(e){if(!this.isDecimalToFractionEnabled())return!1;let r=this.getItemModel(e);return!r||r.type!=="expression"?!1:_h(r)}getEvaluationLabelOptionsForItem(e){return __dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},kP),{displayAsFraction:this.shouldEvaluationForItemDisplayAsFraction(e)})}getPointStyles(){return["POINT","OPEN","CROSS"]}getLineStyles(){return["SOLID","DASHED","DOTTED"]}getOpacities(){return[.2,.4,.8]}isInEditListMode(){return this.layoutModel.inEditListMode}shouldShowAuthorFeatures(){return!!this.graphSettings.config.authorFeatures}getInvertedColors(){return!!this.graphSettings.config.invertedColors}invertSwatches(){return this.isThreeDMode()&&this.getInvertedColors()}canUseAdvancedStyling(){return this.graphSettings.config.advancedStyling}isDegreeMode(){return this.graphSettings.degreeMode}isThreeDMode(){return this.graphSettings.threeDMode}areLogModeRegressionsForced(){return this.graphSettings.config.forceLogModeRegressions}setAllRegressionsToLogMode(){for(let e of this.getAllItemModels())e.type==="expression"&&e.formula&&e.formula.is_regression&&JV(e,!0)}isGraphSettingsOpen(){return this.layoutModel.graphSettingsOpen}isAddExpressionOpen(){return this.layoutModel.addExpressionOpen}shouldRenderList(){if(this.layoutModel.expressionsVisible)return!0;var e=this.layoutModel.expressionsHiddenTime;return e===void 0?!1:Date.now()-e<=500}isListVisible(){return this.layoutModel.expressionsVisible}isGrapherEnabled(){return this.graphSettings.config.graphpaper!==!1}isListEnabled(){return this.graphSettings.config.expressions!==!1}areDistributionsEnabled(){return this.graphSettings.config.distributions===!0}isExpressionListFocused(){let e=this.getFocusLocation();if(!e)return!1;switch(e.type){case"settings":case"generic-menu":case"expression-menu":case"editable-label":case"geo-token":case"multi-select-more-icon":case"multi-select-transformations-icon":case"geo-header-back-link":case"multi-select-delete-icon":case"multi-select-show-hide-icon":case"new-transformation-number":case"label-points-icon":case"geo-show-constructions-icon":case"geo-basic-tool":case"geo-basic-tool-dropdown":case"geo-basic-tool-menu-item":case"regression-output":case"graph-paper":case"zoom-restore-btn":return!1;case"distribution-param":case"cdf-limit":case"slider-limit":case"domain-limit":case"expression":case"visualization-prop":case"search-expressions":case"replace-expressions":case"ticker":case"table":case"image":case"readonly-expression":case"braille-output":case"table-container":case"text":case"folder":case"add-item-btn":case"add-expression-btn":case"add-note-btn":case"add-table-btn":case"add-folder-btn":case"add-ticker-btn":case"add-image-btn":case"change-image-btn":case"edit-list-toggle":case"expression-icon":case"image-icon":case"slider-icon":case"slider-animation-properties-icon":case"slider-thumb":case"table-icon":case"action-icon":case"hide-expression-list-btn":case"show-expression-list-btn":return!0;default:return e}}needsFakeKeypad(){if(this.inAudioTraceMode()&&this.isKeypadEnabled())return!0;let e=this.getFocusLocation();if(!e||this.getBrailleMode()!=="none"&&zs())return!1;switch(e.type){case"settings":return JN(e.location);case"new-transformation-number":case"distribution-param":case"cdf-limit":case"slider-limit":case"domain-limit":case"expression":case"visualization-prop":case"search-expressions":case"replace-expressions":case"ticker":return!0;case"expression-menu":return e.location==="opacity"||e.location==="linewidth"||e.location==="lineopacity"||e.location==="pointopacity"||e.location==="pointsize"||e.location==="labelsize"||e.location==="labelangle"||e.location==="updaterule";case"table":{if(this.isInEditListMode())return!1;let n=e.location;if(n.row===0)return!0;var r=this.getItemModel(e.id);if(!r||r.type!=="table")return!1;let o=r.columnModels[n.column];return o?!o.disabled:!1}case"image":return e.location!=="name";case"readonly-expression":case"braille-output":case"regression-output":case"graph-paper":case"table-container":case"text":case"folder":case"add-item-btn":case"add-expression-btn":case"add-note-btn":case"add-table-btn":case"add-folder-btn":case"add-ticker-btn":case"add-image-btn":case"change-image-btn":case"edit-list-toggle":case"hide-expression-list-btn":case"show-expression-list-btn":case"geo-token":case"multi-select-more-icon":case"multi-select-transformations-icon":case"geo-header-back-link":case"multi-select-delete-icon":case"multi-select-show-hide-icon":case"label-points-icon":case"geo-show-constructions-icon":case"geo-basic-tool":case"geo-basic-tool-dropdown":case"geo-basic-tool-menu-item":case"generic-menu":case"zoom-restore-btn":return!1;case"expression-icon":case"image-icon":case"slider-icon":case"action-icon":case"slider-animation-properties-icon":case"slider-thumb":case"table-icon":return!1;case"editable-label":return this.getItemEditableLabelMode(e.id)==="MATH";default:return e}}isIdentifierRenameValid(e){return ha(e)?!F_(this.listModel,e):!1}getBrandingMode(){return this.getEditLink()?"static-edit-link":this.getGraphSettings().config.editOnWeb?"edit-link":"powered-by"}getEditLink(){return window.iframeEmbedBrandingLink}_expressionZoomFit(e,r,i=!1){let n=this.getItemModel(e);if(!this.grapher||!this.isZoomFitEnabled()||!n||n.type!=="expression"&&n.type!=="table"||!n.boundingBoxes||!n.boundingBoxes.length)return!1;var o=this.grapher.viewportController;if(!("zoomCustom"in o))return!1;let s=Fb(n.boundingBoxes,o.getProjection());return s?(i?o.setViewport(an.fromObject(s)):o.zoomCustom(s),r&&Pi(this,{type:"zoom-restore-btn"}),!0):!1}_deleteItemAndAnimateOut(e,r){let n=this.getItemSelectorById(e);n&&(n.css({transition:.2+"s",opacity:"0",transform:"scale(.1, .1)"}),setTimeout(()=>{this.dispatch({type:"finish-deleting-item-after-animation",id:e,setFocusAfterDelete:r})},1e3*.2))}_finishDeletingItemAfterAnimation(e,r){let i=this.getItemModel(e);if(!i)return;let n=this.getItemSelectorById(e);var o=n&&document.activeElement&&I(document.activeElement).closest(n).length>0,s=zp(this.listModel,i.index);if(this._removeExpressionSynchronously(i),!(!r||!o)){if(!s){let a=Vg(this.listModel);a&&(s=a)}s&&Xn(this,s.id,"end")}}_removeExpressionSynchronously(e){let r=Pg(this.listModel,e.index);this.garbageCollectGeo(r,{}),this.ensureAtLeastOneVisibleItem()}setRootElt(e){this.rootElt=e,this.dragdrop_expressions=new Kb(this)}getRootElt(){return this.rootElt}_hideExpressions(e){this.graphSettings.config.expressions&&(ri(this.listModel,void 0),this.layoutModel=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.layoutModel),{expressionsVisible:!1,expressionsHiddenTime:Date.now()}),e?Pi(this,{type:"show-expression-list-btn"}):ti())}_showExpressions(e){this.graphSettings.config.expressions&&(this.layoutModel=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.layoutModel),{expressionsVisible:!0}),e?Pi(this,{type:"hide-expression-list-btn"}):ti())}_showToast(e){if(this.toastData=e,this.toastData.hasOwnProperty("undoCallback")&&!al){let i=Zr?this.s("graphing-calculator-text-toast-undo-cmd-z"):this.s("graphing-calculator-text-toast-undo-ctrl-z");this.toastData.message+=" "+i}clearTimeout(this._hideToastTimeout);let r=typeof e.hideAfter=="number"?e.hideAfter:6e3;r>0&&(this._hideToastTimeout=setTimeout(()=>{this.dispatch({type:"toast/close",onHide:this.toastData.onHide})},r))}_setExpressionPropertiesFromAPI(e,r){let i=this.getItemModel(e);if(i)if(i.type==="table"&&r.columns){r=__dcg_shared_module_exports__['N'](r);let s=VF(i,r);var n=Eg(this.listModel,s);this._toplevelReplaceItemAt(i.index,n,!1)}else{let s=this.getItemModel(e);if(!s)return;for(var o in r)if(r.hasOwnProperty(o))switch(o){case"slider":{if(s.type!=="expression")continue;let a=r[o];a.hasOwnProperty("min")&&hg(s,a.min),a.hasOwnProperty("max")&&pg(s,a.max),a.hasOwnProperty("step")&&ry(s,a.step),a.hasOwnProperty("isPlaying")&&ga(s,a.isPlaying)}break;case"polarDomain":{if(s.type!=="expression")continue;iy(s,__dcg_shared_module_exports__['kc'](r.polarDomain.min)),ay(s,__dcg_shared_module_exports__['kc'](r.polarDomain.max))}break;case"parametricDomain":{if(s.type!=="expression")continue;ny(s,__dcg_shared_module_exports__['kc'](r.parametricDomain.min)),ly(s,__dcg_shared_module_exports__['kc'](r.parametricDomain.max))}break;case"parametricDomain3Du":{if(s.type!=="expression")continue;oy(s,__dcg_shared_module_exports__['kc'](r.parametricDomain3Du.min)),cy(s,__dcg_shared_module_exports__['kc'](r.parametricDomain3Du.max))}break;case"parametricDomain3Dv":{if(s.type!=="expression")continue;sy(s,__dcg_shared_module_exports__['kc'](r.parametricDomain3Dv.min)),dy(s,__dcg_shared_module_exports__['kc'](r.parametricDomain3Dv.max))}break;case"hidden":this._setItemHidden(e,r.hidden);break;case"secret":EI(s,r.secret);break;case"readonly":_C(s,r.readonly);break;case"color":{if(s.type!=="expression")continue;Fv(s,r.color)}break;case"dragMode":{if(s.type!=="expression")continue;Up(s,r.dragMode)}break;case"label":{if(s.type!=="expression")continue;Pd(s,r.label)}break;case"showLabel":{if(s.type!=="expression")continue;Kp(s,r.showLabel)}break;case"labelSize":{if(s.type!=="expression")continue;my(s,r.labelSize)}break;case"labelOrientation":{if(s.type!=="expression")continue;eI(s,r.labelOrientation)}break;case"latex":if(s.type!=="expression")continue;Bs(s,r.latex);break;case"points":if(s.type!=="expression")continue;XV(s,!!r.points);break;case"lines":if(s.type!=="expression")continue;ZV(s,!!r.lines);break;case"pointStyle":if(s.type!=="expression")continue;QV(s,r.pointStyle);break;case"pointSize":if(s.type!=="expression")continue;uy(s,r.pointSize);break;case"pointOpacity":if(s.type!=="expression")continue;py(s,r.pointOpacity);break;case"lineStyle":if(s.type!=="expression")continue;Bv(s,r.lineStyle);break;case"lineWidth":if(s.type!=="expression")continue;mg(s,r.lineWidth);break;case"lineOpacity":if(s.type!=="expression")continue;gg(s,r.lineOpacity);break;case"fill":if(s.type!=="expression")continue;YV(s,r.fill);break;case"fillOpacity":if(s.type!=="expression")continue;hy(s,r.fillOpacity);break;case"id":case"type":case"domain":break;default:throw new Error("trying to call setProperty for: "+o)}}}_isParentFolderHidden(e){let r=this.getItemModel(e);if(!r)return!1;let i=ma(r);return i?i.hidden:!1}_toggleItemHidden(e){if(this._isParentFolderHidden(e))this._setItemHidden(e,!1);else{let r=this.getItemModel(e);if(!r)return;switch(r.type){case"expression":case"image":case"folder":this._setItemHidden(e,!r.hidden);break;case"table":case"text":break;default:return r}}}_toggleTableColumnHidden(e,r){if(this._isParentFolderHidden(e))this._setTableColumnHidden(e,r,!1);else{let i=this.getItemModel(e);if(!i||i.type!=="table")return;let n=Bo(i,r);if(!n)return;this._setTableColumnHidden(e,r,!n.hidden)}}_setTableColumnHidden(e,r,i){let n=this.getItemModel(e);if(!n||n.type!=="table")return;let o=qC(n,r);!i&&this._isParentFolderHidden(e)&&this._setItemHidden(n.folderId,!1),PF(n,r,i),!i&&o&&II(n,r,!0)}_setItemHidden(e,r){let i=this.getItemModel(e);if(i)switch(!r&&i.type!=="folder"&&this._isParentFolderHidden(i.id)&&this._setItemHidden(i.folderId,!1),i.type){case"expression":sO(i,r);break;case"folder":NO(i,r);break;case"image":t_(i,r);break;case"table":case"text":break;default:return i}}_addItemToEndFromAPI(e){let r=yC(this.listModel);!e.secret&&r&&r.type==="expression"&&r.latex===""&&Pg(this.listModel,r.index),Ql(this.listModel,e)}copyExpressionToIndex(e,r,i){let n={stripDefaults:!1},o;switch(e.type){case"expression":o=Bp(e,n);break;case"table":o=_g(e,n),o.columns&&o.columns.forEach(a=>{a.id=this.generateId()});break;case"image":o=dC(e,n);break;case"text":o=oC(e,n);break;default:return}let s=this.createItemModel(__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},o),{id:this.generateId()}));this._toplevelInsertItemAt(r,s,!1,i||e.folderId)}_toplevelInsertItemAt(e,r,i,n){let o=r;za(this.listModel,o,e),n&&No(o,n),i&&Xn(this,o.id)}_toplevelNewItemAtSelection(e,r){this.setGeoTool("selection");let i=this.getSelectedItem();if(i){let a=i.type==="expression"&&!i.latex;if(a&&!i.folderId&&(e.type!=="expression"||e.latex))return this._toplevelReplaceItemAt(i.index,e,r.shouldFocus);if(a&&i.folderId&&e.type!=="expression"&&e.type!=="folder")return this._toplevelReplaceItemAt(i.index,e,r.shouldFocus);if(i.type!=="folder"&&!i.folderId){let l;return this._toplevelInsertItemAt(i.index+1,e,r.shouldFocus,l)}if(i.type!=="folder"&&i.folderId&&e.type!=="folder")return this._toplevelInsertItemAt(i.index+1,e,r.shouldFocus,i.folderId);if(i.type==="folder"&&!i.collapsed&&e.type!=="folder")return this._toplevelInsertItemAt(i.index+1,e,r.shouldFocus,i.id)}let n=this.getFirstFullyVisibleItem();for(n&&n.type==="folder"&&(n=this.getItemModelByIndex(n.index+1));n&&n.type!=="folder"&&n.folderId;)n=this.getItemModelByIndex(n.index+1);let o=n?n.index:this.getItemCount(),s;return this._toplevelInsertItemAt(o,e,r.shouldFocus,s)}getFirstFullyVisibleItem(){let e=dT(this);if(e)return Xl(this.listModel,e)}find$(e){return I(this.rootElt).find(e)}getExppanelSelector(){let e=Rb(this);if(e)return I(e)}scrollItemIntoView(e){if(!this.rootElt||!this.isListVisible())return;let r=this.getItemSelectorById(e.id),i=Nb(this);if(!(!r||!i)){if(e.type==="table"){let n=r.find(".dcg-row .dcg-selected");if(n.length===1){Ba(n,i,60);return}}Ba(r,i,90)}}scrollSelectedItemIntoView(){let e=this.getSelectedItem();if(e){if(e&&e.type!=="folder"&&e.folderId){let r=this.getItemModel(e.folderId);r&&r.type==="folder"&&r.collapsedChildIsSelected&&(e=r)}this.scrollItemIntoView(e)}}_pasteTable(e){if(!this.grapher)return;let r=bC(this.listModel),i=VI(r,e,this),n=this.createItemModel(i);this._toplevelNewItemAtSelection(n,{shouldFocus:!0}),this._closeAddExpression();let o=this.grapher.getProjection(),s=o.viewport,a=__dcg_shared_module_exports__['l'](e[0],function(d){return parseFloat(d)}),l=__dcg_shared_module_exports__['l'](e[1],function(d){return parseFloat(d)}),c={xmin:__dcg_shared_module_exports__['s'](a),xmax:__dcg_shared_module_exports__['r'](a),ymin:__dcg_shared_module_exports__['s'](l),ymax:__dcg_shared_module_exports__['r'](l),type:"table"};if(isFinite(c.xmin)&&isFinite(c.xmax)&&isFinite(c.ymin)&&isFinite(c.ymax)&&(c.xmax>s.xmax||c.xmin<s.xmin||c.ymax>s.ymax||c.ymin<s.ymin)){let d=Fb([c],o);if(d){let u=new an(d.xmin,d.xmax,d.ymin,d.ymax);this.grapher.viewportController.setViewport(u),this._showToast({message:this.s("graphing-calculator-text-toast-zoom-to-fit"),undoCallback:()=>{this.dispatch({type:"undo"})}}),this.markSquareAxesAfterUserEditedViewport()}}}_insertSeveralExpressions(e){for(var r=0;r<e.length;r++){let i;i=this.createItemModel(e[r]),this._toplevelNewItemAtSelection(i,{shouldFocus:!0})}}_appendNumberList(e){let r=this.getSelectedItem();if(r&&r.type==="expression"){let i=r.latex,n=this.createItemModel({type:"expression",id:this.generateId(),latex:i+e});return this._toplevelReplaceItemAt(r.index,n,!0)}}_openOnWeb(){this.runAfterDispatch(()=>{if(!this.grapher)return;let e=JSON.stringify(this.getState()),r=this.grapher.screenshot({width:100,height:100}),o=(this.getGraphSettings().config.crossOriginSaveTest?"/":"https://www.desmos.com/")+"api/v1/calculator/cross_origin_save",s=I('<input type="text" name="calc_state" />').val(e),a=I('<input type="text" name="thumb_data" />').val(r),l=I('<form target="_blank" method="POST" style="display:none;"></form>').attr("action",o).append(I('<input type="text" name="is_open_on_web" value="true" />')).append(I('<input type="text" name="my_graphs" value="false" />')).append(I('<input type="text" name="is_update" value="false" />')).append(s).append(a);I(this.rootElt).append(l),l.trigger("submit").remove()})}notifyBugsnagAboutMissingSelectedItem(e,r){let i=Lg(this.listModel);var n="";try{i?n=JSON.stringify(i.cachedUndoRedoFullState,null,2):n="undefined"}catch(a){n="[[could not stringify]]"}var o="";try{if(!i)o="undefined";else{let a={id:i.id,index:i.index,displayIndex:i.index,secretIndex:i.secretIndex,guid:i.guid,renderShell:i.renderShell,isHiddenFromUI:i.isHiddenFromUI,hasDCGView:!!i.dcgView,cachedRenderHeight:i.cachedRenderHeight};o=JSON.stringify(a,null,2)}}catch(a){o="[[could not stringify]]"}var s="";try{s=JSON.stringify(vI(this.listModel),null,2)}catch(a){s="[[could not stringify]]"}Co("ReplaceItemAtError: no item at index",{metaData:{index:e,shouldFocus:r,selectedModelJSON:o,selectedItemJSON:n,listStateJSON:s}})}_toplevelReplaceItemAt(e,r,i){let n=r,o=this.getItemModelByIndex(e);o||this.notifyBugsnagAboutMissingSelectedItem(e,i);let s=o.type!=="folder"&&o.folderId;Pg(this.listModel,e),za(this.listModel,n,e),s&&No(n,s),i&&Xn(this,n.id)}convertImageToDraggable(e){let r=this.getItemModel(e);if(!r||r.type!=="image")return;let i=r.folderId,n=r.index+1,o=r.center,s=bC(this.listModel),a=__dcg_shared_module_exports__['Hb']("C_"+s),l=this.createItemModel({id:this.generateId(),type:"expression",latex:a+"="+o,dragMode:"XY",hidden:!0});za(this.listModel,l,n),i&&No(l,i),ya(r,"center",a),hI(r,!0),pI(r,!0),this.listModel.openItemMenu=void 0}createSlidersForItem(e,r){let i=this.getItemModel(e);if(!i)return;let n=i.type!=="folder"&&i.folderId;return this.createSliders({model:i,folderId:n,index:i.index+1},r)}createSlidersForTicker(e){return this.createSliders({model:this.listModel.ticker,folderId:!1,index:0,doNotChangeFocus:!0},e)}createSliders({model:e,folderId:r,index:i,doNotChangeFocus:n},o){var s=[];e.type==="ticker"?gC(e,(p,g)=>{s.push({latex:p,location:g})}):Sg(e,(p,g)=>{s.push({latex:p,location:g})});var a=KN(s,o,{degreeMode:this.graphSettings.degreeMode});let l=e.formula?e.formula.action_value:void 0;for(var c=o.map(p=>{var g=a[p],b="1";g&&g.value!==void 0&&(b=g.value);var x;p===""?x="":l&&l.hasOwnProperty(p)?x=l[p]:x=__dcg_shared_module_exports__['Hb'](p)+"="+b;var w={type:"expression",id:this.generateId(),latex:x,color:this.getNextColor(),hidden:!!x};return g&&(g.min!==void 0&&(w.slider||(w.slider={}),w.slider.hardMin=!0,w.slider.min=g.min),g.max!==void 0&&(w.slider||(w.slider={}),w.slider.hardMax=!0,w.slider.max=g.max),g.step!==void 0&&(w.slider||(w.slider={}),w.slider.step=g.step)),w}),d=c.length-1;d>=0;d--){let p=this.createItemModel(c[d]);za(this.listModel,p,i),r&&No(p,r)}if(n)return;let u=c[c.length-1];u.latex===""?Xn(this,u.id):Pi(this,void 0)}_uploadImagesAndWaitForThemToLoad(e){let{files:r,id:i}=e;if(!r||r.length===0){this._showToast({message:this.s("graphing-calculator-text-toast-no-file-selected")});return}if(i&&r.length>1){this._showToast({message:this.s("graphing-calculator-text-toast-choose-one-file")});return}let n=u_({controller:this,files:r,id:i}),o=n.errors[0];o&&this._showToast({message:o});for(let s of n.tokens)this.__pendingImageUploads[s]=!0;this.isUploadingImages()&&this._showToast({message:this.s("graphing-calculator-text-toast-uploading-images"),onHide:()=>{this._clearPendingImageUploads()}})}getImageToRetry(){let e;for(let r of this.getAllItemModels())r.type==="image"&&r.loadStatus==="failed"&&(!e||e.failures>r.failures)&&(e=r);return e}retryLoadingFailedImage(e){let r=Date.now(),i=r-this.imageRetryState.lastAttemptTime,n=1e3*Math.pow(2,this.imageRetryState.attempts);this.imageRetryState.attempts>0&&i<n||(gI(e),this.imageRetryState={lastAttemptTime:r,attempts:this.imageRetryState.attempts+1})}getSelectedItem(){return Lg(this.listModel)}getAllSelectedItems(){return xC(this.listModel)}getOpenItemMenu(){return this.listModel.openItemMenu}isItemSettingsMenuOpen(e){var r=this.listModel.openItemMenu;return r?r.guid===e:!1}closeItemSettingsMenu(){let e=this.getOpenItemMenu();e!==void 0&&(e.focusFirstOption&&(e.previousFocusLocation!==void 0?Pi(this,e.previousFocusLocation):this.focusOpenMenuIcon()),this.listModel.openItemMenu=void 0)}closeAnyOpenMenusAndClearFocus(){this.getOpenItemMenu()!==void 0&&this.dispatch({type:"close-item-settings-menu"}),this.layoutModel.graphSettingsOpen&&this.dispatch({type:"close-graph-settings",focusIconAfterClose:!1}),this.dispatch({type:"set-none-selected"})}focusOpenMenuIcon(){let e=this.getOpenItemMenu();e&&(e.type==="slider"?this.dispatch({type:"set-focus-location",location:{type:"slider-animation-properties-icon",id:e.model.id}}):e.type==="image"?this.dispatch({type:"set-focus-location",location:{type:"image-icon",id:e.model.id}}):e.type==="table-column"?this.dispatch({type:"set-focus-location",location:{type:"table-icon",id:e.model.table.id,columnId:e.model.id}}):e.type==="geo-tool-dropdown"?this.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool-dropdown",tool:e.tools[0]}}):e.type==="multi-select-more"?this.dispatch({type:"set-focus-location",location:{type:"multi-select-more-icon"}}):e.type==="multi-select-transformations"?this.dispatch({type:"set-focus-location",location:{type:"multi-select-transformations-icon"}}):this.dispatch({type:"set-focus-location",location:{type:"expression-icon",id:e.model.id}}))}getFocusedItem(){return qN(this)}getFocusLocation(){return this.focusLocation}isFocusLocationFocused(e){let r=this.focusLocation,i=e;return!r||!i?!1:__dcg_shared_module_exports__['F'](r,i)}isCurrentFocusLocationValid(){let e=this.focusLocation;if(!e)return!0;if(e.type==="settings")return e.location==="icon"||this.isGraphSettingsOpen();if(e.type==="add-item-btn"||e.type==="edit-list-toggle"||e.type==="hide-expression-list-btn"||e.type==="show-expression-list-btn")return this.isListEnabled();if(e.type==="add-expression-btn"||e.type==="add-table-btn")return this.layoutModel.addExpressionOpen;if(e.type==="add-note-btn")return this.layoutModel.addExpressionOpen&&this.areNotesEnabled();if(e.type==="add-folder-btn")return this.layoutModel.addExpressionOpen&&this.areFoldersEnabled();if(e.type==="add-ticker-btn")return this.layoutModel.addExpressionOpen&&this.areActionsEnabled();if(e.type==="add-image-btn")return this.layoutModel.addExpressionOpen&&this.areImagesEnabled();if(e.type==="zoom-restore-btn")return!0;if(e.type==="search-expressions"||e.type==="replace-expressions")return this.expressionSearchOpen;if(e.type==="ticker")return this.listModel.ticker.open;if(e.type==="generic-menu")return!!this.getOpenItemMenu();if(e.type==="graph-paper"){let n=this.getGrapher();return!!(n&&n.getIsVisible()&&n.settings.config.graphpaper)}if(e.type==="geo-show-constructions-icon"||e.type==="geo-token"||e.type==="multi-select-more-icon"||e.type==="multi-select-transformations-icon"||e.type==="label-points-icon")return this.isGeoUIActive();if(e.type==="new-transformation-number"){let n=this.getGeoModel(),o=n.getCurrentTool(),s=n.getNonObjectsState().ui.currentTool.inputIndex,a=o.getSpec&&o.getSpec();return!!a&&!!a.inputs[s]&&a.inputs[s].type==="number"}if(e.type==="geo-header-back-link")return this.isGeoUIActive()&&this.hasAnyItemsSelected();if(e.type==="multi-select-delete-icon"||e.type==="multi-select-show-hide-icon")return this.isGeoUIActive()&&this.getActiveTool()==="box-selection"&&this.hasAnyItemsSelected();if(e.type==="geo-basic-tool"||e.type==="geo-basic-tool-dropdown")return this.isGeoUIActive()&&e.tool!=="expression-edit";if(e.type==="regression-output")return e.parameter!=="";let r=this.getOpenItemMenu();if(e.type==="geo-basic-tool-menu-item")return this.isGeoUIActive()&&e.tool!==""&&r!==void 0&&r.type==="geo-tool-dropdown";let i;if(r&&r.type==="table-column"?i=r.model.table:i=this.getItemModel(e.id),!i)return!1;if(e.type==="change-image-btn")return this.listModel&&i.type==="image"&&this.areImagesEnabled();if(e.type==="expression-menu"){if(e.location==="start"||e.location==="end"||e.location==="updaterule"||e.location==="anywhere"||i.type==="table")return!0;if(i.type!=="expression")return!1;let{points:n,lines:o,fill:s,surfaces:a}=i;Hc(i)&&(s=!0);let l=__dcg_shared_module_exports__['pc'](i.formula.expression_type,{points:n,lines:o,fill:s,surfaces:a});return!(!l.fill&&!l.points&&!l.lines&&!l.surfaces&&!i.showLabel)}if(!this.isItemSelected(e.id)&&e.type!=="editable-label")return!1;switch(e.type){case"domain-limit":return!(i.type!=="expression"||!Hv(i)&&!zv(i));case"expression-icon":return!0;case"image-icon":return i.type==="image"&&i.loadStatus!=="loading"&&i.loadStatus!=="failed"&&!i.error;case"action-icon":return!(i.type!=="expression"||!yg(i));case"slider-icon":case"slider-animation-properties-icon":case"slider-thumb":case"slider-limit":return!(i.type!=="expression"||!mO(i));case"table-icon":return i.type==="table"&&this.getGraphSettings().config.graphpaper;case"visualization-prop":return!(i.type!=="expression"||!Jv(i));case"distribution-param":if(i.type!=="expression")return!1;let n=qa(i);return n?e.location in n.values:!1;case"cdf-limit":return i.type!=="expression"?!1:zc(i);case"image":return i.type==="image";case"folder":return i.type==="folder";case"text":return i.type==="text";case"expression":return i.type==="expression"&&!this.isInEditListMode();case"readonly-expression":return this.isItemReadonly(i.id)||i.type==="expression"&&this.isInEditListMode();case"braille-output":return i.type==="expression"&&this.getBrailleMode()!=="none";case"table":return i.type!=="table"?!1:FF(i,e.location);case"table-container":return i.type==="table"&&this.isInEditListMode();case"editable-label":return i.type!=="expression"?!1:fg(i);default:return e}}isDragDropActive(){return!!this.listModel.dragState}isItemBeingDragged(e){let r=this.listModel.dragState;return!(!r||r.firstItemId!==e)}shouldRenderDraggedItemAsToken(){let e=this.listModel.dragState;return e?e.renderType==="token":!1}canDraggedItemBeMovedIntoTokenPane(){var i,n;let e=this.getDraggedItemId();if(!e)return!1;let r=this.getItemModel(e);return!r||r.type!=="expression"||((i=r.formula.geometry)==null?void 0:i.valueType)!==void 0&&__dcg_shared_module_exports__['yb'](r.formula.geometry.valueType,__dcg_shared_module_exports__['pb'])&&!__dcg_shared_module_exports__['gc']((n=r.formula.geometry.call)==null?void 0:n.symbol)?!1:!!r.formula.geometry}getDraggedItemId(){let e=this.listModel.dragState;return e&&e.firstItemId}getDraggedIdentifier(){var i;let e=this.getRawDragState();if(!e)return;let r=this.getItemModel(e.dragTarget.calcId);if(!(!r||r.type!=="expression"))return(i=hs(r))==null?void 0:i.identifier}getRawDragState(){return this.listModel.dragState}initStateStack(){this.stateStack=new Xd,this.stateStack.addState({diffState:this.getUndoRedoDiffState(),fullState:this.getUndoRedoFullState()})}getUndoRedoDiffState(){return{randomSeed:this.getRandomSeed(),layoutModel:this.layoutModel,settingsViewModel:this.settingsViewModel,graph:this.grapher?this.grapher.getUndoRedoState():void 0,expressions:J_(this.listModel),wasCompleteSetState:this.isCurrentlyDoingSetState}}getUndoRedoFullState(){return{randomSeed:this.getRandomSeed(),layoutModel:this.layoutModel,settingsViewModel:this.settingsViewModel,graph:this.grapher?this.grapher.getUndoRedoState():void 0,expressions:vI(this.listModel),wasCompleteSetState:this.isCurrentlyDoingSetState}}getState(e){let r={stripDefaults:!0};e&&e.hasOwnProperty("stripDefaults")&&(r.stripDefaults=!!e.stripDefaults);let i=this.grapher?this.grapher.getState(r):__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.getBlankState().graph),{degreeMode:this.graphSettings.degreeMode});var n={version:xl,randomSeed:this.getRandomSeed(),graph:i,expressions:Y_(this.listModel,r)};return e&&e.avoidBackMigration?__dcg_shared_module_exports__['N'](n):_N(__dcg_shared_module_exports__['N'](n))}isGeometry(){return this.graphSettings.config.product==="geometry-calculator"}is3D(){return this.graphSettings.config.product==="graphing-3d"}isMultiSelectEnabled(){return this.isGeometry()}canLoadPastedLink(e){if(!this.graphSettings.config.pasteGraphLink)return!1;if(this.isGeometry()){if(QD(e)){let r=this.getSelectedItem();return r&&r.type==="folder"&&r.title===""}return gT(e)||mT(e)}else return QD(e)}getBlankState(e){if(this.isGeometry())return mm;if(this.is3D())return sB;let r;return(e==null?void 0:e.degreeMode)!==void 0?r=e.degreeMode:r=this.graphSettings.config.clearIntoDegreeMode,r?__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},hm),{graph:__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},hm.graph),{degreeMode:!0})}):hm}externalSetState(e,r){this._clearPendingImageUploads(),this.rootElt&&I(document.activeElement).closest(this.rootElt).length&&I(document.activeElement).trigger("blur"),r||(r={}),e||(e=this.getBlankState()),typeof e=="string"&&(e=JSON.parse(e)),e&&(e=uc(e));let i=this.graphSettings.config.product,n;if(!e.graph||e.graph.product===void 0?n="graphing":n=e.graph.product,n!==i)throw new Error(`Data Error: state appears to have been saved in the '${n}' product and cannot be opened in the '${i}' product.`);let o=this.layoutModel;this.setState(e,r),z_(this.listModel),wC(this.listModel),this.layoutModel=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},lT(this.graphSettings.config)),{keypadMinimized:o.keypadMinimized,keypadLayout:o.keypadLayout,keypadFunctionsOpen:o.keypadFunctionsOpen,expressionsVisible:!!this.graphSettings.config.expressions&&(this.isListVisible()||!!r.forceExpressionsOpen)}),this.settingsViewModel=cT(),Pi(this,void 0),r.forceUnsavedChanges?this.enqueueEvent("change"):this.enqueueEvent("clearUnsavedChanges")}setState(e,r){if(this.isCurrentlyDoingSetState=!0,this.suggestedIdentifierRename=void 0,this.lastUserUpdatedExpressionItem=void 0,"graph"in e&&e.graph!==void 0&&("threeDMode"in e.graph&&e.graph.threeDMode&&this.grapher3d?(this.setGrapher(this.grapher3d),"showBox3D"in e.graph&&this.grapher3d.webglLayer.showBox(e.graph.showBox3D),"showAxis3D"in e.graph&&this.grapher3d.webglLayer.showAxes(!!e.graph.showAxis3D),"showAxisLabels3D"in e.graph&&this.grapher3d.webglLayer.updateAxes(),"showPlane3D"in e.graph&&this.grapher3d.webglLayer.showPlane(!!e.graph.showPlane3D),this.grapher2d.setCanvasSizeFor3D(384,384),this.grapher3d.webglLayer.setBackgroundColor(e.graph.backgroundColor3d)):this.setGrapher(this.grapher2d),this.grapher?this.grapher.setGrapherState(e.graph):od.copyGraphProperties(e.graph,this.graphSettings),"threeDMode"in e.graph&&e.graph.threeDMode&&this.grapher3d&&this.grapher3d.controls.copyWorldRotationToWorld()),"expressions"in e){ri(this.listModel,void 0);let i=X_(e.expressions);i>=this.__nextItemId&&(this.__nextItemId=i+1),Q_(this.listModel,e.expressions,r||{})}e.layoutModel&&(this.layoutModel=e.layoutModel),e.settingsViewModel&&(this.settingsViewModel=e.settingsViewModel),(!r||!r.allowUndo)&&this.clearUndoRedoHistory(),this.setRandomSeed(e.randomSeed||ad())}updateToState(e){this.isCurrentlyDoingRestoreState=!0,this.suggestedIdentifierRename=void 0,this.lastUserUpdatedExpressionItem=void 0,"graph"in e&&this.grapher&&this.setGrapher(e.graph.threeDMode?this.grapher3d||this.grapher2d:this.grapher2d),"graph"in e&&this.grapher&&this.grapher.setGrapherState(e.graph,{doNotClear:!0}),"expressions"in e&&Z_(this.listModel,e.expressions),e.layoutModel&&(this.layoutModel=e.layoutModel),e.settingsViewModel&&(this.settingsViewModel=e.settingsViewModel)}commitUndoRedoSynchronously(e){let r=this.stateStack.getState(),i=r&&r.diffState,n=this.getUndoRedoDiffState();if(C$(i,n))return;let o={diffState:n,fullState:this.getUndoRedoFullState()};lB(e)?(this.stateStack.addState(o),this.enqueueEvent("change",e)):this.stateStack.replaceInteriorState(o)}undo(){if(!this.canUndo())return;this.closeToast(),this.stateStack.undo();let e=this.stateStack.getState().fullState;e.wasCompleteSetState?this.setState(e,{allowUndo:!0}):this.updateToState(e),this.enqueueEvent("change",{type:"undo"})}redo(){if(!this.canRedo())return;this.stateStack.redo();let e=this.stateStack.getState().fullState;e.wasCompleteSetState?this.setState(e,{allowUndo:!0}):this.updateToState(e),this.enqueueEvent("change",{type:"undo"})}clearUndoRedoHistory(){this.stateStack.clear()}canUndo(){return this.stateStack.canUndo()}canRedo(){return this.stateStack.canRedo()}closeToast(){let e=this.toastData.onHide;e&&this.runAfterDispatch(e),this.toastData={}}_closeAddExpression(){this.layoutModel=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.layoutModel),{addExpressionOpen:!1})}doesDOMHaveSize(){return this.layoutMeasurements.width>0&&this.layoutMeasurements.height>0}_getExpListWidth(){var e;if(this.userSpecifiedExpListWidth!==void 0){let n=this.isGeometry()?320:200;e=Math.max(280,Math.min(this.layoutMeasurements.width-n,this.userSpecifiedExpListWidth))}else{if(e=this.layoutMeasurements.width,!e)return 356;var r=.2*e+160;e=Math.min(500,Math.max(280,r))}var i=this.layoutMeasurements.width-this.getGrapherHeight();return Math.abs(i-e)<=10?i:e}_setExpListWidth(e){this.userSpecifiedExpListWidth!==e&&(this.userSpecifiedExpListWidth=e)}getKeypadHeight(){return this.computeMajorLayout().keypad.height}isKeypadEnabled(){return!!this.graphSettings.config.keypad}isKeypadOpen(){if(!this.isKeypadEnabled())return!1;let e=this.layoutModel.keypadMinimized&&!this.isNarrow();return this.needsFakeKeypad()&&!e}isKeypadFunctionsPopoverOpen(){return!!this.layoutModel.keypadFunctionsOpen}getKeypadLayout(){return this.layoutModel.keypadLayout}isLetterKeypadOpen(){let e=this.getKeypadLayout();return this.isKeypadOpen()&&(e==="letters"||e==="noQwertyLetters"||e==="capitalLetters"||e==="noQwertyCapitalLetters")}isFileDraggedOver(){return this.layoutModel.isFileDraggedOver}getGeoToolbarHeight(){return this.isGeoUIActive()?48:0}isNarrowGeometryHeader(){return this.computeMajorLayout().grapher.width<450}getGrapherHeight(){return this.layoutMeasurements.height-this.getGeoToolbarHeight()}computeMajorLayout(){var e=this.layoutMeasurements.width,r=this.layoutMeasurements.height,i=this.isNarrow(),n=this.isListVisible(),o=this.isKeypadOpen(),s=!this.isGrapherEnabled(),a=!this.isListEnabled(),l=!!this.getGraphSettings().config.projectorMode,c={left:0,top:0,width:0,height:0},d={left:0,top:0,width:0,height:0},u={left:0,top:r,width:e,height:l?i?185:193:169};a?(d.width=e,d.height=r):s?(c.width=e,c.height=r):n?i?(c.width=e,c.height=Math.round(.58*r),c.top=r-c.height,d.width=e,d.height=r-c.height):(c.width=this.getExpListWidth(),c.height=r,d.left=c.width,d.width=e-d.left,d.height=r):n||(i?(c.width=e,c.height=Math.round(.58*r),c.top=r,d.width=e,d.height=r):(c.width=this.getExpListWidth(),c.height=r,c.left=-c.width,d.width=e,d.height=r)),o&&(u.top-=u.height,a||(c.height-=u.height));let p=this.getGeoToolbarHeight();return p&&(d.top+=p,d.height-=p),{list:c,grapher:d,keypad:u}}isNarrow(){return this.isGeometry()?this.layoutMeasurements.width<600:this.layoutMeasurements.width<450}getLayoutMeasurements(){return this.layoutMeasurements}getCapExpressionSize(){return!!this.getGraphSettings().config.capExpressionSize}handleAudioTraceCommand(e){let r=this.getAudioGraph();if(r===void 0)return;let i=r.agNavigator;switch(e){case"on":this.runAfterDispatch(()=>{r.enterAudioTrace({fromKeypad:!0})});break;case"off":this.runAfterDispatch(()=>{r.exitAudioTrace()});break;case"hear-graph":r.hearGraph();break;case"stop-graph":r.stopGraph();break;case"volume-down":r.adjustVolume("down");break;case"volume-up":r.adjustVolume("up");break;case"speed-down":r.speedDown();break;case"speed-up":r.speedUp();break;case"previous-point":this.runAfterDispatch(()=>{r.reportAndMoveToPrevPoint()});break;case"next-point":this.runAfterDispatch(()=>{r.reportAndMoveToNextPoint()});break;case"previous-poi":this.runAfterDispatch(()=>{r.reportAndMoveToPrevPOI()});break;case"next-poi":this.runAfterDispatch(()=>{r.reportAndMoveToNextPOI()});break;case"previous-curve":this.runAfterDispatch(()=>{i.prevCurve()});break;case"next-curve":this.runAfterDispatch(()=>{i.nextCurve()});break;case"describe-point":r.describePoint();break;case"describe-curve":r.describeCurve();break;case"describe-axes":r.describeAxes();break;case"keyboard-shortcuts":this.enqueueEvent("showHotkeysModal",{type:"keypad/audio-trace",command:e});break;default:return e}}setAudioTraceSpeed(e){let r=this.getAudioGraph();r&&r.adjustPlaybackSpeed(e)}setGraphPaperFocus(e){Pi(this,e.isFocused?{type:"graph-paper"}:void 0);var r=this.getGrapher();r==null||r.redrawAllLayers(),e.isFocused&&this.isGeoToolActive()&&this.runAfterDispatch(()=>{var i;(i=r==null?void 0:r.poiController)==null||i.keyboardAttentionManager.handleGrapherGainedFocus()})}isGraphPaperFocused(){let e=this.getFocusLocation();return!!e&&e.type==="graph-paper"}isVirtualMouseAllowed(){return!(!this.isGeometry()||!this.isGraphPaperFocused()||!this.geoModel.getCurrentTool().canNextInputBePoint())}setCanShowKeyboardShortcuts(e){this.canShowKeyboardShortcuts=e}getCanShowKeyboardShortcuts(){return this.canShowKeyboardShortcuts}apply3dProps(e){if(!this.grapher||!this.grapher.webglLayer)return;let r=this.grapher.webglLayer;for(let i in e)switch(i){case"showPlane3D":r.showPlane(!!e[i]);break;case"showBox3D":r.showBox(!!e[i]);break;case"showAxis3D":r.showAxes(!!e[i]);break;case"showAxisLabels3D":r.updateAxes();break;case"threeDMode":e[i]&&(r.updatePlaneMap(),this.grapher.controls.animateTransitionFrom2Dto3D());break;default:break}}getGeometryTokenCount(){if(!this.cachedGeoTokenDepths)return 0;let e=0;return __dcg_shared_module_exports__['l'](__dcg_shared_module_exports__['D'](this.cachedGeoTokenDepths),r=>e+=r?r.length:0),e}getAllGeometryConstructionIds(){return L_(this.listModel,__dcg_shared_module_exports__['Oc'])}makeGeoAPI(){this.geoModel=new Lb(this)}getGeoTokenInfoFromIdentifier(e){if(e)return this.cachedGeoTokenInfo[e]}getGeoDescription(e,r={includeDetails:!0}){var $,U,J,R,q,_,A,z,Q,fe,ie,Le,pe,ae,ye,H,ge,Se,Ke,Ae,Ze;if(!e)return this.s("graphing-calculator-narration-geometry-nothing-selected");if(e.type!=="expression"||!e.latex)return this.s("graphing-calculator-narration-geometry-not-a-construction");let i=e.formula.typed_constant_value;if(!i)return this.s("graphing-calculator-narration-geometry-not-a-construction");let n="",o,s,a,l,c,d,u,p=-1,g,b,x,w=this.grapher&&this.grapher.getProjection(),E=w&&w.viewport,k=e.formula.assignment||"",S=k[0]==="$",T=e.formula.geometry&&e.formula.geometry.call,V=T&&T.symbol,O=T&&T.parents?T.parents.map(qe=>qe===void 0?"":qe[0]):[],y=i.valueType,L=i.value;if(!L)return this.s("graphing-calculator-narration-geometry-item-unknown");let P=[];if(r.listIndex!==void 0&&__dcg_shared_module_exports__['ub'](y)&&(y=__dcg_shared_module_exports__['vb'](y),L=L[r.listIndex-1],!L))return this.s("graphing-calculator-narration-geometry-item-unknown");if(r.polygonEdge!==void 0&&y===__dcg_shared_module_exports__['$a'])if(r.polygonEdge>=0&&r.polygonEdge<L.length){let qe=L[r.polygonEdge],At=L[(r.polygonEdge+1)%L.length];p=L.length,L=[qe,At]}else return this.s("graphing-calculator-narration-geometry-item-unknown");switch(y){case __dcg_shared_module_exports__['Ta']:if(V==="intersection"){e.label!==void 0&&e.label!==""?n=this.s("graphing-calculator-narration-geometry-intersection-with-assignment",{assignment:Eo(e.label)}):S?n=this.s("graphing-calculator-narration-geometry-unlabeled-intersection",{index:e.id}):n=this.s("graphing-calculator-narration-geometry-intersection-with-assignment",{assignment:k}),o=L[0],s=L[1],g=this.getGeoTokenInfoFromIdentifier(O[0]),b=this.getGeoTokenInfoFromIdentifier(O[1]),r.includeDetails&&typeof o=="number"&&typeof s=="number"&&g!==void 0&&b!==void 0?P.push(this.s("graphing-calculator-narration-geometry-item-at-coordinates-and-intersection",{itemDescription:n,parent1:g.description,parent2:b.description,x:Xi(this,o),y:Qi(this,s)})):P.push(n);break}else if(V==="midpoint"){e.label!==void 0&&e.label!==""?n=this.s("graphing-calculator-narration-geometry-midpoint-with-assignment",{assignment:Eo(e.label)}):S?n=this.s("graphing-calculator-narration-geometry-unlabeled-midpoint",{index:e.id}):n=this.s("graphing-calculator-narration-geometry-midpoint-with-assignment",{assignment:k}),o=L[0],s=L[1],g=this.getGeoTokenInfoFromIdentifier(O[0]),r.includeDetails&&typeof o=="number"&&typeof s=="number"&&g!==void 0?P.push(this.s("graphing-calculator-narration-geometry-item-at-coordinates-and-parent",{itemDescription:n,parent:g.description,x:Xi(this,o),y:Qi(this,s)})):P.push(n);break}else if(V==="glider"){e.label!==void 0&&e.label!==""?n=this.s("graphing-calculator-narration-geometry-glider-with-assignment",{assignment:Eo(e.label)}):S?n=this.s("graphing-calculator-narration-geometry-unlabeled-glider",{index:e.id}):n=this.s("graphing-calculator-narration-geometry-glider-with-assignment",{assignment:k}),o=L[0],s=L[1],r.includeDetails&&typeof o=="number"&&typeof s=="number"?P.push(this.s("graphing-calculator-narration-geometry-item-at-coordinates",{itemDescription:n,x:Xi(this,o),y:Qi(this,s)})):P.push(n);break}else e.label!==void 0&&e.label!==""?n=this.s("graphing-calculator-narration-geometry-point-with-assignment",{assignment:Eo(e.label)}):S?n=this.s("graphing-calculator-narration-geometry-unlabeled-point",{index:e.id}):n=this.s("graphing-calculator-narration-geometry-point-with-assignment",{assignment:k});o=L[0],s=L[1],r.includeDetails&&typeof o=="number"&&typeof s=="number"?P.push(this.s("graphing-calculator-narration-geometry-item-at-coordinates",{itemDescription:n,x:Xi(this,o),y:Qi(this,s)})):P.push(n);break;case __dcg_shared_module_exports__['db']:S?n=this.s("graphing-calculator-narration-geometry-unlabeled-circle",{index:e.id}):n=this.s("graphing-calculator-narration-geometry-circle-with-assignment",{assignment:k}),o=($=L[0])==null?void 0:$[0],s=(U=L[0])==null?void 0:U[1],u=L[1],r.includeDetails&&E&&typeof o=="number"&&typeof s=="number"&&typeof u=="number"?P.push(this.s("graphing-calculator-narration-geometry-item-at-coordinates-with-radius",{itemDescription:n,x:Xi(this,o),y:Qi(this,s),radius:fs(__dcg_shared_module_exports__['Bb'](u,E.xmax-E.xmin).latex)})):P.push(n);break;case __dcg_shared_module_exports__['fb']:S?n=this.s("graphing-calculator-narration-geometry-unlabeled-arc",{index:e.id}):n=this.s("graphing-calculator-narration-geometry-arc-with-assignment",{assignment:k}),o=(J=L[0])==null?void 0:J[0],s=(R=L[0])==null?void 0:R[1],a=(q=L[1])==null?void 0:q[0],l=(_=L[1])==null?void 0:_[1],c=(A=L[2])==null?void 0:A[0],d=(z=L[2])==null?void 0:z[1],r.includeDetails&&typeof o=="number"&&typeof s=="number"&&typeof a=="number"&&typeof l=="number"&&typeof c=="number"&&typeof d=="number"?P.push(this.s("graphing-calculator-narration-geometry-item-at-coordinates-with-middle-and-end",{itemDescription:n,x1:Xi(this,o),y1:Qi(this,s),x2:Xi(this,a),y2:Qi(this,l),x3:Xi(this,c),y3:Qi(this,d)})):P.push(n);break;case __dcg_shared_module_exports__['$a']:p===-1&&(p=L.length),p===3?S?n=this.s("graphing-calculator-narration-geometry-unlabeled-triangle",{index:e.id}):n=this.s("graphing-calculator-narration-geometry-triangle-with-assignment",{assignment:k}):p===4?S?n=this.s("graphing-calculator-narration-geometry-unlabeled-quadrilateral",{index:e.id}):n=this.s("graphing-calculator-narration-geometry-quadrilateral-with-assignment",{assignment:k}):S?n=this.s("graphing-calculator-narration-geometry-unlabeled-polygon",{index:e.id,sideCount:p}):n=this.s("graphing-calculator-narration-geometry-polygon-with-assignment",{assignment:k,sideCount:p}),r.polygonEdge!==void 0?(o=(Q=L[0])==null?void 0:Q[0],s=(fe=L[0])==null?void 0:fe[1],a=(ie=L[1])==null?void 0:ie[0],l=(Le=L[1])==null?void 0:Le[1],r.includeDetails&&typeof o=="number"&&typeof s=="number"&&typeof a=="number"&&typeof l=="number"?P.push(this.s("graphing-calculator-narration-geometry-item-at-coordinates-to-coordinates",{itemDescription:n,x1:Xi(this,o),y1:Qi(this,s),x2:Xi(this,a),y2:Qi(this,l)})):P.push(n)):(o=(pe=L[0])==null?void 0:pe[0],s=(ae=L[0])==null?void 0:ae[1],r.includeDetails&&typeof o=="number"&&typeof s=="number"?P.push(this.s("graphing-calculator-narration-geometry-item-at-coordinates",{itemDescription:n,x:Xi(this,o),y:Qi(this,s)})):P.push(n));break;case __dcg_shared_module_exports__['hb']:case __dcg_shared_module_exports__['jb']:case __dcg_shared_module_exports__['bb']:V==="parallel"?S?n=this.s("graphing-calculator-narration-geometry-unlabeled-parallel",{index:e.id}):n=this.s("graphing-calculator-narration-geometry-parallel-with-assignment",{assignment:k}):V==="perpendicular"?S?n=this.s("graphing-calculator-narration-geometry-unlabeled-perpendicular",{index:e.id}):n=this.s("graphing-calculator-narration-geometry-perpendicular-with-assignment",{assignment:k}):y===__dcg_shared_module_exports__['hb']?S?n=this.s("graphing-calculator-narration-geometry-unlabeled-line",{index:e.id}):n=this.s("graphing-calculator-narration-geometry-line-with-assignment",{assignment:k}):y===__dcg_shared_module_exports__['jb']?S?n=this.s("graphing-calculator-narration-geometry-unlabeled-ray",{index:e.id}):n=this.s("graphing-calculator-narration-geometry-ray-with-assignment",{assignment:k}):y===__dcg_shared_module_exports__['bb']&&(S?n=this.s("graphing-calculator-narration-geometry-unlabeled-segment",{index:e.id}):n=this.s("graphing-calculator-narration-geometry-segment-with-assignment",{assignment:k})),o=(ye=L[0])==null?void 0:ye[0],s=(H=L[0])==null?void 0:H[1],a=(ge=L[1])==null?void 0:ge[0],l=(Se=L[1])==null?void 0:Se[1],g=this.getGeoTokenInfoFromIdentifier(O[0]),b=this.getGeoTokenInfoFromIdentifier(O[1]),(V==="parallel"||V==="perpendicular")&&r.includeDetails&&typeof o=="number"&&typeof s=="number"&&typeof a=="number"&&typeof l=="number"&&g!==void 0&&b!==void 0?P.push(this.s("graphing-calculator-narration-geometry-item-to-line-passing-through-point-at-coordinates-to-coordinates",{itemDescription:n,parent1:g.description,parent2:b.description,x1:Xi(this,o),y1:Qi(this,s),x2:Xi(this,a),y2:Qi(this,l)})):r.includeDetails&&typeof o=="number"&&typeof s=="number"&&typeof a=="number"&&typeof l=="number"?P.push(this.s("graphing-calculator-narration-geometry-item-at-coordinates-to-coordinates",{itemDescription:n,x1:Xi(this,o),y1:Qi(this,s),x2:Xi(this,a),y2:Qi(this,l)})):P.push(n);break;case __dcg_shared_module_exports__['lb']:case __dcg_shared_module_exports__['nb']:let qe="",At=(Ke=this.getGrapher())==null?void 0:Ke.getGraphSketch(e.id);if(At&&"labels"in At){let Fe=At.labels;Fe.length>0&&"text"in Fe[0]&&(qe=Eo(Fe[0].text))}y===__dcg_shared_module_exports__['lb']?/^\$/.test(k)?qe!==""?n=this.s("graphing-calculator-narration-geometry-unlabeled-angle-with-measurement",{measurementText:qe}):n=this.s("graphing-calculator-narration-geometry-unlabeled-angle",{index:e.id}):qe!==""?n=this.s("graphing-calculator-narration-geometry-angle-with-measurement-and-assignment",{measurementText:qe,assignment:k}):n=this.s("graphing-calculator-narration-geometry-angle-with-assignment",{assignment:k}):y===__dcg_shared_module_exports__['nb']&&(/^\$/.test(k)?qe!==""?n=this.s("graphing-calculator-narration-geometry-unlabeled-directed-angle-with-measurement",{measurementText:qe}):n=this.s("graphing-calculator-narration-geometry-unlabeled-directed-angle",{index:e.id}):qe!==""?n=this.s("graphing-calculator-narration-geometry-directed-angle-with-measurement-and-assignment",{measurementText:qe,assignment:k}):n=this.s("graphing-calculator-narration-geometry-directed-angle-with-assignment",{assignment:k})),o=(Ae=L[0])==null?void 0:Ae[0],s=(Ze=L[0])==null?void 0:Ze[1],O.length&&(g=this.getGeoTokenInfoFromIdentifier(O[0]),b=this.getGeoTokenInfoFromIdentifier(O[1]),x=this.getGeoTokenInfoFromIdentifier(O[2])),r.includeDetails&&typeof o=="number"&&typeof s=="number"?g!==void 0&&b!==void 0&&x!==void 0?P.push(this.s("graphing-calculator-narration-geometry-angle-at-coordinates-through-points",{itemDescription:n,x1:Xi(this,o),y1:Qi(this,s),parent1:g.description,parent2:b.description,parent3:x.description})):g!==void 0?P.push(this.s("graphing-calculator-narration-geometry-angle-of-polygon-at-coordinates",{itemDescription:n,parent:g.description,x:Xi(this,o),y:Qi(this,s)})):P.push(this.s("graphing-calculator-narration-geometry-item-at-coordinates",{itemDescription:n,x:Xi(this,o),y:Qi(this,s)})):P.push(n);break;default:P.push(this.s("graphing-calculator-narration-geometry-item-unknown"))}let K=P.join(" ");if(V==="apply"&&typeof O[0]=="string"){let qe="",At=this.getItemsByIdentifier(O[0]);for(let Fe of At){if(Fe.type!=="expression")continue;let Lt=Fe.formula.geometry;if(!(!Lt||!Lt.call)){qe=Lt.call.symbol;break}}qe==="dilate"?K=this.s("graphing-calculator-narration-geometry-dilated-item",{item:K}):qe==="rotate"?K=this.s("graphing-calculator-narration-geometry-rotated-item",{item:K}):qe==="translate"?K=this.s("graphing-calculator-narration-geometry-translated-item",{item:K}):qe==="reflect"?K=this.s("graphing-calculator-narration-geometry-reflected-item",{item:K}):K=this.s("graphing-calculator-narration-geometry-transformed-item",{item:K})}return r.listIndex!==void 0&&(K=this.s("graphing-calculator-narration-geometry-item-with-list-index",{listIndex:r.listIndex,item:K})),r.polygonEdge!==void 0&&(K=this.s("graphing-calculator-narration-geometry-edge-of-polygon",{polygonEdge:r.polygonEdge+1,item:K})),r.includeSelectionState&&(K=this.isItemSelected(e.id)?this.s("shared-calculator-narration-item-selected",{item:K}):this.s("shared-calculator-narration-item-unselected",{item:K})),K}isDispatching(){return this.dispatcher.isDispatching()}getSuggestedIdentifierRenameInfo(e){if(this.suggestedIdentifierRename&&this.suggestedIdentifierRename.id===e)return this.suggestedIdentifierRename}updateSuggestedIdentifierRenameInfo(){if(!this.shouldShowAuthorFeatures())return;let e=this.lastUserUpdatedExpressionItem;if(!e){this.suggestedIdentifierRename=void 0;return}this.suggestedIdentifierRename&&this.suggestedIdentifierRename.id!==e.id&&(this.suggestedIdentifierRename=void 0);var r=e.formula.assignment||"",i=r?__dcg_shared_module_exports__['Hb'](r):"";if(!this.suggestedIdentifierRename){i&&(this.suggestedIdentifierRename={id:e.id,from:i,to:i,countOfChanges:0});return}if(i!==this.suggestedIdentifierRename.to){if(this.suggestedIdentifierRename.to=i,this.suggestedIdentifierRename.from===this.suggestedIdentifierRename.to||!this.suggestedIdentifierRename.from||!this.suggestedIdentifierRename.to){this.suggestedIdentifierRename.countOfChanges=0;return}if(this.countIdentifierAssignments(r)>1){this.suggestedIdentifierRename.countOfChanges=0;return}var n=this.countGlobalIdentifierOccurences(this.suggestedIdentifierRename.from);this.suggestedIdentifierRename.countOfChanges=n}}getMathquillConfig(e){let r=e.additionalOperators||[];return{autoOperatorNames:da({additionalOperators:r,includeGeometryFunctions:this.isGeometry(),include3DFunctions:this.is3D()}),autoCommands:Kc({additionalCommands:this.isGeometry()?[]:["int"],disallowAns:this.isGeometry()}),logAriaAlerts:!!oo().logAria}}constrainMultiSelect(){if(this.isMultiSelectEnabled())return;let e=xC(this.listModel);e.length>1&&ri(this.listModel,e[0])}};function cB(t){return t&&__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},t),{wasCompleteSetState:void 0,layoutModel:void 0,settingsViewModel:void 0})}function C$(t,e){return __dcg_shared_module_exports__['F'](cB(t),cB(e))}var Um=__dcg_shared_module_exports__['i'](Z());Oe();var Ub=class{constructor(e){this.controller=e}handleKeydown(e){let r=ei(e);if(Lp(e))e.stopPropagation(),e.preventDefault(),this.controller.hasVisibleAndUndoableToast()?this.controller.toastUndo():this.controller.dispatch({type:"undo"});else if(Pp(e))e.stopPropagation(),e.preventDefault(),this.controller.dispatch({type:"redo"});else if(e.altKey&&!e.ctrlKey&&!e.metaKey&&e.shiftKey&&r==="Z"){let i=this.controller.getSelectedItem();i&&i.id&&(e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"expression-zoom-fit",id:i.id,focusAfterTap:!1}))}else if(e.altKey!==Zr&&e.metaKey===Zr&&!e.ctrlKey&&e.shiftKey&&r==="A"&&this.controller.isDecimalToFractionEnabled()){let i=this.controller.getSelectedItem();i&&i.type==="expression"&&(e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"toggle-fraction-evaluation",id:i.id}),this.controller.runAfterDispatch(()=>{_h(i)?me(this.controller.s("shared-calculator-narration-show-as-fraction")):me(this.controller.s("shared-calculator-narration-show-as-decimal"))}))}else if(!e.altKey&&e.ctrlKey!==Zr&&e.metaKey===Zr&&r==="F"){if(this.controller.isExpressionListFocused()){let i=Xe.getFocusedMathquill(),n="";try{n=i.__controller.cursor.selection.join("latex")||""}catch(o){}this.controller.dispatch({type:"open-expression-search",rename:!!e.shiftKey,latex:n}),e.preventDefault(),e.stopPropagation()}}else if((e.altKey||e.metaKey)&&!e.ctrlKey&&!e.shiftKey&&r===void 0){if(Te(e)===Jn){let i=this.controller.getSelectedItem();i&&i.type==="folder"&&(e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"set-folder-collapsed",id:i.id,isCollapsed:!0}),me(this.controller.s("graphing-calculator-narration-folder-collapsed")))}else if(Te(e)===Yn){let i=this.controller.getSelectedItem();i&&i.type==="folder"&&(e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"set-folder-collapsed",id:i.id,isCollapsed:!1}),me(this.controller.s("graphing-calculator-narration-folder-expanded")))}}else if(e.shiftKey&&(e.altKey||e.metaKey)&&!e.ctrlKey){if(Te(e)===Jn)e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"set-all-folders-collapsed",isCollapsed:!0}),me(this.controller.s("graphing-calculator-narration-all-folders-collapsed"));else if(Te(e)===Yn)e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"set-all-folders-collapsed",isCollapsed:!1}),me(this.controller.s("graphing-calculator-narration-all-folders-expanded"));else if(r==="E"){if(!this.controller.isListEnabled())return;this.controller.isListVisible()?(this.controller.dispatch({type:"hide-expressions-list",focusShowIcon:!1}),me(this.controller.s("graphing-calculator-narration-hide-expression-list"))):(this.controller.dispatch({type:"show-expressions-list",focusHideIcon:!1}),this.focusExpressionList()),e.preventDefault(),e.stopPropagation()}}else if(e.ctrlKey&&(e.altKey||e.metaKey)&&!e.shiftKey){if(r==="E"){if(!this.controller.isListEnabled())return;e.preventDefault(),e.stopPropagation(),this.focusExpressionList()}else if(r==="X"){if(!this.controller.isListEnabled())return;e.preventDefault(),e.stopPropagation(),this.controller.canUserAddExpressions()?(me(this.controller.s("graphing-calculator-narration-add-expression")),this.controller.dispatch({type:"new-expression"})):me(this.controller.s("graphing-calculator-narration-unable-to-add-expression"))}else if(r==="O"){if(!this.controller.isListEnabled())return;e.preventDefault(),e.stopPropagation(),this.controller.canUserAddExpressions()&&this.controller.areNotesEnabled()?(me(this.controller.s("graphing-calculator-narration-add-note")),this.controller.dispatch({type:"new-text"})):me(this.controller.s("graphing-calculator-narration-unable-to-add-note"))}else if(r==="F"&&this.controller.canUserAddExpressions()&&this.controller.areFoldersEnabled())e.preventDefault(),e.stopPropagation(),me(this.controller.s("graphing-calculator-narration-add-folder")),this.controller.dispatch({type:"new-folder"});else if(r==="I"&&this.controller.canUserAddExpressions()&&this.controller.areImagesEnabled())e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"toggle-add-expression",focusOnOpen:!1}),this.controller.runAfterDispatch(()=>{this.controller.find$(".dcg-add-expression-container input[type=file]").trigger("click"),me(this.controller.s("graphing-calculator-narration-add-image"))});else if(r==="T")e.preventDefault(),e.stopPropagation(),this.controller.canUserAddExpressions()?(me(this.controller.s("graphing-calculator-narration-add-table")),this.controller.dispatch({type:"new-table"})):me(this.controller.s("graphing-calculator-narration-unable-to-add-table"));else if(r==="M"&&this.controller.isGeoUIActive()){e.preventDefault(),e.stopPropagation();let i=this.controller.getActiveTool();i==="box-selection"&&this.controller.hasAnyItemsSelected()?this.controller.dispatch({type:"set-focus-location",location:{type:"geo-header-back-link"}}):(i==="expression-edit"&&(i="selection"),this.controller.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool",tool:i}}))}else if(r==="C"&&this.controller.isGeoUIActive())e.preventDefault(),e.stopPropagation(),this.controller.getGeometryTokenCount()>0?this.controller.dispatch({type:"set-show-constructions-open",open:!0,setFocus:!0}):me(this.controller.raw("Object navigator has no items."));else if(r==="G")e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"toggle-graph-settings",focusOnOpen:!0});else if(r==="P"){e.preventDefault(),e.stopPropagation();let i;if(this.controller.isGeoUIActive()){this.controller.dispatch({type:"set-focus-location",location:{type:"graph-paper"}});return}else i=this.controller.find$(".dcg-tabbable-point, .dcg-tabbable-clickableobject, .dcg-tabbable-draggableimage").filter("[tabindex=0]"),i.length===0&&(i=this.controller.find$(".dcg-editable-label-border").find('input, textarea, [role="textbox"]'));this.focusElement(i.first(),this.controller.s("graphing-calculator-narration-no-interactive-points"))}else if(r==="Z"){let i=this.controller.getSelectedItem();i&&i.id&&this.controller.dispatch({type:"expression-zoom-fit",id:i.id,focusAfterTap:!1})}else if(r==="D"&&this.controller.canUserAddExpressions()){e.preventDefault(),e.stopPropagation();let i=!this.controller.isInEditListMode();this.controller.dispatch({type:"set-edit-list-mode",isEditListMode:i,focusExpressionList:!0})}}else if(!e.altKey&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey){if(Te(e)===Pa)(!document.activeElement||!Ih(I(document.activeElement)))&&e.preventDefault();else if(Te(e)===jn&&!this.controller.getOpenItemMenu()&&!this.controller.isGraphSettingsOpen()){if(this.controller.isGeoUIActive()){let i=!1,n=this.controller.getGeoModel();if(this.controller.hasAnyItemsSelected()&&(this.controller.dispatch({type:"set-none-selected"}),i=!0),n.isToolplayActive()&&(this.controller.dispatch({type:"cancel-geo-toolplay"}),me(this.controller.s("graphing-calculator-narration-geometry-tool-cancelled")),i=!0),this.controller.isGraphPaperFocused()&&(this.controller.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool",tool:this.controller.getActiveTool()}}),i=!0),this.controller.getActiveTool()!=="selection"&&!i){this.controller.dispatch({type:"select-geo-tool",tool:"selection"});let o=this.controller.getFocusLocation();o&&o.type==="geo-basic-tool"&&this.controller.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool",tool:this.controller.getActiveTool()}}),i=!0}if(i){e.preventDefault(),e.stopPropagation();return}}this.controller.isInEditListMode()&&this.controller.find$(".dcg-options-menu").length===0&&(e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"set-edit-list-mode",isEditListMode:!1,focusExpressionList:!0}))}}else if(!e.metaKey&&!e.shiftKey&&e.ctrlKey===Zr&&e.altKey===!Zr)if(r==="N"){if(!this.controller.getBrailleControls())return;e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"set-braille-mode",mode:"nemeth"}),me(this.controller.s("shared-calculator-narration-hotkey-braille-mode-nemeth"))}else if(r==="U"){if(!this.controller.getBrailleControls())return;e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"set-braille-mode",mode:"ueb"}),me(this.controller.s("shared-calculator-narration-hotkey-braille-mode-ueb"))}else if(r==="Q"||r==="X"){if(!this.controller.getBrailleControls())return;e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"set-braille-mode",mode:"none"}),me(this.controller.s("shared-calculator-narration-hotkey-braille-mode-off"))}else if(r==="6"){if(!this.controller.getBrailleControls())return;e.preventDefault(),e.stopPropagation();let i=!this.controller.getSixKeyInput();this.controller.dispatch({type:"set-six-key-input",useSixKeyInput:i}),me(i?this.controller.s("shared-calculator-narration-six-key-mode-on"):this.controller.s("shared-calculator-narration-six-key-mode-off"))}else r==="D"&&(e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"set-graph-settings",degreeMode:!this.controller.getGraphSettings().degreeMode}),me(this.controller.getGraphSettings().degreeMode?this.controller.s("graphing-calculator-button-settings-degrees"):this.controller.s("graphing-calculator-button-settings-radians")))}focusExpressionList(){let e=this.controller.getSelectedItem();e?this.controller.dispatch({type:"move-focus-to-item",id:e.id}):this.controller.dispatch({type:"focus-first-expression"})}focusElement(e,r){e.length?e.trigger("focus"):r&&me(r)}};Oe();function yT(){if(!document.activeElement)return;let t=I(document.activeElement);Ih(t)&&I("<input />").prependTo("body").trigger("focus").attr({readonly:"readonly",disabled:"true"}).trigger("blur").remove()}Oe();var D$=function(){{var t=0,e=1,r=2,i=!1,n=function(){o(document),i=!0},o=function(s){i||I(s).bind("touchstart",function(a){var l=I(a.target),c=t,d=null;if(!l.closest("[disablescroll]").length)for(;c===t&&l.length&&l[0].tagName!==void 0;){var u=l.css("overflow"),p=l.css("overflow-y");if(u!=="hidden"&&u!=="visible"&&p!=="hidden"&&p!=="hidden"){var g=l.scrollTop();g!==0&&(c=r),l.scrollTop(g+1),l.scrollTop()!==g&&(c=e|c,l.scrollTop(g))}l=l.parent()}if(c!==t){d=[];for(var b=a.originalEvent.touches,x=0;x<b.length;x++){var w={};for(var E in b[x])b[x].hasOwnProperty(E)&&(w[E]=b[x][E]);d.push(w)}}I(document).on("touchmove.scrollfix",function(k){if(d){var S=d[0],T=k.originalEvent.touches[0],V=T.screenY-S.screenY;(V>0&&!(c&r)||V<0&&!(c&e))&&(c=t),V&&(d=null)}c===t&&k.preventDefault()}),I(document).on("touchend.scrollfix",function(){I(document).off(".scrollfix")})})};return{limitScrollOnElement:o,limitScrollOnDocument:n}}}();var{limitScrollOnElement:ZD,limitScrollOnDocument:dB}=D$;var Jt=__dcg_shared_module_exports__['i'](Z());Oe();var vt=__dcg_shared_module_exports__['i'](Z());Oe();Oe();Oe();var hB=__dcg_shared_module_exports__['i'](Z());function S$(t){let e=I(t.target);return e.hasClass("dcg-exp-action-button")||e.hasClass("dcg-icon-duplicate")||e.hasClass("dcg-icon-remove")||e.hasClass("dcg-icon-lock")||e.hasClass("dcg-icon-pencil")}var $s=class extends hB.Class{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id,this._isFirstRender=!0,this._isDragCopy=this.props.isDragCopy()}onItemViewMounted(){this._isDragCopy||(this.model.dcgView=this),this._isFirstRender=!1}onItemViewUnmounted(){this._isDragCopy||(this.model.dcgView=void 0)}isFirstRender(){return this._isFirstRender}onMouseSelect(e){if(this.controller.isInEditListMode()&&!S$(e)){this.exitEditListMode();return}this.controller.isItemReadonly(this.id)||e.type==="dcg-tap"&&e.device==="mouse"||e.type==="dcg-tapstart"&&e.device==="touch"||e.wasHandled()||(e.handle(),this.controller.dispatch({type:"set-selected-id",id:this.id}))}onDragPending(e){this.controller.isItemReadonly(this.model.id)||this.props.onDragPending(e)}exitEditListMode(){this.controller.dispatch({type:"set-edit-list-mode",isEditListMode:!1,focusExpressionList:!0})}};var ws=__dcg_shared_module_exports__['i'](Z());var Qd=__dcg_shared_module_exports__['i'](Z());var ys=class extends Qd.Class{template(){return Qd.createElement(Pe,{tooltip:this.props.error,sticky:this.const(!0),gravity:this.props.gravity},Qd.createElement("div",{class:()=>({"dcg-tooltipped-error":!0,"dcg-white":this.props.isWhite&&this.props.isWhite(),"dcg-small":this.props.size&&this.props.size()==="small"})},Qd.createElement("i",{class:Qd.const("dcg-icon-error"),"aria-hidden":Qd.const("true")})))}};var Ko=__dcg_shared_module_exports__['i'](Z());var bs=__dcg_shared_module_exports__['i'](Z());var{If:eS}=bs.Components,cn=class extends bs.Class{template(){return bs.createElement("span",{class:()=>{var e,r,i;return{"dcg-do-not-blur":!0,"dcg-circular-icon":!0,"dcg-thick-outline":this.isThickOutline(),"dcg-white-icon":!!this.props.whiteIcon&&this.props.whiteIcon(),"dcg-hidden":this.isHidden(),"dcg-semi-transparent":this.props.semiTransparent&&this.props.semiTransparent(),"dcg-colored-icon":this.isColoredIcon(),"dcg-do-not-invert":(i=(r=(e=this.props).dontInvert)==null?void 0:r.call(e))!=null?i:!1,"dcg-has-background-image":this.hasBackgroundImage(),[this.iconModifier()]:this.iconModifier().length>0}},style:this.bindFn(this.getIconStyle)},bs.createElement(eS,{predicate:this.bindFn(this.hasBackgroundImage)},()=>bs.createElement("span",{class:bs.const("dcg-background-image"),style:()=>({"background-image":this.props.backgroundImage&&this.props.backgroundImage(),opacity:this.props.backgroundOpacity&&this.props.backgroundOpacity()})})),bs.createElement(eS,{predicate:()=>!!this.backgroundIcon()},()=>bs.createElement("i",{class:()=>({[this.backgroundIcon()]:!0,"dcg-layered-icon":!0}),style:()=>({opacity:this.backgroundOpacity()})})),bs.createElement(eS,{predicate:()=>!!this.primaryIcon()},()=>bs.createElement("i",{class:()=>({[this.primaryIcon()]:!0,"dcg-layered-icon":!0}),style:()=>({color:this.props.foregroundColor&&this.props.foregroundColor()})})),bs.createElement(eS,{predicate:()=>this.props.iconType()==="loading"},()=>bs.createElement("span",{class:bs.const("dcg-spinner")})))}isColoredIcon(){return!this.isThickOutline()&&!this.isHidden()&&!this.hasBackgroundImage()&&this.props.iconType()!=="loading"}iconModifier(){if(!this.props.iconModifier)return"";switch(this.props.iconModifier()){case"medium":return"dcg-modifier-size-medium";case"large":return"dcg-modifier-size-large";case"small":return"dcg-modifier-size-small";case"rotated":return"dcg-modifier-rotated";case"none":return""}}getIconStyle(){let e=!this.isHidden()&&this.props.backgroundColor?Fg(this.props.backgroundColor()):void 0;return e?{background:e}:{}}isHidden(){return this.props.iconType()==="hidden"}isThickOutline(){let e=this.props.iconType();return e==="folder"||e==="pause"||e==="play"||e==="fraction"||e==="action"||e==="metronome"}hasBackgroundImage(){return!!this.props.backgroundImage&&!this.isHidden()&&!!this.props.backgroundImage()}primaryIcon(){let e=this.props.iconType();switch(e){case"folder":return"dcg-icon-folder";case"pause":return"dcg-icon-pause";case"play":return"dcg-icon-play";case"polygon-dashed":case"polygon-dashed-filled":return"dcg-icon-polygon-dashed";case"polygon-dotted":case"polygon-dotted-filled":return"dcg-icon-polygon-dotted";case"polygon-default":case"polygon-default-filled":return"dcg-icon-polygon-solid";case"graph-dashed":case"parametric-dashed-filled":return"dcg-icon-parametric-dashed";case"graph-dotted":case"parametric-dotted-filled":return"dcg-icon-parametric-dotted";case"graph-default":case"parametric-default-filled":return"dcg-icon-parametric-solid";case"movable-vertical":return"dcg-icon-move-vertical";case"movable-both":return"dcg-icon-move";case"movable-horizontal":return"dcg-icon-move-horizontal";case"point-open":return"dcg-icon-open";case"point-cross":return"dcg-icon-cross";case"point-default":return"dcg-icon-point";case"table-points":case"table-points-and-lines":return"dcg-icon-points";case"table-lines":return"dcg-icon-lines-solid";case"shaded-inequality":case"inequality":return"dcg-icon-shaded-inequality-dash";case"check":return"dcg-icon-check";case"none":case"background":case"hidden":case"polygon-none-filled":case"parametric-none-filled":case"loading":return"";case"fraction":return"dcg-icon-fraction";case"boxplot":return"dcg-icon-boxplot";case"dotplot-cross":return"dcg-icon-dotplot-cross";case"dotplot-default":return"dcg-icon-dotplot-default";case"dotplot-open":return"dcg-icon-dotplot-open";case"histogram":return"dcg-icon-histogram";case"unfilled-distribution":case"filled-distribution":return"dcg-icon-distribution";case"action":return"dcg-icon-chevron-right";case"metronome":return"dcg-icon-metronome-2";case"arrow-right":return"dcg-icon-arrow-right";default:return e}}backgroundOpacity(){let e=this.backgroundIcon();return e==="dcg-icon-polygon-filled"||e==="dcg-icon-parametric-filled"||e==="dcg-icon-shaded-inequality-shade2"||e==="dcg-icon-distribution-fill"||e==="dcg-icon-histogram-fill"?.5:1}backgroundIcon(){let e=this.props.iconType();return e==="filled-distribution"?"dcg-icon-distribution-fill":e==="histogram"?"dcg-icon-histogram-fill":e==="polygon-dashed-filled"||e==="polygon-dotted-filled"||e==="polygon-default-filled"||e==="polygon-none-filled"?"dcg-icon-polygon-filled":e==="parametric-dashed-filled"||e==="parametric-dotted-filled"||e==="parametric-default-filled"||e==="parametric-none-filled"?"dcg-icon-parametric-filled":e==="table-points-and-lines"?"dcg-icon-lines-solid":e==="shaded-inequality"?"dcg-icon-shaded-inequality-shade2":e==="action"?"dcg-icon-minus":""}};var tS=class extends Ko.Class{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return Ko.createElement("div",{class:Ko.const("dcg-play-pause-icon-view")},Ko.createElement(Pe,{gravity:this.const("se"),tooltip:()=>this.controller.s("graphing-calculator-label-slider-disabled-while-ticker-playing"),disabled:()=>!this.controller.getTickerPlaying(),sticky:this.const(!0)},Ko.createElement("div",{class:()=>({"dcg-circular-icon-container":!0,"dcg-disabled":this.controller.getTickerPlaying()}),"aria-label":this.bindFn(this.getAriaLabel),role:Ko.const("button"),tabindex:Ko.const("0"),onTap:e=>{e.wasHandled("dragdrop")||this.toggleSliderIsPlaying()},manageFocus:this.const(yt({controller:this.controller,location:{type:"slider-icon",id:this.model.id}}))},Ko.createElement(cn,{iconType:()=>this.getIconType(),whiteIcon:()=>!this.controller.isInEditListMode()&&this.controller.isItemSelected(this.model.id)||this.controller.isItemBeingDragged(this.model.id)}))),Ko.createElement("div",{class:Ko.const("dcg-slider-menu-container")},Ko.createElement(Pe,{tooltip:()=>this.controller.s("graphing-calculator-label-animation-properties-tooltip"),gravity:this.const("e")},Ko.createElement("div",{class:()=>({"dcg-slider-menu-opener":!0,"dcg-menu-open":this.myOptionsOpen()}),tabindex:Ko.const(0),"dcg-open-menu-guid":()=>this.getMenuGUID(),role:Ko.const("button"),"aria-label":()=>this.myOptionsOpen()?this.controller.s("graphing-calculator-narration-hide-animation-properties"):this.controller.s("graphing-calculator-narration-show-animation-properties"),onTap:e=>{e.wasHandled("dragdrop")||e.wasLongheld()||this.toggleOptions(e)},manageFocus:this.const(yt({controller:this.controller,location:{type:"slider-animation-properties-icon",id:this.model.id}}))},Ko.createElement("i",{class:this.bindFn(this.getIcon),"aria-hidden":Ko.const("true")})))))}getIcon(){return __dcg_shared_module_exports__['Oa'](this.model.slider.loopMode)}getIconType(){return!this.model.slider.isPlaying||HV(this.model)?"play":"pause"}getMenuGUID(){return"slider-"+this.model.guid}myOptionsOpen(){return this.controller.isItemSettingsMenuOpen(this.getMenuGUID())}toggleOptions(e){this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"slider",model:this.model,guid:this.getMenuGUID(),focusFirstOption:e.device==="keyboard"}})}getAriaLabel(){if(!this.model.sliderExists)return"";var e=so(this.model);return e?this.model.slider.isPlaying?this.controller.s("graphing-calculator-narration-pause-variable-animation",{variable:e}):this.controller.s("graphing-calculator-narration-play-variable-animation",{variable:e}):""}toggleSliderIsPlaying(){if(this.model.sliderExists){var e="",r=so(this.model);HV(this.model)?(typeof r=="string"&&(e=this.controller.s("graphing-calculator-narration-slider-variable-restarted",{variable:r})),this.controller.dispatch({type:"play-slider-from-min",id:this.model.id})):this.model.slider.isPlaying?(typeof r=="string"&&(e=this.controller.s("graphing-calculator-narration-slider-variable-playing",{variable:r})),this.controller.dispatch({type:"set-slider-isplaying",id:this.model.id,isPlaying:!1})):(typeof r=="string"&&(e=this.controller.s("graphing-calculator-narration-slider-variable-paused",{variable:r})),this.controller.dispatch({type:"set-slider-isplaying",id:this.model.id,isPlaying:!0})),e!==""&&me(e)}}};var ld=__dcg_shared_module_exports__['i'](Z());var rS=class extends ld.Class{constructor(){super(...arguments),this.isAnimating=!1,this.unmounted=!1}init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return ld.createElement("div",{class:()=>({"dcg-action-icon-view":!0,"dcg-action-icon-view-animating":this.isAnimating})},ld.createElement("div",{class:ld.const("dcg-circular-icon-container"),"aria-label":()=>this.controller.s("graphing-calculator-narration-run-action-icon"),role:ld.const("button"),tabindex:ld.const("0"),onTap:e=>{e.wasHandled("dragdrop")||this.runActionOnce()},manageFocus:this.const(yt({controller:this.props.controller(),location:{type:"action-icon",id:this.model.id}}))},ld.createElement(cn,{iconType:this.const("action"),whiteIcon:()=>!this.controller.isInEditListMode()&&this.controller.isItemSelected(this.model.id)||this.controller.isItemBeingDragged(this.model.id)})))}willUnmount(){this.unmounted=!0}runActionOnce(){this.isAnimating=!0,this.controller.dispatch({type:"action-single-step",id:this.model.id}),setTimeout(()=>{this.isAnimating=!1,this.unmounted||this.update()},150)}};var{SwitchUnion:E$}=ws.Components,k$="#6A93D2",pB="#000",uB="#fff",qb=class extends ws.Class{init(){this.model=this.props.model(),this.controller=this.props.controller()}template(){return ws.createElement("div",{class:ws.const("dcg-expression-icon-container")},E$(this.bindFn(this.getIconMode),{error:()=>ws.createElement(ys,{error:this.bindFn(this.getErrorMsg),isWhite:this.bindFn(this.isSelected),gravity:this.const("se")}),none:()=>ws.createElement("span",null),slider:()=>ws.createElement(tS,{controller:this.props.controller,model:this.props.model}),action:()=>ws.createElement(rS,{controller:this.props.controller,model:this.props.model}),icon:()=>ws.createElement("div",{class:ws.const("dcg-circular-icon-container"),role:ws.const("button"),tabindex:ws.const("0"),"dcg-open-menu-guid":()=>this.getMenuGUID(),"aria-label":this.bindFn(this.getIconAriaLabel),onTap:e=>{if(!e.wasHandled("dragdrop")&&!e.wasLongheld()){if(this.myOptionsOpen())return this.toggleOptions(e);if((this.controller.isInEditListMode()||e.shiftKey)&&!this.isFraction())return this.toggleOptions(e);if(this.isFraction())return this.onToggleFractionDisplay();this.toggleGraphShown()}},onLongHold:e=>{e.handle("dcg-longhold"),e.handle("dcg-tap"),!this.isFraction()&&this.toggleOptions(e)},manageFocus:this.const(yt({controller:this.controller,location:{type:"expression-icon",id:this.model.id}}))},ws.createElement(cn,{iconType:this.bindFn(this.getIconType),backgroundColor:this.bindFn(this.getBackgroundColor),whiteIcon:this.bindFn(this.isSelected),foregroundColor:this.bindFn(this.getForegroundColor),iconModifier:this.bindFn(this.getIconModifier),backgroundImage:this.bindFn(this.backgroundImage),backgroundOpacity:this.const(1)}))}))}backgroundImage(){let e=this.getBackgroundColor();return e.type==="image"?`url("${e.value}")`:""}getErrorMsg(){return this.colorError()?this.controller.s("shared-calculator-error-color-not-assigned"):this.controller.unpack(this.model.error)}getMenuGUID(){return this.model.guid}myOptionsOpen(){return this.controller.isItemSettingsMenuOpen(this.getMenuGUID())}toggleOptions(e){this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"expression",model:this.model,guid:this.getMenuGUID(),focusFirstOption:e.device==="keyboard"}})}isSelected(){return this.controller.isItemSelected(this.model.id)||this.controller.isItemBeingDragged(this.model.id)}isFraction(){return this.controller.canDisplayEvaluationForItemAsFraction(this.model.id)}getIconMode(){return this.hasError()?"error":this.controller.getGraphSettings().config.graphpaper?pl(this.model)?"icon":this.hasSlider()?"slider":this.isFraction()?"icon":this.isNonemptyAction()?"action":"none":"none"}toggleGraphShown(){this.controller.dispatch({type:"toggle-item-hidden",id:this.model.id})}colorError(){return!!this.model.formula.rgb_value&&!this.model.formula.assignment}hasError(){return this.colorError()?!0:!!this.model.error&&!ua(this.model)&&this.controller.getBrailleMode()==="none"}hasSlider(){return!!this.model.sliderExists}isNonemptyAction(){return yg(this.model)}getDisplayProps(){let{points:e,lines:r,fill:i}=this.model;return __dcg_shared_module_exports__['pc'](this.model.formula.expression_type,{points:e,lines:r,fill:i})}getBackgroundColor(){if(!this.isFraction())return Iy(this.model);let e=this.isSelected();return this.controller.shouldEvaluationForItemDisplayAsFraction(this.model.id)?{type:"single-color",value:e?uB:pB}:{type:"single-color",value:""}}getForegroundColor(){if(!this.isFraction())return"";let e=this.isSelected(),r=this.controller.shouldEvaluationForItemDisplayAsFraction(this.model.id);return e!==r?uB:e?k$:pB}onToggleFractionDisplay(){this.controller.dispatch({type:"toggle-fraction-evaluation",id:this.model.id})}getIconModifier(){return Nh(this.model)&&Ld(this.model,"alignedAxis")==="y"?"rotated":"none"}getIconType(){if(this.isFraction())return"fraction";if(!this.model.shouldGraph)return"hidden";if(this.controller.isInEditListMode())return"none";let e=this.model.pointStyle,r=this.model.lineStyle,i=this.getDisplayProps(),n=this.model.formula;if(Nh(this.model))return"boxplot";if(Od(this.model)){if(this.model.pointStyle==="POINT")return"dotplot-default";if(this.model.pointStyle==="CROSS")return"dotplot-cross";if(this.model.pointStyle==="OPEN")return"dotplot-open"}if(Hp(this.model))return"histogram";if(Bh(this.model))return zc(this.model)?"filled-distribution":"unfilled-distribution";if(this.model.reconciledDragMode==="X")return"movable-horizontal";if(this.model.reconciledDragMode==="Y")return"movable-vertical";if(this.model.reconciledDragMode==="XY")return"movable-both";if(gl(this.model))return Ks(this.model)?e==="OPEN"?"point-open":e==="CROSS"?"point-cross":"point-default":i.lines&&i.points?"table-points-and-lines":i.lines?"table-lines":"table-points";let o=this.getDisplayProps().fill;if(qc(this.model))return o?i.lines?r==="DASHED"?"polygon-dashed-filled":r==="DOTTED"?"polygon-dotted-filled":"polygon-default-filled":"polygon-none-filled":i.lines?r==="DASHED"?"polygon-dashed":r==="DOTTED"?"polygon-dotted":"polygon-default":"none";if(Fh(this.model))return o?i.lines?r==="DASHED"?"parametric-dashed-filled":r==="DOTTED"?"parametric-dotted-filled":"parametric-default-filled":"parametric-none-filled":i.lines?r==="DASHED"?"graph-dashed":r==="DOTTED"?"graph-dotted":"graph-default":"none";var s=n.operator,a=__dcg_shared_module_exports__['Ob'][s].direction!==0,l=__dcg_shared_module_exports__['Ob'][s].inclusive===!1;return n.is_shade_between||!l&&a?"shaded-inequality":l&&!a?"inequality":l&&a?"shaded-inequality":r==="DASHED"?"graph-dashed":r==="DOTTED"?"graph-dotted":"graph-default"}getIconAriaLabel(){return this.isFraction()?_h(this.model)?this.controller.s("shared-calculator-narration-display-as-decimal"):this.controller.s("shared-calculator-narration-display-as-fraction"):this.myOptionsOpen()?this.controller.s("graphing-calculator-narration-hide-options"):this.controller.isInEditListMode()?this.controller.s("graphing-calculator-narration-show-options"):this.model.hidden?this.controller.s("graphing-calculator-narration-show-expression"):this.controller.s("graphing-calculator-narration-hide-expression")}};var Oi=__dcg_shared_module_exports__['i'](Z());var iS=__dcg_shared_module_exports__['i'](Z());var np=class extends iS.Class{template(){return iS.createElement("span",{class:()=>{var e,r;return{"dcg-color-swatch":!0,"dcg-color-evaluation":(r=(e=this.props).isEvaluation)==null?void 0:r.call(e),"dcg-light-color":qh(this.props.color(),this.props.invertSwatches())}},style:()=>({background:Fg(this.props.color())})})}};var{If:G$,SwitchUnion:V$}=Oi.Components;function I$(t,e){return __dcg_shared_module_exports__['Eb'](t,e)}var cu=class extends Oi.Class{init(){this.controller=this.props.controller()}template(){return Oi.createElement("div",{class:Oi.const("dcg-evaluation-container")},Oi.createElement("div",{didMount:e=>this.containerNode=e,class:()=>({"dcg-evaluation":!0,"dcg-do-blur":!0,"dcg-hidden":this.props.controller().isInEditListMode()}),handleEvent:Oi.const("true"),tabindex:()=>this.props.focusable()&&this.controller.getBrailleMode()==="none"?"0":"-1",onFocus:()=>{this.controller.getBrailleMode()==="none"&&this.evaluationNode&&this.onSelectEvaluation()},onBlur:()=>{this.controller.getBrailleMode()==="none"&&this.evaluationNode&&this.onUnselectEvaluation()},onTap:()=>{var e;return(e=this.containerNode)==null?void 0:e.focus()}},Oi.createElement(kn,__dcg_shared_module_exports__['b']({latex:this.bindFn(this.getBrailleEvaluation),ariaLabel:this.const(""),brailleShouldFocus:()=>{let e=this.controller.getFocusLocation();return!e||e.type!=="braille-output"?!1:e.id===this.props.id()},onBrailleInput:()=>{},isStatic:this.const(!0),onBrailleFocusedChanged:e=>{e?this.controller.dispatch({type:"set-focus-location",location:{type:"braille-output",id:this.props.id()}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"braille-output",id:this.props.id()}})}},ko(this.controller,{gravity:"sw"})),Oi.createElement("div",{class:Oi.const("dcg-evaluation-label-container")},Oi.createElement(G$,{predicate:()=>!!this.props.dependent()},()=>Oi.createElement(et,{latex:()=>__dcg_shared_module_exports__['Hb'](this.props.dependent()),config:this.const({})})),Oi.createElement("span",{class:Oi.const("dcg-equals")},Oi.createElement(et,{latex:this.const("="),config:this.const({})}))),Oi.createElement("span",{class:()=>({"dcg-text-selectable":this.getEvaluationType()!=="rgbcolor","dcg-evaluation-html":!0,"dcg-color-evaluation":this.getEvaluationType()==="rgbcolor"}),didMount:this.bindFn(this.didMountEvaluation)},V$(()=>this.getEvaluationType(),{list:()=>Oi.createElement("span",{class:Oi.const("dcg-evaluation-list")},()=>this.controller.s("graphing-calculator-label-evaluation-list",{count:this.props.val().length})),fraction:()=>Oi.createElement(et,{latex:()=>__dcg_shared_module_exports__['Gb'](this.props.val(),this.getLabelOptions()),config:this.const({})}),undefined:()=>Oi.createElement("span",null,Oi.const("undefined")),scientific:()=>Oi.createElement(et,{latex:()=>`${this.getNumberLabel().mantissa}\\times10^{${this.getNumberLabel().exponent}}`,config:this.const({})}),decimal:()=>Oi.createElement(et,{latex:()=>this.getNumberLabel().value,config:this.const({})}),rgbcolor:()=>Oi.createElement(np,{color:()=>this.getColorValue(),isEvaluation:this.const(!0),invertSwatches:()=>this.controller.invertSwatches()})})))),Oi.createElement("div",{class:Oi.const("dcg-clear")}))}getColorValue(){let e=this.props.id(),r=this.controller.getColorById(e);return Array.isArray(r)?{type:"color-array",value:r}:{type:"single-color",value:r}}getNumberLabel(){return I$(this.props.val(),this.getLabelOptions())}getEvaluationType(){let e=this.props.val();return typeof e=="string"?"rgbcolor":Array.isArray(e)?typeof e[0]=="string"?"rgbcolor":"list":this.getNumberLabel().type}getLabelOptions(){return this.props.controller().getEvaluationLabelOptionsForItem(this.props.id())}didMountEvaluation(e){this.evaluationNode=e}onSelectEvaluation(){let e=document.createRange();e.selectNodeContents(this.evaluationNode);let r=window.getSelection();r&&(r.removeAllRanges(),r=window.getSelection(),r&&r.addRange(e))}onUnselectEvaluation(){let e=window.getSelection();e&&e.removeAllRanges()}getBrailleEvaluation(){let e="";this.props.dependent()&&(e=__dcg_shared_module_exports__['Hb'](this.props.dependent())),e+="=";let r=this.getEvaluationType();switch(r){case"list":e+=this.controller.s("graphing-calculator-label-evaluation-list",{count:this.props.val().length});break;case"fraction":e+=__dcg_shared_module_exports__['Gb'](this.props.val(),this.getLabelOptions());break;case"undefined":e="undefined";break;case"scientific":e+=`${this.getNumberLabel().mantissa}\\times10^{${this.getNumberLabel().exponent}}`;break;case"decimal":e+=this.getNumberLabel().value;break;case"rgbcolor":e+=this.props.val();break;default:return r}return e}};var ja=__dcg_shared_module_exports__['i'](Z()),Hb=class extends ja.Class{template(){return this.controller=this.props.controller(),ja.createElement("div",{class:ja.const("dcg-unresolved")},ja.createElement("i",{class:ja.const("dcg-icon-error"),"aria-hidden":ja.const("true")}),ja.const("\xA0"),()=>this.controller.s("graphing-calculator-error-equation-contains-unresolved-details"),ja.createElement("a",{href:ja.const("https://help.desmos.com/hc/en-us/articles/202529079-Unresolved-Detail-In-Plotted-Functions"),target:ja.const("_blank")},()=>this.controller.s("graphing-calculator-link-learn-more")))}};var Ws=__dcg_shared_module_exports__['i'](Z());Oe();Wl();var xa=__dcg_shared_module_exports__['i'](Z());var{SwitchUnion:M$}=xa.Components,lr=class extends xa.Class{init(){this.controller=this.props.controller()}template(){return xa.createElement("div",{class:this.bindFn(this.getContainerClass)},M$(()=>String(this.props.readonly()),{true:()=>xa.createElement(kn,__dcg_shared_module_exports__['b']({latex:this.bindFn(this.getStaticLatex),brailleShouldFocus:this.props.isFocused,isStatic:this.const(!0),onBrailleFocusedChanged:this.props.handleFocusChanged,ariaLabel:this.bindFn(this.getBrailleLabel),dataLabelAttributeValue:this.props.dataLabelAttributeValue},ko(this.props.controller())),xa.createElement(et,{latex:this.bindFn(this.getStaticLatex),config:this.bindFn(this.getMQConfig),getAriaLabel:this.props.ariaLabel},xa.createElement("span",{class:xa.const("dcg-math-field"),"data-dcg-label":()=>this.props.dataLabelAttributeValue?this.props.dataLabelAttributeValue():void 0,manageFocus:this.const({shouldBeFocused:()=>this.props.isFocused(),onFocusedChanged:(e,r)=>this.props.handleFocusChanged(e,r)}),tabindex:xa.const("0")}))),false:()=>xa.createElement(kn,__dcg_shared_module_exports__['b']({latex:this.props.latex,brailleShouldFocus:this.props.isFocused,selectOnFocus:this.const(!0),onBrailleInput:this.props.handleLatexChanged,onBrailleFocusedChanged:this.props.handleFocusChanged,onBrailleKeydown:this.bindFn(this.onBrailleKeydown),hasError:this.props.hasError,placeholder:this.props.placeholder,ariaLabel:this.bindFn(this.getBrailleLabel),dataLabelAttributeValue:this.props.dataLabelAttributeValue},ko(this.props.controller())),xa.createElement(Xe,{latex:this.props.latex,getAriaPostLabel:()=>{var r,i;let e=((i=(r=this.props).ariaPostLabel)==null?void 0:i.call(r))||"";return this.props.hasError()&&e===""&&(e=this.controller.s("shared-calculator-narration-math-input-error-message")),e},isFocused:this.props.isFocused,placeholder:this.props.placeholder,capExpressionSize:()=>this.controller.getCapExpressionSize(),selectOnFocus:this.const(!0),config:this.bindFn(this.getMQConfig),getAriaLabel:this.props.ariaLabel,hasError:this.props.hasError,dataLabelAttributeValue:this.props.dataLabelAttributeValue,onUserPressedKey:this.props.handlePressedKey,onUserChangedLatex:this.props.handleLatexChanged,onExpressionSizeExceeded:()=>this.controller.dispatch({type:"expression-size-exceeded"}),onFocusedChanged:this.props.handleFocusChanged,needsSystemKeypad:()=>!this.controller.isKeypadEnabled()}))}))}getStaticLatex(){return this.props.latex()?this.props.latex():this.props.placeholder?this.props.placeholder():""}getContainerClass(){let e=this.props.containerClass?this.props.containerClass():{};return e["dcg-inline-math-input-view"]=!0,this.props.fullWidth&&this.props.fullWidth()&&(e["dcg-full-width-inline-math-input"]=!0),this.props.fontSize&&this.props.fontSize()==="large"&&(e["dcg-large-font-inline-math-input"]=!0),this.props.noBorder&&this.props.noBorder()&&(e["dcg-no-border-inline-math-input"]=!0),e}onBrailleKeydown(e){if(!this.props.handlePressedKey)return;let r=Te(e);r&&this.props.handlePressedKey(r,e)}getMQConfig(){return this.controller.getMathquillConfig({})}getBrailleLabel(){return this.props.brailleLabel?this.props.brailleLabel():this.props.ariaLabel()}};var du=class extends Ws.Class{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id,this.props.parameter!==void 0&&(this.parameter=this.props.parameter())}template(){return Ws.createElement("div",{class:Ws.const("dcg-domain dcg-do-blur"),handleEvent:Ws.const("true")},Ws.createElement("div",{class:Ws.const("dcg-display-domain dcg-do-blur"),handleEvent:Ws.const("true")},Ws.createElement(lr,{readonly:()=>this.controller.isItemReadonly(this.id),latex:()=>this.getMinLatex(),isFocused:()=>this.getFocusedInput()==="min"+this.getDomainVariable(),placeholder:()=>__dcg_shared_module_exports__['Bb'](RP(this.model)).latex,ariaLabel:()=>this.controller.s("graphing-calculator-narration-domain3d-minimum",{term:this.getDomainVariable()}),brailleLabel:()=>this.controller.raw("dmin"),handleFocusChanged:e=>this.handleFocusedChanged("min"+this.getDomainVariable(),e),hasError:()=>!BP(this.model,this.getDomainVariable()),controller:this.props.controller,handlePressedKey:(e,r)=>this.handlePressedKey("min"+this.getDomainVariable(),e,r),handleLatexChanged:e=>this.dispatchMinLatexIfChanged(e),dataLabelAttributeValue:this.const("domain-min")}),Ws.createElement("span",{class:Ws.const("dcg-interval-interior")},Ws.createElement(et,{latex:()=>this.getDomainVariableLatex(),config:this.const({})})),Ws.createElement(lr,{readonly:()=>this.controller.isItemReadonly(this.id),latex:()=>this.getMaxLatex(),isFocused:()=>this.getFocusedInput()==="max"+this.getDomainVariable(),placeholder:()=>__dcg_shared_module_exports__['Bb'](NP(this.model,this.getDomainVariable())).latex,ariaLabel:()=>this.controller.s("graphing-calculator-narration-domain3d-maximum",{term:this.getDomainVariable()}),brailleLabel:()=>this.controller.raw("dmax"),handleFocusChanged:e=>this.handleFocusedChanged("max"+this.getDomainVariable(),e),hasError:()=>!KP(this.model,this.getDomainVariable()),controller:this.props.controller,handlePressedKey:(e,r)=>this.handlePressedKey("max"+this.getDomainVariable(),e,r),handleLatexChanged:e=>this.dispatchMaxLatexIfChanged(e),dataLabelAttributeValue:this.const("domain-max")})))}handlePressedKey(e,r,i){if(!this.controller.isInEditListMode()){if(r==="Esc"){this.controller.dispatch({type:"set-focus-location",location:void 0});return}if(r==="Enter")return this.controller.dispatch({type:"on-special-key-pressed",key:"Enter"})}let n=Xe.getFocusedMathquill(),o=zs();if(r==="Left"||r==="Right"||r==="Down"||r==="Up"){var s;n?s=Xe.applyArrowKeyAndReturnIfWasAtBounds(n,r,i):o&&(o.selectionStart===0&&r==="Left"||o.selectionStart===I(o).val().length&&r==="Right"||r==="Up"||r==="Down")?s=!0:s=!1,s&&(i&&i.preventDefault(),r==="Left"?e==="max"+this.getDomainVariable()&&this.controller.dispatch({type:"set-focus-location",location:{type:"domain-limit",id:this.model.id,location:"min"+this.getDomainVariable()}}):r==="Right"?e==="min"+this.getDomainVariable()&&this.controller.dispatch({type:"set-focus-location",location:{type:"domain-limit",id:this.model.id,location:"max"+this.getDomainVariable()}}):r==="Down"?this.controller.dispatch({type:"on-special-key-pressed",key:"Down"}):r==="Up"&&this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:this.model.id}}));return}n&&(n.keystroke(r,i),e==="min"+this.getDomainVariable()?this.dispatchMinLatexIfChanged(n.latex()):e==="max"+this.getDomainVariable()&&this.dispatchMaxLatexIfChanged(n.latex()))}handleFocusedChanged(e,r){r?this.controller.dispatch({type:"set-focus-location",location:{type:"domain-limit",id:this.id,location:e}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"domain-limit",id:this.id,location:e}})}dispatchMinLatexIfChanged(e){if(this.getMinLatex()!==e){if(this.getDomainType()==="unknown"){Co("DomainView is in use for a non-parametric, non-polar expression",{severity:"error",metaData:{expression:Bp(this.model,{stripDefaults:!0})}});return}let i=this.setMinCommand();i!==void 0&&this.controller.dispatch({type:i,id:this.id,latex:e})}}setMinCommand(){switch(this.getDomainType()){case"polar":return"set-polar-domain-minlatex";case"parametric":return"set-parametric-domain-minlatex";case"parametric-uv":return this.getDomainVariable()==="u"||this.getDomainVariable()==="r"&&pa(this.model)||this.getDomainVariable()==="\\theta"&&Ua(this.model)?"set-parametric-domain3Du-minlatex":"set-parametric-domain3Dv-minlatex"}}setMaxCommand(){switch(this.getDomainType()){case"polar":return"set-polar-domain-maxlatex";case"parametric":return"set-parametric-domain-maxlatex";case"parametric-uv":return this.getDomainVariable()==="u"||this.getDomainVariable()==="r"&&pa(this.model)||this.getDomainVariable()==="\\theta"&&Ua(this.model)?"set-parametric-domain3Du-maxlatex":"set-parametric-domain3Dv-maxlatex"}}dispatchMaxLatexIfChanged(e){if(this.getMaxLatex()!==e){if(this.getDomainType()==="unknown"){Co("DomainView is in use for a non-parametric, non-polar expression",{severity:"error",metaData:{expression:Bp(this.model,{stripDefaults:!0})}});return}let i=this.setMaxCommand();i!==void 0&&this.controller.dispatch({type:i,id:this.id,latex:e})}}getFocusedInput(){let e=this.controller.getFocusLocation();if(!(!e||e.type!=="domain-limit"||e.id!==this.id))return e.location}getMinLatex(){switch(this.getDomainType()){case"parametric":return cO(this.model);case"polar":return aO(this.model);case"parametric-uv":return this.getDomainVariable()==="u"||this.getDomainVariable()==="r"||this.getDomainVariable()==="\\theta"&&Ua(this.model)?dO(this.model):hO(this.model);default:return""}}getMaxLatex(){switch(this.getDomainType()){case"parametric":return pO(this.model);case"polar":return lO(this.model);case"parametric-uv":return this.getDomainVariable()==="u"||this.getDomainVariable()==="r"||this.getDomainVariable()==="\\theta"&&Ua(this.model)?uO(this.model):gO(this.model);default:return""}}getDomainVariable(){var e;switch(this.getDomainType()){case"parametric":return"t";case"polar":return"\\theta";default:return(e=this.parameter)!=null?e:""}}getDomainVariableForDisplay(){return this.getDomainType()==="parametric"&&"dependency"in this.model.formula?this.model.formula.dependency:this.getDomainVariable()}getDomainVariableLatex(){switch(this.getDomainType()){case"parametric":case"polar":case"parametric-uv":return"\\le "+this.getDomainVariableForDisplay()+" \\le";default:return""}}getDomainType(){return Rh(this.model)||bg(this.model)?"polar":Fh(this.model)?"parametric":jv(this.model)||Ua(this.model)||pa(this.model)?"parametric-uv":"unknown"}getMQConfig(){return{autoOperatorNames:da({})}}};var xe=__dcg_shared_module_exports__['i'](Z());var Ja=__dcg_shared_module_exports__['i'](Z());Oe();var Dt=class extends Ja.Class{template(){return Ja.createElement("div",{role:Ja.const("checkbox"),tabindex:()=>this.props.disabled&&this.props.disabled()?-1:0,"aria-label":()=>{var e,r;return(r=(e=this.props).ariaLabel)==null?void 0:r.call(e)},"aria-labelledby":()=>{var e,r;return(r=(e=this.props).labelledBy)==null?void 0:r.call(e)},"aria-describedby":()=>{var e,r;return(r=(e=this.props).describedBy)==null?void 0:r.call(e)},"aria-disabled":()=>this.props.disabled&&this.props.disabled(),"aria-checked":this.props.checked,manageFocus:()=>{var e,r;return(r=(e=this.props).manageFocus)==null?void 0:r.call(e)},class:()=>({"dcg-component-checkbox":!0,"dcg-checked":this.props.checked(),"dcg-disabled":this.props.disabled&&this.props.disabled(),"dcg-small":this.props.small&&this.props.small(),[this.props.class===void 0?"":this.props.class()]:this.props.class!==void 0}),style:()=>this.props.style?this.props.style():{},onTap:this.bindFn(this.onChange)},Ja.createElement("span",{class:Ja.const("dcg-checkbox")},Ja.createElement("i",{class:Ja.const("dcg-icon-check"),"aria-hidden":Ja.const("true")})),Ja.createElement("span",{class:Ja.const("dcg-checkbox-children")},this.children))}onChange(e){e.target&&I(e.target).attr("href")||this.props.disabled&&this.props.disabled()||this.props.onChange(!this.props.checked())}};var{If:vl,For:T$,IfElse:A$}=xe.Components,zb=class extends xe.Class{template(){return this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id,xe.createElement(vl,{predicate:this.bindFn(this.hasRegression)},()=>xe.createElement("div",{class:xe.const("dcg-regression-container")},xe.createElement("div",{class:xe.const("dcg-handle-event"),handleEvent:xe.const("true")},xe.createElement(vl,{predicate:this.bindFn(this.getShouldSuggestLogMode)},()=>xe.createElement("div",{class:xe.const("dcg-log-mode-toggle")},A$(()=>this.areLogModeRegressionsForced(),{true:()=>xe.createElement("div",{class:xe.const("dcg-action-log-mode-toggle dcg-no-hover-styling")},()=>this.controller.s("graphing-calculator-button-regression-log-mode")),false:()=>xe.createElement("div",null,xe.createElement(Dt,{class:this.const("dcg-action-log-mode-toggle dcg-log-mode-checkbox"),onChange:this.bindFn(this.onTapLogMode),checked:()=>this.getIsLogModeRegression()},()=>this.controller.s("graphing-calculator-button-regression-log-mode")),xe.createElement(Pe,{tooltip:()=>this.controller.s("graphing-calculator-label-regression-log-mode-help-tooltip"),gravity:this.const("e")},xe.createElement("a",{"aria-label":()=>this.controller.s("graphing-calculator-label-regression-log-mode-help-tooltip"),class:xe.const("dcg-log-mode-toggle-help"),target:xe.const("_blank"),href:xe.const("https://help.desmos.com/hc/en-us/articles/204349605")},xe.createElement("i",{class:xe.const("dcg-icon-question-sign"),"aria-hidden":xe.const("true")}))))}))),xe.createElement("div",{class:xe.const("dcg-statistics"),role:xe.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-heading-regression-statistics")},xe.createElement("div",{class:xe.const("dcg-expression-footer-title")},()=>this.controller.s("graphing-calculator-heading-regression-statistics"),xe.createElement(vl,{predicate:()=>this.getRegression().statistics.hasOwnProperty("RMSE")},()=>xe.createElement(Pe,{tooltip:()=>this.controller.s("graphing-calculator-label-regression-what-is-rmse-tooltip"),gravity:this.const("s")},xe.createElement("a",{class:xe.const("dcg-expression-footer-title-help"),target:xe.const("_blank"),href:xe.const("https://help.desmos.com/hc/en-us/articles/202529129-What-is-RMSE-"),"aria-label":()=>this.controller.s("graphing-calculator-label-regression-what-is-rmse-tooltip")},xe.createElement("i",{class:xe.const("dcg-icon-question-sign"),"aria-hidden":xe.const("true")})))),xe.createElement(vl,{predicate:()=>this.getRegression().statistics.Rsquared<0},()=>xe.createElement(Pe,{tooltip:()=>this.controller.s("graphing-calculator-label-regression-why-is-negative-tooltip"),gravity:this.const("s")},xe.createElement("a",{"aria-label":()=>this.controller.s("graphing-calculator-label-regression-why-is-negative-tooltip"),class:xe.const("dcg-expression-footer-title-help"),target:xe.const("_blank"),href:xe.const("https://help.desmos.com/hc/en-us/articles/202529139-Why-am-I-seeing-a-negative-R-2-value-")},xe.createElement("i",{class:xe.const("dcg-icon-question-sign"),"aria-hidden":xe.const("true")}))))),xe.createElement("div",{class:xe.const("dcg-statistics-values")},xe.createElement(vl,{predicate:()=>this.getRegression().statistics.hasOwnProperty("Rsquared")},()=>xe.createElement("div",null,xe.createElement(kn,__dcg_shared_module_exports__['b']({latex:()=>"R^2="+Ya(this.getRegression(),"Rsquared"),brailleShouldFocus:()=>{let e=this.controller.getFocusLocation();return!e||e.type!=="regression-output"?!1:e.parameter==="Rsquared"},onBrailleFocusedChanged:e=>{e?this.controller.dispatch({type:"set-focus-location",location:{type:"regression-output",parameter:"Rsquared"}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"regression-output",parameter:"Rsquared"}})},ariaLabel:this.const(""),isStatic:this.const(!0)},ko(this.controller)),xe.createElement(et,{latex:()=>"R^2="+Ya(this.getRegression(),"Rsquared"),config:this.const({})},xe.createElement("span",{tabindex:xe.const("0"),manageFocus:this.const(yt({predicate:()=>this.controller.getBrailleMode()==="none",controller:this.controller,location:{type:"regression-output",parameter:"Rsquared"}}))}))))),xe.createElement(vl,{predicate:()=>this.getRegression().statistics.hasOwnProperty("rsquared")},()=>xe.createElement("div",null,xe.createElement(kn,__dcg_shared_module_exports__['b']({latex:()=>"r^2="+Ya(this.getRegression(),"rsquared"),brailleShouldFocus:()=>{let e=this.controller.getFocusLocation();return!e||e.type!=="regression-output"?!1:e.parameter==="rsquared"},onBrailleFocusedChanged:e=>{e?this.controller.dispatch({type:"set-focus-location",location:{type:"regression-output",parameter:"rsquared"}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"regression-output",parameter:"rsquared"}})},ariaLabel:this.const(""),isStatic:this.const(!0)},ko(this.controller)),xe.createElement(et,{latex:()=>"r^2="+Ya(this.getRegression(),"rsquared"),config:this.const({})},xe.createElement("span",{tabindex:xe.const("0"),manageFocus:this.const(yt({predicate:()=>this.controller.getBrailleMode()==="none",controller:this.controller,location:{type:"regression-output",parameter:"rsquared"}}))}))))),xe.createElement(vl,{predicate:()=>this.getRegression().statistics.hasOwnProperty("r")},()=>xe.createElement("div",null,xe.createElement(kn,__dcg_shared_module_exports__['b']({latex:()=>"r="+Ya(this.getRegression(),"r"),brailleShouldFocus:()=>{let e=this.controller.getFocusLocation();return!e||e.type!=="regression-output"?!1:e.parameter==="r"},onBrailleFocusedChanged:e=>{e?this.controller.dispatch({type:"set-focus-location",location:{type:"regression-output",parameter:"r"}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"regression-output",parameter:"r"}})},ariaLabel:this.const(""),isStatic:this.const(!0)},ko(this.controller)),xe.createElement(et,{latex:()=>"r="+Ya(this.getRegression(),"r"),config:this.const({})},xe.createElement("span",{class:xe.const("dcg-r-value"),tabindex:xe.const("0"),manageFocus:this.const(yt({predicate:()=>this.controller.getBrailleMode()==="none",controller:this.controller,location:{type:"regression-output",parameter:"r"}}))}))))),xe.createElement(vl,{predicate:()=>this.getRegression().statistics.hasOwnProperty("RMSE")},()=>xe.createElement("div",null,xe.createElement(kn,__dcg_shared_module_exports__['b']({latex:()=>"\\operatorname{RMSE}="+Ya(this.getRegression(),"RMSE"),brailleShouldFocus:()=>{let e=this.controller.getFocusLocation();return!e||e.type!=="regression-output"?!1:e.parameter==="RMSE"},onBrailleFocusedChanged:e=>{e?this.controller.dispatch({type:"set-focus-location",location:{type:"regression-output",parameter:"RMSE"}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"regression-output",parameter:"RMSE"}})},ariaLabel:this.const(""),isStatic:this.const(!0)},ko(this.controller)),xe.createElement(et,{latex:()=>"\\operatorname{RMSE}="+Ya(this.getRegression(),"RMSE"),config:this.const({})},xe.createElement("span",{tabindex:xe.const("0"),manageFocus:this.const(yt({predicate:()=>this.controller.getBrailleMode()==="none",controller:this.controller,location:{type:"regression-output",parameter:"RMSE"}}))}))))))),xe.createElement("div",{role:xe.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-heading-regression-residuals"),class:xe.const("dcg-residuals")},xe.createElement("div",{class:xe.const("dcg-expression-footer-title")},()=>this.controller.s("graphing-calculator-heading-regression-residuals")),xe.createElement(kn,__dcg_shared_module_exports__['b']({latex:this.bindFn(this.getResidualVariable),brailleShouldFocus:()=>{let e=this.controller.getFocusLocation();return!e||e.type!=="regression-output"?!1:e.parameter===this.getResidualVariable()},onBrailleFocusedChanged:e=>{e?this.controller.dispatch({type:"set-focus-location",location:{type:"regression-output",parameter:this.getResidualVariable()}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"regression-output",parameter:this.getResidualVariable()}})},ariaLabel:this.const(""),isStatic:this.const(!0)},ko(this.controller)),xe.createElement(et,{latex:this.bindFn(this.getResidualVariable),config:this.const({})},xe.createElement("span",{class:xe.const("dcg-residuals-variable"),tabindex:xe.const("0"),manageFocus:this.const(yt({predicate:()=>this.controller.getBrailleMode()==="none",controller:this.controller,location:{type:"regression-output",parameter:this.getResidualVariable()}}))}))),xe.createElement(vl,{predicate:this.bindFn(this.getResidualSuggestionVisible)},()=>xe.createElement("div",{class:xe.const("dcg-residual-suggestion dcg-action-plot-residual dcg-btn dcg-btn-light-gray"),role:xe.const("button"),onTap:this.bindFn(this.onTapResidualsSuggestion)},()=>this.controller.s("graphing-calculator-button-regression-plot-residuals")))),xe.createElement(vl,{predicate:()=>Object.keys(this.getRegression().parameters).length>0},()=>xe.createElement("div",{class:xe.const("dcg-parameters-container")},xe.createElement("div",{class:xe.const("dcg-expression-footer-title")},()=>this.controller.s("graphing-calculator-heading-regression-parameters"),xe.createElement(vl,{predicate:()=>this.isNonLinearRegression()},()=>xe.createElement(Pe,{tooltip:()=>this.controller.s("graphing-calculator-label-regression-parameters-not-exact"),gravity:this.const("s")},xe.createElement("a",{class:xe.const("dcg-expression-footer-title-help"),target:xe.const("_blank"),href:xe.const("https://help.desmos.com/hc/en-us/articles/360042428612"),"aria-label":()=>this.controller.s("graphing-calculator-label-regression-parameters-not-exact")},xe.createElement("i",{class:xe.const("dcg-icon-question-sign"),"aria-hidden":xe.const("true")}))))),xe.createElement(T$,{each:()=>Object.keys(this.getRegression().parameters)},xe.createElement("div",{role:xe.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-heading-regression-parameters"),class:xe.const("dcg-parameters")},e=>xe.createElement(kn,__dcg_shared_module_exports__['b']({latex:()=>e+"="+nS(this.getRegression(),e),brailleShouldFocus:()=>{let r=this.controller.getFocusLocation();return!r||r.type!=="regression-output"?!1:r.parameter===e},onBrailleFocusedChanged:r=>{r?this.controller.dispatch({type:"set-focus-location",location:{type:"regression-output",parameter:e}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"regression-output",parameter:e}})},ariaLabel:this.const(""),isStatic:this.const(!0)},ko(this.controller)),xe.createElement(et,{latex:()=>e+"="+nS(this.getRegression(),e),config:this.const({})},xe.createElement("span",{class:xe.const("dcg-parameter"),tabindex:xe.const("0"),manageFocus:this.const(yt({controller:this.controller,location:{type:"regression-output",parameter:e}}))}))))))),xe.createElement("div",{class:xe.const("dcg-clear")}),xe.createElement(vl,{predicate:()=>this.hasParameterWarning()},()=>xe.createElement("div",{class:xe.const("dcg-parameter-warning")},xe.createElement("i",{class:xe.const("dcg-icon-error"),"aria-hidden":xe.const("true")}),xe.const("\xA0"),()=>this.controller.s("graphing-calculator-text-regression-potentially-inaccurate-parameters"),xe.const("\xA0"),xe.createElement("a",{href:xe.const("https://help.desmos.com/hc/en-us/articles/360042942771"),target:xe.const("_blank")},()=>this.controller.s("graphing-calculator-link-learn-more")))))))}onTapResidualsSuggestion(){this.controller.dispatch({type:"plot-residuals",id:this.id})}onTapLogMode(){this.controller.dispatch({type:"toggle-logmode",id:this.id})}getRegression(){return this.model.formula.regression}hasRegression(){return!!this.model.formula.regression}isNonLinearRegression(){return!this.getRegression().isLinear}getResidualVariable(){return this.getRegression().residualVariable||""}getResidualSuggestionVisible(){return this.getRegression().residualSuggestionId!==void 0}areLogModeRegressionsForced(){return this.controller.areLogModeRegressionsForced()}getShouldSuggestLogMode(){return!!this.getRegression().shouldSuggestLogMode}hasParameterWarning(){return!!this.getRegression().parameterWarning}getIsLogModeRegression(){return!!this.model.isLogModeRegression}};function nS(t,e){return __dcg_shared_module_exports__['Gb'](t.parameters[e],{digits:6,smallCutoff:1e-6,bigCutoff:1e9})}function Ya(t,e){return __dcg_shared_module_exports__['Gb'](t.statistics[e],{zeroCutoff:1e-15,digits:4,smallCutoff:1e-6,bigCutoff:1e9})}Oe();var dn=__dcg_shared_module_exports__['i'](Z());var Gn=__dcg_shared_module_exports__['i'](Z());Oe();Oe();var oS=class extends Lr{constructor(){super();this.dragging=!1,this.guid=__dcg_shared_module_exports__['L']("dragdrop-class")}_evt2pt(r){return{x:r.changedTouches[0].pageX-this._offsetPt.x,y:r.changedTouches[0].pageY-this._offsetPt.y}}_dispatch(r,i){if(this._destroyed)return;let n=this._evt2pt(i);this.triggerEvent(r,{x:n.x,y:n.y,dx:n.x-this._startPt.x,dy:n.y-this._startPt.y,evt:i})}destroy(){I(document).off(`.${this.guid}`),this._destroyed=!0}startDrag(r,i={}){if(!this.dragging)return I(document).on(`dcg-tapmove.${this.guid}`,n=>{(n.originalEvent||n).preventDefault(),cancelAnimationFrame(this.frameThrottle),this.frameThrottle=requestAnimationFrame(()=>this.doDrag(n))}),I(document).on(`dcg-tapend.${this.guid} dcg-tapcancel.${this.guid}`,n=>this.endDrag(n)),this._offsetPt={x:0,y:0},i.origin&&(this._offsetPt={x:this._evt2pt(r).x-i.origin.x,y:this._evt2pt(r).y-i.origin.y}),this._startPt=this._evt2pt(r),this.setProperty("dragging",!0),this._dispatch("onGrab",r)}doDrag(r){this.dragging&&this._dispatch("onDrag",r)}endDrag(r){this.dragging&&(I(document).off(`.${this.guid}`),this.doDrag(r),this.setProperty("dragging",!1),this._dispatch("onDrop",r))}};var{If:L$}=Gn.Components;function gB(t,e,r){return Math.min(Math.max(t,e),r)}var $b=class extends Gn.Class{template(){return Gn.createElement("div",{class:()=>({"dcg-slider-interior":!0,"dcg-disable-slider":this.shouldDisableSlider()}),didMount:this.bindFn(this.didMountRoot),onTapStart:this.bindFn(this.onStartDrag)},Gn.createElement("div",{class:Gn.const("dcg-track")},Gn.createElement("div",{class:Gn.const("dcg-ticks"),onMount:this.bindFn(this.didMountTickMarks)}),Gn.createElement("div",{class:Gn.const("dcg-graphic")})),Gn.createElement(L$,{predicate:this.bindFn(this.shouldShowZeroMarker)},()=>Gn.createElement("div",{class:Gn.const("dcg-zeroMarker"),style:()=>({left:this.getZeroMarkerPercent()+"%"})})),Gn.createElement("div",{class:()=>({"dcg-thumb":!0,"dcg-down":this.isDragging}),role:Gn.const("slider"),tabindex:Gn.const("0"),disablescroll:Gn.const("true"),style:()=>({left:this.getThumbPercent()+"%"}),onKeyDown:this.bindFn(this.onKeyDown),"aria-label":this.props.ariaLabel,"aria-valuemin":this.props.min,"aria-valuemax":this.props.max,"aria-valuenow":this.props.value,manageFocus:this.buildFocusManager()},Gn.createElement("div",{class:Gn.const("dcg-graphic")}),Gn.createElement("div",{class:Gn.const("dcg-center")})))}willUnmount(){this.dragDrop.destroy()}didMountRoot(e){this.rootNode=e,this.dragDrop=new oS,this.isMounted=!0,this.dragDrop.observeEvent("onDrop",()=>{this.isDragging=!1,this.update(),this.props.onDrop&&this.props.onDrop()}),this.dragDrop.observeEvent("onGrab",()=>{this.isDragging=!0,this.update(),this.props.onGrab&&this.props.onGrab()}),this.dragDrop.observeEvent("onDrag",(r,i)=>{this.props.onDragUpdate(this.valueFromPixels(i.x))})}didMountTickMarks(e){this.tickMarksNode=e,this.renderTickMarks()}didUpdate(){this.renderTickMarks()}shouldDisableSlider(){return this.props.min()===this.props.max()}renderTickMarks(){if(this.tickMarksNode){var e=this.props.step(),r=this.props.min(),i=this.props.max(),n;if(e===void 0?n=0:n=100*e/(i-r),n<3&&(n=0),n>100&&(n=0),isNaN(n)&&(n=0),this.lastTickMarksPercent!==n){this.lastTickMarksPercent=n;var o="";if(n>0&&n<100)for(var s=n;s<100;s+=n)o+='<div class="dcg-tick" style="left:'+s+'%"></div>';this.tickMarksNode.innerHTML=o}}}shouldShowZeroMarker(){return this.props.min()<=0&&this.props.max()>=0}getZeroMarkerPercent(){var e=this.props.min(),r=this.props.max();return 100*(0-e)/(r-e)}getThumbPercent(){return 100*this.percentFromValue(this.props.value())}valueFromPixels(e){if(!this.isMounted)return 0;let r=this.props.min(),i=this.props.max(),n=this.rootNode.getBoundingClientRect().width,o=gB(e/n,0,1),s=r+(i-r)*o,a=(i-r)/n;return fi(s-a,s+a)}percentFromValue(e){let r=this.props.min(),i=this.props.max();return gB((e-r)/(i-r),0,1)}pixelsFromValue(e){if(!this.isMounted)return 0;let r=this.percentFromValue(e);return this.rootNode.getBoundingClientRect().width*r}onKeyDown(e){switch(Te(e)){case Jn:this.props.onUpPress&&(this.props.onUpPress(),e.preventDefault());break;case Yn:this.props.onDownPress&&(this.props.onDownPress(),e.preventDefault());break;case ll:this.props.onEnterPress&&(this.props.onEnterPress(),e.preventDefault());break;case jn:document.activeElement&&I(document.activeElement).trigger("blur");break;case Rc:this.props.onKeyboardUpdate("down"),e.preventDefault();break;case Nc:this.props.onKeyboardUpdate("up"),e.preventDefault();break;case eg:this.props.onKeyboardUpdate("bigdown"),e.preventDefault();break;case Zu:this.props.onKeyboardUpdate("bigup"),e.preventDefault();break;case Vh:this.props.onKeyboardUpdate("min"),e.preventDefault();break;case Gh:this.props.onKeyboardUpdate("max"),e.preventDefault();break}}onStartDrag(e){if(e.device==="keyboard"||!e.target)return;e.preventDefault(),ti();let r={x:0,y:0};I(e.target).closest(".dcg-thumb").length===1?r.x=this.pixelsFromValue(this.props.value()):r.x=e.changedTouches[0].clientX-this.rootNode.getBoundingClientRect().left,this.dragDrop.startDrag(e,{origin:r})}buildFocusManager(){return!this.props.onFocusedChanged||!this.props.isFocused?this.const(void 0):this.const({shouldBeFocused:this.props.isFocused,onFocusedChanged:this.props.onFocusedChanged})}};Oe();var Vn=__dcg_shared_module_exports__['i'](Z());var{If:P$}=Vn.Components,Wb=class extends Vn.Class{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return Vn.createElement("div",{class:Vn.const("dcg-slider_menu dcg-do-blur"),handleEvent:Vn.const("true"),didMount:e=>this.node=e},Vn.createElement("div",{class:Vn.const("dcg-editable-mathquill-container")},Vn.createElement(P$,{predicate:()=>!this.shouldOnlyShowStep()},()=>Vn.createElement("span",null,Vn.createElement(lr,{readonly:()=>this.controller.isItemReadonly(this.id),latex:()=>this.model.slider.hardMin?this.model.slider.min:"",isFocused:()=>this.getFocusedInput()==="min",ariaLabel:()=>this.controller.s("graphing-calculator-narration-slider-minimum"),brailleLabel:()=>this.controller.raw("sldrmin"),handleFocusChanged:(e,r)=>this.handleFocusedChanged("min",e,r),hasError:()=>!Tv(this.model),controller:this.props.controller,handlePressedKey:(e,r)=>this.handlePressedKey("min",e,r),handleLatexChanged:e=>this.handleLatexChanged("min",e),dataLabelAttributeValue:this.const("slidermin")}),Vn.createElement("span",{class:Vn.const("dcg-interval-interior")},Vn.createElement(et,{latex:this.bindFn(this.getDependentLatex),config:this.const({})},Vn.createElement("span",null))),Vn.createElement(lr,{readonly:()=>this.controller.isItemReadonly(this.id),latex:()=>this.model.slider.hardMax?this.model.slider.max:"",isFocused:()=>this.getFocusedInput()==="max",ariaLabel:()=>this.controller.s("graphing-calculator-narration-slider-maximum"),brailleLabel:()=>this.controller.raw("sldrmax"),handleFocusChanged:(e,r)=>this.handleFocusedChanged("max",e,r),hasError:()=>!Av(this.model),controller:this.props.controller,handlePressedKey:(e,r)=>this.handlePressedKey("max",e,r),handleLatexChanged:e=>this.handleLatexChanged("max",e),dataLabelAttributeValue:this.const("slidermax")}))),Vn.createElement("span",{class:()=>({"dcg-slider-step-container":!this.shouldOnlyShowStep()})},Vn.createElement("span",{class:Vn.const("dcg-slider-step-label"),"aria-hidden":Vn.const("true")},()=>this.controller.s("graphing-calculator-label-slider-step")),Vn.createElement(lr,{readonly:()=>this.controller.isItemReadonly(this.id),latex:()=>this.model.slider.step,isFocused:()=>this.getFocusedInput()==="step",ariaLabel:()=>this.controller.s("graphing-calculator-narration-slider-step"),brailleLabel:()=>this.controller.raw("sldrstep"),handleFocusChanged:(e,r)=>this.handleFocusedChanged("step",e,r),hasError:()=>!Lv(this.model),controller:this.props.controller,handlePressedKey:(e,r)=>this.handlePressedKey("step",e,r),handleLatexChanged:e=>this.handleLatexChanged("step",e),dataLabelAttributeValue:this.const("sliderstep")}))))}handlePressedKey(e,r,i){if(!this.controller.isInEditListMode()&&!this.shouldOnlyShowStep()&&(r==="Esc"||r==="Enter")){this.controller.dispatch({type:"set-focus-location",location:{type:"slider-thumb",id:this.id}});return}let n=Xe.getFocusedMathquill(),o=zs();if(r==="Left"||r==="Right"||r==="Down"||r==="Up"){var s;n?s=Xe.applyArrowKeyAndReturnIfWasAtBounds(n,r,i):o&&(o.selectionStart===0&&r==="Left"||o.selectionStart===I(o).val().length&&r==="Right"||r==="Up"||r==="Down")?s=!0:s=!1,s&&(i&&i.preventDefault(),r==="Left"&&!this.shouldOnlyShowStep()?e==="max"?this.controller.dispatch({type:"set-focus-location",location:{type:"slider-limit",id:this.id,location:"min"}}):e==="step"&&this.controller.dispatch({type:"set-focus-location",location:{type:"slider-limit",id:this.id,location:"max"}}):r==="Right"&&!this.shouldOnlyShowStep()?e==="min"?this.controller.dispatch({type:"set-focus-location",location:{type:"slider-limit",id:this.id,location:"max"}}):e==="max"&&this.controller.dispatch({type:"set-focus-location",location:{type:"slider-limit",id:this.id,location:"step"}}):r==="Down"?this.controller.dispatch({type:"on-special-key-pressed",key:"Down"}):r==="Up"&&this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:this.id}}));return}n&&(n.keystroke(r,i),this.handleLatexChanged(e,n.latex()))}shouldOnlyShowStep(){return this.model.slider.loopMode==="PLAY_INDEFINITELY"}handleLatexChanged(e,r){e==="min"?this.dispatchMinLatexIfChanged(r):e==="max"?this.dispatchMaxLatexIfChanged(r):e==="step"&&this.dispatchStepLatexIfChanged(r)}handleFocusedChanged(e,r,i){r&&this.getFocusedInput()!==e?this.controller.dispatch({type:"set-focus-location",location:{type:"slider-limit",id:this.id,location:e}}):this.getFocusedInput()===e&&this.controller.getBrailleMode()==="none"&&(!i.relatedTarget||!this.node.contains(i.relatedTarget))&&this.controller.dispatch({type:"blur-focus-location",location:{type:"slider-limit",id:this.id,location:e}})}dispatchMinLatexIfChanged(e){this.model.slider.min!==e&&this.controller.dispatch({type:"set-slider-minlatex",id:this.id,latex:e})}dispatchMaxLatexIfChanged(e){this.model.slider.max!==e&&this.controller.dispatch({type:"set-slider-maxlatex",id:this.id,latex:e})}dispatchStepLatexIfChanged(e){this.model.slider.step!==e&&this.controller.dispatch({type:"set-slider-steplatex",id:this.id,latex:e})}getDependentLatex(){var e=so(this.model)||"";return" \\le "+__dcg_shared_module_exports__['Hb'](e)+" \\le "}getFocusedInput(){let e=this.controller.getFocusLocation();if(!(!e||e.type!=="slider-limit"||e.id!==this.id))return e.location}getMQConfig(){return{autoOperatorNames:da()}}};var{If:mB}=dn.Components,jb=class extends dn.Class{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return dn.createElement("span",{class:dn.const("dcg-slider-container"),tapboundary:dn.const("true"),onKeydown:e=>{Te(e)==="Tab"&&!e.altKey&&!e.metaKey&&!e.ctrlKey&&(e.shiftKey?this.isSliderMinFocused()&&this.controller.isInEditListMode()?(e.target!==null&&I(e.target).closest(".dcg-expressionitem").find('[tabindex="0"]:visible:first').trigger("focus"),e.preventDefault(),e.stopPropagation()):this.isSliderThumbFocused()&&(this.controller.isItemReadonly(this.model.id)||(this.controller.dispatch({type:"set-focus-location",location:{type:"slider-limit",id:this.id,location:"step"}}),e.preventDefault(),e.stopPropagation())):!e.shiftKey&&this.isSliderStepFocused()&&(this.controller.isInEditListMode()?this.controller.dispatch({type:"set-focus-location",location:{type:"slider-icon",id:this.id}}):this.controller.dispatch({type:"set-focus-location",location:{type:"slider-thumb",id:this.id}}),e.preventDefault(),e.stopPropagation()))}},dn.createElement(mB,{predicate:this.bindFn(this.shouldShowSlider)},()=>dn.createElement("div",{class:dn.const("dcg-do-blur dcg-slider"),handleEvent:dn.const("true")},dn.createElement("div",{class:dn.const("dcg-minLabel dcg-template-minlabelhtml"),role:dn.const("button"),tabindex:dn.const("0"),"aria-label":this.bindFn(this.getMinAriaLabel),onTap:()=>this.onEditLimit("min")},dn.createElement(et,{latex:()=>Iv(this.model),config:this.const({})})),dn.createElement($b,{min:()=>Ka(this.model),max:()=>Jl(this.model),step:()=>ul(this.model),value:()=>Ns(this.model),ariaLabel:()=>this.controller.getBrailleMode()==="none"?'"'+so(this.model)+'"':""+so(this.model),onGrab:this.bindFn(this.onGrab),onDrop:this.bindFn(this.onDrop),onDragUpdate:this.bindFn(this.onDragUpdate),onKeyboardUpdate:this.bindFn(this.onKeyboardUpdate),onUpPress:()=>this.controller.dispatch({type:"on-special-key-pressed",key:"Up"}),onDownPress:()=>this.controller.dispatch({type:"on-special-key-pressed",key:"Down"}),onEnterPress:()=>this.controller.dispatch({type:"on-special-key-pressed",key:"Enter"}),isFocused:this.bindFn(this.isSliderThumbFocused),onFocusedChanged:e=>{e?this.controller.dispatch({type:"set-focus-location",location:{type:"slider-thumb",id:this.id}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"slider-thumb",id:this.id}})}}),dn.createElement("div",{class:dn.const("dcg-maxLabel dcg-template-maxlabelhtml"),onTap:()=>this.onEditLimit("max"),role:dn.const("button"),tabindex:dn.const("0"),"aria-label":()=>this.controller.s("graphing-calculator-narration-slider-maximum")+" "+Eo(Iv(this.model))},dn.createElement(et,{latex:()=>AP(this.model),config:this.const({})})))),dn.createElement(mB,{predicate:this.bindFn(this.shouldShowLimitInputs)},()=>dn.createElement(Wb,{model:this.props.model,controller:this.props.controller})))}getMinAriaLabel(){return this.controller.isItemReadonly(this.model.id)?this.controller.s("graphing-calculator-narration-slider-minimum")+" "+Eo(Iv(this.model)):this.controller.s("graphing-calculator-narration-edit-slider-variable-limits",{variable:this.controller.getBrailleMode()==="none"?'"'+so(this.model)+'"':""+so(this.model)})}onGrab(){this.dispatchIsDraggingIfChanged(!0)}onDrop(){this.controller.dispatch({type:"set-none-selected"}),this.dispatchIsPlayingIfChanged(!1),this.dispatchIsDraggingIfChanged(!1)}onKeyboardUpdate(e){this.controller.dispatch({type:"adjust-slider-by-keyboard",id:this.id,adjustment:e})}onDragUpdate(e){this.controller.dispatch({type:"adjust-slider-by-dragging-thumb",id:this.model.id,target:e})}onEditLimit(e){this.controller.dispatch({type:"set-focus-location",location:{type:"slider-limit",id:this.id,location:e}})}dispatchIsPlayingIfChanged(e){this.model.slider.isPlaying!==e&&this.controller.dispatch({type:"set-slider-isplaying",id:this.id,isPlaying:e})}dispatchIsDraggingIfChanged(e){this.model.sliderDragging!==e&&this.controller.dispatch({type:"set-slider-dragging",id:this.id,dragging:e})}shouldShowLimitInputs(){if(this.controller.isInEditListMode())return!0;if(this.controller.isItemReadonly(this.model.id))return!1;if(!Tv(this.model)||!Av(this.model)||!Lv(this.model)||this.model.slider.loopMode==="PLAY_INDEFINITELY")return!0;let e=this.controller.getFocusLocation();return!!(e&&(e.type==="slider-limit"||e.type==="expression"||e.type==="readonly-expression")&&e.id===this.id)}shouldShowSlider(){return!this.shouldShowLimitInputs()}isSliderThumbFocused(){let e=this.controller.getFocusLocation();return!!(e&&e.type==="slider-thumb"&&e.id===this.id)}isSliderMinFocused(){let e=this.controller.getFocusLocation();return!!(e&&e.type==="slider-limit"&&e.id===this.id&&e.location==="min")}isSliderStepFocused(){let e=this.controller.getFocusLocation();return!!(e&&e.type==="slider-limit"&&e.id===this.id&&e.location==="step")}};Oe();var Zi=__dcg_shared_module_exports__['i'](Z());var{For:O$,If:_$}=Zi.Components,mc=class extends Zi.Class{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return Zi.createElement("div",{class:Zi.const("dcg-create-sliders dcg-action-createslider"),handleEvent:Zi.const("true"),onTap:this.bindFn(this.onCreateSlider)},Zi.createElement("span",{class:Zi.const("dcg-msg")},()=>this.controller.s("graphing-calculator-label-add-slider")),Zi.createElement("span",{class:Zi.const("btns")},Zi.createElement(O$,{each:()=>this.getMissingVariables().slice(0,4)},Zi.createElement("span",null,e=>Zi.createElement("div",{class:Zi.const("dcg-slider-btn-container"),var_name:this.const(e)},Zi.createElement("div",{role:Zi.const("button"),tabindex:Zi.const("0"),class:()=>({"dcg-btn-slider":!0,"dcg-btn-blue":this.getMissingVariables().length===1,"dcg-btn-light-gray":this.getMissingVariables().length!==1}),didMount:r=>{r.innerHTML=__dcg_shared_module_exports__['Ib'](e)}})))),Zi.createElement(_$,{predicate:()=>this.getMissingVariables().length>1},()=>Zi.createElement("div",{class:Zi.const("dcg-slider-btn-container dcg-all")},Zi.createElement("div",{role:Zi.const("button"),tabindex:Zi.const("0"),class:Zi.const("dcg-btn-slider dcg-btn-blue")},()=>this.controller.s("graphing-calculator-button-slider-add-all-variables"))))))}onCreateSlider(e){if(this.controller.dispatch({type:"set-none-selected"}),!e.target)return;var r=I(e.target).closest(".dcg-slider-btn-container");if(!r.length)return;let i=r.hasClass("dcg-all"),n=i?this.getMissingVariables():[r.attr("var_name")];if(this.model.type==="ticker"?this.controller.dispatch({type:"create-sliders-for-ticker",variables:this.getMissingVariables()}):this.controller.dispatch({type:"create-sliders-for-item",id:this.model.id,variables:n}),e.device==="keyboard"){let o=this.model.id,s=this.props.controller().getItemSelectorById(o);if(!s)return;i?this.controller.dispatch({type:"move-focus-to-item",id:o}):s.find(".dcg-btn-blue").trigger("focus")}}getMissingVariables(){return this.model.type==="ticker"?Sy(this.model):Vy(this.model)}didMount(){this.promptAlertTimeout&&clearTimeout(this.promptAlertTimeout),this.promptAlertTimeout=setTimeout(()=>{for(var e=[],r=this.getMissingVariables(),i=0;i<r.length;i++)e.push('"'+r[i]+'"');me(this.controller.s("graphing-calculator-narration-add-slider-prompt",{vars:e.join(",")})),this.promptAlertTimeout=0},2e3)}didUnmount(){this.promptAlertTimeout&&clearTimeout(this.promptAlertTimeout)}};var Ls=__dcg_shared_module_exports__['i'](Z());var Jb=class extends Ls.Class{template(){return Ls.createElement("div",{class:Ls.const("dcg-prompt-rename"),handleEvent:Ls.const("true")},()=>Yo("graphing-calculator-label-rename"),Ls.createElement("span",{class:Ls.const("dcg-btn-light-gray"),onTap:this.props.handleRename,tabindex:Ls.const(0),role:Ls.const("button")},Ls.createElement(et,{latex:()=>this.props.from()+" \\to "+this.props.to(),config:this.const({})},Ls.createElement("span",{style:Ls.const("pointer-events:none")}))),Ls.createElement("span",{class:Ls.const("dcg-reference-count")},()=>Yo("graphing-calculator-label-reference-count",{count:new ks(this.props.count())})))}};var va=__dcg_shared_module_exports__['i'](Z());var ts=__dcg_shared_module_exports__['i'](Z());var{For:F$,If:R$}=ts.Components,jr=class extends ts.Class{init(){this.config=this.props.staticConfig()}template(){return ts.createElement(F$,{each:()=>this.config,key:e=>e.key},ts.createElement("div",{class:ts.const("dcg-segmented-control-container"),role:ts.const("group"),"aria-label":this.props.ariaGroupLabel},e=>ts.createElement("div",{class:()=>({"dcg-segmented-control-btn":!0,"dcg-selected":e.selected(),"dcg-theme-mini":this.getTheme()==="mini","dcg-theme-default":this.getTheme()==="default","dcg-disabled":this.isDisabled(),[e.class?e.class():""]:!!e.class}),role:ts.const("button"),tabindex:ts.const(0),"aria-label":()=>this.getAriaLabel(e),style:()=>({"min-width":this.props.minButtonWidth?this.props.minButtonWidth()+"px":void 0}),"aria-pressed":()=>e.selected(),onTap:()=>{this.isDisabled()||e.onSelect()},manageFocus:()=>{if(e.focusHelperOptions)return yt(e.focusHelperOptions)}},ts.createElement(Pe,{tooltip:()=>e.tooltip?e.tooltip():"",gravity:()=>e.tooltipGravity?e.tooltipGravity():"s",disabled:()=>!(e.tooltip&&e.tooltip())},ts.createElement("div",{class:ts.const("dcg-segmented-control-interior")},()=>e.label?e.label():"",ts.createElement(R$,{predicate:()=>!!e.icon},()=>ts.createElement("i",{class:()=>e.icon?e.icon():""})))))))}getAriaLabel(e){return e.ariaLabel?e.ariaLabel():e.label?e.label():e.tooltip?e.tooltip():""}isDisabled(){return this.props.disabled&&this.props.disabled()}getTheme(){return this.props.theme?this.props.theme():"default"}};var{Input:N$,IfElse:B$}=va.Components,hu=class extends va.Class{template(){return this.controller=this.props.controller(),va.createElement("div",{class:()=>({"dcg-label-visible":this.getShowLabel(),"dcg-label-container":!0,"dcg-do-blur":!0}),tapboundary:va.const("true"),handleEvent:va.const("true")},va.createElement(Dt,{onChange:this.bindFn(this.onCheckboxInput),checked:this.bindFn(this.getShowLabel)},()=>this.controller.s("graphing-calculator-button-label")+(this.getIsDisabled()?"":":")),B$(this.bindFn(this.hasEditableLabel),{true:()=>va.createElement("div",{class:va.const("dcg-editable-mode-toggle")},va.createElement(jr,{theme:this.const("mini"),staticConfig:this.bindFn(this.getEditableLabelOptions),ariaGroupLabel:()=>this.controller.s("graphing-calculator-narration-editable-label-mode")})),false:()=>va.createElement(N$,{class:()=>({"dcg-label-input":!0,"dcg-disabled-input":this.getIsDisabled(),"dcg-disabled-editable-input":this.hasEditableLabel(),"dcg-readonly":this.getIsReadonly()}),disabled:this.bindFn(this.getIsReadonly),"aria-label":()=>this.controller.s("graphing-calculator-narration-label-text"),"aria-disabled":()=>this.getIsDisabled()||this.hasEditableLabel()||this.getIsReadonly(),value:this.bindFn(this.getLabel),onInput:this.bindFn(this.onLabelInput)})}))}getEditableLabelOptions(){return[{key:"math",label:()=>this.controller.s("graphing-calculator-button-editable-math"),selected:()=>this.model().editableLabelMode==="MATH",onSelect:()=>this.setEditableLabelMode("MATH")},{key:"text",label:()=>this.controller.s("graphing-calculator-button-editable-text"),selected:()=>this.model().editableLabelMode==="TEXT",onSelect:()=>this.setEditableLabelMode("TEXT")}]}setEditableLabelMode(e){this.controller.dispatch({type:"set-item-editable-label-mode",id:this.id(),editableLabelMode:e})}getIsReadonly(){return this.controller.isItemReadonly(this.model().id)}model(){return this.props.model()}id(){return this.model().id}getLabel(){return this.model().label||""}hasEditableLabel(){return fg(this.model())}getShowLabel(){return!!this.model().showLabel}getIsDisabled(){return this.getLabel().length===0&&!this.getShowLabel()}onLabelInput(e){var r=e;this.controller.dispatch({type:"set-item-label",id:this.id(),label:r}),this.controller.dispatch({type:"set-item-showlabel",id:this.id(),showLabel:!!r})}onCheckboxInput(){if(this.props.useSmartPointLabeling&&this.props.useSmartPointLabeling()){this.controller.dispatch({type:"toggle-label-for-all-selected-points"});return}this.controller.dispatch({type:"set-item-showlabel",id:this.id(),showLabel:!this.getShowLabel()})}};var Xa=__dcg_shared_module_exports__['i'](Z());var qn=__dcg_shared_module_exports__['i'](Z());var{If:fB}=qn.Components,Yb=class extends qn.Class{constructor(){super(...arguments),this.focusedValues={}}template(){return this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id,qn.createElement("div",{class:qn.const("dcg-cdf-footer-container dcg-do-blur"),tapboundary:qn.const("true"),handleEvent:qn.const("true")},qn.createElement(Dt,{checked:()=>zc(this.model),disabled:()=>nI(this.model)||this.controller.isItemReadonly(this.model.id),onChange:e=>{this.controller.dispatch({type:"set-show-cdf",id:this.model.id,showCDF:e})}},()=>this.controller.s("graphing-calculator-button-find-cdf")),qn.createElement(fB,{predicate:()=>zc(this.model)},()=>qn.createElement("div",null,qn.createElement("span",{class:qn.const("dcg-cdf-limit-name")},()=>this.controller.s("graphing-calculator-label-cdf-minimum")),qn.createElement(lr,{handleFocusChanged:e=>this.handleFocusedChanged("min",e),latex:()=>xy(this.model),hasError:()=>!Cy(this.model),isFocused:()=>this.isInputFocused("min"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-cdf-minimum"),placeholder:()=>SO(this.model),handlePressedKey:(e,r)=>this.handlePressedKey(e,r,"min"),controller:this.props.controller,handleLatexChanged:this.bindFn(this.updateCDFMin),readonly:()=>this.controller.isItemReadonly(this.model.id)}),qn.createElement("span",{class:qn.const("dcg-cdf-limit-name")},()=>this.controller.s("graphing-calculator-label-cdf-maximum")),qn.createElement(lr,{handleFocusChanged:e=>this.handleFocusedChanged("max",e),latex:()=>vy(this.model),hasError:()=>!Dy(this.model),isFocused:()=>this.isInputFocused("max"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-cdf-maximum"),placeholder:()=>EO(this.model),handlePressedKey:(e,r)=>this.handlePressedKey(e,r,"max"),controller:this.props.controller,handleLatexChanged:this.bindFn(this.updateCDFMax),readonly:()=>this.controller.isItemReadonly(this.model.id)}),qn.createElement(fB,{predicate:this.bindFn(this.showEvaluation)},()=>qn.createElement("div",{class:qn.const("dcg-cdf-evaluation-container")},qn.createElement(cu,{val:()=>rC(this.model),controller:this.props.controller,dependent:this.const(""),id:()=>this.model.id,focusable:this.const(!0)}))))))}handlePressedKey(e,r,i){if(e==="Esc"){this.controller.dispatch({type:"set-focus-location",location:void 0});return}if(e==="Enter")return this.controller.dispatch({type:"on-special-key-pressed",key:"Enter"});var n=Xe.getFocusedMathquill();n&&(n.keystroke(e,r),i==="min"&&xy(this.model)!==n.latex()&&this.updateCDFMin(n.latex()),i==="max"&&vy(this.model)!==n.latex()&&this.updateCDFMax(n.latex()))}updateCDFMax(e){this.controller.dispatch({type:"set-cdf-max",id:this.model.id,latex:e})}updateCDFMin(e){this.controller.dispatch({type:"set-cdf-min",id:this.model.id,latex:e})}showEvaluation(){return!(!Dy(this.model)||!Cy(this.model))}isInputFocused(e){let r=this.controller.getFocusLocation();return!r||r.type!=="cdf-limit"||r.id!==this.id?!1:r.location===e}handleFocusedChanged(e,r){r?this.controller.dispatch({type:"set-focus-location",location:{type:"cdf-limit",id:this.id,location:e}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"cdf-limit",id:this.id,location:e}})}};var Uo=__dcg_shared_module_exports__['i'](Z());var{If:K$,For:yB,SwitchUnion:U$}=Uo.Components,fm=class extends Uo.Class{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return U$(this.bindFn(this.getSuggestionType),{list:()=>Uo.createElement(yB,{each:this.bindFn(this.getListOfParameters)},Uo.createElement("div",{class:()=>({"dcg-parameter-suggestion-container":!0,"dcg-parameter-suggestion-braille":this.controller.getBrailleMode()!=="none"})},e=>Uo.createElement("span",{class:Uo.const("dcg-parameter-name")},()=>this.getParamName(e)))),listWithDefault:()=>Uo.createElement(yB,{each:this.bindFn(this.getListOfParameters)},Uo.createElement("div",{class:()=>({"dcg-parameter-suggestion-container":!0,"dcg-parameter-suggestion-braille":this.controller.getBrailleMode()!=="none"}),onTap:this.bindFn(this.fillInDefaults)},e=>Uo.createElement("span",{class:Uo.const("dcg-parameter-name")},()=>this.getParamName(e),Uo.createElement(K$,{predicate:()=>this.shouldShowDefaultValue(e)},()=>Uo.createElement("span",{class:Uo.const("dcg-default-marker")},Uo.const("= "),()=>this.getDefaultValue(e)))))),individual:()=>Uo.createElement("div",{class:()=>({"dcg-parameter-suggestion-container":!0,"dcg-parameter-suggestion-braille":this.controller.getBrailleMode()!=="none"})},this.bindFn(this.getMissingRequiredParamText)),none:()=>{}})}getExtractedAndDefaultArgString(e){let{params:r,values:i,defaults:n}=e;return r.map((s,a)=>{let l=i[s],c=n[a];return l||c||""}).join(",")}fillInDefaults(){let e=qa(this.model);if(!e)return;let{symbol:r,span:i}=e,{input:n,start:o,end:s}=i,a=this.getExtractedAndDefaultArgString(e),l=`\\operatorname{${r}}\\left(${a}\\right)`,c=`${n.slice(0,o)}${l}${n.slice(s)}`;this.controller.dispatch({type:"set-item-latex",id:this.id,latex:c}),this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:this.id}}),this.controller.dispatch({type:"keypad/press-key",key:"Left"})}isMissingDefault(){if(!wy(this.model))return!1;let e=qa(this.model);if(!e)return!1;for(var r=0;r<e.params.length;r++)if(this.shouldShowDefaultValue(e.params[r]))return!0;return!1}getSuggestionType(){return this.getListOfParameters().length>1?this.isMissingDefault()?"listWithDefault":"list":this.missingRequiredParam()?"individual":"none"}missingRequiredParam(){let e=qa(this.model);if(e&&e.params.length===1){var r=e.params[0];if(!this.getDefaultValue(r)&&!this.getParameterExtractedValue(r))return r}}getMissingRequiredParamText(){var e=this.missingRequiredParam();return e?this.controller.s("graphing-calculator-text-enter-pareneter",{param:this.getParamName(e)}):""}getDefaultValue(e){let r=qa(this.model);if(!r||!r.params)return"";for(let i=0;i<r.params.length;i++)if(r.params[i]===e)return r.defaults[i]||"";return""}getParameterExtractedValue(e){let r=qa(this.model);return r&&r.values[e]||""}shouldShowDefaultValue(e){return!this.getParameterExtractedValue(e)&&!!this.getDefaultValue(e)}getListOfParameters(){let e=qa(this.model);return e?e.params:[]}getParamName(e){switch(e){case"mean":return this.controller.s("graphing-calculator-text-parameter-name-mean");case"stdev":return this.controller.s("graphing-calculator-text-parameter-name-stddev");case"dof":return this.controller.s("graphing-calculator-text-parameter-name-dof");case"probsuccess":return this.controller.s("graphing-calculator-text-parameter-name-probsuccess");case"trials":return this.controller.s("graphing-calculator-text-parameter-name-trials");case"data":return this.controller.s("graphing-calculator-text-parameter-name-data");case"binwidth":return this.controller.s("graphing-calculator-text-parameter-name-binwidth");case"min":return this.controller.s("graphing-calculator-text-parameter-name-min");case"max":return this.controller.s("graphing-calculator-text-parameter-name-max");case"height":return this.controller.s("graphing-calculator-text-parameter-name-height");case"offset":return this.controller.s("graphing-calculator-text-parameter-name-offset");default:return e}}};var{If:q$}=Xa.Components,Xb=class extends Xa.Class{template(){return this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id,Xa.createElement("div",{class:Xa.const("dcg-distribution-parameters-container dcg-do-blur"),tapboundary:Xa.const("true"),handleEvent:Xa.const("true")},Xa.createElement(fm,{model:this.props.model,controller:this.props.controller}),Xa.createElement(q$,{predicate:()=>iI(this.model)},()=>Xa.createElement(Yb,{model:this.props.model,controller:this.props.controller})))}};var zt=__dcg_shared_module_exports__['i'](Z());var{SwitchUnion:H$,If:bB}=zt.Components,ym=class extends zt.Class{template(){return zt.createElement("div",{class:zt.const("dcg-toggle-container")},zt.createElement("div",{class:zt.const("dcg-expression-footer-title")},this.props.title,zt.createElement(bB,{predicate:()=>!!this.props.helpLink},()=>zt.createElement("a",{"aria-label":()=>this.props.controller().s("account-shell-link-help"),class:zt.const("dcg-expression-footer-title-help"),target:zt.const("_blank"),href:this.props.helpLink},zt.createElement("i",{class:zt.const("dcg-icon-question-sign"),"aria-hidden":zt.const("true")})))),zt.createElement(jr,{staticConfig:this.bindFn(this.getSegmentedControlOptions),ariaGroupLabel:this.props.title,disabled:this.bindFn(this.isReadonly),theme:this.const("mini"),minButtonWidth:this.const(65)}))}isReadonly(){return this.props.controller().isItemReadonly(this.props.model().id)}getSegmentedControlOptions(){return this.props.options().map(e=>({key:e.name,label:()=>e.displayName,selected:()=>this.isSelected(e.name),onSelect:()=>{this.props.controller().dispatch({type:"set-visualization-prop",id:this.props.model().id,prop:this.props.vizProp(),value:e.name})}}))}isSelected(e){return Ld(this.props.model(),this.props.vizProp())===e}},Qb=class extends zt.Class{template(){return this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id,zt.createElement("div",{class:zt.const("dcg-visualization-parameters-container dcg-do-blur"),tapboundary:zt.const("true"),handleEvent:zt.const("true")},zt.createElement(fm,__dcg_shared_module_exports__['b']({},this.props)),zt.createElement("div",{class:zt.const("dcg-smaller-font")},H$(()=>this.getVisualizationType(),{boxplot:()=>zt.createElement("div",null,zt.createElement("div",{class:zt.const("dcg-expression-footer-title")},()=>this.controller.s("graphing-calculator-heading-visual-parameters-display-properties")),this.makeMQInput({prop:"axisOffset",siblingProps:["breadth"],default:"1",name:()=>this.controller.s("graphing-calculator-narration-visual-parameters-offset")}),this.makeMQInput({prop:"breadth",siblingProps:["axisOffset"],default:"1",name:()=>Ld(this.model,"alignedAxis")==="y"?this.controller.s("graphing-calculator-narration-visual-parameters-width"):this.controller.s("graphing-calculator-narration-visual-parameters-height")}),zt.createElement(Dt,{checked:()=>!!Ld(this.model,"showBoxplotOutliers"),disabled:()=>this.controller.isItemReadonly(this.model.id),onChange:this.bindFn(this.onToggleOutliers)},zt.createElement("span",{class:zt.const("dcg-parameter-name")},()=>this.controller.s("graphing-calculator-button-visual-parameters-exclude-outliers")))),dotplot:()=>zt.createElement(bB,{predicate:()=>FP(this.model)},()=>zt.createElement("div",{class:zt.const("dcg-toggles-container")},zt.createElement(ym,__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.props),{vizProp:()=>"dotplotXMode",options:()=>[{name:"exact",displayName:this.controller.s("graphing-calculator-button-visual-parameters-exact")},{name:"bin",displayName:this.controller.s("graphing-calculator-button-visual-parameters-binned")}],title:()=>this.controller.s("graphing-calculator-heading-visual-parameters-x-values")})),zt.createElement(ym,__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.props),{vizProp:()=>"binAlignment",options:()=>[{name:"center",displayName:this.controller.s("graphing-calculator-button-visual-parameters-center")},{name:"left",displayName:this.controller.s("graphing-calculator-button-visual-parameters-left")}],title:()=>this.controller.s("graphing-calculator-heading-visual-parameters-bin-alignment")})))),histogram:()=>zt.createElement("div",{class:zt.const("dcg-toggles-container")},zt.createElement(ym,__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.props),{vizProp:()=>"histogramMode",options:()=>[{name:"",displayName:this.controller.s("graphing-calculator-button-visual-parameters-count")},{name:"relative",displayName:this.controller.s("graphing-calculator-button-visual-parameters-relative")},{name:"density",displayName:this.controller.s("graphing-calculator-button-visual-parameters-density")}],title:()=>this.controller.s("graphing-calculator-heading-visual-parameters-bar-heights"),helpLink:this.const("https://help.desmos.com/hc/en-us/articles/360022405991")})),zt.createElement(ym,__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.props),{vizProp:()=>"binAlignment",options:()=>[{name:"center",displayName:this.controller.s("graphing-calculator-button-visual-parameters-center")},{name:"left",displayName:this.controller.s("graphing-calculator-button-visual-parameters-left")}],title:()=>this.controller.s("graphing-calculator-heading-visual-parameters-bin-alignment")}))),none:()=>zt.createElement("span",null)})))}makeMQInput(e){return zt.createElement("span",null,zt.createElement("span",{class:zt.const("dcg-parameter-name")},e.name,zt.const(":")),zt.createElement(lr,{latex:()=>this.getPropLatex(e),ariaLabel:e.name,placeholder:()=>e.default,isFocused:()=>this.isInputFocused(e.prop),hasError:()=>!PP(this.model,e.prop),handleFocusChanged:r=>this.handleFocusedChanged(e.prop,r),handlePressedKey:(r,i)=>this.handlePressedKey(r,i,e.prop),handleLatexChanged:r=>this.handleLatexChanged(e.prop,r),readonly:()=>this.controller.isItemReadonly(this.model.id),controller:this.props.controller}))}handlePressedKey(e,r,i){if(e==="Esc"){this.controller.dispatch({type:"set-focus-location",location:void 0});return}if(e==="Enter")return this.controller.dispatch({type:"on-special-key-pressed",key:"Enter"});var n=Xe.getFocusedMathquill();n&&(n.keystroke(e,r),this.handleLatexChanged(i,n.latex()))}isInputFocused(e){let r=this.controller.getFocusLocation();return!r||r.type!=="visualization-prop"||r.id!==this.id?!1:r.location===e}handleFocusedChanged(e,r){r?this.controller.dispatch({type:"set-focus-location",location:{type:"visualization-prop",id:this.id,location:e}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"visualization-prop",id:this.id,location:e}})}getPropLatex({prop:e}){let r=Ld(this.model,e);return typeof r=="string"?r:""}handleLatexChanged(e,r){Ld(this.model,e)!==r&&this.controller.dispatch({type:"set-visualization-prop",id:this.id,prop:e,value:r})}onToggleOutliers(){var e=Ld(this.model,"showBoxplotOutliers");this.controller.dispatch({type:"set-visualization-prop",id:this.id,prop:"showBoxplotOutliers",value:!e})}getVisualizationType(){return wy(this.model)?Nh(this.model)?"boxplot":Od(this.model)?"dotplot":Hp(this.model)?"histogram":"none":"none"}};var $t=__dcg_shared_module_exports__['i'](Z());var Zb=class extends $t.Class{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return $t.createElement("div",{class:$t.const("dcg-ttest-footer-container dcg-do-blur"),handleEvent:$t.const("true")},$t.createElement("table",null,$t.createElement("tr",null,$t.createElement("td",null,$t.createElement("div",{class:$t.const("dcg-value"),role:$t.const("textbox"),"aria-readonly":$t.const("true"),tabindex:$t.const("0"),"aria-label":()=>"Less than: "+this.getLessThan()},$t.createElement("span",{class:$t.const("dcg-operator")},$t.createElement(et,{config:this.const({}),latex:this.const("<")})),$t.createElement("span",{class:$t.const("dcg-evaluation")},$t.createElement(et,{config:this.const({}),latex:()=>this.getLessThan()}))))),$t.createElement("tr",null,$t.createElement("td",null,$t.createElement("div",{class:$t.const("dcg-value"),role:$t.const("textbox"),"aria-readonly":$t.const("true"),tabindex:$t.const("0"),"aria-label":()=>"Greater than: "+this.getGreaterThan()},$t.createElement("span",{class:$t.const("dcg-operator")},$t.createElement(et,{config:this.const({}),latex:this.const(">")})),$t.createElement("span",{class:$t.const("dcg-evaluation")},$t.createElement(et,{config:this.const({}),latex:()=>this.getGreaterThan()}))))),$t.createElement("tr",null,$t.createElement("td",null,$t.createElement("div",{class:$t.const("dcg-value"),role:$t.const("textbox"),"aria-readonly":$t.const("true"),tabindex:$t.const("0"),"aria-label":()=>"Not equal: "+this.getNotEqual()},$t.createElement("span",{class:$t.const("dcg-operator")},$t.createElement(et,{config:this.const({}),latex:this.const("\u2260")})),$t.createElement("span",{class:$t.const("dcg-evaluation")},$t.createElement(et,{config:this.const({}),latex:()=>this.getNotEqual()})))))))}getLessThan(){var e=cg(this.model);return e?__dcg_shared_module_exports__['mc'](e.lessThan,5):""}getGreaterThan(){var e=cg(this.model);return e?__dcg_shared_module_exports__['mc'](e.greaterThan,5):""}getNotEqual(){var e=cg(this.model);return e?__dcg_shared_module_exports__['mc'](e.notEqual,5):""}};var nt=__dcg_shared_module_exports__['i'](Z());var ew=class extends nt.Class{template(){return this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id,nt.createElement("div",{class:nt.const("dcg-stats-footer-container dcg-do-blur"),handleEvent:nt.const("true")},nt.createElement("table",null,nt.createElement("tr",null,nt.createElement("td",null,nt.createElement("div",{class:nt.const("dcg-value"),role:nt.const("textbox"),"aria-readonly":nt.const("true"),tabindex:nt.const("0"),"aria-label":()=>"Min: "+this.getMin()},nt.createElement("span",{class:nt.const("dcg-row-header")},nt.const("Min")),nt.createElement("span",{class:nt.const("dcg-evaluation")},nt.createElement(et,{config:this.const({}),latex:this.bindFn(this.getMin)}))))),nt.createElement("tr",null,nt.createElement("td",null,nt.createElement("div",{class:nt.const("dcg-value"),role:nt.const("textbox"),"aria-readonly":nt.const("true"),tabindex:nt.const("0"),"aria-label":()=>"Q1: "+this.getQ1()},nt.createElement("span",{class:nt.const("dcg-row-header")},nt.const("Q1")),nt.createElement("span",{class:nt.const("dcg-evaluation")},nt.createElement(et,{config:this.const({}),latex:this.bindFn(this.getQ1)}))))),nt.createElement("tr",null,nt.createElement("td",null,nt.createElement("div",{class:nt.const("dcg-value"),role:nt.const("textbox"),"aria-readonly":nt.const("true"),tabindex:nt.const("0"),"aria-label":()=>"Median: "+this.getMedian()},nt.createElement("span",{class:nt.const("dcg-row-header")},nt.const("Median")),nt.createElement("span",{class:nt.const("dcg-evaluation")},nt.createElement(et,{config:this.const({}),latex:this.bindFn(this.getMedian)}))))),nt.createElement("tr",null,nt.createElement("td",null,nt.createElement("div",{class:nt.const("dcg-value"),role:nt.const("textbox"),"aria-readonly":nt.const("true"),tabindex:nt.const("0"),"aria-label":()=>"Q3: "+this.getQ3()},nt.createElement("span",{class:nt.const("dcg-row-header")},nt.const("Q3")),nt.createElement("span",{class:nt.const("dcg-evaluation")},nt.createElement(et,{config:this.const({}),latex:this.bindFn(this.getQ3)}))))),nt.createElement("tr",null,nt.createElement("td",null,nt.createElement("div",{class:nt.const("dcg-value"),role:nt.const("textbox"),"aria-readonly":nt.const("true"),tabindex:nt.const("0"),"aria-label":()=>"Max: "+this.getMax()},nt.createElement("span",{class:nt.const("dcg-row-header")},nt.const("Max")),nt.createElement("span",{class:nt.const("dcg-evaluation")},nt.createElement(et,{config:this.const({}),latex:this.bindFn(this.getMax)})))))))}getMin(){let e=dg(this.model);return e?__dcg_shared_module_exports__['lc'](e.min):""}getQ1(){let e=dg(this.model);return e?__dcg_shared_module_exports__['lc'](e.q1):""}getMedian(){let e=dg(this.model);return e?__dcg_shared_module_exports__['lc'](e.median):""}getQ3(){let e=dg(this.model);return e?__dcg_shared_module_exports__['lc'](e.q3):""}getMax(){let e=dg(this.model);return e?__dcg_shared_module_exports__['lc'](e.max):""}};var In=__dcg_shared_module_exports__['i'](Z());var{If:z$}=In.Components,pu=class extends In.Class{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return In.createElement("div",{class:In.const("dcg-action-info"),handleEvent:In.const("true")},In.createElement("span",{class:In.const("dcg-action-label")},In.const("Run ")),In.createElement(et,{latex:()=>this.model.clickableInfo.latex,config:this.bindFn(this.getMQConfig)}),In.createElement("span",{class:In.const("dcg-action-label")},In.const(" on click")),In.createElement(z$,{predicate:()=>!this.controller.isItemReadonly(this.model.id)},()=>In.createElement("span",{class:In.const("dcg-click-edit"),role:In.const("button"),tabindex:In.const("0"),"aria-label":()=>this.controller.s("graphing-calculator-narration-edit-action"),onTap:this.bindFn(this.editAction)},In.createElement("i",{class:In.const("dcg-icon-pencil"),"aria-hidden":In.const("true")}))))}editAction(){this.model.type==="expression"?this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"expression",model:this.model,guid:this.getMenuGUID(),focusFirstOption:!1}}):this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"image",model:this.model,guid:this.getMenuGUID(),focusFirstOption:!1}}),this.controller.dispatch({type:"set-focus-location",location:{type:"expression-menu",id:this.model.id,location:"updaterule"}})}getMenuGUID(){return this.model.guid}getMQConfig(){return{autoOperatorNames:da({additionalOperators:["index"]}),autoCommands:Kc()}}};var qt=__dcg_shared_module_exports__['i'](Z());var{If:sS}=qt.Components,Cl=class extends qt.Class{init(){this.controller=this.props.controller()}template(){return qt.createElement(sS,{predicate:this.bindFn(this.shouldShowOptions)},()=>qt.createElement("span",{class:()=>({"dcg-expression-edit-actions":!0,"dcg-limited-height":this.limitedHeight()}),style:()=>({background:this.controller.getBackgroundColor()}),didMount:()=>{this.controller.isInEditListMode()&&me(this.controller.s("graphing-calculator-narration-edit-list-mode-on"))},didUnmount:()=>{this.controller.isInEditListMode()||me(this.controller.s("graphing-calculator-narration-edit-list-mode-off"))}},qt.createElement(sS,{predicate:()=>!this.controller.hasBackgroundColor()},()=>qt.createElement("span",{class:qt.const("dcg-graphic"),handleEvent:qt.const("true ")})),qt.createElement(sS,{predicate:this.bindFn(this.canConvertToTable)},()=>qt.createElement(Pe,{tooltip:this.bindFn(this.getConvertTooltip),gravity:this.const("s")},qt.createElement("span",{class:qt.const("dcg-action-createtable dcg-exp-action-button"),handleEvent:qt.const("true"),role:qt.const("button"),tabindex:qt.const("0"),"aria-label":()=>this.controller.s("graphing-calculator-label-convert-to-table-tooltip"),onTap:this.bindFn(this.onCreateTable)},qt.createElement("i",{class:qt.const("dcg-icon-table"),"aria-hidden":qt.const("true")})))),qt.createElement(sS,{predicate:()=>this.controller.shouldShowAuthorFeatures()},()=>qt.createElement(Pe,{tooltip:this.bindFn(this.getReadonlyToggleLabel),gravity:this.const("s")},qt.createElement("span",{class:()=>({"dcg-action-createtable":!0,"dcg-exp-action-button":!0,"dcg-selected":this.isReadonly()}),handleEvent:qt.const("true"),role:qt.const("button"),tabindex:qt.const("0"),"aria-label":this.bindFn(this.getReadonlyToggleLabel),onTap:this.bindFn(this.onToggleReadonly)},qt.createElement("i",{class:qt.const("dcg-icon-lock"),"aria-hidden":qt.const("true")})))),qt.createElement(Pe,{tooltip:()=>this.controller.s("graphing-calculator-label-duplicate-expression-tooltip"),gravity:this.const("s")},qt.createElement("span",{class:qt.const("dcg-duplicate-btn dcg-exp-action-button"),handleEvent:qt.const("true"),role:qt.const("button"),tabindex:qt.const("0"),"aria-label":()=>this.controller.s("graphing-calculator-label-duplicate-expression-tooltip"),onTap:this.bindFn(this.onDuplicateWithoutFocus)},qt.createElement("i",{class:qt.const("dcg-icon-duplicate"),"aria-hidden":qt.const("true")}))),qt.createElement(Pe,{tooltip:()=>this.controller.s("graphing-calculator-label-expression-delete-tooltip"),gravity:this.const("sw")},qt.createElement("span",{class:qt.const("dcg-delete-btn dcg-exp-action-button"),handleEvent:qt.const("true"),role:qt.const("button"),tabindex:qt.const("0"),"aria-label":()=>this.controller.s("graphing-calculator-label-expression-delete-tooltip"),onTap:this.bindFn(this.onDelete)},qt.createElement("i",{class:qt.const("dcg-icon-remove"),"aria-hidden":qt.const("true")})))))}shouldShowOptions(){return this.controller.isInEditListMode()&&(this.controller.shouldShowAuthorFeatures()||!this.controller.isItemReadonly(this.props.id()))}model(){return this.controller.getItemModel(this.props.id())}getConvertTooltip(){return this.shouldInsertOnCreateTable()?this.controller.s("graphing-calculator-label-convert-to-table-tooltip"):this.controller.s("graphing-calculator-label-create-table")}canConvertToTable(){let e=this.model();return!!(e&&e.type==="expression"&&e.formula.is_tableable)}limitedHeight(){let e=this.model();return e&&(e.type==="image"||this.isSlider())}isSlider(){let e=this.model();return e&&e.type==="expression"&&e.sliderExists}generateSubscriptedTableColumns(e,r,i){var n={independent:r,dependent:i};if(r==="x")return n;var o=__dcg_shared_module_exports__['fc'](r);if(o.type!=="Identifier")return n;var s=__dcg_shared_module_exports__['fc'](i);if(s.type!=="FunctionCall"||s.args.length!==1)return n;var a=s.args[0];if(a.type!=="Identifier"||a._symbol!==r)return n;let l=s.getInputString(),c=a.getInputSpan(),d=l.substr(0,c.start),u=l.substr(c.end);return n.independent="x_{"+e+"}",n.dependent=d+n.independent+u,n}shouldInsertOnCreateTable(){let e=this.model();return!!e&&e.type==="expression"&&gl(e)}onCreateTable(){let e=this.model();if(!(!e||e.type!=="expression")){var r=e.formula;if(r.is_tableable&&r.table_info){var i=r.table_info,n=e.index,o=i.independent_variable,s=i.dependent_column;if(i.by_reference){let x=this.generateSubscriptedTableColumns(this.controller.generateTableXSubscript(),o,s);o=x.independent,s=x.dependent}var a,l=[],c=[];if(i.values)for(a=0;a<i.values.length;a++){var d=i.values[a][0];l.push(isNaN(d)?"":d+"");var u=i.values[a][1];c.push(isNaN(u)?"":u+"")}else for(a=-2;a<=2;a++)l.push(a+""),c.push("");var p={id:this.controller.generateId(),type:"table",readonly:!i.by_reference&&e.readonly,columns:[{id:this.controller.generateId(),latex:o,color:this.controller.getNextColor(),hidden:!1,values:l,points:!0,lines:!1,dragMode:"NONE",pointStyle:"POINT",lineStyle:"SOLID",colorLatex:"",lineOpacity:"",lineWidth:"",pointOpacity:"",pointSize:""},{id:this.controller.generateId(),latex:s,color:Zl(e),hidden:!1,values:c,points:!0,lines:this.shouldInsertOnCreateTable()&&!!e.lines,dragMode:"NONE",pointStyle:"POINT",lineStyle:"SOLID",colorLatex:"",lineOpacity:"",lineWidth:"",pointOpacity:"",pointSize:""}]},g=this.controller;this.controller.dispatch({type:"set-edit-list-mode",isEditListMode:!1,focusExpressionList:!1}),this.shouldInsertOnCreateTable()?this.controller.dispatch({type:"replace-item-at-index",index:n,state:p,focus:!0}):this.controller.dispatch({type:"insert-item-at-index",index:n+1,state:p,folderId:e.folderId,focus:!0});var b=function(){g.dispatch({type:"undo"}),g.dispatch({type:"set-edit-list-mode",isEditListMode:!0,focusExpressionList:!1})};this.controller.dispatch({type:"toast/show",toast:{message:this.controller.s("graphing-calculator-text-table-created"),undoCallback:b}})}}}onDelete(e){this.controller.dispatch({type:"delete-item-and-animate-out",id:this.props.id(),setFocusAfterDelete:e.device==="keyboard"})}onDuplicateWithoutFocus(){let e=this.model();e&&(e.type==="folder"?this.controller.dispatch({type:"duplicate-folder",id:this.props.id()}):this.controller.dispatch({type:"duplicate-expression",id:this.props.id()}))}isReadonly(){return this.controller.isItemReadonly(this.props.id())}onToggleReadonly(){let e=this.model();e&&this.controller.dispatch({type:"set-item-readonly",id:this.props.id(),readonly:!e.readonly})}getReadonlyIcon(){return this.isReadonly()?"dcg-icon-lock":"dcg-icon-pencil"}getReadonlyToggleLabel(){return this.isReadonly()?this.controller.s("graphing-calculator-label-unlock-expression-tooltip"):this.controller.s("graphing-calculator-label-lock-expression-tooltip")}};var js=__dcg_shared_module_exports__['i'](Z());var{If:$$}=js.Components,bm=class extends js.Class{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return js.createElement($$,{predicate:()=>this.controller.showExpressionZoomFitButton(this.model)},()=>js.createElement("div",{class:js.const("dcg-suggested-zoom-view dcg-do-blur"),handleEvent:js.const(!0)},js.createElement(Pe,{tooltip:this.bindFn(this.getZoomText),gravity:()=>"e"},js.createElement("i",{onTap:this.bindFn(this.onZoom),role:js.const("button"),tabindex:js.const("0"),"aria-label":this.bindFn(this.getZoomText),class:js.const("dcg-icon-zoom-fit")}))))}getZoomText(){return this.controller.s("graphing-calculator-text-zoom-fit")}onZoom(e){this.controller.dispatch({type:"expression-zoom-fit",id:this.model.id,focusAfterTap:e.device==="keyboard"})}};var lt=__dcg_shared_module_exports__['i'](Z());var Go=__dcg_shared_module_exports__['i'](Z()),{Switch:W$}=Go.Components,Dl=class extends Go.Class{iconType(){return this.props.controller().shouldShowReplaceIcon()?"rename":this.props.controller().isItemReadonly(this.props.id())?this.props.controller().shouldShowAuthorFeatures()?"lock":"none":"delete"}onDelete(){this.props.controller().dispatch({type:"delete-item-and-animate-out",id:this.props.id(),setFocusAfterDelete:!this.props.controller().isInEditListMode()})}onRenameInItem(){this.props.controller().dispatch({type:"rename-identifier-in-item",search:this.props.controller().getExpressionSearchStr(),replace:this.props.controller().getExpressionReplaceStr(),id:this.props.id()})}template(){return Go.createElement("div",{class:Go.const("dcg-top-level-icon")},Go.createElement(W$,{key:()=>this.iconType()},e=>{switch(e){case"delete":return Go.createElement("i",{class:Go.const("dcg-icon-remove dcg-top-level-delete"),handleEvent:Go.const("true"),onTap:this.bindFn(this.onDelete),"aria-hidden":Go.const("true")});case"lock":return Go.createElement("i",{class:Go.const("dcg-icon-lock dcg-lock-indicator"),"aria-hidden":Go.const("true")});case"rename":return Go.createElement("i",{class:Go.const("dcg-icon-replace"),handleEvent:Go.const("true"),onTap:this.bindFn(this.onRenameInItem)});case"none":return Go.createElement("span",null)}}))}};var{If:op,SwitchUnion:J$}=lt.Components,tw=class extends $s{didMount(){this.onItemViewMounted(),this.lastBrailleMode=this.controller.getBrailleMode()}didMountRootNode(e){this.rootNode=e}willUnmount(){this.onItemViewUnmounted()}template(){return lt.createElement("div",{class:()=>({"dcg-do-not-blur":!0,"dcg-expressionitem":!0,"dcg-mathitem":!0,"dcg-inFolder":!!this.model.folderId,"dcg-readonly":this.controller.isItemReadonly(this.id),"dcg-selected":this.controller.isItemSelected(this.id)&&!this.controller.isInEditListMode(),"dcg-dragging":!!this.controller.isItemBeingDragged(this.id),"dcg-hasSlider":this.hasSlider(),"dcg-hasEvaluation":this.controller.shouldShowEvaluationForItem(this.id),"dcg-hasRegression":this.hasRegression(),"dcg-hasDomain":this.hasDomain()||this.hasDomain3d()}),"expr-id":()=>this.model.id,didMount:this.bindFn(this.didMountRootNode)},lt.createElement("div",{class:lt.const("dcg-fade-container"),onTapStart:this.bindFn(this.onMouseSelect),onTap:this.bindFn(this.onMouseSelect)},lt.createElement("div",{class:lt.const("dcg-main")},lt.createElement(op,{predicate:()=>!this.controller.isInEditListMode()&&!this.isReadonly()},()=>lt.createElement(kn,__dcg_shared_module_exports__['b']({latex:()=>ey(this.model),ariaLabel:()=>this.getAriaLabel("braille"),brailleShouldFocus:()=>this.isFocused(),onBrailleInput:e=>this.handleLatexChanged(e),onBrailleFocusedChanged:(e,r)=>this.handleMQFocusedChanged(e,r),onBrailleKeydown:this.bindFn(this.handleBraillePressedKey)},ko(this.controller)),lt.createElement(Xe,{latex:()=>ey(this.model),getAriaLabel:()=>this.getAriaLabel("speech"),getAriaPostLabel:this.bindFn(this.getFormulaAria),isFocused:()=>this.isFocused(),tokenController:this.props.controller,capExpressionSize:()=>this.controller.getCapExpressionSize(),config:this.bindFn(this.getMQConfig),hasError:this.const(!1),onUserPressedKey:(e,r)=>this.handlePressedKey(e,r),onUserChangedLatex:e=>this.handleLatexChanged(e),onExpressionSizeExceeded:()=>this.controller.dispatch({type:"expression-size-exceeded"}),onFocusedChanged:(e,r)=>this.handleMQFocusedChanged(e,r),onSelectionChanged:()=>{this.controller.dispatch({type:"render"})},needsSystemKeypad:()=>!this.controller.isKeypadEnabled()}))),lt.createElement(op,{predicate:()=>this.controller.isInEditListMode()||this.isReadonly()},()=>lt.createElement("div",{class:lt.const("dcg-edit-list-mathquill"),tabindex:()=>this.controller.getBrailleMode()==="none"?"0":"-1",onTap:()=>this.controller.isInEditListMode()?this.exitEditListMode():{},onKeydown:this.bindFn(this.handleReadonlyPressedKey),manageFocus:this.const({shouldBeFocused:()=>this.controller.getBrailleMode()!=="none"?!1:zy({controller:this.controller,location:{type:"readonly-expression",id:this.model.id}}),onFocusedChanged:(e,r)=>{this.controller.getBrailleMode()==="none"&&(e?this.controller.dispatch({type:"set-focus-location",location:{type:"readonly-expression",id:this.model.id}}):this.doesNodeBelongToSliderLimit(r.relatedTarget)||this.controller.dispatch({type:"blur-focus-location",location:{type:"readonly-expression",id:this.model.id}}))}})},lt.createElement(kn,__dcg_shared_module_exports__['b']({latex:()=>ey(this.model),ariaLabel:()=>this.getAriaLabel("braille"),isStatic:this.const(!0),brailleShouldFocus:()=>{let e=this.controller.getFocusLocation();return!e||e.type!=="readonly-expression"?!1:e.id===this.id},onBrailleFocusedChanged:(e,r)=>{e?this.controller.dispatch({type:"set-focus-location",location:{type:"readonly-expression",id:this.model.id}}):this.doesNodeBelongToSliderLimit(r.relatedTarget)||this.controller.dispatch({type:"blur-focus-location",location:{type:"readonly-expression",id:this.model.id}})}},ko(this.controller)),lt.createElement(et,{latex:()=>ey(this.model),config:this.bindFn(this.getMQConfig),getAriaLabel:()=>this.getAriaLabel("speech")}))))),lt.createElement(Dl,{controller:this.props.controller,id:()=>this.id}),lt.createElement(op,{predicate:this.bindFn(this.shouldShowFooter)},()=>lt.createElement("div",{class:this.getFooterClass()},J$(()=>this.getFooterType(),{none:()=>{},regression:()=>lt.createElement(zb,{model:this.props.model,controller:this.props.controller}),label:()=>lt.createElement(hu,{model:this.props.model,controller:this.props.controller}),slider:()=>lt.createElement(jb,{model:this.props.model,controller:this.props.controller}),domain:()=>lt.createElement(du,{model:this.props.model,controller:this.props.controller}),domain3d:()=>lt.createElement("div",null,lt.createElement(du,{model:this.props.model,controller:this.props.controller,parameter:()=>this.domainVariable1(this.props.model())}),lt.createElement(du,{model:this.props.model,controller:this.props.controller,parameter:()=>this.domainVariable2(this.props.model())})),evaluation:()=>lt.createElement(cu,{id:()=>this.props.model().id,dependent:()=>so(this.model)||"",val:()=>this.controller.getEvaluationValueForItem(this.id),controller:this.props.controller,focusable:this.const(!0)}),distribution:()=>lt.createElement(Xb,{model:this.props.model,controller:this.props.controller}),visualization:()=>lt.createElement(Qb,{model:this.props.model,controller:this.props.controller}),ttest:()=>lt.createElement(Zb,{model:this.props.model,controller:this.props.controller}),stats:()=>lt.createElement(ew,{model:this.props.model,controller:this.props.controller}),unresolved:()=>lt.createElement(Hb,{controller:this.props.controller})}),lt.createElement(op,{predicate:this.bindFn(this.shouldShowBrailleError)},()=>lt.createElement("div",{tabindex:lt.const(0),class:lt.const("dcg-expression-braille-error"),role:lt.const("button"),"aria-roledescription":lt.const("error"),"aria-label":()=>this.controller.unpack(this.model.error)},lt.createElement("i",{class:lt.const("dcg-icon-error"),"aria-hidden":lt.const("true")}),()=>this.controller.unpack(this.model.error))),lt.createElement(op,{predicate:this.bindFn(this.shouldShowSliderPrompt)},()=>lt.createElement(mc,{model:this.props.model,controller:this.props.controller})),lt.createElement(op,{predicate:this.bindFn(this.shouldShowRenamePrompt)},()=>lt.createElement(Jb,{from:this.bindFn(this.getRenameIdentifierFrom),to:this.bindFn(this.getRenameIdentifierTo),count:this.bindFn(this.getRenameCountOfChanges),handleRename:this.bindFn(this.handleRename)})),lt.createElement(op,{predicate:this.bindFn(this.shouldShowThreeDPrompt)},()=>lt.createElement("div",{class:lt.const("dcg-create-sliders"),handleEvent:lt.const("true"),onTap:this.bindFn(this.switchTo3D)},lt.createElement("div",{class:lt.const("dcg-slider-btn-container"),var_name:this.const("3D")},lt.createElement("div",{role:lt.const("button"),tabindex:lt.const("0"),class:lt.const("dcg-btn-slider dcg-btn-light-gray")},()=>"Switch to 3D")))))),lt.createElement(op,{predicate:this.bindFn(this.shouldShowActionInfo)},()=>lt.createElement("div",{class:this.getFooterClass()},lt.createElement(pu,{model:this.props.model,controller:this.props.controller})))),lt.createElement("span",{class:lt.const("dcg-tab dcg-action-drag dcg-action-icon-touch"),handleevent:lt.const("true"),tapboundary:lt.const("true"),disablescroll:lt.const("true"),onTapStart:this.bindFn(this.onDragPending)},lt.createElement("span",{class:lt.const("dcg-num")},()=>this.model.displayIndex),lt.createElement("div",{class:lt.const("dcg-tab-interior dcg-action-icon-mouse")},lt.createElement(qb,{model:this.props.model,controller:this.props.controller})),lt.createElement(bm,{model:this.props.model,controller:this.props.controller})),lt.createElement(Cl,{controller:this.props.controller,id:()=>this.model.id}))}domainVariable1(e){return Ua(e)?"\\theta":pa(e)?"r":"u"}domainVariable2(e){return Ua(e)?"\\phi":pa(e)?"\\theta":"v"}getRenameIdentifierFrom(){let e=this.controller.getSuggestedIdentifierRenameInfo(this.id);return e&&e.from||""}getRenameIdentifierTo(){let e=this.controller.getSuggestedIdentifierRenameInfo(this.id);return e&&e.to||""}getRenameCountOfChanges(){let e=this.controller.getSuggestedIdentifierRenameInfo(this.id);return e&&e.countOfChanges||0}handleRename(){this.controller.dispatch({type:"rename-identifier-global",search:this.getRenameIdentifierFrom(),replace:this.getRenameIdentifierTo()})}didUpdate(){this.lastBrailleMode=this.controller.getBrailleMode()}shouldShowFooter(){return this.shouldShowBrailleError()||this.shouldShowSliderPrompt()||this.shouldShowRenamePrompt()||this.shouldShowThreeDPrompt()?!0:this.getFooterType()!=="none"}getFooterType(){return this.hasRegression()?"regression":this.shouldShowLabelView()?"label":this.hasSlider()?"slider":this.hasDomain()?"domain":this.hasDomain3d()?"domain3d":this.isTTest()?"ttest":this.isStats()?"stats":this.controller.shouldShowEvaluationForItem(this.id)?"evaluation":this.isToplevelDistribution()?"distribution":this.isVisualization()?"visualization":this.model.unresolved?"unresolved":"none"}shouldShowThreeDPrompt(){var e;return this.controller.is3D()&&!this.controller.isThreeDMode()&&__dcg_shared_module_exports__['ic']((e=this.model.formula.graphMode3d)!=null?e:10)}switchTo3D(){this.controller.setGrapher(this.controller.grapher3d||this.controller.grapher2d),this.controller.dispatch({type:"set-graph-settings",threeDMode:!0})}getFooterClass(){return this.isFirstRender()?this.const("dcg-expression-bottom dcg-indent-in-folder"):this.const("dcg-expression-bottom dcg-indent-in-folder dcg-fadein-bottom")}onCreateSliders(e){this.controller.dispatch({type:"create-sliders-for-item",id:this.id,variables:e})}shouldShowLabelView(){return mi("labels")&&xO(this.model)}shouldShowSliderPrompt(){return this.controller.areSlidersEnabled()?Vv(this.model).length>0:!1}shouldShowRenamePrompt(){return this.getRenameCountOfChanges()>0}shouldShowActionInfo(){return!!(this.controller.areActionsEnabled()&&this.model.clickableInfo&&this.model.clickableInfo.enabled&&this.model.clickableInfo.latex)}shouldShowBrailleError(){return this.controller.getBrailleMode()!=="none"&&this.hasError()}hasRegression(){return!!(this.model.formula&&this.model.formula.is_regression)}hasDomain(){return Hv(this.model)}hasDomain3d(){return zv(this.model)}isToplevelDistribution(){return Bh(this.model)}isVisualization(){return Jv(this.model)}isTTest(){return Yv(this.model)}isStats(){return CO(this.model)}hasSlider(){return!!this.model.sliderExists}getLabelOptions(){return this.controller.getEvaluationLabelOptionsForItem(this.model.id)}getAriaLabel(e){if(this.shouldShowLabelView()){var r;this.model.label&&this.model.label!==""?r=this.model.label:e==="speech"?r=this.controller.s("graphing-calculator-narration-expression-label"):r=this.controller.raw("lbl");var i;return this.model.showLabel?i=r:e==="speech"?i=this.controller.s("graphing-calculator-narration-expression-hidden-label",{label:r}):i=this.controller.raw("h __label__",{label:r}),i}return e==="speech"?this.controller.s("shared-calculator-narration-expression-index",{index:this.model.displayIndex}):this.controller.raw("eq__index__",{index:this.model.displayIndex})}getFormulaAria(){let e=this.model.formula,r="";if(!e||ua(this.model))return r;if(this.controller.shouldShowEvaluationForItem(this.id)){r="equals ";let i=e.zero_values&&e.zero_values.length?e.zero_values[0].val:e.constant_value;Array.isArray(i)?r+=i.length+" element list.":i!==void 0&&(r+=fs(__dcg_shared_module_exports__['Gb'](+i,this.getLabelOptions())))}else e.error&&!this.shouldShowSliderPrompt()?r=this.controller.unpack(e.error):Bh(this.model)?r=this.controller.s("graphing-calculator-narration-expression-evaluation-is-distribution"):this.isTTest()&&(r=this.controller.s("graphing-calculator-narration-expression-evaluation-is-t-test"));if(this.model.shouldGraph&&(e.is_graphable||e.is_regression)){e.is_graphable&&e.is_regression?r+=" "+this.controller.s("graphing-calculator-narration-expression-evaluation-has-graph-and-regression"):e.is_regression?r+=" "+this.controller.s("graphing-calculator-narration-expression-evaluation-has-regression"):r+=" "+this.controller.s("graphing-calculator-narration-expression-evaluation-has-graph");let i=this.controller.getAudioGraph();i&&i.agNavigator.canTrace(this.model)&&(Zr?r+=" "+this.controller.s("graphing-calculator-narration-expression-audio-trace-mac"):r+=" "+this.controller.s("graphing-calculator-narration-expression-audio-trace-windows"))}return r}handleBraillePressedKey(e){let r=Te(e);if(r){if(r==="Esc")ti(),this.hasSlider()&&this.controller.dispatch({type:"set-focus-location",location:{type:"slider-thumb",id:this.model.id}});else if(r==="Up"||r==="Down"||r==="Enter")this.controller.dispatch({type:"on-special-key-pressed",key:r});else if(r==="Del"||r==="Backspace"){let i=zs();ua(this.model)&&gm(i)&&(this.controller.dispatch({type:"on-special-key-pressed",key:r==="Del"?"Delete":r}),e.preventDefault(),e.stopPropagation())}}}handleReadonlyPressedKey(e){if(this.controller.isInEditListMode())return;let r=Te(e);!e.altKey&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey&&(r==="Esc"?(e.preventDefault(),e.stopPropagation(),ti(),this.hasSlider()&&this.controller.dispatch({type:"set-focus-location",location:{type:"slider-thumb",id:this.model.id}})):(r==="Up"||r==="Down"||r==="Enter")&&(e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"on-special-key-pressed",key:r})))}handlePressedKey(e,r){var i=Xe.getFocusedMathquill();if(i){if(e==="Esc"){ti(),this.hasSlider()&&this.controller.dispatch({type:"set-focus-location",location:{type:"slider-thumb",id:this.model.id}});return}else if(e==="Up"||e==="Down"){var n=Xe.applyArrowKeyAndReturnIfWasAtBounds(i,e,r);return n?this.controller.dispatch({type:"on-special-key-pressed",key:e}):void 0}else if(e==="Delete"||e==="Backspace"){if(ua(this.model))return this.controller.dispatch({type:"on-special-key-pressed",key:e})}else if(e==="Enter")return r&&(r.preventDefault(),r.stopPropagation()),this.controller.dispatch({type:"on-special-key-pressed",key:"Enter"});i.keystroke(e,r),this.handleLatexChanged(i.latex())}}handleLatexChanged(e){e!==this.model.latex&&this.controller.dispatch({type:"set-item-latex",id:this.id,latex:e})}doesNodeBelongToSliderLimit(e){return!e||!this.rootNode.contains(e)?!1:!!I(e).closest("[data-dcg-label]").length}handleMQFocusedChanged(e,r){e?this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:this.id}}):!this.doesNodeBelongToSliderLimit(r.relatedTarget)&&this.lastBrailleMode===this.controller.getBrailleMode()&&this.controller.dispatch({type:"blur-focus-location",location:{type:"expression",id:this.id}})}onMouseSelect(e){this.isReadonly()||e.device!=="keyboard"&&(e.type==="dcg-tap"&&e.device==="mouse"||e.type==="dcg-tapstart"&&e.device==="touch"||e.wasHandled()||(e.handle(),this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:this.id}})))}isReadonly(){return this.controller.isItemReadonly(this.id)}isFocused(){let e=this.controller.getFocusLocation();return!e||e.type!=="expression"?!1:e.id===this.id}isSliderThumbFocused(){let e=this.controller.getFocusLocation();return!e||e.type!=="slider-thumb"?!1:e.id===this.id}hasError(){return!!this.model.error&&!ua(this.model)}getMQConfig(){return this.controller.getMathquillConfig({})}};function ko(t,e){let r=i=>lt.createElement(et,{config:()=>({}),latex:()=>i});return{tooltipOptions:()=>__dcg_shared_module_exports__['b']({latexView:r},e||{}),sixKeyInput:()=>t.getSixKeyInput(),mode:()=>t.getBrailleMode(),capExpressionSize:()=>t.getCapExpressionSize()?{exceedsLimit:i=>i.length>em,onExpressionSizeExceeded:()=>t.dispatch({type:"expression-size-exceeded"})}:void 0}}var fc=__dcg_shared_module_exports__['i'](Z());Oe();var{Textarea:Y$}=fc.Components,Zd=class extends fc.Class{template(){return fc.createElement("div",{class:fc.const("dcg-smart-textarea-container")},fc.createElement("div",{class:fc.const("dcg-displayTextarea dcg-fixed-width-element"),didMount:this.bindFn(this.didMountDisplay)}),fc.createElement(Y$,{class:()=>({"dcg-do-blur":!0,"dcg-fixed-width-element":!0,"dcg-smart-textarea":!0,"dcg-empty":!this.props.text()}),"aria-label":()=>this.props.ariaLabel?this.props.ariaLabel():void 0,placeholder:this.props.placeholder,readonly:()=>this.props.readonly()?!0:void 0,value:this.props.text,onInput:this.props.onInput,didMount:this.bindFn(this.didMountTextarea),onKeydown:this.bindFn(this.onKeydownEvent)}))}getDisplayTextHTML(){let e=this.props.text()||"",r=(o,s)=>e.slice(o,s).replace(/</g,"&lt;").replace(/>/g,"&gt;"),i=0,n="";if(this.props.showLinks()){let o=/(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi,s=null;for(;(s=o.exec(e))!==null;){let[a]=s;n+=r(i,s.index),n+=`<a rel='nofollow ugc' href='${a}' target ='_blank'>${a}</a>`,i=o.lastIndex}}return n+=r(i),n}willUnmount(){this.textareaNode=void 0}didMountDisplay(e){this.displayNode=e,I(e).on("touchend",function(r){r.preventDefault()}),I(e).on("dcg-tap dcg-tapstart","a",function(r){r.handle()}),this.renderDisplayText()}didMountTextarea(e){this.textareaNode=e,I(e).on("dcg-tapstart",r=>{r.handle()}),I(e).on("focusin focusout",()=>this.onFocusEvent()),this.updateFocused()}didUpdate(){this.updateFocused(),this.renderDisplayText()}onFocusEvent(){if(this.textareaNode){var e=document.activeElement===this.textareaNode;this.shouldBeFocused()!==e&&this.props.onFocusChange(e)}}renderDisplayText(){if(!this.displayNode)return;let e=this.getDisplayTextHTML();this.lastDisplayTextHTML!==e&&(this.lastDisplayTextHTML=e,this.displayNode.innerHTML=e)}isFocused(){return document.activeElement===this.textareaNode}shouldBeFocused(){return this.props.shouldFocus()}updateFocused(){if(!this.textareaNode)return;let e=this.isFocused(),r=this.shouldBeFocused();if(e!==r)if(!r)this.textareaNode.blur();else{if(La&&Id)return;this.textareaNode.focus(),this.textareaNode.selectionStart=this.textareaNode.selectionEnd=this.textareaNode.value.length}}onKeydownEvent(e){var r=this.textareaNode;if(!r)return;var i=Te(e);let n=this.props.readonly(),o=this.props.readonlyAction&&this.props.readonlyAction();if(n&&o!==void 0&&o.predicate()){!e.altKey&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey&&(i===ll||i===Nf)&&(e.preventDefault(),o.action());return}i===ll&&!e.metaKey?(e.preventDefault(),this.props.onSpecialKey("Enter")):i===jn?ti():i===Jn?(n||r.selectionStart===0&&r.selectionEnd===0)&&!(e.altKey||e.metaKey)&&(e.preventDefault(),this.props.onSpecialKey("Up")):i===Yn?(n||r.selectionStart===r.value.length&&r.selectionEnd===r.value.length)&&!(e.altKey||e.metaKey)&&(e.preventDefault(),this.props.onSpecialKey("Down")):i===Pa&&!(n&&o!==void 0&&o.predicate())?r.value.length===0&&(e.preventDefault(),this.props.onSpecialKey("Backspace")):i===Op&&!(n&&o!==void 0&&o.predicate())&&r.value.length===0&&(e.preventDefault(),this.props.onSpecialKey("Delete")),this.props.onKeydown&&this.props.onKeydown(e)}};var Qn=__dcg_shared_module_exports__['i'](Z());var rw=class extends $s{didMount(){this.onItemViewMounted()}willUnmount(){this.onItemViewUnmounted()}template(){return Qn.createElement("div",{class:()=>({"dcg-do-not-blur":!0,"dcg-expressionitem":!0,"dcg-readonly":this.controller.isItemReadonly(this.id),"dcg-expressiontext":!0,"dcg-inFolder":!!this.model.folderId,"dcg-selected":!!this.controller.isItemSelected(this.id),"dcg-dragging":!!this.controller.isItemBeingDragged(this.id)}),"expr-id":()=>this.model.id,onTapStart:this.bindFn(this.onMouseSelect),onTap:this.bindFn(this.onMouseSelect)},Qn.createElement("div",{class:Qn.const("dcg-fade-container")},Qn.createElement("div",{class:Qn.const("dcg-main")},Qn.createElement(Zd,{shouldFocus:this.bindFn(this.isFocused),text:()=>this.model.text,placeholder:()=>this.controller.s("graphing-calculator-text-enter-note-placeholder"),showLinks:()=>this.controller.areLinksEnabled(),onInput:this.bindFn(this.onInput),onFocusChange:this.bindFn(this.onFocusChange),onSpecialKey:this.bindFn(this.onSpecialKey),readonly:()=>this.controller.isInEditListMode()||this.controller.isItemReadonly(this.id),readonlyAction:this.const({predicate:()=>this.controller.isInEditListMode(),action:()=>this.exitEditListMode()})})),Qn.createElement(Dl,{controller:this.props.controller,id:()=>this.id})),Qn.createElement("span",{class:Qn.const("dcg-tab dcg-action-drag"),handleevent:Qn.const("true"),tapboundary:Qn.const("true"),disablescroll:Qn.const("true"),onTapStart:this.bindFn(this.onDragPending)},Qn.createElement("span",{class:Qn.const("dcg-num")},()=>this.model.displayIndex),Qn.createElement("div",{class:Qn.const("dcg-tab-interior")}),Qn.createElement("i",{class:Qn.const("dcg-icon-text"),"aria-hidden":Qn.const("true")})),Qn.createElement(Cl,{controller:this.props.controller,id:()=>this.model.id}))}onInput(e){this.controller.dispatch({type:"set-note-text",id:this.id,text:e})}onFocusChange(e){e?this.controller.dispatch({type:"set-focus-location",location:{type:"text",id:this.id}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"text",id:this.id}})}onSpecialKey(e){return this.controller.dispatch({type:"on-special-key-pressed",key:e})}isFocused(){let e=this.controller.getFocusLocation();return!(!e||e.type!=="text"||e.id!==this.id)}};var Ut=__dcg_shared_module_exports__['i'](Z());Oe();var si=__dcg_shared_module_exports__['i'](Z());var Ps=__dcg_shared_module_exports__['i'](Z());var{SwitchUnion:X$}=Ps.Components,iw=class extends Ps.Class{init(){this.model=this.props.model(),this.controller=this.props.controller()}template(){return Ps.createElement("div",{class:Ps.const("dcg-table-icon-container")},X$(this.bindFn(this.typeOfIcon),{error:()=>Ps.createElement(ys,{error:()=>this.controller.unpack(this.model.error),gravity:this.const("se")}),none:()=>Ps.createElement("span",null),icon:()=>Ps.createElement("div",{class:Ps.const("dcg-circular-icon-container"),role:Ps.const("button"),tabindex:Ps.const("0"),"aria-label":this.bindFn(this.getIconAriaLabel),handleevent:Ps.const("true"),"dcg-open-menu-guid":()=>this.getMenuGUID(),onTap:e=>{if(!e.wasHandled("dragdrop")&&!e.wasLongheld()){if(this.myOptionsOpen())return this.toggleOptions();if(this.controller.isInEditListMode()||e.shiftKey)return this.toggleOptions();this.toggleGraphShown()}},onLongHold:e=>{e.handle("dcg-longhold"),e.handle("dcg-tap"),this.toggleOptions()},manageFocus:this.const(yt({controller:this.controller,location:{type:"table-icon",id:this.model.table.id,columnId:this.model.id}}))},Ps.createElement(cn,{iconType:this.bindFn(this.getIcon),backgroundColor:this.bindFn(this.getModelColor)}))}))}getModelColor(){return Iy(this.model)}getMenuGUID(){return this.model.guid}myOptionsOpen(){return this.controller.isItemSettingsMenuOpen(this.getMenuGUID())}toggleOptions(){this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"table-column",model:this.model,guid:this.getMenuGUID(),focusFirstOption:!1}})}toggleGraphShown(){this.controller.dispatch({type:"toggle-tablecolumn-hidden",tableId:this.model.table.id,columnId:this.model.id})}hasError(){return!!this.model.error}getIcon(){return this.model.shouldGraph?this.controller.isInEditListMode()?"none":this.model.points&&this.model.lines?"table-points-and-lines":this.model.points&&!this.model.lines?"table-points":!this.model.points&&this.model.lines?"table-lines":"none":"hidden"}typeOfIcon(){return this.model.latex===""||!this.controller.getGraphSettings().config.graphpaper?"none":this.model.error?"error":this.model.index===0?"none":"icon"}getIconAriaLabel(){return this.myOptionsOpen()?this.controller.s("graphing-calculator-narration-hide-options"):this.controller.isInEditListMode()?this.controller.s("graphing-calculator-narration-show-options"):this.model.shouldGraph?this.controller.s("graphing-calculator-narration-hide-table-column"):this.controller.s("graphing-calculator-narration-show-table-column")}};var{If:nw}=si.Components,ow=class extends si.Class{init(){this.model=this.props.model(),this.controller=this.props.controller(),this.table=this.model.table}isRightSide(){return this.lookupCellPosition().column>=this.table.columnModels.length-1}template(){return si.createElement("div",{class:()=>({"dcg-cell":!0,"dcg-table-header":!0,"dcg-do-not-blur":!0,"dcg-left":this.model.index===0,"dcg-right":this.isRightSide(),"dcg-selected":this.shouldFocus()&&!this.table.readonly,"dcg-error":!!this.model.error}),index:()=>this.model.index,onTapStart:this.bindFn(this.focusThisCell)},si.createElement("div",{class:si.const("dcg-inner-border")}),si.createElement(nw,{predicate:()=>!this.isRightSide()},()=>si.createElement(iw,{model:this.props.model,controller:this.props.controller})),si.createElement("div",{role:si.const("columnheader")},si.createElement(nw,{predicate:()=>!this.controller.isInEditListMode()&&!this.table.readonly},()=>si.createElement(kn,__dcg_shared_module_exports__['b']({latex:()=>this.model.latex||"",brailleShouldFocus:this.bindFn(this.shouldFocus),ariaLabel:()=>this.getAriaLabel("braille"),onBrailleInput:e=>this.handleLatexChanged(e),onBrailleFocusedChanged:this.bindFn(this.handleMQFocusedChanged),selectOnFocus:this.const(!0),onBrailleKeydown:this.bindFn(this.handleKeydownOnBrailleInput)},ko(this.props.controller(),{gravity:"s"})),si.createElement(Xe,{latex:()=>this.model.latex||"",isFocused:this.bindFn(this.shouldFocus),capExpressionSize:()=>this.controller.getCapExpressionSize(),config:this.bindFn(this.getMQConfig),getAriaLabel:()=>this.getAriaLabel("speech"),getAriaPostLabel:this.bindFn(this.getAriaPostLabel),hasError:this.const(!1),onUserPressedKey:(e,r)=>this.handlePressedKey(e,r),onUserChangedLatex:e=>this.handleLatexChanged(e),onExpressionSizeExceeded:()=>this.controller.dispatch({type:"expression-size-exceeded"}),onFocusedChanged:this.bindFn(this.handleMQFocusedChanged),selectOnFocus:this.const(!0),needsSystemKeypad:()=>!this.controller.isKeypadEnabled()}))),si.createElement(nw,{predicate:()=>this.controller.isInEditListMode()||this.controller.isItemReadonly(this.table.id)},()=>si.createElement(kn,__dcg_shared_module_exports__['b']({latex:()=>this.model.latex||"",ariaLabel:()=>this.getAriaLabel("braille"),onBrailleInput:e=>this.handleLatexChanged(e),tabindex:this.const(-1),isStatic:this.const(!0),brailleShouldFocus:this.bindFn(this.shouldFocusReadonlyCell),onBrailleFocusedChanged:this.bindFn(this.handleMQFocusedChanged)},ko(this.props.controller(),{gravity:"s"})),si.createElement(et,{latex:()=>this.model.latex||"",config:this.bindFn(this.getMQConfig),getAriaLabel:()=>this.getAriaLabel("speech")},si.createElement("span",{class:si.const("dcg-math-field dcg-cell-math-content"),role:si.const("textbox"),"aria-readonly":si.const("true"),tabindex:()=>this.controller.isInEditListMode()?-1:0,onKeyDown:this.bindFn(this.handleKeydownOnReadonlyCell),manageFocus:this.const({shouldBeFocused:this.bindFn(this.shouldFocusReadonlyCell),onFocusedChanged:this.bindFn(this.handleFocusedChanged)})})))),si.createElement(nw,{predicate:()=>this.model.dragMode!=="NONE"&&!this.model.error},()=>si.createElement("span",{class:si.const("dcg-drag-icon"),"dcg-drag-mode":()=>this.model.dragMode,style:()=>({color:this.model.color})},si.createElement("i",{class:()=>({"dcg-icon-move":this.model.dragMode==="XY","dcg-icon-move-horizontal":this.model.dragMode==="X","dcg-icon-move-vertical":this.model.dragMode==="Y"}),"aria-hidden":si.const("true")})))),si.createElement("div",{class:si.const("dcg-empty-line")}),si.createElement(nw,{predicate:()=>this.isRightSide()},()=>si.createElement("span",{class:si.const("dcg-fade-right")})))}focusThisCell(e){e.wasHandled()||(e.handle(),!this.controller.isItemReadonly(this.table.id)&&(this.shouldFocus()||this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.table.id,location:this.lookupCellPosition()}})))}handleFocusedChanged(e,r){e?this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.table.id,location:this.lookupCellPosition()}}):this.isNodeWithinTableCell(r.relatedTarget)||this.controller.dispatch({type:"blur-focus-location",location:{type:"table",id:this.table.id,location:this.lookupCellPosition()}})}lookupCellPosition(){return{row:0,column:this.model.index}}getAriaLabel(e){var r=this.lookupCellPosition();return e==="speech"?this.controller.s("graphing-calculator-narration-table-column-header",{column:r.column+1}):this.controller.raw("h__column__",{column:r.column+1})}getAriaPostLabel(){let e="",r=this.model;return r.shouldGraph&&(r.points||r.lines)&&!RF(r)&&(e=this.controller.s("graphing-calculator-narration-expression-evaluation-has-graph"),Zr?e+=" "+this.controller.s("graphing-calculator-narration-expression-audio-trace-mac"):e+=" "+this.controller.s("graphing-calculator-narration-expression-audio-trace-windows")),e}handlePressedKey(e,r){var i=Xe.getFocusedMathquill();i&&(Xe.handleKeystrokeAndDecideIfSpecialEvent(i,e,r)?this.controller.dispatch({type:"navigate-table-by-key",id:this.table.id,key:e}):this.handleLatexChanged(i.latex()))}handleKeydownOnBrailleInput(e){let r=Te(e);if(!r)return;let i=r==="Enter"||r==="Up"||r==="Down",n=zs(),o=n&&r==="Left"&&n.selectionStart===0||r==="Right"&&n.selectionStart===I(n).val().length,s=this.model.latex.length===0&&gm(n);(i||o||(r==="Del"||r==="Backspace")&&s)&&(this.controller.dispatch({type:"navigate-table-by-key",id:this.table.id,key:r==="Del"?"Delete":r}),e.preventDefault())}handleKeydownOnReadonlyCell(e){let r=Te(e);r!=="Tab"&&(e.preventDefault(),r==="Esc"&&ti(),r&&this.controller.dispatch({type:"navigate-table-by-key",id:this.table.id,key:r}))}handleLatexChanged(e){var r=this.model.latex;r!==e&&this.controller.dispatch({type:"set-tablecell-latex",tableId:this.table.id,cell:this.lookupCellPosition(),latex:e})}shouldFocus(){return!this.controller.isInEditListMode()&&__dcg_shared_module_exports__['F'](this.lookupCellPosition(),Do(this.table))}shouldFocusReadonlyCell(){return __dcg_shared_module_exports__['F'](this.lookupCellPosition(),Do(this.table))}isNodeWithinTableCell(e){if(!e||I(e).closest(".dcg-cell").length===0)return!1;var r=this.controller.getItemRootNodeById(this.table.id);return r?I.contains(r,e):!1}handleMQFocusedChanged(e,r){e?this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.table.id,location:this.lookupCellPosition()}}):this.isNodeWithinTableCell(r.relatedTarget)||this.controller.dispatch({type:"blur-focus-location",location:{type:"table",id:this.table.id,location:this.lookupCellPosition()}})}getMQConfig(){return this.controller.getMathquillConfig({})}};var en=__dcg_shared_module_exports__['i'](Z());Oe();var{If:wT}=en.Components,sw=class extends en.Class{init(){this.column=this.props.column(),this.controller=this.props.controller(),this.table=this.column.table}template(){return en.createElement("div",{class:()=>({"dcg-cell":!0,"dcg-do-not-blur":!0,"dcg-empty":this.isEmpty(),"dcg-non-editable":!!this.column.disabled,"dcg-error":!!this.hasError(),"dcg-selected":this.shouldFocus()&&!this.controller.isItemReadonly(this.table.id)}),onTapStart:this.bindFn(this.focusThisCell)},en.createElement("div",{class:en.const("dcg-inner-border")}),en.createElement("div",{role:en.const("gridcell")},en.createElement(wT,{predicate:this.bindFn(this.hasError)},()=>en.createElement("span",{class:en.const("dcg-table-icon-error-container")},en.createElement(ys,{error:this.bindFn(this.getErrorMessage),gravity:this.const("se"),size:this.const("small")}))),en.createElement(wT,{predicate:()=>!this.isColumnEditable()},()=>en.createElement(kn,__dcg_shared_module_exports__['b']({latex:()=>this.getValue(),brailleShouldFocus:this.bindFn(this.shouldFocusReadonlyCell),ariaLabel:()=>this.getAriaLabel("braille"),tabindex:()=>this.controller.isInEditListMode()?-1:0,isStatic:this.const(!0),onBrailleFocusedChanged:this.bindFn(this.handleFocusedChanged),onBrailleKeydown:e=>(this.handleKeydownOnReadonlyCell(e),!0)},ko(this.props.controller(),{gravity:"s"})),en.createElement(et,{getAriaLabel:()=>this.getAriaLabel("speech"),latex:()=>this.getValue(),config:this.bindFn(this.getMQConfig)},en.createElement("span",{class:en.const("dcg-math-field dcg-cell-math-content dcg-mathquill-input-span"),role:en.const("textbox"),"aria-roledescription":()=>this.column.disabled?this.controller.s("graphing-calculator-narration-computed-cell-role-description"):void 0,"aria-readonly":en.const("true"),tabindex:()=>!this.controller.isInEditListMode()&&(!this.isEmpty()||!this.column.disabled)?0:-1,onKeyDown:this.bindFn(this.handleKeydownOnReadonlyCell),manageFocus:this.const({shouldBeFocused:this.bindFn(this.shouldFocusReadonlyCell),onFocusedChanged:this.bindFn(this.handleFocusedChanged)})})))),en.createElement(wT,{predicate:this.bindFn(this.isColumnEditable)},()=>en.createElement(kn,__dcg_shared_module_exports__['b']({latex:()=>this.getValue(),brailleShouldFocus:this.bindFn(this.shouldFocusEditableCell),ariaLabel:()=>this.getAriaLabel("braille"),onBrailleInput:e=>this.handleLatexChanged(e),onBrailleFocusedChanged:this.bindFn(this.handleFocusedChanged),onBrailleKeydown:this.bindFn(this.handleKeydownOnBrailleInput),selectOnFocus:this.const(!0)},ko(this.props.controller(),{gravity:"s"})),en.createElement(Xe,{latex:()=>this.getValue(),isFocused:this.bindFn(this.shouldFocusEditableCell),capExpressionSize:()=>this.controller.getCapExpressionSize(),config:this.bindFn(this.getMQConfig),getAriaLabel:()=>this.getAriaLabel("speech"),getAriaPostLabel:this.bindFn(this.getErrorMessage),hasError:this.const(!1),onUserPressedKey:(e,r)=>this.handlePressedKey(e,r),onUserChangedLatex:e=>this.handleLatexChanged(e),onExpressionSizeExceeded:()=>this.controller.dispatch({type:"expression-size-exceeded"}),onFocusedChanged:this.bindFn(this.handleFocusedChanged),selectOnFocus:this.const(!0),needsSystemKeypad:()=>!this.controller.isKeypadEnabled()})))),en.createElement("div",{class:en.const("dcg-empty-line")}))}focusThisCell(e){e.wasHandled()||this.controller.isItemReadonly(this.table.id)||(e.handle(),!this.shouldFocus()&&this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.table.id,location:this.lookupCellPosition()}}))}handlePressedKey(e,r){var i=Xe.getFocusedMathquill();if(i){let n=Xe.handleKeystrokeAndDecideIfSpecialEvent(i,e,r);e===jn&&ti(),n?this.controller.dispatch({type:"navigate-table-by-key",id:this.table.id,key:e}):this.handleLatexChanged(i.latex())}}handleKeydownOnBrailleInput(e){let r=Te(e);if(!r)return;r===jn&&ti();let i=r==="Enter"||r==="Up"||r==="Down",n=zs(),o=n&&r==="Left"&&n.selectionStart===0||r==="Right"&&n.selectionStart===I(n).val().length;(i||o||(r==="Del"||r==="Backspace")&&this.getValue().length===0)&&(this.controller.dispatch({type:"navigate-table-by-key",id:this.table.id,key:r==="Del"?"Delete":r}),e.preventDefault())}handleKeydownOnReadonlyCell(e){let r=Te(e);r!=="Tab"&&(e.preventDefault(),r==="Esc"&&ti(),r&&this.controller.dispatch({type:"navigate-table-by-key",id:this.table.id,key:r}))}handleLatexChanged(e){var r=this.getValue();r!==e&&this.controller.dispatch({type:"set-tablecell-latex",tableId:this.table.id,cell:this.lookupCellPosition(),latex:e})}shouldFocus(){return __dcg_shared_module_exports__['F'](this.lookupCellPosition(),Do(this.table))}shouldFocusReadonlyCell(){return!this.controller.isInEditListMode()&&(this.controller.isItemReadonly(this.table.id)||!!this.column.disabled)&&this.shouldFocus()}shouldFocusEditableCell(){return!this.column.disabled&&this.shouldFocus()}isNodeWithinTableCell(e){if(!e||I(e).closest(".dcg-cell").length===0)return!1;var r=this.controller.getItemRootNodeById(this.table.id);return r?I.contains(r,e):!1}handleFocusedChanged(e,r){e?this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.table.id,location:this.lookupCellPosition()}}):this.isNodeWithinTableCell(r.relatedTarget)||this.controller.dispatch({type:"blur-focus-location",location:{type:"table",id:this.table.id,location:this.lookupCellPosition()}})}lookupCellPosition(){return{row:this.props.rowIdx(),column:this.column.index}}getPackedError(){return this.column.packedErrors[this.props.rowIdx()-1]}hasError(){return!!this.getPackedError()}getErrorMessage(){let e=this.getPackedError();return e?this.controller.unpack(e):""}getValue(){let e=this.props.rowIdx()-1,r=this.column.index;return Ty(this.table,e,r)}isEmpty(){let e=zs();return this.getValue()===""&&gm(e)}getAriaLabel(e){var r=this.lookupCellPosition(),i=r.row,n=r.column+1;return e==="speech"?this.controller.s("graphing-calculator-narration-table-row-column",{row:i.toString(),column:n.toString()}):this.controller.raw("r__row__c__column__",{row:i.toString(),column:n.toString()})}isColumnEditable(){return!this.column.disabled&&!this.controller.isItemReadonly(this.table.id)&&!this.controller.isInEditListMode()}getMQConfig(){return this.controller.getMathquillConfig({})}};Oe();var{For:xT}=Ut.Components,aw=class extends $s{didMount(){this.onItemViewMounted()}willUnmount(){this.onItemViewUnmounted()}template(){return Ut.createElement("div",{class:()=>({"dcg-expressionitem":!0,"dcg-expressiontable":!0,"dcg-readonly":this.controller.isItemReadonly(this.id),"dcg-inFolder":!!this.model.folderId,"dcg-selected":!!this.controller.isItemSelected(this.id),"dcg-dragging":!!this.controller.isItemBeingDragged(this.id),"dcg-faded-h":this.shouldFadeLastColumn(),"dcg-faded-v":this.shouldFadeLastRow()}),"expr-id":()=>this.model.id,didMount:this.bindFn(this.didMountContainer),onKeydown:this.bindFn(this.onKeydown)},Ut.createElement("div",{class:Ut.const("dcg-fade-container dcg-disable-horizontal-scroll-to-cursor")},Ut.createElement("div",{class:Ut.const("dcg-main")},Ut.createElement("div",{class:Ut.const("dcg-table-container"),tabindex:()=>this.controller.isInEditListMode()?0:-1,"aria-label":()=>this.controller.getBrailleMode()==="none"?this.controller.s("graphing-calculator-narration-expression-index-table",{index:this.model.displayIndex}):this.controller.s("graphing-calculator-narration-expression-index-table",{index:this.model.displayIndex}),didMount:this.bindFn(this.didMountContainer),manageFocus:this.const({shouldBeFocused:this.shouldBeFocused.bind(this),onFocusedChanged:this.onFocusedChanged.bind(this)})},Ut.createElement("div",{class:Ut.const("dcg-table-sliding-container"),style:()=>({transform:`translateX(${this.computeScrolledX()}px)`})},Ut.createElement(xT,{each:()=>this.getVisibleRows(),key:e=>this.getRowGUID(e)},Ut.createElement("div",{role:Ut.const("grid"),class:Ut.const("dcg-tabledata")},e=>e.type==="show-more"?Ut.createElement("tr",{role:Ut.const("row"),class:Ut.const("dcg-show-more-row")},Ut.createElement("td",{colspan:this.bindFn(this.getColSpan)},this.bindFn(this.missingRowMessage),Ut.createElement("div",{tabindex:Ut.const(0),role:Ut.const("button"),class:Ut.const("dcg-show-more"),onTap:()=>this.controller.dispatch({type:"table-show-more-rows",id:this.id})},()=>this.controller.s("graphing-calculator-button-show-all-table-rows")))):e.type==="spacer-row"?Ut.createElement("tr",{role:Ut.const("row"),class:Ut.const("dcg-blank-row")},Ut.createElement("td",{colspan:this.bindFn(this.getColSpan),style:()=>({height:(e.endIdx-e.startIdx+1)*this.getRowHeight()+"px"})})):e.type==="header"?Ut.createElement(xT,{each:()=>this.model.columnModels,key:r=>r.guid},Ut.createElement("tr",{role:Ut.const("row"),"aria-rowindex":Ut.const(0),class:()=>({"dcg-row":e,"dcg-braille-row":this.controller.getBrailleMode()!=="none"})},r=>Ut.createElement(ow,{controller:this.props.controller,model:this.const(r)}))):Ut.createElement(xT,{each:()=>this.model.columnModels,key:r=>r.guid},Ut.createElement("tr",{role:Ut.const("row"),"aria-rowindex":()=>e.index,class:()=>({"dcg-row":e,"dcg-braille-row":this.controller.getBrailleMode()!=="none"})},r=>Ut.createElement(sw,{controller:this.props.controller,column:this.const(r),rowIdx:()=>e.index})))))))),Ut.createElement(Dl,{controller:this.props.controller,id:()=>this.id})),Ut.createElement("span",{class:Ut.const("dcg-tab dcg-action-drag"),handleevent:Ut.const("true"),tapboundary:Ut.const("true"),disablescroll:Ut.const("true"),onTapStart:this.bindFn(this.onDragPending)},Ut.createElement("span",{class:Ut.const("dcg-num")},()=>this.model.displayIndex),Ut.createElement("div",{class:Ut.const("dcg-tab-interior")}),Ut.createElement(bm,{model:this.props.model,controller:this.props.controller})),Ut.createElement(Cl,{controller:this.props.controller,id:()=>this.model.id}))}getRowGUID(e){switch(e.type){case"header":return"header";case"show-more":return"show-more";case"spacer-row":return`spacer-${e.startIdx}-${e.endIdx}`;case"standard-row":return`row-${e.index}`}}getColSpan(){return this.model.columnModels.length-1}getRowHeight(){return this.controller.getGraphSettings().config.projectorMode?38:33}getVisibleRows(){let e=[{type:"header"}],r=Us(this.model)+1;if(r<=25){for(let g=1;g<r;g++)e.push({type:"standard-row",index:g});return e}let i=Jp(this.model);if(i!==void 0){for(let g=1;g<i.min;g++)e.push({type:"standard-row",index:g});e.push({type:"show-more"});for(let g=i.max;g<r;g++)e.push({type:"standard-row",index:g});return e}let n=Bb(this.controller),o=n?n.height:0,s=I(this.node).offset(),a=(s?s.top:0)-(n?n.top:0),l=I(this.node).find(".dcg-row:eq(0)").height(),c=this.getRowHeight();if(o/c>r){for(let g=1;g<r;g++)e.push({type:"standard-row",index:g});return e}let d=(-a-l)/c,u=(o-a)/c;for(var p=1;p<r;p++){let g=Do(this.model);if(p===r-2||g&&g.row===p)e.push({type:"standard-row",index:p});else if(p>u||p<d){let b=e[e.length-1];b&&b.type==="spacer-row"?b.endIdx=p:e.push({type:"spacer-row",startIdx:p,endIdx:p})}else e.push({type:"standard-row",index:p})}return e}missingRowMessage(){let e=Jp(this.model);return e===void 0?"":this.controller.s("graphing-calculator-text-table-more-rows",{rowCount:e.max-e.min})}didMountContainer(e){this.node=e,I(e).on("scroll",()=>e.scrollLeft=0)}getSelectedCell(){return Do(this.model)}computeScrolledX(){if(!this.getSelectedCell()||!this.node)return 0;let e=this.node.children[0],r=this.node.querySelector(".dcg-selected");if(e===null||r===null)return 0;let i=this.node.getBoundingClientRect(),n=r.getBoundingClientRect(),o=n.left-e.getBoundingClientRect().left,s=i.width-o-n.width-80,a=Math.min(0,i.width-e.scrollWidth-30);return s=Math.max(s,a),Math.min(0,s)}shouldFadeLastRow(){return NF(this.model)&&!this.isBottomFocused()}shouldFadeLastColumn(){return!this.isRightFocused()}isBottomFocused(){let e=this.getSelectedCell();return!!e&&e.row===Us(this.model)}isRightFocused(){let e=this.getSelectedCell();return!!e&&e.column===this.model.columnModels.length-1}isReadonly(){return this.controller.isItemReadonly(this.id)}isFocused(){return!!this.getSelectedCell()}onKeydown(e){this.controller.isInEditListMode()||e.ctrlKey&&!e.shiftKey&&!e.altKey&&!e.metaKey&&(Te(e)==="Up"?(e.preventDefault(),e.stopPropagation(),this.moveToFirstCellInColumn()):Te(e)==="Down"?(e.preventDefault(),e.stopPropagation(),this.moveToLastCellInColumn()):Te(e)==="Left"?(e.preventDefault(),e.stopPropagation(),this.moveToFirstCellInRow()):Te(e)==="Right"?(e.preventDefault(),e.stopPropagation(),this.moveToLastCellInRow()):ei(e)==="H"&&(e.preventDefault(),e.stopPropagation(),this.speakColumnHeader()))}moveToFirstCellInColumn(){let e=this.getSelectedCell();e&&this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.id,location:{row:0,column:e.column}}})}moveToLastCellInColumn(){let e=this.getSelectedCell();e&&this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.id,location:{row:Us(this.model),column:e.column}}})}moveToFirstCellInRow(){let e=this.getSelectedCell();e&&this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.id,location:{row:e.row,column:0}}})}moveToLastCellInRow(){let e=this.getSelectedCell();e&&this.controller.dispatch({type:"set-focus-location",location:{type:"table",id:this.id,location:{row:e.row,column:Us(this.model)-1}}})}speakColumnHeader(){let e=this.controller.s("graphing-calculator-narration-table-no-column-header"),r=this.getSelectedCell();if(r){let i=this.model.columnModels[r.column].latex;i&&(e=dl.StaticMath(document.createElement("span")).latex(i).mathspeak())}me(e)}focusHelperOptions(){return{controller:this.controller,location:{type:"table-container",id:this.model.id}}}shouldBeFocused(){return zy(this.focusHelperOptions())}onFocusedChanged(e){if(this.controller.isInEditListMode())return aM(this.focusHelperOptions(),e)}};var Jr=__dcg_shared_module_exports__['i'](Z());var lw=class extends $s{didMount(){this.onItemViewMounted()}willUnmount(){this.onItemViewUnmounted()}template(){return Jr.createElement("div",{class:()=>({"dcg-do-not-blur":!0,"dcg-expressionitem":!0,"dcg-readonly":this.controller.isItemReadonly(this.id),"dcg-expressionfolder":!0,"dcg-inFolder":!1,"dcg-selected":this.renderAsSelected(),"dcg-dragging":!!this.controller.isItemBeingDragged(this.id),"dcg-collapsed":!!this.model.collapsed,"dcg-hidden":!!this.model.hidden,"dcg-has-items":this.controller.getNumberOfItemsInFolder(this.id)>0,"dcg-secretFolder":this.model.secret&&!this.controller.shouldShowAuthorFeatures()}),"expr-id":()=>this.model.id,onTapStart:this.bindFn(this.onMouseSelect),onTap:this.bindFn(this.onMouseSelect)},Jr.createElement("div",{class:Jr.const("dcg-fade-container")},Jr.createElement("div",{class:Jr.const("dcg-main")},Jr.createElement("div",{role:Jr.const("button"),tabindex:Jr.const("0"),"aria-pressed":()=>this.model.collapsed,"aria-label":()=>this.controller.s("graphing-calculator-narration-collapse-folder"),class:Jr.const("dcg-caret-container dcg-action-toggle-folder-collapsed dcg-do-not-blur"),handleEvent:Jr.const("true"),onTap:this.bindFn(this.toggleCollapsed)},Jr.createElement("i",{class:Jr.const("dcg-icon-caret-down"),"aria-hidden":Jr.const("true")})),Jr.createElement(Zd,{shouldFocus:this.bindFn(this.isFocused),text:()=>this.model.title,placeholder:()=>this.controller.s("graphing-calculator-text-note-placeholder"),showLinks:()=>this.controller.areLinksEnabled(),onInput:this.bindFn(this.onInput),onFocusChange:this.bindFn(this.onFocusChange),onSpecialKey:this.bindFn(this.onSpecialKey),ariaLabel:this.bindFn(this.getAriaLabel),readonly:()=>this.controller.isInEditListMode()||this.controller.isItemReadonly(this.id),readonlyAction:this.const({predicate:()=>this.controller.isInEditListMode(),action:()=>this.exitEditListMode()})}),Jr.createElement(Dt,{checked:()=>this.model.secret,class:this.const("dcg-action-toggle-secret-folder dcg-do-not-blur"),style:()=>({display:this.controller.shouldShowAuthorFeatures()?void 0:"none"}),onChange:this.bindFn(this.toggleSecret)},Jr.createElement("span",{class:Jr.const("dcg-checkbox-label")},()=>this.controller.s("graphing-calculator-button-hide-folder-from-students-2")))),Jr.createElement(Dl,{controller:this.props.controller,id:()=>this.id})),Jr.createElement("span",{class:Jr.const("dcg-tab dcg-action-drag"),handleevent:Jr.const("true"),tapboundary:Jr.const("true"),disablescroll:Jr.const("true"),onTapStart:this.bindFn(this.onDragPending)},Jr.createElement("span",{class:Jr.const("dcg-num")},()=>this.model.displayIndex),Jr.createElement("div",{class:Jr.const("dcg-tab-interior")},Jr.createElement("span",{role:Jr.const("button"),tabindex:Jr.const("0"),"aria-pressed":()=>!!this.model.hidden,"aria-label":()=>this.controller.s("graphing-calculator-narration-hide-folder"),class:Jr.const("dcg-circular-icon-container dcg-expression-icon-container"),onTap:this.bindFn(this.toggleHidden)},Jr.createElement(cn,{iconType:()=>this.model.hidden?"hidden":"folder",whiteIcon:()=>this.renderAsSelected()||this.controller.isItemBeingDragged(this.model.id)})))),Jr.createElement(Cl,{controller:this.props.controller,id:()=>this.model.id}))}renderAsSelected(){return this.controller.isItemSelected(this.model.id)||this.model.collapsedChildIsSelected}toggleHidden(){this.controller.dispatch({type:"toggle-item-hidden",id:this.id})}toggleSecret(){this.controller.dispatch({type:"set-item-secret",id:this.id,isSecret:!this.model.secret})}toggleCollapsed(){this.controller.dispatch({type:"set-folder-collapsed",id:this.id,isCollapsed:!this.model.collapsed})}onInput(e){this.controller.dispatch({type:"set-folder-title",id:this.id,title:e})}onFocusChange(e){e?this.controller.dispatch({type:"set-focus-location",location:{type:"folder",id:this.id}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"folder",id:this.id}})}onSpecialKey(e){return this.controller.dispatch({type:"on-special-key-pressed",key:e})}isFocused(){let e=this.controller.getFocusLocation();return!(!e||e.type!=="folder"||e.id!==this.id)}getAriaLabel(){var e="",r="";!this.model.hidden&&!this.model.collapsed&&!this.model.secret?r=this.controller.s("graphing-calculator-narration-description-folder"):this.model.hidden&&!this.model.collapsed&&!this.model.secret?r=this.controller.s("graphing-calculator-narration-description-hidden-folder"):!this.model.hidden&&this.model.collapsed&&!this.model.secret?r=this.controller.s("graphing-calculator-narration-description-collapsed-folder"):!this.model.hidden&&!this.model.collapsed&&this.model.secret?r=this.controller.s("graphing-calculator-narration-description-secret-folder"):this.model.hidden&&this.model.collapsed&&!this.model.secret?r=this.controller.s("graphing-calculator-narration-description-hidden-collapsed-folder"):this.model.hidden&&!this.model.collapsed&&this.model.secret?r=this.controller.s("graphing-calculator-narration-description-hidden-secret-folder"):!this.model.hidden&&this.model.collapsed&&this.model.secret?r=this.controller.s("graphing-calculator-narration-description-collapsed-secret-folder"):this.model.hidden&&this.model.collapsed&&this.model.secret&&(r=this.controller.s("graphing-calculator-narration-description-hidden-collapsed-secret-folder"));let i=this.controller.getNumberOfItemsInFolder(this.id);return i>0?e=this.controller.s("graphing-calculator-narration-folder-has-items",{folder:r,count:i}):e=r,e}};Oe();var tt=__dcg_shared_module_exports__['i'](Z());function aS(t){let e=document.createElement("a");return e.href=t,e.href}var Os=__dcg_shared_module_exports__['i'](Z());var{SwitchUnion:Q$}=Os.Components,cw=class extends Os.Class{init(){this.model=this.props.model(),this.controller=this.props.controller()}template(){return Os.createElement("div",{class:Os.const("dcg-expression-icon-container dcg-image-icon-container")},Q$(this.bindFn(this.typeOfIcon),{error:()=>Os.createElement(ys,{error:()=>this.controller.unpack(this.model.error),isWhite:this.bindFn(this.isSelected),gravity:this.const("se")}),failed:()=>Os.createElement("span",null),loading:()=>Os.createElement(cn,{iconType:this.const("loading")}),hidden:()=>this.buildIconView(),image:()=>this.buildIconView()}))}buildIconView(){return Os.createElement("div",{class:Os.const("dcg-circular-icon-container"),role:Os.const("button"),tabindex:Os.const("0"),"dcg-open-menu-guid":()=>this.getMenuGUID(),"aria-label":this.bindFn(this.getIconAriaLabel),onTap:e=>{if(!e.wasHandled("dragdrop")&&!e.wasLongheld()){if(this.myOptionsOpen())return this.toggleOptions(e);if(this.controller.isInEditListMode()||e.shiftKey)return this.toggleOptions(e);this.toggleImageShown()}},onLongHold:e=>{e.handle("dcg-longhold"),e.handle("dcg-tap"),this.toggleOptions(e)},manageFocus:this.const(yt({controller:this.controller,location:{type:"image-icon",id:this.model.id}}))},Os.createElement(cn,{iconType:()=>this.typeOfIcon()==="hidden"?"hidden":"background",backgroundImage:this.bindFn(this.getBackgroundImage),backgroundOpacity:this.const(1),whiteIcon:this.bindFn(this.isSelected)}))}isSelected(){return this.controller.isItemSelected(this.model.id)||this.controller.isItemBeingDragged(this.model.id)}typeOfIcon(){return this.model.loadStatus==="loading"?"loading":this.model.loadStatus==="failed"?"failed":this.hasError()?"error":this.model.shouldGraph?"image":"hidden"}getMenuGUID(){return this.model.guid}myOptionsOpen(){return this.controller.isItemSettingsMenuOpen(this.getMenuGUID())}toggleOptions(e){this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"image",model:this.model,guid:this.getMenuGUID(),focusFirstOption:e.device==="keyboard"}})}hasError(){return!!this.model.error&&this.controller.getBrailleMode()==="none"}getBackgroundImage(){return this.model.image_url===this.lastURL?this.lastEncodedURL:(this.lastURL=this.model.image_url,this.lastEncodedURL='url("'+aS(this.model.image_url)+'")',this.lastEncodedURL)}toggleImageShown(){this.controller.dispatch({type:"toggle-item-hidden",id:this.model.id}),this.controller.dispatch({type:"set-focus-location",location:{type:"image-icon",id:this.model.id}})}getIconAriaLabel(){return this.myOptionsOpen()?this.controller.s("graphing-calculator-narration-hide-options"):this.controller.isInEditListMode()?this.controller.s("graphing-calculator-narration-show-options"):this.model.hidden?this.controller.s("graphing-calculator-narration-show-image"):this.controller.s("graphing-calculator-narration-hide-image")}};var Sl=__dcg_shared_module_exports__['i'](Z());Oe();var eh=class extends Sl.Class{init(){this.controller=this.props.controller()}template(){return Sl.createElement("div",{class:Sl.const("dcg-do-not-blur"),onTap:this.bindFn(this.newImage),handleEvent:Sl.const("true"),role:Sl.const("button"),tabindex:()=>this.props.readonly()?-1:0,"aria-label":this.props.ariaLabel,"aria-disabled":()=>this.props.readonly(),manageFocus:this.const(this.props.location?yt({controller:this.controller,location:this.props.location()}):void 0)},this.children,Sl.createElement("input",{type:Sl.const("file"),accept:Sl.const("image/*"),style:Sl.const("display: none"),didMount:this.bindFn(this.didMountFileInput)}))}didMountFileInput(e){this.fileInputNode=e,I(e).on("change",()=>{this.props.onFileChange(e.files),I(e).val("")})}newImage(){this.props.readonly()||this.fileInputNode.click()}};var{If:dw,SwitchUnion:Z$}=tt.Components,uu=class extends tt.Class{init(){this.model=this.props.model(),this.controller=this.props.controller()}template(){return tt.createElement(lr,{containerClass:()=>({"dcg-image-input-mathquill":!0,"dcg-suffix-degree":this.props.name()==="angle"&&this.props.controller().getGraphSettings().degreeMode,"dcg-suffix-radian":this.props.name()==="angle"&&!this.props.controller().getGraphSettings().degreeMode}),fontSize:this.const("large"),fullWidth:this.const(!0),readonly:this.props.readonly,latex:()=>this.model[this.props.name()],isFocused:()=>this.props.focusedInput()===this.props.name(),ariaLabel:()=>this.controller.raw(this.props.name()),handleFocusChanged:this.bindFn(this.handleMQFocusedChanged),hasError:()=>d_(this.model,this.props.name()),controller:this.props.controller,handlePressedKey:this.bindFn(this.handlePressedKey),handleLatexChanged:this.bindFn(this.handleLatexChanged),noBorder:()=>!this.props.focusedInput()})}getInputs(){return["center","width","angle","height","opacity"]}handlePressedKey(e,r){let i=this.props.name();var n=Xe.getFocusedMathquill();let o=this.getInputs(),s=o.indexOf(i);if(!this.controller.isInEditListMode()){if(e==="Enter")return this.controller.dispatch({type:"on-special-key-pressed",key:"Enter"});if(e==="Esc"){ti();return}}let a=-1;e==="Up"&&(a=s===1?4:s-2),e==="Down"&&(a=s===4?1:s+2),e==="Left"&&(a=s-1),e==="Right"&&(a=s+1);let l=e;if(a>=0&&a<o.length){let c=!1;if(n)c=Xe.applyArrowKeyAndReturnIfWasAtBounds(n,l,r);else if(e==="Up"||e==="Down")c=!0;else{let d=zs();c=d&&(e==="Left"&&d.selectionStart===0||e==="Right"&&d.selectionStart===I(d).val().length)}c&&(this.focusInput(o[a]),r&&r.preventDefault());return}n&&(n.keystroke(e,r),this.handleLatexChanged(n.latex()))}focusInput(e){this.controller.dispatch({type:"set-focus-location",location:{type:"image",id:this.model.id,location:e}})}handleLatexChanged(e){let r=this.props.name();this.model.draggingOnGraphpaper||r_(this.model,r)!==e&&this.controller.dispatch({type:"set-image-mq-attribute",id:this.model.id,attribute:r,latex:e})}handleMQFocusedChanged(e){let r=this.props.name();e?this.props.focusedInput()!==r&&this.controller.dispatch({type:"set-focus-location",location:{type:"image",id:this.model.id,location:r}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"image",id:this.model.id,location:r}})}},hw=class extends $s{didMount(){this.onItemViewMounted()}willUnmount(){this.onItemViewUnmounted()}template(){return tt.createElement("div",{class:()=>({"dcg-do-not-blur":!0,"dcg-expressionitem":!0,"dcg-readonly":this.controller.isItemReadonly(this.id),"dcg-expressionimage":!0,"dcg-inFolder":!!this.model.folderId,"dcg-selected":this.controller.isItemSelected(this.id),"dcg-dragging":!!this.controller.isItemBeingDragged(this.id),"dcg-input-focused":this.getFocusedInput()&&this.getFocusedInput()!=="name"}),"expr-id":()=>this.model.id,onTapStart:this.bindFn(this.onMouseSelect),onTap:this.bindFn(this.onMouseSelect)},tt.createElement("div",{class:tt.const("dcg-fade-container")},tt.createElement("div",{class:tt.const("dcg-main")},Z$(()=>this.model.loadStatus,{failed:()=>tt.createElement("div",null,tt.createElement("div",{class:tt.const("dcg-image-failed")},()=>this.controller.s("graphing-calculator-error-failed-to-load-image")),tt.createElement("div",{role:tt.const("button"),tabindex:tt.const(0),class:tt.const("dcg-retry-loading-image"),onTap:this.bindFn(this.onRetryLoad)},()=>this.controller.s("graphing-calculator-button-load-image-retry"))),loading:()=>tt.createElement("div",null,tt.createElement("div",{class:tt.const("dcg-image-loading")},()=>this.controller.s("graphing-calculator-text-loading-image")),tt.createElement("div",{role:tt.const("button"),tabindex:tt.const(0),class:tt.const("dcg-retry-loading-image"),onTap:this.bindFn(this.onRetryLoad)},()=>this.controller.s("graphing-calculator-button-load-image-retry"))),loaded:()=>tt.createElement("div",{class:tt.const("dcg-image-loaded")},tt.createElement("div",{class:tt.const("dcg-image-title-row")},tt.createElement(Zd,{shouldFocus:()=>this.getFocusedInput()==="name",text:()=>this.model.name,ariaLabel:()=>this.controller.s("graphing-calculator-text-image-enter-note-placeholder"),placeholder:()=>this.controller.s("graphing-calculator-text-image-enter-note-placeholder"),showLinks:()=>this.controller.areLinksEnabled(),onInput:this.bindFn(this.onNameInput),onFocusChange:this.bindFn(this.onNameFocusChange),onSpecialKey:this.bindFn(this.onNameSpecialKey),readonly:()=>this.controller.isInEditListMode()||this.isReadonly()}),tt.createElement(dw,{predicate:()=>this.controller.areImagesEnabled()},()=>tt.createElement(eh,{controller:()=>this.controller,ariaLabel:()=>this.controller.s("graphing-calculator-button-change-image"),onFileChange:e=>this.insertFiles(e),location:this.const({type:"change-image-btn",id:this.id}),readonly:this.bindFn(this.isReadonly)},tt.createElement(dw,{predicate:()=>!this.isReadonly()},()=>tt.createElement("div",{class:tt.const("dcg-action-changeimage")},()=>this.controller.s("graphing-calculator-button-change-image")))))),tt.createElement("div",{class:()=>({"dcg-do-blur":!0,"dcg-image-input-grid":!0}),handleEvent:tt.const("true")},tt.createElement("div",{class:tt.const("dcg-image-input-name")},()=>this.controller.s("graphing-calculator-label-image-center")),tt.createElement(uu,{name:this.const("center"),controller:()=>this.controller,model:()=>this.model,focusedInput:this.bindFn(this.getFocusedInput),readonly:this.bindFn(this.isReadonly)}),tt.createElement("div",{class:tt.const("dcg-image-input-name")},()=>this.controller.s("graphing-calculator-label-image-width")),tt.createElement(uu,{name:this.const("width"),controller:()=>this.controller,model:()=>this.model,focusedInput:this.bindFn(this.getFocusedInput),readonly:this.bindFn(this.isReadonly)}),tt.createElement("div",{class:tt.const("dcg-image-input-name")},()=>this.controller.s("graphing-calculator-label-image-angle")),tt.createElement(uu,{name:this.const("angle"),controller:()=>this.controller,model:()=>this.model,focusedInput:this.bindFn(this.getFocusedInput),readonly:this.bindFn(this.isReadonly)}),tt.createElement("div",{class:tt.const("dcg-image-input-name")},()=>this.controller.s("graphing-calculator-label-image-height")),tt.createElement(uu,{name:this.const("height"),controller:()=>this.controller,model:()=>this.model,focusedInput:this.bindFn(this.getFocusedInput),readonly:this.bindFn(this.isReadonly)}),tt.createElement("div",{class:tt.const("dcg-image-input-name")},()=>this.controller.s("graphing-calculator-label-image-opacity")),tt.createElement(uu,{name:this.const("opacity"),controller:()=>this.controller,model:()=>this.model,focusedInput:this.bindFn(this.getFocusedInput),readonly:this.bindFn(this.isReadonly)})))})),tt.createElement("span",{class:tt.const("dcg-fadeout")}),tt.createElement(Dl,{controller:this.props.controller,id:()=>this.id}),tt.createElement(dw,{predicate:this.bindFn(this.shouldShowBrailleError)},()=>tt.createElement("div",{class:this.getFooterClass()},tt.createElement("div",{tabindex:tt.const(0),class:tt.const("dcg-expression-braille-error"),"aria-roledescription":tt.const("error"),"aria-label":()=>this.controller.unpack(this.model.error)},tt.createElement("i",{class:tt.const("dcg-icon-error"),"aria-hidden":tt.const("true")}),()=>this.controller.unpack(this.model.error)))),tt.createElement(dw,{predicate:()=>cC(this.model).length>0&&this.controller.areSlidersEnabled()},()=>tt.createElement("div",{class:this.getFooterClass()},tt.createElement(mc,{model:this.props.model,controller:this.props.controller}))),tt.createElement(dw,{predicate:this.bindFn(this.shouldShowActionInfo)},()=>tt.createElement("div",{class:this.getFooterClass()},tt.createElement(pu,{model:this.props.model,controller:this.props.controller})))),tt.createElement("span",{class:tt.const("dcg-tab dcg-action-drag dcg-action-icon-touch"),handleevent:tt.const("true"),tapboundary:tt.const("true"),disablescroll:tt.const("true"),onTapStart:this.bindFn(this.onDragPending)},tt.createElement("span",{class:tt.const("dcg-num")},()=>this.model.displayIndex),tt.createElement("div",{class:tt.const("dcg-tab-interior dcg-action-icon-mouse")},tt.createElement(cw,{model:this.props.model,controller:this.props.controller}))),tt.createElement(Cl,{controller:this.props.controller,id:()=>this.model.id}))}isReadonly(){return this.controller.isItemReadonly(this.id)}shouldShowActionInfo(){return!!(this.model.clickableInfo&&this.model.clickableInfo.enabled&&this.model.clickableInfo.latex)}getFooterClass(){return this.isFirstRender()?this.const("dcg-expression-bottom dcg-indent-in-folder"):this.const("dcg-expression-bottom dcg-fadein-bottom dcg-indent-in-folder")}onNameInput(e){this.controller.dispatch({type:"set-image-name",id:this.id,name:e})}onNameFocusChange(e){e?this.controller.dispatch({type:"set-focus-location",location:{type:"image",id:this.id,location:"name"}}):this.getFocusedInput()==="name"&&this.controller.dispatch({type:"blur-focus-location",location:{type:"image",id:this.id,location:"name"}})}onNameSpecialKey(e){return this.controller.dispatch({type:"on-special-key-pressed",key:e})}getFocusedInput(){let e=this.controller.getFocusLocation();if(e&&e.type==="image"&&e.id===this.model.id)return e.location}onRetryLoad(){this.controller.dispatch({type:"image-retry-loading",id:this.id})}shouldShowBrailleError(){return this.controller.getBrailleMode()!=="none"&&!!this.model.error}insertFiles(e){this.controller.dispatch({type:"change-image",files:e,id:this.id})}onMouseSelect(e){e.type==="dcg-tap"&&e.device==="mouse"||e.type==="dcg-tapstart"&&e.device==="touch"||e.wasHandled()||(e.handle(),this.controller.dispatch({type:"set-selected-id",id:this.id}))}};var pw=__dcg_shared_module_exports__['i'](Z());var uw=class extends $s{didMount(){this.onItemViewMounted()}willUnmount(){this.onItemViewUnmounted()}template(){let e="";return this.model.cachedRenderHeight&&(e="height:"+this.model.cachedRenderHeight+"px"),pw.createElement("div",{class:pw.const("dcg-do-not-blur dcg-expressionitem dcg-shell"),"expr-id":this.const(this.model.id),onTap:this.bindFn(this.onMouseSelect),style:pw.const(e)})}};var wm=__dcg_shared_module_exports__['i'](Z()),gw=class extends wm.Class{init(){this.controller=this.props.controller()}template(){return wm.createElement("div",{class:wm.const("dcg-drag-container"),style:()=>({top:this.getTopPx(),left:this.getLeftPx()})},this.children)}getTopPx(){let e=this.controller.getRawDragState();if(e)return e.itemTop+"px"}getLeftPx(){let e=this.controller.getRawDragState();if(e)return e.itemLeft+"px"}};Oe();var cd={delimiter:"",header:!1,dynamicTyping:!1,preview:0,step:void 0,encoding:"",comments:!1,complete:void 0,error:void 0,download:!1,chunk:void 0,keepEmptyRows:!1},tn={};tn.parse=eW;tn.unparse=tW;tn.RECORD_SEP=String.fromCharCode(30);tn.UNIT_SEP=String.fromCharCode(31);tn.BYTE_ORDER_MARK="\uFEFF";tn.BAD_DELIMITERS=["\r",`
`,'"',tn.BYTE_ORDER_MARK];tn.LocalChunkSize=1024*1024*10;tn.RemoteChunkSize=1024*1024*5;tn.DefaultDelimiter=",";tn.Parser=lS;tn.ParserHandle=xm;tn.NetworkStreamer=wB;tn.FileStreamer=xB;I.fn.parse=function(t){var e=t.config||{},r=[];return this.each(function(s){var a=I(this).prop("tagName").toUpperCase()=="INPUT"&&I(this).attr("type").toLowerCase()=="file"&&window.FileReader;if(!a||!this.files||this.files.length==0)return!0;for(var l=0;l<this.files.length;l++)r.push({file:this.files[l],inputElem:this,instanceConfig:I.extend({},e)})}),i(),this;function i(){if(r.length!=0){var s=r[0];if(Ca(t.before)){var a=t.before(s.file,s.inputElem);if(typeof a=="object")if(a.action=="abort"){n("AbortError",s.file,s.inputElem,a.reason);return}else if(a.action=="skip"){o();return}else typeof a.config=="object"&&(s.instanceConfig=I.extend(s.instanceConfig,a.config));else if(a=="skip"){o();return}}var l=s.instanceConfig.complete;s.instanceConfig.complete=function(c){Ca(l)&&l(c,s.file,s.inputElem),o()},tn.parse(s.file,s.instanceConfig)}}function n(s,a,l,c){Ca(t.error)&&t.error({name:s},a,l,c)}function o(){r.splice(0,1),i()}};function eW(t,e){var r=rW(e);if(typeof t=="string")if(r.download){var i=new wB(r);i.stream(t)}else{var n=new xm(r),o=n.parse(t);return o}else if(t instanceof File)if(r.step||r.chunk){var i=new xB(r);i.stream(t)}else{var n=new xm(r);reader=new FileReader,reader.onload=function(a){var l=new xm(r),c=l.parse(a.target.result)},reader.onerror=function(){Ca(r.error)&&r.error(reader.error,t)},reader.readAsText(t,r.encoding)}}function tW(t,e){var r="",i=[],n=!1,o=",",s=`\r
`;if(a(),typeof t=="string"&&(t=JSON.parse(t)),t instanceof Array){if(!t.length||t[0]instanceof Array)return c(null,t);if(typeof t[0]=="object")return c(l(t[0]),t)}else if(typeof t=="object")return typeof t.data=="string"&&(t.data=JSON.parse(t.data)),t.data instanceof Array&&(t.fields||(t.fields=t.data[0]instanceof Array?t.fields:l(t.data[0])),!(t.data[0]instanceof Array)&&typeof t.data[0]!="object"&&(t.data=[t.data])),c(t.fields||[],t.data||[]);throw"exception: Unable to serialize unrecognized input";function a(){typeof e=="object"&&(typeof e.delimiter=="string"&&e.delimiter.length==1&&tn.BAD_DELIMITERS.indexOf(e.delimiter)==-1&&(o=e.delimiter),(typeof e.quotes=="boolean"||e.quotes instanceof Array)&&(n=e.quotes),typeof e.newline=="string"&&(s=e.newline))}function l(p){if(typeof p!="object")return[];var g=[];for(var b in p)g.push(b);return g}function c(p,g){var b="";typeof p=="string"&&(p=JSON.parse(p)),typeof g=="string"&&(g=JSON.parse(g));var x=p instanceof Array&&p.length>0,w=!(g[0]instanceof Array);if(x){for(var E=0;E<p.length;E++)E>0&&(b+=o),b+=d(p[E],E);g.length>0&&(b+=s)}for(var k=0;k<g.length;k++){for(var S=x?p.length:g[k].length,T=0;T<S;T++){T>0&&(b+=o);var V=x&&w?p[T]:T;b+=d(g[k][V],T)}k<g.length-1&&(b+=s)}return b}function d(p,g){if(typeof p=="undefined"||p===null)return"";p=p.toString().replace(/"/g,'""');var b=typeof n=="boolean"&&n||n instanceof Array&&n[g]||u(p,tn.BAD_DELIMITERS)||p.indexOf(o)>-1||p.charAt(0)==" "||p.charAt(p.length-1)==" ";return b?'"'+p+'"':p}function u(p,g){for(var b=0;b<g.length;b++)if(p.indexOf(g[b])>-1)return!0;return!1}}function wB(t){t=t||{},t.chunkSize||(t.chunkSize=tn.RemoteChunkSize);var e=0,r=0,i="",n="",o,s,a=new xm(mw(t));this.stream=function(l){s=function(){c()},s();function c(){if(o=new XMLHttpRequest,o.onload=d,o.onerror=u,o.open("GET",l,!0),t.step){var g=e+t.chunkSize-1;r&&g>r&&(g=r),o.setRequestHeader("Range","bytes="+e+"-"+g)}o.send(),e+=t.chunkSize}function d(){if(o.readyState==4){if(o.status<200||o.status>=400){u();return}i+=n+o.responseText,n="";var g=!t.step||e>p(o);if(!g){var b=i.lastIndexOf(`
`);if(b<0&&(b=i.lastIndexOf("\r")),b>-1)n=i.substring(b+1),i=i.substring(0,b);else{s();return}}var x=a.parse(i);i="",Ca(t.chunk)&&(t.chunk(x),x=void 0),!g&&!x.meta.paused&&s()}}function u(){Ca(t.error)&&t.error(o.statusText)}function p(g){var b=g.getResponseHeader("Content-Range");return parseInt(b.substr(b.lastIndexOf("/")+1))}}}function xB(t){t=t||{},t.chunkSize||(t.chunkSize=tn.LocalChunkSize);var e=0,r="",i="",n,o,s,a=new xm(mw(t)),l=typeof FileReader=="function";this.stream=function(c){var d=c.slice||c.webkitSlice||c.mozSlice;l?(n=new FileReader,n.onload=g,n.onerror=b):n=new FileReaderSync,u();function u(){e<c.size&&p()}function p(){var x=Math.min(e+t.chunkSize,c.size),w=n.readAsText(d.call(c,e,x),t.encoding);l||g({target:{result:w}})}function g(x){e+=t.chunkSize,r+=i+x.target.result,i="";var w=e>=c.size;if(!w){var E=r.lastIndexOf(`
`);if(E<0&&(E=r.lastIndexOf("\r")),E>-1)i=r.substring(E+1),r=r.substring(0,E);else{u();return}}var k=a.parse(r);r="",Ca(t.chunk)&&(t.chunk(k,c),k=void 0),!w&&!k.meta.paused&&u()}function b(){Ca(t.error)&&t.error(n.error,c)}}}function xm(t){var e=/^\s*-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?\s*$/i,r=this,i,n,o=!1,s,a=[],l={data:[],errors:[],meta:{}};t=mw(t),this.parse=function(w){if(s=!1,!t.delimiter){var E=g(w);E.successful?t.delimiter=E.bestDelimiter:(s=!0,t.delimiter=tn.DefaultDelimiter),l.meta.delimiter=t.delimiter}if(Ca(t.step)){var k=t.step;t.step=function(S){l=S,d()?c():k(c(),r)}}return t.preview&&t.header&&t.preview++,i=w,n=new lS(t),l=n.parse(i),c(),Ca(t.complete)&&!o&&t.complete(l),o?{meta:{paused:!0}}:l},this.pause=function(){o=!0,n.abort(),i=i.substr(n.getCharIndex())},this.resume=function(){o=!1,n=new lS(t),n.parse(i),Ca(t.complete)&&!o&&t.complete(l)},this.abort=function(){n.abort(),Ca(t.complete)&&t.complete(l),i=""};function c(){return l&&s&&(x("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+tn.DefaultDelimiter+"'"),s=!1),d()&&u(),p()}function d(){return t.header&&a.length==0}function u(){if(l){for(var w=0;d()&&w<l.data.length;w++)for(var E=0;E<l.data[w].length;E++)a.push(l.data[w][E]);l.data.splice(0,1)}}function p(){if(!l||!t.header&&!t.dynamicTyping)return l;for(var w=0;w<l.data.length;w++){for(var E={},k=0;k<l.data[w].length;k++){if(t.dynamicTyping){var S=l.data[w][k];S=="true"?l.data[w][k]=!0:S=="false"?l.data[w][k]=!1:l.data[w][k]=b(S)}t.header&&(k>=a.length?(E.__parsed_extra||(E.__parsed_extra=[]),E.__parsed_extra.push(l.data[w][k])):E[a[k]]=l.data[w][k])}t.header&&(l.data[w]=E,k>a.length?x("FieldMismatch","TooManyFields","Too many fields: expected "+a.length+" fields but parsed "+k,w):k<a.length&&x("FieldMismatch","TooFewFields","Too few fields: expected "+a.length+" fields but parsed "+k,w))}return t.header&&l.meta&&(l.meta.fields=a),l}function g(w){for(var E=[",","	","|",";",tn.RECORD_SEP,tn.UNIT_SEP],k,S,T,V=0;V<E.length;V++){var O=E[V],y=0,L=0;T=void 0;for(var P=new lS({delimiter:O,preview:10}).parse(w),K=0;K<P.data.length;K++){var $=P.data[K].length;if(L+=$,typeof T=="undefined"){T=$;continue}else $>1&&(y+=Math.abs($-T),T=$)}L/=P.data.length,(typeof S=="undefined"||y<S)&&L>1.99&&(S=y,k=O)}return t.delimiter=k,{successful:!!k,bestDelimiter:k}}function b(w){var E=e.test(w);return E?parseFloat(w):w}function x(w,E,k,S){l.errors.push({type:w,code:E,message:k,row:S})}}function lS(t){var e=/^\s*$/,r,i,n,o,s,a,l,c,d,u,p,g,b,x,w,E=!1;t=t||{},i=t.delimiter,n=t.comments,o=t.step,a=t.preview,(typeof i!="string"||i.length!=1||tn.BAD_DELIMITERS.indexOf(i)>-1)&&(i=","),n===!0?n="#":(typeof n!="string"||n.length!=1||tn.BAD_DELIMITERS.indexOf(n)>-1||n==i)&&(n=!1),this.parse=function(ae){if(typeof ae!="string")throw"Input must be a string";return ie(ae),k()},this.abort=function(){E=!0},this.getCharIndex=function(){return c};function k(){for(;c<r.length&&!(E||a>0&&w>=a);)l=='"'?V():d?O():y(),S();return T()}function S(){c++,l=r[c]}function T(){if(E&&fe("Abort","ParseAbort","Parsing was aborted by the user's step function"),d&&fe("Quotes","MissingQuotes","Unescaped or mismatched quotes"),J(),!Ca(o))return pe()}function V(){z()&&!A()?d=!d:(K(),d&&A()?c++:fe("Quotes","UnexpectedQuotes","Unexpected quotes"))}function O(){(q(c)||_(c))&&u++,K()}function y(){l==i?$():q(c)?(U(),S()):_(c)?U():L()?P():K()}function L(){if(!n)return!1;var ae=c==0||_(c-1)||q(c-2);return ae&&r[c]===n}function P(){for(;!q(c)&&!_(c)&&c<r.length;)S()}function K(){p[b][x]+=l}function $(){p[b].push(""),x=p[b].length-1}function U(){J(),u++,w++,p.push([]),b=p.length-1,$()}function J(){R(),Ca(o)&&(p[b]&&o(pe()),Le())}function R(){p[b].length==1&&e.test(p[b][0])&&(t.keepEmptyRows?p[b].splice(0,1):p.splice(b,1),b=p.length-1)}function q(ae){return ae<r.length-1&&(r[ae]=="\r"&&r[ae+1]==`
`||r[ae]==`
`&&r[ae+1]=="\r")}function _(ae){return r[ae]=="\r"||r[ae]==`
`}function A(){return!z()&&c<r.length-1&&r[c+1]=='"'}function z(){return!d&&Q(c-1)||Q(c+1)}function Q(ae){typeof ae!="number"&&(ae=c);var ye=r[ae];return ae<=-1||ae>=r.length||ye==i||ye=="\r"||ye==`
`}function fe(ae,ye,H){g.push({type:ae,code:ye,message:H,line:u,row:b,index:c})}function ie(ae){r=ae,d=!1,c=0,w=0,u=1,Le(),p=[[""]],l=r[c]}function Le(){p=[],g=[],b=0,x=0}function pe(){return{data:p,errors:g,meta:{lines:u,delimiter:i,aborted:E,truncated:a>0&&c<r.length}}}}function rW(t){typeof t!="object"&&(t={});var e=mw(t);return(typeof e.delimiter!="string"||e.delimiter.length!=1||tn.BAD_DELIMITERS.indexOf(e.delimiter)>-1)&&(e.delimiter=cd.delimiter),typeof e.header!="boolean"&&(e.header=cd.header),typeof e.dynamicTyping!="boolean"&&(e.dynamicTyping=cd.dynamicTyping),typeof e.preview!="number"&&(e.preview=cd.preview),typeof e.step!="function"&&(e.step=cd.step),typeof e.complete!="function"&&(e.complete=cd.complete),typeof e.error!="function"&&(e.error=cd.error),typeof e.encoding!="string"&&(e.encoding=cd.encoding),typeof e.download!="boolean"&&(e.download=cd.download),typeof e.keepEmptyRows!="boolean"&&(e.keepEmptyRows=cd.keepEmptyRows),e}function mw(t){if(typeof t!="object")return t;var e=t instanceof Array?[]:{};for(var r in t)e[r]=mw(t[r]);return e}function Ca(t){return typeof t=="function"}var{parse:vB}=tn;Wl();function vT(t){var e;if(typeof t=="number")e=t+"";else if(typeof t=="string")e=t;else return!1;return e.trim().match(/^-?[0-9]*\.?[0-9]*$/)}function CB(t){let e=t.split(/\r?\n/),r=[],i=!1;if(!(e.length<2)){for(let n=0;n<e.length;n++){let o=e[n];if(!o.trim())continue;n>0&&!vT(o.replace(/,(\d{3})/g,"$1"))&&(i=!0);let s={content:o};r.push(s)}if(!i){let n=__dcg_shared_module_exports__['q'](r,"content").map(o=>o.replace(/,(\d{3})/g,"$1"));return vT(n[0])||(n=n.slice(1)),[{content:"\\left["+n.join(",")+"\\right]",numberList:!0}]}return r}}function DB(t){if(/^\s*$/.test(t))return;let e=vB(t,{preview:1e3}),r=e.data,i=[];if(e.errors.length&&!e.data.length){Co("PapaParse.parse returned errors.",{metaData:{input:t,output:e.errors}});return}if(!(!e.data.length||e.data.length<2)){var n=r[0].length;for(let o=0;o<n;o++)i.push([]);for(let o=0;o<e.data.length;o++)if(!(o===0&&isNaN(parseFloat(r[o][0])))){if(r[o].length<2)return;if(!(!r[o][0]&&!r[o][1]))for(let s=0;s<n;s++){let a=(r[o][s]||"").replace(/,(\d{3})/g,"$1");if(a&&isNaN(parseFloat(a)))return;i[s].push(a)}}if(!(i[0].length<2))return i}}var _s=__dcg_shared_module_exports__['i'](Z()),fw=class extends _s.Class{template(){return this.controller=this.props.controller(),_s.createElement("div",{class:_s.const("dcg-expressionitem dcg-new-expression dcg-opened")},_s.createElement("div",{class:_s.const("dcg-new-math-div dcg-do-not-blur dcg-action-newmath"),onTap:this.bindFn(this.newMath)},_s.createElement("div",{class:_s.const("dcg-new-expression-fade")})),_s.createElement("span",{class:_s.const("dcg-tab")},_s.createElement("span",{class:_s.const("dcg-num dcg-variable-index")},this.bindFn(this.getIndex)),_s.createElement("div",{class:_s.const("dcg-tab-interior")})))}getIndex(){return this.controller.getNextDisplayIndex()}newMath(){this.controller.dispatch({type:"new-expression-at-end"})}};var it=__dcg_shared_module_exports__['i'](Z());Oe();var{If:yw}=it.Components,bw=class extends it.Class{init(){this.controller=this.props.controller()}template(){return it.createElement("div",{class:it.const("dcg-add-expression-container")},it.createElement(Pe,{tooltip:()=>this.controller.s("graphing-calculator-label-add-item-tooltip"),gravity:()=>this.controller.isNarrow()?"ne":"se"},it.createElement("span",{class:()=>({"dcg-icon-btn":!0,"dcg-add-expression-btn":!0,"dcg-action-add-expression":!0,"dcg-do-blur":!0,"dcg-active":this.controller.isAddExpressionOpen()}),handleEvent:it.const("true"),role:it.const("button"),tabindex:it.const("0"),"aria-haspopup":it.const("true"),"aria-expanded":()=>this.controller.isAddExpressionOpen(),"aria-label":()=>this.controller.s("graphing-calculator-label-add-item-tooltip"),didMount:e=>{this.toggleButtonNode=e},onTap:this.bindFn(this.toggleAddExpression),manageFocus:this.const(yt({controller:this.controller,location:{type:"add-item-btn"}}))},it.createElement("i",{class:it.const("dcg-icon-plus"),"aria-hidden":it.const("true")}))),it.createElement(yw,{predicate:()=>this.controller.isAddExpressionOpen()},()=>it.createElement("div",{class:()=>({"dcg-add-expression-dropdown":!0,"dcg-popover":!0,"dcg-bottom":!this.controller.isNarrow(),"dcg-right":this.controller.isNarrow()}),role:it.const("complementary"),"aria-label":()=>this.controller.s("graphing-calculator-narration-add-item-menu"),didMount:this.bindFn(this.didMountPopover),didUnmount:this.bindFn(this.didUnmountPopover)},it.createElement("div",{class:it.const("dcg-popover-interior")},it.createElement("div",{class:it.const("dcg-new-item dcg-do-not-blur dcg-action-newexpression"),role:it.const("button"),tabindex:it.const(0),"aria-label":()=>this.controller.s("graphing-calculator-narration-add-expression"),onTap:this.bindFn(this.newExpression),handleEvent:it.const("true"),manageFocus:this.const(yt({controller:this.controller,location:{type:"add-expression-btn"}}))},it.createElement("i",{class:it.const("dcg-icon-new-expression dcg-expression-icon"),"aria-hidden":it.const("true")}),()=>this.controller.s("graphing-calculator-label-expression-lowercase")),it.createElement(yw,{predicate:()=>this.controller.areNotesEnabled()},()=>it.createElement("div",{class:it.const("dcg-new-item dcg-do-not-blur dcg-action-newtext"),role:it.const("button"),tabindex:it.const(0),"aria-label":()=>this.controller.s("graphing-calculator-narration-add-note"),onTap:this.bindFn(this.newText),handleEvent:it.const("true"),manageFocus:this.const(yt({controller:this.controller,location:{type:"add-note-btn"}}))},it.createElement("i",{class:it.const("dcg-icon-new-text dcg-expression-icon"),"aria-hidden":it.const("true")}),()=>this.controller.s("graphing-calculator-label-note-lowercase"))),it.createElement("div",{class:it.const("dcg-new-item dcg-do-not-blur dcg-action-newtable"),role:it.const("button"),tabindex:it.const(0),"aria-label":()=>this.controller.s("graphing-calculator-narration-add-table"),onTap:this.bindFn(this.newTable),handleEvent:it.const("true"),manageFocus:this.const(yt({controller:this.controller,location:{type:"add-table-btn"}}))},it.createElement("i",{class:it.const("dcg-icon-new-table dcg-expression-icon"),"aria-hidden":it.const("true")}),()=>this.controller.s("graphing-calculator-label-table-lowercase")),it.createElement(yw,{predicate:()=>this.controller.areFoldersEnabled()},()=>it.createElement("div",{class:it.const("dcg-new-item dcg-do-not-blur dcg-action-newfolder"),role:it.const("button"),tabindex:it.const(0),"aria-label":()=>this.controller.s("graphing-calculator-narration-add-folder"),onTap:this.bindFn(this.newFolder),handleEvent:it.const("true"),manageFocus:this.const(yt({controller:this.controller,location:{type:"add-folder-btn"}}))},it.createElement("i",{class:it.const("dcg-icon-new-folder dcg-expression-icon"),"aria-hidden":it.const("true")}),()=>this.controller.s("graphing-calculator-label-folder-lowercase"))),it.createElement(yw,{predicate:()=>this.controller.areImagesEnabled()},()=>it.createElement(eh,{controller:()=>this.controller,ariaLabel:()=>this.controller.s("graphing-calculator-narration-add-image"),onFileChange:e=>this.insertFiles(e),location:this.const({type:"add-image-btn"}),readonly:this.const(!1)},it.createElement("div",{class:it.const("dcg-new-item dcg-action-newimage")},it.createElement("i",{class:it.const("dcg-icon-new-image dcg-expression-icon"),"aria-hidden":it.const("true")}),()=>this.controller.s("graphing-calculator-label-image-lowercase")))),it.createElement(yw,{predicate:this.bindFn(this.showAddTicker)},()=>it.createElement("div",{class:it.const("dcg-new-item dcg-do-not-blur dcg-action-ticker"),role:it.const("button"),tabindex:it.const(0),"aria-label":()=>this.controller.s("graphing-calculator-narration-add-ticker"),onTap:this.bindFn(this.addTicker),handleEvent:it.const("true"),manageFocus:this.const(yt({controller:this.controller,location:{type:"add-ticker-btn"}}))},it.createElement("i",{class:it.const("dcg-icon-metronome dcg-expression-icon"),"aria-hidden":it.const("true")}),()=>this.controller.s("graphing-calculator-label-ticker-lowercase")))),it.createElement("span",{class:it.const("dcg-arrow")}))))}showAddTicker(){return this.controller.areActionsEnabled()&&!this.controller.getTickerOpen()}didMountPopover(e){this.popoverNode=e,I(document).on("dcg-tapstart.add-expression-view wheel.add-expression-view",r=>{this.eventShouldClosePopover(r)&&this.controller.dispatch({type:"close-add-expression",focusIconAfterClose:r.device==="keyboard"})}),I(document).on("keydown.add-expression-view",r=>{if(Te(r)==="Esc"&&this.controller.dispatch({type:"close-add-expression",focusIconAfterClose:!0}),Te(r)==="Tab"&&!r.altKey&&!r.metaKey&&!r.ctrlKey){let i=this.controller.getFocusLocation();if(!i)return;let n;this.showAddTicker()?n={type:"add-ticker-btn"}:this.controller.areImagesEnabled()?n={type:"add-image-btn"}:this.controller.areFoldersEnabled()?n={type:"add-folder-btn"}:n={type:"add-table-btn"},!r.shiftKey&&i.type===n.type?(this.controller.dispatch({type:"set-focus-location",location:{type:"add-item-btn"}}),r.preventDefault(),r.stopPropagation()):r.shiftKey&&i.type==="add-item-btn"&&(this.controller.dispatch({type:"set-focus-location",location:n}),r.preventDefault(),r.stopPropagation())}}),La&&Id&&I(e).on("dcg-tapstart",r=>r.preventDefault()),I(e).find(".dcg-new-item").on("touchstart",r=>r.preventDefault())}didUnmountPopover(){I(document).off(".add-expression-view")}toggleAddExpression(e){this.controller.dispatch({type:"toggle-add-expression",focusOnOpen:e.device==="keyboard"})}newExpression(){this.controller.dispatch({type:"new-expression"})}newText(){this.controller.dispatch({type:"new-text"})}newFolder(){this.controller.dispatch({type:"new-folder"})}addTicker(){this.controller.dispatch({type:"open-ticker"})}newTable(){this.controller.dispatch({type:"new-table"})}insertFiles(e){this.controller.dispatch({type:"new-images",files:e})}eventShouldClosePopover(e){let r=!!I(e.target).closest(this.popoverNode).length,i=!!I(e.target).closest(this.toggleButtonNode).length;return!(r||i)}};var ot=__dcg_shared_module_exports__['i'](Z());var yc=__dcg_shared_module_exports__['i'](Z());var cS=class extends yc.Class{init(){this.controller=this.props.controller()}template(){return yc.createElement("span",{role:yc.const("button"),class:()=>({"dcg-constructions-count-link":!0,"dcg-is-expanded":this.controller.getShowConstructionsOpen()}),tabindex:yc.const("0"),"aria-expanded":()=>this.controller.getShowConstructionsOpen(),manageFocus:this.const(yt({controller:this.controller,location:{type:"geo-show-constructions-icon"}})),onTap:this.bindFn(this.showAllConstructions)},yc.createElement("i",{class:yc.const("dcg-icon-geometry"),"aria-label":()=>this.controller.raw("Token Count")}),yc.createElement("span",{class:yc.const("dcg-construction-count")},()=>this.controller.getGeometryTokenCount()))}showAllConstructions(){this.controller.dispatch({type:"set-show-constructions-open",open:!this.controller.getShowConstructionsOpen(),setFocus:!1})}};var xs=__dcg_shared_module_exports__['i'](Z());var vm=class extends xs.Class{init(){this.controller=this.props.controller()}template(){return xs.createElement("div",null,xs.createElement(Pe,{tooltip:()=>this.controller.s("graphing-calculator-label-undo-tooltip"),gravity:this.bindFn(this.getUndoTooltipGravity),disabled:()=>!this.controller.canUndo()},xs.createElement("span",{class:()=>({"dcg-action-undo":!0,"dcg-icon-btn":!0,"dcg-disabled":!this.controller.canUndo()}),role:xs.const("button"),tabindex:()=>this.controller.canUndo()?0:-1,"aria-label":()=>this.controller.s("graphing-calculator-narration-undo"),onTap:()=>this.controller.dispatch({type:"undo"}),"aria-disabled":()=>!this.controller.canUndo()},xs.createElement("i",{class:xs.const("dcg-icon-undo"),"aria-hidden":xs.const("true")}))),xs.createElement(Pe,{tooltip:()=>this.controller.s("graphing-calculator-label-redo-tooltip"),gravity:this.bindFn(this.getRedoTooltipGravity),disabled:()=>!this.controller.canRedo()},xs.createElement("span",{class:()=>({"dcg-action-redo":!0,"dcg-icon-btn":!0,"dcg-disabled":!this.controller.canRedo()}),role:xs.const("button"),tabindex:()=>this.controller.canRedo()?0:-1,"aria-label":()=>this.controller.s("graphing-calculator-narration-redo"),onTap:()=>this.controller.dispatch({type:"redo"}),"aria-disabled":()=>!this.controller.canRedo()},xs.createElement("i",{class:xs.const("dcg-icon-redo"),"aria-hidden":xs.const("true")}))))}getUndoTooltipGravity(){return this.props.undoTooltipGravity?this.props.undoTooltipGravity():this.controller.isNarrow()?"n":"s"}getRedoTooltipGravity(){return this.props.redoTooltipGravity?this.props.redoTooltipGravity():this.controller.isNarrow()?"n":"s"}};var{If:th}=ot.Components,ww=class extends ot.Class{init(){this.controller=this.props.controller()}template(){return ot.createElement("div",{class:()=>({"dcg-expression-top-bar":!0,"dcg-expressions-scrolled":this.showShadow()}),role:ot.const("toolbar"),"aria-label":()=>this.controller.s("graphing-calculator-narration-expression-bar"),didMount:e=>{this.node=e},onTapStart:this.bindFn(this.clearSelectionOnMobile),style:()=>({background:this.controller.hasBackgroundColor()?this.controller.getPillboxBackgroundColor():void 0})},ot.createElement("div",{class:ot.const("dcg-left-buttons")},ot.createElement(th,{predicate:this.bindFn(this.showHamburger)},()=>ot.createElement("span",{class:ot.const("dcg-action-opendrawer dcg-tooltip dcg-icon-btn dcg-in-api-action-opendrawer"),handleEvent:ot.const("true"),tooltip:()=>this.controller.s("graphing-calculator-label-open-graph-tooltip"),role:ot.const("button"),tabindex:ot.const("0"),"aria-label":()=>this.controller.s("graphing-calculator-narration-open-graph"),onTap:()=>this.controller.dispatch({type:"open-drawer"})},ot.createElement("i",{class:ot.const("dcg-icon-hamburger"),"aria-hidden":ot.const("true")}))),ot.createElement(th,{predicate:()=>!this.controller.isInEditListMode()},()=>ot.createElement(bw,{controller:()=>this.props.controller()})),ot.createElement(th,{predicate:()=>this.controller.isGeoUIActive()},()=>ot.createElement(cS,{controller:this.props.controller})),ot.createElement(th,{predicate:this.bindFn(this.showRerandomize)},()=>ot.createElement(Pe,{tooltip:()=>this.controller.s("graphing-calculator-label-randomize-tooltip"),gravity:()=>this.controller.isNarrow()?"n":"s"},ot.createElement("span",{class:ot.const("dcg-icon-btn"),handleEvent:ot.const("true"),role:ot.const("button"),tabindex:ot.const("0"),"aria-label":()=>this.controller.s("graphing-calculator-label-randomize-tooltip"),onTap:()=>this.controller.dispatch({type:"re-randomize"})},ot.createElement("i",{class:ot.const("dcg-icon-randomize"),"aria-hidden":ot.const("true")})))),ot.createElement(th,{predicate:()=>this.controller.isInEditListMode()&&!this.controller.hasDefaultState()},()=>ot.createElement("span",{class:ot.const("dcg-btn-red dcg-action-clearall"),role:ot.const("button"),tabindex:ot.const("0"),onTap:()=>this.controller.dispatch({type:"clear-graph"})},()=>this.controller.s("graphing-calculator-button-clear-graph"))),ot.createElement(th,{predicate:()=>this.controller.isInEditListMode()&&this.controller.hasDefaultState()},()=>ot.createElement("span",{class:ot.const("dcg-btn-red dcg-action-reset"),role:ot.const("button"),tabindex:ot.const("0"),onTap:()=>this.controller.dispatch({type:"reset-graph"})},()=>this.controller.s("graphing-calculator-button-reset-graph")))),ot.createElement("div",{class:ot.const("dcg-center-buttons")},ot.createElement(vm,__dcg_shared_module_exports__['b']({},this.props))),ot.createElement("div",{class:ot.const("dcg-right-buttons")},ot.createElement(th,{predicate:()=>!this.controller.isInEditListMode()},()=>ot.createElement(Pe,{tooltip:()=>this.controller.s("graphing-calculator-label-edit-list-tooltip"),gravity:()=>this.controller.isNarrow()?"n":"s"},ot.createElement("span",{class:ot.const("dcg-icon-btn dcg-action-toggle-edit"),handleEvent:ot.const("true"),role:ot.const("button"),tabindex:ot.const("0"),"aria-label":()=>this.controller.s("graphing-calculator-narration-edit-expression-list"),onTap:this.bindFn(this.toggleEditListMode),manageFocus:this.const(yt({controller:this.controller,location:{type:"edit-list-toggle"}}))},ot.createElement("i",{class:ot.const("dcg-icon-settings"),"aria-hidden":ot.const("true")})))),ot.createElement(th,{predicate:()=>this.controller.isInEditListMode()},()=>ot.createElement("span",{class:ot.const("dcg-btn-primary dcg-action-toggle-edit dcg-do-not-blur"),handleEvent:ot.const("true"),role:ot.const("button"),tabindex:ot.const("0"),onTap:this.bindFn(this.toggleEditListMode),manageFocus:this.const(yt({controller:this.controller,location:{type:"edit-list-toggle"}}))},()=>this.controller.s("graphing-calculator-button-done"))),ot.createElement(th,{predicate:()=>!this.controller.isInEditListMode()&&this.controller.getGraphSettings().config.graphpaper},()=>ot.createElement(Pe,{tooltip:()=>this.controller.s("graphing-calculator-label-hide-expression-list-tooltip"),gravity:()=>this.controller.isNarrow()?"nw":"sw"},ot.const(" "),ot.createElement("span",{class:()=>({"dcg-resize-list-btn":!0,"dcg-action-hideexpressions":!0,"dcg-icon-btn":!0,"dcg-rotated":this.controller.isNarrow()}),role:ot.const("button"),tabindex:ot.const("0"),"aria-label":()=>this.controller.s("graphing-calculator-label-hide-expression-list-tooltip"),onTap:e=>{this.controller.dispatch({type:"hide-expressions-list",focusShowIcon:e.device==="keyboard"})},manageFocus:this.const(yt({controller:this.controller,location:{type:"hide-expression-list-btn"}}))},ot.createElement("i",{class:ot.const("dcg-icon-hide"),"aria-hidden":ot.const("true")}))))))}showShadow(){return this.controller.getTickerOpen()||this.controller.getExpressionSearchOpen()?!1:this.props.expsScrolled()}showRerandomize(){return this.controller.anyItemDependsOnRandomSeed()}showHamburger(){return!this.controller.getGraphSettings().config.showHamburger||this.controller.isInEditListMode()?!1:!this.controller.isNarrow()}clearSelectionOnMobile(e){e.wasHandled()||this.controller.dispatch({type:"set-none-selected"})}toggleEditListMode(e){this.controller.dispatch({type:"set-edit-list-mode",isEditListMode:!this.controller.isInEditListMode(),focusExpressionList:!1}),e.device==="keyboard"&&this.controller.dispatch({type:"set-focus-location",location:{type:"edit-list-toggle"}})}};Oe();function nW(t){return __dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},t),{version:"0"})}var SB=nW;var oW={centerX:0,centerY:0,size:15},sW={scale:1,unit:"",visible:!1,showLegend:!1};function aW(t){let e=t.objects||{},r=__dcg_shared_module_exports__['N'](e);for(let i in r){let n=r[i];n.label&&(n.showLabel=!0)}return{version:"1",objects:r,viewport:t.viewport||oW,customTools:t.customTools||{},grid:t.grid||sW}}var EB=aW;function lW(t){return(t.type==="point"||t.type==="glider")&&!t.draggable}function cW(t){let e=t.objects||{},r=__dcg_shared_module_exports__['N'](e),i=__dcg_shared_module_exports__['N'](t.grid);for(let n in r){let o=r[n];lW(o)&&(o.draggable=!0),o.type==="angle"&&o.showLabel&&!o.label&&(o.label="{angle}"),o.type==="segment"&&o.showLabel&&!o.label&&(o.label="{length}")}return i.unit="",i.scale=1,{version:"2",objects:r,viewport:t.viewport,customTools:t.customTools||{},grid:i}}var kB=cW;function CT(t){return t&&(t.type==="circle"||t.type==="compass")}function dW(t){let e=__dcg_shared_module_exports__['N'](t.objects||{});for(let r in e){let i=e[r];if(i.type==="point")i.y=-i.y;else if(i.type==="glider"){let n=e[i.parents.host];CT(n)&&(i.t=-i.t)}else if(i.type==="intersection"){let n=e[i.parents.host1],o=e[i.parents.host2];CT(n)&&CT(o)&&(i.negRoot=!i.negRoot)}}return{version:"3",objects:e,viewport:t.viewport,customTools:t.customTools||{},graphSettings:{showGrid:!!(t.grid||{}).visible,showAxes:!1,showAxisNumbers:!1}}}var GB=dW;function hW(t){let e=__dcg_shared_module_exports__['N'](t.objects||{});for(let r in e){let i=e[r];i.draggable===!1&&(i.locked=!0),delete i.draggable}return __dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},t),{version:"4",objects:e})}var VB=hW;var dS=[SB,EB,kB,GB,VB],pW="4";function DT(t){let e=parseInt(pW,10),r=parseInt(t.version||"0",10);for(r>e&&typeof console!="undefined"&&console.warn&&console.warn(`Loading saved state with version ${r}, but last known version is ${e}. States saved in a newer version of the geometry tool may not load correctly in older versions of the tool.`),dS[r]||typeof console!="undefined"&&console.warn&&console.warn(`State has invalid version: ${r}. If a version is present, it should be a non-negative integer less than or equal to ${e}.`),r===0&&(t=dS[0](t));r<e;)r+=1,dS[r]&&(t=dS[r](t));return t}var uW=!1;function Cm(t,e){var r=e[t];return r.type==="transformed-object"?Cm(r.parents.object,e):r.type}function IB(t){switch(t){case"circle":case"compass":case"arc":return!0}return!1}function gW(t,e,r){var i=Cm(e,r);return i==="circle"||i==="compass"?t/(2*Math.PI):t}function MB(t){switch(t){case"scaled-rotation":return!0}return!1}function mW(t){switch(t){case"point":case"midpoint":case"glider":case"intersection":case"polygon":return"P";case"line":case"segment":case"ray":case"vector":case"parallel":case"perpendicular":return"L";case"circle":case"compass":return"C";case"arc":case"angle":return"A";case"image":return"I";case"dilation":case"rotation":case"translation":case"reflection":case"scaled-rotation":return"T";case"transformed-object":return"T";default:return t}}function TB(t){let e=!uW,r=DT(t),i={},n={},o=k=>{if(n.hasOwnProperty(k))return n[k];let S=Cm(k,r.objects);if(e&&!MB(S)){let y=i.token||1;i.token=y+1;let L="\\token{"+y+"}";return n[k]=L,L}let T=mW(S),V=i[T]||1;i[T]=V+1;let O=T+"_{"+V+"}";return n[k]=O,O};function s(k){let S=i[k]||1;return i[k]=S+1,k+"_{"+S+"}"}let a=(k,S,T)=>o(k)+"=\\operatorname{"+S+"}\\left("+T.map(o).join(",")+"\\right)",{centerX:l,centerY:c,size:d}=r.viewport;d*=1.25;let u=1,p=d/(1+u),g=p*u,b={version:10,randomSeed:"",expressions:{list:[]},graph:{product:"geometry-calculator",viewport:{xmin:l-p,xmax:l+p,ymin:c-g,ymax:c+g},showGrid:!1,showXAxis:!1,showYAxis:!1,squareAxes:!0,degreeMode:!0}};r.graphSettings.showGrid&&(b.graph.showGrid=!0,b.graph.xAxisMinorSubdivisions=1,b.graph.yAxisMinorSubdivisions=1,b.graph.xAxisStep=1,b.graph.yAxisStep=1);let x=b.expressions.list,w=[],E=[];for(let k in r.objects){let S=r.objects[k],T=Cm(S.id,r.objects),V={id:S.id,type:"expression",color:S.color,hidden:!!S.hidden};if(e&&!MB(T)&&(V.folderId=__dcg_shared_module_exports__['Oc']),S.locked&&(V.dragMode="NONE"),!S.hidden&&S.label&&S.showLabel){if(V.label=S.label,V.showLabel=!0,T==="segment"&&S.label.indexOf("{length}")!==-1)if(S.label==="{length}")V.label="";else{let O=s("l"),y=O+"=\\operatorname{round}\\left(\\operatorname{length}\\left("+o(S.id)+"\\right),2\\right)";E.push({id:"len-"+V.id,type:"expression",latex:y}),V.label=V.label.replace(/\{length\}/g,"${"+O+"}")}if(T==="angle"&&S.label.indexOf("{angle}")!==-1)if(S.label==="{angle}")V.label="";else{let O=s("a"),y=O+"=\\operatorname{round}\\left(\\operatorname{measure}\\left("+o(S.id)+"\\right)\\right)";E.push({id:"angle-"+V.id,type:"expression",latex:y}),V.label=V.label.replace(/\{angle}/g,"${"+O+"}\xB0")}if(T==="polygon"&&S.label.indexOf("{area}")!==-1)if(S.label==="{area}")V.label="";else{let O=s("a"),y=O+"=\\operatorname{round}\\left(\\operatorname{area}\\left("+o(S.id)+"\\right),2\\right)";E.push({id:"area-"+V.id,type:"expression",latex:y}),V.label=V.label.replace(/\{area\}/g,"${"+O+"}")}if(T==="polygon"&&S.label.indexOf("{perimeter}")!==-1){let O=s("p"),y=O+"=\\operatorname{round}\\left(\\operatorname{perimeter}\\left("+o(S.id)+"\\right),2\\right)";E.push({id:"perim-"+V.id,type:"expression",latex:y}),V.label=V.label.replace(/\{perimeter\}/g,"${"+O+"}")}}switch(S.type){case"point":V.latex=o(S.id)+"=\\left("+__dcg_shared_module_exports__['lc'](S.x)+","+__dcg_shared_module_exports__['lc'](S.y)+"\\right)";break;case"glider":V.latex=o(S.id)+"=\\operatorname{glider}\\left("+o(S.parents.host)+","+__dcg_shared_module_exports__['lc'](gW(S.t,S.parents.host,r.objects))+"\\right)";break;case"intersection":let O=Cm(S.parents.host1,r.objects),y=Cm(S.parents.host2,r.objects),L=S.negRoot;(IB(O)&&!IB(y)||y==="arc")&&(L=!L),L?V.latex=a(S.id,S.type,[S.parents.host1,S.parents.host2]):V.latex=a(S.id,S.type,[S.parents.host2,S.parents.host1]);break;case"midpoint":V.latex=a(S.id,S.type,[S.parents.straight]);break;case"circle":V.latex=a(S.id,S.type,[S.parents.point1,S.parents.point2]);break;case"arc":V.latex=a(S.id,S.type,[S.parents.point1,S.parents.point2,S.parents.point3]);break;case"compass":V.latex=a(S.id,"circle",[S.parents.center,S.parents.straight]);break;case"line":case"segment":case"ray":V.latex=a(S.id,S.type,[S.parents.point1,S.parents.point2]);break;case"vector":V.latex=a(S.id,"segment",[S.parents.point1,S.parents.point2]),V.arrowMode="POSITIVE";break;case"parallel":case"perpendicular":V.latex=a(S.id,S.type,[S.parents.straight,S.parents.point]);break;case"polygon":V.latex=a(S.id,S.type,S.parents.points);break;case"angle":V.latex=a(S.id,S.type,[S.parents.point1,S.parents.point2,S.parents.point3]);break;case"transformed-object":V.latex=o(S.id)+"="+o(S.parents.transformation)+"\\left("+o(S.parents.object)+"\\right)";break;case"dilation":V.latex=o(S.id)+"\\left(x\\right)=\\operatorname{dilate}\\left(x,"+o(S.parents.center)+","+S.scaleFactor+"\\right)";break;case"reflection":V.latex=o(S.id)+"\\left(x\\right)=\\operatorname{reflect}\\left(x,"+o(S.parents.straight)+"\\right)";break;case"translation":V.latex=o(S.id)+"\\left(x\\right)=\\operatorname{translate}\\left(x,"+o(S.parents.from)+","+o(S.parents.to)+"\\right)";break;case"rotation":V.latex=o(S.id)+"\\left(x\\right)=\\operatorname{rotate}\\left(x,"+o(S.parents.center)+","+S.angle+"\\right)";break;case"scaled-rotation":V.latex=o(S.id)+"=";break;case"image":break;default:return S}V.latex&&(V.folderId===__dcg_shared_module_exports__['Oc']?w.push(V):E.push(V))}return x.push({type:"folder",id:__dcg_shared_module_exports__['Oc'],title:"geometry",secret:!0}),x.push.apply(x,w),x.push.apply(x,E),b}function AB(t){let e=__dcg_shared_module_exports__['N'](uc(t));if(e.graph.product="geometry-calculator",!e.expressions.list.some(i=>i.id===__dcg_shared_module_exports__['Oc'])){let i={type:"folder",id:__dcg_shared_module_exports__['Oc'],title:"geometry",secret:!0};e.expressions.list.unshift(i)}return e}function hS(t,e,r){let i=!1;t.dispatch({type:"toast/show",toast:{message:t.s("graphing-calculator-text-toast-importing-graph"),hideAfter:0,toastStyle:"cover",onHide:()=>{i=!0}}});let n=()=>{i||t.dispatch({type:"toast/show",toast:{message:t.s("graphing-calculator-text-toast-error-importing-graph"),toastStyle:"error",hideAfter:12e3}})},o=()=>{t.dispatch({type:"toast/show",toast:{message:t.s("graphing-calculator-text-toast-error-no-folders"),toastStyle:"error",hideAfter:12e3}})},s=(l,c)=>{t.dispatch({type:"set-state",state:l}),t.dispatch({type:"toast/show",toast:{message:t.s("graphing-calculator-text-toast-imported-graph"),undoCallback:()=>{t.dispatch({type:"set-state",state:c})}}})},a=(l,c,d)=>{if(i)return;let u=t.getSelectedItem();if(!u)return;let p=u.type==="folder",g=u.type!=="folder"&&!!u.folderId,b=p||g,x={},w=t.getState(),E=w.expressions.list;if(E.length===1&&!p){s(l,w);return}if(t.isGeometry()&&(d!=="graphing"||!p)){s(l,w);return}let k=l.expressions.list;t.isGeometry()&&(k=k.filter(({id:y})=>y!==__dcg_shared_module_exports__['Oc']));for(let y=0;y<k.length;y++){let L=t.generateId(),P=k[y];if(P.type==="folder")if(b){o();return}else{x[P.id]=L,P.id=L;continue}P.folderId?P.folderId=x[P.folderId]:p?P.folderId=u.id:g&&(P.folderId=u.folderId),P.id=L}let S=__dcg_shared_module_exports__['N'](w),T=0;for(;T<E.length;){if(E[T].id===u.id){p&&(E[T].title=c);break}T+=1}let V=p?T+1:T,O=p?0:1;E.splice(V,O,...k),s(w,S)};I.getJSON(e,Bc).done(l=>{let c=l.state,d=aB(e);t.isGeometry()&&(d==="geometry"?c=TB(c):d==="graphing"&&(c=AB(c))),c=uc(c),r(c,(u,p)=>{u||!p||!d?n():a(p,l.title||"",d)})}).fail(n)}function LB(t){if(window.clipboardData&&window.clipboardData.getData)return window.clipboardData.getData("Text");if(t&&t.clipboardData&&t.clipboardData.getData)return t.clipboardData.getData("text/plain")}var rh=__dcg_shared_module_exports__['i'](Z());Oe();var{If:fW}=rh.Components,pS=class extends rh.Class{init(){this.guid=__dcg_shared_module_exports__['L']("dcg-exp-list-resize")}template(){return rh.createElement(fW,{predicate:this.bindFn(this.isVisible)},()=>rh.createElement("div",{class:rh.const("dcg-exp-list-resizer"),onTapStart:this.bindFn(this.onTapStart)}))}isVisible(){return this.props.controller().expressionsAreFullWidth()?!1:this.props.controller().isListVisible()}onTapStart(e){this.initialWidth=this.props.controller().getExpListWidth(),this.initialLeft=e.changedTouches[0].clientX,I(document).on(`dcg-tapmove.${this.guid}`,r=>{if(this.initialLeft===void 0||this.initialWidth===void 0)return;let i=r.changedTouches[0].clientX-this.initialLeft+this.initialWidth;this.props.controller().dispatch({type:"resize-exp-list",expListWidth:i})}),I(document).on(`dcg-tapend.${this.guid}`,this.bindFn(this.onTapEnd)),I(document).on(`dcg-tapcancel.${this.guid}`,this.bindFn(this.onTapEnd))}onTapEnd(){I(document).off(`.${this.guid}`),this.initialLeft=void 0,this.initialWidth=void 0}};var ir=__dcg_shared_module_exports__['i'](Z());var{If:xw}=ir.Components,uS=class extends ir.Class{constructor(){super(...arguments),this.justGlobalReplaced=!1}init(){this.controller=this.props.controller()}template(){return ir.createElement("div",{class:()=>({"dcg-expression-search-bar":!0,"dcg-expressions-scrolled":this.props.expsScrolled()&&!this.controller.getTickerOpen()}),role:ir.const("search")},ir.createElement("div",{class:ir.const("dcg-search-row")},ir.createElement("div",{class:ir.const("dcg-search-mathquill-container")},ir.createElement(Xe,{hasError:this.const(!1),getAriaLabel:()=>this.controller.s("graphing-calculator-label-search-expressions"),getAriaPostLabel:()=>this.controller.getExpressionSearchStr().length===0?this.controller.raw(""):this.shouldShowReplaceError()?this.controller.s("graphing-calculator-error-expression-replacement"):this.shouldShowSearchError()?this.controller.s("graphing-calculator-error-expression-search"):this.controller.s("graphing-calculator-narration-expression-search-results",{count:this.controller.getExpressionSearchCount()}),capExpressionSize:this.const(!1),onUserChangedLatex:this.bindFn(this.onSearchChange),latex:()=>this.controller.getRawExpressionSearchStr(),isFocused:this.bindFn(this.isSearchFocused),config:this.bindFn(this.getMQConfig),onFocusedChanged:this.bindFn(this.onSearchFocusChanged),noFadeout:this.const(!0),onUserPressedKey:(e,r)=>{if(e==="Esc")r&&r.preventDefault(),this.closeSearch();else if(e==="Enter")r&&r.preventDefault(),this.onEnter();else{var i=Xe.getFocusedMathquill();if(!i)return;i.keystroke(e,r),this.controller.getRawExpressionSearchStr()!==i.latex()&&(this.justGlobalReplaced=!1,this.onSearchChange(i.latex()))}}}),ir.createElement("i",{class:ir.const("dcg-icon-search"),"aria-hidden":ir.const("true")}),ir.createElement(xw,{predicate:()=>this.controller.getRawExpressionSearchStr().length===0},()=>ir.createElement("span",{class:ir.const("dcg-search-placeholder")},()=>this.controller.s("graphing-calculator-label-search-expressions"))),ir.createElement(xw,{predicate:()=>this.shouldShowSearchError()},()=>ir.createElement("span",{class:ir.const("dcg-search-replace-icon-container")},ir.createElement(ys,{error:()=>this.controller.s("graphing-calculator-error-expression-search"),gravity:this.const("s"),size:this.const("small")}))),ir.createElement(xw,{predicate:()=>this.controller.isSearchReplaceValid()&&!this.justGlobalReplaced},()=>ir.createElement("span",{class:ir.const("dcg-search-replace-icon-container")},ir.createElement("i",{class:ir.const("dcg-icon-replace"),role:ir.const("button"),tabindex:ir.const("0"),"aria-label":()=>this.controller.s("graphing-calculator-button-replace"),onTap:this.bindFn(this.onGlobalReplace)}))),ir.createElement(xw,{predicate:()=>this.justGlobalReplaced},()=>ir.createElement("span",{class:ir.const("dcg-search-replace-icon-container")},ir.createElement("i",{class:ir.const("dcg-icon-check"),"aria-hidden":ir.const("true")}))),ir.createElement(xw,{predicate:()=>this.shouldShowReplaceError()},()=>ir.createElement("span",{class:ir.const("dcg-search-replace-icon-container")},ir.createElement(ys,{error:()=>this.controller.s("graphing-calculator-error-expression-replacement"),gravity:this.const("s"),size:this.const("small")})))),ir.createElement("i",{onTap:()=>this.closeSearch(),tabindex:ir.const("0"),"aria-label":()=>this.controller.s("account-shell-button-cancel"),role:ir.const("button"),class:ir.const("dcg-icon-remove dcg-do-not-blur")})))}onGlobalReplace(){this.justGlobalReplaced=!0,setTimeout(()=>{this.justGlobalReplaced=!1,this.update()},1500),this.controller.dispatch({type:"rename-identifier-global",search:this.controller.getExpressionSearchStr(),replace:this.controller.getExpressionReplaceStr()})}onEnter(){this.controller.isSearchReplaceValid()?this.onGlobalReplace():this.controller.dispatch({type:"update-expression-search-str",str:this.controller.getRawExpressionSearchStr()})}shouldShowSearchError(){return!this.controller.getIsExpressionSearchStrValidForReplace()&&this.controller.getExpressionReplaceStr().length>0}shouldShowReplaceError(){return!this.shouldShowSearchError()&&!this.controller.getIsExpressionReplaceStrValidForReplace()&&this.controller.getExpressionReplaceStr().length>0}closeSearch(){this.controller.dispatch({type:"close-expression-search"})}onSearchChange(e){this.controller.dispatch({type:"update-expression-search-str",str:e})}onSearchFocusChanged(e){e?this.controller.dispatch({type:"set-focus-location",location:{type:"search-expressions"}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"search-expressions"}})}isSearchFocused(){let e=this.controller.getFocusLocation();return!!e&&e.type==="search-expressions"}onReplaceChange(e){this.controller.dispatch({type:"update-expression-replace-str",str:e})}onReplaceFocusChanged(e){e?this.controller.dispatch({type:"set-focus-location",location:{type:"replace-expressions"}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"replace-expressions"}})}isReplaceFocused(){let e=this.controller.getFocusLocation();return!!e&&e.type==="replace-expressions"}getMQConfig(){return this.controller.getMathquillConfig({additionalOperators:["label","rename"]})}};var tr=__dcg_shared_module_exports__['i'](Z());var{If:PB,IfDefined:yW}=tr.Components,gS=class extends tr.Class{init(){this.controller=this.props.controller()}template(){return tr.createElement("div",{class:()=>({"dcg-ticker":!0,"dcg-expressions-scrolled":this.props.expsScrolled()})},tr.createElement("div",{class:tr.const("dcg-ticker-settings-container")},tr.createElement("div",{class:tr.const("dcg-ticker-settings-internal")},tr.createElement("div",{class:tr.const("dcg-editable-mathquill-container dcg-action-definition")},tr.createElement("span",{class:tr.const("dcg-ticker-label")},()=>this.controller.raw("Run")),tr.createElement(Xe,{hasError:()=>!!this.getHandlerErrorString(),getAriaPostLabel:()=>{let e=this.getHandlerErrorString();return e?this.controller.unpack(e):""},capExpressionSize:this.const(!1),onUserChangedLatex:e=>this.dispatchHandlerLatexIfChanged(e),latex:()=>this.getHandlerLatex(),getAriaLabel:()=>this.controller.s("graphing-calculator-narration-tick-action"),isFocused:()=>this.getFocusedInput()==="handler",config:()=>this.getMQConfig(),onFocusedChanged:e=>this.handleFocusedChanged("handler",e),selectOnFocus:this.const(!0),noFadeout:this.const(!0),onUserPressedKey:(e,r)=>{this.handlePressedKey("handler",e,r)}}),yW(()=>this.getHandlerErrorString(),e=>tr.createElement("span",{class:tr.const("dcg-clickable-info-error-container")},tr.createElement(ys,{error:()=>this.controller.unpack(e()),gravity:this.const("s"),size:this.const("small")})))),tr.createElement("div",{class:tr.const("dcg-editable-mathquill-container dcg-action-frequency")},tr.createElement("span",{class:tr.const("dcg-ticker-label")},()=>this.controller.raw("every")),tr.createElement(Xe,{hasError:()=>!!this.getMinStepErrorString(),getAriaPostLabel:()=>{let e=this.getMinStepErrorString();return e?this.controller.unpack(e):""},capExpressionSize:this.const(!1),onUserChangedLatex:e=>this.dispatchMinStepLatexIfChanged(e),latex:()=>this.getMinStepLatex(),getAriaLabel:()=>this.controller.s("graphing-calculator-label-ticker-min-step"),isFocused:()=>this.getFocusedInput()==="minstep",config:this.bindFn(this.getMQConfig),onFocusedChanged:e=>this.handleFocusedChanged("minstep",e),selectOnFocus:this.const(!0),placeholder:this.const("0"),noFadeout:this.const(!0),onUserPressedKey:(e,r)=>{this.handlePressedKey("minstep",e,r)}}),()=>this.controller.raw("ms"),tr.createElement(Pe,{tooltip:()=>this.controller.s("graphing-calculator-label-ticker-help-tooltip"),gravity:this.const("s")},tr.createElement("a",{"aria-label":()=>this.controller.s("graphing-calculator-label-ticker-help-tooltip"),class:tr.const("dcg-ticker-toggle-help"),target:tr.const("_blank"),href:tr.const("https://help.desmos.com/hc/en-us/articles/4407725009165")},tr.createElement("i",{class:tr.const("dcg-icon-question-sign"),"aria-hidden":tr.const("true")})))),tr.createElement(PB,{predicate:this.bindFn(this.shouldShowSliderPrompt)},()=>tr.createElement(mc,{model:()=>this.props.controller().getTicker(),controller:this.props.controller}))),tr.createElement("div",{class:()=>({"dcg-circular-icon-container":!0,"dcg-disabled":this.iconDisabled()}),"aria-label":this.bindFn(this.getIconAriaLabel),role:tr.const("button"),tabindex:()=>this.iconDisabled()?-1:0,"aria-disabled":this.bindFn(this.iconDisabled),"aria-pressed":()=>this.controller.getTickerPlaying()&&!this.iconDisabled(),onTap:this.bindFn(this.toggleTicker),onTapStart:()=>{ti()}},tr.createElement(cn,{iconType:this.const("metronome")}),tr.createElement("div",{class:()=>({"dcg-metronome-bar":!0,"dcg-metronome-playing":this.controller.getTickerPlaying()&&!this.iconDisabled()})}),tr.createElement(PB,{predicate:()=>!this.iconDisabled()},()=>tr.createElement("div",{class:tr.const("dcg-mini-play-pause")},tr.createElement(cn,{iconType:this.bindFn(this.getPlayIcon)}))))),tr.createElement("i",{onTap:this.bindFn(this.closeTicker),tabindex:()=>this.controller.isInEditListMode()?0:-1,"aria-label":()=>this.controller.s("graphing-calculator-label-ticker-close"),role:tr.const("link"),class:tr.const("dcg-icon-remove dcg-do-not-blur")}))}iconDisabled(){return!!(this.getMinStepErrorString()||this.getHandlerErrorString()||!this.isHandlerMaybeValid())}isHandlerMaybeValid(){var r;return((r=this.controller.getTicker().formula)==null?void 0:r.handler.status)==="maybe-valid"}closeTicker(){this.controller.dispatch({type:"close-ticker"})}toggleTicker(){this.iconDisabled()||this.controller.dispatch({type:"toggle-ticker"})}getPlayIcon(){return this.controller.getTickerPlaying()?"pause":"play"}getIconAriaLabel(){return this.controller.getTickerPlaying()?this.controller.s("graphing-calculator-label-ticker-pause"):this.controller.s("graphing-calculator-label-ticker-play")}getFocusedInput(){let e=this.controller.getFocusLocation();if(!(!e||e.type!=="ticker"))return e.location}handlePressedKey(e,r,i){let n=Xe.getFocusedMathquill();if(n){if(r==="Enter"&&this.shouldShowSliderPrompt()&&this.controller.dispatch({type:"create-sliders-for-ticker",variables:Sy(this.props.controller().getTicker())}),r==="Right"&&e==="handler"||r==="Left"&&e==="minstep"||r==="Down"){var o=Xe.applyArrowKeyAndReturnIfWasAtBounds(n,r,i);if(!o)return;if(r==="Down")return this.controller.dispatch({type:"on-special-key-pressed",key:r});if(r==="Right"){this.handleFocusedChanged("minstep",!0);return}else if(r==="Left"){this.handleFocusedChanged("handler",!0);return}}n.keystroke(r,i),e==="handler"?this.dispatchHandlerLatexIfChanged(n.latex()):e==="minstep"&&this.dispatchMinStepLatexIfChanged(n.latex())}}handleFocusedChanged(e,r){r?this.controller.dispatch({type:"set-focus-location",location:{type:"ticker",location:e}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"ticker",location:e}})}dispatchHandlerLatexIfChanged(e){this.getHandlerLatex()!==e&&this.controller.dispatch({type:"update-ticker-handlerlatex",latex:e})}dispatchMinStepLatexIfChanged(e){this.getMinStepLatex()!==e&&this.controller.dispatch({type:"update-ticker-minsteplatex",latex:e})}getHandlerLatex(){return this.controller.getTickerHandlerLatex()}getMinStepLatex(){return this.controller.getTickerMinStepLatex()}getMQConfig(){return this.controller.getMathquillConfig({additionalOperators:["dt"]})}getHandlerErrorString(){return this.getHandlerLatex()?G_(this.controller.getTicker()):void 0}getMinStepErrorString(){return V_(this.controller.getTicker())}shouldShowSliderPrompt(){return this.controller.areSlidersEnabled()?Sy(this.controller.getTicker()).length>0:!1}};var Vo=__dcg_shared_module_exports__['i'](Z());var{For:OB,If:bW}=Vo.Components,mS=class extends Vo.Class{init(){this.controller=this.props.controller(),this.currentlyInspectedDepth=1/0,this.cachedTokenDepths={depths:{},isInvalid:!1},this.updateCachedTokenDepthInfo()}willUpdate(){this.updateCachedTokenDepthInfo()}updateCachedTokenDepthInfo(){let e="",r=!1,i=this.controller.getFocusLocation();if(i&&i.type==="expression"){let o=this.controller.getFocusedItem();(o==null?void 0:o.type)==="expression"&&(e=o.id,r=!!o.error||!!o.formula.variables.length)}if(this.cachedTokenDepths.focusedExpressionBeforeError==e&&r){this.cachedTokenDepths.isInvalid=!0;return}this.cachedTokenDepths={depths:this.controller.cachedGeoTokenDepths,isInvalid:!1,focusedExpressionBeforeError:r?void 0:e}}template(){return Vo.createElement("div",{class:()=>({"dcg-geo-show-constructions-pane":!0,"dcg-transient-error":this.cachedTokenDepths.isInvalid}),"aria-label":()=>this.controller.raw("Object Navigator"),role:Vo.const("group"),didUnmount:()=>this.lastFocusedIdentifier=void 0,onKeydown:this.bindFn(this.handleKeydown)},Vo.createElement(bW,{predicate:()=>this.controller.getGeometryTokenCount()===0},()=>Vo.createElement("div",{class:Vo.const("dcg-empty-constructions")},()=>this.controller.raw("No constructed objects yet."))),Vo.createElement(OB,{each:this.bindFn(this.getObjectDepths)},Vo.createElement("div",{class:Vo.const("dcg-displayed-sections-container")},e=>Vo.createElement("div",{class:()=>({"dcg-displayed-section-level":!0,"dcg-selected-level":parseInt(e)===this.getCurrentlyInspectedDepth(),"dcg-below-the-line":parseInt(e)>this.getCurrentlyInspectedDepth()})},Vo.createElement(OB,{each:()=>this.getTokensForDepth(e),key:(r,i)=>i},Vo.createElement("span",{role:Vo.const("listbox"),"aria-label":()=>this.controller.raw(`Depth: ${e}`)},(r,i)=>Vo.createElement("span",{class:()=>({"dcg-token-being-dragged-container":this.isTokenBeingDragged(e,i)}),onTapStart:n=>{let o=this.getCalcIdForDepth(e,i),s=this.controller.getItemModel(o);!s||s.type!=="expression"||this.controller.isItemInGeoFolder(s.id)&&this.props.onDragPending(n,{type:"token",calcId:o,originalIndex:s.index})}},Vo.createElement(td,{showParentChildrenHover:this.const(!0),controller:this.props.controller,identifier:()=>this.getIdentifierForDepth(e,i),insideMQ:this.const(!1),insideGroup:this.const(!0),focusLocation:()=>({type:"geo-token",identifier:this.getIdentifierForDepth(e,i)}),putInTabOrder:()=>{if(this.lastFocusedIdentifier===void 0){let n=this.getObjectDepths();this.lastFocusedIdentifier=this.getIdentifierForDepth(n[0],0)}return this.lastFocusedIdentifier===this.getIdentifierForDepth(e,i)}}))))))))}isTokenBeingDragged(e,r){let i=this.controller.getDraggedItemId();if(!i)return!1;if(this.controller.isItemInGeoFolder(i))return i==this.getCalcIdForDepth(e,r)}getCurrentlyInspectedDepth(){return Math.min(this.currentlyInspectedDepth,this.getObjectDepths().length-1)}getIdentifierForDepth(e,r){var i=this.getTokensForDepth(e)[r];return i?i.identifier:""}getCalcIdForDepth(e,r){var i=this.getTokensForDepth(e)[r];return i?i.calcId:""}getTokensForDepth(e){let{depths:r}=this.cachedTokenDepths;var i=r[e];return i||[]}getObjectDepths(){let e=Object.keys(this.cachedTokenDepths.depths);return e.sort((r,i)=>{let n=parseInt(r),o=parseInt(i);return isFinite(n)?isFinite(o)?n-o:1:-1}),e}selectItemIfNecessary(){if(this.controller.hasAnyItemsSelected())return;let e=this.controller.getFocusLocation();if((e==null?void 0:e.type)!=="geo-token")return;let{calcId:r}=this.controller.cachedGeoTokenInfo[e.identifier];!r||!this.controller.getItemModel(r)||this.controller.dispatch({type:"set-selected-id",id:r})}handleKeydown(e){let r=this.controller.getFocusLocation(),i=Te(e),n=ei(e);if(e.ctrlKey&&e.shiftKey&&!e.altKey&&!e.metaKey&&n==="O"){e.preventDefault(),e.stopPropagation(),this.selectItemIfNecessary(),this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"multi-select-more",guid:ru(),focusFirstOption:!0,previousFocusLocation:r}});return}if(e.altKey&&!e.ctrlKey&&!e.metaKey&&e.shiftKey&&n==="M"){if(e.preventDefault(),e.stopPropagation(),(r==null?void 0:r.type)!=="geo-token")return;let{calcId:p}=this.controller.cachedGeoTokenInfo[r.identifier];if(!p)return;let g=this.controller.getItemModel(p);if(!g||g.type!=="expression"||!g.formula.geometry)return;this.controller.convertToNamedAssignment(g),No(g,""),this.controller.getEvaluator().notifyWhenSynced(()=>{this.controller.dispatch({type:"set-none-selected"}),this.controller.dispatch({type:"set-focus-location",location:{type:"expression",id:g.id}})});return}if(e.altKey||e.ctrlKey||e.metaKey||e.shiftKey)return;if(i==="Esc"){e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"set-show-constructions-open",open:!1,setFocus:!0});return}if(i!=="Up"&&i!=="Down"&&i!=="Left"&&i!=="Right")return;e.preventDefault(),e.stopPropagation();let o=this.getObjectDepths();if(o.length===0)return;let s="";if(r&&r.type==="geo-token")s=r.identifier;else{let p=this.getTokensForDepth(o[0])[0];if(!p)return;s=p.identifier}if(s==="")return;let a,l=-1,c=[];for(a=0;a<o.length;a++){let p=o[a];if(c=this.getTokensForDepth(p),!!c&&(l=__dcg_shared_module_exports__['y'](c,{identifier:s}),l!==-1))break}if(a===-1||l===-1)return;i==="Up"?a=Math.max(a-1,0):i==="Down"?a=Math.min(a+1,o.length-1):i==="Left"?l=Math.max(l-1,0):i==="Right"&&(l=Math.min(l+1,c.length-1));let d=this.getTokensForDepth(o[a]);if(!d)return;l=Math.min(l,d.length-1);let u=d[l].identifier;this.controller.dispatch({type:"set-focus-location",location:{type:"geo-token",identifier:u}}),this.lastFocusedIdentifier=u}};var{If:sp,For:wW,Switch:_B,SwitchUnion:xW}=vt.Components,vw=class extends vt.Class{constructor(){super(...arguments),this.guid=__dcg_shared_module_exports__['L']("listView")}init(){this.controller=this.props.controller()}template(){return vt.createElement("div",{didMount:this.bindFn(this.didMountContainer)},vt.createElement("div",{class:vt.const("dcg-exppanel-outer"),onDrop:this.bindFn(this.onDrop),style:()=>this.computeExppanelOuterStyle()},vt.createElement(sp,{predicate:()=>this.controller.isFileDraggedOver()},()=>vt.createElement("div",{class:vt.const("dcg-drop-image")},vt.createElement("span",null,()=>this.controller.s("graphing-calculator-label-drop-image-here")))),vt.createElement("div",{class:()=>({"dcg-exppanel-container":!0,"dcg-add-shadow":this.controller.shouldRenderList()}),style:()=>({transform:this.controller.isListVisible()?void 0:this.controller.isNarrow()?"translate(0, 100%)":"translate(-100%, 0)"})},vt.createElement(sp,{predicate:()=>this.controller.shouldRenderList()},()=>vt.createElement(ww,{controller:this.props.controller,expsScrolled:()=>!!this.exppanel&&this.exppanel.scrollTop>0})),vt.createElement(sp,{predicate:()=>this.controller.getExpressionSearchOpen()},()=>vt.createElement(uS,{controller:this.props.controller,expsScrolled:()=>!!this.exppanel&&this.exppanel.scrollTop>0})),vt.createElement(sp,{predicate:()=>this.controller.getTickerOpen()&&!this.controller.getTicker().filteredBySearch},()=>vt.createElement(gS,{controller:this.props.controller,expsScrolled:()=>!!this.exppanel&&this.exppanel.scrollTop>0})),vt.createElement(sp,{predicate:()=>this.controller.shouldRenderList()},()=>vt.createElement("div",{class:()=>({"dcg-exppanel":!0,"dcg-disable-horizontal-scroll-to-cursor":!0,"dcg-isDragging":this.controller.isDragDropActive(),"dcg-has-background-color":this.controller.hasBackgroundColor(),"dcg-edit-list-mode":this.controller.isInEditListMode()}),style:()=>({background:this.controller.getBackgroundColor()}),onPaste:this.bindFn(this.onPaste),onTapStart:this.bindFn(this.onExppanelTapstart),didMount:this.bindFn(this.didMountExppanel)},vt.createElement("div",{class:vt.const("dcg-expressionlist"),role:vt.const("complementary"),"aria-label":()=>this.controller.s("graphing-calculator-narration-expression-list")},vt.createElement(sp,{predicate:()=>this.controller.getShowConstructionsOpen()},()=>vt.createElement(mS,{controller:this.props.controller,onDragPending:(e,r)=>this.onDragPending(e,r)})),vt.createElement(wW,{each:()=>this.controller.getAllItemModels(),key:e=>e.guid},vt.createElement("span",{class:vt.const("dcg-template-expressioneach")},e=>xW(()=>FC(e),{shell:()=>this.makeShellViewForModel(e),render:()=>this.makeViewForModel(e),none:()=>{}}))),vt.createElement(fw,{controller:()=>this.props.controller()}),vt.createElement(_B,{key:()=>this.controller.getDraggedItemId()},e=>{if(e){let r=this.controller.getItemModel(e);return vt.createElement(gw,{controller:this.props.controller},this.makeDragCopyViewForModel(r))}else return}),vt.createElement("div",{class:vt.const("dcg-expressions-branding"),style:()=>({opacity:this.controller.isKeypadOpen()?0:1})},vt.createElement(sp,{predicate:()=>this.controller.canEditOnWeb()},()=>vt.createElement("span",{role:vt.const("link"),tabindex:vt.const(0),class:vt.const("dcg-edit-branding"),onTap:()=>this.controller.dispatch({type:"open-on-web"})},vt.createElement("div",{class:vt.const("dcg-powered-by"),"aria-label":()=>this.controller.s("graphing-calculator-narration-edit-graph-on-desmos")},()=>this.controller.s("graphing-calculator-button-edit-graph-on-desmos-logo")),vt.createElement("i",{class:vt.const("dcg-icon-desmos"),"aria-hidden":vt.const("true")}))),vt.createElement(sp,{predicate:()=>!this.controller.canEditOnWeb()},()=>vt.createElement("span",{class:vt.const("dcg-noedit-branding")},vt.createElement("div",{class:vt.const("dcg-powered-by"),"aria-label":()=>this.controller.s("graphing-calculator-narration-powered-by-desmos")},()=>this.controller.s("graphing-calculator-label-powered-by")),vt.createElement("i",{class:vt.const("dcg-icon-desmos"),"aria-hidden":vt.const("true")})))))))),vt.createElement(pS,{controller:this.props.controller})))}makeShellViewForModel(e){return vt.createElement(uw,{controller:this.props.controller,model:()=>e,onDragPending:()=>{},isDragCopy:()=>!1})}computeExppanelOuterStyle(){this.getListBottomAndUpdateLastExpressionPadding();let{list:e}=this.controller.computeMajorLayout(),r=0,i=e.top;return e.top>0&&!this.controller.isListVisible()&&(i-=e.height),{position:"absolute",left:r+"px",top:i+"px",width:e.width+"px",height:e.height+"px"}}makeDragCopyViewForModel(e){return this.makeViewForModel(e,!0)}makeViewForModel(e,r=!1){var i;if(e.type==="table")i=vt.createElement(aw,{controller:this.props.controller,model:()=>e,onDragPending:n=>this.onDragPending(n,{type:"expression",calcId:e.id}),isDragCopy:()=>r});else if(e.type==="folder")i=vt.createElement(lw,{controller:this.props.controller,model:()=>e,onDragPending:n=>this.onDragPending(n,{type:"expression",calcId:e.id}),isDragCopy:()=>r});else if(e.type==="text")i=vt.createElement(rw,{controller:this.props.controller,model:()=>e,onDragPending:n=>this.onDragPending(n,{type:"expression",calcId:e.id}),isDragCopy:()=>r});else if(e.type==="image")i=vt.createElement(hw,{controller:this.props.controller,model:()=>e,onDragPending:n=>this.onDragPending(n,{type:"expression",calcId:e.id}),isDragCopy:()=>r});else if(e.type==="expression")i=vt.createElement(_B,{key:()=>r&&this.controller.shouldRenderDraggedItemAsToken()},n=>n?vt.createElement(td,{showParentChildrenHover:this.const(!1),controller:this.props.controller,identifier:()=>this.controller.getDraggedIdentifier(),insideMQ:this.const(!1),insideGroup:this.const(!1),putInTabOrder:()=>!1}):vt.createElement(tw,{controller:this.props.controller,model:()=>e,onDragPending:o=>this.onDragPending(o,{type:"expression",calcId:e.id}),isDragCopy:()=>r}));else return;return i}didUnmount(){I(document.documentElement).off("."+this.guid)}didMountContainer(e){this.node=e,I(document.documentElement).on("keydown."+this.guid,this.bindFn(this.handleKeyDown))}didMountExppanel(e){this.exppanel=e,e.onscroll=()=>this.controller.markTickRequiredNextFrame()}getListBottomAndUpdateLastExpressionPadding(){let e=this.controller.getKeypadHeight(),r=this.__listBottom||0;return this.__listBottom=e,e===0&&r!==0&&PL()&&this.padLastExpressionUntilTapEnd(r),e}padLastExpression(e){I(this.node).find(".dcg-expressionitem.dcg-new-expression").css("margin-bottom",e+"px")}unpadLastExpression(){I(this.node).find(".dcg-expressionitem.dcg-new-expression").css("margin-bottom","0")}padLastExpressionUntilTapEnd(e){this.padLastExpression(e),I(document).on("dcg-tap.animating-bottom",()=>{this.unpadLastExpression(),I(document).off("dcg-tap.animating-bottom")})}handleKeyDown(e){var s;if(this.controller.inAudioTraceMode())return;let r=Te(e),i=ei(e),n=this.controller.getSelectedItem();if(!n){(r===Pa||r===Op)&&!this.controller.needsFakeKeypad()&&this.controller.hasMultipleItemsSelected()&&this.controller.dispatch({type:"delete-all-selected-items"});return}if(e.altKey&&!e.ctrlKey&&!e.metaKey&&e.shiftKey&&i==="M"&&n){if(!this.controller.isGeometry()||n.type!=="expression"||!n.formula.geometry)return;e.preventDefault(),e.stopPropagation(),this.controller.convertToTokenAssignment(n);let a=this.controller.getGeometryFolder();if(a){let c=a.index+this.controller.getNumberOfItemsInFolder(a.id);No(n,a.id),n.index!==c&&Uh(this.controller.getListModel(),n.index,c,1)}this.controller.ensureAtLeastOneVisibleItem();let l=(s=hs(n))==null?void 0:s.identifier;l&&this.controller.getShowConstructionsOpen()&&this.controller.dispatch({type:"set-focus-location",location:{type:"geo-token",identifier:l}});return}let o=this.controller.getFocusLocation();if(!(this.controller.getSelectedGeoExpression()&&(o!==void 0||r!==Op&&r!==Pa))){if(e.ctrlKey&&e.shiftKey&&!e.metaKey&&!e.altKey&&o!==void 0){if(i==="O"){e.preventDefault(),e.stopPropagation();let a;if(n.type==="expression")!n.sliderExists&&!yg(n)?(a={type:"expression",model:n,guid:n.guid,focusFirstOption:!0,previousFocusLocation:o},this.controller.dispatch({type:"set-focus-location",location:{type:"expression-icon",id:n.id}})):n.sliderExists&&(a={type:"slider",model:n,guid:"slider-"+n.guid,focusFirstOption:!0,previousFocusLocation:o},this.controller.dispatch({type:"set-focus-location",location:{type:"slider-animation-properties-icon",id:n.id}}));else if(n.type==="image")a={type:"image",model:n,guid:n.guid,focusFirstOption:!0,previousFocusLocation:o},this.controller.dispatch({type:"set-focus-location",location:{type:"image-icon",id:n.id}});else if(n.type==="table"&&o.type==="table"){let l=o.location;if(!l)return;let c=n.columnModels[l.column];if(!c||c.latex===""||!this.controller.getGraphSettings().config.graphpaper||c.error||c.index===0)return;a={type:"table-column",model:c,guid:c.guid,focusFirstOption:!0,previousFocusLocation:o},this.controller.dispatch({type:"set-focus-location",location:{type:"table-icon",id:n.id,columnId:c.id}})}if(!a)return;this.controller.dispatch({type:"toggle-item-settings-menu",menu:a});return}else if(i==="D"){if(this.controller.isItemReadonly(n.id)&&!this.controller.isInEditListMode())return;e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"delete-item-and-animate-out",id:n.id,setFocusAfterDelete:!0});return}}if(this.controller.isInEditListMode()&&!e.altKey&&!e.ctrlKey&&!e.metaKey){if(r===Oa&&o!==void 0){let a=this.controller.getItemModelByIndex(0);if(!a)return;let l=(o.type==="readonly-expression"&&a.type==="expression"||o.type==="table-container"&&a.type==="table"||o.type===a.type)&&o.id===a.id,c={type:"edit-list-toggle"},d=this.controller.isFocusLocationFocused(c);e.shiftKey&&l?(e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"set-focus-location",location:c})):!e.shiftKey&&d&&(e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"move-focus-to-item",id:a.id,where:a.type==="table"?"container":void 0}))}else if(r===Jn||r===Yn){let a=this.controller.getListModel(),l=r===Jn?zp(a,n.index):$p(a,n.index);if(!l)return;this.controller.dispatch({type:"move-focus-to-item",id:l.id,where:l.type==="table"?"container":"start"})}return}if(!(document.activeElement&&I.contains(document.body,document.activeElement))&&!I(e.target).closest(this.exppanel).length&&I.contains(document.documentElement,e.target))switch(r){case Jn:e.preventDefault(),this.controller.dispatch({type:"select-previous-expression"});break;case Yn:e.preventDefault(),this.controller.dispatch({type:"select-next-expression"});break;case jn:e.preventDefault(),this.controller.dispatch({type:"set-none-selected"});break;case Nc:e.preventDefault(),n&&(n.type==="expression"&&n.sliderExists?(this.controller.dispatch({type:"adjust-slider-by-keyboard",id:n.id,adjustment:"up"}),this.controller.dispatch({type:"set-focus-location",location:{type:"slider-thumb",id:n.id}})):this.controller.dispatch({type:"move-focus-to-item",id:n.id,where:"start"}));break;case Oa:e.preventDefault(),n&&this.controller.dispatch({type:"move-focus-to-item",id:n.id,where:"start"});break;case Rc:e.preventDefault(),n&&(n.type==="expression"&&n.sliderExists?(this.controller.dispatch({type:"adjust-slider-by-keyboard",id:n.id,adjustment:"down"}),this.controller.dispatch({type:"set-focus-location",location:{type:"slider-thumb",id:n.id}})):this.controller.dispatch({type:"move-focus-to-item",id:n.id,where:"end"}));break;case Pa:e.preventDefault(),n&&!this.controller.isItemReadonly(n.id)&&this.controller.dispatch({type:"upward-delete-selected-expression"});break;case Op:e.preventDefault(),n&&!this.controller.isItemReadonly(n.id)&&this.controller.dispatch({type:"downward-delete-selected-expression"});break;case ll:e.wasHandled("create-expression-with-keyboard")||(e.preventDefault(),e.handle("create-expression-with-keyboard"),n&&this.controller.dispatch({type:"on-special-key-pressed",key:"Enter"}));break;default:if(e.metaKey||e.ctrlKey||r===Rf||r===Nf)return;n&&(n.type==="table"||this.controller.dispatch({type:"move-focus-to-item",id:n.id,where:"end"}))}}}onDragPending(e,r){e.preventDefault(),ti();var i={x:e.touches[0].clientX,y:e.touches[0].clientY},n={x:i.x,y:i.y},o=setTimeout(()=>{I(document).off(".dragpending"),this.onDragStart(e,r,i,n)},500);I(document).on("dcg-tapmove.dragpending",s=>{n={x:s.touches[0].clientX,y:s.touches[0].clientY},(Math.abs(n.y-i.y)>3||Math.abs(n.x-i.x)>3)&&(clearTimeout(o),I(document).off(".dragpending"),this.onDragStart(e,r,i,n))}),I(document).on("dcg-tapend.dragpending",function(){clearTimeout(o),I(document).off(".dragpending")})}onDragStart(e,r,i,n){e.touches.length===1&&(e.wasHandled("dcg-longhold")||this.controller.dispatch({type:"start-dragdrop",dragTarget:r,grabPt:i,mousePt:n}))}onExppanelTapstart(e){e.device!=="mouse"&&I(e.target).closest(".dcg-expressionitem").length===0&&ti()}onPaste(e){let r=this.controller.getGraphSettings().config;var i=LB(e);if(!i)return;var n=this.controller.getSelectedItem();if(this.controller.canLoadPastedLink(i)&&n&&n.type==="folder"&&n.title===""){e.stopPropagation(),e.preventDefault(),hS(this.controller,i,(s,a)=>a(null,s));return}if(n&&(n.type==="text"||n.type==="folder"))return;if(this.controller.canLoadPastedLink(i)){e.stopPropagation(),e.preventDefault();let s=r.pasteGraphLinkCallback?r.pasteGraphLinkCallback:(a,l)=>l(null,a);hS(this.controller,i,s);return}if(r.pasteTableData){let s=DB(i);if(s!==void 0)return e.stopPropagation(),e.preventDefault(),this.controller.dispatch({type:"paste-table",data:s})}let o=CB(i);if(o!==void 0){e.stopPropagation(),e.preventDefault();let s=[];o.length===1&&o[0].numberList?this.controller.dispatch({type:"append-number-list",latex:o[0].content}):(o.forEach(a=>{s.push({type:"expression",id:this.controller.generateId(),latex:a.content})}),this.controller.dispatch({type:"insert-several-expressions",expressions:s}));return}}onDrop(e){if(!this.controller.areImagesEnabled())return;let r=e.dataTransfer&&e.dataTransfer.files;r&&this.controller.dispatch({type:"new-images",files:r})}};var Fi=__dcg_shared_module_exports__['i'](Z());Oe();var Mn=__dcg_shared_module_exports__['i'](Z());Oe();var FB=__dcg_shared_module_exports__['i'](Z());var hn=class extends FB.Class{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}getFocusedInput(){let e=this.controller.getFocusLocation(),r=this.model.type==="table-column"?this.model.table.id:this.id;if(!(!e||e.type!=="expression-menu"||e.id!==r))return e.location}handleFocusedChanged(e,r){let i=this.model.type==="table-column"?this.model.table.id:this.id;e?this.controller.dispatch({type:"set-focus-location",location:{type:"expression-menu",id:i,location:r}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"expression-menu",id:i,location:r}})}onColorSelected(e){this.model.type!=="image"&&(this.model.type==="expression"?this.controller.dispatch({type:"set-item-color",id:this.id,color:e}):this.controller.dispatch({type:"set-tablecolumn-color",color:e,tableId:this.model.table.id,columnId:this.id}))}onCustomColorSelected(e){this.model.type!=="image"&&(this.model.type==="expression"?this.controller.dispatch({type:"set-item-colorlatex",id:this.id,colorLatex:e}):this.controller.dispatch({type:"set-tablecolumn-colorlatex",tableId:this.model.table.id,columnId:this.model.id,colorLatex:e}))}getModelColor(){return this.model.type==="image"?"":Zl(this.model)}};var Br=__dcg_shared_module_exports__['i'](Z());var ih=__dcg_shared_module_exports__['i'](Z()),pn=class extends ih.Class{template(){return ih.createElement("div",{class:()=>({"dcg-toggle-view":!0,"dcg-toggled":this.props.toggled()}),"aria-label":()=>this.props.ariaLabel(),role:ih.const("checkbox"),tabindex:ih.const("0"),"aria-checked":()=>this.props.toggled(),toggled:()=>this.props.toggled(),onTap:this.bindFn(this.props.onChange)},ih.createElement("div",{class:ih.const("dcg-toggle-switch")}))}};var Ir=__dcg_shared_module_exports__['i'](Z());var{For:RB,If:ST}=Ir.Components,rs=class extends Ir.Class{init(){this.controller=this.props.controller()}template(){return Ir.createElement("div",{class:Ir.const("dcg-color-picker-container")},Ir.createElement(RB,{each:()=>this.getColorValues()},Ir.createElement("span",{class:Ir.const("dcg-color-picker-menu dcg-do-not-blur")},e=>Ir.createElement("span",{class:Ir.const("dcg-color-tile"),handleevent:Ir.const("true"),role:Ir.const("button"),tabindex:Ir.const("0"),"aria-label":()=>Rd(this.controller,e),"aria-pressed":()=>this.isSelected(e),onTap:()=>this.props.onColorSelected(e)},Ir.createElement("span",{class:()=>({"dcg-color-swatch":!0,"dcg-light-color":qh({type:"single-color",value:e},this.controller.invertSwatches())}),style:()=>({background:e})}),Ir.createElement(ST,{predicate:()=>this.isSelected(e)},()=>Ir.createElement("i",{class:Ir.const("dcg-icon-check"),"aria-hidden":Ir.const("true")}))))),Ir.createElement(ST,{predicate:()=>this.getUniqueCustomColors().length>0},()=>Ir.createElement(RB,{each:this.bindFn(this.getUniqueCustomColors),key:e=>typeof e=="string"?e:e.assignmentLatex},Ir.createElement("span",{class:Ir.const("dcg-color-picker-menu dcg-do-not-blur")},e=>typeof e=="string"?Ir.createElement("span",{class:Ir.const("dcg-color-picker-placeholder")}):Ir.createElement(Pe,{tooltip:()=>e.assignmentLatex,renderAsLatex:()=>({view:r=>Ir.createElement(et,{config:this.const({}),latex:()=>r})})},Ir.createElement("span",{class:Ir.const("dcg-color-tile"),handleevent:Ir.const("true"),role:Ir.const("button"),tabindex:Ir.const(0),"aria-label":()=>fs(e.assignmentLatex),"aria-pressed":()=>this.props.colorLatex()===e.assignmentLatex,onTap:()=>this.props.onCustomColorSelected(e.assignmentLatex)},Ir.createElement(np,{color:()=>this.getColorValue(e),invertSwatches:()=>this.controller.invertSwatches()}),Ir.createElement(ST,{predicate:()=>this.props.colorLatex()===e.assignmentLatex},()=>Ir.createElement("i",{class:()=>this.getCheckmarkClass(e),"aria-hidden":Ir.const("true")}))))))))}isSelected(e){var r=this.props.colorLatex();return r&&__dcg_shared_module_exports__['q'](this.getUniqueCustomColors(),"assignmentLatex").indexOf(r)>=0?!1:this.props.selectedColor()===e}getColorValues(){return __dcg_shared_module_exports__['D'](this.controller.getColors())}getUniqueCustomColors(){if(this.props.hideCustomColors&&this.props.hideCustomColors())return[];let e=this.controller.getAllColorAssignments(),r=__dcg_shared_module_exports__['v'](e,function(n){return n.assignmentLatex}),i=__dcg_shared_module_exports__['m'](e,n=>r[n.assignmentLatex]===1);for(let n=0;n<i.length%6;n++)i.push("placholder-"+n);return i}getColorValue(e){let r=this.controller.getColorById(e.id);return Array.isArray(r)?{type:"color-array",value:r}:{type:"single-color",value:r}}getCheckmarkClass(e){return qh(this.getColorValue(e),!1)?`dcg-icon-check ${OC(this.getColorValue(e),!1)?"dcg-light-color":"dcg-mixed-color"}`:"dcg-icon-check"}};var{If:ET}=Br.Components,Dm=class extends hn{template(){return Br.createElement("div",{class:Br.const("dcg-options-menu-section")},Br.createElement("div",{class:Br.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-heading-lines"),Br.createElement(pn,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-lines-visible"),toggled:this.props.isOpen,onChange:this.bindFn(this.toggleLinesVisible)})),Br.createElement(ET,{predicate:()=>this.props.isOpen()},()=>Br.createElement("div",{class:Br.const("dcg-options-menu-content")},Br.createElement("div",{class:Br.const("dcg-options-flex-container")},Br.createElement("div",{class:Br.const("dcg-options-left-side")},Br.createElement("div",{class:Br.const("dcg-iconed-mathquill-row dcg-line-opacity-row")},Br.createElement(Pe,{tooltip:()=>this.controller.s("graphing-calculator-label-opacity-tooltip"),sticky:this.const(!0),gravity:this.const("se")},Br.createElement("i",{class:Br.const("dcg-icon-opacity"),"aria-hidden":Br.const("true")})),Br.createElement(lr,{latex:()=>this.model.lineOpacity,placeholder:this.bindFn(this.getLineOpacity),isFocused:()=>this.getFocusedInput()==="lineopacity",ariaPostLabel:()=>this.isLineOpacityValid()?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-line-opacity"),hasError:()=>!this.isLineOpacityValid(),handleLatexChanged:this.bindFn(this.dispatchLineOpacityLatexIfChanged),dataLabelAttributeValue:this.const("line-opacity"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>this.handleFocusedChanged(e,"lineopacity")})),Br.createElement("div",{class:Br.const("dcg-iconed-mathquill-row dcg-line-thickness-row")},Br.createElement(Pe,{tooltip:()=>this.controller.s("graphing-calculator-label-line-thickness-tooltip"),sticky:this.const(!0),gravity:this.const("se")},Br.createElement("i",{class:Br.const("dcg-icon-line-thickness"),"aria-hidden":Br.const("true")})),Br.createElement(lr,{latex:()=>this.model.lineWidth,placeholder:this.bindFn(this.getLineWidth),isFocused:()=>this.getFocusedInput()==="linewidth",ariaPostLabel:()=>this.isLineWidthValid()?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-label-line-thickness-tooltip"),hasError:()=>!this.isLineWidthValid(),handleLatexChanged:this.bindFn(this.dispatchLineWidthLatexIfChanged),dataLabelAttributeValue:this.const("line-width"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>this.handleFocusedChanged(e,"linewidth")}))),Br.createElement("div",{class:Br.const("dcg-options-right-side")},Br.createElement(ET,{predicate:this.bindFn(this.shouldShowLineStyles)},()=>Br.createElement(jr,{staticConfig:this.bindFn(this.getPointStyleOptions),ariaGroupLabel:()=>this.controller.s("graphing-calculator-heading-style"),theme:this.const("mini")})))),Br.createElement(ET,{predicate:this.props.isFirstOpenSection},()=>Br.createElement(rs,{controller:this.props.controller,colorLatex:()=>this.model.colorLatex,selectedColor:this.bindFn(this.getModelColor),onColorSelected:this.bindFn(this.onColorSelected),onCustomColorSelected:this.bindFn(this.onCustomColorSelected)})))))}getLineWidth(){return this.isGeometryPolygon()?""+2:""+2.5}getLineOpacity(){return this.isGeometryPolygon()?""+.6:""+.9}isGeometryPolygon(){return this.controller.isGeometry()&&this.model.type==="expression"&&qc(this.model)}getPointStyleOptions(){return["SOLID","DASHED","DOTTED"].map(r=>({key:r,icon:()=>this.getStyleIcon(r),ariaLabel:()=>this.getStyleAria(r),selected:()=>this.model.lineStyle===r,class:()=>"dcg-line-segmented-option",onSelect:()=>{this.onLineStyleSelected(r)}}))}getStyleIcon(e){switch(e){case"SOLID":return"dcg-icon-line-solid";case"DASHED":return"dcg-icon-line-dashed";case"DOTTED":return"dcg-icon-line-dotted"}}getStyleAria(e){let r=this.controller.s;switch(e){case"SOLID":return r("graphing-calculator-narration-line-style-solid");case"DASHED":return r("graphing-calculator-narration-line-style-dashed");case"DOTTED":return r("graphing-calculator-narration-line-style-dotted")}}isLineOpacityValid(){return this.model.type==="expression"?GO(this.model):this.model.type==="table-column"?bF(this.model):!1}isLineWidthValid(){return this.model.type==="expression"?eC(this.model):this.model.type==="table-column"?wF(this.model):!1}dispatchLineOpacityLatexIfChanged(e){this.model.lineOpacity!==e&&(this.model.type==="expression"?this.controller.dispatch({type:"set-item-lineopacity",id:this.id,lineOpacity:e}):this.controller.dispatch({type:"set-tablecolumn-lineopacity",tableId:this.model.table.id,columnId:this.model.id,lineOpacity:e}))}shouldShowLineStyles(){return!(this.model.type==="expression"&&Hc(this.model))}onLineStyleSelected(e){this.model.lineStyle!==e&&(this.model.type==="expression"?this.controller.dispatch({type:"set-item-linestyle",id:this.id,lineStyle:e}):this.controller.dispatch({type:"set-tablecolumn-linestyle",tableId:this.model.table.id,columnId:this.model.id,lineStyle:e}))}dispatchLineWidthLatexIfChanged(e){this.model.lineWidth!==e&&(this.model.type==="expression"?this.controller.dispatch({type:"set-item-linewidth",id:this.id,lineWidth:e}):this.controller.dispatch({type:"set-tablecolumn-linewidth",tableId:this.model.table.id,columnId:this.model.id,lineWidth:e}))}toggleLinesVisible(){this.model.type==="expression"?this.controller.dispatch({type:"set-item-lines",id:this.id,lines:!this.props.isOpen()}):this.controller.dispatch({type:"set-tablecolumn-lines",tableId:this.model.table.id,columnId:this.model.id,bool:!this.props.isOpen()})}};var lo=__dcg_shared_module_exports__['i'](Z());var{If:DW,For:SW}=lo.Components,fS=class extends hn{template(){return lo.createElement("div",{class:lo.const("dcg-options-menu-section dcg-options-menu-section-arrows")},lo.createElement("div",{class:lo.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-heading-arrows"),lo.createElement(pn,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-menu-arrows-enabled"),toggled:this.props.isOpen,onChange:this.bindFn(this.toggleArrowsEnabled)})),lo.createElement(DW,{predicate:this.props.isOpen},()=>lo.createElement("div",{class:lo.const("dcg-options-menu-content")},lo.createElement(SW,{each:()=>this.getArrowModeOptions()},lo.createElement("div",{class:lo.const("dcg-style-icons"),role:lo.const("radiogroup")},e=>lo.createElement("div",{class:lo.const("dcg-style-icon-container"),onTap:()=>this.setArrowMode(e),role:lo.const("radio"),tabindex:lo.const(0),"aria-label":()=>this.getAriaLabel(e),"aria-checked":()=>this.getArrowMode()===e},lo.createElement(cn,{backgroundColor:()=>({type:"single-color",value:"#000"}),semiTransparent:()=>this.getArrowMode()!==e,iconType:()=>this.getArrowIconType(e)})))))))}getArrowModeOptions(){return by(this.model)?["POSITIVE","BOTH"]:[]}getArrowIconType(e){switch(e){case"POSITIVE":return"arrow-right";case"BOTH":return"movable-horizontal"}}getAriaLabel(e){switch(e){case"POSITIVE":return this.controller.s("graphing-calculator-narration-arrow-mode-one");case"BOTH":return this.controller.s("graphing-calculator-narration-arrow-mode-both")}}setArrowMode(e){this.controller.dispatch({type:"set-item-arrow-mode",id:this.id,value:e})}getArrowMode(){return Kv(this.model)}toggleArrowsEnabled(){this.model.type==="expression"&&this.setArrowMode(this.props.isOpen()?"NONE":"POSITIVE")}};var Cw=__dcg_shared_module_exports__['i'](Z());var yS=class extends hn{template(){return Cw.createElement("div",{class:Cw.const("dcg-options-menu-section")},Cw.createElement(rs,{controller:this.props.controller,colorLatex:()=>this.model.colorLatex,selectedColor:this.bindFn(this.getModelColor),onColorSelected:this.bindFn(this.onColorSelected),onCustomColorSelected:this.bindFn(this.onCustomColorSelected),hideCustomColors:()=>this.model.type==="expression"&&$v(this.model)}))}};var Zn=__dcg_shared_module_exports__['i'](Z());var{If:kT}=Zn.Components,bS=class extends hn{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return Zn.createElement("div",{class:Zn.const("dcg-options-menu-section")},Zn.createElement("div",{class:Zn.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-heading-fill"),Zn.createElement(kT,{predicate:()=>!this.isInequality()},()=>Zn.createElement(pn,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-fill-visible"),toggled:this.props.isOpen,onChange:this.bindFn(this.toggleFillVisible)}))),Zn.createElement(kT,{predicate:this.props.isOpen},()=>Zn.createElement("div",{class:Zn.const("dcg-options-menu-content")},Zn.createElement("div",{class:Zn.const("dcg-iconed-mathquill-row dcg-fill-opacity-row")},Zn.createElement(Pe,{tooltip:()=>this.controller.s("graphing-calculator-label-opacity-tooltip"),sticky:this.const(!0),gravity:this.const("se")},Zn.createElement("i",{class:Zn.const("dcg-icon-opacity"),"aria-hidden":Zn.const("true")})),Zn.createElement(lr,{latex:()=>this.model.fillOpacity,placeholder:this.bindFn(this.getFillOpacity),isFocused:()=>this.getFocusedInput()==="opacity",ariaPostLabel:()=>oI(this.model)?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-fill-opacity"),hasError:()=>!oI(this.model),handleLatexChanged:this.bindFn(this.dispatchOpacityLatexIfChanged),dataLabelAttributeValue:this.const("fill-opacity"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>this.handleFocusedChanged(e,"opacity")})),Zn.createElement(kT,{predicate:this.props.isFirstOpenSection},()=>Zn.createElement(rs,{controller:this.props.controller,colorLatex:()=>this.model.colorLatex,selectedColor:this.bindFn(this.getModelColor),onColorSelected:this.bindFn(this.onColorSelected),onCustomColorSelected:this.bindFn(this.onCustomColorSelected)})))))}getFillOpacity(){return this.controller.isGeometry()&&qc(this.model)?""+.2:""+.4}isInequality(){return Hc(this.model)}toggleFillVisible(){this.controller.dispatch({type:"set-item-fill",id:this.id,fill:!this.props.isOpen()})}dispatchOpacityLatexIfChanged(e){this.model.fillOpacity!==e&&this.controller.dispatch({type:"set-item-fillopacity",id:this.id,fillOpacity:e})}};var Kr=__dcg_shared_module_exports__['i'](Z());var Wt=__dcg_shared_module_exports__['i'](Z());var{If:NB,Switch:BB}=Wt.Components,wS=class extends Wt.Class{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return Wt.createElement("div",{class:Wt.const("dcg-clickable-image-info-view"),role:Wt.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-narration-clickable-image-options")},Wt.createElement("div",{class:Wt.const("dcg-clickable-image-state-container")},Wt.createElement(Pe,{tooltip:()=>this.tooltip("hovered"),gravity:this.const("s")},Wt.createElement(eh,{controller:()=>this.controller,ariaLabel:()=>this.tooltip("hovered"),onFileChange:e=>this.updateImage("hovered",e),readonly:()=>this.controller.isItemReadonly(this.id)},Wt.createElement(BB,{key:this.bindFn(this.hoveredStatus)},()=>Wt.createElement("div",{class:Wt.const("dcg-clickable-image-state"),style:()=>this.getStyleForState("hovered")})))),Wt.createElement(NB,{predicate:()=>!!this.model.clickableInfo.hoveredImage},()=>Wt.createElement("div",{class:Wt.const("dcg-clickable-image-state-close"),onTap:()=>this.removeImageState("hovered"),ariaLabel:()=>this.controller.s("graphing-calculator-label-remove-hovered-image"),role:Wt.const("button"),tabIndex:Wt.const(0)},Wt.createElement("i",{class:Wt.const("dcg-icon-remove"),"aria-hidden":Wt.const("true")}))),Wt.createElement("div",{role:Wt.const("heading"),"aria-level":Wt.const("2"),class:Wt.const("dcg-clickable-image-label")},()=>this.controller.s("graphing-calculator-label-hovered"))),Wt.createElement("div",{class:Wt.const("dcg-clickable-image-state-container")},Wt.createElement(Pe,{tooltip:()=>this.tooltip("depressed"),gravity:this.const("s")},Wt.createElement(eh,{controller:()=>this.controller,ariaLabel:()=>this.tooltip("depressed"),onFileChange:e=>this.updateImage("depressed",e),readonly:()=>this.controller.isItemReadonly(this.id)},Wt.createElement(BB,{key:this.bindFn(this.depressedStatus)},()=>Wt.createElement("div",{class:Wt.const("dcg-clickable-image-state"),style:()=>this.getStyleForState("depressed")})))),Wt.createElement(NB,{predicate:()=>!!this.model.clickableInfo.depressedImage},()=>Wt.createElement("div",{class:Wt.const("dcg-clickable-image-state-close"),onTap:()=>this.removeImageState("depressed"),ariaLabel:()=>this.controller.s("graphing-calculator-label-remove-depressed-image"),role:Wt.const("button"),tabIndex:Wt.const(0)},Wt.createElement("i",{class:Wt.const("dcg-icon-remove"),"aria-hidden":Wt.const("true")}))),Wt.createElement("div",{role:Wt.const("heading"),"aria-level":Wt.const("2"),class:Wt.const("dcg-clickable-image-label")},()=>this.controller.s("graphing-calculator-label-depressed"))))}hoveredStatus(){return this.hoveredUploading?"loading":"background"}depressedStatus(){return this.depressedUploading?"loading":"background"}tooltip(e){return(e==="hovered"?this.model.clickableInfo.hoveredImage:this.model.clickableInfo.depressedImage)?e==="depressed"?this.controller.s("graphing-calculator-label-change-depressed-image-tooltip"):this.controller.s("graphing-calculator-label-change-hovered-image-tooltip"):e==="depressed"?this.controller.s("graphing-calculator-label-add-depressed-image-tooltip"):this.controller.s("graphing-calculator-label-add-hovered-image-tooltip")}getImageURLForState(e){let r;if(e==="hovered"){if(this.hoveredStatus()!=="background")return"";r="hoveredImage"}else{if(this.depressedStatus()!=="background")return"";r="depressedImage"}let i=this.model.clickableInfo[r];return i?`url(${i})`:`url(${this.model.image_url})`}getStyleForState(e){let r={"background-image":this.getImageURLForState(e),opacity:1};return e==="hovered"&&!this.model.clickableInfo.hoveredImage&&(r.opacity=.5),r}removeImageState(e){e==="hovered"?this.controller.dispatch({type:"set-hovered-image",id:this.model.id,url:""}):this.controller.dispatch({type:"set-depressed-image",id:this.model.id,url:""})}updateImage(e,r){if(!r||!r[0])return;let i=r[0];e==="hovered"&&(this.hoveredUploading=!0),e==="depressed"&&(this.depressedUploading=!0),this.controller.getGraphSettings().config.imageUploadCallback(i,(n,o)=>{e==="hovered"&&(this.hoveredUploading=!1),e==="depressed"&&(this.depressedUploading=!1),!n&&o&&(e==="hovered"?this.controller.dispatch({type:"set-hovered-image",id:this.model.id,url:o}):this.controller.dispatch({type:"set-depressed-image",id:this.model.id,url:o}))})}};var El=__dcg_shared_module_exports__['i'](Z()),xS=__dcg_shared_module_exports__['i'](XB());var VT=/\{\$([a-zA-Z0-9\-]+([a-zA-Z0-9\-]+_)*[a-zA-Z0-9\-]+)\}/;function QB(t,e){let r=0,i=0,n={},o={},s=a(t);if(!/^<0>/.test(s)||!/<\/0>$/.test(s))throw new Error("Expected template string to start and end with <0> and </0>, but found "+JSON.stringify(s));return s.slice(3,-4).trim();function a(c){if(e.isConst(c))return AW(e.getConstValue(c));if(e.isNamedBinding(c)){let d=l(n,e.getBindingName(c)),u=`{$${d}}`;if(!VT.test(u))throw new Error(`Invalid <Localize> variable: ${u}.`);return e.addBinding&&e.addBinding(d,c),n[d]=!0,u}else if(c!==t&&e.isView(c)){let d=l(o,e.getViewName(c));if(!/[a-zA-Z0-9\-_]/.test(d))throw new Error(`Invalid <Localize> subview identifier: ${d}.`);return e.addView&&e.addView(d,c),o[d]=!0,`<${d}/>`}else if(e.isBinding(c)){let d=l(n,`v${r++}`),u=`{$${d}}`;return e.addBinding&&e.addBinding(d,c),n[d]=!0,u}else{let d=`${i++}`;e.addElement&&e.addElement(d,c);let u=[];return e.forEachChild(c,p=>{u.push(a(p))}),o[d]=!0,u.length>0?`<${d}>${u.join("")}</${d}>`:`<${d}/>`}}function l(c,d){let u=0,p=d;for(;c[p];)p=`${d}-${++u}`;return p}}var TW=!0;function AW(t){return TW?t:t.replace(/\{|\}/g,e=>`{"${e}"}`).replace(/(^|[\s\n]+)(\[|\]|\.)/g,(e,r,i)=>`${r}{"${i}"}`)}function LW(t){return t.__DCGViewLocalizeBindingName}function PW(t){return typeof t=="function"&&t.__DCGViewLocalizeViewName}var un=class extends El.Class{init(){this.viewMap={},this.elementMap={},this.bindingMap={},this.i18n=this.props.i18n(),this.templateString=this.serializeToTemplateString(El.createElement("div",null,this.children))}template(){return El.createElement(El.Components.If,{predicate:()=>this.shouldShow()},()=>El.createElement(El.Components.Switch,{key:()=>IT(this.translatedString())},e=>this.renderDeserializedTemplateNode(this.parseAndValidate(e))))}shouldShow(){let e=this.props.options&&this.props.options();return e&&e.hideUntranslatedView&&this.i18n.hasTranslation?this.i18n.hasTranslation(this.props.key()):!0}translatedString(){let e={};for(let r in this.bindingMap)e[r]=ca(`{$${r}}`);return this.i18n.s(this.props.key(),e)}static variable(e,r){let i=()=>r();return i.__DCGViewLocalizeBindingName=e,i}static subview(e,r){let i=()=>r();return i.__DCGViewLocalizeViewName=e,i}parseAndValidate(e){let r=(0,xS.parse)(e),i={},n={};o(r);for(let s in this.elementMap)if(!n[s])return(0,xS.parse)(IT(this.templateString));for(let s in this.bindingMap)if(!i[s])return(0,xS.parse)(IT(this.templateString));return r;function o(s){if(Array.isArray(s)){for(let a of s)o(a);return}s.name==="token"?i[s.attrs.id]=!0:s.type!=="text"&&(n[s.name]=!0,o(s.children))}}renderDeserializedTemplateNode(e){if(Array.isArray(e))return e.map(r=>this.renderDeserializedTemplateNode(r));if(e.type==="text")return El.const(e.content||"");if(e.name==="token"){let r=this.bindingMap[e.attrs.id];return r||(()=>"")}else if(this.elementMap[e.name]){let r=this.elementMap[e.name],i=e.children.map(n=>this.renderDeserializedTemplateNode(n));return e3(r.type,r.attrs,i)}else return this.viewMap[e.name]?this.viewMap[e.name]():e3("span",{},[])}serializeToTemplateString(e){return QB(e,{isView:PW,isConst:ZB,isBinding:r=>typeof r=="function",isNamedBinding:LW,getConstValue:r=>r(),getBindingName:r=>r.__DCGViewLocalizeBindingName,getViewName:r=>r.__DCGViewLocalizeViewName,addBinding:(r,i)=>{this.bindingMap[r]=i},addElement:(r,i)=>{this.elementMap[r]={type:i.tagName,attrs:i.attrs}},addView:(r,i)=>{if(this.viewMap[r])throw new Error(`Unexpected duplicate view ${r}.`);this.viewMap[r]=i},forEachChild:(r,i)=>{for(let n of r.children){if(!ZB(n)&&typeof n!="function"&&n._isDCGView)throw new Error("Bare DCGViews are not allowed inside <Localize>. Use Localize.subview().");i(n)}}})}};function ZB(t){return typeof t=="function"&&t.isDCGViewConst}function e3(t,e,r){return El.createElement(t,e,r)}function IT(t){return`<0>${t}</0>`.replace(new RegExp(VT.source,"g"),(r,i)=>`<token id="${i}"/>`)}var{If:vS,IfDefined:OW,Textarea:_W}=Kr.Components,Sm=class extends hn{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return Kr.createElement("div",{class:Kr.const("dcg-options-menu-section dcg-clickable-section")},Kr.createElement("div",{class:Kr.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-heading-clickable"),Kr.createElement(pn,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-make-clickable"),toggled:this.props.isOpen,onChange:this.bindFn(this.toggleClickable)})),Kr.createElement(vS,{predicate:this.props.isOpen},()=>Kr.createElement("div",{class:Kr.const("dcg-options-menu-content")},Kr.createElement("div",{class:Kr.const("dcg-clickable-menu-row")},Kr.createElement("span",{class:Kr.const("dcg-input-label")},()=>this.controller.s("graphing-calculator-label-update-on-click")),Kr.createElement(Xe,{latex:()=>this.model.clickableInfo.latex,placeholder:this.const(""),isFocused:()=>this.getFocusedInput()==="updaterule",capExpressionSize:()=>!!this.controller.getGraphSettings().config.capExpressionSize,selectOnFocus:this.const(!0),config:this.bindFn(this.getMQConfig),getAriaLabel:()=>this.controller.s("graphing-calculator-narration-click-action"),getAriaPostLabel:this.const(""),hasError:()=>this.hasError(),onUserChangedLatex:e=>this.dispatchUpdateRuleLatexIfChanged(e),onExpressionSizeExceeded:()=>this.controller.dispatch({type:"expression-size-exceeded"}),onFocusedChanged:e=>this.handleFocusedChanged(e,"updaterule"),dataLabelAttributeValue:this.const("click-handler"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled()}),OW(()=>this.packedError(),e=>Kr.createElement("span",{class:Kr.const("dcg-clickable-info-error-container")},Kr.createElement(ys,{error:()=>this.controller.unpack(e()),gravity:this.const("s"),size:this.const("small")})))),Kr.createElement(vS,{predicate:this.bindFn(this.isList)},()=>Kr.createElement("div",{class:Kr.const("dcg-clickable-list-index-notice")},Kr.createElement(un,{i18n:this.const(this.controller),key:this.const("graphing-calculator-label-list-index")},Kr.const("Use"),Kr.const(" "),Kr.createElement("span",{class:()=>({"dcg-index-variable-marker":!0,"dcg-btn":!0,"dcg-btn-light-gray":!0,"dcg-mathquill-has-focus":this.getFocusedInput()==="updaterule","dcg-do-not-blur":!0}),onTap:this.bindFn(this.insertIndex)},Kr.const("index")),Kr.const(" "),Kr.const("to reference the clicked index in the list.")))),Kr.createElement(vS,{predicate:()=>this.model.type!=="image"},()=>Kr.createElement(_W,{placeholder:()=>this.controller.s("graphing-calculator-text-add-screen-reader-label-placeholder"),value:()=>this.model.description,onInput:e=>this.controller.dispatch({type:"set-item-description",id:this.model.id,description:e})})),Kr.createElement(vS,{predicate:()=>this.model.type==="image"},()=>Kr.createElement("div",{class:Kr.const("dcg-clickable-menu-row")},Kr.createElement(wS,{controller:()=>this.controller,model:()=>this.model}))))))}insertIndex(){this.controller.dispatch({type:"keypad/type-text",text:"index"})}isList(){return this.model.formula?!!this.model.formula.is_concrete_list:!1}hasError(){return this.packedError()!==void 0}packedError(){if(this.model.formula.click_handler&&this.model.formula.click_handler.status==="error")return this.model.formula.click_handler.error}toggleClickable(){this.controller.dispatch({type:"set-clickableinfo-prop",id:this.model.id,prop:"enabled",value:!this.model.clickableInfo.enabled}),this.model.clickableInfo.enabled&&this.handleFocusedChanged(!0,"updaterule")}dispatchUpdateRuleLatexIfChanged(e){this.model.clickableInfo.latex!==e&&this.controller.dispatch({type:"set-clickableinfo-rule-latex",id:this.id,latex:e})}getMQConfig(){return this.controller.getMathquillConfig({additionalOperators:["index"]})}};var bi=__dcg_shared_module_exports__['i'](Z());var nh=__dcg_shared_module_exports__['i'](Z());var Em=class extends hn{template(){return nh.createElement("div",{class:nh.const("dcg-iconed-mathquill-row dcg-point-opacity-row")},nh.createElement(Pe,{tooltip:()=>this.controller.s("graphing-calculator-label-opacity-tooltip"),sticky:this.const(!0),gravity:this.const("se")},nh.createElement("i",{class:nh.const("dcg-icon-opacity"),"aria-hidden":nh.const("true")})),nh.createElement(lr,{latex:()=>this.model.pointOpacity,placeholder:this.bindFn(this.getPointOpacityPlaceholder),isFocused:()=>this.getFocusedInput()==="pointopacity",ariaPostLabel:()=>this.isPointOpacityValid()?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-line-opacity"),hasError:()=>!this.isPointOpacityValid(),handleLatexChanged:this.bindFn(this.dispatchPointOpacityLatexIfChanged),dataLabelAttributeValue:this.const("point-opacity"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>this.handleFocusedChanged(e,"pointopacity")}))}isPointOpacityValid(){return this.model.type==="expression"?VO(this.model):this.model.type==="table-column"?vF(this.model):!1}dispatchPointOpacityLatexIfChanged(e){this.model.pointOpacity!==e&&(this.model.type==="expression"?this.controller.dispatch({type:"set-item-pointopacity",id:this.id,pointOpacity:e}):this.controller.dispatch({type:"set-tablecolumn-pointopacity",columnId:this.model.id,tableId:this.model.table.id,pointOpacity:e}))}getPointOpacityPlaceholder(){return this.getDragMode()==="NONE"?`${.9}`:"1"}getDragMode(){return this.model.type==="expression"?this.model.reconciledDragMode||this.model.dragMode:this.model.dragMode}};var{If:CS}=bi.Components,km=class extends hn{template(){return bi.createElement("div",{class:bi.const("dcg-options-menu-section")},bi.createElement("div",{class:bi.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-heading-points"),bi.createElement(pn,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-points-visible"),toggled:this.props.isOpen,onChange:this.bindFn(this.togglePointsVisible)})),bi.createElement(CS,{predicate:this.props.isOpen},()=>bi.createElement("div",{class:bi.const("dcg-options-menu-content")},bi.createElement("div",{class:bi.const("dcg-options-flex-container")},bi.createElement("div",{class:bi.const("dcg-options-left-side")},bi.createElement(Em,__dcg_shared_module_exports__['b']({},this.props)),bi.createElement(CS,{predicate:()=>!this.isDraggable()},()=>bi.createElement("div",{class:bi.const("dcg-iconed-mathquill-row")},bi.createElement(Pe,{tooltip:()=>this.controller.s("graphing-calculator-label-point-size-tooltip"),gravity:this.const("se"),sticky:this.const(!0)},bi.createElement("i",{class:bi.const("dcg-icon-line-thickness"),"aria-hidden":bi.const("true")})),bi.createElement(lr,{latex:()=>this.model.pointSize,placeholder:this.bindFn(this.getDefaultPointSize),isFocused:()=>this.getFocusedInput()==="pointsize",ariaPostLabel:()=>this.isPointSizeValid()?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-point-size"),hasError:()=>!this.isPointSizeValid(),handleLatexChanged:e=>this.dispatchPointSizeLatexIfChanged(e),dataLabelAttributeValue:this.const("point-size"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>this.handleFocusedChanged(e,"pointsize")})))),bi.createElement("div",{class:bi.const("dcg-options-right-side")},bi.createElement(CS,{predicate:()=>!this.isDraggable()},()=>bi.createElement(jr,{staticConfig:this.bindFn(this.getPointStyleOptions),ariaGroupLabel:()=>this.controller.s("graphing-calculator-heading-style"),theme:this.const("mini")})))),bi.createElement(CS,{predicate:this.props.isFirstOpenSection},()=>bi.createElement(rs,{controller:this.props.controller,colorLatex:()=>this.model.colorLatex,selectedColor:this.bindFn(this.getModelColor),onColorSelected:this.bindFn(this.onColorSelected),onCustomColorSelected:this.bindFn(this.onCustomColorSelected)})))))}getPointStyleOptions(){return["POINT","OPEN","CROSS"].map(r=>({key:r,icon:()=>this.getStyleIcon(r),ariaLabel:()=>this.getStyleAria(r),selected:()=>this.model.pointStyle===r,class:()=>"dcg-point-segmented-option",onSelect:()=>{this.onPointStyleSelected(r)}}))}getStyleIcon(e){switch(e){case"POINT":return"dcg-icon-point";case"OPEN":return"dcg-icon-open";case"CROSS":return"dcg-icon-cross"}}getStyleAria(e){let r=this.controller.s;switch(e){case"POINT":return r("graphing-calculator-narration-point-style-point");case"OPEN":return r("graphing-calculator-narration-point-style-open");case"CROSS":return r("graphing-calculator-narration-point-style-cross")}}isPointSizeValid(){return this.model.type==="expression"?Zv(this.model):this.model.type==="table-column"?xF(this.model):!1}onPointStyleSelected(e){this.model.pointStyle!==e&&(this.model.type==="expression"?this.controller.dispatch({type:"set-item-pointstyle",id:this.id,pointStyle:e}):this.controller.dispatch({type:"set-tablecolumn-pointstyle",columnId:this.model.id,tableId:this.model.table.id,pointStyle:e}))}dispatchPointSizeLatexIfChanged(e){this.model.pointSize!==e&&(this.model.type==="expression"?this.controller.dispatch({type:"set-item-pointsize",id:this.id,pointSize:e}):this.controller.dispatch({type:"set-tablecolumn-pointsize",columnId:this.model.id,tableId:this.model.table.id,pointSize:e}))}isDraggable(){return this.getDragMode()!=="NONE"}togglePointsVisible(){this.model.type==="expression"&&Ks(this.model)?this.controller.dispatch({type:"toggle-item-hidden",id:this.model.id}):this.model.type==="expression"?this.controller.dispatch({type:"set-item-points",id:this.id,points:!this.props.isOpen()}):this.controller.dispatch({type:"set-tablecolumn-points",columnId:this.model.id,tableId:this.model.table.id,bool:!this.props.isOpen()})}getDragMode(){return this.model.type==="expression"?this.model.reconciledDragMode||this.model.dragMode:this.model.dragMode}getDefaultPointSize(){return this.model.type==="expression"&&Od(this.model)?`${14}`:`${9}`}};var Zt=__dcg_shared_module_exports__['i'](Z());var is=__dcg_shared_module_exports__['i'](Z());var{For:RW}=is.Components,NW=[{orientation:"default",cssClass:"dcg-label-orientation-center",description:"graphing-calculator-text-label-orientation-default"},{orientation:"above",cssClass:"dcg-label-orientation-above",description:"graphing-calculator-text-label-orientation-above"},{orientation:"above_right",cssClass:"dcg-label-orientation-above-right",description:"graphing-calculator-text-label-orientation-above-right"},{orientation:"right",cssClass:"dcg-label-orientation-right",description:"graphing-calculator-text-label-orientation-right"},{orientation:"below_right",cssClass:"dcg-label-orientation-below-right",description:"graphing-calculator-text-label-orientation-below-right"},{orientation:"below",cssClass:"dcg-label-orientation-below",description:"graphing-calculator-text-label-orientation-below"},{orientation:"below_left",cssClass:"dcg-label-orientation-below-left",description:"graphing-calculator-text-label-orientation-below-left"},{orientation:"left",cssClass:"dcg-label-orientation-left",description:"graphing-calculator-text-label-orientation-left"},{orientation:"above_left",cssClass:"dcg-label-orientation-above-left",description:"graphing-calculator-text-label-orientation-above-left"}],DS=class extends is.Class{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return is.createElement("div",{class:is.const("dcg-label-orientation-view"),style:()=>`transform: rotate(${this.getCSSRotationValue()});`},is.createElement("span",{class:is.const("dcg-vertical-orientation-indicator")}),is.createElement(RW,{each:()=>NW,key:e=>e.orientation},is.createElement("div",{class:is.const("dcg-label-orientations"),role:is.const("radiogroup"),"aria-label":()=>this.controller.s("graphing-calculator-heading-label-orientation")},e=>is.createElement("div",{class:()=>({[e.cssClass]:!0,"dcg-orientation-option":!0,"dcg-selected":this.isSelected(e.orientation),"dcg-orientation-disabled":this.isDisabled(e.orientation)}),role:is.const("radio"),tabindex:is.const("0"),"aria-label":()=>this.controller.s(e.description),"aria-checked":()=>this.getOrientation()===e.orientation,onTap:()=>this.onTapOrientation(e.orientation)},is.createElement("i",{class:()=>({"dcg-icon-chevron-left":e.orientation!=="default"})})))))}isDisabled(e){return e!=="default"?!1:this.isPointVisible()?!0:this.model.labelOrientation==="default"}isSelected(e){return e==="default"&&e===this.model.labelOrientation?!this.isPointVisible():e===this.model.labelOrientation}isPointVisible(){return this.model.hidden?!1:Ks(this.model)?!this.model.hidden:this.model.points}getCSSRotationValue(){let e=AO(this.model);return`${Array.isArray(e)?0:e}rad`}getOrientation(){return this.props.model().labelOrientation}onTapOrientation(e){e===this.getOrientation()&&(e="default"),this.controller.dispatch({type:"set-item-label-orientation",id:this.id,labelOrientation:e})}};var{If:Gm}=Zt.Components,SS=class extends hn{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return Zt.createElement("div",{class:Zt.const("dcg-options-menu-section")},Zt.createElement("div",{class:Zt.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-heading-label"),Zt.createElement(pn,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-label-visible"),toggled:this.props.isOpen,onChange:this.bindFn(this.toggleLabelVisible)})),Zt.createElement(Gm,{predicate:this.props.isOpen},()=>Zt.createElement("div",{class:Zt.const("dcg-options-menu-content")},Zt.createElement("div",{class:Zt.const("dcg-options-flex-container")},Zt.createElement("div",{class:Zt.const("dcg-options-left-side")},Zt.createElement(Gm,{predicate:this.props.isFirstOpenSection},()=>Zt.createElement(Em,__dcg_shared_module_exports__['b']({},this.props))),Zt.createElement("div",{class:Zt.const("dcg-iconed-mathquill-row dcg-label-size-row")},Zt.createElement(Pe,{tooltip:()=>this.controller.s("graphing-calculator-label-label-size-tooltip"),sticky:this.const(!0),gravity:this.const("se")},Zt.createElement("span",{class:Zt.const("dcg-font-size")},Zt.const("A"))),Zt.createElement(lr,{latex:()=>this.model.labelSize,placeholder:()=>"1",isFocused:()=>this.getFocusedInput()==="labelsize",ariaPostLabel:()=>sI(this.model)?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-label-size"),hasError:()=>!sI(this.model),handleLatexChanged:this.bindFn(this.dispatchLabelSizeIfChanged),dataLabelAttributeValue:this.const("label-size"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>this.handleFocusedChanged(e,"labelsize")})),Zt.createElement("div",{class:()=>({"dcg-iconed-mathquill-row":!0,"dcg-label-angle-row":!0,"dcg-suffix-degree":this.props.controller().getGraphSettings().degreeMode,"dcg-suffix-radian":!this.props.controller().getGraphSettings().degreeMode})},Zt.createElement(Pe,{tooltip:()=>this.controller.s("graphing-calculator-label-angle-tooltip"),sticky:this.const(!0)},Zt.createElement("i",{class:Zt.const("dcg-icon-angle"),"aria-hidden":Zt.const("true")})),Zt.createElement(lr,{latex:()=>this.model.labelAngle,placeholder:()=>"0",isFocused:()=>this.getFocusedInput()==="labelangle",ariaPostLabel:()=>aI(this.model)?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-label-angle"),hasError:()=>!aI(this.model),handleLatexChanged:this.bindFn(this.dispatchLabelAngleIfChanged),dataLabelAttributeValue:this.const("label-angle"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>this.handleFocusedChanged(e,"labelangle")}))),Zt.createElement("div",{class:Zt.const("dcg-options-right-side")},Zt.createElement(DS,{controller:()=>this.controller,model:()=>this.model}))),Zt.createElement(Gm,{predicate:this.props.isFirstOpenSection},()=>Zt.createElement(rs,{controller:this.props.controller,colorLatex:()=>this.model.colorLatex,selectedColor:this.bindFn(this.getModelColor),onColorSelected:this.bindFn(this.onColorSelected),onCustomColorSelected:this.bindFn(this.onCustomColorSelected)})),Zt.createElement(Gm,{predicate:()=>this.controller.canUseAdvancedStyling()},()=>Zt.createElement("div",{class:Zt.const("dcg-label-advanced")},Zt.createElement(Dt,{checked:this.bindFn(this.getWhiteTextOutline),onChange:this.bindFn(this.setWhiteTextOutline),disabled:()=>this.getEditable()},()=>this.controller.s("graphing-calculator-button-label-text-outline")),Zt.createElement("div",{role:Zt.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-heading-advanced")},Zt.createElement(Gm,{predicate:()=>this.shouldShowHoverLabelCheckbox()},()=>Zt.createElement(Dt,{checked:this.bindFn(this.getInteractiveLabel),onChange:this.bindFn(this.setInteractiveLabel)},()=>this.controller.s("graphing-calculator-button-label-show-on-hover"))),Zt.createElement(Gm,{predicate:this.bindFn(this.shouldShowEditableLabelToggle)},()=>Zt.createElement(Dt,{checked:this.bindFn(this.getEditable),onChange:this.bindFn(this.setEditable)},()=>this.controller.s("graphing-calculator-button-label-editable")))))))))}getWhiteTextOutline(){return this.getEditable()?!1:!this.model.suppressTextOutline}setWhiteTextOutline(e){this.controller.dispatch({type:"set-suppress-text-outline",id:this.id,suppressTextOutline:!e})}setInteractiveLabel(e){this.controller.dispatch({type:"set-item-interactive-label",id:this.id,interactiveLabel:e})}getInteractiveLabel(){return!!this.model.interactiveLabel}setEditable(e){if(e){let r=__dcg_shared_module_exports__['Zc'](this.model.label)==="latex"?"MATH":"TEXT";this.controller.dispatch({type:"set-item-editable-label-mode",id:this.id,editableLabelMode:r})}else this.controller.dispatch({type:"set-item-editable-label-mode",id:this.id,editableLabelMode:"NONE"})}getEditable(){return this.model.editableLabelMode!=="NONE"}shouldShowEditableLabelToggle(){return Ks(this.model)}shouldShowHoverLabelCheckbox(){return this.model.reconciledDragMode==="NONE"}dispatchLabelAngleIfChanged(e){this.model.labelAngle!==e&&this.controller.dispatch({type:"set-item-labelangle",id:this.id,labelAngle:e})}dispatchLabelSizeIfChanged(e){this.model.labelSize!==e&&this.controller.dispatch({type:"set-item-labelSize",id:this.id,labelSize:e})}toggleLabelVisible(){this.controller.dispatch({type:"set-item-showlabel",id:this.id,showLabel:!this.props.isOpen()})}};var qo=__dcg_shared_module_exports__['i'](Z());var{If:BW,For:KW}=qo.Components,Vm=class extends hn{template(){return qo.createElement("div",{class:qo.const("dcg-options-menu-section")},qo.createElement("div",{class:qo.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-heading-drag"),qo.createElement(pn,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-menu-drag-enabled"),toggled:this.props.isOpen,onChange:this.bindFn(this.toggleDragEnabled)})),qo.createElement(BW,{predicate:this.props.isOpen},()=>qo.createElement("div",{class:qo.const("dcg-options-menu-content")},qo.createElement(KW,{each:()=>["X","Y","XY"]},qo.createElement("div",{class:qo.const("dcg-style-icons"),role:qo.const("radiogroup")},e=>qo.createElement("div",{class:()=>({"dcg-style-icon-container":!0,"dcg-disabled":this.isDisabled(e)}),onTap:()=>this.onDragModeSelected(e),role:qo.const("radio"),tabindex:()=>this.isDisabled(e)?-1:0,"aria-label":()=>e==="X"?this.controller.s("graphing-calculator-narration-drag-mode-x"):e==="Y"?this.controller.s("graphing-calculator-narration-drag-mode-y"):e==="XY"?this.controller.s("graphing-calculator-narration-drag-mode-xy"):this.controller.raw(""),"aria-checked":()=>this.getDragMode()===e},qo.createElement(cn,{backgroundColor:()=>({type:"single-color",value:"#000"}),semiTransparent:()=>this.getDragMode()!==e,iconType:()=>e==="X"?"movable-horizontal":e==="Y"?"movable-vertical":"movable-both"})))))))}isDisabled(e){let r=this.controller.getEnabledDragModesForItem(this.id);return!__dcg_shared_module_exports__['p'](r,e)}onDragModeSelected(e){if(this.model.type==="expression"){if(this.isDisabled(e))return;this.controller.dispatch({type:"set-item-dragmode",id:this.id,dragMode:e})}else{let r=this.model.id,i=this.model.table.id;this.controller.dispatch({type:"set-tablecolumn-dragmode",tableId:i,columnId:r,dragMode:e})}}getDragMode(){return this.model.type==="expression"?this.model.reconciledDragMode||this.model.dragMode:this.model.dragMode}toggleDragEnabled(){let e=this.getDragMode()!=="NONE"?"NONE":"XY";this.model.type==="expression"?this.controller.dispatch({type:"set-item-dragmode",id:this.id,dragMode:e}):this.onDragModeSelected(e)}};var Io=__dcg_shared_module_exports__['i'](Z());var{If:qW}=Io.Components,ES=class extends hn{template(){return Io.createElement("div",{class:Io.const("dcg-options-menu-section")},Io.createElement("div",{class:Io.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-heading-points"),Io.createElement(pn,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-points-visible"),toggled:this.props.isOpen,onChange:this.bindFn(this.togglePointsVisible)})),Io.createElement(qW,{predicate:()=>this.props.isOpen()},()=>Io.createElement("div",{class:Io.const("dcg-options-menu-content")},Io.createElement("div",{class:Io.const("dcg-iconed-mathquill-row dcg-line-thickness-row-3d")},Io.createElement(Pe,{tooltip:()=>this.controller.s("graphing-calculator-label-point-size-3d-tooltip"),gravity:this.const("se"),sticky:this.const(!0)},Io.createElement("i",{class:Io.const("dcg-icon-line-thickness"),"aria-hidden":Io.const("true")})),Io.createElement(lr,{latex:()=>this.model.pointSize,placeholder:this.bindFn(this.getDefaultPointSize),isFocused:()=>this.getFocusedInput()==="pointsize",ariaPostLabel:()=>this.isPointSizeValid()?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-point-size"),hasError:()=>!this.isPointSizeValid(),handleLatexChanged:e=>this.dispatchPointSizeLatexIfChanged(e),dataLabelAttributeValue:this.const("point-size"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>this.handleFocusedChanged(e,"pointsize")})),Io.createElement(rs,{controller:this.props.controller,colorLatex:()=>this.model.colorLatex,selectedColor:this.bindFn(this.getModelColor),onColorSelected:this.bindFn(this.onColorSelected),onCustomColorSelected:this.bindFn(this.onCustomColorSelected),hideCustomColors:()=>!1}))))}togglePointsVisible(){this.controller.dispatch({type:"set-item-points",id:this.id,points:!this.props.isOpen()})}isPointSizeValid(){return this.model.type==="expression"?Zv(this.model):!1}dispatchPointSizeLatexIfChanged(e){this.model.pointSize!==e&&this.model.type==="expression"&&this.controller.dispatch({type:"set-item-pointsize",id:this.id,pointSize:e})}getDefaultPointSize(){return`${3}`}};var wn=__dcg_shared_module_exports__['i'](Z());var{If:t3}=wn.Components,kS=class extends hn{template(){return wn.createElement("div",{class:wn.const("dcg-options-menu-section")},wn.createElement("div",{class:wn.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-heading-lines"),wn.createElement(pn,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-lines-visible"),toggled:this.props.isOpen,onChange:this.bindFn(this.toggleLinesVisible)})),wn.createElement(t3,{predicate:()=>this.props.isOpen()},()=>wn.createElement("div",{class:wn.const("dcg-options-menu-content")},wn.createElement("div",{class:wn.const("dcg-iconed-mathquill-row dcg-line-thickness-row-3d")},wn.createElement(Pe,{tooltip:()=>this.controller.s("graphing-calculator-label-line-thickness-3d-tooltip"),sticky:this.const(!0),gravity:this.const("se")},wn.createElement("i",{class:wn.const("dcg-icon-line-thickness"),"aria-hidden":wn.const("true")})),wn.createElement(lr,{latex:()=>this.model.lineWidth,placeholder:()=>`${1}`,isFocused:()=>this.getFocusedInput()==="linewidth",ariaPostLabel:()=>this.isLineWidthValid()?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-label-line-thickness-3d-tooltip"),hasError:()=>!this.isLineWidthValid(),handleLatexChanged:this.bindFn(this.dispatchLineWidthLatexIfChanged),dataLabelAttributeValue:this.const("line-width"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>this.handleFocusedChanged(e,"linewidth")})),wn.createElement(t3,{predicate:()=>this.model.latex.indexOf("segment")===-1&&!!mi("beta3d")},()=>wn.createElement("div",{style:wn.const("font-size:85%; margin-top:8px; margin-bottom: 8px")},wn.const("Resolution:"),wn.createElement(lr,{latex:()=>this.model.resolution,placeholder:()=>`${__dcg_shared_module_exports__['xc']}`,isFocused:()=>this.getFocusedInput()==="resolution",ariaPostLabel:()=>this.isResolutionValid()?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-label-resolution-tooltip"),hasError:()=>!this.isResolutionValid(),handleLatexChanged:this.bindFn(this.dispatchResolutionLatexIfChanged),dataLabelAttributeValue:this.const("resolution"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>this.handleFocusedChanged(e,"resolution")}))),wn.createElement(rs,{controller:this.props.controller,colorLatex:()=>this.model.colorLatex,selectedColor:this.bindFn(this.getModelColor),onColorSelected:this.bindFn(this.onColorSelected),onCustomColorSelected:this.bindFn(this.onCustomColorSelected),hideCustomColors:()=>!1}))))}toggleLinesVisible(){this.controller.dispatch({type:"set-item-lines",id:this.id,lines:!this.props.isOpen()})}isLineWidthValid(){return this.model.type==="expression"?eC(this.model):!1}isResolutionValid(){return this.model.type==="expression"?tC(this.model):!1}dispatchLineWidthLatexIfChanged(e){this.model.lineWidth!==e&&this.model.type==="expression"&&this.controller.dispatch({type:"set-item-linewidth",id:this.id,lineWidth:e})}dispatchResolutionLatexIfChanged(e){this.model.resolution!==e&&this.model.type==="expression"&&this.controller.dispatch({type:"set-item-resolution",id:this.id,resolution:e})}};var _i=__dcg_shared_module_exports__['i'](Z());var Rt=__dcg_shared_module_exports__['i'](Z());var{For:MT,If:Dw}=Rt.Components,zW={RED:__dcg_shared_module_exports__['T'].RED,BLUE:__dcg_shared_module_exports__['T'].BLUE,GREEN:__dcg_shared_module_exports__['T'].GREEN,ORANGE:__dcg_shared_module_exports__['T'].ORANGE,PURPLE:__dcg_shared_module_exports__['T'].PURPLE,GRAY:__dcg_shared_module_exports__['T'].GRAY},GS=class extends Rt.Class{init(){this.controller=this.props.controller()}template(){return Rt.createElement("div",{class:Rt.const("dcg-color-picker-container")},Rt.createElement(MT,{each:()=>__dcg_shared_module_exports__['D'](zW)},Rt.createElement("span",{class:Rt.const("dcg-color-picker-menu dcg-do-not-blur")},e=>Rt.createElement("span",{class:Rt.const("dcg-color-tile"),handleevent:Rt.const("true"),role:Rt.const("button"),tabindex:Rt.const(0),"aria-label":()=>Rd(this.controller,e),"aria-pressed":()=>this.isSelected(e),onTap:()=>this.props.onColorSelected(e)},Rt.createElement("span",{class:()=>({"dcg-color-swatch":!0,"dcg-light-color":qh({type:"single-color",value:e},this.controller.invertSwatches())}),style:()=>({background:e})}),Rt.createElement(Dw,{predicate:()=>this.isSelected(e)},()=>Rt.createElement("i",{class:Rt.const("dcg-icon-check"),"aria-hidden":Rt.const("true")}))))),Rt.createElement(Dw,{predicate:()=>this.getUniqueCustomColors().length>0},()=>Rt.createElement(MT,{each:this.bindFn(this.getUniqueCustomColors),key:e=>typeof e=="string"?e:e.assignmentLatex},Rt.createElement("span",{class:Rt.const("dcg-color-picker-menu dcg-do-not-blur")},e=>typeof e=="string"?Rt.createElement("span",{class:Rt.const("dcg-color-picker-placeholder")}):Rt.createElement(Pe,{tooltip:()=>e.assignmentLatex,renderAsLatex:()=>({view:r=>Rt.createElement(et,{config:this.const({}),latex:()=>r})})},Rt.createElement("span",{class:Rt.const("dcg-color-tile"),handleevent:Rt.const("true"),role:Rt.const("button"),tabindex:Rt.const(0),"aria-label":()=>Eo(e.assignmentLatex),"aria-pressed":()=>this.props.colorLatex()===e.assignmentLatex,onTap:()=>this.props.onCustomColorSelected(e.assignmentLatex)},Rt.createElement(np,{color:()=>this.getColorValue(e),invertSwatches:()=>this.controller.invertSwatches()}),Rt.createElement(Dw,{predicate:()=>this.props.colorLatex()===e.assignmentLatex},()=>Rt.createElement("i",{class:()=>this.getCheckmarkClass(e),"aria-hidden":Rt.const("true")}))))))),Rt.createElement(Dw,{predicate:()=>this.props.canUsePatterns()&&this.getAllImages().length>0},()=>Rt.createElement(MT,{each:this.bindFn(this.getAllImages),key:e=>e.id},Rt.createElement("span",{class:Rt.const("dcg-color-picker-menu dcg-do-not-blur")},e=>e.id.indexOf("placeholder")!==-1?Rt.createElement("span",{class:Rt.const("dcg-color-picker-placeholder")}):Rt.createElement(Pe,{tooltip:()=>this.controller.raw(e.name)},Rt.createElement("span",{class:Rt.const("dcg-color-tile"),handleevent:Rt.const("true"),role:Rt.const("button"),tabindex:Rt.const(0),"aria-label":()=>this.controller.raw(e.name),"aria-pressed":()=>this.props.colorLatex()===e.url,onTap:()=>this.props.onCustomColorSelected(e.url)},Rt.createElement("span",{class:()=>({"dcg-color-swatch":!0,"dcg-has-background-image":!0}),style:()=>({"background-image":'url("'+e.url+'")'})}),Rt.createElement(Dw,{predicate:()=>this.props.colorLatex()===e.url},()=>Rt.createElement("i",{class:()=>"dcg-icon-check dcg-mixed-color","aria-hidden":Rt.const("true")}))))))))}isSelected(e){var r=this.props.colorLatex();return r&&__dcg_shared_module_exports__['q'](this.getUniqueCustomColors(),"assignmentLatex").indexOf(r)>=0?!1:this.props.selectedColor()===e}getUniqueCustomColors(){if(this.props.hideCustomColors&&this.props.hideCustomColors())return[];let e=this.props.canUsePatterns()?[{id:"gradient_u",assignmentLatex:"gradient_u"},{id:"gradient_v",assignmentLatex:"gradient_v"}].concat(mi("beta3d")?{id:"checkers",assignmentLatex:"checkers"}:[]):[],r=this.controller.getAllColorAssignments(),i=__dcg_shared_module_exports__['v'](r,function(s){return s.assignmentLatex}),n=this.controller.getAllColorFunctionAssignments(),o=e.concat(__dcg_shared_module_exports__['m'](r,s=>i[s.assignmentLatex]===1)).concat(n);for(let s=0;s<o.length%6;s++)o.push("placholder-"+s);return o}getAllImages(){if(!mi("beta3d"))return[];let e=this.controller.getAllImages();for(let r=0;r<e.length%6;r++)e.push({id:"placeholder-"+r,url:"",name:""});return e}getColorValue(e){switch(e.id){case"gradient_u":case"gradient_v":case"checkers":case"shader":return{type:e.id};default:let r=this.controller.getColorById(e.id);return Array.isArray(r)?{type:"color-array",value:r}:/^data:image/.test(r)?{type:"image",value:r}:{type:"single-color",value:r}}}getCheckmarkClass(e){return qh(this.getColorValue(e),!1)?`dcg-icon-check ${OC(this.getColorValue(e),!1)?"dcg-light-color":"dcg-mixed-color"}`:"dcg-icon-check"}};var{If:Sw}=_i.Components,VS=class extends hn{template(){return _i.createElement("div",{class:_i.const("dcg-options-menu-section")},_i.createElement("div",{class:_i.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-heading-surfaces"),_i.createElement(pn,{ariaLabel:()=>this.controller.s("graphing-calculator-narration-surfaces-visible"),toggled:this.props.isOpen,onChange:this.bindFn(this.toggleSurfacesVisible)})),_i.createElement(Sw,{predicate:()=>this.props.isOpen()},()=>_i.createElement("div",{style:_i.const("font-size:85%; margin-top:8px")},_i.createElement(Sw,{predicate:()=>this.isNotTriangle()&&!!mi("beta3d")},()=>_i.createElement("div",null,_i.const("Resolution:"),_i.createElement(lr,{latex:()=>this.model.resolution,placeholder:()=>this.getDefaultResolution(),isFocused:()=>this.getFocusedInput()==="resolution",ariaPostLabel:()=>this.isResolutionValid()?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-label-resolution-tooltip"),hasError:()=>!this.isResolutionValid(),handleLatexChanged:this.bindFn(this.dispatchResolutionLatexIfChanged),dataLabelAttributeValue:this.const("resolution"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>this.handleFocusedChanged(e,"resolution")}))),_i.createElement(Sw,{predicate:()=>this.model.colorLatex==="checkers"},()=>_i.createElement("div",null,_i.const("Checkers:"),_i.createElement(lr,{latex:()=>this.model.checkers,placeholder:()=>`${__dcg_shared_module_exports__['vc']}`,isFocused:()=>this.getFocusedInput()==="checkers",ariaPostLabel:()=>this.isCheckersValid()?this.controller.raw(""):this.controller.s("shared-calculator-narration-input-error"),ariaLabel:()=>this.controller.s("graphing-calculator-label-checkers"),hasError:()=>!this.isCheckersValid(),handleLatexChanged:this.bindFn(this.dispatchCheckersLatexIfChanged),dataLabelAttributeValue:this.const("checkers"),controller:this.props.controller,readonly:()=>this.controller.isItemReadonly(this.model.id),handleFocusChanged:e=>this.handleFocusedChanged(e,"checkers")}))),_i.createElement(Sw,{predicate:this.props.isFirstOpenSection},()=>_i.createElement("div",{class:_i.const("dcg-options-menu-content"),style:_i.const("margin-top:8px")},_i.createElement(GS,{controller:this.props.controller,colorLatex:()=>this.model.colorLatex,selectedColor:this.bindFn(this.getModelColor),onColorSelected:this.bindFn(this.onColorSelected),onCustomColorSelected:this.bindFn(this.onCustomColorSelected),hideCustomColors:()=>!1,canUsePatterns:()=>this.isNotTriangle()}))),_i.createElement(Sw,{predicate:()=>Wv(this.model)&&!!mi("beta3d")},()=>_i.createElement("div",{style:_i.const("margin-top:8px")},_i.createElement(jr,{staticConfig:this.bindFn(this.get3dPolarOptions),ariaGroupLabel:()=>this.controller.s("graphing-calculator-narration-settings-dimension"),theme:this.const("mini")}))))))}toggleSurfacesVisible(){this.controller.dispatch({type:"set-item-surfaces",id:this.id,surfaces:!this.props.isOpen()})}isNotTriangle(){return this.model.latex.indexOf("triangle")===-1}dispatchResolutionLatexIfChanged(e){this.model.resolution!==e&&this.model.type==="expression"&&this.controller.dispatch({type:"set-item-resolution",id:this.id,resolution:e})}dispatchCheckersLatexIfChanged(e){this.model.checkers!==e&&this.model.type==="expression"&&this.controller.dispatch({type:"set-item-checkers",id:this.id,checkers:e})}isCheckersValid(){return this.model.type==="expression"?IO(this.model):!1}isResolutionValid(){return this.model.type==="expression"?tC(this.model):!1}getDefaultResolution(){if(this.model.type==="expression"){if(this.model.formula.graphMode3d===41)return`${40}`;if(yO(this.model))return`${__dcg_shared_module_exports__['wc']}`}return`${__dcg_shared_module_exports__['uc']}`}get3dPolarOptions(){return["Cylindrical","Spherical"].map(r=>({key:r,label:()=>r,selected:()=>this.isPolarCoordinateSystemSelected(r),onSelect:()=>{this.on3dOptionSelected(r)}}))}isPolarCoordinateSystemSelected(e){return"polarCoordinateSystem"in this.model?this.model.polarCoordinateSystem==e:!1}on3dOptionSelected(e){if("polarCoordinateSystem"in this.model){if(this.model.polarCoordinateSystem===e)return;this.model.type==="expression"&&this.controller.dispatch({type:"set-item-polar-coordinate-system",id:this.id,polarCoordinateSystem:e})}}};var{For:jW,If:JW}=Mn.Components,Im=class extends Mn.Class{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id,this.props.registerRepositionCb(this.bindFn(this.renderOffset))}template(){return Mn.createElement("div",{class:()=>({"dcg-expressions-options-menu":!0,"dcg-options-menu":!0}),role:Mn.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-narration-options-menu"),didMount:this.bindFn(this.didMountContainer)},Mn.createElement(jW,{each:this.bindFn(this.getSections)},Mn.createElement("div",null,e=>{switch(e){case"points":return Mn.createElement(km,__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.props),{isOpen:()=>this.isSectionOpen("points"),isFirstOpenSection:()=>this.isFirstOpenSection("points")}));case"label":return Mn.createElement(SS,__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.props),{isOpen:()=>this.isSectionOpen("label"),isFirstOpenSection:()=>this.isFirstOpenSection("label")}));case"drag":return Mn.createElement(Vm,__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.props),{isOpen:()=>this.isSectionOpen("drag"),isFirstOpenSection:()=>this.isFirstOpenSection("drag")}));case"lines":return Mn.createElement(Dm,__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.props),{isOpen:()=>this.isSectionOpen("lines"),isFirstOpenSection:()=>this.isFirstOpenSection("lines")}));case"arrows":return Mn.createElement(fS,__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.props),{isOpen:()=>this.isSectionOpen("arrows"),isFirstOpenSection:()=>this.isFirstOpenSection("arrows")}));case"fill":return Mn.createElement(bS,__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.props),{isOpen:()=>this.isSectionOpen("fill"),isFirstOpenSection:()=>this.isFirstOpenSection("fill")}));case"colors-only":return Mn.createElement(yS,__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.props),{isOpen:this.const(!0),isFirstOpenSection:this.const(!0)}));case"points3d":return Mn.createElement(ES,__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.props),{isOpen:()=>this.isSectionOpen("points"),isFirstOpenSection:()=>this.isFirstOpenSection("points")}));case"lines3d":return Mn.createElement(kS,__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.props),{isOpen:()=>this.isSectionOpen("lines3d"),isFirstOpenSection:()=>this.isFirstOpenSection("lines3d")}));case"surfaces":return Mn.createElement(VS,__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.props),{isOpen:()=>this.isSectionOpen("surfaces"),isFirstOpenSection:()=>this.isFirstOpenSection("surfaces")}))}})),Mn.createElement(JW,{predicate:this.bindFn(this.isClickable)},()=>Mn.createElement(Sm,__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.props),{isOpen:()=>!!this.model.clickableInfo.enabled,isFirstOpenSection:this.const(!1)}))),Mn.createElement("div",{class:Mn.const("dcg-triangle"),didMount:this.bindFn(this.didMountArrow)}))}willUnmount(){me(this.controller.s("graphing-calculator-narration-options-menu-closed"))}didMountContainer(e){this.$containerElt=I(e),me(this.controller.s("graphing-calculator-narration-options-menu-open"))}didMountArrow(e){this.$arrowElt=I(e)}renderOffset(e){if(!this.$containerElt||!this.$arrowElt)return;let r=this.$containerElt.outerHeight(),i=0;r>e&&(i=+e-r);let n=-i<r-38;this.$containerElt.css("margin-top",`${i}px`),this.$arrowElt.css("margin-top",`${-i}px`),this.$arrowElt.css("display",n?"":"none")}isClickable(){return this.controller.areActionsEnabled()&&lI(this.model)&&!this.controller.isItemReadonly(this.model.id)}getSections(){if(this.controller.isThreeDMode()){if(fO(this.model))return["points3d"];if(tI(this.model))return["lines3d"];if(bO(this.model)||Wv(this.model))return["lines","surfaces"];if(rI(this.model))return["surfaces"]}return Hp(this.model)||Nh(this.model)||$v(this.model)||DO(this.model)?["colors-only"]:Bh(this.model)?["lines"]:Od(this.model)?["points"]:vO(this.model)?["points","label","lines"]:Ks(this.model)?this.model.formula.move_strategy&&!this.controller.isThreeDMode()?["points","label","drag"]:["points","label"]:Fh(this.model)||qc(this.model)?["lines","fill"]:Hc(this.model)?Rh(this.model)||bg(this.model)||pa(this.model)?["lines"]:["lines","fill"]:by(this.model)?["lines","arrows"]:["lines"]}isFirstOpenSection(e){let r=this.getSections();for(let i of r){if(i===e)return this.isSectionOpen(e);if(this.isSectionOpen(i))return!1}return!1}isSectionOpen(e){let{points:r,lines:i,fill:n,surfaces:o}=this.model,s=__dcg_shared_module_exports__['pc'](this.model.formula.expression_type,{points:r,lines:i,fill:n,surfaces:o});switch(e){case"lines":return this.model.hidden?!1:s.lines;case"label":return this.model.showLabel;case"fill":return this.model.hidden?!1:Hc(this.model)?!0:s.fill;case"points":return this.model.hidden?!1:Ks(this.model)?!this.model.hidden:s.points;case"drag":return this.model.reconciledDragMode!=="NONE";case"arrows":return Kv(this.model)!=="NONE";case"colors-only":return!0;case"points3d":return this.model.hidden?!1:s.surfaces;case"lines3d":return this.model.hidden?!1:s.lines;case"surfaces":return this.model.hidden?!1:s.surfaces}}};var Hr=__dcg_shared_module_exports__['i'](Z());var Js=__dcg_shared_module_exports__['i'](Z());var{Input:YW}=Js.Components,IS=class extends Js.Class{init(){this.controller=this.props.controller(),this.cacheFolderList(),this.newFolderTitle=""}willUpdate(){this.cacheFolderList()}template(){return Js.createElement("div",{class:Js.const("dcg-move-to-folder")},Js.createElement("div",{class:Js.const("dcg-move-to-folder-title")},this.bindFn(this.getMoveMessage)),Js.createElement("div",{class:Js.const("dcg-move-to-folder-flex")},Js.createElement(YW,{"aria-label":this.bindFn(this.getMoveMessage),value:()=>this.newFolderTitle,onInput:e=>{this.newFolderTitle=e,this.update()},placeholder:()=>this.controller.raw("Folder name"),didMount:e=>{e.onkeydown=function(r){let i=Te(r);(i==="Backspace"||i==="Del")&&r.stopPropagation()}},onEnterPressed:this.bindFn(this.onEnterPressed)}),Js.createElement("div",{class:()=>({"dcg-btn-blue":!0,"dcg-disabled":!this.newFolderTitle}),role:Js.const("button"),tabindex:()=>this.newFolderTitle?0:-1,onTap:this.bindFn(this.createNewFolder)},()=>this.controller.raw("Move"))))}getMoveMessage(){return this.controller.getAllSelectedItems().length===1?this.controller.raw("Move to folder:"):this.controller.raw(`Move ${this.controller.getAllSelectedItems().length} objects to folder:`)}onEnterPressed(){let e=!1;this.folderList.forEach(r=>{r.title===this.newFolderTitle&&(e=!0,this.chooseFolder(r.id))}),e||this.createNewFolder()}chooseFolder(e){this.controller.dispatch({type:"update-all-selected-items",update:{prop:"folderId",value:e}})}createNewFolder(){this.newFolderTitle&&this.controller.dispatch({type:"update-all-selected-items",update:{prop:"folderId",value:this.newFolderTitle,createFolder:!0}})}cacheFolderList(){this.folderList=[],this.controller.getAllItemModels().forEach(e=>{e.type==="folder"&&!this.controller.isGeoFolder(e)&&this.folderList.push(e)})}};var de=__dcg_shared_module_exports__['i'](Z());var FT={};__dcg_shared_module_exports__['h'](FT,{CLCalculator:()=>r3,Label:()=>__dcg_shared_module_exports__['Lb'],applyDiff:()=>a3,applyLocalizationMap:()=>d3,blankGeometryCalculatorState:()=>C9,blankGraphingCalculatorState:()=>v9,builtInFrame:()=>b9,calculateDiff:()=>o3,colorHelpers:()=>__dcg_shared_module_exports__['U'],context:()=>y9,expressionParser:()=>_T,extractLocalizationMap:()=>c3,formatLatex:()=>u3,migrateToLatest:()=>uc,numberToDecimalString:()=>__dcg_shared_module_exports__['lc'],numberToLatex:()=>__dcg_shared_module_exports__['kc'],parseNodes:()=>m3,parser:()=>m9,policies:()=>x9,replaceIdentifierWithLatex:()=>FV,treeQueries:()=>f9,types:()=>w9});function r3(t){let e=uc(t);var r={},i=e.graph.degreeMode,n=e.randomSeed;let o=e.graph.product==="graphing"?"graphing":"geometry";function s(l){switch(l.type){case void 0:case"expression":{let d=__dcg_shared_module_exports__['Xc'](__dcg_shared_module_exports__['Tc'](l));r[d.id]=d}break;case"table":{let d=BC(NC(l));r[d.id]=d}break;case"folder":case"text":case"image":break;default:return l}}for(var a of e.expressions.list)s(a);return{setExpression(l){s(l)},getChangeSet(){return{statements:r,isCompleteState:!0,degreeMode:i,globalRandomSeed:n,evaluationMode:o}}}}function Mm(t,e){switch(t.type){case"Mul":case"DotMul":case"CrossMul":case"Div":case"Prime":case"Call":case"ImplicitCall":case"Dot":case"Pipes":case"Sqrt":case"Nthroot":case"Frac":case"Derivative":case"Integral":case"EmptyIntegral":case"Sum":case"Product":case"Piecewise":case"Paren":case"Juxt":case"Superscript":case"Bang":case"Index":case"Equals":case"Inequality":case"Tilde":case"Pos":case"Neg":case"Add":case"Sub":case"List":case"Seq":case"Colon":case"Ellipsis":case"PercentOf":case"RightArrow":case"For":case"With":{let i=0;for(let n of t.args)i+=Mm(n,e);return i}case"Decimal":return e===void 0||parseFloat(t.val)===e?1:0;case"MixedNumber":{if(e===void 0)return 3;let i=0;return parseFloat(t.whole)===e&&(i+=1),parseFloat(t.num)===e&&(i+=1),parseFloat(t.den)===e&&(i+=1),i}case"Letter":case"EmptyPiecewise":case"Cmd":case"EmptyRangeEnd":return 0;case"Subscript":return Mm(t.args[0],e);case"InequalityChain":{let i=0;i+=Mm(t.first,e);for(let n of t.chain)i+=Mm(n.args[0],e);return i}default:throw`Unexpected surface node ${t.type}.`}}function i3(t){let e=t.length,r=new Array(e),i=new Array(e+1),n=0;for(let a=0;a<e;a++){let l;if(t[i[n]]<t[a])l=n+1;else{let c=1,d=n-1;for(;c<=d;){let u=Math.ceil((c+d)/2);t[i[u]]<t[a]?c=u+1:d=u-1}l=c}r[a]=i[l-1],i[l]=a,l>n&&(n=l)}let o=new Array(n),s=i[n];for(let a=n-1;a>=0;a--)o[a]=t[s],s=r[s];return o}function o3(t,e){return MS(t,e,0)}function MS(t,e,r){let i={};for(let n in t){if(!t.hasOwnProperty(n))continue;if(!e.hasOwnProperty(n)){i[n]={d:1};continue}let o=t[n],s=e[n],a=XW(o,s,r,n);a&&(i[n]=a)}for(let n in e)e.hasOwnProperty(n)&&!t.hasOwnProperty(n)&&(i[n]={s:e[n]});return i}function XW(t,e,r,i){if(__dcg_shared_module_exports__['H'](t)&&__dcg_shared_module_exports__['H'](e)){if(r===1&&i==="list"||r===2&&i==="columns")return ZW(t,e);if(!__dcg_shared_module_exports__['F'](t,e))return{s:e}}else if(__dcg_shared_module_exports__['I'](t)&&__dcg_shared_module_exports__['I'](e)){let n=MS(t,e,QW(r,i));if(!__dcg_shared_module_exports__['G'](n))return{e:n}}else if(!__dcg_shared_module_exports__['F'](t,e))return{s:e}}function QW(t,e){return t===0&&e==="expressions"?1:3}function ZW(t,e){let r={},i={};for(let a=0;a<t.length;a++){if(i[t[a].id]!==void 0)return{s:e};i[t[a].id]=a}let n={};for(let a=0;a<e.length;a++){if(n[e[a].id]!==void 0)return{s:e};n[e[a].id]=a}let o=e9(t,e,i),s=0;for(let a=0;a<t.length;a++){let l=t[a];if(!o[l.id])r[a]={d:1};else{let c=n[l.id],d=e[c],u={};if(s!==c&&(u.a=e.slice(s,c).map(p=>n3(t,i,p))),!__dcg_shared_module_exports__['F'](l,d)){let p=l.type==="table"&&d.type==="table";u.e=MS(l,d,p?2:3)}__dcg_shared_module_exports__['G'](u)||(r[a]=u),s=c+1}}if(s<e.length&&(r[t.length]={a:e.slice(s,e.length).map(a=>n3(t,i,a))}),!__dcg_shared_module_exports__['G'](r))return{l:r}}function n3(t,e,r){if(e[r.id]){let i=t[e[r.id]],n={f:e[r.id]};return __dcg_shared_module_exports__['F'](i,r)||(n.e=MS(i,r,3)),{m:n}}return{s:r}}function e9(t,e,r){let i={},n=e.filter(s=>r[s.id]!==void 0).map(s=>r[s.id]),o=i3(n);for(let s of o)i[t[s].id]=!0;return i}function a3(t,e){let r=__dcg_shared_module_exports__['N'](t);return TS(r,e)}function TS(t,e){for(let r of __dcg_shared_module_exports__['C'](e)){let i=e[r];r9(i)?t[r]=i.s:i9(i)?delete t[r]:n9(i)?t[r]=t9(t[r],i.l):o9(i)&&(t[r]=TS(t[r],i.e))}return t}function t9(t,e){let r=[];for(let n=0;n<t.length;n++){let o=e[n];o&&o.a&&r.push(...s3(t,o.a)),o&&o.e?r.push(TS(t[n],o.e)):(!o||!o.d)&&r.push(t[n])}let i=e[t.length];return i&&i.a&&r.push(...s3(t,i.a)),r}function s3(t,e){let r=[];for(let i of e)if(s9(i))r.push(i.s);else if(a9(i)){let n=t[i.m.f];i.m.e?r.push(TS(n,i.m.e)):r.push(n)}return r}function r9(t){return t.hasOwnProperty("s")}function i9(t){return t.hasOwnProperty("d")}function n9(t){return t.hasOwnProperty("l")}function o9(t){return t.hasOwnProperty("e")}function s9(t){return t.hasOwnProperty("s")}function a9(t){return t.hasOwnProperty("m")}function l3(t){return t.location==="expression"||t.location==="object"?`${t.location}:${t.id}:${t.path}`:`${t.location}:${t.path}`}function TT(t){let e=()=>new Error(`Invalid key: ${t}`),r=t.split(":"),i=r[0];if(!i||i!="expression"&&i!="settings"&&i!="object")throw e();if(i=="settings"){if(r.length!=2)throw e();return{location:i,path:r[1]}}if(r.length!=3)throw e();return{location:i,id:r[1],path:r[2]}}function AS(t,e,r){if(!t)return;let i=e.split("."),n=t;for(let o=0;o<i.length;o++){let s=i[o];if(!n[s])break;o==i.length-1&&typeof n[s]=="string"?n[s]=r:n=n[s]}}function AT(t,e){return(r,i,n,o)=>{if(r){let s=l3(__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},e),{path:i}));t[s]={value:r,type:n,context:o}}}}function l9(t){var i,n;let e={},r=AT(e,{location:"expression",id:t.id});switch(t.type){case"expression":r(t.label,"label","interpolated-string","expression-list-expression-label"),r(t.description,"description","string","expression-list-expression-clickable-description");break;case"image":r(t.image_url,"image_url","image","expression-list-image-url"),r(t.description,"description","string","expression-list-image-clickable-description"),r((i=t.clickableInfo)==null?void 0:i.hoveredImage,"clickableInfo.hoveredImage","image","expression-list-image-clickable-hovered"),r((n=t.clickableInfo)==null?void 0:n.depressedImage,"clickableInfo.depressedImage","image","expression-list-image-clickable-depressed");break;case"text":r(t.text,"text","string","expression-list-note-text");break;case"folder":r(t.title,"title","string","expression-list-folder-title");break}return e}function c9(t){let e={},r=AT(e,{location:"settings"});return r(t.graph.xAxisLabel,"xAxisLabel","string","settings-xaxis-label"),r(t.graph.yAxisLabel,"yAxisLabel","string","settings-yaxis-label"),e}function d9(t){let e={},r=AT(e,{location:"object",id:t.id});return r(t.label,"label","string","geometry-object-label"),t.type==="image"&&r(t.url,"url","image","geometry-object-image-url"),e}function c3(t){let e={};if(t.type=="graph"){let r=t.graphState.expressions.list;for(let n of r){let o=l9(n);for(let s in o)e[s]=o[s]}let i=c9(t.graphState);for(let n in i)e[n]=i[n]}else{let r=t.geometryState.objects;for(let i in r){let n=d9(r[i]);for(let o in n)e[o]=n[o]}}return e}function d3(t,e,r){var n;let i=__dcg_shared_module_exports__['N'](t);if(r==="graph"){let o={},s=(n=i.expressions)==null?void 0:n.list,a=Array.isArray(s)?s:[];for(let l of a)o[l.id]=l;for(let l in e){let c=TT(l);c.location=="expression"?AS(o[c.id],c.path,e[l].value):AS(i.graph,c.path,e[l].value)}}else if(i.objects)for(let o in e){let s=TT(o);s.location=="object"&&AS(i.objects[s.id],s.path,e[o].value)}return i}function Ur(t){switch(t.type){case"Equals":return Mo(t.args,"=");case"Inequality":let e=t.symbol==="<="?"\\le":t.symbol===">="?"\\ge":t.symbol;return Mo(t.args,e);case"InequalityChain":return Ur(t.first)+t.chain.map(Ur).join("");case"TrailingInequalityPiece":return t.symbol+Ur(t.args[0]);case"Tilde":return Mo(t.args,"~");case"Pos":return"+"+Ur(t.args[0]);case"Neg":return"-"+Ur(t.args[0]);case"Add":return Mo(t.args,"+");case"Sub":return Mo(t.args,"-");case"Mul":return Mo(t.args,"*");case"DotMul":return Mo(t.args,"\\cdot ");case"CrossMul":return Mo(t.args,"\\times ");case"Div":return Mo(t.args,"/");case"Bang":return Ur(t.args[0])+"!";case"Call":let r=PT(t.args);return r?r.script+"\\left("+r.arg+"\\right)":Ur(t.args[0])+"\\left("+Ur(t.args[1])+"\\right)";case"Paren":return"\\left("+Ur(t.args[0])+"\\right)";case"List":return"\\left["+t.args.map(Ur).join(",")+"\\right]";case"Pipes":return"\\left|"+Ur(t.args[0])+"\\right|";case"Index":return Ur(t.args[0])+"\\left["+Ur(t.args[1])+"\\right]";case"Subscript":return Mo(t.args,"_",!0);case"Superscript":return Mo(t.args,"^",!0);case"Prime":if(t.args[0].type==="Call"){let s=PT(t.args[0].args);return s?s.script+LT(t.nprimes)+"\\left("+s.arg+"\\right)":Ur(t.args[0].args[0])+LT(t.nprimes)+"\\left("+Ur(t.args[0].args[1])+"\\right)"}return Ur(t.args[0])+LT(t.nprimes);case"Seq":return t.args.map(Ur).join(",");case"Sqrt":return"\\sqrt"+Ew(Ur(t.args[0]));case"Nthroot":return"\\sqrt["+Ur(t.args[0])+"]"+Ew(Ur(t.args[1]));case"Frac":return"\\frac{"+Ur(t.args[0])+"}{"+Ur(t.args[1])+"}";case"Derivative":return"\\frac{d}{d"+Ur(t.args[0])+"}"+Ur(t.args[1]);case"Integral":case"EmptyIntegral":if(t.args[0].type!=="Cmd")throw new Error("Expected first argument of an integral to be the variable");let i="d"+t.args[0].val;if(t.args.length===3)return kw("int",t.args[1],t.args[2])+i;let n=Ur(t.args[3]);return kw("int",t.args[1],t.args[2])+n+i;case"Sum":return h3(t.args,"sum");case"Product":return h3(t.args,"prod");case"Piecewise":return"\\{"+Ur(t.args[0])+"\\}";case"EmptyPiecewise":return"\\{\\}";case"Colon":return Mo(t.args,":");case"Ellipsis":return Mo(t.args,"...");case"For":return Mo(t.args,"\\for ");case"With":return Mo(t.args,"\\with ");case"Dot":return Mo(t.args,".");case"PercentOf":return Mo(t.args,"\\% \\of ");case"RightArrow":return Mo(t.args,"->");case"Juxt":return Mo(t.args,t.args[0].type==="Cmd"?" ":"");case"ImplicitCall":{let s=PT(t.args);return s?s.script+s.arg:Mo(t.args,"")}case"MixedNumber":return t.whole+"\\frac{"+t.num+"}{"+t.den+"}";case"Letter":case"Decimal":case"Alphanumeric":return t.val;case"Cmd":return"\\"+t.val;case"EmptyRangeEnd":return"EmptyRangeEnd";case"Err":throw t.error;default:return t}}function Ew(t){return t.length>1?"{"+t+"}":t}function kw(t,e,r){let i=Ew(Ur(e));if(r){let n=Ew(Ur(r));return`\\${t}_${i}^${n}`}return`\\${t}_${i}`}function Mo(t,e,r=!1){let i=Ur(t[0]),n=r?Ew(Ur(t[1])):Ur(t[1]);return i+e+n}function h3(t,e){let r=Ur(t[0]);return kw(e,t[1],t[2])+r}function LT(t){let e="";for(let r=0;r<t;r++)e+="'";return e}function p3(t){return t.type==="Cmd"&&t.val==="logbase"}function PT(t){let e=t[1],r;if(t[1].type==="Seq"&&t[1].args.length===2&&(e=t[1].args[1],r=t[1].args[0]),t[0].type==="Superscript"&&p3(t[0].args[0]))return{script:kw("log",e,t[0].args[1]),arg:r?Ur(r):""};if(p3(t[0]))return{script:kw("log",e),arg:r?Ur(r):""}}function u3(t){let e=_T.parse(t.latex);if(e.type=="Err")return;let r=To(e);for(;r.type==="Paren";)r=r.args[0];return dd(r)?{latex:t.latex}:{latex:Ur(r)}}function h9(t){return t.isPseudoSurfaceNode}function dd(t){switch(t.type){case"Letter":case"Decimal":case"Cmd":return t.val==="0";case"Paren":return dd(t.args[0]);default:return!1}}function ap(t){switch(t.type){case"Letter":case"Decimal":case"Cmd":return t.val==="1";case"Paren":return ap(t.args[0]);default:return!1}}function g3(t){return t.type==="Neg"?ap(t.args[0]):t.type==="Paren"?g3(t.args[0]):!1}function LS(t){return{isPseudoSurfaceNode:!0,type:"Decimal",span:t,val:"0"}}function OT(t,e){return{isPseudoSurfaceNode:!0,type:"Neg",span:e,args:[t]}}function p9(t,e){return{isPseudoSurfaceNode:!0,type:"Paren",span:e,args:[t]}}function Da(t,e){return __dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},t),{span:e})}function To(t,e){let r;switch(t.type){case"Add":{let o=To(t.args[0]),s=To(t.args[1]);if(dd(o))return Da(s,t.span);if(dd(s))return Da(o,t.span);let a;if(s.type==="Neg"?a=To(s.args[0]):s.type==="Paren"&&s.args[0].type==="Neg"&&(a=To(s.args[0].args[0])),a!==void 0)return{isPseudoSurfaceNode:!0,type:"Sub",span:t.span,args:[o,a]};r=[o,s];break}case"Sub":{let o=To(t.args[0]),s=To(t.args[1]);if(dd(o))return OT(s,t.span);if(dd(s))return Da(o,t.span);let a;if(s.type==="Neg"?a=s.args[0]:s.type==="Paren"&&s.args[0].type==="Neg"&&(a=s.args[0].args[0]),a)return{isPseudoSurfaceNode:!0,type:"Add",span:t.span,args:[o,a]};r=[o,s];break}case"Mul":{let o=To(t.args[0]),s=To(t.args[1]);if(ap(o))return Da(s,t.span);if(ap(s))return Da(o,t.span);if(dd(o)||dd(s))return LS(t.span);r=[o,s];break}case"Juxt":{let o=To(t.args[0],t),s=To(t.args[1],t);if(ap(o))return Da(s,t.span);if(ap(s))return Da(o,t.span);if(g3(o))return OT(s,t.span);if(dd(o)||dd(s))return LS(t.span);if(o.type==="Neg"){let a=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},t),{type:"Juxt",isPseudoSurfaceNode:!0,args:[o.args[0],s]});return OT(a,t.span)}r=[o,s];break}case"Frac":case"Div":{let o=To(t.args[0]),s=To(t.args[1]);if(ap(s))return Da(o,t.span);r=[o,s];break}case"Superscript":let i=To(t.args[0]),n=To(t.args[1]);if(ap(n))return Da(i,t.span);(e==null?void 0:e.type)==="Juxt"&&e.args[0].type==="Decimal"&&i.type==="Decimal"&&(i=p9(i,i.span)),r=[i,n];break;case"Paren":{let o=To(t.args[0]);if((e==null?void 0:e.type)!=="Juxt"){if(__dcg_shared_module_exports__['$b'](o))return Da(o,t.span);let s="args"in o?o.args:void 0;if((!s||s.length<=1)&&o.type!=="Neg")return Da(o,t.span)}r=[o];break}case"Pos":{let o=To(t.args[0]);return Da(o,t.span)}case"Neg":{let o=To(t.args[0]),s="args"in o?o.args[0]:void 0;if(o.type==="Paren"&&s&&s.type==="Neg"&&s.args[0])return Da(To(s.args[0]),t.span);if(o.type==="Neg"&&s)return Da(s,t.span);r=[o];break}case"Cmd":case"Letter":case"Decimal":case"MixedNumber":case"EmptyRangeEnd":case"EmptyPiecewise":case"InequalityChain":return __dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},t),{isPseudoSurfaceNode:!0});default:r=t.args.map(o=>h9(o)?o:o.type==="Alphanumeric"?__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},o),{isPseudoSurfaceNode:!0}):To(o))}return __dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},t),{isPseudoSurfaceNode:!0,args:r})}function u9(t,e){return t==null&&(t=""),__dcg_shared_module_exports__['fc'](t,e)}function g9(t){if(t!=null)try{let e=__dcg_shared_module_exports__['_b'](t);return __dcg_shared_module_exports__['ec'](e)}catch(e){let r=e instanceof m3.Base?e.getInputSpan():void 0;r||(r=__dcg_shared_module_exports__['Pa'](t,0,t.length));let i=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},__dcg_shared_module_exports__['bc']()),{originalError:e});return __dcg_shared_module_exports__['ac'](r,i)}}var m9={parse:u9},_T={parse:g9},f9={countNumbers:Mm},y9=__dcg_shared_module_exports__['bd'],b9=__dcg_shared_module_exports__['Mb'],w9=__dcg_shared_module_exports__['zb'],m3=__dcg_shared_module_exports__['Pb'],x9={graphing:new __dcg_shared_module_exports__['nc']({enableGeometry:!1,enable3d:!1,beta3d:!1,scales:void 0}),scientific:new __dcg_shared_module_exports__['ad']({singleExpression:!1}),fourFunction:new __dcg_shared_module_exports__['$c']({singleExpression:!1})},v9=hm,C9=mm;var{Switch:f3,For:D9}=de.Components,qr=class extends de.Class{template(){return de.createElement(f3,{key:()=>this.getLatex().indexOf("\\token")>=0},e=>e?de.createElement(td,{identifier:()=>this.getIdentifier(),insideMQ:()=>!1,controller:()=>this.props.controller(),insideGroup:()=>!1,putInTabOrder:()=>!1}):de.createElement("span",null,de.createElement(et,{config:this.const({}),latex:()=>this.getLatex()})))}getLatex(){return this.props.latex()||"unknown"}getIdentifier(){let e=this.props.latex();return e?__dcg_shared_module_exports__['Lb'].latexToIdentifier(e):""}},Tm=class extends de.Class{init(){this.controller=this.props.controller()}call(){let e=this.getGeometry();return e&&e.call&&e.call.symbol}template(){return de.createElement(f3,{key:this.bindFn(this.getObjectType)},e=>{var r;switch(e){case"copy":return de.createElement("div",null,de.const("Copy of"),de.const(" "),de.createElement(qr,{controller:this.props.controller,latex:()=>{var i;return __dcg_shared_module_exports__['Lb'].geoParentToLatex((i=this.getGeometry())==null?void 0:i.assignmentRhsReference)}}));case"apply":return de.createElement("div",null,de.const("Transformation of"),de.const(" "),de.createElement(qr,{controller:this.props.controller,latex:()=>this.getParents()[1]}));case __dcg_shared_module_exports__['$a']:return de.createElement("div",null,()=>this.getParents().length===3?"Triangle":this.getParents().length===4?"Quadrilateral":"Polygon",de.const(" "),de.const("with vertices"),de.const(" "),de.createElement(D9,{each:()=>this.getParents(),key:(i,n)=>n},de.createElement("span",null,(i,n)=>de.createElement("span",null,()=>n>0?", ":"",()=>n===this.getParents().length-1?"and ":"",de.createElement(qr,{controller:this.props.controller,latex:()=>i})))));case __dcg_shared_module_exports__['Ta']:return this.call()==="intersection"?de.createElement("div",null,de.const("Intersection of"),de.const(" "),de.createElement(qr,{controller:this.props.controller,latex:()=>this.getParents()[0]}),de.const(" "),de.const("and"),de.const(" "),de.createElement(qr,{controller:this.props.controller,latex:()=>this.getParents()[1]})):this.call()==="glider"?de.createElement("div",null,de.const("Glider on"),de.const(" "),de.createElement(qr,{controller:this.props.controller,latex:()=>this.getParents()[0]})):this.call()==="midpoint"?de.createElement("div",null,de.const("Midpoint of"),de.const(" "),de.createElement(qr,{controller:this.props.controller,latex:()=>this.getParents()[0]})):de.createElement("div",null,de.const("Free Point"));case __dcg_shared_module_exports__['bb']:return this.getParents().length===1&&this.getGeometry()&&this.getGeometry().listAccess?de.createElement("div",null,de.const("Segment "),()=>this.getGeometry().listAccess,de.const(" of a"),de.const(" "),de.createElement(qr,{controller:this.props.controller,latex:()=>this.getParents()[0]})):de.createElement("div",null,de.const("Segment between"),de.const(" "),de.createElement(qr,{controller:this.props.controller,latex:()=>this.getParents()[0]}),de.const(" "),de.const("and"),de.const(" "),de.createElement(qr,{controller:this.props.controller,latex:()=>this.getParents()[1]}));case __dcg_shared_module_exports__['jb']:return de.createElement("div",null,de.const("Ray from"),de.const(" "),de.createElement(qr,{controller:this.props.controller,latex:()=>this.getParents()[0]}),de.const(" "),de.const("through"),de.const(" "),de.createElement(qr,{controller:this.props.controller,latex:()=>this.getParents()[1]}));case __dcg_shared_module_exports__['fb']:return de.createElement("div",null,de.const("Arc from"),de.const(" "),de.createElement(qr,{controller:this.props.controller,latex:()=>this.getParents()[0]}),de.const(" "),de.const("to"),de.const(" "),de.createElement(qr,{controller:this.props.controller,latex:()=>this.getParents()[2]}),de.const(" "),de.const("through"),de.const(" "),de.createElement(qr,{controller:this.props.controller,latex:()=>this.getParents()[1]}));case __dcg_shared_module_exports__['hb']:return this.call()==="parallel"?de.createElement("div",null,de.const("Parallel to"),de.const(" "),de.createElement(qr,{controller:this.props.controller,latex:()=>this.getParents()[0]}),de.const(" "),de.const("passing through"),de.const(" "),de.createElement(qr,{controller:this.props.controller,latex:()=>this.getParents()[1]})):this.call()==="perpendicular"?de.createElement("div",null,de.const("Perpendicuar to"),de.const(" "),de.createElement(qr,{controller:this.props.controller,latex:()=>this.getParents()[0]}),de.const(" "),de.const("passing through"),de.const(" "),de.createElement(qr,{controller:this.props.controller,latex:()=>this.getParents()[1]})):de.createElement("div",null,de.const("Line through"),de.const(" "),de.createElement(qr,{controller:this.props.controller,latex:()=>this.getParents()[0]}),de.const(" "),de.const("and"),de.const(" "),de.createElement(qr,{controller:this.props.controller,latex:()=>this.getParents()[1]}));case __dcg_shared_module_exports__['db']:return de.createElement("div",null,de.const("Circle from"),de.const(" "),de.createElement(qr,{controller:this.props.controller,latex:()=>this.getParents()[0]}),de.const(" "),de.const("through"),de.const(" "),de.createElement(qr,{controller:this.props.controller,latex:()=>this.getParents()[1]}));case __dcg_shared_module_exports__['lb']:case __dcg_shared_module_exports__['nb']:return this.getParents().length===1&&((r=this.getGeometry())!=null&&r.listAccess)?de.createElement("div",null,()=>e===__dcg_shared_module_exports__['nb']?"Directed ":"",de.const("Angle "),()=>{var i;return(i=this.getGeometry())==null?void 0:i.listAccess},de.const(" of"),de.const(" "),de.createElement(qr,{controller:this.props.controller,latex:()=>this.getParents()[0]})):de.createElement("div",null,()=>e===__dcg_shared_module_exports__['nb']?"Directed ":"",de.const("Angle at"),de.const(" "),de.createElement(qr,{controller:this.props.controller,latex:()=>this.getParents()[1]}),de.const(" "),de.const("from"),de.const(" "),de.createElement(qr,{controller:this.props.controller,latex:()=>this.getParents()[0]}),de.const(" "),de.const("to"),de.const(" "),de.createElement(qr,{controller:this.props.controller,latex:()=>this.getParents()[2]}));case __dcg_shared_module_exports__['pb']:case __dcg_shared_module_exports__['qb']:return this.call()==="translate"?de.createElement("div",null,de.const("Translate from"),de.const(" "),de.createElement(qr,{controller:this.props.controller,latex:()=>this.getParents()[0]}),de.const(" "),de.const("to"),de.const(" "),de.createElement(qr,{controller:this.props.controller,latex:()=>this.getParents()[1]})):this.call()==="reflect"?de.createElement("div",null,de.const("Reflect over"),de.const(" "),de.createElement(qr,{controller:this.props.controller,latex:()=>this.getParents()[0]})):this.call()==="dilate"?de.createElement("div",null,de.const("Dilate at"),de.const(" "),de.createElement(qr,{controller:this.props.controller,latex:()=>this.getParents()[0]}),de.const(" by "),de.createElement(qr,{controller:this.props.controller,latex:()=>this.getRawParentLatex(2)})):this.call()==="rotate"?de.createElement("div",null,de.const("Rotate around"),de.const(" "),de.createElement(qr,{controller:this.props.controller,latex:()=>this.getParents()[0]}),de.const(" by "),de.createElement(qr,{controller:this.props.controller,latex:()=>this.getRawParentLatex(2)+(this.controller.getGraphSettings().degreeMode?"\xB0":"")})):de.createElement("div",null,de.const("Unknown transformation: "),()=>this.call());default:return de.createElement("span",null,de.const("Object Description coming soon!"))}})}getParents(){let e=this.getGeometry();return!e||!e.call?[]:e&&e.call?e.call.parents.map(r=>__dcg_shared_module_exports__['Lb'].geoParentToLatex(r)):[]}getRawParentLatex(e){var s;var r=(s=this.props.model())==null?void 0:s.latex;if(!r)return"";let n=__dcg_shared_module_exports__['fc'](r)._expression;if(!n)return"";let o=n.args[e];return!o||!o.getInputString?"":o.getInputString()||""}getGeometry(){let e=this.props.model();if(e)return e.formula.geometry}isTransformationApply(e){var o,s;if(!e||!e.call||e.call.symbol!=="apply")return!1;let r=(o=e.call.parents[0])==null?void 0:o[0];if(r===void 0)return!1;let i=this.controller.getItemsByIdentifier(r);return i.length!==1?!1:((s=i[0].formula.typed_constant_value)==null?void 0:s.valueType)===__dcg_shared_module_exports__['pb']}getObjectType(){let e=this.getGeometry();return e!=null&&e.assignmentRhsReference?"copy":this.isTransformationApply(e)?"apply":e&&e.valueType}};var OS=__dcg_shared_module_exports__['i'](Z());var PS=class extends OS.Class{init(){this.controller=this.props.controller(),this.cacheSelectedColor()}template(){return OS.createElement(rs,{controller:this.props.controller,colorLatex:()=>this.colorLatex,selectedColor:()=>this.selectedColor,onColorSelected:this.bindFn(this.onColorSelected),onCustomColorSelected:this.bindFn(this.onCustomColorSelected),hideCustomColors:this.const(!1)})}onCustomColorSelected(e){this.controller.dispatch({type:"update-all-selected-items",update:{prop:"colorLatex",value:e}})}cacheSelectedColor(){let e=__dcg_shared_module_exports__['m'](this.controller.getAllSelectedItems(),r=>r.type==="expression");if(e.length===0){this.selectedColor="",this.colorLatex="";return}this.selectedColor=Zl(e[0]),this.colorLatex=e[0].colorLatex;for(let r=1;r<e.length;r++)if(this.selectedColor!==Zl(e[r])||this.colorLatex!==e[r].colorLatex){this.selectedColor="",this.colorLatex="";return}}willUpdate(){this.cacheSelectedColor()}onColorSelected(e){this.controller.dispatch({type:"update-all-selected-items",update:{prop:"color",value:e}})}getFirstSelectedExpression(){var e=this.controller.getAllSelectedItems();for(let r of e)if(r.type==="expression")return r}};var{If:Am}=Hr.Components,_S=class extends Hr.Class{init(){this.controller=this.props.controller(),this.cacheSectionValues()}willUpdate(){this.cacheSectionValues()}template(){return Hr.createElement("div",{class:()=>({"dcg-generic-options-menu":!0,"dcg-options-menu":!0,"dcg-multi-select-options-menu":!0}),role:Hr.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-narration-options-menu")},Hr.createElement("div",{class:Hr.const("dcg-options-menu-section")},Hr.createElement(Am,{predicate:()=>this.controller.getAllSelectedItems().length===1},()=>Hr.createElement("div",{class:Hr.const("dcg-selected-objects-header")},Hr.createElement(Tm,{controller:this.props.controller,model:()=>{let e=this.controller.getAllSelectedItems();if(e.length!==1)return;let r=e[0];if(!(!r||r.type!=="expression"))return r}}))),Hr.createElement("div",{class:Hr.const("dcg-multi-select-color-picker")},Hr.createElement(PS,{controller:this.props.controller})),Hr.createElement(Am,{predicate:()=>this.sectionValues.showPointLabels!==void 0},()=>Hr.createElement("div",{class:Hr.const("dcg-checkbox-section")},Hr.createElement(Dt,{checked:()=>!!this.sectionValues.showPointLabels,onChange:this.bindFn(this.onShowPointLabelChanged)},Hr.const("Label Points")))),Hr.createElement(Am,{predicate:()=>this.sectionValues.singleLabelableExpressionModel!==void 0},()=>Hr.createElement("div",{class:Hr.const("dcg-checkbox-section")},Hr.createElement(hu,{controller:this.props.controller,model:()=>this.sectionValues.singleLabelableExpressionModel,useSmartPointLabeling:()=>this.sectionValues.draggableFreePoint!==void 0}))),Hr.createElement(Am,{predicate:()=>this.sectionValues.draggableFreePoint!==void 0},()=>Hr.createElement("div",{class:Hr.const("dcg-checkbox-section")},Hr.createElement(Dt,{checked:()=>!!this.sectionValues.draggableFreePoint,onChange:this.bindFn(this.onDraggableFreePointChanged)},Hr.const("Draggable")))),Hr.createElement(Am,{predicate:()=>this.sectionValues.arrowMode!==void 0},()=>Hr.createElement("div",null,Hr.const("arrowMode: "),this.sectionValues.arrowMode)),Hr.createElement(Am,{predicate:()=>this.controller.getGraphSettings().config.expressions},()=>Hr.createElement(IS,{controller:this.props.controller}))))}onShowPointLabelChanged(){this.controller.dispatch({type:"toggle-label-for-all-selected-points"})}onDraggableFreePointChanged(e){this.controller.dispatch({type:"update-all-selected-items",update:{prop:"dragMode",value:e?"AUTO":"NONE"}})}cacheSectionValues(){this.sectionValues=this.computeSectionValues()}computeSectionValues(){var o;let e={showPointLabels:[],singleLabelableExpressionModel:[],draggableFreePoint:[],arrowMode:[]},r=this.controller.getAllSelectedItems();for(let s of r){if(s.type!=="expression")return{};let a=(o=s.formula.geometry)==null?void 0:o.valueType;if(a===void 0)return{};if(__dcg_shared_module_exports__['ub'](a)&&(a=__dcg_shared_module_exports__['vb'](a)),!__dcg_shared_module_exports__['wb'](a))return{};switch(a){case __dcg_shared_module_exports__['Ta']:e.showPointLabels.push(s.showLabel),e.singleLabelableExpressionModel.push(s),e.draggableFreePoint.push(s.dragMode!=="NONE");break;case __dcg_shared_module_exports__['$a']:break;case __dcg_shared_module_exports__['fb']:e.arrowMode.push(s.arrowMode);break;case __dcg_shared_module_exports__['db']:break;case __dcg_shared_module_exports__['hb']:break;case __dcg_shared_module_exports__['jb']:break;case __dcg_shared_module_exports__['bb']:e.singleLabelableExpressionModel.push(s),e.arrowMode.push(s.arrowMode);break;case __dcg_shared_module_exports__['lb']:case __dcg_shared_module_exports__['nb']:e.singleLabelableExpressionModel.push(s);break;case __dcg_shared_module_exports__['pb']:break;default:return a}}let i={},n=r.length;for(let s in e){let a=s;switch(a){case"singleLabelableExpressionModel":{let c=e[a];n===1&&c.length===1&&(i[a]=c[0])}break;case"showPointLabels":{let c=e[a];c.length>0&&n>1&&(i[a]=__dcg_shared_module_exports__['n'](c,d=>!!d))}break;case"draggableFreePoint":{let c=e[a];c.length===n&&(i[a]=__dcg_shared_module_exports__['o'](c))}break;case"arrowMode":break;default:return a}}return i}willUnmount(){me(this.controller.s("graphing-calculator-narration-options-menu-closed"))}didMount(){me(this.controller.s("graphing-calculator-narration-options-menu-open"))}};var xn=__dcg_shared_module_exports__['i'](Z());var{Each:y3,If:S9}=xn.Components,FS=class extends xn.Class{init(){this.controller=this.props.controller(),this.focusOrder=this.getTransformationFocusLocations(),this.cacheExistingTransformations()}willUpdate(){this.cacheExistingTransformations()}template(){return xn.createElement("div",{class:()=>({"dcg-generic-options-menu":!0,"dcg-options-menu":!0,"dcg-multi-select-transformations-menu":!0}),role:xn.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-narration-transformations-menu")},xn.createElement("div",{onKeydown:this.bindFn(this.handleKeydown),class:xn.const("dcg-new-transformations-container"),role:xn.const("toolbar"),"aria-label":()=>this.controller.s("graphing-calculator-label-new-transformation")},y3(this.getTransformations,{item:e=>xn.createElement("div",{class:xn.const("dcg-new-transformation"),role:xn.const("button"),tabindex:()=>this.getTransformations().indexOf(e)===0?0:-1,manageFocus:this.const(yt({controller:this.controller,location:{type:"geo-basic-tool",tool:e}})),onTap:r=>{this.controller.dispatch({type:"select-geo-tool",tool:e}),r.device==="keyboard"&&this.controller.dispatch({type:"set-focus-location",location:{type:"graph-paper"}})}},xn.createElement("i",{class:()=>this.getTransformationIcon(e)}),()=>this.getTransformationName(e))})),xn.createElement(S9,{predicate:()=>this.cachedExistingTransformations.length>0},()=>xn.createElement("div",{class:xn.const("dcg-transformation-header")},()=>this.controller.s("graphing-calculator-label-recent-transformations"))),xn.createElement("div",{role:xn.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-label-recent-transformations")},y3(()=>this.cachedExistingTransformations,{item:e=>xn.createElement("div",{class:xn.const("dcg-existing-transformation"),role:xn.const("button"),tabindex:xn.const("0"),onTap:()=>this.applyTransformation(e),onPointerOut:r=>this.onPointerOut(r,e),onPointerOver:r=>this.onPointerOver(r,e),willUnmount:()=>this.onImplicitMouseOut(e)},xn.createElement(Tm,{controller:this.props.controller,model:()=>e})),key:e=>e.id})))}willUnmount(){me(this.controller.s("graphing-calculator-narration-options-menu-closed"))}didMount(){me(this.controller.s("graphing-calculator-narration-options-menu-open"))}handleKeydown(e){let r=Te(e);if(e.altKey||e.ctrlKey||e.metaKey||e.shiftKey||r!=="Left"&&r!=="Right"&&r!=="Home"&&r!=="End")return;let i=this.controller.getFocusLocation();if(!i)return;let n=__dcg_shared_module_exports__['y'](this.focusOrder,i);if(n===-1)return;e.preventDefault(),e.stopPropagation();let o=n;r==="Left"?o=Math.max(0,n-1):r==="Right"?o=Math.min(this.focusOrder.length-1,n+1):r==="Home"?o=0:r==="End"&&(o=this.focusOrder.length-1),o!==n&&this.controller.dispatch({type:"set-focus-location",location:this.focusOrder[o]})}computeExistingTransformations(){var r;let e=[];for(let i of this.controller.getAllItemModels()){if(i.type!=="expression"||!this.controller.isItemInGeoFolder(i.id))continue;let n=(r=i.formula.geometry)==null?void 0:r.call;n&&__dcg_shared_module_exports__['gc'](n.symbol)&&e.push(i)}return e.reverse()}cacheExistingTransformations(){this.cachedExistingTransformations=this.computeExistingTransformations()}getTransformations(){return["translate","reflect","dilate","rotate"]}getTransformationIcon(e){switch(e){case"dilate":return"dcg-icon-dilation";case"reflect":return"dcg-icon-reflection";case"rotate":return"dcg-icon-rotation";case"translate":return"dcg-icon-translation"}}getTransformationName(e){switch(e){case"dilate":return this.controller.s("graphing-calculator-text-geometry-tool-dilate-display-name");case"reflect":return this.controller.s("graphing-calculator-text-geometry-tool-reflect-display-name");case"rotate":return this.controller.s("graphing-calculator-text-geometry-tool-rotate-display-name");case"translate":return this.controller.s("graphing-calculator-text-geometry-tool-translate-display-name")}}getTransformationFocusLocations(){let e=[];return this.getTransformations().forEach(r=>{e.push({type:"geo-basic-tool",tool:r})}),e}onPointerOver(e,r){var n;if(e.pointerType!=="mouse")return;let i=(n=hs(r))==null?void 0:n.identifier;i&&(this.currentlyActiveTokenIdentifier=i,this.controller.dispatch({type:"set-active-token",identifier:this.currentlyActiveTokenIdentifier,style:"hovered"}))}onPointerOut(e,r){var n;if(e.pointerType!=="mouse")return;let i=(n=hs(r))==null?void 0:n.identifier;i&&this.currentlyActiveTokenIdentifier&&this.currentlyActiveTokenIdentifier===i&&(this.controller.dispatch({type:"unset-active-token",identifier:this.currentlyActiveTokenIdentifier,style:"hovered"}),this.currentlyActiveTokenIdentifier=void 0)}onImplicitMouseOut(e){var i;let r=(i=hs(e))==null?void 0:i.identifier;r&&this.currentlyActiveTokenIdentifier&&this.currentlyActiveTokenIdentifier===r&&this.controller.runAfterDispatch(()=>{let n=this.currentlyActiveTokenIdentifier;n&&(this.currentlyActiveTokenIdentifier=void 0,this.controller.dispatch({type:"unset-active-token",identifier:n,style:"hovered"}))})}applyTransformation(e){var i;if(!((i=e.formula.geometry)!=null&&i.identifier))return;let r=__dcg_shared_module_exports__['Hb'](e.formula.geometry.identifier);this.controller.dispatch({type:"apply-transformation-to-selected",assignmentLatex:r})}};var Ys=__dcg_shared_module_exports__['i'](Z());var{For:E9}=Ys.Components,RS=class extends Ys.Class{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return Ys.createElement("div",{class:()=>({"dcg-table-column-menu":!0,"dcg-options-menu":!0}),role:Ys.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-narration-options-menu"),didMount:()=>{me(this.controller.s("graphing-calculator-narration-options-menu-open"))},didUnmount:()=>{me(this.controller.s("graphing-calculator-narration-options-menu-closed"))}},Ys.createElement(E9,{each:this.bindFn(this.getSections)},Ys.createElement("div",null,e=>{switch(e){case"points":return Ys.createElement(km,__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.props),{isOpen:()=>this.isSectionOpen("points"),isFirstOpenSection:()=>this.isFirstOpenSection("points")}));case"drag":return Ys.createElement(Vm,__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.props),{isOpen:()=>this.isSectionOpen("drag"),isFirstOpenSection:()=>this.isFirstOpenSection("drag")}));case"lines":return Ys.createElement(Dm,__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.props),{isOpen:()=>this.isSectionOpen("lines"),isFirstOpenSection:()=>this.isFirstOpenSection("lines")}))}})),Ys.createElement("div",{class:Ys.const("dcg-triangle")}))}getSections(){return this.model.draggable&&!this.controller.isThreeDMode()?["points","lines","drag"]:["points","lines"]}isFirstOpenSection(e){let r=this.getSections();for(let i of r){if(i===e)return this.isSectionOpen(e);if(this.isSectionOpen(i))return!1}return!1}isSectionOpen(e){switch(e){case"drag":return this.model.dragMode!=="NONE";case"lines":return!!this.model.lines;case"points":return!!this.model.points}}};var cr=__dcg_shared_module_exports__['i'](Z());var{For:k9,If:RT,Textarea:G9}=cr.Components,NS=class extends cr.Class{template(){return this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id,cr.createElement("div",{class:cr.const("dcg-image-options-menu dcg-options-menu")},cr.createElement("div",{class:cr.const("dcg-triangle")}),cr.createElement("div",{class:cr.const("dcg-opacities-menu dcg-dividing-line-after")},cr.createElement("div",{role:cr.const("heading"),"aria-level":cr.const("2"),class:cr.const("dcg-title")},()=>this.controller.s("graphing-calculator-heading-image-opacity")),cr.createElement(k9,{each:()=>this.controller.getImageOpacities()},cr.createElement("div",{class:cr.const("dcg-opacities-menu-flex"),role:cr.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-heading-image-opacity")},e=>cr.createElement("span",{class:cr.const("dcg-opacity-option"),role:cr.const("button"),tabindex:cr.const(0),"aria-label":()=>`opacity: ${e}`,"aria-pressed":()=>this.isOpacitySelected(e),handleevent:cr.const("true"),onTap:()=>this.onSelectOpacity(e)},cr.createElement(cn,{backgroundImage:this.bindFn(this.getBackgroundImage),iconType:()=>this.isOpacitySelected(e)?"check":"none",backgroundOpacity:()=>parseFloat(e)}))))),cr.createElement("div",{class:cr.const("dcg-styles-div dcg-options-menu-section")},cr.createElement("div",{class:cr.const("dcg-styles-menu"),role:cr.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-narration-image-styles")},cr.createElement(Dt,{checked:()=>!this.model.foreground,onChange:this.bindFn(this.onToggleForeground)},()=>this.controller.s("graphing-calculator-button-place-image-behind-graphs"))),cr.createElement(RT,{predicate:()=>this.shouldShowDraggableCheckbox()},()=>cr.createElement("div",{class:cr.const("dcg-draggable-checkbox-container")},cr.createElement(Dt,{checked:()=>jc(this.model),onChange:this.bindFn(this.onToggleDraggable)},()=>this.controller.s("graphing-calculator-button-draggable")))),cr.createElement(RT,{predicate:this.bindFn(this.shouldShowClickable)},()=>cr.createElement("div",{class:cr.const("dcg-clickable-image-controls")},cr.createElement(Sm,__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.props),{isOpen:()=>!!this.model.clickableInfo.enabled,isFirstOpenSection:this.const(!1)})))),cr.createElement(RT,{predicate:()=>jc(this.model)||!!this.model.clickableInfo.enabled},()=>cr.createElement(G9,{placeholder:()=>this.controller.s("graphing-calculator-text-add-screen-reader-label-placeholder"),value:()=>this.model.description,onInput:e=>this.controller.dispatch({type:"set-item-description",id:this.model.id,description:e})}))))}onToggleDraggable(){xg(this.model)?this.controller.dispatch({type:"set-image-draggable",id:this.id,draggable:!this.model.draggable}):this.makeDraggable()}onToggleForeground(e){this.controller.dispatch({type:"set-image-in-foreground",id:this.id,foreground:!e})}onSelectOpacity(e){this.controller.dispatch({type:"set-image-opacity",id:this.id,opacity:e})}isOpacitySelected(e){return this.model.opacity===e}getBackgroundImage(){return this.model.image_url===this.lastURL?this.lastEncodedURL:(this.lastURL=this.model.image_url,this.lastEncodedURL='url("'+aS(this.model.image_url)+'")',this.lastEncodedURL)}shouldShowClickable(){return this.controller.areActionsEnabled()}makeDraggable(){this.controller.dispatch({type:"convert-image-to-draggable",id:this.model.id})}shouldShowDraggableCheckbox(){if(this.controller.isThreeDMode())return!1;var e=xg(this.model);return e?PO(e):o_(this.model)}};var rn=__dcg_shared_module_exports__['i'](Z());var Ao=__dcg_shared_module_exports__['i'](Z());var BS=[.05,.1,.15,.2,.35,.5,.75,1,1.5,2,3.5,5,7.5,10,15,20],V9=__dcg_shared_module_exports__['s'](BS),I9=__dcg_shared_module_exports__['r'](BS),Gw=class extends Ao.Class{init(){this.controller=this.props.controller(),this.model=this.props.model()}template(){return Ao.createElement("div",{class:Ao.const("dcg-slider-speed-container dcg-do-not-blur"),handleEvent:Ao.const("true")},Ao.createElement("span",{class:()=>({"dcg-action-slower":!0,"dcg-disabled":this.isSlowerDisabled()}),onTap:()=>this.animateSlower(),role:Ao.const("button"),"aria-label":()=>this.getSlowerAriaLabel(),tabindex:()=>this.isSlowerDisabled()?-1:0,"aria-disabled":()=>this.isSlowerDisabled()},Ao.createElement("i",{class:Ao.const("dcg-icon-show"),"aria-hidden":Ao.const("true")})),Ao.createElement("span",{class:Ao.const("dcg-variable-speed")},this.bindFn(this.computeSpeed),Ao.const("x")),Ao.createElement("span",{class:()=>({"dcg-action-faster":!0,"dcg-disabled":this.isFasterDisabled()}),onTap:()=>this.animateFaster(),role:Ao.const("button"),"aria-label":()=>this.getFasterAriaLabel(),tabindex:()=>this.isFasterDisabled()?-1:0,"aria-disabled":()=>this.isFasterDisabled()},Ao.createElement("i",{class:Ao.const("dcg-icon-show"),"aria-hidden":Ao.const("true")})))}computeSpeed(){var e=__dcg_shared_module_exports__['Pc']/this.model.slider.animationPeriod;return e=Number(e.toFixed(3)),e}isSlowerDisabled(){return V9>=this.computeSpeed()}isFasterDisabled(){return I9<=this.computeSpeed()}animateSlower(){var e=this.computeSpeed(),r=__dcg_shared_module_exports__['m'](BS,function(i){return i<e});r.length!==0&&this.setPeriodFromSpeed(__dcg_shared_module_exports__['r'](r))}animateFaster(){var e=this.computeSpeed(),r=__dcg_shared_module_exports__['m'](BS,function(i){return i>e});r.length!==0&&this.setPeriodFromSpeed(__dcg_shared_module_exports__['s'](r))}setPeriodFromSpeed(e){var r=__dcg_shared_module_exports__['Pc']/e;this.controller.dispatch({type:"set-slider-animationperiod",id:this.model.id,animationPeriod:r}),me(this.controller.s("graphing-calculator-narration-slider-animating-at-speed",{speed:e+""}))}getSlowerAriaLabel(){return this.controller.s("graphing-calculator-narration-slider-animate-slower")}getFasterAriaLabel(){return this.controller.s("graphing-calculator-narration-slider-animate-faster")}};var KS=class extends rn.Class{init(){this.controller=this.props.controller(),this.model=this.props.model(),this.id=this.model.id}template(){return rn.createElement("div",{class:rn.const("dcg-slider-options-view dcg-options-menu")},rn.createElement("div",{class:rn.const("dcg-triangle")}),rn.createElement("div",{class:rn.const("dcg-slider-menu")},rn.createElement("div",{role:rn.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-heading-slider-animation-mode")},rn.createElement("div",{role:rn.const("heading"),"aria-level":rn.const("2"),class:rn.const("dcg-title")},()=>this.controller.s("graphing-calculator-heading-slider-animation-mode")),rn.createElement(jr,{ariaGroupLabel:()=>this.controller.s("graphing-calculator-heading-slider-animation-mode"),staticConfig:this.bindFn(this.getAnimationOptions),theme:this.const("mini")}))),rn.createElement("div",{class:rn.const("dcg-slider-menu dcg-slider-speed-menu"),role:rn.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-heading-slider-speed")},rn.createElement("div",{role:rn.const("heading"),"aria-level":rn.const("2"),class:rn.const("dcg-title")},()=>this.controller.s("graphing-calculator-heading-slider-speed")),rn.createElement("div",{class:rn.const("dcg-slider-speed-container")},rn.createElement(Gw,__dcg_shared_module_exports__['b']({},this.props)))))}getAnimationOptions(){return["LOOP_FORWARD_REVERSE","LOOP_FORWARD","PLAY_ONCE","PLAY_INDEFINITELY"].map((r,i)=>({key:r,icon:()=>__dcg_shared_module_exports__['Oa'](r),tooltip:()=>this.getTooltip(r),tooltipGravity:()=>i===0?"se":"s",selected:()=>this.isSelected(r),onSelect:()=>{this.props.controller().dispatch({type:"set-slider-loopmode",id:this.props.model().id,loopMode:r})}}))}getTooltip(e){let r=this.controller.s;switch(e){case"LOOP_FORWARD_REVERSE":return r("graphing-calculator-narration-slider-loop-forwards-and-backwards");case"LOOP_FORWARD":return r("graphing-calculator-narration-slider-repeat-one-direction");case"PLAY_ONCE":return r("graphing-calculator-narration-slider-play-once");case"PLAY_INDEFINITELY":return r("graphing-calculator-narration-slider-play-indefinitely")}}isSelected(e){return this.model.slider.loopMode===e}};var xr=__dcg_shared_module_exports__['i'](Z());var qS=__dcg_shared_module_exports__['i'](Z());function b3(t){return t.uncommitted?"#ccc":!t.selected&&!t.hovered&&w3(t)===1?__dcg_shared_module_exports__['R'](t.color,.2):t.color}function w3(t){let e=.6;return t.hidden?t.selected?e=.4:e=.25:t.selected||t.isPoint?e=1:t.hovered&&(e=.8),t.isTransparentObject&&(e*=.3),e}function M9(t){return t.hidden?t.isPoint?0:t.selected?.3:.2:t.selected||t.isPoint||t.hovered?1:.7}function x3(t,e){if(t=t.replace(/#/,""),t.length===3)var r=parseInt(t.slice(0,1)+t.slice(0,1),16),i=parseInt(t.slice(1,2)+t.slice(1,2),16),n=parseInt(t.slice(2,3)+t.slice(2,3),16);else if(t.length===6)var r=parseInt(t.slice(0,2),16),i=parseInt(t.slice(2,4),16),n=parseInt(t.slice(4,6),16);else var r=0,i=0,n=0;return`rgba(${r}, ${i}, ${n}, ${e})`}function Vw(t){return x3(b3(t),M9(t))}function US(t){return x3(b3(t),w3(t))}function C3(t,e,r){t.save();for(let i of r)switch(i.type){case"point":{let n;!i.color||i.color==="dark"?n=US({isPoint:!0,color:e.point,uncommitted:!1,featured:!1,hidden:!1,hovered:!1,projectorMode:!1}):i.color==="light"?n=__dcg_shared_module_exports__['R'](e.point,.7):n=i.color;let o;switch(i.size){case"small":o=5;break;case"large":o=10;break;case"medium":default:o=5;break}i.hollow?(t.lineWidth=2,t.strokeStyle=n,t.beginPath(),t.arc(i.x,i.y,o-1,0,2*Math.PI),t.stroke()):(t.fillStyle=n,t.beginPath(),t.arc(i.x,i.y,o,0,2*Math.PI),t.fill())}break;case"circle":{let n;!i.color||i.color==="dark"?n=Vw({isPoint:!1,color:e.circle,uncommitted:!1,featured:!1,hidden:!1,hovered:!1,projectorMode:!1}):i.color==="light"?n=__dcg_shared_module_exports__['R'](e.circle,.7):n=i.color;let o;switch(i.lineWidth){case"small":o=2;break;case"large":o=7;break;case"medium":default:o=4;break}t.lineWidth=o,t.strokeStyle=n,t.beginPath(),t.arc(i.x,i.y,i.radius,0,2*Math.PI),t.stroke()}break;case"arc":{let n;!i.color||i.color==="dark"?n=Vw({isPoint:!1,color:e.circle,uncommitted:!1,featured:!1,hidden:!1,hovered:!1,projectorMode:!1}):i.color==="light"?n=__dcg_shared_module_exports__['R'](e.circle,.7):n=i.color;let o;switch(i.lineWidth){case"small":o=2;break;case"large":o=7;break;case"medium":default:o=4;break}t.lineWidth=o,t.strokeStyle=n,t.beginPath(),t.arc(i.x,i.y,i.radius,i.startAngle,i.endAngle),t.stroke()}break;case"stroked-path":{let n;!i.color||i.color==="dark"?n=Vw({isPoint:!1,color:e.line,uncommitted:!1,featured:!1,hidden:!1,hovered:!1,projectorMode:!1}):i.color==="light"?n=__dcg_shared_module_exports__['R'](e.line,.7):n=i.color;let o=i.path,s;switch(i.lineWidth){case"small":s=1;break;case"large":s=5;break;case"medium":default:s=3;break}t.lineCap="round",t.lineJoin="round",t.strokeStyle=n,t.lineWidth=s,t.beginPath(),t.moveTo(o[0],o[1]);for(let a=2;a<o.length;a+=2)t.lineTo(o[a],o[a+1]);if(i.arrow){let a=[],l=o.length-1;A9(a,o[l-3],o[l-2],o[l-1],o[l],s/2+9.5);for(let c=0;c<a.length;c+=2)t.lineTo(a[c],a[c+1])}t.stroke()}break;case"filled-polygon":{let n;i.color?n=i.color:n=US({isPoint:!1,color:e.polygon,uncommitted:!1,featured:!1,hidden:!1,hovered:!1,projectorMode:!1,isTransparentObject:!0});let o=i.path;t.fillStyle=n,t.beginPath(),t.moveTo(o[0],o[1]);for(let s=2;s<o.length;s+=2)t.lineTo(o[s],o[s+1]);t.fill()}break;case"angle":{let n=Vw({isPoint:!1,color:e.angle,uncommitted:!1,featured:!1,hidden:!1,hovered:!1,projectorMode:!1,isTransparentObject:!0}),o=US({isPoint:!1,color:e.angle,uncommitted:!1,featured:!1,hidden:!1,hovered:!1,projectorMode:!1,isTransparentObject:!0});T9(t,{type:"angle-indicator",lineWidth:4,strokeStyle:n,fillStyle:o,isRightAngle:!1,x:i.x,y:i.y,isDirected:i.isDirected,radius:i.radius,startAngle:i.startAngle,deltaAngle:i.deltaAngle})}break;default:return i}t.restore()}function T9(t,e){t.beginPath(),v3(t,e),t.lineTo(e.x,e.y),t.lineTo(e.x+e.radius*Math.cos(e.startAngle),e.y+e.radius*Math.sin(e.startAngle)),e.isDirected||(t.fillStyle=e.fillStyle,t.fill()),t.strokeStyle=e.strokeStyle,t.lineWidth=e.lineWidth,t.beginPath(),v3(t,e),t.stroke()}function v3(t,e){let r=e.startAngle+e.deltaAngle;if(e.isRightAngle){let i=e.radius*Math.cos(e.startAngle),n=e.radius*Math.cos(r),o=e.radius*Math.sin(e.startAngle),s=e.radius*Math.sin(r);t.moveTo(e.x+i,e.y+o),t.lineTo(e.x+i+n,e.y+o+s),t.lineTo(e.x+n,e.y+s)}else t.arc(e.x,e.y,e.radius,e.startAngle,r)}function A9(t,e,r,i,n,o=12){let s=Math.atan2(n-r,i-e),a=i-o*Math.cos(s-Math.PI/9),l=n-o*Math.sin(s-Math.PI/9),c=i-o*Math.cos(s+Math.PI/9),d=n-o*Math.sin(s+Math.PI/9),u=i-(o-2)*Math.cos(s-Math.PI/18),p=n-(o-2)*Math.sin(s-Math.PI/18),g=i-(o-2)*Math.cos(s+Math.PI/18),b=n-(o-2)*Math.sin(s+Math.PI/18);t.push(a,l,c,d,i,n,u,p,g,b,i,n)}var Lm=class extends qS.Class{template(){return qS.createElement("canvas",{didMount:this.bindFn(this.didMountCanvas),width:()=>this.props.width(),height:()=>this.props.height(),style:()=>({width:this.props.width()/2+"px",height:this.props.height()/2+"px"})})}didMountCanvas(e){this.canvas=e,this.redraw()}didUpdate(){this.redraw()}redraw(){let e=this.props.instructions()||[],r=this.props.model().getNonObjectsState().ui.colors;if(__dcg_shared_module_exports__['F'](e,this.lastInstructions)&&__dcg_shared_module_exports__['F'](r,this.lastColors))return;this.lastInstructions=e,this.lastColors=r;let i=this.canvas.getContext("2d");i.clearRect(0,0,i.canvas.width,i.canvas.height),C3(i,r,e)}};Oe();var{If:L9,For:D3}=xr.Components,HS=class extends xr.Class{init(){this.controller=this.props.controller(),this.geoModel=this.controller.getGeoModel()}template(){return xr.createElement("div",{role:xr.const("toolbar"),"aria-label":()=>this.controller.s("graphing-calculator-label-geometry-tools"),class:xr.const("dcg-geo-basic-tools dcg-animate-in-after-initial-load")},xr.createElement(D3,{each:()=>this.controller.getGeoTools(),key:e=>e.key},xr.createElement("span",{class:xr.const("dcg-icon-row")},e=>xr.createElement("span",{class:()=>({"dcg-icon-container":!0,"dcg-split-btn":!!e.dropdown,"dcg-selected":this.selectedTool()===e.key}),"dcg-geo-tool":this.const(e.key),onKeydown:r=>this.handleToolbarKeydown(r,e)},xr.createElement("span",{role:xr.const("button"),tabindex:()=>this.selectedTool()===e.key?0:-1,"aria-label":()=>this.geoModel.getDisplayNameForTool(e.key),"aria-haspopup":()=>!!e.dropdown,"aria-pressed":()=>this.selectedTool()===e.key,class:()=>({"dcg-basic-tool-btn":!0,"dcg-icon":!0}),onTap:r=>this.chooseTool(r,e),onLongHold:r=>this.openMenuFromLongHold(r,e),manageFocus:this.const(yt({controller:this.controller,location:{type:"geo-basic-tool",tool:e.key}}))},xr.createElement(Lm,{model:()=>this.geoModel,width:this.const(100),height:this.const(100),instructions:()=>this.geoModel.getIconInstructionsForTool(e.key)})),xr.createElement(L9,{predicate:()=>!!e.dropdown},()=>xr.createElement(NT,{geoModel:()=>this.geoModel,spec:()=>e,controller:this.props.controller}))))))}handleToolbarKeydown(e,r){let i=Te(e);if(i!=="Up"&&i!=="Down"&&i!=="Left"&&i!=="Right"&&i!=="Home"&&i!=="End")return;e.preventDefault(),e.stopPropagation();let n=this.controller.getFocusLocation();if(!n)return;let o,s=this.controller.getGeoTools(),a=s.indexOf(r),l=s[a];if(!l)return;let c=l.dropdown||[],d;if(i==="Home")d=s[0],o={type:"geo-basic-tool",tool:d.key},this.controller.dispatch({type:"select-geo-tool",tool:d.key});else if(i==="End")d=s[s.length-1],o={type:"geo-basic-tool",tool:d.key},this.controller.dispatch({type:"select-geo-tool",tool:d.key});else if(i==="Left")n.type==="geo-basic-tool-dropdown"&&c.length>0?o={type:"geo-basic-tool",tool:r.key}:a>0&&(d=s[Math.max(0,a-1)],o={type:"geo-basic-tool",tool:d.key},this.controller.dispatch({type:"select-geo-tool",tool:d.key}));else if(i==="Right"&&a<s.length-1)d=s[Math.min(a+1,s.length-1)],o={type:"geo-basic-tool",tool:d.key},this.controller.dispatch({type:"select-geo-tool",tool:d.key});else if(c.length>0){let u=c.indexOf(l.key);if(u===-1)return;let p;i==="Up"?p=c[Math.max(0,u-1)]:i==="Down"&&(p=c[Math.min(u+1,c.length-1)]),p&&(this.controller.dispatch({type:"select-geo-tool",tool:p}),o={type:"geo-basic-tool",tool:p})}o&&this.controller.dispatch({type:"set-focus-location",location:o})}selectedTool(){let e=this.controller.getActiveTool();return e==="expression-edit"?"selection":e}openDropdownMenu(e,r){r.dropdown&&this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"geo-tool-dropdown",guid:"geo-dropdown-"+r.dropdown[0],tools:r.dropdown,focusFirstOption:e.device==="keyboard"}})}openMenuFromLongHold(e,r){this.controller.dispatch({type:"select-geo-tool",tool:r.key}),this.openDropdownMenu(e,r)}chooseTool(e,r){e.wasLongheld()||(this.controller.dispatch({type:"select-geo-tool",tool:r.key,focusGraphPaper:e.device==="keyboard"}),e.shiftKey&&this.openDropdownMenu(e,r))}},zS=class extends xr.Class{init(){this.controller=this.props.controller(),this.geoModel=this.controller.getGeoModel()}template(){return xr.createElement("div",{class:()=>({"dcg-options-menu":!0,"dcg-select-tools-dropdown":!0}),role:xr.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-narration-options-menu"),didMount:this.bindFn(this.didMountContainer)},xr.createElement("div",{class:xr.const("dcg-options-menu-section")},xr.createElement(D3,{each:()=>this.props.tools()},xr.createElement("div",null,e=>xr.createElement("div",{role:xr.const("button"),tabindex:xr.const("0"),"aria-pressed":()=>this.controller.getActiveTool()===e,onTap:r=>this.chooseTool({tool:e,focusIcon:r.device==="keyboard"}),class:()=>({"dcg-dropdown-tool":!0,"dcg-selected-tool":this.controller.getActiveTool()===e}),manageFocus:this.const(yt({controller:this.controller,location:{type:"geo-basic-tool-menu-item",tool:e}}))},xr.createElement(Lm,{model:()=>this.geoModel,width:this.const(100),height:this.const(100),instructions:()=>this.geoModel.getIconInstructionsForTool(e)}),xr.createElement("span",null,()=>this.geoModel.getDisplayNameForTool(e)))))))}chooseTool(e){let r=this.props.controller();r.dispatch({type:"select-geo-tool",tool:e.tool}),e.focusIcon&&r.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool-dropdown",tool:this.props.tools()[0]}})}willUnmount(){me(this.controller.s("graphing-calculator-narration-options-menu-closed"))}didMountContainer(e){this.$containerElt=I(e),me(this.controller.s("graphing-calculator-narration-options-menu-open"))}},NT=class extends xr.Class{init(){this.controller=this.props.controller(),this.geoModel=this.props.geoModel()}template(){return xr.createElement("span",{style:xr.const("position:relative;"),class:xr.const("dcg-tool-dropdown"),role:xr.const("button"),tabindex:xr.const("-1"),"aria-label":()=>this.controller.s("graphing-calculator-label-geometry-tool-options",{tool:this.geoModel.getDisplayNameForTool(this.props.spec().key)}),"aria-expanded":this.bindFn(this.getMenuOpen),onTap:this.bindFn(this.handleOnTap),manageFocus:this.const(yt({controller:this.props.controller(),location:{type:"geo-basic-tool-dropdown",tool:this.getPrimaryToolName()}})),"dcg-open-menu-guid":this.bindFn(this.getMenuGUID)},xr.createElement("span",{class:xr.const("dcg-dropdown-icon")},xr.createElement("i",{class:xr.const("dcg-icon-caret-down")})))}getMenuGUID(){var e=this.props.spec().dropdown||[];return"geo-dropdown-"+e[0]}getMenuOpen(){let e=this.controller.getOpenItemMenu();return e!==void 0&&e.type==="geo-tool-dropdown"&&e.guid===this.getMenuGUID()}handleOnTap(e){let{key:r,dropdown:i=[]}=this.props.spec(),n=e.device==="keyboard";this.controller.getActiveTool()!==r&&this.controller.dispatch({type:"select-geo-tool",tool:r}),this.controller.dispatch({type:"toggle-item-settings-menu",menu:{type:"geo-tool-dropdown",guid:this.getMenuGUID(),tools:i,focusFirstOption:n}})}getPrimaryToolName(){let e=this.props.spec().dropdown;return e!==void 0?e[0]:""}};var{Switch:P9}=Fi.Components,S3=':input, [role="textbox"], [tabindex="0"]:visible',$S=class extends Fi.Class{init(){this.controller=this.props.controller()}template(){return Fi.createElement(P9,{key:this.bindFn(this.getActiveGuid)},()=>{let e=this.controller.getOpenItemMenu();return this.registeredChildRepositionCb=void 0,e?e.type==="expression"?Fi.createElement("div",{class:Fi.const("dcg-options-menu-container"),didMount:this.bindFn(this.didMountView),didUnmount:this.bindFn(this.didUnmountView)},Fi.createElement(Im,{controller:this.props.controller,model:()=>e.model,registerRepositionCb:i=>{this.registeredChildRepositionCb=i}})):e.type==="image"?Fi.createElement("div",{class:Fi.const("dcg-options-menu-container"),didMount:this.bindFn(this.didMountView),didUnmount:this.bindFn(this.didUnmountView)},Fi.createElement(NS,{controller:this.props.controller,model:()=>e.model})):e.type==="table-column"?Fi.createElement("div",{class:Fi.const("dcg-options-menu-container"),didMount:this.bindFn(this.didMountView),didUnmount:this.bindFn(this.didUnmountView)},Fi.createElement(RS,{controller:this.props.controller,model:()=>e.model})):e.type==="slider"?Fi.createElement("div",{class:Fi.const("dcg-options-menu-container"),didMount:this.bindFn(this.didMountView),didUnmount:this.bindFn(this.didUnmountView)},Fi.createElement(KS,{controller:this.props.controller,model:()=>e.model})):e.type==="multi-select-more"?Fi.createElement("div",{class:Fi.const("dcg-options-menu-container"),didMount:this.bindFn(this.didMountView),didUnmount:this.bindFn(this.didUnmountView)},Fi.createElement(_S,{controller:this.props.controller,registerRepositionCb:i=>{this.registeredChildRepositionCb=i}})):e.type==="multi-select-transformations"?Fi.createElement("div",{class:Fi.const("dcg-options-menu-container"),didMount:this.bindFn(this.didMountView),didUnmount:this.bindFn(this.didUnmountView)},Fi.createElement(FS,{controller:this.props.controller,registerRepositionCb:i=>{this.registeredChildRepositionCb=i}})):e.type==="geo-tool-dropdown"?Fi.createElement("div",{class:Fi.const("dcg-options-menu-container"),didMount:this.bindFn(this.didMountView),didUnmount:this.bindFn(this.didUnmountView)},Fi.createElement(zS,{controller:this.props.controller,registerRepositionCb:i=>{this.registeredChildRepositionCb=i},tools:()=>e.tools})):e:Fi.createElement("span",null)})}getActiveGuid(){let e=this.controller.getOpenItemMenu();if(e)return e.guid}didMountView(e){this.guid=__dcg_shared_module_exports__['L']("dcg-item-settings-view"),this.openView=e,this.positionMenu(),this.moveFocusIfAppropriate(),I(document.body).on(`keydown.${this.guid}`,r=>{let i=Te(r);i===jn?(r.preventDefault(),r.stopPropagation(),this.focusMenuIcon(),this.hideOptions()):i==="Tab"&&!r.altKey&&!r.ctrlKey&&!r.metaKey&&(r.shiftKey?r.shiftKey&&(this.isIconModelFocused()?(r.preventDefault(),r.stopPropagation(),this.focusLastOption()):this.isFirstOptionViewFocused()?(r.preventDefault(),r.stopPropagation(),this.focusIcon()):this.focusAnywhere()):this.isIconModelFocused()?(r.preventDefault(),r.stopPropagation(),this.focusFirstOption()):this.isLastOptionViewFocused()?(r.preventDefault(),r.stopPropagation(),this.focusIcon()):this.focusAnywhere())}),requestAnimationFrame(()=>{var r;if(this.openView){let i=this.controller.getExppanelSelector();i&&((r=this.controller.getOpenMenuIcon())!=null&&r.closest(i).length)&&i.on("scroll."+this.guid,()=>{i.off("scroll."+this.guid),this.hideOptions()})}}),I(document.body).on(`dcg-tapstart.${this.guid}`,r=>{if(!this.openView)return;let i=I(r.target),n=this.controller.getOpenMenuIcon();if(!(n&&i.closest(n).length)){if(i.closest(this.openView).length){if(!i.is(S3))return;let{$first:o,$last:s}=this.getDOMTabStops();o!==void 0&&o.is(i)?this.focusFirstOption():s!==void 0&&s.is(i)?this.focusLastOption():!r.target.hasAttribute("dataLabelAttributeValue")&&r.target.getAttribute("dataLabelAttributeValue")!=="fill-opacity"&&this.focusAnywhere();return}i.closest(".dcg-keypad,.dcg-show-keypad-container").length||this.hideOptions()}})}didUnmountView(){I(document.body).off(`.${this.guid}`),this.openView=void 0}didUpdate(){this.positionMenu(),this.moveFocusIfAppropriate()}moveFocusIfAppropriate(){let{$first:e,$last:r}=this.getDOMTabStops();e===void 0||r===void 0||(this.shouldMoveFocusToFirstOption()?e.trigger("focus"):this.shouldMoveFocusToLastOption()&&r.trigger("focus"))}open(){return!!this.controller.getOpenItemMenu()}hideOptions(){if(!this.open())return;let e=this.controller.getFocusLocation(),r=this.controller.getOpenItemMenu();e&&r&&e.type==="expression-menu"&&"model"in r&&e.id===r.model.id&&this.controller.dispatch({type:"blur-focus-location",location:e}),this.controller.dispatch({type:"close-item-settings-menu"})}positionMenu(){let e=this.controller.getOpenMenuIcon();if(!e||!this.openView)return;var r=this.controller.find$(".dcg-container"),i=r[0].getBoundingClientRect();let n=e[0].getBoundingClientRect(),o={top:n.top-i.top,left:n.left-i.left},s=this.controller.computeMajorLayout(),a=s.list.top+s.list.height,l=s.keypad.top,d=Math.min(a,l)+i.top-n.top;I(this.openView).css({top:o.top+"px",left:o.left+"px",display:"block"}),this.registeredChildRepositionCb&&this.registeredChildRepositionCb(d)}focusMenuIcon(){let e=this.controller.getOpenItemMenu();if(e){if(e.type==="geo-tool-dropdown"){this.controller.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool-dropdown",tool:e.tools[0]}});return}else if(!("model"in e))return;this.controller.dispatch({type:"set-focus-location",location:{type:"expression-icon",id:e.model.id}})}}isIconModelFocused(){let e=this.controller.getOpenItemMenu();if(e===void 0)return!1;if(e.type==="slider")return this.controller.isFocusLocationFocused({type:"slider-animation-properties-icon",id:e.model.id});if(e.type==="image")return this.controller.isFocusLocationFocused({type:"image-icon",id:e.model.id});if(e.type==="table-column")return this.controller.isFocusLocationFocused({type:"table-icon",id:e.model.table.id,columnId:e.model.id});if(e.type==="geo-tool-dropdown")return this.controller.isFocusLocationFocused({type:"geo-basic-tool-dropdown",tool:e.tools[0]});if(e.type==="multi-select-more")return this.controller.isFocusLocationFocused({type:"multi-select-more-icon"});if(e.type==="multi-select-transformations")return this.controller.isFocusLocationFocused({type:"multi-select-transformations-icon"});var r=this.getModelForOpenMenu();if(r)return this.controller.isFocusLocationFocused({type:"expression-icon",id:r.id})}focusIcon(){this.controller.focusOpenMenuIcon()}isFirstOptionViewFocused(){let{$first:e}=this.getDOMTabStops();return e!==void 0&&e.is(":focus")}shouldMoveFocusToFirstOption(){let e=this.controller.getOpenItemMenu();if(e){if(e.type==="geo-tool-dropdown")return!this.isFirstOptionViewFocused()&&this.controller.isFocusLocationFocused({type:"geo-basic-tool-menu-item",tool:e.tools[0]});if(e.type==="multi-select-more"||e.type==="multi-select-transformations")return!this.isFirstOptionViewFocused()&&this.controller.isFocusLocationFocused({type:"generic-menu",where:"start"});var r=this.getModelForOpenMenu();if(r)return!this.isFirstOptionViewFocused()&&this.controller.isFocusLocationFocused({type:"expression-menu",id:r.id,location:"start"})}}focusFirstOption(){let e=this.controller.getOpenItemMenu();if(e){if(e.type==="geo-tool-dropdown"){this.controller.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool-menu-item",tool:e.tools[0]}});return}if(e.type==="multi-select-more"||e.type==="multi-select-transformations"){this.controller.dispatch({type:"set-focus-location",location:{type:"generic-menu",where:"start"}});return}var r=this.getModelForOpenMenu();r&&this.controller.dispatch({type:"set-focus-location",location:{type:"expression-menu",id:r.id,location:"start"}})}}isLastOptionViewFocused(){let{$last:e}=this.getDOMTabStops();return e!==void 0&&e.is(":focus")}getModelForOpenMenu(){let e=this.controller.getOpenItemMenu();if(e&&"model"in e)return e.model}shouldMoveFocusToLastOption(){let e=this.controller.getOpenItemMenu();if(e){if(e.type==="geo-tool-dropdown")return!this.isLastOptionViewFocused()&&this.controller.isFocusLocationFocused({type:"geo-basic-tool-menu-item",tool:e.tools[e.tools.length-1]});if(e.type==="multi-select-more"||e.type==="multi-select-transformations")return!this.isLastOptionViewFocused()&&this.controller.isFocusLocationFocused({type:"generic-menu",where:"end"});var r=this.getModelForOpenMenu();if(r)return!this.isLastOptionViewFocused()&&this.controller.isFocusLocationFocused({type:"expression-menu",id:r.id,location:"end"})}}focusLastOption(){let e=this.controller.getOpenItemMenu();if(e){if(e.type==="geo-tool-dropdown"){this.controller.dispatch({type:"set-focus-location",location:{type:"geo-basic-tool-menu-item",tool:e.tools[e.tools.length-1]}});return}if(e.type==="multi-select-more"||e.type==="multi-select-transformations"){this.controller.dispatch({type:"set-focus-location",location:{type:"generic-menu",where:"end"}});return}var r=this.getModelForOpenMenu();r&&this.controller.dispatch({type:"set-focus-location",location:{type:"expression-menu",id:r.id,location:"end"}})}}focusAnywhere(){let e=this.controller.getOpenItemMenu();if(e){if(e.type==="multi-select-more"||e.type==="multi-select-transformations"){this.controller.dispatch({type:"set-focus-location",location:{type:"generic-menu",where:"anywhere"}});return}var r=this.getModelForOpenMenu();r&&this.controller.dispatch({type:"set-focus-location",location:{type:"expression-menu",id:r.id,location:"anywhere"}})}}getDOMTabStops(){if(this.openView===void 0)return{};let r=I(this.openView).find(S3),i=r.first(),n=r.last();return{$first:i,$last:n}}};var jt=__dcg_shared_module_exports__['i'](Z());var E3=__dcg_shared_module_exports__['i'](Z()),ns=class extends E3.Class{init(){this.controller=this.props.controller(),this.dispatch=this.controller.dispatch,this.s=this.controller.s}};var Fm=__dcg_shared_module_exports__['i'](Z());var oh=__dcg_shared_module_exports__['i'](Z()),vr=class extends oh.Class{template(){return oh.createElement("div",{class:()=>({"dcg-keypad-btn-container":!0,"dcg-disabled":this.isDisabled()}),style:()=>({"flex-grow":this.getColSpan()})},oh.createElement("span",{role:oh.const("button"),class:this.bindFn(this.getClasses),"dcg-command":this.props.command,"aria-label":this.bindFn(this.getAriaLabel),"aria-disabled":this.bindFn(this.isDisabled),onTap:()=>{this.isDisabled()||this.props.onTap()}},oh.createElement("span",{class:oh.const("dcg-keypad-btn-content")},this.children)))}getClasses(){let e={"dcg-keypad-btn":!0,"dcg-keypad-btn-active":this.isActive()},r=this.props.style();switch(r){case"default":e["dcg-btn-light-on-gray"]=!0;break;case"highlight":e["dcg-btn-dark-on-gray"]=!0;break;case"popover":e["dcg-btn-light-gray"]=!0;break;case"blue":e["dcg-btn-short-blue"]=!0;break;case"tall-blue":e["dcg-btn-tall-blue"]=!0;break;default:return r}return e}isActive(){return this.props.active?this.props.active():!1}getAriaLabel(){return this.props.ariaLabel?this.props.ariaLabel():this.props.command()}getColSpan(){if(this.props.colspan)return this.props.colspan()}isDisabled(){return this.props.disabled&&this.props.disabled()}};var te=__dcg_shared_module_exports__['i'](Z()),{IfElse:V3,If:k3,Switch:O9}=te.Components;function Sr(t,e){return t===void 0?te.const(e):typeof t=="function"?t:te.const(t)}function Pm(t){return(e,r,i={},n)=>te.createElement(vr,{command:te.const(t.command||t.typedText||t.keys[0]),ariaLabel:()=>t.ariaLabelKey?n(t.ariaLabelKey):t.typedText||t.keys[0],colspan:Sr(i.colspan,1),style:()=>i.style||"default",onTap:()=>r({type:"keypad/type-text",text:t.typedText||t.keys[0]})},V3(()=>t.keys[0]==="{"||t.keys[0]==="[",{true:()=>te.createElement("span",{class:te.const("dcg-mq-math-mode"),style:te.const("font-size: 120%")},te.const(t.keys[0]),te.const("\xA0"),te.createElement("span",{style:te.const("color: #999")},te.const(t.keys[1]))),false:()=>te.createElement("span",{class:te.const("dcg-either-or-btn")},te.createElement(et,{config:te.const({}),latex:te.const(t.keys[0])}),te.createElement("span",{style:te.const("color: #999")},te.createElement(et,{config:te.const({}),latex:te.const(t.keys[1])})))}))}function Om(t){return(e,r,i={},n)=>te.createElement(vr,{command:te.const(t.command||t.typedText||t.keys[1]),ariaLabel:()=>t.ariaLabelKey?n(t.ariaLabelKey):t.typedText||t.keys[0],colspan:Sr(i.colspan,1),style:Sr(i.style,"default"),onTap:()=>r({type:"keypad/type-text",text:t.typedText||t.keys[1]})},V3(()=>t.keys[1]==="}"||t.keys[1]==="]",{true:()=>te.createElement("span",{class:te.const("dcg-mq-math-mode"),style:te.const("font-size: 120%")},te.createElement("span",{style:te.const("color: #999")},te.const(t.keys[0])),te.const("\xA0"),te.const(t.keys[1])),false:()=>te.createElement("span",null,te.createElement("span",{style:te.const("color: #999")},te.createElement(et,{config:te.const({}),latex:te.const(t.keys[0])})),te.createElement(et,{config:te.const({}),latex:te.const(t.keys[1])}))}))}function _9(t){return(e,r,i={},n)=>te.createElement(vr,{command:te.const(t.command),ariaLabel:()=>t.ariaLabelKey?n(t.ariaLabelKey):e,colspan:Sr(i.colspan,1),style:()=>i.style||"default",onTap:()=>{r({type:"keypad/audio-trace",command:t.command})}},te.createElement(k3,{predicate:te.const(t.iconClass!==void 0)},()=>te.createElement("span",{class:()=>({"dcg-button-icon":!0,"dcg-icon-only":t.contentKey===void 0})},te.createElement("i",{class:te.const(t.iconClass),"aria-hidden":te.const("true")}))),te.createElement(k3,{predicate:te.const(t.contentKey!==void 0)},()=>te.createElement("span",null,()=>n(t.contentKey)||e)))}function Ie(t){return(e,r,i={},n)=>te.createElement(vr,{command:te.const(t.command||e),ariaLabel:()=>t.ariaLabelKey?n(t.ariaLabelKey):e,colspan:Sr(i.colspan,1),style:()=>i.style||"default",onTap:()=>r({type:"keypad/type-text",text:t.typedText||e})},te.createElement(et,{config:te.const({}),latex:te.const(t.content||e)}))}function G3(t){return(e,r,i={},n)=>te.createElement(vr,{command:te.const(t.command||e),ariaLabel:()=>t.ariaLabelKey?n(t.ariaLabelKey):e,colspan:Sr(i.colspan,1),style:()=>i.style||"default",onTap:()=>r({type:"keypad/type-text",text:t.typedText||e})},te.createElement("span",{class:te.const("dcg-mq-math-mode")},te.const(t.content||e)))}function Be(t){return(e,r,i={},n)=>te.createElement(vr,{command:te.const(e),ariaLabel:()=>t.ariaLabelKey?n(t.ariaLabelKey):e,colspan:Sr(i.colspan,1),style:()=>i.style||"default",onTap:()=>r({type:"keypad/type-text",text:e+"("})},te.createElement(O9,{key:()=>e.match(/^[a-z]{2,}$/)},o=>o?te.createElement("span",{class:te.const("dcg-mq-math-mode dcg-static-mathquill-view")},te.createElement("span",{class:te.const("dcg-mq-root-block")},te.createElement("span",{class:te.const("dcg-mq-operator-name")},()=>e))):te.createElement(et,{config:te.const({}),latex:te.const(e)})))}function Ho(t){return(e,r,i={},n)=>te.createElement(vr,{command:te.const(t.command),ariaLabel:()=>t.ariaLabelKey?n(t.ariaLabelKey):t.command,colspan:Sr(i.colspan,1),style:()=>i.style||"default",onTap:()=>{r({type:"keypad/custom-command",command:t.command})}},te.createElement(et,{config:te.const({}),latex:te.const(t.content)}))}var F9={"{":G3({ariaLabelKey:"shared-calculator-narration-keypad-key-left-bracket"}),"}":G3({ariaLabelKey:"shared-calculator-narration-keypad-key-right-bracket"}),"(":Ie({ariaLabelKey:"shared-calculator-narration-keypad-key-left-paren"}),")":Ie({ariaLabelKey:"shared-calculator-narration-keypad-key-right-paren"}),sqrt:Ie({content:"\\sqrt{}",ariaLabelKey:"shared-calculator-narration-keypad-key-sqrt"}),"/":Ie({ariaLabelKey:"shared-calculator-narration-keypad-key-divide"}),division:Ie({content:"\xF7",typedText:"/",command:"/",ariaLabelKey:"shared-calculator-narration-keypad-key-divide"}),obelus:Ie({content:"\xF7",typedText:"\xF7",ariaLabelKey:"shared-calculator-narration-keypad-key-divide"}),"*":Ie({ariaLabelKey:"shared-calculator-narration-keypad-key-times"}),multiplication:Ie({content:"\xD7",typedText:"*",command:"*",ariaLabelKey:"shared-calculator-narration-keypad-key-times"}),"\xB1":Ie({ariaLabelKey:"shared-calculator-narration-keypad-plus-minus"}),"-":Ie({ariaLabelKey:"shared-calculator-narration-keypad-key-minus"}),"+":Ie({ariaLabelKey:"shared-calculator-narration-keypad-key-plus"}),".":Ie({ariaLabelKey:"shared-calculator-narration-keypad-key-decimal"}),ans:(t,e,r={},i)=>te.createElement(vr,{command:te.const(t),ariaLabel:()=>i("shared-calculator-narration-keypad-key-ans"),colspan:Sr(r.colspan,1),style:()=>r.style||"default",onTap:()=>e({type:"keypad/type-text",text:t})},te.const("ans")),enter:(t,e,r={},i)=>te.createElement(vr,{command:te.const(t),ariaLabel:()=>i("shared-calculator-narration-keypad-key-enter"),colspan:Sr(r.colspan,1),style:()=>r.style||"default",onTap:()=>e({type:"keypad/press-key",key:"Enter"})},te.createElement("i",{class:te.const("dcg-icon-arrow-enter"),"aria-hidden":te.const("true")})),shift:(t,e,r={},i)=>te.createElement(vr,{command:te.const(t),ariaLabel:()=>i("shared-calculator-narration-keypad-key-shift"),colspan:Sr(r.colspan,1),style:()=>r.style||"default",active:Sr(r.active,!1),onTap:()=>e({type:"keypad/shift"})},te.createElement("i",{class:te.const("dcg-icon-shift"),"aria-hidden":te.const("true")})),left:(t,e,r={},i)=>te.createElement(vr,{command:te.const(t),ariaLabel:()=>i("shared-calculator-narration-keypad-key-left-arrow"),colspan:Sr(r.colspan,1),style:()=>r.style||"default",onTap:()=>e({type:"keypad/press-key",key:"Left"})},te.createElement("i",{class:te.const("dcg-icon-arrow-left"),"aria-hidden":te.const("true")})),right:(t,e,r={},i)=>te.createElement(vr,{command:te.const(t),ariaLabel:()=>i("shared-calculator-narration-keypad-key-right-arrow"),colspan:Sr(r.colspan,1),style:()=>r.style||"default",onTap:()=>e({type:"keypad/press-key",key:"Right"})},te.createElement("i",{class:te.const("dcg-icon-arrow-right"),"aria-hidden":te.const("true")})),123:(t,e,r={},i)=>te.createElement(vr,{command:te.const(t),ariaLabel:()=>i("shared-calculator-narration-keypad-key-toggle-numbers"),colspan:Sr(r.colspan,1),style:()=>r.style||"default",onTap:()=>e({type:"keypad/123"})},te.const("1 2 3")),ABC:(t,e,r={},i)=>te.createElement(vr,{command:te.const(t),ariaLabel:()=>i("shared-calculator-narration-keypad-key-toggle-letters"),colspan:Sr(r.colspan,1),style:()=>r.style||"default",onTap:()=>e({type:"keypad/abc"})},te.const("A B C")),Audio:(t,e,r={},i)=>te.createElement(vr,{command:te.const(t),ariaLabel:()=>i("shared-calculator-narration-keypad-key-toggle-audio-trace"),colspan:Sr(r.colspan,1),style:()=>r.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"on"})},te.createElement("i",{class:te.const("dcg-icon-volume"),"aria-hidden":te.const("true")})),backspace:(t,e,r={},i)=>te.createElement(vr,{command:te.const(t),ariaLabel:()=>i("shared-calculator-narration-keypad-key-backspace"),colspan:Sr(r.colspan,1),style:()=>r.style||"default",onTap:()=>e({type:"keypad/press-key",key:"Backspace"})},te.createElement("i",{class:te.const("dcg-icon-delete"),"aria-hidden":te.const("true")})),pi:Ie({content:"\\pi",ariaLabelKey:"shared-calculator-narration-keypad-key-pi"}),alpha:Ie({content:"\\alpha",ariaLabelKey:"shared-calculator-narration-keypad-key-alpha"}),beta:Ie({content:"\\beta",ariaLabelKey:"shared-calculator-narration-keypad-key-beta"}),theta:Ie({content:"\\theta",ariaLabelKey:"shared-calculator-narration-keypad-key-theta"}),tau:Ie({content:"\\tau",ariaLabelKey:"shared-calculator-narration-keypad-key-tau"}),"a^2":Ho({command:"a^2",content:"a^2",ariaLabelKey:"shared-calculator-narration-keypad-key-squared"}),"a^3":Ho({command:"a^3",content:"a^3",ariaLabelKey:"shared-calculator-narration-keypad-key-cubed"}),"x^3":Ho({command:"a^3",content:"x^3",ariaLabelKey:"shared-calculator-narration-keypad-key-cubed"}),"a^b":Ie({content:"a^b",typedText:"^",ariaLabelKey:"shared-calculator-narration-keypad-key-superscript"}),a_b:Ie({content:"a_b",typedText:"_",ariaLabelKey:"shared-calculator-narration-keypad-key-subscript"}),"a/b":Ho({content:"\\frac{a}{b}",command:"a/b",ariaLabelKey:"shared-calculator-narration-keypad-key-fraction"}),"x^2":Ho({command:"a^2",content:"x^2",ariaLabelKey:"shared-calculator-narration-keypad-key-squared"}),"x^y":Ie({content:"x^y",typedText:"^",ariaLabelKey:"shared-calculator-narration-keypad-key-superscript"}),"x/y":Ie({content:"\\frac{x}{y}",typedText:"/",ariaLabelKey:"shared-calculator-narration-keypad-key-fraction"}),nthroot:Ho({command:"nthroot",content:"\\sqrt[n]{}",ariaLabelKey:"shared-calculator-narration-keypad-key-nthroot"}),ythroot:Ho({command:"nthroot",content:"\\sqrt[y]{}",ariaLabelKey:"shared-calculator-narration-keypad-key-ythroot"}),sin:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-sin"}),cos:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-cos"}),tan:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-tan"}),sec:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-sec"}),csc:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-csc"}),cot:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-cot"}),sinh:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-sinh"}),cosh:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-cosh"}),tanh:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-tanh"}),sech:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-csch"}),csch:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-csch"}),coth:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-coth"}),arcsin:Ho({command:"arcsin",content:"sin^{-1}",ariaLabelKey:"shared-calculator-narration-keypad-key-arcsin"}),arccos:Ho({command:"arccos",content:"cos^{-1}",ariaLabelKey:"shared-calculator-narration-keypad-key-arccos"}),arctan:Ho({command:"arctan",content:"tan^{-1}",ariaLabelKey:"shared-calculator-narration-keypad-key-arctan"}),arccsc:Ho({command:"arccsc",content:"csc^{-1}",ariaLabelKey:"shared-calculator-narration-keypad-key-arccsc"}),arcsec:Ho({command:"arcsec",content:"sec^{-1}",ariaLabelKey:"shared-calculator-narration-keypad-key-arcsec"}),arccot:Ho({command:"arccot",content:"cot^{-1}",ariaLabelKey:"shared-calculator-narration-keypad-key-arccot"}),"|a|":Ie({typedText:"|",ariaLabelKey:"shared-calculator-narration-keypad-key-abs"}),"|x|":Ie({typedText:"|",ariaLabelKey:"shared-calculator-narration-keypad-key-abs"}),ln:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-ln"}),midpoint:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-midpoint"}),segment:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-segment"}),line:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-line"}),ray:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-ray"}),parallel:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-parallel"}),perpendicular:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-perpendicular"}),circle:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-circle"}),arc:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-arc"}),angle:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-angle"}),directedangle:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-directed-angle"}),glider:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-glider"}),coterminal:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-coterminal"}),supplement:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-supplement"}),dilation:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-dilation"}),rotation:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-rotation"}),translation:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-translation"}),reflection:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-reflection"}),vertices:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-vertices"}),angles:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-angles"}),directedangles:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-directed-angles"}),segments:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-segments"}),radius:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-radius"}),center:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-center"}),intersection:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-intersection"}),area:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-area"}),perimeter:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-perimeter"}),log:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-log"}),quantile:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-quantile"}),quartile:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-quartile"}),var:Be({}),varp:Be({}),nCr:Be({}),loga:Ho({command:"loga",content:"log_a",ariaLabelKey:"shared-calculator-narration-keypad-key-loga"}),stdev:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-stdev"}),mad:Be({}),nPr:Be({}),total:Be({}),length:Be({}),for:Be({}),min:Be({}),max:Be({}),cov:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-cov"}),covp:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-covp"}),corr:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-corr"}),spearman:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-spearman"}),stats:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-stats"}),polygon:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-polygon"}),distance:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-distance"}),mean:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-mean"}),stdevp:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-stdevp"}),mod:Be({}),"e^x":Ie({typedText:"e^",ariaLabelKey:"shared-calculator-narration-keypad-key-exp"}),"10^n":Ie({content:"\\times10^{n}",typedText:"*10^",ariaLabelKey:"shared-calculator-narration-keypad-key-10-n"}),"a^{-1}":Ie({typedText:"^-1",ariaLabelKey:"shared-calculator-narration-keypad-key-reciprocal"}),sum:Ie({content:"\\sum",ariaLabelKey:"shared-calculator-narration-keypad-key-sum"}),prod:Ie({content:"\\prod",ariaLabelKey:"shared-calculator-narration-keypad-key-product"}),floor:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-floor"}),ceil:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-ceil"}),round:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-round"}),abs:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-abs"}),"!":Ie({ariaLabelKey:"shared-calculator-narration-keypad-key-factorial"}),"n!":Ie({typedText:"!",ariaLabelKey:"shared-calculator-narration-keypad-key-factorial"}),median:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-median"}),lcm:Be({}),gcd:Be({}),gcf:Be({}),ddx:Ho({command:"ddx",content:"\\frac{d}{dx}"}),integral:Ho({command:"integral",content:"\\int",ariaLabelKey:"shared-calculator-narration-keypad-key-int"}),"%":Ie({content:"\\%",ariaLabelKey:"shared-calculator-narration-keypad-key-percent-of"}),"->":Ie({content:"\\to",ariaLabelKey:"shared-calculator-narration-keypad-key-action-to"}),with:Ie({typedText:"with",content:"with",ariaLabelKey:"shared-calculator-narration-keypad-key-action-with"}),prime:Ie({typedText:"'",content:"f'",ariaLabelKey:"shared-calculator-narration-keypad-key-prime"}),exp:Ie({}),sign:Be({}),normaldist:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-normaldist"}),poissondist:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-poissondist"}),binomialdist:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-binomialdist"}),uniformdist:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-uniformdist"}),erf:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-erf"}),histogram:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-histogram"}),boxplot:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-boxplot"}),dotplot:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-dotplot"}),tscore:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-tscore"}),ittest:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-ittest"}),ttest:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-ttest"}),tdist:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-tdist"}),pdf:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-pdf"}),cdf:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-pdf"}),random:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-random"}),inversecdf:Be({ariaLabelKey:"shared-calculator-narration-keypad-key-inversecdf"}),hsv:Be({}),rgb:Be({}),sort:Be({}),shuffle:Be({}),unique:Be({}),join:Be({}),"A^-1":Ho({command:"A^-1",content:"A^{-1}",ariaLabelKey:"matrix-calculator-narration-keypad-key-inverse"}),"A^T":Ho({command:"A^T",content:"A^T",ariaLabelKey:"matrix-calculator-narration-keypad-key-transpose"}),"A^2":Ho({command:"A^2",content:"A^2",ariaLabelKey:"shared-calculator-narration-keypad-key-squared"}),"A^n":Ie({content:"A^n",typedText:"^",ariaLabelKey:"shared-calculator-narration-keypad-key-exp"}),det:Be({ariaLabelKey:"matrix-calculator-narration-keypad-key-det"}),trace:Be({ariaLabelKey:"matrix-calculator-narration-keypad-key-trace"}),rref:Be({ariaLabelKey:"matrix-calculator-narration-keypad-key-rref"}),a:Ie({}),b:Ie({}),c:Ie({}),d:Ie({}),e:Ie({}),f:Ie({}),g:Ie({}),h:Ie({}),i:Ie({}),j:Ie({}),k:Ie({}),l:Ie({}),m:Ie({}),n:Ie({}),o:Ie({}),p:Ie({}),q:Ie({}),r:Ie({}),s:Ie({}),t:Ie({}),u:Ie({}),v:Ie({}),w:Ie({}),x:Ie({}),boldX:Ie({content:"x",typedText:"x"}),y:Ie({}),boldY:Ie({content:"y",typedText:"y"}),z:Ie({}),A:Ie({}),B:Ie({}),C:Ie({}),D:Ie({}),E:Ie({}),F:Ie({}),G:Ie({}),H:Ie({}),I:Ie({}),J:Ie({}),K:Ie({}),L:Ie({}),M:Ie({}),N:Ie({}),O:Ie({}),P:Ie({}),Q:Ie({}),R:Ie({}),S:Ie({}),T:Ie({}),U:Ie({}),V:Ie({}),W:Ie({}),X:Ie({}),Y:Ie({}),Z:Ie({}),0:Ie({}),1:Ie({}),2:Ie({}),3:Ie({}),4:Ie({}),5:Ie({}),6:Ie({}),7:Ie({}),8:Ie({}),9:Ie({}),",":Ie({}),"=":Ie({}),"[":Ie({}),"]":Ie({}),"{}_left":Pm({keys:["{","}"]}),"{}_right":Om({keys:["{","}"]}),"()_left":Pm({keys:["(",")"]}),"()_right":Om({keys:["(",")"]}),"[]_left":Pm({keys:["[","]"]}),"[]_right":Om({keys:["[","]"]}),",'_left":Pm({keys:[",","\u2032"]}),",'_right":Om({keys:[",","\u2032"],typedText:"'"}),'"':Ie({}),"'":Ie({}),"~":Ie({}),":":Ie({}),">":Ie({}),"<":Ie({}),">=":Ie({content:"\\ge"}),"<=":Ie({content:"\\le"}),"!%_left":Pm({keys:["!","{}^{%}"]}),"!%_right":Om({keys:["!","{}^{%}"],typedText:"%"}),"~:_left":Pm({keys:["~","{}^{:}"]}),"~:_right":Om({keys:["~","{}^{:}"],typedText:":"}),"audio-trace-off":_9({contentKey:"graphing-calculator-button-keypad-audio-trace-off",command:"off"}),"hear-graph":(t,e,r={},i)=>te.createElement(vr,{command:te.const(t),disabled:Sr(r.disabled,!1),colspan:Sr(r.colspan,1),style:Sr(r.style,"blue"),onTap:()=>{e({type:"keypad/audio-trace",command:"hear-graph"})}},te.createElement("span",{class:te.const("dcg-play-icon-container")},te.createElement("i",{class:te.const("dcg-icon-play"),"aria-hidden":te.const("true")})),te.createElement("span",null,()=>i("graphing-calculator-button-audio-trace-hear-graph"))),"stop-graph":(t,e,r={},i)=>te.createElement(vr,{command:te.const(t),disabled:Sr(r.disabled,!1),colspan:Sr(r.colspan,1),style:Sr(r.style,"blue"),onTap:()=>{e({type:"keypad/audio-trace",command:"stop-graph"})}},te.createElement("span",{class:te.const("dcg-stop-icon-container")},te.createElement("span",{class:te.const("dcg-stop-icon")})),te.createElement("span",null,()=>i("graphing-calculator-button-audio-trace-stop-graph"))),"volume-down":(t,e,r={},i)=>te.createElement(vr,{command:te.const(t),ariaLabel:()=>i("graphing-calculator-narration-keypad-key-volume-down"),disabled:Sr(r.disabled,!1),style:()=>r.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"volume-down"})},te.createElement("span",{class:te.const("dcg-button-icon dcg-icon-only")},te.createElement("i",{class:te.const("dcg-icon-volume-down"),"aria-hidden":te.const("true")}))),"volume-up":(t,e,r={},i)=>te.createElement(vr,{command:te.const(t),ariaLabel:()=>i("graphing-calculator-narration-keypad-key-volume-up"),disabled:Sr(r.disabled,!1),style:()=>r.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"volume-up"})},te.createElement("span",{class:te.const("dcg-button-icon dcg-icon-only")},te.createElement("i",{class:te.const("dcg-icon-volume-up"),"aria-hidden":te.const("true")}))),"speed-down":(t,e,r={},i)=>te.createElement(vr,{command:te.const(t),ariaLabel:()=>i("graphing-calculator-narration-keypad-key-speed-down"),disabled:Sr(r.disabled,!1),style:()=>r.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"speed-down"})},te.createElement("span",{class:te.const("dcg-button-icon dcg-icon-only")},te.createElement("i",{class:te.const("dcg-icon-hide"),"aria-hidden":te.const("true")}))),"speed-up":(t,e,r={},i)=>te.createElement(vr,{command:te.const(t),ariaLabel:()=>i("graphing-calculator-narration-keypad-key-speed-up"),disabled:Sr(r.disabled,!1),style:()=>r.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"speed-up"})},te.createElement("span",{class:te.const("dcg-button-icon dcg-icon-only")},te.createElement("i",{class:te.const("dcg-icon-show"),"aria-hidden":te.const("true")}))),"previous-point":(t,e,r={},i)=>te.createElement(vr,{ariaLabel:()=>i("graphing-calculator-narration-keypad-key-previous-point"),command:te.const(t),disabled:Sr(r.disabled,!1),colspan:Sr(r.colspan,1),style:()=>r.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"previous-point"})},te.createElement("span",{class:te.const("dcg-button-icon dcg-icon-only")},te.createElement("i",{class:te.const("dcg-icon-thin-arrow-left"),"aria-hidden":te.const("true")}))),"next-point":(t,e,r={},i)=>te.createElement(vr,{ariaLabel:()=>i("graphing-calculator-narration-keypad-key-next-point"),command:te.const(t),disabled:Sr(r.disabled,!1),colspan:Sr(r.colspan,1),style:()=>r.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"next-point"})},te.createElement("span",{class:te.const("dcg-button-icon dcg-icon-only")},te.createElement("i",{class:te.const("dcg-icon-thin-arrow-right"),"aria-hidden":te.const("true")}))),"previous-poi":(t,e,r={},i)=>te.createElement(vr,{ariaLabel:()=>i("graphing-calculator-narration-keypad-key-previous-poi"),command:te.const(t),disabled:Sr(r.disabled,!1),colspan:Sr(r.colspan,1),style:()=>r.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"previous-poi"})},te.createElement("span",{class:te.const("dcg-button-icon dcg-icon-only")},te.createElement("i",{class:te.const("dcg-icon-hide"),"aria-hidden":te.const("true")}))),"next-poi":(t,e,r={},i)=>te.createElement(vr,{ariaLabel:()=>i("graphing-calculator-narration-keypad-key-next-poi"),command:te.const(t),disabled:Sr(r.disabled,!1),colspan:Sr(r.colspan,1),style:()=>r.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"next-poi"})},te.createElement("span",{class:te.const("dcg-button-icon dcg-icon-only")},te.createElement("i",{class:te.const("dcg-icon-show"),"aria-hidden":te.const("true")}))),"previous-curve":(t,e,r={},i)=>te.createElement(vr,{ariaLabel:()=>i("graphing-calculator-narration-keypad-key-previous-curve"),command:te.const(t),disabled:Sr(r.disabled,!1),colspan:Sr(r.colspan,1),style:()=>r.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"previous-curve"})},te.createElement("span",{class:te.const("dcg-button-icon dcg-icon-only")},te.createElement("i",{class:te.const("dcg-icon-caret-up"),"aria-hidden":te.const("true")}))),"next-curve":(t,e,r={},i)=>te.createElement(vr,{ariaLabel:()=>i("graphing-calculator-narration-keypad-key-next-curve"),command:te.const(t),disabled:Sr(r.disabled,!1),style:()=>r.style||"default",onTap:()=>e({type:"keypad/audio-trace",command:"next-curve"})},te.createElement("span",{class:te.const("dcg-button-icon dcg-icon-only")},te.createElement("i",{class:te.const("dcg-icon-caret-down"),"aria-hidden":te.const("true")})))};function C(t,e,r={}){let i=t.dispatch;return F9[e](e,i,r,t.s)}function Vi(t=1){return te.createElement("div",{style:te.const(`flex-grow:${t}`)})}var WS=__dcg_shared_module_exports__['i'](Z());var I3=__dcg_shared_module_exports__['i'](Z()),sh=class extends I3.Class{init(){this.controller=this.props.controller()}};var sr=class extends sh{template(){return WS.createElement("div",{class:WS.const("dcg-basic-keypad dcg-do-not-blur")},this.children)}};var _m=__dcg_shared_module_exports__['i'](Z()),Re=class extends _m.Class{template(){return _m.createElement("div",{class:_m.const("dcg-keypad-row")},this.children)}};var jS=class extends ns{template(){return Fm.createElement(sr,{controller:this.props.controller},Fm.createElement(Re,null,C(this,"q"),C(this,"w"),C(this,"e"),C(this,"r"),C(this,"t"),C(this,"y"),C(this,"u"),C(this,"i"),C(this,"o"),C(this,"p")),Fm.createElement(Re,null,C(this,"a"),C(this,"s"),C(this,"d"),C(this,"f"),C(this,"g"),C(this,"h"),C(this,"j"),C(this,"k"),C(this,"l"),C(this,"theta")),Fm.createElement(Re,null,C(this,"shift",{colspan:1.364,style:"highlight"}),Vi(.136),C(this,"z"),C(this,"x"),C(this,"c"),C(this,"v"),C(this,"b"),C(this,"n"),C(this,"m"),Vi(.136),C(this,"backspace",{colspan:1.364,style:"highlight"})),Fm.createElement(Re,null,C(this,"123",{colspan:1.818,style:"highlight"}),Vi(.182),C(this,"a_b"),C(this,"!%_left"),C(this,"[]_left"),C(this,"{}_left"),C(this,"~:_left"),C(this,",'_left"),Vi(.182),C(this,"enter",{colspan:1.818,style:"blue"})))}};var Rm=__dcg_shared_module_exports__['i'](Z());var JS=class extends ns{template(){return Rm.createElement(sr,{controller:this.props.controller},Rm.createElement(Re,null,C(this,"Q"),C(this,"W"),C(this,"E"),C(this,"R"),C(this,"T"),C(this,"Y"),C(this,"U"),C(this,"I"),C(this,"O"),C(this,"P")),Rm.createElement(Re,null,C(this,"A"),C(this,"S"),C(this,"D"),C(this,"F"),C(this,"G"),C(this,"H"),C(this,"J"),C(this,"K"),C(this,"L"),C(this,"tau")),Rm.createElement(Re,null,C(this,"shift",{colspan:1.364,active:!0,style:"highlight"}),Vi(.136),C(this,"Z"),C(this,"X"),C(this,"C"),C(this,"V"),C(this,"B"),C(this,"N"),C(this,"M"),Vi(.136),C(this,"backspace",{colspan:1.364,style:"highlight"})),Rm.createElement(Re,null,C(this,"123",{colspan:1.818,style:"highlight"}),Vi(.182),C(this,"a^b"),C(this,"!%_right"),C(this,"[]_right"),C(this,"{}_right"),C(this,"~:_right"),C(this,",'_right"),Vi(.182),C(this,"enter",{colspan:1.818,style:"blue"})))}};var vs=__dcg_shared_module_exports__['i'](Z());var YS=class extends ns{template(){return vs.createElement(sr,{controller:this.props.controller},vs.createElement(Re,null,C(this,"boldX"),C(this,"boldY"),C(this,"a^2"),C(this,"a^b"),Vi(.5),C(this,"7",{style:"highlight"}),C(this,"8",{style:"highlight"}),C(this,"9",{style:"highlight"}),C(this,"division"),Vi(.5),vs.createElement(vr,{command:this.const("functions"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-functions"),colspan:this.const(2),style:this.const("highlight"),active:()=>this.controller.isKeypadFunctionsPopoverOpen(),onTap:()=>this.dispatch({type:"keypad/functions"})},this.bindFn(this.getFuncsBtnText))),vs.createElement(Re,null,C(this,"("),C(this,")"),C(this,"<"),C(this,">"),Vi(.5),C(this,"4",{style:"highlight"}),C(this,"5",{style:"highlight"}),C(this,"6",{style:"highlight"}),C(this,"multiplication"),Vi(.5),C(this,"left",{style:"highlight"}),C(this,"right",{style:"highlight"})),vs.createElement(Re,null,C(this,"|a|"),C(this,","),C(this,"<="),C(this,">="),Vi(.5),C(this,"1",{style:"highlight"}),C(this,"2",{style:"highlight"}),C(this,"3",{style:"highlight"}),C(this,"-"),Vi(1),C(this,"backspace",{colspan:1.5,style:"highlight"})),vs.createElement(Re,null,vs.createElement("div",{class:vs.const("dcg-abc-audio-container")},vs.createElement(vr,{command:vs.const("ABC"),colspan:this.const(1),ariaLabel:()=>this.controller.s("graphing-calculator-narration-toggle-letters"),style:this.const("highlight"),onTap:()=>{this.dispatch({type:"keypad/abc"})}},()=>this.controller.getLayoutMeasurements().width<=600?this.controller.raw("ABC"):this.controller.raw("A B C")),vs.createElement(vr,{command:vs.const("Audio"),disabled:()=>!this.controller.canAudioTrace(),ariaLabel:()=>this.controller.s("graphing-calculator-narration-toggle-audio-trace"),colspan:this.const(1),style:()=>"highlight",onTap:()=>this.dispatch({type:"keypad/audio-trace",command:"on"})},vs.createElement("i",{class:vs.const("dcg-icon-volume"),"aria-hidden":vs.const("true")}))),C(this,"sqrt"),C(this,"pi"),Vi(.5),C(this,"0",{style:"highlight"}),C(this,".",{style:"highlight"}),C(this,"="),C(this,"+"),Vi(.5),C(this,"enter",{colspan:2,style:"blue"})))}getFuncsBtnText(){return this.controller.isNarrow()?this.controller.s("graphing-calculator-button-funcs"):this.controller.s("graphing-calculator-button-functions")}};var Nm=__dcg_shared_module_exports__['i'](Z());var XS=class extends ns{template(){return Nm.createElement(sr,{controller:this.props.controller},Nm.createElement(Re,null,C(this,"a"),C(this,"b"),C(this,"c"),C(this,"d"),C(this,"e"),C(this,"f"),C(this,"g"),C(this,"h"),C(this,"i"),C(this,"j")),Nm.createElement(Re,null,C(this,"k"),C(this,"l"),C(this,"m"),C(this,"n"),C(this,"o"),C(this,"p"),C(this,"q"),C(this,"r"),C(this,"s"),C(this,"t")),Nm.createElement(Re,null,C(this,"shift",{style:"highlight"}),C(this,"u"),C(this,"v"),C(this,"w"),C(this,"x"),C(this,"y"),C(this,"z"),C(this,"theta"),C(this,"backspace",{colspan:2,style:"highlight"})),Nm.createElement(Re,null,C(this,"123",{colspan:2,style:"highlight"}),C(this,"a_b"),C(this,"!%_left"),C(this,"[]_left"),C(this,"{}_left"),C(this,"~:_left"),C(this,",'_left"),C(this,"enter",{colspan:2,style:"blue"})))}};var Bm=__dcg_shared_module_exports__['i'](Z());var QS=class extends ns{template(){return Bm.createElement(sr,{controller:this.props.controller},Bm.createElement(Re,null,C(this,"A"),C(this,"B"),C(this,"C"),C(this,"D"),C(this,"E"),C(this,"F"),C(this,"G"),C(this,"H"),C(this,"I"),C(this,"J")),Bm.createElement(Re,null,C(this,"K"),C(this,"L"),C(this,"M"),C(this,"N"),C(this,"O"),C(this,"P"),C(this,"Q"),C(this,"R"),C(this,"S"),C(this,"T")),Bm.createElement(Re,null,C(this,"shift",{style:"highlight"}),C(this,"U"),C(this,"V"),C(this,"W"),C(this,"X"),C(this,"Y"),C(this,"Z"),C(this,"tau"),C(this,"backspace",{colspan:2,style:"highlight"})),Bm.createElement(Re,null,C(this,"123",{colspan:2,style:"highlight"}),C(this,"a^b"),C(this,"!%_right"),C(this,"[]_right"),C(this,"{}_right"),C(this,"~:_right"),C(this,",'_right"),C(this,"enter",{colspan:2,style:"blue"})))}};var je=__dcg_shared_module_exports__['i'](Z());var{IfElse:R9}=je.Components,ZS=460,eE=class extends ns{template(){return je.createElement(sr,{controller:this.props.controller},je.createElement("div",{class:je.const("dcg-audio-keypad-container")},je.createElement("div",{class:je.const("dcg-audio-keypad-column dcg-playback-column")},je.createElement(Pe,{tooltip:this.bindFn(this.getDisabledTooltipText),gravity:this.const("s"),sticky:this.const(!1)},je.createElement("div",{class:je.const("dcg-btn-playback")},R9(()=>this.controller.isAudioTracing(),{true:()=>C(this,"stop-graph",{disabled:this.bindFn(this.isAudioDisabled)}),false:()=>C(this,"hear-graph",{disabled:this.bindFn(this.isAudioDisabled)})}))),je.createElement("div",{class:je.const("dcg-key-nav-section-container")},je.createElement(Pe,{tooltip:this.bindFn(this.getDisabledTooltipText),class:this.const("dcg-volume-button-container"),gravity:this.const("s"),sticky:this.const(!1)},je.createElement("div",{class:je.const("dcg-key-nav-section")},C(this,"volume-down",{disabled:this.bindFn(this.isVolumeDownDisabled)}),je.createElement("div",{role:je.const("heading"),"aria-level":je.const("2"),class:()=>({"dcg-key-nav-section-title-container":!0,"dcg-disabled":this.isAudioDisabled()})},je.createElement("span",{class:je.const("dcg-key-nav-section-title")},()=>this.controller.s("graphing-calculator-label-audio-trace-volume")),je.createElement("span",{class:je.const("dcg-keypad-volume-value dcg-key-nav-section-value")},()=>this.getAudioTraceVolume())),C(this,"volume-up",{disabled:this.bindFn(this.isVolumeUpDisabled)})))),je.createElement("div",{class:je.const("dcg-key-nav-section-container")},je.createElement(Pe,{tooltip:this.bindFn(this.getDisabledTooltipText),gravity:this.const("s"),sticky:this.const(!1)},je.createElement("div",{class:je.const("dcg-key-nav-section")},C(this,"speed-down",{disabled:this.bindFn(this.isSpeedDownDisabled)}),je.createElement("div",{class:()=>({"dcg-key-nav-section-title-container":!0,"dcg-disabled":this.isAudioDisabled()}),role:je.const("heading"),"aria-level":je.const("2")},je.createElement("span",{class:je.const("dcg-key-nav-section-title")},()=>this.controller.s("graphing-calculator-label-audio-trace-speed")),je.createElement("span",{class:je.const("dcg-keypad-speed-value dcg-key-nav-section-value")},()=>this.getAudioTraceSpeed())),C(this,"speed-up",{disabled:this.bindFn(this.isSpeedUpDisabled)})))),C(this,"audio-trace-off",{style:"highlight"})),je.createElement("div",{class:je.const("dcg-audio-keypad-spacer")}),je.createElement("div",{class:je.const("dcg-audio-keypad-column dcg-navigation-column")},je.createElement("span",{class:je.const("dcg-key-section-title dcg-center-col"),role:je.const("heading"),"aria-level":je.const("2")},()=>this.controller.s("graphing-calculator-heading-audio-trace-navigation")),je.createElement("div",{class:je.const("dcg-key-nav-section dcg-center-col")},C(this,"previous-point",{disabled:this.bindFn(this.isPrevPointDisabled)}),je.createElement("div",{class:je.const("dcg-key-nav-section-title-container"),role:je.const("heading"),"aria-level":je.const("2")},()=>this.controller.s("graphing-calculator-label-audio-trace-point")),C(this,"next-point",{disabled:this.bindFn(this.isNextPointDisabled)})),je.createElement("div",{class:je.const("dcg-key-nav-section")},C(this,"previous-poi",{disabled:this.bindFn(this.isPrevPOIDisabled)}),je.createElement("div",{class:je.const("dcg-key-nav-section-title-container dcg-poi-section-container"),role:je.const("heading"),"aria-level":je.const("2")},je.createElement(un,{i18n:this.const(this.controller),key:this.const("graphing-calculator-heading-keypad-audio-trace-point-of-interest")},je.createElement("span",{class:je.const("dcg-key-nav-section-value")},je.const("Point")),je.createElement("span",{class:je.const("dcg-key-nav-section-title")},je.const("of Interest")))),C(this,"next-poi",{disabled:this.bindFn(this.isNextPOIDisabled)})),je.createElement("div",{class:je.const("dcg-key-nav-section dcg-center-col")},C(this,"previous-curve",{disabled:this.bindFn(this.isPrevCurveDisabled)}),je.createElement("div",{class:je.const("dcg-key-nav-section-title-container"),role:je.const("heading"),"aria-level":je.const("2")},()=>this.controller.s("graphing-calculator-label-audio-trace-curve")),C(this,"next-curve",{disabled:this.bindFn(this.isNextCurveDisabled)}))),je.createElement("div",{class:je.const("dcg-audio-keypad-spacer")}),je.createElement("div",{class:je.const("dcg-audio-keypad-column dcg-screenreader-options")},je.createElement("span",{class:je.const("dcg-key-section-title"),role:je.const("heading"),"aria-level":je.const("2")},()=>this.layoutWidth()<=ZS?this.controller.s("graphing-calculator-heading-audio-trace-describe"):this.controller.s("graphing-calculator-heading-audio-trace-screen-reader"),je.createElement(Pe,{tooltip:()=>this.controller.s("graphing-calculator-label-audio-trace-need-screen-reader"),gravity:this.const("s"),sticky:this.const(!0)},je.createElement("i",{class:je.const("dcg-icon-question-sign"),"aria-hidden":je.const("true")}))),je.createElement(vr,{command:je.const("describe-point"),colspan:this.const(1),style:this.const("default"),onTap:()=>{this.dispatch({type:"keypad/audio-trace",command:"describe-point"})}},je.createElement("span",null,()=>this.layoutWidth()<=ZS?this.controller.s("graphing-calculator-button-keypad-describe-point-short"):this.controller.s("graphing-calculator-button-keypad-describe-point"))),je.createElement(vr,{command:je.const("describe-curve"),colspan:this.const(1),style:this.const("default"),onTap:()=>{this.dispatch({type:"keypad/audio-trace",command:"describe-curve"})}},je.createElement("span",null,()=>this.layoutWidth()<=ZS?this.controller.s("graphing-calculator-button-keypad-describe-curve-short"):this.controller.s("graphing-calculator-button-keypad-describe-curve"))),je.createElement(vr,{command:je.const("describe-axes"),colspan:this.const(1),style:this.const("default"),onTap:()=>{this.dispatch({type:"keypad/audio-trace",command:"describe-axes"})}},je.createElement("span",null,()=>this.layoutWidth()<=ZS?this.controller.s("graphing-calculator-label-axes"):this.controller.s("graphing-calculator-button-keypad-describe-axes"))))))}layoutWidth(){return this.controller.getLayoutMeasurements().width}isPrevPointDisabled(){let t=this.controller.getAudioGraph();return t?!t.agNavigator.canMoveToPrevPoint():!0}isNextPointDisabled(){let t=this.controller.getAudioGraph();return t?!t.agNavigator.canMoveToNextPoint():!0}isPrevPOIDisabled(){let t=this.controller.getAudioGraph();return t?!t.agNavigator.canMoveToPrevPOI():!0}isNextPOIDisabled(){let t=this.controller.getAudioGraph();return t?!t.agNavigator.canMoveToNextPOI():!0}isPrevCurveDisabled(){let t=this.controller.getAudioGraph();return t?!t.agNavigator.canMoveToPrevCurve():!0}isNextCurveDisabled(){let t=this.controller.getAudioGraph();return t?!t.agNavigator.canMoveToNextCurve():!0}isAudioDisabled(){return!this.controller.getAudio()}getAudioTraceVolume(){let t=this.controller.getAudioGraph();return!t||this.isAudioDisabled()?"0%":`${t.tonegen.getAudioVolume()*100}%`}isVolumeDownDisabled(){let t=this.controller.getAudioGraph();return!t||this.isAudioDisabled()?!0:t.tonegen.getAudioVolume()<=0}isVolumeUpDisabled(){let t=this.controller.getAudioGraph();return!t||this.isAudioDisabled()?!0:t.tonegen.getAudioVolume()>=1}getAudioTraceSpeed(){let t=this.controller.getAudioGraph();return!t||this.isAudioDisabled()?"0":Zy[t.getAudioSpeedIndex()].displayedSpeed}isSpeedDownDisabled(){let t=this.controller.getAudioGraph();return!t||this.isAudioDisabled()?!0:t.getAudioSpeedIndex()<=0}isSpeedUpDisabled(){let t=this.controller.getAudioGraph();return!t||this.isAudioDisabled()?!0:t.getAudioSpeedIndex()===Zy.length-1}getDisabledTooltipText(){return this.isAudioDisabled()?this.controller.s("graphing-calculator-narration-audio-trace-sound-effects-disabled"):""}};var wi=__dcg_shared_module_exports__['i'](Z());var{If:BT,For:M3}=wi.Components,tE=class extends ns{template(){return wi.createElement("div",{class:()=>({"dcg-functions-popover":!0,"dcg-popover":!0,"dcg-top":!0,"dcg-two-column":this.shouldRenderWithTwoColumns()})},wi.createElement("div",{class:wi.const("dcg-popover-interior")},wi.createElement("div",{class:wi.const("dcg-interior-buttons")},wi.createElement(M3,{each:this.bindFn(this.getKeypadKeys),key:t=>t.id},wi.createElement("div",{class:wi.const("dcg-basic-keypad dcg-do-not-blur")},t=>wi.createElement("div",{class:wi.const("dcg-keypad-keys-section")},wi.createElement(BT,{predicate:()=>t.title!==void 0},()=>wi.createElement("div",{class:wi.const("dcg-section-heading")},()=>t.title,wi.createElement(BT,{predicate:()=>!!t.helpLink},()=>wi.createElement("a",{href:()=>t.helpLink.url,target:wi.const("_blank"),"aria-label":()=>t.helpLink.tooltip},wi.createElement("i",{class:wi.const("dcg-icon-question-sign"),"aria-hidden":wi.const("true")}))))),wi.createElement(BT,{predicate:()=>t.title===void 0},()=>wi.createElement("div",{class:wi.const("dcg-popover-section-separator")})),wi.createElement(M3,{each:()=>t.keys},wi.createElement("div",{class:wi.const("dcg-keypad-keys-buttons")},e=>this.b(e)))))))),wi.createElement("div",{class:wi.const("dcg-arrow")}))}shouldRenderWithTwoColumns(){let t=this.controller.getGraphSettings().config.projectorMode?410:375;return this.controller.getLayoutMeasurements().width<t}getInverseTrigSection(){let t=this.controller.areFunctionsRestricted()?["arcsin","arccos","arctan"]:["arcsin","arccos","arctan","arccsc","arcsec","arccot"];return{id:"inversetrig",title:this.controller.s("graphing-calculator-heading-inverse-trig"),keys:t}}getGeometryTools(){let t=["midpoint","intersection","segment","line","ray","parallel","perpendicular","circle","arc","angle","directedangle","polygon","glider"];return{id:"geometry-tools",title:this.controller.s("graphing-calculator-heading-geometry-tools"),keys:t}}getGeometryTransformations(){let t=["dilation","rotation","reflection","translation"];return{id:"geometry-transformations",title:this.controller.s("graphing-calculator-heading-geometry-transformations"),keys:t}}getGeometryMeasurements(){let t=["distance","length","area","perimeter","vertices","angles","directedangles","segments","radius","center","coterminal","supplement"];return{id:"geometry-measurements",title:this.controller.s("graphing-calculator-heading-geometry-measurements"),keys:t}}getCalculatorGeometryMethods(){let e=!this.controller.areFunctionsRestricted()||this.controller.areGeometryFunctionsForceEnabled()?["polygon","distance","midpoint"]:["polygon"];return{id:"geometry",title:this.controller.s("graphing-calculator-heading-geometry"),keys:e}}getTrigSection(){let t=this.controller.areFunctionsRestricted()?["sin","cos","tan"]:["sin","cos","tan","csc","sec","cot"];return{id:"trig",title:this.controller.s("graphing-calculator-heading-trig"),keys:t}}getHyperbolicTrigSection(){let t=this.controller.areFunctionsRestricted()?["sinh","cosh","tanh"]:["sinh","cosh","tanh","csch","sech","coth"];return{id:"hyperbtrig",title:this.controller.s("graphing-calculator-heading-hyperbolic-trig"),keys:t}}getListFunctions(){return{id:"lists",title:this.controller.s("graphing-calculator-heading-lists"),keys:["join","sort","shuffle","unique","for"]}}getStatTests(){return{id:"stat-tests",title:this.controller.s("graphing-calculator-heading-stat-tests"),keys:["ttest","tscore","ittest"]}}getStatsSection(){let t=["mean","median","min","max","quartile","quantile","stdev","stdevp","var"];return this.controller.areFunctionsRestricted()||(t=t.concat(["mad","cov","covp"])),t=t.concat(["corr","spearman","stats","length","total"]),{id:"stats",title:this.controller.s("graphing-calculator-heading-stats"),keys:t}}getMiscSection(){return{title:this.controller.s("graphing-calculator-button-functions-menu-number-theory"),id:"misc",keys:["lcm","gcd","mod","ceil","floor","round","sign","nthroot","nPr","nCr"]}}getVisualizationsSection(){return{title:this.controller.s("graphing-calculator-heading-dist-tab-visualizations"),id:"visualizations",keys:["histogram","dotplot","boxplot"],helpLink:{url:"https://help.desmos.com/hc/en-us/articles/360022405991-Data-Visualizations",tooltip:this.controller.s("graphing-calculator-narration-dist-tab-visualizations")}}}getCalculusSection(){return{title:this.controller.s("graphing-calculator-heading-calculus"),id:"calculus",keys:["exp","ln","log","loga","ddx","prime","integral","sum","prod"]}}getDistributionsSection(){return{title:this.controller.s("graphing-calculator-heading-dist-tab-distributions"),id:"distributions",keys:["normaldist","tdist","poissondist","binomialdist","uniformdist","pdf","cdf","inversecdf","random"],helpLink:{url:"https://help.desmos.com/hc/en-us/articles/360022401451-Distributions",tooltip:this.controller.s("graphing-calculator-narration-dist-tab-distributions")}}}getColorsSection(){return{title:this.controller.s("graphing-calculator-button-functions-menu-custom-colors"),id:"colors",keys:["rgb","hsv"],helpLink:{url:"https://help.desmos.com/hc/en-us/articles/4406795899533-Custom-Colors",tooltip:this.controller.s("graphing-calculator-button-functions-menu-custom-colors")}}}getAdvancedSection(){return{title:this.controller.s("graphing-calculator-heading-functions-menu-advanced"),id:"advanced",keys:["->","with"],helpLink:{url:"https://help.desmos.com/hc/en-us/sections/4406370087053-Advanced-Features",tooltip:this.controller.s("graphing-calculator-heading-functions-menu-advanced")}}}getKeypadKeys(){let t=[this.getTrigSection(),this.getInverseTrigSection(),this.getStatsSection(),this.getListFunctions()];return this.controller.areDistributionsEnabled()&&(t.push(this.getVisualizationsSection()),t.push(this.getDistributionsSection()),t.push(this.getStatTests())),t.push(this.getCalculusSection()),t.push(this.getHyperbolicTrigSection()),this.controller.isGeometry()?(t.push(this.getGeometryTools()),t.push(this.getGeometryMeasurements()),t.push(this.getGeometryTransformations())):t.push(this.getCalculatorGeometryMethods()),t.push(this.getColorsSection()),t.push(this.getMiscSection()),this.controller.areActionsEnabled()&&t.push(this.getAdvancedSection()),t}b(t){return C(this,t,{style:"popover"})}};Oe();var{SwitchUnion:N9,If:KT}=jt.Components,rE=class extends ns{template(){return jt.createElement("div",{class:jt.const("dcg-keypad"),role:jt.const("complementary"),"aria-label":jt.const("Keypad")},jt.createElement("div",{class:()=>({"dcg-keys-container":!0,"dcg-smaller-functions-text":this.controller.getLayoutMeasurements().width<650,"dcg-small-ABC":this.controller.getLayoutMeasurements().width<490,"dcg-smaller-ABC":this.controller.getLayoutMeasurements().width<420,"dcg-smallest-ABC":this.controller.getLayoutMeasurements().width<380}),style:this.bindFn(this.computeStyles),didMount:this.bindFn(this.didMountContainer),"aria-hidden":()=>!this.controller.isKeypadOpen()},jt.createElement("div",{class:jt.const("dcg-keys-background dcg-do-not-blur"),style:()=>({background:this.controller.getPillboxBackgroundColor()})},jt.createElement("div",{class:jt.const("dcg-keys")},N9(()=>this.controller.getKeypadLayout(),{letters:()=>jt.createElement(jS,{controller:this.props.controller}),capitalLetters:()=>jt.createElement(JS,{controller:this.props.controller}),mainNumbers:()=>jt.createElement(YS,{controller:this.props.controller}),noQwertyLetters:()=>jt.createElement(XS,{controller:this.props.controller}),noQwertyCapitalLetters:()=>jt.createElement(QS,{controller:this.props.controller}),audio:()=>jt.createElement(eE,{controller:this.props.controller})}),jt.createElement(KT,{predicate:()=>this.controller.isKeypadFunctionsPopoverOpen()},()=>jt.createElement(tE,{controller:this.props.controller}))),jt.createElement(KT,{predicate:this.bindFn(this.isHideKeypadButtonVisible)},()=>jt.createElement("div",{class:jt.const("dcg-minimize-keypad-container")},jt.createElement(Pe,{tooltip:()=>this.controller.s("graphing-calculator-label-hide-keypad"),gravity:this.const("ne"),offset:this.const({left:6})},jt.createElement("div",{role:jt.const("button"),"aria-label":()=>this.controller.s("graphing-calculator-narration-hide-keypad"),class:jt.const("dcg-minimize-keypad"),style:()=>({"border-bottom-color":this.controller.getPillboxBackgroundColor(),background:this.controller.getPillboxBackgroundColor()}),onTap:()=>{this.controller.dispatch({type:"keypad/set-minimized",minimized:!0})}},jt.createElement("i",{class:jt.const("dcg-icon-keyboard"),"aria-hidden":jt.const("true")}),jt.createElement("i",{class:jt.const("dcg-icon-caret-down"),"aria-hidden":jt.const("true")}))))))),jt.createElement(KT,{predicate:this.bindFn(this.isShowKeypadButtonVisible)},()=>jt.createElement("div",{class:jt.const("dcg-show-keypad-container")},jt.createElement(Pe,{tooltip:()=>this.controller.s("graphing-calculator-label-show-keypad"),gravity:this.const("ne")},jt.createElement("div",{role:jt.const("button"),"aria-label":()=>this.controller.s("graphing-calculator-narration-show-keypad"),class:jt.const("dcg-btn-flat-gray dcg-show-keypad dcg-do-not-blur"),style:()=>({background:this.controller.getPillboxBackgroundColor()}),onTap:()=>{this.controller.dispatch({type:"keypad/set-minimized",minimized:!1})}},jt.createElement("i",{class:jt.const("dcg-icon-keyboard"),"aria-hidden":jt.const("true")}),jt.createElement("i",{class:jt.const("dcg-icon-caret-up dcg-do-not-blur"),"aria-hidden":jt.const("true")}))))))}didMountContainer(t){this.containerElt=t}isShowKeypadButtonVisible(){return this.controller.getBrailleMode()!=="none"?!1:!this.controller.isKeypadOpen()&&!this.controller.isNarrow()&&!this.controller.isInEditListMode()&&(this.controller.isListVisible()||this.controller.inAudioTraceMode())}isHideKeypadButtonVisible(){return this.controller.getBrailleMode()==="none"&&this.controller.isKeypadOpen()&&(!this.controller.isNarrow()||this.controller.inAudioTraceMode())}didMount(){this.updatePopoverPosition()}didUpdate(){this.updatePopoverPosition()}computeStyles(){let t={};return this.controller.isNarrow()||(t.transition="transform .3s, opacity .3s"),this.controller.isKeypadOpen()||(t.opacity="0",t.transform="translate3d(0, 255px, 0)"),t}updatePopoverPosition(){if(!this.controller.isKeypadFunctionsPopoverOpen()){this.__popoverCache=void 0;return}let t=this.controller.computeMajorLayout(),e={keypadTop:t.keypad.top,keypadWidth:t.keypad.width,keypadHeight:t.keypad.height,showToLeft:t.grapher.height<525};if(__dcg_shared_module_exports__['F'](e,this.__popoverCache))return;this.__popoverCache=e;let r=I(this.containerElt),i=r.find("[dcg-command=functions]"),n=r.find(".dcg-functions-popover"),o=r.find(".dcg-arrow");if(e.showToLeft){n.removeClass("dcg-top").addClass("dcg-left");var s=e.keypadHeight-(i.offset().top-r.offset().top),a=s-i.outerHeight()/2-2-10;o.css({left:"auto",bottom:a})}else n.removeClass("dcg-left").addClass("dcg-top"),o.css({left:n.width()-i.width()/2,bottom:"auto"})}};var ho=__dcg_shared_module_exports__['i'](Z());var xi=__dcg_shared_module_exports__['i'](Z()),{SwitchUnion:B9}=xi.Components,Iw=class extends xi.Class{template(){return this.controller=this.props.controller(),B9(()=>this.controller.getBrandingMode(),{"static-edit-link":()=>xi.createElement("div",{class:xi.const("dcg-graphpaper-branding")},xi.createElement("a",{href:()=>this.controller.getEditLink(),target:xi.const("_blank")},xi.createElement("span",{class:xi.const("dcg-powered-by"),"aria-label":()=>this.controller.s("graphing-calculator-narration-edit-on-desmos")},()=>this.controller.s("graphing-calculator-link-edit-on-desmos")),xi.createElement("i",{class:xi.const("dcg-icon-desmos"),"aria-hidden":xi.const("true")}))),"edit-link":()=>xi.createElement("div",{class:xi.const("dcg-graphpaper-branding")},xi.createElement("span",{class:xi.const("dcg-edit-branding"),onTap:()=>this.controller.dispatch({type:"open-on-web"})},xi.createElement("span",{class:xi.const("dcg-powered-by"),"aria-label":()=>this.controller.s("graphing-calculator-narration-edit-on-desmos")},()=>this.controller.s("graphing-calculator-link-edit-on-desmos")),xi.createElement("i",{class:xi.const("dcg-icon-desmos"),"aria-hidden":xi.const("true")}))),"powered-by":()=>xi.createElement("div",{class:xi.const("dcg-graphpaper-branding dcg-unclickable")},xi.createElement("span",{class:xi.const("dcg-powered-by"),"aria-label":()=>this.controller.s("graphing-calculator-narration-powered-by-desmos")},()=>this.controller.s("graphing-calculator-label-powered-by")),xi.createElement("i",{class:xi.const("dcg-icon-desmos"),"aria-hidden":xi.const("true")}))})}};var oe=__dcg_shared_module_exports__['i'](Z());Oe();var os=__dcg_shared_module_exports__['i'](Z());var{If:K9}=os.Components,ah=class extends os.Class{init(){this.controller=this.props.controller()}template(){return os.createElement(Pe,{tooltip:this.bindFn(this.getTooltip),gravity:this.const("w")},os.createElement("div",{class:()=>({"dcg-action-settings":!0,"dcg-icon-btn":!0,"dcg-btn-flat-gray":this.isPillbox(),"dcg-settings-pillbox":this.isPillbox()}),style:()=>({background:this.isPillbox()?this.controller.getPillboxBackgroundColor():void 0}),role:os.const("button"),tabindex:os.const("0"),"aria-haspopup":os.const("true"),"aria-expanded":()=>this.controller.isGraphSettingsOpen(),"aria-label":this.bindFn(this.getTooltip),onTap:this.bindFn(this.onTapSettingsButton),manageFocus:this.const(yt({controller:this.controller,location:{type:"settings",location:"icon"}}))},os.createElement("i",{class:os.const("dcg-icon-wrench"),"aria-hidden":os.const("true")}),os.createElement(K9,{predicate:()=>this.controller.getLockViewportUserSetting()},()=>os.createElement("i",{class:os.const("dcg-icon-lock"),"aria-hidden":os.const("true")}))))}getTooltip(){return this.controller.isGeometry()?this.controller.s("graphing-calculator-label-tooltip-geometry-settings"):this.controller.s("graphing-calculator-label-tooltip-graph-settings")}isPillbox(){return this.props.isPillbox&&this.props.isPillbox()}onTapSettingsButton(e){this.controller.dispatch({type:"toggle-graph-settings",focusOnOpen:e.device==="keyboard"})}};var zr=__dcg_shared_module_exports__['i'](Z());var bc=__dcg_shared_module_exports__['i'](Z());var gu=class extends bc.Class{template(){return bc.createElement(Pe,{tooltip:()=>this.props.controller().s("shared-calculator-label-toast-learn-more")},bc.createElement("a",{"aria-label":()=>this.props.controller().s("shared-calculator-label-toast-learn-more"),class:bc.const("dcg-learn-more-link"),href:this.props.href,target:bc.const("_blank")},bc.createElement("i",{class:bc.const("dcg-icon-question-sign"),"aria-hidden":bc.const("true")})))}};var{If:iE}=zr.Components,nE=class extends zr.Class{template(){return zr.createElement("div",{class:zr.const("dcg-checkbox-title dcg-lock-viewport-option")},zr.createElement(Dt,{ariaLabel:()=>this.props.controller().s("graphing-calculator-label-settings-lock-viewport"),onChange:()=>{this.props.controller().dispatch({type:"toggle-lock-viewport"})},checked:()=>this.props.controller().getLockViewportUserSetting()},()=>this.props.controller().s("graphing-calculator-label-settings-lock-viewport")),zr.createElement(gu,{href:this.const("https://help.desmos.com/hc/en-us/articles/4405296853517#h_01FZX4DBWKD83TZVMH615XF3QA"),controller:this.props.controller}))}},oE=class extends zr.Class{init(){this.controller=this.props.controller(),this.isOpen=this.getAxisScale("x")==="logarithmic"||this.getAxisScale("y")==="logarithmic"||this.props.controller().getLockViewportUserSetting()}template(){return zr.createElement("div",{class:zr.const("dcg-advanced-viewport-settings-view")},zr.createElement(iE,{predicate:()=>this.shouldShowLogScalesOption()},()=>zr.createElement("div",null,zr.createElement("div",{class:()=>({"dcg-advanced-toggle":!0,"dcg-opened":this.isOpen}),onTap:this.bindFn(this.toggleOpen),tabindex:zr.const(0),role:zr.const("button"),"aria-pressed":()=>this.isOpen},zr.createElement("div",{class:zr.const("dcg-caret-container")},zr.createElement("i",{class:zr.const("dcg-icon-caret-down"),"aria-hidden":zr.const("true")})),()=>this.controller.s("graphing-calculator-label-more-viewport-options")),zr.createElement(iE,{predicate:()=>this.isOpen},()=>zr.createElement("div",{class:zr.const("dcg-advanced-contents")},zr.createElement("div",{class:zr.const("dcg-log-axes-container")},zr.createElement("div",null,()=>this.getAxisScaleLabel("x")),zr.createElement(jr,{ariaGroupLabel:()=>this.getAxisScaleLabel("x"),theme:this.const("mini"),staticConfig:this.const(this.getStaticConfigForAxis("x"))}),zr.createElement("div",null,()=>this.getAxisScaleLabel("y")),zr.createElement(jr,{ariaGroupLabel:()=>this.getAxisScaleLabel("y"),theme:this.const("mini"),staticConfig:this.const(this.getStaticConfigForAxis("y"))})),zr.createElement(iE,{predicate:()=>!this.controller.getLockViewportConfigSetting()},()=>zr.createElement(nE,__dcg_shared_module_exports__['b']({},this.props))))))),zr.createElement(iE,{predicate:()=>!this.controller.getLockViewportConfigSetting()&&!this.shouldShowLogScalesOption()},()=>zr.createElement(nE,__dcg_shared_module_exports__['b']({},this.props))))}toggleOpen(){this.isOpen=!this.isOpen,this.update()}getAxisScaleLabel(e){return e==="x"?this.controller.s("graphing-calculator-label-settings-x-axis")+":":this.controller.s("graphing-calculator-label-settings-y-axis")+":"}getStaticConfigForAxis(e){return[{key:"linear",label:()=>"Linear",selected:()=>this.getAxisScale(e)==="linear",onSelect:()=>this.setAxisScale({axis:e,scale:"linear"})},{key:"logarithmic",label:()=>"Logarithmic",selected:()=>this.getAxisScale(e)==="logarithmic",onSelect:()=>this.setAxisScale({axis:e,scale:"logarithmic"})}]}shouldShowLogScalesOption(){return this.controller.getGraphSettings().config.logScales&&!this.controller.isThreeDMode()}getAxisScale(e){return this.controller.getGraphSettings()[e==="x"?"xAxisScale":"yAxisScale"]}setAxisScale({axis:e,scale:r}){return this.controller.dispatch({type:"set-graph-settings",[e==="x"?"xAxisScale":"yAxisScale"]:r})}};var{Input:UT,If:zo,IfElse:T3,For:U9}=oe.Components,hd=class extends oe.Class{template(){return oe.createElement(lr,{isFocused:()=>this.props.parent().getFocusedLimit()===this.props.limit(),latex:()=>this.props.parent().getLimitLatex(this.props.limit()),ariaLabel:this.props.ariaLabel,handleLatexChanged:e=>this.props.parent().setLimitLatex(this.props.limit(),e),handleFocusChanged:e=>this.props.parent().onFocusedChanged(this.props.limit(),e),hasError:()=>this.props.parent().isLimitInvalid(this.props.limit()),dataLabelAttributeValue:this.props.limit,controller:this.props.controller,readonly:this.const(!1),containerClass:()=>({"dcg-log-scale":this.props.axisScale()==="logarithmic"})})}},Mw=class extends oe.Class{init(){this.controller=this.props.controller()}template(){return oe.createElement("div",{class:oe.const("dcg-settings-view-container")},oe.createElement(ah,__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.props),{isPillbox:this.const(!0)})),oe.createElement(zo,{predicate:()=>this.controller.isGraphSettingsOpen()},()=>oe.createElement("div",{class:oe.const("dcg-settings-container dcg-left dcg-popover dcg-constrained-height-popover"),style:this.bindFn(this.getContainerStyle),didMount:this.bindFn(this.didMountContainer),didUnmount:this.bindFn(this.didUnmountContainer)},oe.createElement("div",{class:oe.const("dcg-popover-interior"),role:oe.const("complementary"),"aria-label":()=>this.controller.s("graphing-calculator-label-tooltip-graph-settings")},oe.createElement("div",{class:oe.const("dcg-visual-settings")},oe.createElement("div",{class:oe.const("dcg-displaysizegroup")},oe.createElement(jr,{ariaGroupLabel:()=>this.controller.s("shared-calculator-narration-settings-display-size"),staticConfig:this.bindFn(this.getProjectorModeOptions)})),oe.createElement(Dt,{onChange:this.bindFn(this.toggleInvertedColors),checked:()=>this.controller.getInvertedColors(),manageFocus:this.const(yt({controller:this.controller,location:{type:"settings",location:"reverse-contrast"}}))},()=>this.controller.s("graphing-calculator-label-settings-reverse-contrast")),oe.createElement(zo,{predicate:()=>this.controller.getBrailleControls()},()=>oe.createElement("div",{class:oe.const("dcg-braille-container dcg-braille-mode")},oe.createElement(Dt,{onChange:this.bindFn(this.toggleBrailleMode),checked:()=>this.controller.getBrailleMode()!=="none"},()=>this.controller.s("shared-calculator-narration-braille-mode")),oe.createElement(zo,{predicate:()=>this.controller.getBrailleMode()!=="none"},()=>oe.createElement("div",{class:oe.const("dcg-braille-options-container")},oe.createElement("div",{class:oe.const("dcg-braille-options-buttons")},oe.createElement(jr,{ariaGroupLabel:()=>this.controller.s("shared-calculator-narration-braille-mode"),staticConfig:this.bindFn(this.getBrailleOptions)})),oe.createElement("div",{class:oe.const("dcg-checkbox-title dcg-six-key-checkbox")},oe.createElement(Dt,{onChange:e=>this.controller.dispatch({type:"set-six-key-input",useSixKeyInput:e}),checked:()=>this.controller.getSixKeyInput()},()=>this.controller.s("graphing-calculator-label-settings-six-key-braille")),oe.createElement("a",{href:oe.const("https://www.desmos.com/accessibility#braille"),"aria-label":()=>this.controller.s("graphing-calculator-link-learn-more"),class:oe.const("dcg-six-key-info"),target:oe.const("_blank")},oe.createElement("i",{class:oe.const("dcg-icon-question-sign"),"aria-hidden":oe.const("true")}))),oe.createElement("div",{class:oe.const("dcg-refreshable-braille-note")},()=>this.controller.s("graphing-calculator-text-refreshable-braille-display-note")+" ",oe.createElement("a",{href:()=>"https://www.desmos.com/braille-examples?"+this.controller.getBrailleMode(),target:oe.const("_blank")},()=>this.controller.s("graphing-calculator-link-view-braille-examples")))))))),oe.createElement(zo,{predicate:()=>this.controller.isThreeDMode()},()=>oe.createElement("div",null,oe.createElement(zo,{predicate:()=>!!mi("beta3d")},()=>oe.createElement("div",{class:oe.const("dcg-top-section-flex dcg-3d-background-color")},oe.createElement("span",{style:oe.const("text-align: center; height:30px; line-height:30px;")},oe.const("Background:")),oe.createElement(U9,{each:()=>["#000","#555","#888","#EEE","#FFF"]},oe.createElement("div",{class:oe.const("dcg-opacities-menu-flex"),role:oe.const("group"),"aria-label":()=>this.controller.s("graphing-calculator-heading-image-opacity")},e=>oe.createElement("span",{class:oe.const("dcg-opacity-option"),role:oe.const("button"),tabindex:oe.const(0),"aria-label":()=>`color: ${e}`,"aria-pressed":()=>{this.controller.getGraphSettings().backgroundColor3d},handleevent:oe.const("true"),onTap:()=>this.onBackgroundColor3d(e),style:oe.const("padding-left:3px")},oe.createElement(cn,{iconType:()=>"none",backgroundColor:()=>({type:"single-color",value:e}),backgroundOpacity:()=>1,dontInvert:oe.const(!0)})))))),oe.createElement("div",{class:oe.const("dcg-top-section-flex dcg-show-axis-3d-option")},oe.createElement(Dt,{ariaLabel:()=>this.controller.s("graphing-calculator-label-settings-axis-3d"),onChange:()=>{this.controller.dispatch({type:"set-graph-settings",showAxis3D:!this.controller.getGraphSettings().showAxis3D})},checked:()=>!!this.controller.getGraphSettings().showAxis3D},()=>this.controller.s("graphing-calculator-label-settings-axis-3d"))),oe.createElement(zo,{predicate:()=>this.controller.getGraphSettings().showAxis3D},()=>oe.createElement("div",{class:oe.const("dcg-top-section-flex dcg-show-axis-labels-3d-option")},oe.createElement(Dt,{ariaLabel:()=>this.controller.s("graphing-calculator-label-settings-axis-labels-3d"),onChange:()=>{this.controller.dispatch({type:"set-graph-settings",showAxisLabels3D:!this.controller.getGraphSettings().showAxisLabels3D})},checked:()=>!!this.controller.getGraphSettings().showAxisLabels3D},()=>this.controller.s("graphing-calculator-label-settings-axis-labels-3d")))),oe.createElement("div",{class:oe.const("dcg-top-section-flex dcg-show-box-3d-option")},oe.createElement(Dt,{ariaLabel:()=>this.controller.s("graphing-calculator-label-settings-box-3d"),onChange:()=>{this.controller.dispatch({type:"set-graph-settings",showBox3D:!this.controller.getGraphSettings().showBox3D})},checked:()=>!!this.controller.getGraphSettings().showBox3D},()=>this.controller.s("graphing-calculator-label-settings-box-3d"))),oe.createElement("div",{class:oe.const("dcg-top-section-flex dcg-domain-plane-option")},oe.createElement(Dt,{ariaLabel:()=>this.controller.s("graphing-calculator-label-settings-domain-plane"),onChange:()=>{this.controller.dispatch({type:"set-graph-settings",showPlane3D:!this.controller.getGraphSettings().showPlane3D})},checked:()=>!!this.controller.getGraphSettings().showPlane3D},()=>this.controller.s("graphing-calculator-label-settings-domain-plane")),oe.createElement(zo,{predicate:()=>!!this.controller.getGraphSettings().showPlane3D},()=>oe.createElement("div",{style:oe.const("padding-left:20px")},oe.createElement(Pe,{tooltip:()=>this.controller.s("graphing-calculator-label-opacity-tooltip"),sticky:this.const(!0),gravity:this.const("se")},oe.createElement("i",{class:oe.const("dcg-icon-opacity"),"aria-hidden":oe.const("true")})),oe.createElement(UT,{class:this.const("dcg-2dplane-opacity"),onInput:this.bindFn(this.onPlane3dOpacityInput),value:this.bindFn(this.getPlane3dOpacity)})))))),oe.createElement(zo,{predicate:()=>!this.controller.isThreeDMode()||!!this.controller.getGraphSettings().showPlane3D},()=>oe.createElement("div",{class:oe.const("dcg-top-section-flex dcg-grid-settings-container")},oe.createElement("div",{class:oe.const("dcg-grid-settings")},oe.createElement(Dt,{class:this.const("dcg-settings-grid-toggle"),onChange:this.bindFn(this.toggleGrid),checked:this.bindFn(this.getShowGrid)},()=>this.controller.s("graphing-calculator-label-settings-grid")),oe.createElement(zo,{predicate:this.bindFn(this.getShowGrid)},()=>oe.createElement("div",{class:oe.const("dcg-circle-icon-group dcg-grid-group")},oe.createElement("div",{class:()=>({"dcg-circle-icon":!0,"dcg-action-cartesian":!0,"dcg-selected":!this.getPolarMode()}),role:oe.const("button"),tabindex:oe.const("0"),"aria-pressed":()=>!this.getPolarMode(),"aria-label":()=>this.controller.s("graphing-calculator-narration-settings-cartesian-grid"),onTap:this.bindFn(this.setCartesianMode)}),oe.const("\xA0"),oe.createElement("div",{class:()=>({"dcg-circle-icon":!0,"dcg-action-polar":!0,"dcg-selected":this.getPolarMode()}),role:oe.const("button"),tabindex:oe.const("0"),"aria-pressed":()=>this.getPolarMode(),"aria-label":()=>this.controller.s("graphing-calculator-narration-settings-polar-grid"),onTap:this.bindFn(this.setPolarMode)}))),oe.createElement(Dt,{onChange:this.bindFn(this.toggleArrows),checked:()=>this.getAxisArrowMode()!=="NONE"},()=>this.controller.s("graphing-calculator-label-settings-arrows")),oe.createElement(zo,{predicate:()=>this.getAxisArrowMode()!=="NONE"},()=>oe.createElement("div",{class:oe.const("dcg-circle-icon-group dcg-arrow-group")},oe.createElement("div",{role:oe.const("button"),tabindex:oe.const("0"),class:()=>({"dcg-circle-icon":!0,"dcg-arrows":!0,"dcg-selected":this.getAxisArrowMode()==="BOTH"}),"dcg-arrows":oe.const("BOTH"),"aria-label":()=>this.controller.s("graphing-calculator-narration-settings-show-both"),"aria-pressed":()=>this.getAxisArrowMode()==="BOTH",onTap:()=>this.setAxisArrowMode("BOTH")},oe.createElement("i",{class:oe.const("dcg-icon-arrows-two"),"aria-hidden":oe.const("true")})),oe.const("\xA0"),oe.createElement("div",{role:oe.const("button"),tabindex:oe.const("0"),class:()=>({"dcg-circle-icon":!0,"dcg-arrows":!0,"dcg-selected":this.getAxisArrowMode()==="POSITIVE"}),"dcg-arrows":oe.const("POSITIVE"),"aria-label":()=>this.controller.s("graphing-calculator-narration-settings-show-positive"),"aria-pressed":()=>this.getAxisArrowMode()==="POSITIVE",onTap:()=>this.setAxisArrowMode("POSITIVE")},oe.createElement("i",{class:oe.const("dcg-icon-arrows-one"),"aria-hidden":oe.const("true")}))))),oe.createElement("div",{class:oe.const("dcg-top-checkboxes-container")},oe.createElement(Dt,{onChange:this.bindFn(this.toggleAxisNumbers),checked:this.bindFn(this.getAxisNumbers),small:this.const(!0)},()=>this.controller.s("graphing-calculator-label-settings-axis-numbers")),oe.createElement(zo,{predicate:()=>this.getShowGrid()&&!this.getPolarMode()},()=>oe.createElement(Dt,{onChange:this.bindFn(this.toggleMinorGridlines),checked:this.bindFn(this.getMinorGridlines),small:this.const(!0)},()=>this.controller.s("graphing-calculator-label-settings-minor-gridlines"))),oe.createElement(zo,{predicate:()=>this.controller.canUseAdvancedStyling()&&!this.getPolarMode()},()=>oe.createElement(Dt,{checked:()=>this.controller.getGraphSettings().restrictGridToFirstQuadrant,ariaLabel:this.const("One Quadrant"),onChange:e=>this.controller.dispatch({type:"set-graph-settings",restrictGridToFirstQuadrant:e}),small:this.const(!0)},oe.const("One Quadrant"))),oe.createElement(zo,{predicate:this.bindFn(this.showZoomSquareButton)},()=>oe.createElement("div",{role:oe.const("button"),tabindex:oe.const("0"),class:oe.const("dcg-action-zoom-square dcg-btn-light-gray"),onTap:this.bindFn(this.zoomSquare)},()=>this.controller.s("graphing-calculator-button-settings-zoom-square")))))),oe.createElement("div",{class:oe.const("dcg-axes-settings-container")},oe.createElement(zo,{predicate:()=>!this.controller.isThreeDMode()},()=>oe.createElement("div",{class:oe.const("dcg-checkbox-title dcg-x-axis-title")},oe.createElement(Dt,{ariaLabel:()=>this.controller.s("graphing-calculator-label-settings-x-axis"),onChange:this.bindFn(this.toggleXAxis),checked:this.bindFn(this.getShowXAxis)},()=>this.controller.s("graphing-calculator-label-settings-x-axis")),oe.createElement(UT,{class:this.const("dcg-axis-label dcg-x-axis-label"),placeholder:()=>this.controller.s("graphing-calculator-label-settings-add-label"),"aria-label":()=>this.controller.s("graphing-calculator-narration-settings-x-axis-label"),disabled:()=>this.getShowXAxis()?void 0:!0,"aria-disabled":()=>this.getShowXAxis()?void 0:!0,onInput:this.bindFn(this.onXAxisLabelInput),value:this.bindFn(this.getXAxisLabel)}))),oe.createElement("div",{class:oe.const("dcg-editable-mathquill-container dcg-x-axis-options")},oe.createElement(hd,{limit:this.const("xmin"),axisScale:()=>this.getAxisScale("x"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-x-axis-min"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller}),oe.createElement(et,{config:this.const({}),latex:this.const("\\le x\\le")},oe.createElement("span",{class:oe.const("dcg-interval-interior")})),oe.createElement(hd,{limit:this.const("xmax"),axisScale:()=>this.getAxisScale("x"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-x-axis-max"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller}),oe.createElement(zo,{predicate:()=>!this.getPolarMode()&&!this.controller.isThreeDMode()},()=>T3(()=>this.getAxisScale("x")==="linear",{true:()=>oe.createElement("span",{class:oe.const("dcg-step-container")},oe.createElement("span",{class:oe.const("dcg-step-label"),"aria-hidden":oe.const("true")},()=>this.controller.s("graphing-calculator-label-settings-step")),oe.createElement(hd,{limit:this.const("xstep"),axisScale:this.const("linear"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-x-axis-step"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller})),false:()=>oe.createElement("span",{style:oe.const("display: none")})}))),oe.createElement(zo,{predicate:()=>!this.controller.isThreeDMode()},()=>oe.createElement("div",{class:oe.const("dcg-checkbox-title dcg-y-axis-title")},oe.createElement(Dt,{ariaLabel:()=>this.controller.s("graphing-calculator-label-settings-y-axis"),onChange:this.bindFn(this.toggleYAxis),checked:this.bindFn(this.getShowYAxis)},()=>this.controller.s("graphing-calculator-label-settings-y-axis")),oe.createElement(UT,{class:this.const("dcg-axis-label dcg-y-axis-label"),placeholder:()=>this.controller.s("graphing-calculator-label-settings-add-label"),"aria-label":()=>this.controller.s("graphing-calculator-narration-settings-y-axis-label"),disabled:()=>this.getShowYAxis()?void 0:!0,"aria-disabled":()=>this.getShowYAxis()?void 0:!0,onInput:this.bindFn(this.onYAxisLabelInput),value:this.bindFn(this.getYAxisLabel)}))),oe.createElement("div",{class:oe.const("dcg-editable-mathquill-container dcg-y-axis-options")},oe.createElement(hd,{limit:this.const("ymin"),axisScale:()=>this.getAxisScale("y"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-y-axis-min"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller}),oe.createElement(et,{config:this.const({}),latex:this.const("\\le y\\le")},oe.createElement("span",{class:oe.const("dcg-interval-interior")})),oe.createElement(hd,{limit:this.const("ymax"),axisScale:()=>this.getAxisScale("y"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-y-axis-max"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller}),oe.createElement(zo,{predicate:()=>!this.getPolarMode()&&!this.controller.isThreeDMode()},()=>T3(()=>this.getAxisScale("y")==="linear",{true:()=>oe.createElement("span",{class:oe.const("dcg-step-container")},oe.createElement("span",{class:oe.const("dcg-step-label"),"aria-hidden":oe.const("true")},()=>this.controller.s("graphing-calculator-label-settings-step")),oe.createElement(hd,{limit:this.const("ystep"),axisScale:this.const("linear"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-y-axis-step"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller})),false:()=>oe.createElement("span",{style:oe.const("display: none")})}))),oe.createElement(zo,{predicate:()=>this.controller.isThreeDMode()},()=>oe.createElement("div",null,oe.createElement("div",{class:oe.const("dcg-editable-mathquill-container dcg-z-axis-options")},oe.createElement(hd,{limit:this.const("zmin"),axisScale:this.const("linear"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-z-axis-min"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller}),oe.createElement(et,{config:this.const({}),latex:this.const("\\le z\\le")},oe.createElement("span",{class:oe.const("dcg-interval-interior")})),oe.createElement(hd,{limit:this.const("zmax"),axisScale:this.const("linear"),ariaLabel:()=>this.controller.s("graphing-calculator-narration-settings-z-axis-max"),needsSystemKeypad:()=>!this.controller.isKeypadEnabled(),parent:this.const(this),controller:this.props.controller})))),oe.createElement(oE,{controller:this.props.controller})),oe.createElement("div",{class:oe.const("dcg-radiangroup")},oe.createElement(jr,{ariaGroupLabel:()=>this.controller.s("graphing-calculator-narration-settings-angle"),staticConfig:this.bindFn(this.getAngleModeOptions)})),oe.createElement(zo,{predicate:()=>this.controller.is3D()&&!!mi("beta3d")},()=>oe.createElement("div",{class:oe.const("dcg-dimensiongroup")},oe.createElement(jr,{ariaGroupLabel:()=>this.controller.s("graphing-calculator-narration-settings-dimension"),staticConfig:this.bindFn(this.getDimensionOptions)}))),oe.createElement("div",{class:oe.const("dcg-arrow")})))))}getAngleModeOptions(){return[{key:"radians",label:()=>this.controller.s("graphing-calculator-button-settings-radians"),selected:()=>!this.getDegreeMode(),onSelect:()=>this.setDegreeMode(!1),focusHelperOptions:{controller:this.controller,location:{type:"settings",location:"radian-mode"}}},{key:"degrees",label:()=>this.controller.s("graphing-calculator-button-settings-degrees"),selected:()=>this.getDegreeMode(),onSelect:()=>this.setDegreeMode(!0),focusHelperOptions:{controller:this.controller,location:{type:"settings",location:"degree-mode"}}}]}getDimensionOptions(){return[{key:"2d",label:()=>this.controller.s("graphing-calculator-button-settings-2d"),selected:()=>!this.getThreeDMode(),onSelect:()=>this.setTwoDMode(),focusHelperOptions:{controller:this.controller,location:{type:"settings",location:"2d-mode"}}},{key:"3d",label:()=>this.controller.s("graphing-calculator-button-settings-3d"),selected:()=>this.getThreeDMode(),onSelect:()=>this.setThreeDMode(),focusHelperOptions:{controller:this.controller,location:{type:"settings",location:"3d-mode"}}}]}getDegreeMode(){return!!this.controller.getGraphSettings().degreeMode}setDegreeMode(e){this.controller.dispatch({type:"set-graph-settings",degreeMode:e})}toggleBrailleMode(){this.controller.dispatch({type:"set-braille-mode",mode:this.controller.getBrailleMode()==="none"?"nemeth":"none"})}getBrailleOptions(){return[{key:"nemeth",label:()=>this.controller.s("shared-calculator-button-braille-mode-nemeth"),selected:()=>this.controller.getBrailleMode()==="nemeth",onSelect:()=>this.setBrailleMode("nemeth")},{key:"ueb",label:()=>this.controller.s("shared-calculator-button-braille-mode-ueb"),selected:()=>this.controller.getBrailleMode()==="ueb",onSelect:()=>this.setBrailleMode("ueb")}]}setBrailleMode(e){this.controller.dispatch({type:"set-braille-mode",mode:e})}getProjectorModeOptions(){return[{key:"default",label:()=>"A",ariaLabel:()=>this.controller.s("shared-calculator-narration-settings-display-size-default"),class:()=>"dcg-displaysize-default",selected:()=>!this.getProjectorMode(),onSelect:()=>this.onSelectProjectorModeOption(!1),focusHelperOptions:{controller:this.controller,location:{type:"settings",location:"default-size"}}},{key:"large",label:()=>"A",ariaLabel:()=>this.controller.s("shared-calculator-narration-settings-display-size-large"),class:()=>"dcg-displaysize-large",selected:()=>this.getProjectorMode(),onSelect:()=>this.onSelectProjectorModeOption(!0),focusHelperOptions:{controller:this.controller,location:{type:"settings",location:"large-size"}}}]}onSelectProjectorModeOption(e){this.controller.dispatch({type:"set-projector-mode",value:e})}didMountContainer(e){this.node=e,I(document).on("dcg-tapstart.settings-view wheel.settings-view",r=>{this.eventShouldClosePopover(r)&&this.controller.dispatch({type:"close-graph-settings",focusIconAfterClose:r.device==="keyboard"})}),I(document).on("keydown.settings-view",r=>{let i=Te(r);if(i==="Esc"&&this.controller.dispatch({type:"close-graph-settings",focusIconAfterClose:!0}),this.controller.isGraphSettingsOpen()&&i==="Tab"&&!r.altKey&&!r.metaKey&&!r.ctrlKey){let n=this.controller.getFocusLocation();if(!n||n.type!=="settings")return;r.shiftKey?r.shiftKey&&(n.location==="default-size"?(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"icon"}}),r.preventDefault(),r.stopPropagation()):n.location==="icon"&&(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"degree-mode"}}),r.preventDefault(),r.stopPropagation())):n.location==="icon"?(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"default-size"}}),r.preventDefault(),r.stopPropagation()):n.location===(this.controller.is3D()&&mi("beta3d")?"3d-mode":"degree-mode")&&(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"icon"}}),r.preventDefault(),r.stopPropagation())}})}didUnmountContainer(){I(document).off(".settings-view")}didUpdate(){if(!this.controller.isGraphSettingsOpen())return;let e=this.controller.getKeypadHeight();e!==this.cachedKeypadHeight&&document.activeElement&&I(document.activeElement).closest(this.node).length&&Ba(I(document.activeElement),I(this.node).find(".dcg-popover-interior"),50),this.cachedKeypadHeight=e}eventShouldClosePopover(e){let r=I(e.target),i=!!r.closest(this.node).length,n=!!r.closest(".dcg-action-settings").length,o=this.isMathquillFocused()&&r.closest(".dcg-keypad").length,s=!!r.closest(".dcg-action-undo").length||!!r.closest(".dcg-action-redo").length;return!(i||n||o||s)}isMathquillFocused(){return this.getFocusedLimit()!==void 0}getLimitLatex(e){return this.controller.getSettingsViewModel().limitLatex[e]||""}setLimitLatex(e,r){r!==this.controller.getSettingsViewModel().limitLatex[e]&&this.controller.dispatch({type:"set-axis-limit-latex",limit:e,latex:r})}getFocusedLimit(){let e=this.controller.getFocusLocation();if(e&&e.type==="settings")return e.location}getInvalidLimits(){let e=!!this.controller.getGraphSettings().degreeMode,r=yn(this.getLimitLatex("xmin"),e),i=yn(this.getLimitLatex("xmax"),e),n=yn(this.getLimitLatex("ymin"),e),o=yn(this.getLimitLatex("ymax"),e),s=this.getLimitLatex("xstep")===""?0:yn(this.getLimitLatex("xstep"),e),a=this.getLimitLatex("ystep")===""?0:yn(this.getLimitLatex("ystep"),e),l={},c=new an(r,i,n,o);return isFinite(r)&&isFinite(i)?(l.xmin=!c.isXValid(this.controller.getGraphSettings().xAxisScale),l.xmax=l.xmin):(l.xmin=!isFinite(r),l.xmax=!isFinite(i)),isFinite(n)&&isFinite(o)?(l.ymin=!c.isYValid(this.controller.getGraphSettings().yAxisScale),l.ymax=l.ymin):(l.ymin=!isFinite(n),l.ymax=!isFinite(o)),l.xstep=!sg(s),l.ystep=!sg(a),l}isLimitInvalid(e){return this.getInvalidLimits()[e]}onFocusedChanged(e,r){r?this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:e}}):this.controller.dispatch({type:"blur-focus-location",location:{type:"settings",location:e}})}onPlane3dOpacityInput(e){this.controller.dispatch({type:"set-graph-settings",plane3dOpacity:e})}onBackgroundColor3d(e){this.controller.dispatch({type:"set-graph-settings",backgroundColor3d:e})}getPlane3dOpacity(){return this.controller.getGraphSettings().plane3dOpacity}onXAxisLabelInput(e){this.controller.dispatch({type:"set-graph-settings",xAxisLabel:e})}onYAxisLabelInput(e){this.controller.dispatch({type:"set-graph-settings",yAxisLabel:e})}getXAxisLabel(){return this.controller.getGraphSettings().xAxisLabel}getYAxisLabel(){return this.controller.getGraphSettings().yAxisLabel}getShowXAxis(){return!!this.controller.getGraphSettings().showXAxis}toggleXAxis(){this.controller.dispatch({type:"set-graph-settings",showXAxis:!this.getShowXAxis()})}getShowYAxis(){return!!this.controller.getGraphSettings().showYAxis}toggleYAxis(){this.controller.dispatch({type:"set-graph-settings",showYAxis:!this.getShowYAxis()})}getAxisNumbers(){return!!this.controller.getGraphSettings().xAxisNumbers}toggleAxisNumbers(){let e=this.getAxisNumbers();this.controller.dispatch({type:"set-graph-settings",xAxisNumbers:!e,yAxisNumbers:!e,polarNumbers:!e})}getMinorGridlines(){return this.controller.getGraphSettings().xAxisMinorSubdivisions===0}toggleMinorGridlines(){let e=this.getMinorGridlines()?1:0;this.controller.dispatch({type:"set-graph-settings",yAxisMinorSubdivisions:e,xAxisMinorSubdivisions:e})}getPolarMode(){return!!this.controller.getGraphSettings().polarMode}setPolarMode(){this.controller.dispatch({type:"set-polar-mode",polarMode:!0})}setCartesianMode(){this.controller.dispatch({type:"set-polar-mode",polarMode:!1})}getThreeDMode(){return!!this.controller.isThreeDMode()}setTwoDMode(){this.controller.setGrapher(this.controller.grapher2d),this.controller.dispatch({type:"set-graph-settings",threeDMode:!1})}setThreeDMode(){this.controller.setGrapher(this.controller.grapher3d||this.controller.grapher2d),this.controller.dispatch({type:"set-graph-settings",threeDMode:!0})}getAxisScale(e){return this.controller.getGraphSettings()[e==="x"?"xAxisScale":"yAxisScale"]}getProjectorMode(){return!!this.controller.getGraphSettings().config.projectorMode}toggleInvertedColors(){this.controller.dispatch({type:"set-inverted-colors",value:!this.controller.getInvertedColors()})}getAxisArrowMode(){return this.controller.getGraphSettings().xAxisArrowMode}setAxisArrowMode(e){this.controller.dispatch({type:"set-graph-settings",xAxisArrowMode:e,yAxisArrowMode:e})}getShowGrid(){return this.controller.getGraphSettings().showGrid}toggleGrid(){this.controller.dispatch({type:"set-graph-settings",showGrid:!this.getShowGrid()})}toggleArrows(){let e=this.getAxisArrowMode()==="NONE"?"BOTH":"NONE";this.controller.dispatch({type:"set-graph-settings",xAxisArrowMode:e,yAxisArrowMode:e})}showZoomSquareButton(){let e=this.controller.getAxisScaleSettings();return!this.controller.isThreeDMode()&&e.xAxisScale===e.yAxisScale&&!this.controller.getGraphSettings().squareAxes}getContainerStyle(){return this.controller.getKeypadHeight()?"bottom: 0":""}zoomSquare(){this.controller.dispatch({type:"zoom",direction:"square"})}};var Er=__dcg_shared_module_exports__['i'](Z());var{If:q9}=Er.Components,Tw=class extends Er.Class{init(){this.controller=this.props.controller()}template(){return Er.createElement("div",{class:Er.const("dcg-zoom-container")},Er.createElement("div",{class:Er.const("dcg-zoominout-pillbox dcg-btn-flat-gray dcg-btn-flat-gray-group"),style:()=>({background:this.controller.getPillboxBackgroundColor()})},Er.createElement(Pe,{tooltip:()=>this.controller.s("graphing-calculator-label-tooltip-zoom-in"),gravity:this.const("w")},Er.createElement("div",{class:Er.const("dcg-action-zoomin"),role:Er.const("button"),tabindex:Er.const("0"),"aria-label":()=>this.controller.s("graphing-calculator-label-tooltip-zoom-in"),onTap:this.bindFn(this.zoomIn)},Er.createElement("i",{class:Er.const("dcg-icon dcg-icon-plus"),"aria-hidden":Er.const("true")}))),Er.createElement(Pe,{tooltip:()=>this.controller.s("graphing-calculator-label-tooltip-zoom-out"),gravity:this.const("w")},Er.createElement("div",{class:Er.const("dcg-option dcg-action-zoomout dcg-tooltip-e"),tooltip:()=>this.controller.s("graphing-calculator-label-tooltip-zoom-out"),role:Er.const("button"),tabindex:Er.const("0"),"aria-label":()=>this.controller.s("graphing-calculator-label-tooltip-zoom-out"),onTap:this.bindFn(this.zoomOut)},Er.createElement("i",{class:Er.const("dcg-icon dcg-icon-minus"),"aria-hidden":Er.const("true")})))),Er.createElement(Pe,{tooltip:()=>this.controller.s("graphing-calculator-label-tooltip-viewport-default"),gravity:this.const("w")},Er.createElement("div",{class:()=>({"dcg-btn-flat-gray":!0,"dcg-option":!0,"dcg-action-zoomrestore":!0,"dcg-disabled":this.isDefaultViewportRestored()}),"aria-disabled":this.bindFn(this.isDefaultViewportRestored),role:Er.const("button"),tabindex:()=>this.isDefaultViewportRestored()?-1:0,"aria-label":()=>this.controller.s("graphing-calculator-narration-viewport-restore-default"),onTap:this.bindFn(this.setDefaultViewport),style:()=>({background:this.controller.getPillboxBackgroundColor()}),manageFocus:this.const(yt({controller:this.controller,location:{type:"zoom-restore-btn"}}))},Er.createElement("i",{class:Er.const("dcg-icon dcg-icon-home"),"aria-hidden":Er.const("true")}))),Er.createElement(q9,{predicate:()=>this.controller.isThreeDMode()},()=>Er.createElement(Pe,{tooltip:()=>this.controller.s("graphing-calculator-label-tooltip-zoom-default-orientation"),gravity:this.const("w")},Er.createElement("div",{class:()=>({"dcg-btn-flat-gray":!0,"dcg-option":!0,"dcg-action-zoomrestore":!0,"dcg-disabled":this.isDefaultOrientation()}),"aria-disabled":this.bindFn(this.isDefaultOrientation),role:Er.const("button"),tabindex:()=>this.isDefaultOrientation()?-1:0,"aria-label":()=>this.controller.s("graphing-calculator-narration-orientation-restore-default"),onTap:this.bindFn(this.zoomRestoreOrientation),style:()=>({background:this.controller.getPillboxBackgroundColor()}),manageFocus:this.const(yt({controller:this.controller,location:{type:"zoom-restore-btn"}}))},Er.createElement("i",{class:Er.const("dcg-icon dcg-icon-3d-reorient"),"aria-hidden":Er.const("true")})))))}zoomIn(){this.controller.dispatch({type:"zoom",direction:"in"})}zoomOut(){this.controller.dispatch({type:"zoom",direction:"out"})}setDefaultViewport(){this.controller.dispatch({type:"zoom",direction:"default"})}isDefaultViewportRestored(){let e=this.controller.getGrapher();return!!e&&e.viewportController.isDefaultViewportRestored()}zoomRestoreOrientation(){this.controller.dispatch({type:"zoom",direction:"default3dOrientation"})}isDefaultOrientation(){return"grapher3d"in this.controller&&this.controller.grapher3d!==void 0?this.controller.grapher3d.controls.isDefaultOrientation()||this.controller.grapher3d.transition.isAnimating:!0}};var Sa=__dcg_shared_module_exports__['i'](Z());var Aw=class extends Sa.Class{init(){this.controller=this.props.controller()}template(){return Sa.createElement("div",{class:Sa.const("dcg-reset-container")},Sa.createElement(Pe,{tooltip:()=>this.controller.s("graphing-calculator-label-tooltip-reset"),gravity:this.const("w")},Sa.createElement("div",{class:Sa.const("dcg-reset-pillbox dcg-action-reset dcg-btn-flat-gray"),role:Sa.const("button"),tabindex:Sa.const("0"),"aria-label":()=>this.controller.s("graphing-calculator-label-tooltip-reset"),onTap:this.bindFn(this.reset),style:()=>({background:this.controller.getPillboxBackgroundColor()})},Sa.createElement("i",{class:Sa.const("dcg-icon dcg-icon-reset"),"aria-hidden":Sa.const("true")}))))}reset(){this.controller.dispatch({type:"reset-graph"})}};var{If:Lw}=ho.Components,Pw=class extends ho.Class{init(){this.controller=this.props.controller()}template(){return ho.createElement("div",null,ho.createElement(Lw,{predicate:this.bindFn(this.shouldShowContainer)},()=>ho.createElement("div",{class:()=>({"dcg-pillbox-container":!0,"dcg-geometry-toolbar-present":this.controller.isGeoUIActive()}),role:ho.const("group"),"aria-label":()=>this.controller.isGeoUIActive()?void 0:this.controller.s("graphing-calculator-narration-graph-settings-controls")},ho.createElement("div",{class:ho.const("dcg-overgraph-pillbox-elements"),style:this.bindFn(this.getContainerStyle)},ho.createElement(Lw,{predicate:this.bindFn(this.shouldShowGraphSettings)},()=>ho.createElement(Mw,{controller:this.props.controller})),ho.createElement(Lw,{predicate:this.bindFn(this.shouldShowGeometrySettings)},()=>ho.createElement(ah,__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.props),{isPillbox:this.const(!0)}))),ho.createElement(Lw,{predicate:this.bindFn(this.shouldShowResetButton)},()=>ho.createElement(Aw,{controller:this.props.controller})),ho.createElement(Lw,{predicate:this.bindFn(this.shouldShowZoomButtons)},()=>ho.createElement(Tw,{controller:this.props.controller}))))),ho.createElement(Iw,{controller:()=>this.props.controller()}))}getContainerStyle(){let e=this.controller.isKeypadOpen()?this.controller.getKeypadHeight():0;return this.controller.isGraphSettingsOpen()?`bottom: ${e}px;`:"bottom: auto"}shouldShowContainer(){return this.shouldShowGeometrySettings()||this.shouldShowGraphSettings()||this.shouldShowZoomButtons()||this.shouldShowResetButton()}shouldShowGraphSettings(){return this.controller.getGraphSettings().config.settingsMenu&&!this.controller.isGeometry()}shouldShowGeometrySettings(){return this.controller.getGraphSettings().config.settingsMenu&&this.controller.isGeometry()&&this.controller.isNarrowGeometryHeader()}shouldShowZoomButtons(){return this.controller.getGraphSettings().config.zoomButtons&&!this.isViewportLocked()}isViewportLocked(){return this.controller.getGraphSettings().config.lockViewport||this.controller.getGraphSettings().userLockedViewport}shouldShowResetButton(){return this.controller.getGraphSettings().config.showResetButtonOnGraphpaper&&this.controller.hasDefaultState()}};var Cr=__dcg_shared_module_exports__['i'](Z());var Ii=__dcg_shared_module_exports__['i'](Z());var{Each:H9,SwitchUnion:z9,If:$9}=Ii.Components,sE=class extends Ii.Class{init(){this.controller=this.props.controller()}template(){return Ii.createElement("div",{role:Ii.const("toolbar"),"aria-label":()=>this.controller.s("graphing-calculator-label-geometry-tools"),class:Ii.const("dcg-geo-basic-tools dcg-animate-in-after-initial-load dcg-create-transformation-view")},Ii.createElement(im,{ariaLabel:()=>this.controller.s("account-shell-button-mygraphs-cancel"),controller:this.props.controller,message:()=>this.getTransformationName(this.controller.getActiveTool()),onBack:this.bindFn(this.onCancel)}),H9(()=>this.getInputIndexes(),{item:e=>Ii.createElement(qT,{activeStep:this.bindFn(this.getInputIndex),controller:this.props.controller,toolSpec:()=>this.getToolSpec(),stepIdx:()=>e})}))}onCancel(){this.controller.dispatch({type:"select-geo-tool",tool:"selection"}),this.controller.dispatch({type:"set-focus-location",location:{type:"graph-paper"}})}getTransformationName(e){switch(e){case"dilate":return this.controller.s("graphing-calculator-text-geometry-tool-dilate-display-name");case"reflect":return this.controller.s("graphing-calculator-text-geometry-tool-reflect-display-name");case"rotate":return this.controller.s("graphing-calculator-text-geometry-tool-rotate-display-name");case"translate":return this.controller.s("graphing-calculator-text-geometry-tool-translate-display-name");default:return"Unknown"}}getInputIndex(){return this.controller.getGeoModel().getNonObjectsState().ui.currentTool.inputIndex}getInputIndexes(){return this.getToolSpec().inputs.map((e,r)=>r)}getToolSpec(){return this.controller.getGeoModel().getCurrentTool().getSpec()}},qT=class extends Ii.Class{init(){this.controller=this.props.controller()}template(){return z9(()=>this.getInputType(),{completed:()=>Ii.createElement("span",{class:Ii.const("dcg-step-completed")},Ii.createElement("i",{class:Ii.const("dcg-icon-check")})),upcoming:()=>Ii.createElement("span",{class:Ii.const("dcg-step-upcoming")},Ii.createElement("span",null)),active:()=>Ii.createElement("span",{class:Ii.const("dcg-active-step")},Ii.createElement("span",{class:Ii.const("dcg-step-active-icon")},Ii.createElement("span",null,()=>this.props.stepIdx()+1)),this.bindFn(this.getActiveString),Ii.createElement($9,{predicate:this.bindFn(this.isNumberInputStep)},()=>Ii.createElement("span",{class:Ii.const("dcg-input-flex-container"),didMount:this.bindFn(this.didMountNumberInput)},Ii.createElement(lr,{containerClass:()=>({"dcg-suffix-degree":this.getNumberUnits()==="\xB0","dcg-suffix-radian":this.getNumberUnits()==="rad"}),readonly:()=>!1,latex:()=>this.getNumberInputLatex(),ariaLabel:this.bindFn(this.getActiveString),isFocused:()=>this.isNumberInputFocused(),handleFocusChanged:(e,r)=>this.handleFocusedChanged(e,r),hasError:this.bindFn(this.doesNumberInputHaveError),controller:this.props.controller,handlePressedKey:(e,r)=>{this.handlePressedKey(e,r)},handleLatexChanged:e=>{this.handleLatexChanged(e)},dataLabelAttributeValue:this.const("transformation-number")}),Ii.createElement("span",{class:()=>({"dcg-action-submit":!0,"dcg-disabled":this.isSubmitNumberDisabled(),"dcg-btn-blue":!0}),role:Ii.const("button"),tabindex:()=>this.isSubmitNumberDisabled()?-1:0,"aria-disabled":this.bindFn(this.isSubmitNumberDisabled),onTap:e=>this.submitNumberInput({device:e.device})},()=>this.controller.raw("Go")))))})}getNumberUnits(){return this.controller.getActiveTool()==="rotate"?this.controller.isDegreeMode()?"\xB0":"rad":""}didMountNumberInput(){this.controller.dispatch({type:"set-focus-location",location:{type:"new-transformation-number"}})}isNumberInputFocused(){let e=this.controller.getFocusLocation();return!!(e&&e.type==="new-transformation-number")}doesNumberInputHaveError(){if(!this.getNumberInputLatex()||this.getNumberInputLatex()===this.getStep().defaultLatex)return!1;let r=this.props.toolSpec().outputs[0].id,{idMap:i}=this.controller.getGeoModel().getNonObjectsState().ui.currentTool,n=i[r];if(!n)return!0;let o=Mg(this.controller.getListModel()).filter(l=>{var c;if(l.type==="expression")return n===((c=hs(l))==null?void 0:c.latex)}),s=o[0];if(!s||o.length===0||o.length>1||s.error)return!0;let a=s.formula.typed_constant_value;return!a||!__dcg_shared_module_exports__['yb'](a.valueType,__dcg_shared_module_exports__['pb'])}handlePressedKey(e,r){let i=Xe.getFocusedMathquill();if(e==="Enter"){this.submitNumberInput({device:"keyboard"});return}i&&(i.keystroke(e,r),this.handleLatexChanged(i.latex()))}getNumberInputLatex(){return this.controller.getGeoModel().getCurrentTool().getNumberInputLatex()}isSubmitNumberDisabled(){return!!(this.doesNumberInputHaveError()||!this.getNumberInputLatex())}submitNumberInput(e){var a,l,c;if(this.isSubmitNumberDisabled())return;let r=this.controller.getGeoModel(),i=this.controller.getActiveTool(),n=r.getCurrentTool(),o=(a=n.getSpec)==null?void 0:a.call(n),s=n.tryCommitResults();s.committed&&(this.controller.dispatch(__dcg_shared_module_exports__['b']({type:"commit-geo-objects"},s)),(c=(l=this.controller.getGrapher())==null?void 0:l.poiController)==null||c.speakReleaseAndUpdate(i,o,s.committed),e.device==="keyboard"&&this.controller.dispatch({type:"set-focus-location",location:{type:"graph-paper"}}))}handleLatexChanged(e){this.getNumberInputLatex()!==e&&(this.controller.getGeoModel().getCurrentTool().onNumberInput(e),this.controller.getGeoModel().onPreviewChange())}handleFocusedChanged(e,r){e&&!this.isNumberInputFocused()?this.controller.dispatch({type:"set-focus-location",location:{type:"new-transformation-number"}}):this.isNumberInputFocused()&&this.controller.dispatch({type:"blur-focus-location",location:{type:"new-transformation-number"}})}getActiveString(){let e=this.getStep().hint;return e?this.props.controller().s(e):this.props.controller().raw("unknown instruction")}isNumberInputStep(){return this.getStep().type==="number"}getStep(){return this.props.toolSpec().inputs[this.props.stepIdx()]}getInputType(){let e=this.props.activeStep(),r=this.props.stepIdx();return r<e?"completed":r>e?"upcoming":"active"}};var{SwitchUnion:W9,If:aE}=Cr.Components,lE=class extends Cr.Class{constructor(){super(...arguments),this.afterInitialLoad=!1}init(){this.controller=this.props.controller()}template(){return Cr.createElement("div",{class:()=>({"dcg-geometry-toolbar-view":!0,"dcg-after-initial-load":this.afterInitialLoad}),style:()=>({left:`${this.controller.computeMajorLayout().grapher.left}px`}),onTapStart:this.bindFn(this.onTapStart)},Cr.createElement("div",{class:Cr.const("dcg-header-left dcg-do-blur")},Cr.createElement(aE,{predicate:this.bindFn(this.showHamburger)},()=>Cr.createElement(Pe,{tooltip:()=>this.controller.s("graphing-calculator-label-tooltip-open-graph"),gravity:this.const("se")},Cr.createElement("div",{role:Cr.const("button"),"aria-label":()=>this.controller.s("graphing-calculator-label-tooltip-open-graph"),tabindex:Cr.const("0"),class:Cr.const("dcg-action-opendrawer dcg-icon-btn dcg-in-api-action-opendrawer"),onTap:()=>this.controller.dispatch({type:"open-drawer"})},Cr.createElement("i",{class:Cr.const("dcg-icon-hamburger"),"aria-hidden":Cr.const("true")})))),Cr.createElement(aE,{predicate:this.bindFn(this.showOpenExpressionsButton)},()=>Cr.createElement("div",{class:Cr.const("dcg-show-expressions-tab dcg-icon-btn"),"aria-label":()=>this.controller.s("graphing-calculator-label-tooltip-show-list"),role:Cr.const("button"),tabindex:Cr.const("0"),onTap:e=>{this.controller.dispatch({type:"show-expressions-list",focusHideIcon:e.device==="keyboard"})},manageFocus:this.const(yt({controller:this.controller,location:{type:"show-expression-list-btn"}}))},Cr.createElement("i",{class:Cr.const("dcg-icon-show"),"aria-hidden":Cr.const("true")}))),Cr.createElement(aE,{predicate:this.bindFn(this.showUndoRedo)},()=>Cr.createElement("div",{class:()=>({"dcg-geo-undo-redo-container":!0,"dcg-overgraph-undo-redo":this.undoRedoOverGraph()})},Cr.createElement(vm,__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},this.props),{undoTooltipGravity:this.const("se"),redoTooltipGravity:this.const("s")}))))),Cr.createElement("div",{class:Cr.const("dcg-flex-spacer")}),W9(this.bindFn(this.getViewToShow),{tools:()=>Cr.createElement(HS,{controller:this.props.controller}),selectedItems:()=>Cr.createElement(DD,{controller:this.props.controller}),createTransformation:()=>Cr.createElement(sE,{controller:this.props.controller})}),Cr.createElement("div",{class:Cr.const("dcg-flex-spacer")}),Cr.createElement("div",{class:Cr.const("dcg-header-right dcg-do-blur")},Cr.createElement(aE,{predicate:()=>this.controller.getGraphSettings().config.settingsMenu&&!this.controller.isNarrowGeometryHeader()},()=>Cr.createElement(ah,__dcg_shared_module_exports__['b']({},this.props)))))}undoRedoOverGraph(){return this.controller.isNarrowGeometryHeader()}showUndoRedo(){return!this.controller.isListEnabled()}showHamburger(){return this.controller.getGraphSettings().config.showHamburger?!this.controller.isListEnabled()||!this.controller.isListVisible()||this.controller.isNarrow():!1}showOpenExpressionsButton(){return this.controller.isListEnabled()&&!this.controller.isListVisible()&&!this.controller.isNarrow()}willUpdate(){this.afterInitialLoad||this.getViewToShow()==="selectedItems"&&(this.afterInitialLoad=!0)}onTapStart(e){e.target.classList.contains("dcg-do-blur")&&this.controller.dispatch({type:"set-none-selected"})}getViewToShow(){return __dcg_shared_module_exports__['gc'](this.controller.getActiveTool())?"createTransformation":this.controller.getSelectedGeoExpression()||this.controller.hasMultipleItemsSelected()?"selectedItems":"tools"}};var dr=__dcg_shared_module_exports__['i'](Z());var{If:Ow}=dr.Components,HT=class extends dr.Class{init(){this.controller=this.props.controller()}template(){return dr.createElement("span",{class:dr.const("dcg-toast")},dr.createElement("i",{class:dr.const("dcg-icon-error"),"aria-hidden":dr.const("true")}),dr.createElement(Ow,{predicate:()=>!this.showUndo()},()=>dr.createElement("i",{class:dr.const("dcg-icon-remove"),onTap:()=>this.controller.dispatch({type:"toast/close"}),role:dr.const("link"),tabindex:dr.const(0),"aria-label":dr.const("Dismiss Notice")})),dr.createElement("span",{class:dr.const("dcg-msg"),"aria-atomic":()=>this.shouldLiveUpdateAria(),"aria-live":()=>this.shouldLiveUpdateAria()?"assertive":""},()=>this.controller.toastData.message),dr.createElement(Ow,{predicate:this.bindFn(this.showUndo)},()=>dr.createElement("a",{role:dr.const("link"),tabindex:dr.const(0),class:dr.const("dcg-undo"),onTap:()=>this.controller.dispatch({type:"toast/undo"})},()=>this.controller.s("shared-calculator-label-toast-undo"))),dr.createElement(Ow,{predicate:this.bindFn(this.showLearnMore)},()=>dr.createElement("a",{role:dr.const("link"),tabindex:dr.const(0),target:dr.const("_blank"),onTap:()=>this.controller.dispatch({type:"toast/learn-more"})},()=>this.controller.s("shared-calculator-label-toast-learn-more"))),dr.createElement(Ow,{predicate:()=>!!this.controller.toastData.link},()=>dr.createElement("a",{role:dr.const("link"),tabindex:dr.const(0),target:dr.const("_blank"),href:()=>{var e;return((e=this.controller.toastData.link)==null?void 0:e.url)||""}},()=>{var e;return((e=this.controller.toastData.link)==null?void 0:e.text)||""})))}showUndo(){return!!this.controller.toastData.undoCallback}showLearnMore(){return!!this.controller.toastData.learnMoreCallback}shouldUpdate(){return!!this.controller.toastData.message}shouldLiveUpdateAria(){return!this.controller.toastData.noAria}},cE=class extends dr.Class{template(){return dr.createElement("div",{class:()=>({"dcg-toast-view":!0,"dcg-visible":!!this.props.controller().toastData.message,"dcg-below-geo-toolbar":this.isGeometryInCalculator()}),"toast-style":()=>this.props.controller().toastData.toastStyle},dr.createElement(Ow,{predicate:()=>!!this.props.controller().toastData.message},()=>dr.createElement("div",{class:dr.const("dcg-toast-wrapper")},dr.createElement("div",{class:dr.const("dcg-toast-cover")}),dr.createElement(HT,__dcg_shared_module_exports__['b']({},this.props)))))}isGeometryInCalculator(){var r;let e=this.props.controller();return(r=e.isGeometry)==null?void 0:r.call(e)}};function zT(t){let e="drag dragend dragenter dragover dragleave drop";t.on(e,r=>{r.preventDefault(),r.stopPropagation()})}var Gt=__dcg_shared_module_exports__['i'](Z());Oe();var{If:_w}=Gt.Components,Fw=class extends Gt.Class{init(){this.controller=this.props.controller()}template(){return Gt.createElement("div",{class:()=>({"dcg-geometry-settings-container":!0,"dcg-popover":!0,"dcg-constrained-height-popover":!0,"dcg-generic-options-menu":!0,"dcg-narrow-geometry-header":this.controller.isNarrowGeometryHeader()}),style:this.bindFn(this.getContainerStyle),didMount:this.bindFn(this.didMountContainer),didUnmount:this.bindFn(this.didUnmountContainer)},Gt.createElement("div",{class:Gt.const("dcg-popover-interior"),role:Gt.const("complementary"),"aria-label":()=>this.controller.s("graphing-calculator-label-tooltip-geometry-settings")},Gt.createElement("div",{class:Gt.const("dcg-options-menu-section")},Gt.createElement(Dt,{onChange:this.bindFn(this.toggleInvertedColors),checked:()=>this.controller.getInvertedColors(),manageFocus:this.const(yt({controller:this.controller,location:{type:"settings",location:"reverse-contrast"}}))},()=>this.controller.s("graphing-calculator-label-settings-reverse-contrast")),Gt.createElement(_w,{predicate:()=>!this.controller.getLockViewportConfigSetting()},()=>Gt.createElement("div",{class:Gt.const("dcg-checkbox-title dcg-lock-viewport-option")},Gt.createElement(Dt,{onChange:()=>{this.controller.dispatch({type:"toggle-lock-viewport"})},checked:()=>this.controller.getLockViewportUserSetting()},()=>this.controller.s("graphing-calculator-label-settings-lock-viewport")),Gt.createElement(gu,{href:this.const("https://help.desmos.com/hc/en-us/articles/4405296853517#h_01FZX4DBWKD83TZVMH615XF3QA"),controller:this.props.controller})))),Gt.createElement("div",{class:Gt.const("dcg-options-menu-section")},Gt.createElement("div",{class:Gt.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-label-settings-grid"),Gt.createElement(pn,{ariaLabel:()=>this.controller.s("graphing-calculator-label-settings-grid"),toggled:this.bindFn(this.getShowGrid),onChange:this.bindFn(this.toggleGrid)})),Gt.createElement(_w,{predicate:this.bindFn(this.getShowGrid)},()=>Gt.createElement(Dt,{onChange:this.bindFn(this.toggleMinorGridlines),checked:this.bindFn(this.getMinorGridlines)},()=>this.controller.s("graphing-calculator-label-settings-minor-gridlines")))),Gt.createElement("div",{class:Gt.const("dcg-options-menu-section")},Gt.createElement("div",{class:Gt.const("dcg-options-menu-section-title")},()=>this.controller.s("graphing-calculator-label-axes"),Gt.createElement(pn,{ariaLabel:()=>this.controller.s("graphing-calculator-label-axes"),toggled:this.bindFn(this.getShowAxes),onChange:this.bindFn(this.toggleAxes)})),Gt.createElement(_w,{predicate:this.bindFn(this.getShowAxes)},()=>Gt.createElement("div",null,Gt.createElement(Dt,{onChange:this.bindFn(this.toggleAxisNumbers),checked:this.bindFn(this.getAxisNumbers)},()=>this.controller.s("graphing-calculator-label-settings-axis-numbers")),Gt.createElement("div",null,Gt.createElement(Dt,{onChange:this.bindFn(this.toggleArrows),checked:()=>this.getAxisArrowMode()!=="NONE"},()=>this.controller.s("graphing-calculator-label-settings-arrows")))))),Gt.createElement(_w,{predicate:this.bindFn(this.shouldShowBrailleSection)},()=>Gt.createElement("div",{class:Gt.const("dcg-options-menu-section")},Gt.createElement("div",{class:Gt.const("dcg-options-menu-section-title")},()=>this.controller.s("shared-calculator-narration-braille-mode"),Gt.createElement(pn,{ariaLabel:()=>this.controller.s("shared-calculator-narration-braille-mode"),onChange:this.bindFn(this.toggleBrailleMode),toggled:()=>this.controller.getBrailleMode()!=="none"})),Gt.createElement(_w,{predicate:()=>this.controller.getBrailleMode()!=="none"},()=>Gt.createElement("div",{class:Gt.const("dcg-braille-options-container")},Gt.createElement("div",{class:Gt.const("dcg-braille-options-buttons")},Gt.createElement(jr,{ariaGroupLabel:()=>this.controller.s("shared-calculator-narration-braille-mode"),staticConfig:this.bindFn(this.getBrailleOptions)})),Gt.createElement("div",{class:Gt.const("dcg-checkbox-title dcg-six-key-checkbox")},Gt.createElement(Dt,{onChange:e=>this.controller.dispatch({type:"set-six-key-input",useSixKeyInput:e}),checked:()=>this.controller.getSixKeyInput()},()=>this.controller.s("graphing-calculator-label-settings-six-key-braille")),Gt.createElement(gu,{href:this.const("https://www.desmos.com/accessibility#braille"),controller:this.props.controller})),Gt.createElement("div",{class:Gt.const("dcg-refreshable-braille-note")},()=>this.controller.s("graphing-calculator-text-refreshable-braille-display-note")+" ",Gt.createElement("a",{href:()=>"https://www.desmos.com/braille-examples?"+this.controller.getBrailleMode(),class:Gt.const("dcg-shared-blue-link"),target:Gt.const("_blank")},()=>this.controller.s("graphing-calculator-link-view-braille-examples"))))))),Gt.createElement("div",{class:Gt.const("dcg-options-menu-section dcg-radiangroup")},Gt.createElement(jr,{ariaGroupLabel:()=>this.controller.s("graphing-calculator-narration-settings-angle"),staticConfig:this.bindFn(this.getAngleModeOptions)}))))}shouldShowBrailleSection(){return this.controller.getBrailleControls()&&this.controller.getGraphSettings().config.expressions}getAngleModeOptions(){return[{key:"radians",label:()=>this.controller.s("graphing-calculator-button-settings-radians"),selected:()=>!this.getDegreeMode(),onSelect:()=>this.setDegreeMode(!1),focusHelperOptions:{controller:this.controller,location:{type:"settings",location:"radian-mode"}}},{key:"degrees",label:()=>this.controller.s("graphing-calculator-button-settings-degrees"),selected:()=>this.getDegreeMode(),onSelect:()=>this.setDegreeMode(!0),focusHelperOptions:{controller:this.controller,location:{type:"settings",location:"degree-mode"}}}]}getDegreeMode(){return!!this.controller.getGraphSettings().degreeMode}setDegreeMode(e){this.controller.dispatch({type:"set-graph-settings",degreeMode:e})}toggleBrailleMode(){this.controller.dispatch({type:"set-braille-mode",mode:this.controller.getBrailleMode()==="none"?"nemeth":"none"})}getBrailleOptions(){return[{key:"nemeth",label:()=>this.controller.s("shared-calculator-button-braille-mode-nemeth"),selected:()=>this.controller.getBrailleMode()==="nemeth",onSelect:()=>this.setBrailleMode("nemeth")},{key:"ueb",label:()=>this.controller.s("shared-calculator-button-braille-mode-ueb"),selected:()=>this.controller.getBrailleMode()==="ueb",onSelect:()=>this.setBrailleMode("ueb")}]}setBrailleMode(e){this.controller.dispatch({type:"set-braille-mode",mode:e})}didMountContainer(e){this.node=e,I(document).on("dcg-tapstart.geometry-settings-view wheel.geometry-settings-view",r=>{this.eventShouldClosePopover(r)&&this.controller.dispatch({type:"close-graph-settings",focusIconAfterClose:r.device==="keyboard"})}),I(document).on("keydown.geometry-settings-view",r=>{let i=Te(r);if(i==="Esc"&&this.controller.dispatch({type:"close-graph-settings",focusIconAfterClose:!0}),this.controller.isGraphSettingsOpen()&&i==="Tab"&&!r.altKey&&!r.metaKey&&!r.ctrlKey){let n=this.controller.getFocusLocation();if(!n||n.type!=="settings")return;r.shiftKey?r.shiftKey&&(n.location==="reverse-contrast"?(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"icon"}}),r.preventDefault(),r.stopPropagation()):n.location==="icon"&&(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"degree-mode"}}),r.preventDefault(),r.stopPropagation())):n.location==="icon"?(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"reverse-contrast"}}),r.preventDefault(),r.stopPropagation()):n.location==="degree-mode"&&(this.controller.dispatch({type:"set-focus-location",location:{type:"settings",location:"icon"}}),r.preventDefault(),r.stopPropagation())}})}didUnmountContainer(){I(document).off(".geometry-settings-view")}didUpdate(){if(!this.controller.isGraphSettingsOpen())return;let e=this.controller.getKeypadHeight();e!==this.cachedKeypadHeight&&document.activeElement&&I(document.activeElement).closest(this.node).length&&Ba(I(document.activeElement),I(this.node).find(".dcg-popover-interior"),50),this.cachedKeypadHeight=e}eventShouldClosePopover(e){let r=I(e.target),i=!!r.closest(this.node).length,n=!!r.closest(".dcg-action-settings").length,o=this.isMathquillFocused()&&r.closest(".dcg-keypad").length,s=!!r.closest(".dcg-action-undo").length||!!r.closest(".dcg-action-redo").length;return!(i||n||o||s)}isMathquillFocused(){return this.getFocusedLimit()!==void 0}getFocusedLimit(){let e=this.controller.getFocusLocation();if(e&&e.type==="settings")return e.location}getShowXAxis(){return!!this.controller.getGraphSettings().showXAxis}toggleAxes(){this.controller.dispatch({type:"set-graph-settings",showXAxis:!this.getShowXAxis(),showYAxis:!this.getShowXAxis()})}getShowAxes(){return!!this.controller.getGraphSettings().showXAxis}getAxisNumbers(){return!!this.controller.getGraphSettings().xAxisNumbers}toggleAxisNumbers(){let e=this.getAxisNumbers();this.controller.dispatch({type:"set-graph-settings",xAxisNumbers:!e,yAxisNumbers:!e,polarNumbers:!e})}getMinorGridlines(){return this.controller.getGraphSettings().xAxisMinorSubdivisions===0}toggleMinorGridlines(){let e=this.getMinorGridlines()?1:0;this.controller.dispatch({type:"set-graph-settings",yAxisMinorSubdivisions:e,xAxisMinorSubdivisions:e})}toggleInvertedColors(){this.controller.dispatch({type:"set-inverted-colors",value:!this.controller.getInvertedColors()})}getAxisArrowMode(){return this.controller.getGraphSettings().xAxisArrowMode}getShowGrid(){return this.controller.getGraphSettings().showGrid}toggleGrid(){this.controller.dispatch({type:"set-graph-settings",showGrid:!this.getShowGrid()})}toggleArrows(){let e=this.getAxisArrowMode()==="NONE"?"BOTH":"NONE";this.controller.dispatch({type:"set-graph-settings",xAxisArrowMode:e,yAxisArrowMode:e})}getContainerStyle(){return this.controller.getKeypadHeight()?"bottom: 0":""}};var{If:mu}=Jt.Components,Rw=class extends Jt.Class{init(){this.controller=this.props.controller()}settings(){return this.controller.getGraphSettings()}template(){return Jt.createElement("div",{class:Jt.const("dcg-calculator-api-container"),style:Jt.const("width: 100%; height: 100%; position: relative;")},Jt.createElement("div",{class:()=>({"dcg-container":!0,"dcg-fullscreen":!this.controller.isListVisible(),"dcg-narrow":this.controller.isNarrow(),"dcg-PROJECTOR-MODE":this.settings().config.projectorMode,"dcg-inverted-colors":!!this.settings().config.invertedColors,"dcg-inverted-swatches":this.controller.invertSwatches(),"dcg-EDIT-LIST-MODE":this.controller.isInEditListMode(),"dcg-no-graphpaper":!this.settings().config.graphpaper,"dcg-no-branding":!this.settings().config.branding,"dcg-no-expression-topbar":!this.settings().config.expressionsTopbar,"dcg-default-border":!!this.settings().config.border,"dcg-no-hyperlinks":!this.settings().config.links,"dcg-has-background-color":this.controller.hasBackgroundColor(),"dcg-is-interactive":this.settings().config.expressions||!(this.settings().config.lockViewport||this.settings().userLockedViewport)}),style:()=>({"font-size":this.settings().config.fontSize+"px",background:this.getContainerBackgroundColor(),color:this.controller.getTextColor()}),role:Jt.const("application"),"aria-label":()=>this.controller.isGeometry()?this.controller.s("graphing-calculator-narration-main-desmos-geometry"):this.controller.s("graphing-calculator-narration-main-desmos-graphing-calculator"),"x-ms-format-detection":Jt.const("none"),didMount:this.bindFn(this.didMountRoot)},Jt.createElement(mu,{predicate:()=>this.controller.getGraphSettings().config.expressions},()=>Jt.createElement(vw,{controller:this.props.controller})),Jt.createElement($S,{controller:this.props.controller}),Jt.createElement(mu,{predicate:()=>this.controller.isListEnabled()&&!this.controller.isListVisible()&&(!this.controller.isGeometry()||this.controller.isNarrow())},()=>Jt.createElement("div",{class:()=>({"dcg-overgraph-icon-container":!0,"dcg-bottom-right":this.controller.isNarrow()})},Jt.createElement(Pe,{tooltip:()=>this.controller.s("graphing-calculator-label-tooltip-show-list"),gravity:()=>this.controller.isNarrow()?"nw":"se"},Jt.createElement("div",{class:()=>({"dcg-show-expressions-tab":!0,"dcg-overgraph-icon":!0,"dcg-rotated":this.controller.isNarrow()}),"aria-label":()=>this.controller.s("graphing-calculator-label-tooltip-show-list"),role:Jt.const("button"),tabindex:Jt.const("0"),onTap:e=>{this.controller.dispatch({type:"show-expressions-list",focusHideIcon:e.device==="keyboard"})},manageFocus:this.const(yt({controller:this.controller,location:{type:"show-expression-list-btn"}}))},Jt.createElement("i",{class:Jt.const("dcg-icon-show"),"aria-hidden":Jt.const("true")}))))),Jt.createElement(mu,{predicate:this.bindFn(this.showHamburger)},()=>Jt.createElement("div",{class:Jt.const("dcg-overgraph-icon-container")},Jt.createElement(Pe,{tooltip:()=>this.controller.s("graphing-calculator-label-tooltip-open-graph"),gravity:this.const("se")},Jt.createElement("div",{role:Jt.const("button"),"aria-label":()=>this.controller.s("graphing-calculator-label-tooltip-open-graph"),class:Jt.const("dcg-action-opendrawer dcg-in-api-action-opendrawer dcg-overgraph-icon"),onTap:()=>this.controller.dispatch({type:"open-drawer"})},Jt.createElement("i",{class:Jt.const("dcg-icon-hamburger"),"aria-hidden":Jt.const("true")}))))),Jt.createElement(Pw,{controller:this.props.controller}),Jt.createElement(mu,{predicate:()=>this.controller.isGeoUIActive()&&this.controller.getGraphSettings().config.settingsMenu&&this.controller.isGraphSettingsOpen()},()=>Jt.createElement(Fw,{controller:this.props.controller})),Jt.createElement(mu,{predicate:()=>this.controller.isGeoUIActive()},()=>Jt.createElement(lE,{controller:this.props.controller})),Jt.createElement(cE,{controller:this.props.controller}),Jt.createElement("div",{class:Jt.const("dcg-grapher dcg-grapher-2d"),style:()=>({visibility:this.controller.isThreeDMode()?"hidden":"visible","pointer-events":this.controller.isThreeDMode()?"none":"auto"})}),Jt.createElement(mu,{predicate:()=>this.controller.is3D()},()=>Jt.createElement("div",{class:Jt.const("dcg-grapher dcg-grapher-3d"),style:()=>({visibility:this.controller.isThreeDMode()?"visible":"hidden","pointer-events":this.controller.isThreeDMode()?"auto":"none"})})),Jt.createElement(mu,{predicate:()=>this.controller.getGraphSettings().config.keypad},()=>Jt.createElement(rE,{controller:this.props.controller}))))}showHamburger(){return!this.controller.getGraphSettings().config.showHamburger||this.controller.isGeometry()?!1:this.controller.isNarrow()}getContainerBackgroundColor(){return this.controller.hasTransparentBackground()?"none":this.controller.getBackgroundColor()}didMountRoot(e){Mh(e),this.controller.getGraphSettings().config.disableScrollFix||ZD(e),this.setupFileDragDrop(e)}setupFileDragDrop(e){let r=I(e);zT(r);let i=I(),n=this;function o(){i=I(),r.off(".filedraggedover"),n.controller.dispatch({type:"file-is-not-dragged-over"})}r.on("dragenter",s=>{this.controller.areImagesEnabled()&&(i.length===0&&r.on("dcg-tapstart.filedraggedover",o),i=i.add(s.target),this.controller.dispatch({type:"file-is-dragged-over"}))}).on("dragleave",s=>{i=i.not(s.target),i.length===0&&o()}).on("drop",o)}};var dE=class extends Lr{constructor(r){super();this.workerPool=r,this.guid=__dcg_shared_module_exports__['L']("worker-pool-connection"),this.worker=r.allocateWorker(),this.worker.__connections[this.guid]=this}destroy(){this.sendMessage({type:"destroy"}),delete this.worker.__connections[this.guid]}killWorker(){this.worker.__isFake||this.workerPool.killWorker(this.worker)}onWorkerKilled(){}onResponse(r){}sendMessage(r){this.worker.__isFake?this.worker.postMessage(r):this.worker.postMessage({connectionId:this.guid,originalMessage:r})}};function A3(t){var e={},r=new __dcg_shared_module_exports__['cd'](i);function i(n,o){t({type:n,payload:o})}return e.postMessage=function(n){setTimeout(function(){r.processChangeSet(n)},0)},e}Xp();var Nw="";try{Nw=Ud(window.location.search,"workerThrottle"),Nw==null&&(Nw=Ud(window.top.location.search,"workerThrottle"))}catch(t){}var L3=parseInt(Nw,10),$T=0;function P3(t){return L3?function(e){$T=Math.max(Date.now(),$T)+L3,setTimeout(t,$T-Date.now(),e)}:t}var Km=class extends Lr{constructor(r=1/0){super();this.workers=[],this.maxWorkers=r}allowedToSpawnWorker(){return!!__dcg_worker_source_exports__['createWorker']&&this.workers.length<this.maxWorkers}killWorker(r){var i=__dcg_shared_module_exports__['z'](this.workers,r);i!==-1&&(r.terminate(),this.workers=__dcg_shared_module_exports__['x'](this.workers,r),__dcg_shared_module_exports__['t'](__dcg_shared_module_exports__['D'](r.__connections)).forEach(function(n){n&&n.onWorkerKilled&&n.onWorkerKilled()}))}spawnWorker(){if(!__dcg_worker_source_exports__['createWorker'])return null;try{var r=__dcg_worker_source_exports__['createWorker']();return r.__connections={},r.__isFake=!1,r.onerror=function(i){__dcg_shared_module_exports__['M'].log(i)},r.addEventListener("message",P3(function(i){var n=i.data;if(!(n&&n.log)&&n&&n.connectionId){var o=r.__connections[n.connectionId];o&&o.onResponse(n.originalMessage)}})),this.workers.push(r),r}catch(i){return null}}spawnFakeWorker(){var r=A3(P3(function(i){var n=__dcg_shared_module_exports__['D'](r.__connections)[0];n&&n.onResponse(i)}));return r.__isFake=!0,r.__connections={},r}findLeastUsedWorker(){var r=function(n){return __dcg_shared_module_exports__['w'](n.__connections)},i=__dcg_shared_module_exports__['u'](this.workers,r)[0];return i}allocateWorker(){var r=null;return this.allowedToSpawnWorker()&&(r=this.spawnWorker()),r||(r=this.findLeastUsedWorker()),r||(r=this.spawnFakeWorker()),r}};var j9=4e3,lp=class{constructor(e){this.__ticksEnabled=!0;this.listeners={processChangeSet(e){var r={},i={};for(var n in e.graphChanges){var o=e.graphChanges[n];o===void 0?i[n]=!0:(__dcg_shared_module_exports__['Vb'](o),r[n]=o)}var s={};for(var n in e.intersectionChanges)i[n]||(s[n]=e.intersectionChanges[n]);var a=!!this.changeSet;this.onEvaluatorResults({evaluationStates:e.statusChanges,graphData:{addedGraphs:r,removedGraphs:i,intersections:s},renderSlowly:!!e.isCompleteState,timingData:e.timingData,eventUpdates:e.eventUpdates});let l=e.syncId;for(;this.syncRequests.length&&l!==void 0&&this.syncRequests[0].id<=l;)this.syncRequests.shift().callback();this.markJobFinished(),a&&this._processChangeSet()}};this.__state={},this.changeSet=null,this.cumulativeChangeSet={},this.syncId=1,this.syncRequests=[],e||(e=new Km),this.workerPool=e,this.createWorkerPoolConnection()}privateGetWorkerPool(){return this.workerPool}privateGetWorkerPoolConnection(){return this.workerPoolConnection}createWorkerPoolConnection(){this.workerPoolConnection&&(this.workerPoolConnection.onResponse=function(){},this.workerPoolConnection.onWorkerKilled=function(){}),this.workerPoolConnection=new dE(this.workerPool),this.markJobFinished(),this.workerPoolConnection.onResponse=e=>{this.shouldIgnoreWorkerMessage(e)?e.type==="processChangeSet"&&(this.markJobFinished(),this._processChangeSet()):this.listeners[e.type].call(this,e.payload)},this.workerPoolConnection.onWorkerKilled=()=>{var e=this.hasJobInWorker();this.createWorkerPoolConnection(),e?(this.changeSet=__dcg_shared_module_exports__['N'](this.cumulativeChangeSet),this.__state.changed=!0,this.__state.droppedMessage=!0):(this.changeSet=__dcg_shared_module_exports__['N'](this.cumulativeChangeSet),this.__state.changed=!1),this.processChangeSet()}}destroy(){this.workerPoolConnection&&(this.workerPoolConnection.onResponse=function(){},this.workerPoolConnection.onWorkerKilled=function(){},this.workerPoolConnection.destroy())}shouldIgnoreWorkerMessage(e){return this.__suspendUntilSyncId?!e||!e.payload?!0:!(e.payload.syncId>=this.__suspendUntilSyncId):!1}suspend(){(!this.changeSet||!this.changeSet.syncId)&&(this.syncId++,this.applyToChangeSets(e=>{e.syncId=this.syncId})),this.__suspendUntilSyncId=this.changeSet.syncId}markJobFinished(){this.__state.droppedMessage=!1,this.__jobStartTime=-1,this.__suspendUntilSyncId=void 0}startJobTimer(){this.__jobStartTime=new Date().getTime()}hasJobInWorker(){return this.__jobStartTime!==-1}getJobElapsedTime(){return this.hasJobInWorker()?new Date().getTime()-this.__jobStartTime:NaN}setTicksEnabled(e){this.__ticksEnabled=e}tick(){this.__ticksEnabled&&this._processChangeSet()}processChangeSet(){this.__processChangeSetRequested=!0}_processChangeSet(){if(this._syncEvaluatorConfig(),!this.__processChangeSetRequested)return;let e=this.getJobElapsedTime()>=j9;if(this.__state.droppedMessage&&e){this.workerPoolConnection.killWorker();return}if(this.__state.changed&&this.changeSet)if(this.changeSet.syncId||(this.syncId++,this.changeSet.syncId=this.syncId),this.hasJobInWorker())this.changeSet.isCompleteState&&e&&this.workerPoolConnection.killWorker();else{let r=this.changeSet;this.changeSet=null,this.__state.changed=!1,this.startJobTimer(),this.workerPoolConnection.sendMessage(r),this.__processChangeSetRequested=!1}}notifyWhenSynced(e){if(this._syncEvaluatorConfig(),!this.hasJobInWorker()&&!this.changeSet){setTimeout(e,0);return}this.syncId++,this.syncRequests.push({id:this.syncId,callback:e}),this.applyToChangeSets(r=>{r.syncId=this.syncId})}applyToChangeSets(e){this.__state.changed=!0,this.changeSet||(this.changeSet={}),this.cumulativeChangeSet||(this.cumulativeChangeSet={}),e(this.changeSet),e(this.cumulativeChangeSet),this.processChangeSet()}clearStatementsAndStartCompleteState(){this.hasJobInWorker()&&this.suspend(),this.applyToChangeSets(function(e){e.isCompleteState=!0,delete e.statements})}markUndoRedoState(){this.applyToChangeSets(function(e){e.isUndoRedoState=!0})}addStatement(e){this.applyToChangeSets(function(r){r.statements||(r.statements={}),r.statements[e.id]=__dcg_shared_module_exports__['N'](e)})}removeStatement(e){this.applyToChangeSets(function(r){r.statements||(r.statements={}),r.removes||(r.removes={}),delete r.statements[e],r.removes[e]=!0})}addActionStepEvent(e){this.applyToChangeSets(function(r){r.events||(r.events=[]),r.events.push({type:"step",expressionId:e})})}addClockTickEvent(e,r){this.applyToChangeSets(function(i){i.events||(i.events=[]),i.events.push({type:"clock-tick",id:e,isFirstTick:r})})}addClickEvent(e,r){this.applyToChangeSets(function(i){i.events||(i.events=[]),r===void 0&&(r=0),i.events.push({type:"click",expressionId:e,indexVar:r})})}_syncEvaluatorConfig(){if(this.readEvaluatorConfig){var e=this.readEvaluatorConfig();for(let r in e)this._applyIfChanged(e,r)}}_applyIfChanged(e,r){let i=this.cumulativeChangeSet&&this.cumulativeChangeSet[r],n=e[r];__dcg_shared_module_exports__['F'](i,n)||this.applyToChangeSets(function(o){o[r]=n})}};function pd(t){return t==="es-ES"?(__dcg_shared_module_exports__['M'].warn("{language: 'es-ES'} has been deprecated. Proceeding with {language: 'es'}"),"es"):t}ql();var J9=0,Bw=class{constructor(e,r,i,n){e||(e=document.createElement("div"));let o=document.createElement("div");o.className="dcg-wrapper",o.style.width="100%",o.style.height="100%",e.appendChild(o),this.__id=J9++;let s=new $l;this.graphSettings=s;for(let g in i)s.config.setProperty(g,i[g]);let a=new lu(s);this.controller=a,n&&a.dispatch({type:"ui/container-resized",size:n}),this.rootElt=o,this.view=Um.mountToNode(Rw,this.rootElt,{controller:Um.const(a)});let l=new lp(r);this.controller.setEvaluator(l),this.controller.setRootElt(this.rootElt);let c=a.find$(".dcg-grapher-2d"),d=new od(c,s,this.controller,l);this.grapher2d=d,this.controller.setGrapher2d(d),s.registerCallbacks(d),this.grapher=d,this.controller.setGrapher(this.grapher),this.controller.initStateStack(),l.readEvaluatorConfig=()=>({product:s.config.product,beta3d:!!mi("beta3d"),evaluationMode:a.isGeometry()?"geometry":this.controller.isThreeDMode()?"graphing_3d":"graphing",globalRandomSeed:s.randomSeed,degreeMode:s.degreeMode,viewState:a.getViewState(),selectedIds:a.getPropagatedSelectedIds(),restrictedFunctions:s.config.restrictedFunctions,forceEnableGeometryFunctions:s.config.forceEnableGeometryFunctions,distributions:s.config.distributions,pointsOfInterest:s.config.pointsOfInterest,plotSingleVariableImplicitEquations:s.config.plotSingleVariableImplicitEquations,plotImplicits:s.config.plotImplicits,plotInequalities:s.config.plotInequalities,sliders:s.config.sliders,actions:!!s.config.actions,substitutions:!!s.config.substitutions,dimensions:a.getGrapherDimensions()}),l.onEvaluatorResults=g=>{this.controller.dispatch({type:"on-evaluator-changes",changes:g.evaluationStates,timingData:g.timingData,graphData:g.graphData,eventUpdates:g.eventUpdates}),this.grapher.redrawAllLayers()},this.unsubFunc=this.controller.subToChanges(()=>{this.controller.doesDOMHaveSize()&&(this.view.update(),this.grapher=this.controller.isThreeDMode()?this.grapher3d||this.grapher2d:this.grapher2d,this.grapher.update());var g=!1;p()&&(g=!0),g&&this.controller.doesDOMHaveSize()&&(this.view.update(),this.grapher.update())});let u=new Lr;u.setProperties({pixelCoordinates:{top:0,bottom:0,left:0,right:0,width:0,height:0},mathCoordinates:{top:0,bottom:0,left:0,right:0,width:0,height:0}}),this.graphpaperBounds=u;let p=()=>{var g=!1,b=a.computeMajorLayout(),x={left:b.grapher.left,right:b.grapher.left+b.grapher.width,width:b.grapher.width,top:b.grapher.top,bottom:b.grapher.top+b.grapher.height,height:b.grapher.height},w=this.grapher.getCurrentViewport(),E={top:w.ymax,bottom:w.ymin,left:w.xmin,right:w.xmax,width:w.xmax-w.xmin,height:w.ymax-w.ymin};__dcg_shared_module_exports__['F'](E,u.mathCoordinates)||(u.setProperty("mathCoordinates",E),g=!0);var k=x.height>0&&x.width>0;return k&&!__dcg_shared_module_exports__['F'](x,u.pixelCoordinates)&&(u.setProperty("pixelCoordinates",x),g=!0),g};I(this.rootElt).on("keydown.calculator-"+this.__id,g=>{this.grapher instanceof od&&this.grapher.audioGraph.handleKeydown(g),this.instanceHotkeys.handleKeydown(g)}),I(window).on("dcg-tapstart.calculator-"+this.__id,g=>{let b=I(g.target),x=!!b.closest(this.rootElt).length,w=g.wasHandled("create-expression-with-keyboard"),E=!!b.closest(".dcg-api-shared-keypad-root").length,k=!!b.hasClass("dcg-shell");if(!x&&!E&&!k&&!w&&a.dispatch({type:"set-none-selected"}),!g.wasHandled("do-not-clear-poi-labels")&&this.grapher.traceLayer&&(this.grapher.traceLayer.clearOpenedPOI(),this.grapher.redrawAllLayers()),a.isInEditListMode()){let S=b.closest(".dcg-exppanel").length===0&&b.closest(".dcg-options-menu").length===0&&b.closest(".dcg-expression-top-bar").length===0&&b.closest(".dcg-keypad").length===0;(!x||S)&&a.dispatch({type:"set-edit-list-mode",isEditListMode:!1,focusExpressionList:!1})}}),this.evaluator=l,this.tourManager=new Dv,this.controller.dispatch({type:"set-blank",degreeMode:!!i.degreeMode}),s.config.expressionsCollapsed&&this.setOptions({expressionsCollapsed:!0}),s.config.capExpressionSize&&this.setOptions({capExpressionSize:!0}),s.config.hasOwnProperty("pointsOfInterest")&&this.setOptions({pointsOfInterest:s.config.pointsOfInterest}),s.config.hasOwnProperty("backgroundColor")&&this.setOptions({backgroundColor:s.config.backgroundColor}),s.config.hasOwnProperty("textColor")&&this.setOptions({textColor:s.config.textColor}),s.config.observe("language",()=>{let g=this.controller.getState();this.controller.dispatch({type:"set-state",state:g}),this.tourManager&&(this.tourManager.closingMsg=(b,x)=>"<b>"+b+"</b><br>"+this.controller.s("graphing-tours-label-self-destruct",{seconds:x}))}),s.config.observe("forceLogModeRegressions",()=>{s.config.forceLogModeRegressions&&this.controller.setAllRegressionsToLogMode()}),this.instanceHotkeys=new Ub(a)}initializeGrapher3d(e){let r=this.controller.find$(".dcg-grapher-3d"),i=new e(r,this.controller.getGraphSettings(),this.controller,this.controller.getEvaluator());this.grapher3d=i,this.controller.setGrapher3d(i),this.grapher=i,this.controller.setGrapher(this.grapher),this.controller.dispatch({type:"set-blank"}),this.controller.clearUndoRedoHistory()}setOption(e,r){this.controller.getGraphSettings().config.setProperty(e,r)}setOptions(e){let r,i=this.controller.getGraphSettings().config,n=__dcg_shared_module_exports__['b']({},e);e.hasOwnProperty("backgroundColor")&&(__dcg_shared_module_exports__['Q'](e.backgroundColor)||(__dcg_shared_module_exports__['M'].warn("Invalid backgroundColor. Background color must be a 3- or 6-character hex color (e.g. #cde or #ffaaaa)"),delete n.backgroundColor)),e.hasOwnProperty("textColor")&&(__dcg_shared_module_exports__['Q'](e.textColor)||(__dcg_shared_module_exports__['M'].warn("Invalid textColor. Text color must be a 3- or 6-character hex color (e.g. #000 or #001111)"),delete n.textColor)),e.hasOwnProperty("menus")&&(__dcg_shared_module_exports__['M'].warn("Deprecated option: menus. Setting settingsMenu and expressionsTopbar instead."),e.hasOwnProperty("settingsMenu")||(n.settingsMenu=!!e.menus),e.hasOwnProperty("expressionsTopbar")||(n.expressionsTopbar=!!e.menus),delete n.menus),e.hasOwnProperty("solutions")&&(__dcg_shared_module_exports__['M'].warn("Deprecated option: solutions. Setting pointsOfInterest instead."),e.hasOwnProperty("pointsOfInterest")||(n.pointsOfInterest=!!e.solutions),delete n.solutions),e.hasOwnProperty("administerSecretFolders")&&(__dcg_shared_module_exports__['M'].warn("Deprecated option: administerSecretFolders. Setting authorFeatures instead."),e.hasOwnProperty("authorFeatures")||(n.authorFeatures=!!e.administerSecretFolders),delete n.administerSecretFolders),e.hasOwnProperty("singleVariableSolutions")&&(__dcg_shared_module_exports__['M'].warn("Deprecated option: singleVariableSolutions has been removed."),delete n.singleVariableSolutions),e.graphpaper===!1&&(e.expressionsCollapsed&&(n.expressionsCollapsed=!1,__dcg_shared_module_exports__['M'].warn("Cannot set graphpaper: false with expressionsCollapsed: true. Proceeding with expressionsCollapsed: false.")),i.expressionsCollapsed&&(n.expressionsCollapsed=!1,__dcg_shared_module_exports__['M'].warn("Disabling the graphpaper with the expressions list collapsed is not supported.Setting expressionsCollapsed: false.")),e.zoomButtons&&(n.zoomButtons=!1,__dcg_shared_module_exports__['M'].warn("Cannot set graphpaper: false with zoomButtons: true. Proceeding with zoomButtons: false.")),e.showResetButtonOnGraphpaper&&(n.showResetButtonOnGraphpaper=!1,__dcg_shared_module_exports__['M'].warn("Cannot set graphpaper: false with showResetButtonOnGraphpaper: true. Proceeding with showResetButtonOnGraphpaper: false.")),i.zoomButtons&&(n.zoomButtons=!1,__dcg_shared_module_exports__['M'].warn("Disabling the graphpaper with the zoomButtons visible is not supported. Setting zoomButtons: false.")),i.showResetButtonOnGraphpaper&&(n.showResetButtonOnGraphpaper=!1,__dcg_shared_module_exports__['M'].warn("Disabling the graphpaper with the reset button visible is not supported. Setting showResetButtonOnGraphpaper: false."))),i.graphpaper===!1&&(e.expressionsCollapsed||e.zoomButtons||e.showResetButtonOnGraphpaper)&&(n.graphpaper=!0,__dcg_shared_module_exports__['M'].warn("Must have visible graphpaper to proceed. Setting graphpaper: true.")),e.lockViewport&&e.zoomButtons&&(n.zoomButtons=!1,__dcg_shared_module_exports__['M'].warn("Cannot set zoomButtons: true and lockViewport: true. Proceeding with zoomButtons: false.")),i.lockViewport&&e.zoomButtons&&(n.lockViewport=!1,__dcg_shared_module_exports__['M'].warn("Cannot set zoomButtons: true while the viewport is locked. Setting lockViewport: false.")),i.zoomButtons&&e.lockViewport&&(n.zoomButtons=!1,__dcg_shared_module_exports__['M'].warn("Cannot lock the viewport without hiding the zoom buttons. Setting zoomButtons: false."));function o(d){let{notes:u,folders:p,images:g}=d;return u===!1||p===!1||g===!1}let s=o(e),a=o(__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['b']({},i),e)),l=i.pasteGraphLink,c=e.pasteGraphLink;s?(c||l)&&(n.pasteGraphLink=!1,__dcg_shared_module_exports__['M'].warn("Cannot disable creating note, folder, or image expressions without disabling graph link pasting. Setting pasteGraphLink: false.")):c&&a&&(n.notes=!0,n.folders=!0,n.images=!0,__dcg_shared_module_exports__['M'].warn("Cannot enable graph link pasting while the creation of notes, folders, or images is disable. Setting notes: true, folders: true, images: true.")),e.language&&(n.language=pd(e.language)),e.logScales&&this.controller.isGeometry()&&(__dcg_shared_module_exports__['M'].warn("Cannot set logScales: true in the geometry calculator"),delete n.logScales);for(r in n)if(n.hasOwnProperty(r))switch(r){case"expressionsCollapsed":this.setOption("expressionsCollapsed",!!n.expressionsCollapsed),n.expressionsCollapsed?this.controller.dispatch({type:"hide-expressions-list",focusShowIcon:!1}):this.controller.dispatch({type:"show-expressions-list",focusHideIcon:!1});break;case"qwertyKeyboard":this.setOption("qwertyKeyboard",!!n.qwertyKeyboard),this.controller.isLetterKeypadOpen()&&this.controller.dispatch({type:"keypad/abc"});break;case"degreeMode":this.setOption("degreeMode",!!n.degreeMode),this.controller.dispatch({type:"set-graph-settings",degreeMode:!!n.degreeMode});break;case"actions":{let u=n[r];if(u===void 0||u===this.controller.getGraphSettings().config.actions)break;this.setOption(r,u),this.setState(this.getState(),{allowUndo:!0});break}case"substitutions":{let u=n[r];if(u===void 0||u===this.controller.getGraphSettings().config.substitutions)break;this.setOption(r,u),this.setState(this.getState(),{allowUndo:!0});break}case"product":case"beta3d":{__dcg_shared_module_exports__['M'].warn(`Cannot update '${r}' setting.`);break}case"logScales":{let u=n[r];u!==void 0&&(u===!1&&this.controller.dispatch({type:"set-graph-settings",xAxisScale:"linear",yAxisScale:"linear"}),this.setOption(r,u));break}case"keypad":case"graphpaper":case"expressions":case"settingsMenu":case"zoomButtons":case"showResetButtonOnGraphpaper":case"expressionsTopbar":case"pointsOfInterest":case"trace":case"border":case"lockViewport":case"authorFeatures":case"advancedStyling":case"images":case"imageUploadCallback":case"folders":case"notes":case"sliders":case"links":case"restrictedFunctions":case"forceEnableGeometryFunctions":case"distributions":case"pasteGraphLink":case"pasteTableData":case"clearIntoDegreeMode":case"autosize":case"plotSingleVariableImplicitEquations":case"plotImplicits":case"plotInequalities":case"colors":case"branding":case"disableScrollFix":case"invertedColors":case"fontSize":case"projectorMode":case"language":case"onlyTraceSelected":case"disableMouseInteractions":case"nativeOnscreenKeypad":case"functionDefinition":case"plaidMode":case"pasteGraphLinkCallback":case"editOnWeb":case"crossOriginSaveTest":case"backgroundColor":case"textColor":case"enableTabindex":case"audioTraceReverseExpressions":case"showHamburger":case"decimalToFraction":case"capExpressionSize":case"transparentBackground":case"pauseWhenOffscreen":case"hideGeoUI":case"brailleMode":case"sixKeyInput":case"brailleControls":case"zoomFit":case"forceLogModeRegressions":case"audio":{let u=n[r];u!==void 0&&this.setOption(r,u);break}default:return r}}setViewport(e){let r=new an(e[0],e[1],e[2],e[3]);this.grapher.viewportController.setViewport(r),this.controller.dispatch({type:"commit-user-requested-viewport",viewport:r})}resize(e){e&&this.controller.dispatch({type:"ui/container-resized",size:e})}interceptTouch(){let e=I(this.rootElt),r=e.find(".dcg-expression-top-bar");r.add(e.find(".dcg-keypad")),r.length&&(r.on("touchstart",i=>{I(i.target).is("input, textarea")||i.preventDefault()}),r.on("touchend",i=>{I(i.target).closest(".dcg-do-not-blur").length>0||yT()}))}destroy(){I(window).off(".calculator-"+this.__id);let e=I(this.rootElt);e.off(".calculator-"+this.__id),this.unsubFunc(),this.graphSettings.unobserveAll(),this.evaluator&&this.evaluator.destroy(),this.grapher&&this.grapher.remove(),Um.unmountFromNode(this.rootElt),e.remove()}tick(e,r){r||(this.controller.handleTick(e),this.controller.updateRenderShellsAfterDispatch()),this.evaluator.tick(),this.grapher&&this.grapher.tick(e)}getState(e){return this.controller.getState(e)}setBlank(e){this.controller.dispatch({type:"set-blank",opts:e||{}})}setState(e,r){this.controller.dispatch({type:"set-state",state:e,opts:r||{}})}};function Y9(){var t=I('<div style="z-index:99999; position: absolute; left: 0; top: 0;background:#FFF">waiting...</div>').appendTo("body"),e=window,r=[],i=[];e.Calc.controller.onEvaluatorChangesSpy=function(){r.push(Date.now())};let n;e.Calc.controller.isThreeDMode()&&(n=e.Calc.controller.grapher3d.webglLayer,n.onRenderSpy=function(){i.push(Date.now())}),setInterval(function(){for(var o=Date.now();o-r[0]>1e3;)r.shift();for(;o-i[0]>1e3;)i.shift();let s=e.Calc.controller.isThreeDMode()?`compute: ${r.length} fps, 3d render: ${i.length} fps, ${n.renderer.info.render.triangles} triangles`:`${r.length} fps`;t.text(s)},100)}function X9(){var t=I('<div style="z-index:99999; position: absolute; left: 0; top: 0;background:#FFF">waiting...</div>').appendTo("body"),e=window,r=[],i=0;e.Calc.controller.onEvaluatorChangesSpy=function(a,l){let{timeInWorker:c}=l;r[i%100]=c,i+=1};function n(){let a=0;for(let c of r)a+=c;let l=a/r.length;t.text(l.toFixed(1)+" ms")}let o;function s(){cancelAnimationFrame(o),o=requestAnimationFrame(s),n()}s()}var Q9=!!oo().simulationFPS;Q9&&(Kw=setInterval(function(){var t=window.Calc;t&&(clearInterval(Kw),setTimeout(Y9,1e3))},1));var Kw,Z9=!!oo().timeInWorker;Z9&&(Kw=setInterval(function(){var e=window.Calc;e&&(clearInterval(Kw),setTimeout(X9,1e3))},1));var Kw;Oe();var O3=1,qm={},Uw=!1;function F3(){Uw=!0,requestAnimationFrame(ej)}var _3={};function ej(){_3.rafSPY&&_3.rafSPY(),Uw=!1;for(let t in qm)qm[t].detectAndEnqueueEvent(),Uw=!0;if(Uw){F3();for(let t in qm)qm[t].dispatchQueuedEvent()}}var fu=class{constructor(e,r){this.elt=e;this.cb=r;this.destroyed=!1;this.lastOffscreen=!1;this.id=O3.toString(),this.appliedScale={x:1,y:1},O3++}stopWatching(){delete qm[this.id]}startWatching(){this.checkForChanges(),qm[this.id]=this,Uw||F3()}resetAppliedScalingAndGetBoundingClientRect(){var e=this.elt.getBoundingClientRect(),r={x:e.width/this.elt.offsetWidth,y:e.height/this.elt.offsetHeight};if(r.x===this.appliedScale.x&&r.y===this.appliedScale.y)return e;let i=I(this.elt).children(".dcg-wrapper")[0];return i&&(this.appliedScale=r,I(i).css({transform:"scale("+1/this.appliedScale.x+","+1/this.appliedScale.y+")",width:100*this.appliedScale.x+"%",height:100*this.appliedScale.y+"%","transform-origin":"0 0"})),e}detectAndEnqueueEvent(){if(this.destroyed)return;let e=!0;if(!(document.body&&document.body.contains(this.elt)))this.lastSize&&(this.lastSize=void 0,this.queuedEvent={type:"removed",target:this.elt,isOffscreen:!0});else{let i=this.resetAppliedScalingAndGetBoundingClientRect();e=i.top>window.innerHeight||i.bottom<0||i.left>window.innerWidth||i.right<0,this.lastSize?(i.width!==this.lastSize.width||i.height!==this.lastSize.height)&&(this.lastSize.width=i.width,this.lastSize.height=i.height,this.queuedEvent={type:"resized",target:this.elt,size:__dcg_shared_module_exports__['b']({},this.lastSize),isOffscreen:e}):(this.lastSize={width:i.width,height:i.height},this.queuedEvent={type:"added",target:this.elt,size:__dcg_shared_module_exports__['b']({},this.lastSize),isOffscreen:e})}e!==this.lastOffscreen&&(this.lastOffscreen=e,this.queuedEvent||(this.queuedEvent={type:"offscreen-noop",target:this.elt,isOffscreen:e}))}dispatchQueuedEvent(){let e=this.queuedEvent;e&&(this.queuedEvent=void 0,this.cb(e))}checkForChanges(){this.detectAndEnqueueEvent(),this.dispatchQueuedEvent()}destroy(){this.stopWatching();for(var e in this)this.hasOwnProperty(e)&&delete this[e];this.destroyed=!0}};function R3(t){var e=t.mode,r=t.width,i=t.height,n=t.currentBounds,o=t.graphpaperAspectRatio,s=t.mathAspectRatio,a=t.mathBounds,l=r/i,c={x:n.left+n.width/2,y:n.bottom+n.height/2};if(a.left===void 0!=(a.right===void 0)||a.bottom===void 0!=(a.top===void 0))return __dcg_shared_module_exports__['M'].warn('asyncScreenshot: cannot specify "left" bound without "right" or "bottom" bound without "top". Got: '+a),n;var d=a.left!==void 0&&a.right!==void 0,u=a.bottom!==void 0&&a.top!==void 0,p=d&&u,g,b,x,w,E,k,S,T,V,O;switch(e){case"stretch":return p?a:d?{left:a.left,right:a.right,bottom:n.bottom,top:n.top}:u?{left:n.left,right:n.right,bottom:a.bottom,top:a.top}:n;case"contain":return p?(w=a.right-a.left,E=a.top-a.bottom,k={x:a.left+w/2,y:a.bottom+E/2},x=w/E,l>x?(b=E/i,g=b*s,{left:k.x-g*r/2,right:k.x+g*r/2,bottom:a.bottom,top:a.top}):(g=w/r,b=g/s,{left:a.left,right:a.right,bottom:k.y-b*i/2,top:k.y+b*i/2})):d?(S=a.right-a.left,T=a.left+S/2,x=S/n.height,l>x?(b=n.height/i,g=b*s,{left:T-g*r/2,right:T+g*r/2,bottom:n.bottom,top:n.top}):(g=S/r,b=g/s,{left:a.left,right:a.right,bottom:c.y-b*i/2,top:c.y+b*i/2})):u?(V=a.top-a.bottom,O=a.bottom+V/2,x=n.width/V,l>x?(b=V/i,g=b*s,{left:c.x-g*r/2,right:c.x+g*r/2,bottom:a.bottom,top:a.top}):(g=n.width/r,b=g/s,{left:n.left,right:n.right,bottom:O-b*i/2,top:O+b*i/2})):l>o?(b=n.height/i,g=b*s,{left:c.x-g*r/2,right:c.x+g*r/2,bottom:n.bottom,top:n.top}):(g=n.width/r,b=g/s,{left:n.left,right:n.right,bottom:c.y-b*i/2,top:c.y+b*i/2});case"preserveX":return p?(w=a.right-a.left,E=a.top-a.bottom,k={x:a.left+w/2,y:a.bottom+E/2},x=w/E,g=w/r,b=g/s,{left:a.left,right:a.right,bottom:k.y-b*i/2,top:k.y+b*i/2}):u?(V=a.top-a.bottom,O=a.bottom+V/2,x=n.width/V,g=n.width/r,b=g/s,{left:n.left,right:n.right,bottom:O-b*i/2,top:O+b*i/2}):d?(S=a.right-a.left,g=S/r,b=g/s,{left:a.left,right:a.right,bottom:c.y-b*i/2,top:c.y+b*i/2}):(S=n.right-n.left,g=S/r,b=g/s,{left:n.left,right:n.right,bottom:c.y-b*i/2,top:c.y+b*i/2});case"preserveY":return p?(w=a.right-a.left,E=a.top-a.bottom,k={x:a.left+w/2,y:a.bottom+E/2},x=w/E,b=E/i,g=b*s,{left:k.x-g*r/2,right:k.x+g*r/2,bottom:a.bottom,top:a.top}):d?(S=a.right-a.left,T=a.left+S/2,x=S/n.height,b=n.height/i,g=b*s,{left:T-g*r/2,right:T+g*r/2,bottom:n.bottom,top:n.top}):u?(V=a.top-a.bottom,b=V/i,g=b*s,{left:c.x-g*r/2,right:c.x+g*r/2,bottom:a.bottom,top:a.top}):(V=n.top-n.bottom,b=V/i,g=b*s,{left:c.x-g*r/2,right:c.x+g*r/2,bottom:n.bottom,top:n.top});default:return n}}function Hw(t,e){for(var r in e)if(e.hasOwnProperty(r)&&e[r]===t)return!0;return!1}function WT(t){return Hw(t,JT)}function jT(t){return Hw(t,YT)}function N3(t){return Hw(t,XT)}function tj(t){return Hw(t,qw)}function rj(t){return Hw(t,QT)}var JT={OPEN:"OPEN",CROSS:"CROSS",POINT:"POINT"},YT={SOLID:"SOLID",DASHED:"DASHED",DOTTED:"DOTTED"},XT={NONE:"NONE",AUTO:"AUTO",X:"X",Y:"Y",XY:"XY"},qw={POINTS:"POINTS",LINES:"LINES",POINTS_AND_LINES:"POINTS_AND_LINES"},QT={DEFAULT:"default",CENTER:"center",CENTER_AUTO:"center_auto",AUTO_CENTER:"auto_center",ABOVE:"above",ABOVE_LEFT:"above_left",ABOVE_RIGHT:"above_right",ABOVE_AUTO:"above_auto",BELOW:"below",BELOW_LEFT:"below_left",BELOW_RIGHT:"below_right",BELOW_AUTO:"below_auto",LEFT:"left",AUTO_LEFT:"auto_left",RIGHT:"right",AUTO_RIGHT:"auto_right"};function ij(t){return{id:t.id,type:t.type,columns:t.columns.map(nj)}}function nj(t){return{id:t.id,latex:t.latex,color:t.color,hidden:t.hidden,pointStyle:t.pointStyle,pointSize:t.pointSize,pointOpacity:t.pointOpacity,lineStyle:t.lineStyle,lineWidth:t.lineWidth,lineOpacity:t.lineOpacity,points:t.points,lines:t.lines,dragMode:t.dragMode,values:t.values.slice()}}function oj(t){var e=["latex","color","lineStyle","lineWidth","lineOpacity","pointStyle","pointSize","pointOpacity","points","lines","fill","fillOpacity","hidden","secret","dragMode","label","showLabel","labelSize","labelOrientation","interactiveLabel","readonly"],r={id:t.id,type:t.type};return e.forEach(function(i){t.hasOwnProperty(i)&&(r[i]=t[i])}),t.hasOwnProperty("parametricDomain")&&(r.parametricDomain={min:t.parametricDomain.min,max:t.parametricDomain.max}),t.hasOwnProperty("parametricDomain3Du")&&(r.parametricDomain3Du={min:t.parametricDomain3Du.min,max:t.parametricDomain3Du.max}),t.hasOwnProperty("parametricDomain3Dv")&&(r.parametricDomain3Dv={min:t.parametricDomain3Dv.min,max:t.parametricDomain3Dv.max}),t.hasOwnProperty("polarDomain")&&(r.polarDomain={min:t.polarDomain.min,max:t.polarDomain.max}),t.hasOwnProperty("domain")&&(r.domain={min:t.domain.min,max:t.domain.max}),t.slider&&(t.slider.hardMin&&(r.sliderBounds=r.sliderBounds||{},r.sliderBounds.min=t.slider.min),t.slider.hardMax&&(r.sliderBounds=r.sliderBounds||{},r.sliderBounds.max=t.slider.max),t.slider.step&&(r.sliderBounds=r.sliderBounds||{},r.sliderBounds.step=t.slider.step),r.playing=!!t.slider.isPlaying),r}function sj(t){return{id:t.id,type:t.type,hidden:t.hidden,secret:t.secret}}function aj(t){return{id:t.id,type:t.type,hidden:t.hidden,secret:t.secret}}function lj(t){return{id:t.id,type:t.type,secret:t.secret}}function pE(t){switch(t.type){case"expression":return oj(t);case"table":return ij(t);case"folder":return aj(t);case"image":return sj(t);case"text":return lj(t);default:return t}}function Hm(t,e){return t.hasOwnProperty("id")?t.id+"":e.generateId()}function cj(t,e){var r={type:"expression",id:Hm(t,e)};if(r.type="expression",r.id=Hm(t,e),t.hasOwnProperty("latex")&&(r.latex=t.latex+""),t.hasOwnProperty("color")&&(r.color=t.color+""),t.hasOwnProperty("points")&&(r.points=!!t.points),t.hasOwnProperty("lines")&&(r.lines=!!t.lines),t.hasOwnProperty("surfaces")&&(r.surfaces=!!t.surfaces),t.hasOwnProperty("style")&&(__dcg_shared_module_exports__['M'].warn("As of API v1.1 the 'style' property is deprecated and has been split into 'pointStyle' and 'lineStyle'."),WT(t.style)?r.pointStyle=t.style:jT(t.style)?r.lineStyle=t.style:__dcg_shared_module_exports__['M'].warn("Invalid style: '"+t.style+"'.")),t.hasOwnProperty("pointStyle")&&(WT(t.pointStyle)?r.pointStyle=t.pointStyle:__dcg_shared_module_exports__['M'].warn("Invalid pointStyle: '"+t.pointStyle+"'.")),t.hasOwnProperty("pointSize")&&(r.pointSize=""+t.pointSize),t.hasOwnProperty("pointOpacity")&&(r.pointOpacity=""+t.pointOpacity),t.hasOwnProperty("lineStyle")&&(jT(t.lineStyle)?r.lineStyle=t.lineStyle:__dcg_shared_module_exports__['M'].warn("Invalid lineStyle: '"+t.lineStyle+"'.")),t.hasOwnProperty("lineWidth")&&(r.lineWidth=""+t.lineWidth),t.hasOwnProperty("lineOpacity")&&(r.lineOpacity=""+t.lineOpacity),t.hasOwnProperty("hidden")&&(r.hidden=!!t.hidden),t.hasOwnProperty("readonly")&&(r.readonly=!!t.readonly),t.hasOwnProperty("secret")&&(r.secret=!!t.secret),t.hasOwnProperty("sliderBounds")&&t.sliderBounds&&(r.slider={min:__dcg_shared_module_exports__['kc'](t.sliderBounds.min),max:__dcg_shared_module_exports__['kc'](t.sliderBounds.max),step:__dcg_shared_module_exports__['kc'](t.sliderBounds.step)},r.slider.min&&(r.slider.hardMin=!0),r.slider.max&&(r.slider.hardMax=!0)),t.hasOwnProperty("playing")){let{playing:i}=t;typeof i!="boolean"?__dcg_shared_module_exports__['M'].warn(`Invalid value for 'playing'. Expected a boolean but got '${i}'.`):(r.slider||(r.slider={}),r.slider.isPlaying=i)}return t.hasOwnProperty("parametricDomain3Du")&&t.parametricDomain3Du&&(r.parametricDomain3Du={min:__dcg_shared_module_exports__['kc'](t.parametricDomain3Du.min),max:__dcg_shared_module_exports__['kc'](t.parametricDomain3Du.max)}),t.hasOwnProperty("parametricDomain3Dv")&&t.parametricDomain3Dv&&(r.parametricDomain3Dv={min:__dcg_shared_module_exports__['kc'](t.parametricDomain3Dv.min),max:__dcg_shared_module_exports__['kc'](t.parametricDomain3Dv.max)}),t.hasOwnProperty("parametricDomain")&&t.parametricDomain?(r.parametricDomain={min:__dcg_shared_module_exports__['kc'](t.parametricDomain.min),max:__dcg_shared_module_exports__['kc'](t.parametricDomain.max)},t.hasOwnProperty("domain")&&__dcg_shared_module_exports__['M'].warn("Both 'parametricDomain' and the deprecated 'domain' property were specified. Using 'parametricDomain'.")):t.hasOwnProperty("domain")&&(__dcg_shared_module_exports__['M'].warn("The 'domain' property is deprecated.Use 'parametricDomain' to specify the domain for parametric functions"),r.parametricDomain={min:__dcg_shared_module_exports__['kc'](t.domain.min),max:__dcg_shared_module_exports__['kc'](t.domain.max)}),t.hasOwnProperty("polarDomain")&&t.polarDomain&&(r.polarDomain={min:__dcg_shared_module_exports__['kc'](t.polarDomain.min),max:__dcg_shared_module_exports__['kc'](t.polarDomain.max)}),t.hasOwnProperty("dragMode")&&(N3(t.dragMode)?r.dragMode=t.dragMode:__dcg_shared_module_exports__['M'].warn("Invalid dragMode: '"+t.dragMode+"'.")),t.hasOwnProperty("label")&&(r.label=t.label+""),t.hasOwnProperty("showLabel")&&(r.showLabel=!!t.showLabel),t.hasOwnProperty("labelSize")&&(typeof t.labelSize=="string"?r.labelSize=t.labelSize:__dcg_shared_module_exports__['M'].warn("Invalid labelSize: "+t.labelSize)),t.hasOwnProperty("labelOrientation")&&(rj(t.labelOrientation)?r.labelOrientation=t.labelOrientation:__dcg_shared_module_exports__['M'].warn("Invalid labelOrientation: "+t.labelOrientation)),t.hasOwnProperty("fill")&&(r.fill=!!t.fill),t.hasOwnProperty("fillOpacity")&&(r.fillOpacity=""+t.fillOpacity),r}function dj(t,e){var r={id:Hm(t,e)};return t.hasOwnProperty("latex")&&(r.latex=t.latex+""),t.hasOwnProperty("color")&&(r.color=t.color+""),t.hasOwnProperty("hidden")&&(r.hidden=!!t.hidden),t.hasOwnProperty("points")&&(r.points=!!t.points),t.hasOwnProperty("lines")&&(r.lines=!!t.lines),t.hasOwnProperty("values")&&t.values&&(r.values=t.values.map(function(i){return i+""})),t.hasOwnProperty("pointStyle")&&(WT(t.pointStyle)?r.pointStyle=t.pointStyle:__dcg_shared_module_exports__['M'].warn("Invalid pointStyle: '"+t.pointStyle+"'.")),t.hasOwnProperty("pointSize")&&(r.pointSize=""+t.pointSize),t.hasOwnProperty("pointOpacity")&&(r.pointOpacity=""+t.pointOpacity),t.hasOwnProperty("lineStyle")&&(jT(t.lineStyle)?r.lineStyle=t.lineStyle:__dcg_shared_module_exports__['M'].warn("Invalid lineStyle: '"+t.lineStyle+"'.")),t.hasOwnProperty("lineWidth")&&(r.lineWidth=""+t.lineWidth),t.hasOwnProperty("lineOpacity")&&(r.lineOpacity=""+t.lineOpacity),t.hasOwnProperty("columnMode")&&(__dcg_shared_module_exports__['M'].warn("As of API v1.1 the 'columnMode' property is deprecated and has been split into individual 'points' and 'lines' properties."),t.columnMode===qw.POINTS_AND_LINES?(r.points=!0,r.lines=!0):t.columnMode===qw.LINES?(r.points=!1,r.lines=!0):(r.points=!0,r.lines=!1),r.lines&&!r.points&&t.hasOwnProperty("dragMode")&&t.dragMode!=="NONE"&&(__dcg_shared_module_exports__['M'].warn("A 'lines' value of true and 'points' value of false is only compatible with a dragMode of 'NONE'. Proceeding by setting 'points' to true."),r.points=!0),tj(t.columnMode)&&__dcg_shared_module_exports__['M'].warn("Invalid columnMode: '"+t.columnMode+"'.")),t.hasOwnProperty("dragMode")&&(N3(t.dragMode)?r.dragMode=t.dragMode==="AUTO"?"NONE":t.dragMode:__dcg_shared_module_exports__['M'].warn("Invalid dragMode: '"+t.dragMode+"'.")),r}function hj(t,e){var r={type:"table",id:Hm(t,e)};return t.hasOwnProperty("columns")&&t.columns&&(r.columns=t.columns.map(function(i){return dj(i,e)})),r}function pj(t,e){var r={type:"folder",id:Hm(t,e)};return t.hasOwnProperty("hidden")&&(r.hidden=!!t.hidden),r}function uj(t,e){var r={type:"image",id:Hm(t,e)};return t.hasOwnProperty("hidden")&&(r.hidden=!!t.hidden),r}function uE(t,e,r){var i=t.type;if(e&&i&&i!==e){__dcg_shared_module_exports__['M'].warn("Cannot change type of expression from '"+e+"' to '"+i+"'.");return}switch(i){case void 0:case"expression":return cj(t,r);case"image":return uj(t,r);case"table":return hj(t,r);case"folder":return pj(t,r);default:if(e){__dcg_shared_module_exports__['M'].warn("Cannot modify expressions of type: '"+e+"' through the API.");return}else{__dcg_shared_module_exports__['M'].warn("Invalid expression type: '"+i+"'.");return}}}var gE=class{constructor(e){this.mq=e,this.id=e.id,this.data=e.data}simulateUserChangedLatex(){Xe.simulateUserChangedLatex(this.mq)}simulateKeypress(e){Xe.simulateKeypress(this.mq,e)}latex(e){return e===void 0?this.mq.latex():(this.mq.latex(e),this.simulateUserChangedLatex(),this)}reflow(){this.mq.reflow()}el(){return this.mq.el()}getAriaLabel(){return this.mq.getAriaLabel()}setAriaLabel(e){return this.mq.setAriaLabel(e)}html(){return this.mq.html()}mathspeak(){return this.mq.mathspeak()}text(){return this.mq.text()}selection(){return this.mq.selection()}select(){return this.mq.select(),this}moveToRightEnd(){return this.mq.moveToRightEnd(),this}moveToLeftEnd(){return this.mq.moveToLeftEnd(),this}cmd(e){return this.mq.cmd(e),this.simulateUserChangedLatex(),this}write(e){return this.mq.write(e),this.simulateUserChangedLatex(),this}keystroke(e){return this.simulateKeypress(e),this}typedText(e){return this.mq.typedText(e),this.simulateUserChangedLatex(),this}clearSelection(){return this.mq.clearSelection(),this}getAriaPostLabel(){return this.mq.getAriaPostLabel()}setAriaPostLabel(e,r){return this.mq.setAriaPostLabel(e,r),this}blur(){return this.mq.blur(),this}focus(){return this.mq.focus(),this}revert(){return this.mq.revert()}ignoreNextMousedown(e){return this.mq.ignoreNextMousedown(e),this}clickAt(e,r,i){return this.mq.clickAt(e,r,i),this}};ql();function gj(t){function e(r){requestAnimationFrame(e),t(r)}requestAnimationFrame(e)}function mj(t){function e(){setTimeout(e,zm),t(Date.now())}setTimeout(e,zm)}var B3=oo().timeoutLoop,zm=0;typeof B3=="string"&&(zm=parseFloat(B3),isNaN(zm)&&(zm=1e3/60));var K3=zm>0?mj:gj;var e0=new Lr;K3(function(t){e0.triggerEvent("tick",t)});var ZT=0;function lh(t){return ZT+=1,e0.observeEvent("tick."+ZT,function(e,r){t(r)}),ZT}function yu(t){e0.unobserveEvent("tick."+t)}Xp();var U3=Ud(location.search,"nworkers"),q3=4;U3&&(q3=parseInt(U3,10));var $m=new Km(q3);var fE={};__dcg_shared_module_exports__['h'](fE,{LARGE:()=>bj,MEDIUM:()=>t0,SMALL:()=>yj,VERY_LARGE:()=>wj,VERY_SMALL:()=>fj});var fj=9,yj=12,t0=16,bj=20,wj=24;var bt=function(t,e,r){var i=document.createElement("img"),n,o;if(i.onerror=e,i.onload=function(){o&&!(r&&r.noRevoke)&&bt.revokeObjectURL(o),e&&e(bt.scale(i,r))},bt.isInstanceOf("Blob",t)||bt.isInstanceOf("File",t))n=o=bt.createObjectURL(t),i._type=t.type;else if(typeof t=="string")n=t,r&&r.crossOrigin&&(i.crossOrigin=r.crossOrigin);else return!1;return n?(i.src=n,i):bt.readFile(t,function(s){var a=s.target;a&&a.result?i.src=a.result:e&&e(s)})},yE=window.createObjectURL&&window||window.URL&&URL.revokeObjectURL&&URL||window.webkitURL&&webkitURL;bt.isInstanceOf=function(t,e){return Object.prototype.toString.call(e)==="[object "+t+"]"};bt.transformCoordinates=function(){};bt.getTransformedOptions=function(t){return t};bt.renderImageToCanvas=function(t,e,r,i,n,o,s,a,l,c){return t.getContext("2d").drawImage(e,r,i,n,o,s,a,l,c),t};bt.hasCanvasOption=function(t){return t.canvas||t.crop};bt.scale=function(t,e){e=e||{};var r=document.createElement("canvas"),i=t.getContext||bt.hasCanvasOption(e)&&r.getContext,n=t.naturalWidth||t.width,o=t.naturalHeight||t.height,s=n,a=o,l,c,d,u,p,g,b,x,w,E=function(){var S=Math.max((d||s)/s,(u||a)/a);S>1&&(s=Math.ceil(s*S),a=Math.ceil(a*S))},k=function(){var S=Math.min((l||s)/s,(c||a)/a);S<1&&(s=Math.ceil(s*S),a=Math.ceil(a*S))};return i&&(e=bt.getTransformedOptions(e),b=e.left||0,x=e.top||0,e.sourceWidth?(p=e.sourceWidth,e.right!==void 0&&e.left===void 0&&(b=n-p-e.right)):p=n-b-(e.right||0),e.sourceHeight?(g=e.sourceHeight,e.bottom!==void 0&&e.top===void 0&&(x=o-g-e.bottom)):g=o-x-(e.bottom||0),s=p,a=g),l=e.maxWidth,c=e.maxHeight,d=e.minWidth,u=e.minHeight,i&&l&&c&&e.crop?(s=l,a=c,w=p/g-l/c,w<0?(g=c*p/l,e.top===void 0&&e.bottom===void 0&&(x=(o-g)/2)):w>0&&(p=l*g/c,e.left===void 0&&e.right===void 0&&(b=(n-p)/2))):((e.contain||e.cover)&&(d=l=l||d,u=c=c||u),e.cover?(k(),E()):(E(),k())),i?(r.width=s,r.height=a,bt.transformCoordinates(r,e),bt.renderImageToCanvas(r,t,b,x,p,g,0,0,s,a)):(t.width=s,t.height=a,t)};bt.createObjectURL=function(t){return yE?yE.createObjectURL(t):!1};bt.revokeObjectURL=function(t){return yE?yE.revokeObjectURL(t):!1};bt.readFile=function(t,e,r){if(window.FileReader){var i=new FileReader;if(i.onload=i.onerror=e,r=r||"readAsDataURL",i[r])return i[r](t),i}return!1};(!window.navigator||!window.navigator.platform||!/iP(hone|od|ad)/.test(window.navigator.platform))&&(H3=bt.renderImageToCanvas,bt.detectSubsampling=function(t){var e,r;return t.width*t.height>1024*1024?(e=document.createElement("canvas"),e.width=e.height=1,r=e.getContext("2d"),r.drawImage(t,-t.width+1,0),r.getImageData(0,0,1,1).data[3]===0):!1},bt.detectVerticalSquash=function(t,e){var r=t.naturalHeight||t.height,i=document.createElement("canvas"),n=i.getContext("2d"),o,s,a,l,c;for(e&&(r/=2),i.width=1,i.height=r,n.drawImage(t,0,0),o=n.getImageData(0,0,1,r).data,s=0,a=r,l=r;l>s;)c=o[(l-1)*4+3],c===0?a=l:s=l,l=a+s>>1;return l/r||1},bt.renderImageToCanvas=function(t,e,r,i,n,o,s,a,l,c){if(e._type==="image/jpeg"){var d=t.getContext("2d"),u=document.createElement("canvas"),p=1024,g=u.getContext("2d"),b,x,w,E;if(u.width=p,u.height=p,d.save(),b=bt.detectSubsampling(e),b&&(r/=2,i/=2,n/=2,o/=2),x=bt.detectVerticalSquash(e,b),b||x!==1){for(i*=x,l=Math.ceil(p*l/n),c=Math.ceil(p*c/o/x),a=0,E=0;E<o;){for(s=0,w=0;w<n;)g.clearRect(0,0,p,p),g.drawImage(e,r,i,n,o,-w,-E,n,o),d.drawImage(u,0,0,p,p,s,a,l,c),w+=p,s+=l;E+=p,a+=c}return d.restore(),t}}return H3(t,e,r,i,n,o,s,a,l,c)});var H3,xj=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice);bt.blobSlice=xj&&function(){var t=this.slice||this.webkitSlice||this.mozSlice;return t.apply(this,arguments)};bt.metaDataParsers={jpeg:{65505:[]}};bt.parseMetaData=function(t,e,r){r=r||{};var i=this,n=r.maxMetaDataSize||262144,o={},s=!(window.DataView&&t&&t.size>=12&&t.type==="image/jpeg"&&bt.blobSlice);(s||!bt.readFile(bt.blobSlice.call(t,0,n),function(a){var l=a.target.result,c=new DataView(l),d=2,u=c.byteLength-4,p=d,g,b,x,w;if(c.getUint16(0)===65496){for(;d<u&&(g=c.getUint16(d),g>=65504&&g<=65519||g===65534);){if(b=c.getUint16(d+2)+2,d+b>c.byteLength){console.log("Invalid meta data: Invalid segment size.");break}if(x=bt.metaDataParsers.jpeg[g],x)for(w=0;w<x.length;w+=1)x[w].call(i,c,d,b,o,r);d+=b,p=d}!r.disableImageHead&&p>6&&(l.slice?o.imageHead=l.slice(0,p):o.imageHead=new Uint8Array(l).subarray(0,p))}else console.log("Invalid JPEG file: Missing JPEG marker.");e(o)},"readAsArrayBuffer"))&&e(o)};var vj=bt.hasCanvasOption;bt.hasCanvasOption=function(t){return vj(t)||t.orientation};bt.transformCoordinates=function(t,e){var r=t.getContext("2d"),i=t.width,n=t.height,o=e.orientation;if(o)switch(o>4&&(t.width=n,t.height=i),o){case 2:r.translate(i,0),r.scale(-1,1);break;case 3:r.translate(i,n),r.rotate(Math.PI);break;case 4:r.translate(0,n),r.scale(1,-1);break;case 5:r.rotate(.5*Math.PI),r.scale(1,-1);break;case 6:r.rotate(.5*Math.PI),r.translate(0,-n);break;case 7:r.rotate(.5*Math.PI),r.translate(i,-n),r.scale(-1,1);break;case 8:r.rotate(-.5*Math.PI),r.translate(-i,0);break}};bt.getTransformedOptions=function(t){if(!t.orientation||t.orientation===1)return t;var e={},r;for(r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);switch(t.orientation){case 2:e.left=t.right,e.right=t.left;break;case 3:e.left=t.right,e.top=t.bottom,e.right=t.left,e.bottom=t.top;break;case 4:e.top=t.bottom,e.bottom=t.top;break;case 5:e.left=t.top,e.top=t.left,e.right=t.bottom,e.bottom=t.right;break;case 6:e.left=t.top,e.top=t.right,e.right=t.bottom,e.bottom=t.left;break;case 7:e.left=t.bottom,e.top=t.right,e.right=t.top,e.bottom=t.left;break;case 8:e.left=t.bottom,e.top=t.left,e.right=t.top,e.bottom=t.right;break}return t.orientation>4&&(e.maxWidth=t.maxHeight,e.maxHeight=t.maxWidth,e.minWidth=t.minHeight,e.minHeight=t.minWidth,e.sourceWidth=t.sourceHeight,e.sourceHeight=t.sourceWidth),e};bt.ExifMap=function(){return this};bt.ExifMap.prototype.map={Orientation:274};bt.ExifMap.prototype.get=function(t){return this[t]||this[this.map[t]]};bt.getExifThumbnail=function(t,e,r){var i,n,o;if(!r||e+r>t.byteLength){console.log("Invalid Exif data: Invalid thumbnail data.");return}for(i=[],n=0;n<r;n+=1)o=t.getUint8(e+n),i.push((o<16?"0":"")+o.toString(16));return"data:image/jpeg,%"+i.join("%")};bt.exifTagTypes={1:{getValue:function(t,e){return t.getUint8(e)},size:1},2:{getValue:function(t,e){return String.fromCharCode(t.getUint8(e))},size:1,ascii:!0},3:{getValue:function(t,e,r){return t.getUint16(e,r)},size:2},4:{getValue:function(t,e,r){return t.getUint32(e,r)},size:4},5:{getValue:function(t,e,r){return t.getUint32(e,r)/t.getUint32(e+4,r)},size:8},9:{getValue:function(t,e,r){return t.getInt32(e,r)},size:4},10:{getValue:function(t,e,r){return t.getInt32(e,r)/t.getInt32(e+4,r)},size:8}};bt.exifTagTypes[7]=bt.exifTagTypes[1];bt.getExifValue=function(t,e,r,i,n,o){var s=bt.exifTagTypes[i],a,l,c,d,u,p;if(!s){console.log("Invalid Exif data: Invalid tag type.");return}if(a=s.size*n,l=a>4?e+t.getUint32(r+8,o):r+8,l+a>t.byteLength){console.log("Invalid Exif data: Invalid data offset.");return}if(n===1)return s.getValue(t,l,o);for(c=[],d=0;d<n;d+=1)c[d]=s.getValue(t,l+d*s.size,o);if(s.ascii){for(u="",d=0;d<c.length&&(p=c[d],p!=="\0");d+=1)u+=p;return u}return c};bt.parseExifTag=function(t,e,r,i,n){var o=t.getUint16(r,i);n.exif[o]=bt.getExifValue(t,e,r,t.getUint16(r+2,i),t.getUint32(r+4,i),i)};bt.parseExifTags=function(t,e,r,i,n){var o,s,a;if(r+6>t.byteLength){console.log("Invalid Exif data: Invalid directory offset.");return}if(o=t.getUint16(r,i),s=r+2+12*o,s+4>t.byteLength){console.log("Invalid Exif data: Invalid directory size.");return}for(a=0;a<o;a+=1)this.parseExifTag(t,e,r+2+12*a,i,n);return t.getUint32(s,i)};bt.parseExifData=function(t,e,r,i,n){if(!n.disableExif){var o=e+10,s,a,l;if(t.getUint32(e+4)===1165519206){if(o+8>t.byteLength){console.log("Invalid Exif data: Invalid segment size.");return}if(t.getUint16(e+8)!==0){console.log("Invalid Exif data: Missing byte alignment offset.");return}switch(t.getUint16(o)){case 18761:s=!0;break;case 19789:s=!1;break;default:console.log("Invalid Exif data: Invalid byte alignment marker.");return}if(t.getUint16(o+2,s)!==42){console.log("Invalid Exif data: Missing TIFF marker.");return}a=t.getUint32(o+4,s),i.exif=new bt.ExifMap,a=bt.parseExifTags(t,o,o+a,s,i),a&&!n.disableExifThumbnail&&(l={exif:{}},a=bt.parseExifTags(t,o,o+a,s,l),l.exif[513]&&(i.exif.Thumbnail=bt.getExifThumbnail(t,o+l.exif[513],l.exif[514]))),i.exif[34665]&&!n.disableExifSub&&bt.parseExifTags(t,o,o+i.exif[34665],s,i),i.exif[34853]&&!n.disableExifGps&&bt.parseExifTags(t,o,o+i.exif[34853],s,i)}}};bt.metaDataParsers.jpeg[65505].push(bt.parseExifData);bt.ExifMap.prototype.tags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright",36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",42240:"Gamma",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubSecTime",37521:"SubSecTimeOriginal",37522:"SubSecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"PhotographicSensitivity",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"};bt.ExifMap.prototype.stringValues={ExposureProgram:{0:"Undefined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Undefined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},ComponentsConfiguration:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"},Orientation:{1:"top-left",2:"top-right",3:"bottom-right",4:"bottom-left",5:"left-top",6:"right-top",7:"right-bottom",8:"left-bottom"}};bt.ExifMap.prototype.getText=function(t){var e=this.get(t);switch(t){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":case"Orientation":return this.stringValues[t][e];case"ExifVersion":case"FlashpixVersion":return String.fromCharCode(e[0],e[1],e[2],e[3]);case"ComponentsConfiguration":return this.stringValues[t][e[0]]+this.stringValues[t][e[1]]+this.stringValues[t][e[2]]+this.stringValues[t][e[3]];case"GPSVersionID":return e[0]+"."+e[1]+"."+e[2]+"."+e[3]}return String(e)};(function(t){var e=t.tags,r=t.map,i;for(i in e)e.hasOwnProperty(i)&&(r[e[i]]=i)})(bt.ExifMap.prototype);bt.ExifMap.prototype.getAll=function(){var t={},e,r;for(e in this)this.hasOwnProperty(e)&&(r=this.tags[e],r&&(t[r]=this.getText(r)));return t};function z3(t,e){for(var r=[.92,.86,.8,.7,.6,.5,.4,.3,.2,.1],i,n=0;n<r.length;n++)if(i=t.toDataURL("image/jpeg",r[n]),i.length<e)return i;return i}function Cj(t,e){for(var r=t.toDataURL().length,i=t.width,n=t.height,o=document.createElement("canvas"),s,a=0;a<2;a++){var l=Math.sqrt(e/r);i=Math.round(l*i),n=Math.round(l*n),o.height=n,o.width=i;var c=o.getContext("2d");if(c.drawImage(t,0,0,i,n),s=o.toDataURL(),r=s.length,r<e)return s}return s}function Dj(t){for(var e=t.getContext("2d"),r=e.getImageData(0,0,t.width,t.height).data,i=3;i<r.length;i+=4)if(r[i]!==255)return!0;return!1}function bE(t,e){var r={orientation:!0,canvas:!0,maxWidth:1600,maxHeight:1600};bt(t,function(i){if(!i.toDataURL){e(!0);return}var n=2e5,o;if(t.type==="image/jpeg")o=z3(i,n);else if(o=i.toDataURL(),o.length>n){var s=o.length>.75*i.width*i.height,a=s&&!Dj(i);o=a?z3(i,n):Cj(i,n)}e(null,o)},r)}var r0={keypad:!0,graphpaper:!0,expressions:!0,settingsMenu:!0,zoomButtons:!0,showResetButtonOnGraphpaper:!1,expressionsTopbar:!0,capExpressionSize:!1,pointsOfInterest:!0,trace:!0,border:!0,lockViewport:!1,expressionsCollapsed:!1,authorFeatures:!1,advancedStyling:!1,images:!0,imageUploadCallback:bE,folders:!0,notes:!0,sliders:!0,links:!0,qwertyKeyboard:!0,restrictedFunctions:!1,forceEnableGeometryFunctions:!1,pasteGraphLink:!1,pasteTableData:!0,degreeMode:!1,clearIntoDegreeMode:!1,autosize:!0,plotSingleVariableImplicitEquations:!0,plotImplicits:!0,plotInequalities:!0,colors:{RED:IC,BLUE:MC,GREEN:TC,ORANGE:LC,PURPLE:AC,BLACK:PC},invertedColors:!1,functionDefinition:!0,projectorMode:!1,decimalToFraction:!0,fontSize:16,language:"en",backgroundColor:"#fff",textColor:"#000",distributions:!0,brailleMode:"none",sixKeyInput:!1,brailleControls:!0,zoomFit:!0,forceLogModeRegressions:!1,actions:"auto",audio:!0,logScales:!0},$3=Object.keys(r0),W3={product:"graphing",showHamburger:!1,disableScrollFix:!1,branding:!0,onlyTraceSelected:!1,disableMouseInteractions:!1,nativeOnscreenKeypad:!1,plaidMode:!1,pasteGraphLinkCallback:void 0,editOnWeb:!1,crossOriginSaveTest:!1,enableTabindex:!0,audioTraceReverseExpressions:!1,transparentBackground:!1,pauseWhenOffscreen:!1,hideGeoUI:!1,substitutions:!0,beta3d:!1},Sj={solutions:!0,menus:!0,singleVariableSolutions:!0,clickableObjects:!1,administerSecretFolders:!1},wE=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['b']({},r0),W3);function j3(t){return!!(r0.hasOwnProperty(t)||W3.hasOwnProperty(t)||Sj.hasOwnProperty(t))}function xE(t){var e=__dcg_shared_module_exports__['N'](wE);for(var r in t)e.hasOwnProperty(r)&&(e[r]=t[r]);return __dcg_shared_module_exports__['Q'](e.backgroundColor)||(e.backgroundColor=wE.backgroundColor,__dcg_shared_module_exports__['M'].warn("Invalid backgroundColor. Background color must be a 3- or 6-character hex color (e.g. #cde or #ffaaaa)")),__dcg_shared_module_exports__['Q'](e.textColor)||(e.textColor=wE.textColor,__dcg_shared_module_exports__['M'].warn("Invalid textColor. Text color must be a 3- or 6-character hex color (e.g. #000 or #001111)")),e.actions!==!0&&e.actions!==!1&&e.actions!=="auto"&&(e.actions=wE.actions,__dcg_shared_module_exports__['M'].warn("Invalid actions setting. Must be true, false, or 'auto'.")),t.zoomButtons===void 0&&(!e.graphpaper||e.lockViewport)&&(e.zoomButtons=!1),t.images===void 0&&(e.graphpaper||(e.images=!1)),t.hasOwnProperty("menus")&&(__dcg_shared_module_exports__['M'].warn("As of API version 0.4, the 'menus' option is deprecated and has been split into 'settingsMenu' (boolean) and 'expressionsTopbar' (boolean)."),t.hasOwnProperty("settingsMenu")||(e.settingsMenu=!!t.menus),t.hasOwnProperty("expressionsTopbar")||(e.expressionsTopbar=!!t.menus)),t.hasOwnProperty("solutions")&&(__dcg_shared_module_exports__['M'].warn("As of API v1.0, the 'solutions' option is deprecated and has been replaced with 'pointsOfInterest' (boolean)."),t.hasOwnProperty("pointsOfInterest")||(e.pointsOfInterest=!!t.solutions)),t.hasOwnProperty("singleVariableSolutions")&&__dcg_shared_module_exports__['M'].warn("As of API v1.0, the 'singleVariableSolutions' has been removed. The calculator no longer displays solutions to single variable equations."),t.hasOwnProperty("clickableObjects")&&(__dcg_shared_module_exports__['M'].warn("As of API v1.7, the 'clickableObjects' option is deprecated and has been replaced with 'actions'."),t.clickableObjects===!0&&!t.hasOwnProperty("actions")&&(e.actions=!0)),t.hasOwnProperty("administerSecretFolders")&&(__dcg_shared_module_exports__['M'].warn("As of API v1.8, the 'administerSecretFolders' option is deprecated and has been subsumed under 'authorFeatures'."),t.administerSecretFolders===!0&&!t.hasOwnProperty("authorFeatures")&&(e.authorFeatures=!0)),e.graphpaper||(e.expressionsCollapsed&&(e.expressionsCollapsed=!1,__dcg_shared_module_exports__['M'].warn("Desmos API initialized with bad options. graphpaper: false and expressionsCollapsed: true are incompatible. Proceeding with expressionsCollapsed: false.")),e.zoomButtons&&(e.zoomButtons=!1,__dcg_shared_module_exports__['M'].warn("Desmos API initialized with bad options. graphpaper: false and zoomButtons: true are incompatible. Proceeding with zoomButtons: false.")),e.showResetButtonOnGraphpaper&&(e.showResetButtonOnGraphpaper=!1,__dcg_shared_module_exports__['M'].warn("Desmos API initialized with bad options. graphpaper: false and showResetButtonOnGraphpaper: true are incompatible. Proceeding with showResetButtonOnGraphpaper: false."))),e.lockViewport&&e.zoomButtons&&(e.zoomButtons=!1,__dcg_shared_module_exports__['M'].warn("Desmos API initialized with bad options. lockViewport: true and zoomButtons: true are incompatible. Proceeding with zoomButtons: false.")),(e.notes===!1||e.folders===!1||e.images===!1)&&e.pasteGraphLink===!0&&(e.pasteGraphLink=!1,__dcg_shared_module_exports__['M'].warn("Desmos API initialized with bad options. pasteGraphLink: true is incompatible with disabling the creation of note, folder, or image expressions. Proceeding with pasteGraphLink: false.")),e.language&&(e.language=pd(e.language)),e}function J3(t,e){var r={},i={};for(var n in t)j3(n)?r[n]=t[n]:hP(n)?i[n]=t[n]:e||__dcg_shared_module_exports__['M'].warn("Unrecognized setting: "+n+". Ignoring.");return{configOptions:r,settingsOptions:i}}function Y3(t,e){var r={};return e.hasOwnProperty("x")&&(r.x=t.mapX(e.x)),e.hasOwnProperty("y")&&(r.y=t.mapY(e.y)),r}var Q3=[],i0=!1,X3=new Map;function Ej(t){let e=X3.get(t);return e||(e=new t,X3.set(t,e)),e}function Z3(t){if(!t||i0)return;let e;for(;(e=Q3.shift())&&e.api._destroyed;);if(!e)return;let r=e;i0=!0;let{options:i,mathBounds:n,state:o,callback:s}=r;var a=Ej(t);a.setState(o),a.setMathBounds(n),["majorAxisOpacity","minorAxisOpacity","axisLineOffset","axisLineWidth","labelSize","graphLineWidth","pointLineWidth"].forEach(g=>{g==="axisLineWidth"?a._calc.grapher.settings.setProperty(g,r.api._calc.grapher.settings[g]):a._calc.grapher.settings[g]=r.api._calc.grapher.settings[g]});var c=a._calc.evaluator,d=()=>{a._calc.grapher.asyncScreenshot(i,g=>{i0=!1,Z3(t),s(g)})},u=r.api._calc.controller,p=lh(function(){u.areAnyImagesLoading()||(yu(p),c.notifyWhenSynced(d))})}var bu=class extends Lr{constructor(r,i,n){super();this._destroyed=!1;this.isOffscreen=!1;var o=J3(i||{},!0),s=xE(o.configOptions),a=o.settingsOptions;this._calc=new Bw(r,$m,s),this._calc.interceptTouch(),this.controller=this._calc.controller,this.controller.onEventsEmitted=l=>{let c=this.controller.getSelectedItem();this.setProperty("isAnyExpressionSelected",!!c),this.setProperty("selectedExpressionId",c?c.id:void 0),this.setProperty("expressionAnalysis",this.controller.getExpressionAnalysis());var d=Xe.getFocusedMathquill();this.setProperty("focusedMathQuill",d?new gE(d):void 0);for(var u in l){if(!l.hasOwnProperty(u))continue;let p=l[u];p&&this.triggerEvent(u,p)}},this._calc.graphpaperBounds.observeAndSync("mathCoordinates",this._syncGraphpaperBounds.bind(this)),this._calc.graphpaperBounds.observeAndSync("pixelCoordinates",this._syncGraphpaperBounds.bind(this)),this.colors=this.controller.getColors(),this._initGraphSettings(),this.updateSettings(a),this._sharedClockBusToken=lh(l=>this.withControllerInAPIMode(()=>{var c=this._calc.grapher.settings.config.pauseWhenOffscreen&&this.isOffscreen;this._calc.tick(l,c)})),this.domChangeDetector=new fu(r,l=>this.withControllerInAPIMode(()=>{switch(this.isOffscreen=l.isOffscreen,l.type){case"offscreen-noop":break;case"added":this._calc.resize(l.size);break;case"removed":break;case"resized":this._calc.resize(l.size);break}})),s.autosize?this.domChangeDetector.startWatching():this.domChangeDetector.checkForChanges(),typeof n=="function"&&n(this)}destroy(){this.controller.onEventsEmitted=function(){},this._calc.destroy(),yu(this._sharedClockBusToken),this.domChangeDetector.destroy();function r(s){__dcg_shared_module_exports__['M'].warn("You've destroyed this API instance. You can no longer call ."+s+"()")}for(var i={},n=this;n;)Object.getOwnPropertyNames(n).forEach(a=>i[a]=!0),n=Object.getPrototypeOf(n);for(var o in i)typeof this[o]=="function"?this[o]=r.bind(this,o):this.hasOwnProperty(o)&&delete this[o];this.destroy=function(){},this._destroyed=!0}withControllerInAPIMode(r){try{return this.controller.pushAPIMethodCall(),r()}finally{this.controller.popAPIMethodCall()}}_syncGraphpaperBounds(){return this.withControllerInAPIMode(()=>{this.controller.runAfterDispatch(()=>{this.setProperty("graphpaperBounds",{mathCoordinates:this._calc.graphpaperBounds.mathCoordinates,pixelCoordinates:this._calc.graphpaperBounds.pixelCoordinates})})})}_initGraphSettings(){return this.withControllerInAPIMode(()=>{var r=new Lr;this.settings=this.graphSettings=r,dP.forEach(i=>{this._calc.grapher.settings.observeAndSync(i,()=>{this.controller.runAfterDispatch(()=>{r.setProperty(i,this._calc.grapher.settings[i])})})}),$3.forEach(i=>{this._calc.grapher.settings.config.observeAndSync(i,()=>{this.controller.runAfterDispatch(()=>{r.setProperty(i,this._calc.grapher.settings.config[i])})})})})}updateSettings(r){return this.withControllerInAPIMode(()=>{var i=J3(r,!1),n=i.configOptions,o=i.settingsOptions;__dcg_shared_module_exports__['G'](n)||this._calc.setOptions(n),__dcg_shared_module_exports__['G'](o)||this.controller.dispatch(__dcg_shared_module_exports__['b']({type:"set-graph-settings"},this.controller.getGraphSettings().validateSettings(o))),this.notifyControllerOfAPICall()})}setGraphSettings(r){return this.withControllerInAPIMode(()=>{__dcg_shared_module_exports__['M'].warn("As of API v0.8 the 'setGraphSettings' method is deprecated and has been renamed 'updateSettings.'"),this.updateSettings(r),this.setGraphSettings=this.updateSettings,this.notifyControllerOfAPICall()})}fetchLanguage(r){return this.withControllerInAPIMode(()=>og(r))}setDefaultState(r){return this.withControllerInAPIMode(()=>{this._calc.grapher.settings.setProperty("defaultState",r),this.notifyControllerOfAPICall()})}mathToPixels(r){return this.withControllerInAPIMode(()=>{var i=__dcg_shared_module_exports__['Ec'].fromRects(this.graphpaperBounds.mathCoordinates,this.graphpaperBounds.pixelCoordinates,{xAxisScale:this._calc.grapher.settings.xAxisScale,yAxisScale:this._calc.grapher.settings.yAxisScale});return Y3(i,r)})}pixelsToMath(r){return this.withControllerInAPIMode(()=>{var i=__dcg_shared_module_exports__['Ec'].fromRects(this.graphpaperBounds.mathCoordinates,this.graphpaperBounds.pixelCoordinates,{xAxisScale:this._calc.grapher.settings.xAxisScale,yAxisScale:this._calc.grapher.settings.yAxisScale}).inverse();return Y3(i,r)})}notifyControllerOfAPICall(){return this.withControllerInAPIMode(()=>{this.controller.dispatch({type:"render"})})}setExpression(r){return this.withControllerInAPIMode(()=>{var i=this.controller,n=i.getItemModel(r.id),o=n&&n.type,s=uE(r,o,this.controller);if(s)if(o)this.controller.dispatch({type:"set-expression-properties-from-api",id:s.id,properties:s});else{if(s.type==="image")return;this.controller.dispatch({type:"add-item-to-end-from-api",state:s})}})}setExpressions(r){return this.withControllerInAPIMode(()=>{r.forEach(this.setExpression.bind(this))})}removeExpression(r){return this.withControllerInAPIMode(()=>{var i=r.id.toString();this.controller.dispatch({type:"remove-item-by-id",id:i})})}removeExpressions(r){return this.withControllerInAPIMode(()=>{r.forEach(this.removeExpression.bind(this))})}removeSelected(){return this.withControllerInAPIMode(()=>{var r=this.controller.getSelectedItem();if(!r)return;let{id:i}=r;return this.controller.dispatch({type:"remove-item-by-id",id:i}),i})}setMathBounds(r){return this.withControllerInAPIMode(()=>{r&&r.left<r.right&&r.bottom<r.top?(this._calc.setViewport([r.left,r.right,r.bottom,r.top]),this._calc.controller.unmarkLastChangedAxis(),this._calc.controller.markSquareAxesAfterUserEditedViewport()):__dcg_shared_module_exports__['M'].warn("Invalid bounds argument. Expected a bounds object with bounds.bottom < bounds.top, and bounds.left < bounds.right. Got "+JSON.stringify(r)),this.notifyControllerOfAPICall()})}setViewport(r){return this.withControllerInAPIMode(()=>{r.length==4&&r[1]>r[0]&&r[3]>r[2]?(this._calc.setViewport(r),this._calc.controller.markSquareAxesAfterUserEditedViewport()):__dcg_shared_module_exports__['M'].warn("Invalid viewport.  Expected [xmin, xmax, ymin, ymax].  Got "+r),this.notifyControllerOfAPICall()})}resize(){return this.withControllerInAPIMode(()=>{this.domChangeDetector.checkForChanges()})}getState(r){return this.withControllerInAPIMode(()=>this.controller.getState(r))}getExpressions(){return this.withControllerInAPIMode(()=>{var r=this.getState({stripDefaults:!1}).expressions.list;return r.map(pE)})}setBlank(r){return this.withControllerInAPIMode(()=>{this.controller.dispatch({type:"set-blank",opts:r||{}})})}setState(r,i){return this.withControllerInAPIMode(()=>{this.controller.dispatch({type:"set-state",state:r,opts:i||{}})})}undo(){return this.withControllerInAPIMode(()=>{this.controller.dispatch({type:"undo"})})}redo(){return this.withControllerInAPIMode(()=>{this.controller.dispatch({type:"redo"})})}clearHistory(){return this.withControllerInAPIMode(()=>{this.controller.dispatch({type:"clear-undoredo-history"})})}newRandomSeed(){return this.withControllerInAPIMode(()=>{this.updateSettings({randomSeed:ad()})})}screenshot(r){return this.withControllerInAPIMode(()=>(r||(r={}),r=this._validateBrailleScreenshotOptions(r),this._calc.grapher.screenshot(r)))}_getMathAspectRatio(){return this.withControllerInAPIMode(()=>{var r=this.graphpaperBounds.mathCoordinates,i=this._calc.grapher.getProjection().pixelCoordinates,n=i.right-i.left,o=i.bottom-i.top,s=r.width/n,a=r.height/o;return s/a})}isProjectionUniform(){return this.withControllerInAPIMode(()=>!!this._calc.grapher.getProjection().settings.squareAxes)}_validateBrailleScreenshotOptions(r){return this.withControllerInAPIMode(()=>{r=__dcg_shared_module_exports__['N'](r);var i=r.braille;if(i){let n=i.embosserModel;if(!n)return __dcg_shared_module_exports__['M'].warn("Screenshot braille options requires an embosser model to be specified. "),__dcg_shared_module_exports__['M'].warn("Continuing with non-braille screenshot."),delete r.braille,r;if(n==="etc"&&(i.embosserModel="etc11"),n==="vpmax"&&(i.embosserModel="vpmax11"),i.embosserModel!=="etc8"&&i.embosserModel!=="etc11"&&i.embosserModel!=="vpmax8"&&i.embosserModel!=="vpmax11")return __dcg_shared_module_exports__['M'].warn('Unknown screenshot braille embosser model. Valid models are "etc" and "vpmax".'),__dcg_shared_module_exports__['M'].warn("Continuing with non-braille screenshot."),delete r.braille,r;i.brailleMode!=="nemeth"&&i.brailleMode!=="ueb"&&(__dcg_shared_module_exports__['M'].warn("Screenshot options braille.brailleMode must be nemeth or ueb. Proceeding with nemeth."),i.brailleMode="nemeth"),r.width&&(__dcg_shared_module_exports__['M'].warn("Screenshot width option is ignored when exporting Braille."),delete r.width),r.height&&(__dcg_shared_module_exports__['M'].warn("Screenshot height option is ignored when exporting Braille."),delete r.height),r.targetPixelRatio&&(__dcg_shared_module_exports__['M'].warn("Screenshot targetPixelRatio option is ignored when exporting Braille."),delete r.targetPixelRatio),r.preserveAxisNumbers&&(__dcg_shared_module_exports__['M'].warn("Screenshot preserveAxisNumbers option is ignored when exporting Braille."),delete r.preserveAxisNumbers)}return r})}_validateAsyncScreenshotOpts(r){return this.withControllerInAPIMode(()=>{r=__dcg_shared_module_exports__['N'](r);let i=r.mode||"contain",n=r.width||r.height||this.graphpaperBounds.pixelCoordinates.width,o=r.height||r.width||this.graphpaperBounds.pixelCoordinates.height,s=r.targetPixelRatio||1;s<1&&(s=1);let a=r.preserveAxisNumbers;r.hasOwnProperty("format")||(r.svg?(r.format="svg",delete r.svg):r.format="png");let l=r.mathBounds||{},c=this._getMathAspectRatio(),d=this.graphpaperBounds.pixelCoordinates.width/this.graphpaperBounds.pixelCoordinates.height,u=R3({mode:i,width:n,height:o,currentBounds:this.graphpaperBounds.mathCoordinates,graphpaperAspectRatio:d,mathAspectRatio:c,mathBounds:l});return{opts:__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},r),{width:n,height:o,targetPixelRatio:s,preserveAxisNumbers:a}),mathBounds:u}})}asyncScreenshot(r,i){if(!arguments.length){__dcg_shared_module_exports__['M'].warn("asyncScreenshot expects a callback");return}if(arguments.length===1)if(typeof r!="function"){__dcg_shared_module_exports__['M'].warn("asyncScreenshot expects a callback");return}else i=r,r={};return this.withControllerInAPIMode(()=>{r||(r={}),r=this._validateBrailleScreenshotOptions(r);let{opts:n,mathBounds:o}=this._validateAsyncScreenshotOpts(r);Q3.push({api:this,options:n,mathBounds:o,state:this.getState(),callback:i}),Z3(this.constructor)})}setOptions(r){return this.withControllerInAPIMode(()=>{var i=this._calc.setOptions(r);return this.notifyControllerOfAPICall(),i})}focusFirstExpression(){return this.withControllerInAPIMode(()=>{this.controller.dispatch({type:"focus-first-expression"})})}HelperExpression(r){return this.withControllerInAPIMode(()=>{var i=r&&r.latex||"",n=new Lr;return n.latex=i,this.controller.dispatch({type:"add-helper-expression",state:{type:"helper-expression",id:this.controller.generateId(),latex:i,proxy:n}}),n})}};var Ea=class extends bu{constructor(e,r,i){super(e,__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},r),{product:"graphing"}),i)}};var bf=__dcg_shared_module_exports__['i'](Z());var Qa=__dcg_shared_module_exports__['i'](Z());var mt=__dcg_shared_module_exports__['i'](Z());Oe();var kl=__dcg_shared_module_exports__['i'](Z());var vE=class extends kl.Class{template(){return kl.createElement("span",{role:kl.const("button"),tabindex:kl.const(0),"aria-label":()=>this.openGraphText(),class:kl.const("dcg-header-btn dcg-action-opendrawer dcg-tooltip"),tooltip:()=>this.openGraphText(),onTap:e=>this.props.controller().dispatch({type:"open-mygraphs",device:e.device})},kl.createElement(Pe,{tooltip:()=>this.openGraphText(),disabled:()=>!this.props.tooltip(),gravity:this.const("se"),offset:()=>({top:12})},kl.createElement("i",{class:kl.const("dcg-icon-hamburger"),"aria-hidden":kl.const("true")})))}openGraphText(){let e=this.props.controller().getOpenText();return Zr?this.props.controller().s("account-shell-label-open-graph-mac",{open_graph:e}):this.props.controller().s("account-shell-label-open-graph-pc",{open_graph:e})}};var fr=__dcg_shared_module_exports__['i'](Z());Oe();var{If:CE}=fr.Components,DE=class extends fr.Class{template(){let e=this.props.controller().userController;return fr.createElement("span",null,fr.createElement(CE,{predicate:()=>e.isLoggedIn()&&!this.props.disableAccounts()},()=>fr.createElement("span",null,fr.createElement(CE,{predicate:()=>e.isLoggingOut()},()=>fr.createElement("span",{class:fr.const("logout-progress-notice")},fr.createElement("span",{class:fr.const("dcg-spinner-dark")}))),fr.createElement(CE,{predicate:()=>!e.isLoggingOut()&&!this.props.disableAccounts()},()=>fr.createElement("span",{class:fr.const("dcg-account-link"),"dcg-menu-button":fr.const("account"),role:fr.const("button"),tabindex:fr.const(0),"aria-haspopup":fr.const("true"),"aria-expanded":fr.const("false"),"aria-label":fr.const("Account Information"),onTap:r=>{if(this.props.controller().dispatch({type:"toggle-menu",payload:"account"}),r.device=="keyboard"){let n=this.props.controller().getOpenMenu()==="account"?".dcg-action-accountsettings":".dcg-account-link";I(n).trigger("focus")}}},fr.createElement("span",{class:fr.const("email")},fr.createElement("div",{class:fr.const("header-account-name dcg-variable-name")},()=>e.getFirstName()),fr.createElement("i",{class:fr.const("dcg-icon-caret-down"),"aria-hidden":fr.const("true")})))))),fr.createElement(CE,{predicate:()=>!e.isLoggedIn()&&!this.props.disableAccounts()},()=>fr.createElement("span",{class:fr.const("dcg-login")},fr.createElement("a",{role:fr.const("link"),tabindex:fr.const(0),class:fr.const("dcg-sign-in dcg-action-login dcg-btn-white-outline"),onTap:r=>{this.props.controller().dispatch({type:"show-modal",modal:"login",device:r.device})}},()=>this.props.controller().s("account-shell-button-log-in")),()=>this.props.controller().s("account-shell-text-or"),fr.createElement("a",{role:fr.const("link"),tabindex:fr.const(0),class:fr.const("dcg-create-account dcg-btn dcg-btn-primary dcg-action-createaccount"),onTap:r=>{this.props.controller().dispatch({type:"show-modal",modal:"signup",device:r.device})}},()=>this.props.controller().s("account-shell-button-sign-up")))))}};var wc=__dcg_shared_module_exports__['i'](Z());var Wm=class extends wc.Class{init(){this.controller=this.props.controller()}template(){return this.controller=this.props.controller(),wc.createElement(Pe,{tooltip:this.props.tooltip,gravity:this.bindFn(this.getGravity),offset:()=>({top:12})},wc.createElement("span",{role:wc.const("button"),tabindex:wc.const("0"),"aria-haspopup":wc.const("true"),"aria-label":()=>this.props.label(),"aria-expanded":()=>this.isMenuOpen(),class:()=>({"dcg-header-btn":!0,[`dcg-action-${this.props.name()}`]:!0,"dcg-tooltip":!0,"dcg-active":this.isMenuOpen()}),"dcg-menu-button":this.props.name,onTap:this.props.onTap},wc.createElement("i",{class:this.props.icon,"aria-hidden":wc.const("true")})))}getGravity(){return this.props.gravity?this.props.gravity():"s"}isMenuOpen(){return this.controller.getOpenMenu()===this.props.label().toLowerCase()}};var uo=__dcg_shared_module_exports__['i'](Z());Oe();var po=__dcg_shared_module_exports__['i'](Z());var{SwitchUnion:kj}=po.Components,SE=class extends po.Class{init(){this.controller=this.props.controller(),this.graphsController=this.controller.graphsController}getSaveStatus(){return this.graphsController.isSaving()?"saving":this.graphsController.didSaveSucceed()?"save-success":"default"}template(){return po.createElement("span",null,kj(()=>this.getSaveStatus(),{saving:()=>po.createElement("span",{class:po.const("dcg-if-user save-btn-container")},po.createElement("span",{class:po.const("saving-notice")},po.createElement("span",{class:po.const("dcg-spinner-dark")}))),"save-success":()=>po.createElement("span",{class:po.const("dcg-save-success")},po.createElement("i",{class:po.const("dcg-icon-check")}),()=>this.controller.s("shared-calculator-label-saved")),default:()=>po.createElement("span",{class:()=>({"dcg-if-user save-btn-container":!0})},po.createElement(Pe,{tooltip:()=>this.controller.isSaveEnabled()?this.saveChangesText():this.controller.s("account-shell-label-no-unsaved-changes"),offset:()=>({top:7})},po.createElement("span",{role:po.const("button"),class:()=>({"dcg-action-save":!0,"tooltip-offset":!0,"dcg-btn-primary":this.controller.isSaveEnabled(),"dcg-disabled":!this.controller.isSaveEnabled()}),onTap:e=>{this.controller.isSaveEnabled()&&this.controller.simpleSave(e.device)}},()=>this.controller.s("account-shell-button-save"))))}))}saveChangesText(){return Zr?this.controller.s("account-shell-label-save-changes-mac"):this.controller.s("account-shell-label-save-changes-pc")}};var{If:eK}=uo.Components,EE=class extends uo.Class{init(){this.controller=this.props.controller(),this.userController=this.controller.userController,this.graphsController=this.controller.graphsController}template(){return uo.createElement("span",{class:uo.const("title-div")},uo.createElement("span",{role:uo.const("button"),class:uo.const("dcg-variable-title-container"),"dcg-menu-button":()=>this.shouldShowDropdown()?"graph-actions":void 0,tabindex:uo.const(0),onTap:e=>{this.shouldShowDropdown()?this.openGraphActionsDropdown(e):this.shouldOpenSaveDialog()&&this.controller.dispatch({type:"edit-title"})},"aria-haspopup":()=>this.shouldShowDropdown(),"aria-expanded":()=>this.props.controller().getOpenMenu()=="graph-actions","aria-label":()=>this.shouldShowDropdown()?this.controller.s("account-shell-label-graph-actions"):void 0},uo.createElement("span",{class:()=>({"dcg-variable-title dcg-tooltip":!0,"dcg-action-savedialog":this.shouldOpenSaveDialog()})},()=>this.graphsController.getCurrentGraphTitle()||this.graphsController.getUntitledString()),uo.createElement(eK,{predicate:this.bindFn(this.shouldShowDropdown)},()=>uo.createElement("span",{class:uo.const("dcg-graph-actions-dropdown-anchor")},uo.createElement("i",{class:uo.const("dcg-icon-caret-down"),"aria-hidden":uo.const("true")})))),uo.createElement(eK,{predicate:()=>this.userController.isLoggedIn()&&!this.controller.getPreviewParams()&&!this.controller.isInMaintenanceMode()},()=>uo.createElement(SE,{controller:this.props.controller})))}shouldOpenSaveDialog(){return this.controller.product==="geometry"}shouldShowDropdown(){return this.controller.product!=="geometry"&&this.graphsController.wasCurrentGraphEverSaved()}openGraphActionsDropdown(e){this.props.controller().dispatch({type:"toggle-menu",payload:"graph-actions"}),e&&e.device==="keyboard"&&this.controller.getOpenMenu()!=="share"&&I(".dcg-graph-actions-container .dropdown-choice:not(.dropdown-choice-disabled):eq(0)").trigger("focus")}};var GE=__dcg_shared_module_exports__['i'](Z());var kE=class extends GE.Class{template(){return GE.createElement("span",{onMount:this.bindFn(this.addSVGLogo)})}addSVGLogo(e){e.innerHTML=`
    <svg version="1.1" class="dcg-desmos-svg-logo" id="svg-desmos" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
    viewBox="0 0 909.3 188.4" style="enable-background:new 0 0 909.3 188.4;" xml:space="preserve">
    <title>${Yo("frontpage-narration-shared-desmos-logo")}</title>
    <g>
      <path d="M129.6,0c-6.8,0-12.4,5.5-12.4,12.4v48c-27.7-25.4-70.6-24-96.7,3.1c-27.4,28.4-27.4,73.4,0,101.8
        c26.1,27.1,69.1,28.4,96.8,3v8.8c2,6.5,9,10.2,15.5,8.2c3.9-1.2,7-4.3,8.2-8.2V12.4C141.1,5.9,136.1,0.5,129.6,0z M103.9,148.7
        c-17.3,18.2-46.1,18.9-64.3,1.6c-0.6-0.5-1.1-1.1-1.6-1.6c-18.4-19.2-18.4-49.5,0-68.7c17.3-18.2,46.1-18.9,64.3-1.6
        c0.6,0.5,1.1,1.1,1.6,1.6C122.3,99.3,122.3,129.6,103.9,148.7z"/>
      <path d="M298.3,124c2.2-2.3,3.4-5.3,3.5-8.4c-0.1-19-7.6-37.2-20.9-50.7c-26.6-27.6-70.6-28.4-98.2-1.8c-0.6,0.6-1.2,1.2-1.8,1.8
        c-27.4,28.4-27.4,73.4,0,101.8c21.8,22.6,56.2,27.7,83.7,12.4c10-5.6,18.5-13.5,24.8-23.1c3.4-5.5,1.9-12.7-3.3-16.5
        c-5.5-3.3-12.6-1.7-16.4,3.5c-4.2,6.4-9.9,11.6-16.6,15.4c-6.8,3.8-14.4,5.8-22.2,5.8c-12.5,0-24.4-5.1-33.1-14.1
        c-6-6.3-10.3-14-12.4-22.4h104C292.7,127.6,296,126.3,298.3,124z M231.3,67.2c12.4,0.1,24.3,5.2,33,14.1
        c6.1,6.3,10.4,14.1,12.4,22.6h-90.7c2.1-8.5,6.3-16.3,12.4-22.6C207,72.4,218.8,67.3,231.3,67.2z"/>
      <path d="M763.5,63c-26.7-28.1-71.1-29.2-99.2-2.5c-0.8,0.8-1.7,1.6-2.5,2.5c-13.7,13.9-21.3,32.7-20.9,52.2
        c-0.2,19.3,7.2,37.8,20.7,51.6c27.7,28.2,73.1,28.7,101.3,0.9c0.3-0.3,0.6-0.6,0.9-0.9c13.4-13.8,20.9-32.4,20.7-51.7
        c0.2-19.4-7.3-38.2-21.1-51.9 M712.8,66.7c12.4,0,24.2,5.2,32.5,14.4c8.9,9.2,13.8,21.5,13.6,34.3c0.2,12.7-4.6,25-13.5,34.1
        c-8.5,9.2-20.5,14.2-33,13.9c-12.3,0.3-24.2-4.7-32.5-13.8c-8.8-9.1-13.6-21.4-13.3-34.1c-0.3-12.9,4.7-25.4,13.8-34.6
        c8.2-9.3,20-14.6,32.4-14.4"/>
      <path d="M623.8,92.6v81.9c0.3,6.8-4.9,12.7-11.8,13c-6.8,0.3-12.7-4.9-13-11.8V93.1c0-7.5-3-14.6-8.3-19.8
        c-4.3-4.7-10.2-7.6-16.5-8.1h-1.9c-7-0.1-13.6,2.9-18.2,8.2c-4.8,4.9-7.5,11.5-7.7,18.3v2l0,0v81.1c0,6.8-5.5,12.4-12.4,12.4
        c-6.5,0-11.9-4.9-12.4-11.4V91.5c-0.6-4.3-1.8-8.4-3.5-12.4c-1.2-2.3-2.6-4.5-4.3-6.4c-4.7-5.2-11.3-8.3-18.3-8.3
        c-7,0-13.6,3-18.1,8.3c-5.1,5.2-8,12.3-7.9,19.6V176c-0.8,6.3-6.1,11-12.4,10.9c-6.8,0-12.4-5.5-12.4-12.4V52.9
        c-0.7-6.8,4.2-12.9,11-13.6c5.9-0.6,11.4,3,13.1,8.7l2.9-1.9c7.4-3.9,15.6-6,23.9-5.9c12.3-0.1,24.1,4.3,33.3,12.4
        c1.1,0.9,2.1,2,3,3.1c0.9,0.7,1.7,1.5,2.5,2.4l2.2-2.4c0.9-1.1,1.9-2.2,3-3.1c9.2-8.1,21-12.5,33.2-12.4h4.3
        c10.8,0.8,21,5.1,29,12.4c0.9,1,2,1.9,3,2.9C618.9,65.3,624,78.7,623.8,92.6"/>
      <path d="M427.2,145.4c0.1,23.4-18.6,42.5-42,43h-50.8c-6.8,0-12.4-5.5-12.4-12.4s5.5-12.4,12.4-12.4H384c10-0.2,17.9-8.4,17.8-18.3
        c0.1-9.9-7.9-18-17.8-18.1c0,0-0.1,0-0.1,0h-24.8c-23.8-1.3-42-21.6-40.8-45.4c1.2-22,18.8-39.6,40.8-40.8h50.2
        c6.8,0,12.4,5.5,12.4,12.4s-5.5,12.4-12.4,12.4h-49.1c-10,0.8-17.5,9.6-16.7,19.7c0.7,8.9,7.8,15.9,16.7,16.7H385
        c5.9,0,11.8,1.2,17.2,3.7C417.7,112.8,427.2,128.4,427.2,145.4"/>
      <path d="M908.9,145.2c0,23.4-18.3,42.7-41.6,43.3h-50.8c-6.8,0-12.4-5.5-12.4-12.4s5.5-12.4,12.4-12.4h50.2
        c10-0.2,17.9-8.4,17.8-18.3c0.1-9.9-7.9-18-17.8-18.1c0,0-0.1,0-0.1,0h-24.8c-23.8-1.3-42-21.6-40.8-45.4
        c1.2-22,18.8-39.6,40.8-40.8h49.6c6.8,0,12.4,5.5,12.4,12.4s-5.5,12.4-12.4,12.4h-49.6c-10.1,0-18.2,8.2-18.2,18.2c0,0,0,0,0,0
        c0,9.9,8,18,17.8,18.1h24.8c5.9,0,11.8,1.3,17.2,3.7C898.9,112.8,908.9,128.2,908.9,145.2"/>
    </g>
    </svg>
    `}};var{If:wu}=mt.Components,VE=class extends mt.Class{init(){this.controller=this.props.controller(),this.userController=this.controller.userController}template(){let e=this.controller.isInMaintenanceMode(),r=this.controller.getPreviewParams();return mt.createElement("div",{class:mt.const("dcg-header")},mt.createElement("div",{class:mt.const("dcg-header-desktop")},mt.createElement("div",{class:mt.const("align-left-container")},mt.createElement(vE,{controller:this.props.controller,tooltip:mt.const(!0)}),mt.createElement(EE,{controller:this.props.controller})),mt.createElement("div",{class:mt.const("align-center-container")},mt.createElement("a",{href:mt.const("/"),target:mt.const("_blank"),class:mt.const("dcg-home-link")},mt.createElement(kE,null))),mt.createElement(wu,{predicate:()=>this.userController.didLogoutFail()},()=>mt.createElement("div",{class:mt.const("dcg-toast-container")},mt.createElement("div",{class:mt.const("dcg-toast")},()=>this.controller.s("account-shell-error-logging-out")))),mt.createElement("div",{class:mt.const("align-right-container")},mt.createElement(DE,{controller:this.props.controller,disableAccounts:()=>r!=null||e}),mt.createElement(wu,{predicate:()=>this.controller.isArtContestEnabled()},()=>mt.createElement(Pe,{tooltip:()=>Yo("account-shell-label-math-art-contest"),gravity:this.const("s"),offset:()=>({top:12})},mt.createElement("span",{role:mt.const("button"),tabindex:mt.const(0),"aria-haspopup":mt.const("true"),"aria-label":()=>Yo("account-shell-label-math-art-contest"),class:mt.const("dcg-header-btn dcg-action-contest dcg-tooltip"),onTap:i=>this.controller.dispatch({type:"show-modal",modal:"contest-submission",device:i.device})},mt.const("\u{1F3C6}")))),mt.createElement(Wm,{controller:this.props.controller,label:()=>Yo("account-shell-label-share"),tooltip:()=>this.controller.s("account-shell-label-share-graph"),icon:mt.const("dcg-icon-share"),name:()=>"share",onTap:i=>{if(this.controller.dispatch({type:"toggle-menu",payload:"share"}),i&&i.device==="keyboard"&&this.controller.getOpenMenu()!=="share")return this.focusElement(".dcg-action-share")}}),mt.createElement(Wm,{controller:this.props.controller,label:()=>Yo("account-shell-label-help"),tooltip:()=>this.controller.s("account-shell-label-help"),icon:mt.const("dcg-icon-question-sign"),name:mt.const("help"),onTap:i=>{if(this.controller.dispatch({type:"toggle-menu",payload:"help"}),i.device==="keyboard"){let o=this.controller.getOpenMenu()==="help"?'.dcg-feature[href="/calculator?tour=sliders"]':".dcg-action-help";return this.focusElement(o)}}}),mt.createElement(Wm,{controller:this.props.controller,gravity:this.const("sw"),label:()=>Yo("account-shell-label-language"),tooltip:()=>this.controller.s("account-shell-label-language"),icon:mt.const("dcg-icon-world"),name:mt.const("language"),onTap:i=>{if(this.controller.dispatch({type:"toggle-menu",payload:"language"}),i.device==="keyboard"){let o=this.controller.getOpenMenu()==="language"?".dcg-language-option.dcg-selected":".dcg-action-language";return this.focusElement(o)}}}))),mt.createElement(wu,{predicate:()=>r!=null||e},()=>mt.createElement("div",{class:mt.const("dcg-toast-container")},mt.createElement("span",{class:mt.const("dcg-toast dcg-maintenance-toast")},mt.createElement("span",{class:mt.const("dcg-msg")},mt.createElement(wu,{predicate:()=>e},()=>mt.createElement("span",null,()=>this.controller.s("account-shell-text-maintenance-mode"))),mt.createElement(wu,{predicate:()=>r!=null},()=>mt.createElement("span",null,()=>r!=null?r.message:void 0))),mt.createElement(wu,{predicate:()=>e},()=>mt.createElement("a",{class:mt.const("undo"),target:mt.const("_blank"),href:mt.const("http://desmos.zendesk.com/entries/25429616-What-is-Maintenance-Mode-/")},()=>this.controller.s("account-shell-link-learn-more"))),mt.createElement(wu,{predicate:()=>r!=null},()=>mt.createElement("a",{class:mt.const("undo"),target:mt.const("_blank"),href:()=>r!=null?r.url:void 0},()=>this.controller.s("account-shell-link-share-thoughts")))))))}focusElement(e){I(e).trigger("focus")}};var cp=__dcg_shared_module_exports__['i'](Z());var Xs=__dcg_shared_module_exports__['i'](Z());Oe();var{If:Gj}=Xs.Components,Gl=class extends Xs.Class{init(){this.controller=this.props.controller()}template(){return Xs.createElement("div",{class:()=>({"dcg-popover":!0,"dcg-bottom":!0,"dcg-constrained-height-popover":!0,[`dcg-${this.props.type()}-container`]:!0,[`dcg-product-${this.props.controller().getProduct()}`]:!0}),style:()=>this.props.left?{display:"block",left:this.props.left(),right:"auto"}:{display:"block"},role:Xs.const("complementary"),label:()=>this.props.label()},Xs.createElement("div",{class:Xs.const("dcg-popover-interior")},Xs.createElement(Gj,{predicate:()=>!!(typeof this.props.title=="function"&&this.props.title())},()=>Xs.createElement("div",{class:Xs.const("dcg-popover-title")},()=>this.props.title())),this.children),Xs.createElement("div",{class:Xs.const("dcg-arrow"),style:()=>this.props.arrowLeft?{left:this.props.arrowLeft(),right:"auto"}:{}}))}didMount(){let e=this.props.type();this.guid=`menu-${e}`,I("body").on(`dcg-tapstart.${this.guid}`,r=>{let i=I(r.target),n=!!i.closest(".dcg-popover").length,o=!!i.closest(`[dcg-menu-button=${e}]`).length;!n&&!o&&this.controller.dispatch({type:"toggle-menu",payload:"none"})})}didUnmount(){I("body").off(`dcg-tapstart.${this.guid}`)}};var Tn=__dcg_shared_module_exports__['i'](Z());var{For:Vj,If:Ij}=Tn.Components,IE=class extends Tn.Class{init(){this.i18n=this.props.i18n()}template(){return Tn.createElement("div",{class:()=>({"dcg-language-picker":!0,"dcg-two-columns":this.getLanguages().length>7})},Tn.createElement("div",{class:Tn.const("dcg-language-header"),role:Tn.const("heading"),"aria-level":Tn.const("2")},()=>this.i18n.s("shared-title-language-menu")),Tn.createElement(Vj,{each:()=>this.getLanguages()},Tn.createElement("div",{class:Tn.const("dcg-languages-list"),role:Tn.const("list")},e=>Tn.createElement("div",{class:Tn.const("dcg-listitem"),role:Tn.const("listitem")},Tn.createElement("div",{class:()=>({"dcg-language-option":!0,"dcg-selected":this.isLanguageSelected(e)}),lang:this.const(this.getLangCode(e)),role:Tn.const("link"),tabindex:Tn.const("0"),"aria-current":()=>this.isLanguageSelected(e),onTap:()=>this.updateLang(e)},()=>this.i18n.raw(this.getLanguageDisplayName(e)))))),Tn.createElement(Ij,{predicate:()=>this.shouldShowFooterLink()},()=>Tn.createElement("a",{class:Tn.const("dcg-language-footer-link dcg-shared-blue-link"),href:()=>this.getFooterLinkURL()},()=>this.getFooterLinkText())))}shouldShowFooterLink(){return!!(this.props.footerLink&&this.props.footerLink())}getFooterLinkURL(){let e=this.props.footerLink&&this.props.footerLink();if(e)return e.url}getFooterLinkText(){let e=this.props.footerLink&&this.props.footerLink();return e?e.text:this.i18n.raw("")}getCurrentLang(){return this.props.currentLang()}getLanguages(){return Object.keys(this.props.getAllLangs())}getLanguageDisplayName(e){return this.props.getAllLangs()[e].display_name}updateLang(e){let r=this.props.getAllLangs()[e].code;return this.props.onLangChosen(r)}getLangCode(e){return this.props.getAllLangs()[e].code}isLanguageSelected(e){return this.getLangCode(e)===this.getCurrentLang()}};var Mj=$L(),ME=class extends cp.Class{init(){this.controller=this.props.controller(),this.languageController=this.controller.languageController}template(){return cp.createElement(Gl,{type:()=>"language",label:()=>this.controller.s("account-shell-narration-language-menu"),controller:this.props.controller},cp.createElement("div",{class:cp.const("dcg-popover-content")},cp.createElement(IE,{getAllLangs:()=>Mj,currentLang:()=>this.languageController.getLanguage(),onLangChosen:e=>{this.languageController.fetchAndSetLanguage(e),this.controller.dispatch({type:"toggle-menu",payload:"none"})},i18n:this.props.controller})))}};var ka=__dcg_shared_module_exports__['i'](Z());Oe();var xc={};__dcg_shared_module_exports__['h'](xc,{ANIMATING_SLIDER:()=>c0,COMPLEX_EXP:()=>jm,DEFINES:()=>PE,DEPENDS_ON:()=>hp,EVALUATION:()=>a0,EXP:()=>AE,EXP_NOT_RESTRICTED_LINE:()=>RE,FOCUSED_EXP:()=>zw,FOCUSED_OR_EMPTY_EXP:()=>ch,GRAPHABLE_EXP:()=>dp,HAS_DATA_COLUMN:()=>Ww,HAS_DEPENDENT_Y:()=>l0,HAS_ERROR:()=>LE,HAS_FUNCTION_COLUMN:()=>h0,HAS_N_DEPENDENCIES:()=>OE,NONCONSTANT_LINE:()=>_E,PARABOLA:()=>Jm,REGRESSION:()=>BE,RESTRICTED:()=>$w,RESTRICTED_LINE:()=>FE,SHIFTED_PARABOLA:()=>s0,SLIDER:()=>NE,SLID_SLIDER:()=>d0,TABLE:()=>xu,TABLEABLE_EXP:()=>o0});function TE(t,e){return __dcg_shared_module_exports__['ea'](1/__dcg_shared_module_exports__['tc'](__dcg_shared_module_exports__['sc'](t)),0,e)}function Tj(t,e,r,i,n,o){return TE([[t,e,1],[r,i,1],[n,o,1]])}function Aj(t,e,r,i,n,o,s,a){return TE([[t*t+e*e,t,e,1],[r*r+i*i,r,i,1],[n*n+o*o,n,o,1],[s*s+a*a,s,a,1]])}function Lj(t,e,r,i,n,o,s,a,l,c,d,u){return TE([[t*t,e*e,2*t*e,t,e,1],[r*r,i*i,2*r*i,r,i,1],[n*n,o*o,2*n*o,n,o,1],[s*s,a*a,2*s*a,s,a,1],[l*l,c*c,2*l*c,l,c,1],[d*d,u*u,2*d*u,d,u,1]])}function Pj(t,e,r,i,n,o,s,a,l,c){return{a:__dcg_shared_module_exports__['rc'].det([[e*e,2*t*e,t,e,1],[i*i,2*r*i,r,i,1],[o*o,2*n*o,n,o,1],[a*a,2*s*a,s,a,1],[c*c,2*l*c,l,c,1]]),b:__dcg_shared_module_exports__['rc'].det([[t*t,e*e,t,e,1],[r*r,i*i,r,i,1],[n*n,o*o,n,o,1],[s*s,a*a,s,a,1],[l*l,c*c,l,c,1]]),c:-__dcg_shared_module_exports__['rc'].det([[t*t,2*t*e,t,e,1],[r*r,2*r*i,r,i,1],[n*n,2*n*o,n,o,1],[s*s,2*s*a,s,a,1],[l*l,2*l*c,l,c,1]])}}function Oj(t,e,r,i,n,o,s,a,l,c,d,u){if(Tj(t,e,n,o,d,u))return"line";if(Aj(t,e,r,i,l,c,d,u))return"circle";if(!Lj(t,e,r,i,n,o,s,a,l,c,d,u))return"none";var p=Pj(t,e,r,i,n,o,s,a,l,c);return TE([[p.a,p.b],[p.b,p.c]],20)?"parabola":p.b*p.b>p.a*p.c?"hyperbola":"ellipse"}function tK(t){var e,r;if(t.length===1&&t[0].length===4)return"line";for(var i=0;i<t.length;i++){var n=t[i],o=n.length;if(o<12)return"unknown";if(r=Oj(n[0],n[1],n[2*Math.floor(1*o/12)],n[2*Math.floor(1*o/12)+1],n[2*Math.floor(2*o/12)],n[2*Math.floor(2*o/12)+1],n[2*Math.floor(3*o/12)],n[2*Math.floor(3*o/12)+1],n[2*Math.floor(4*o/12)],n[2*Math.floor(4*o/12)+1],n[o-2],n[o-1]),r==="none"||e&&r!==e)return"none";e=r}return e}function zw(t){return Ha(t)&&t.type==="expression"}function ch(t,e){return Ha(t)&&t.type==="expression"?!0:t.type==="expression"&&ua(t)}function n0(t){return tK(t)}function jm(t,e){return t.type==="expression"&&pl(t)&&e&&e.branches[0]&&n0(e.branches[0].segments)!=="line"}function o0(t,e){return t.type==="expression"&&pl(t)&&!!t.formula.is_tableable}function AE(t,e){return t.type==="expression"}function dp(t,e){return t.type==="expression"&&pl(t)}function LE(t,e){return t.type==="expression"&&!!t.error&&!ua(t)}function hp(t){return function(e,r){if(e.type!=="expression"||!e.latex)return!1;var i=__dcg_shared_module_exports__['fc'](e.latex);return i.getDependencies().indexOf(t)>=0}}function PE(t){return function(e,r){if(e.type!=="expression"||!e.latex)return!1;var i=__dcg_shared_module_exports__['fc'](e.latex);return i.getExports().indexOf(t)>=0}}function OE(t){return function(e,r){return e.type==="expression"&&e.formula&&e.formula.variables&&e.formula.variables.length>=t}}function rK(t){if(t.type!=="expression"||!t.formula||!t.formula.constant_value)return!1;let e=t.formula.constant_value;return typeof e=="number"&&isFinite(e)}function _E(t,e){return e&&n0(e.branches[0].segments)==="line"&&!rK(t)}function FE(t,e){return _E(t,e)&&$w(t,e)}function RE(t,e){return AE(t,e)&&!FE(t,e)}function Jm(t,e){return e&&e.branches&&e.branches.some(function(r){return n0(r.segments)==="parabola"})}function $w(t,e){return!t||t.type!=="expression"||!t.latex?!1:!!t.latex.match(/\\left\\{(.+)\\right\\}/)}function s0(t,e){if(!Jm(t,e))return!1;var r=e.branches[0].compiled.fn;return r(0)!==0||r(1)!==1}function a0(t,e){return t.type==="expression"&&!!t.formula&&!!t.formula.is_evaluable&&rK(t)}function l0(t,e){return t.type==="expression"&&t.formula.assignment==="y"}function NE(t,e){return t.type==="expression"&&!!t.sliderExists&&!pl(t)}function c0(t,e){return t.type==="expression"&&!!t.sliderExists&&t.slider.isPlaying}function d0(t,e){return t.type==="expression"&&!!t.sliderExists&&!pl(t)&&Ns(t)!==1}function xu(t,e){return t.type==="table"}function BE(t,e){return t.type==="expression"&&!!t.formula&&!!t.formula.regression}function Ww(t,e){if(t.type!=="table")return!1;for(var r=1;r<t.columnModels.length;r++)if(t.columnModels[r].discrete)return!0;return!1}function h0(t,e){if(t.type!=="table")return!1;for(var r=1;r<t.columnModels.length;r++)if(t.columnModels[r].discrete===!1)return!0;return!1}var KE=class{constructor(e,r){this.color="#000000",this.showHighlight=!1,this.selected=!1,this.id=e,this.branches=r!==void 0?r:[]}updateFrom(e){e&&(this.showHighlight=e.showHighlight,this.selected=e.selected)}};var ss=class{constructor(e){this.Calc=e,this.controller=this.Calc.controller}expressionsVisible(){return this.controller.isListVisible()}requireExpressionsVisible(){return{position:"e",content:this.controller.s("graphing-tours-label-require-expressions-visible"),sel:I(".dcg-show-expressions-tab"),delayBeforeEnter:400,delayBeforeExit:400}}resourcesOpen(){return I("body").hasClass("resources-open")}requireResourcesNotOpen(){return{position:"e",content:this.controller.s("graphing-tours-label-require-resources-not-open"),sel:I(".dcg-action-opendrawer"),delayBeforeEnter:400,delayBeforeExit:400}}editListMode(){return this.controller.isInEditListMode()}requireNotEditListMode(){return{position:"s",content:this.controller.s("graphing-tours-label-require-not-edit-list-mode"),sel:I(".dcg-action-toggle-edit")}}expressionCount(){return this.controller.getItemCount()}getExpSketch(e){var r=this.Calc.grapher.graphSketches[e.id];if(r instanceof KE)throw new Error("Unimplemented: tours cannot work with 3d sketches");return r}getAvailableExp(e){var r=this.getMatchingExpSelector(ch,e);return r||".dcg-new-math-div"}expList(){return I(this.Calc.rootElt).find(".dcg-exppanel")}getSelectorById(e){if(e)return this.controller.getItemSelectorById(e)}getModelById(e){if(e)return this.controller.getItemModel(e)}expMatches(e,r){if(!e)return!1;if(typeof r=="function")return r.call(xc,e,this.getExpSketch(e));for(var i=0;i<r.length;i++)if(!r[i].call(xc,e,this.getExpSketch(e)))return!1;return!0}getMatchingExpId(e,r){var i={},n,o,s=this.controller.getAllItemModels();for(n=0;n<s.length;n++)o=s[n],FC(o)==="render"&&(i[o.id]=!0);for(var a in r)delete i[a];var l=this.controller.getSelectedItem();if(l&&i[l.id]&&this.expMatches(l,e))return l.id;for(n=0;n<s.length;n++)if(o=s[n],i[o.id]&&this.expMatches(o,e))return o.id}getMatchingExpSelector(e,r){var i=this.getMatchingExpId(e,r);return i?this.getSelectorById(i):void 0}getMatchingExpModel(e,r){var i=this.getMatchingExpId(e,r);return i?this.getModelById(i):void 0}};var UE=class extends ss{shouldPopup(){return!!this.getMatchingExpSelector(NE)}update(){if(this.resourcesOpen())return this.requireResourcesNotOpen();if(!this.expressionsVisible())return this.requireExpressionsVisible();if(this.editListMode())return this.requireNotEditListMode();var e=this.getMatchingExpSelector(dp),r=this.getMatchingExpSelector(NE),i=this.getMatchingExpSelector(c0),n=this.getMatchingExpSelector(d0);if(e&&i)return{type:"final",position:"s",endingMsg:this.controller.s("graphing-tours-label-sliders-pro"),sel:i.find(".dcg-circular-icon")};if(e&&n)return n.find(".dcg-depressed").length?{type:"do-not-update"}:{position:"s",content:"<b>"+this.controller.s("graphing-tours-label-sliders-hands-free")+"</b><br>"+this.controller.s("graphing-tours-label-sliders-press-play"),sel:n.find(".dcg-circular-icon")};if(e&&r){var o=r.find(".dcg-thumb .dcg-graphic");return o.length===1?{position:"s",content:this.controller.s("graphing-tours-label-sliders-drag-handle"),sel:o}:{position:"e",content:this.controller.s("graphing-tours-label-sliders-change-value"),sel:r}}var s;return this.expressionCount()>1?s=this.getMatchingExpSelector(OE(1)):s=this.getMatchingExpSelector(OE(2)),s?{position:"s",content:"<b>"+this.controller.s("graphing-tours-label-awesome")+"</b> "+this.controller.s("graphing-tours-label-sliders-add"),sel:s.find(".dcg-slider-btn-container:last .dcg-btn-blue")}:(s=this.getMatchingExpSelector(ch),s?{position:"e",content:"<b>"+this.controller.s("graphing-tours-label-sliders-make-sliders")+"</b><br>"+this.controller.s("graphing-tours-label-sliders-try-typing",{sample_expression:'<span class="trip-math">y=mx+b</span>'}),sel:s,delayBeforeExit:600}:{position:"e",content:this.controller.s("graphing-tours-label-sliders-blank-expression"),sel:".dcg-action-newmath"})}};Oe();var qE=class extends ss{shouldPopup(){return!!this.getMatchingExpSelector(xu)}update(){if(this.resourcesOpen())return this.requireResourcesNotOpen();if(!this.expressionsVisible())return this.requireExpressionsVisible();if(this.editListMode())return this.requireNotEditListMode();var e=this.getMatchingExpId(Ww),r=this.getSelectorById(e),i=this.getModelById(e),n=i;if(!r||!n||n.type!=="table"){var o=I(".dcg-action-newtable:visible");return o.length===0?{position:"e",content:"<b>"+this.controller.s("graphing-tours-label-tables-start")+"</b><br>"+this.controller.s("graphing-tours-label-new-item"),sel:I(".dcg-add-expression-btn")}:{position:"e",content:this.controller.s("graphing-tours-label-tables-select-table"),sel:o,delayBeforeExit:300}}for(var s=Do(n),a=Us(n),l=0,c=0;c<a&&c<3;c++){var d=r.find(".dcg-row:nth-of-type("+(c+2)+") .dcg-cell:nth-of-type(1)"),u=r.find(".dcg-row:nth-of-type("+(c+2)+") .dcg-cell:nth-of-type(2)");d.is(":not(.dcg-empty, .dcg-error)")&&u.is(":not(.dcg-empty, .dcg-error)")&&l++}if(l===3){var p=n.columnModels[1].points&&n.columnModels[1].lines,g=I(".dcg-table-column-menu").length>0;return p&&!g?{type:"final",position:"e",endingMsg:this.controller.s("graphing-tours-label-tables-whiz"),sel:r}:p?{position:"e",content:this.controller.s("graphing-tours-label-tables-close-options"),sel:r}:g?{content:this.controller.s("graphing-tours-label-tables-dots"),position:"e",sel:".dcg-toggle-switch:eq(1)"}:{content:["<b>"+this.controller.s("graphing-tours-label-tables-last-trick")+"</b><br>",this.controller.s("graphing-tours-label-tables-open-options")].join(""),position:"e",sel:r.find(".dcg-row:nth-of-type(1) .dcg-cell:nth-of-type(2) .dcg-circular-icon")}}var b,x,w;for(b=0;b<a;b++)for(x=0;x<2;x++)if(w=r.find(".dcg-row:nth-of-type("+(b+2)+") .dcg-cell:nth-of-type("+(x+1)+")"),w.is(".dcg-error"))return{position:"e",content:this.controller.s("graphing-tours-label-tables-valid-number"),sel:w};if(!s)return{position:"e",content:this.controller.s("graphing-tours-label-tables-back"),sel:r.find(".dcg-row:nth-of-type("+b+") .dcg-cell:nth-of-type(2)")};if(a===2&&l===1&&s&&s.row===1)return{position:"e",content:this.controller.s("graphing-tours-label-tables-next-row"),sel:r.find(".dcg-row:nth-of-type("+(s.row+1)+") .dcg-cell:nth-of-type(2)")};if(a===3&&l===2&&s&&s.row!==3)return{position:"e",content:"<b>"+this.controller.s("graphing-tours-label-awesome")+"</b><br>"+this.controller.s("graphing-tours-label-tables-enter"),sel:r.find(".dcg-row:nth-of-type("+(s.row+1)+") .dcg-cell:nth-of-type(2)")};for(b=0;b<a;b++)for(x=0;x<2;x++)if(w=r.find(".dcg-row:nth-of-type("+(b+2)+") .dcg-cell:nth-of-type("+(x+1)+")"),w.is(".dcg-empty")){var E=this.controller.s("graphing-tours-label-tables-fill-row");return b===2&&x===1&&(E=this.controller.s("graphing-tours-label-tables-fill-another")),b===0&&x===1&&(E="<b>"+this.controller.s("graphing-tours-label-tables-fill-cell")+"</b><br>"+this.controller.s("graphing-tours-label-tables-type-number")),{position:"e",content:E,sel:r.find(".dcg-row:nth-of-type("+(b+2)+") .dcg-cell:nth-of-type(2)")}}return{type:"do-not-update"}}};Oe();var HE=class extends ss{shouldPopup(){return!!this.getMatchingExpSelector(xu)}update(){if(this.resourcesOpen())return this.requireResourcesNotOpen();if(!this.expressionsVisible())return this.requireExpressionsVisible();var e=this.getMatchingExpId(h0),r=this.getSelectorById(e),i=this.getModelById(e),n=this.getMatchingExpSelector(ch),o=this.getMatchingExpSelector([jm,o0]);if(r&&i&&i.type==="table"){var s=i,a=s.columnModels[1].points,l=I(".dcg-table-column-menu").length>0,c=s.columnModels.length>3&&s.columnModels[2].discrete===!1,d=Do(s);return c?{type:"final",position:"e",endingMsg:this.controller.s("graphing-tours-label-advanced-tables-wizard"),sel:r}:d&&d.row===0&&d.column===2?{position:"e",content:this.controller.s("graphing-tours-label-advanced-tables-type-function",{sample_expression:'<span class="trip-math">cos\\left(x\\right)</span>'}),sel:r.find("tr:nth-of-type(1) .dcg-cell:nth-of-type(3)")}:d&&(d.row!==0||d.column!==2)?{position:"e",content:this.controller.s("graphing-tours-label-advanced-tables-new-column"),sel:r.find("tr:nth-of-type(1) .dcg-cell:nth-of-type(3)")}:a&&!d?{position:"e",content:this.controller.s("graphing-tours-label-advanced-tables-continue"),sel:r.find("tr:nth-of-type(1) .dcg-cell:nth-of-type(2)")}:l?{content:this.controller.s("graphing-tours-label-advanced-tables-dots"),position:"e",sel:".dcg-table-points"}:{content:this.controller.s("graphing-tours-label-advanced-tables-options"),position:"e",sel:r.find("tr:nth-of-type(1) .dcg-cell:nth-of-type(2) .dcg-circular-icon")}}return o?this.editListMode()?{position:"e",content:this.controller.s("graphing-tours-label-advanced-tables-create"),sel:".dcg-action-createtable",delayBeforeExit:400}:{position:"s",content:"<b>"+this.controller.s("graphing-tours-label-advanced-tables-convert")+"</b><br>"+this.controller.s("graphing-tours-label-advanced-tables-edit-list"),sel:".dcg-action-toggle-edit"}:n?{position:"e",content:["<b>"+this.controller.s("graphing-tours-label-advanced-tables-graph")+"</b><br>",this.controller.s("graphing-tours-label-advanced-tables-type-function",{sample_expression:'<span class="trip-math">y=sin\\left(x\\right)</span>'})].join(""),sel:n}:{position:"e",content:this.controller.s("graphing-tours-label-advanced-tables-start"),sel:".dcg-new-math-div"}}};var zE=class extends ss{shouldPopup(){return!!this.getMatchingExpSelector($w)}restrictedLineTour(){if(this.resourcesOpen())return this.requireResourcesNotOpen();if(!this.expressionsVisible())return this.requireExpressionsVisible();var r=this.getMatchingExpSelector(FE),i=this.getMatchingExpSelector(RE);if(r)return i?(this.completedPhase1=!0,this.update()):{position:"e",content:"<b>"+this.controller.s("graphing-tours-label-brilliant")+"</b><br>"+this.controller.s("graphing-tours-label-restrictions-new-expression"),sel:".dcg-new-math-div"};var n=this.getMatchingExpId(ch),o=this.getSelectorById(n),s=this.getModelById(n);if(o&&s){var a=this.expMatches(s,_E),l=this.expMatches(s,LE);return l?{type:"do-not-update"}:a?{position:"e",content:["<b>"+this.controller.s("graphing-tours-label-awesome")+"</b><br>",this.controller.s("graphing-tours-label-restrictions-domain",{sample_expression:'<span class="trip-math">\\left\\{x<0\\right\\}</span>'}),"<br><i>"+this.controller.s("graphing-tours-label-restrictions-abc",{buttons:"{ }"})+"</i>"].join(""),sel:o}:{position:"e",content:["<b>"+this.controller.s("graphing-tours-label-restrictions-start")+"</b><br>",this.controller.s("graphing-tours-label-restrictions-straight-line",{sample_expression:'<span class="trip-math">y=2x</span>'})].join(""),sel:o}}return{position:"e",content:this.controller.s("graphing-tours-label-restrictions-blank-expression"),sel:".dcg-new-math-div"}}restrictedParabolaTour(){if(this.resourcesOpen())return this.requireResourcesNotOpen();if(!this.expressionsVisible())return this.requireExpressionsVisible();var r=this.getMatchingExpSelector([$w,Jm]);if(r)return{type:"final",position:"e",endingMsg:this.controller.s("graphing-tours-label-restrictions-star"),sel:".dcg-exppanel-container"};var i=this.getMatchingExpId([RE,zw]),n=this.getSelectorById(i),o=this.getModelById(i);if(n&&o){var s=this.expMatches(o,[Jm,l0]),a=this.expMatches(o,s0),l=this.expMatches(o,Jm),c=this.expMatches(o,LE);return c?{type:"do-not-update"}:l?s?a?{position:"e",content:["<b>"+this.controller.s("graphing-tours-label-nice")+"</b><br>"+this.controller.s("graphing-tours-label-restrictions-range",{sample_expression:'<span class="trip-math">\\left\\{y<4\\right\\}</span>'})].join(""),sel:n}:{position:"e",content:["<b>"+this.controller.s("graphing-tours-label-restrictions-move-parabola")+"</b><br>",this.controller.s("graphing-tours-label-restrictions-change-equation",{sample_expression:'<span class="trip-math">y=x^2-2</span>'})].join(""),sel:n}:{position:"e",content:["<b>"+this.controller.s("graphing-tours-label-restrictions-dont-forget")+"</b><br>",this.controller.s("graphing-tours-label-restrictions-type-all",{sample_expression:'<span class="trip-math">y=x^2</span>'})].join(""),sel:n}:{position:"e",content:[this.controller.s("graphing-tours-label-restrictions-graph-parabola",{sample_expression:'<span class="trip-math">y=x^2</span>'})+"<br><i>"+this.controller.s("graphing-tours-label-restrictions-typing-hint",{suggestion1:"y=x^2",suggestion2:'<span class="trip-math">a^2</span>'})+"</i>"].join(""),sel:n}}return{position:"e",content:this.controller.s("graphing-tours-label-restrictions-blank-expression"),sel:".dcg-new-math-div"}}update(){return this.completedPhase1?this.restrictedParabolaTour():this.restrictedLineTour()}};Oe();var $E=class extends ss{constructor(){super(...arguments);this.hasCreatedLinearRegression=!1;this.hasInitiallyRenderedSampleDataLink=!1}shouldPopup(){return!!this.getMatchingExpSelector(xu)}update(){if(this.resourcesOpen())return this.requireResourcesNotOpen();if(!this.expressionsVisible())return this.requireExpressionsVisible();if(this.editListMode())return this.requireNotEditListMode();var r=this.getMatchingExpId(BE)||this.getMatchingExpId(AE),i=this.getSelectorById(r),n=this.getModelById(r),o=this.getMatchingExpId(Ww),s=this.getSelectorById(o),a=this.getModelById(o);if(!s||!a||a.type!=="table"||!a.columnModels[1]){var l=I(".dcg-action-newtable:visible"),c=!La&&!al;return l.length===0&&c?this.hasInitiallyRenderedSampleDataLink?{type:"do-not-update"}:(this.hasInitiallyRenderedSampleDataLink=!0,{position:"e",content:'<div class="trip-title">'+this.controller.s("graphing-tours-label-regressions-data")+"</div>"+this.controller.s("graphing-tours-label-regressions-docs",{sample_data_link:'<a class="trip-link" target="_blank" href="https://docs.google.com/spreadsheets/d/1h4kYwWka_1PvI5G-hPYz_QBe1FrYLo9Gb1XvxJz-QYE/edit#gid=0">'+this.controller.s("graphing-tours-label-regressions-sample-data")+"</a>"})+' <div class="trip-hint"><br>'+this.controller.s("graphing-tours-label-regressions-own-data",{plus_icon:'<i class="dcg-icon-plus" aria-hidden="true"></i>'})+"</div>",sel:i||I(".dcg-exppanel")}):l.length===0?{position:"e",content:'<div class="trip-title">'+this.controller.s("graphing-tours-label-regressions-data-2")+"</div>"+this.controller.s("graphing-tours-label-new-item"),sel:I(".dcg-add-expression-btn"),delayBeforeExit:150}:{position:"e",content:this.controller.s("graphing-tours-label-regressions-new-table"),sel:l,delayBeforeExit:250}}var d=s.find(".dcg-row .dcg-cell:nth-of-type(2):not(.dcg-table-header):not(.dcg-empty)");if(d.length<5)return{position:"e",content:'<div class="trip-title">'+this.controller.s("graphing-tours-label-regressions-fill-sample-data")+"</div><table class='dcg-regression-tour-table'><tr><td><span class='trip-math'>x_1</span></td><td><span class='trip-math'>y_1</span></td></tr><tr><td>1</td><td>0.8</td></tr><tr><td>2</td><td>2.7</td></tr><tr><td>3</td><td>3.9</td></tr><tr><td>4</td><td>4.6</td></tr><tr><td>5</td><td>5</td></tr></table>",sel:s.find(".dcg-row:nth-of-type(2) .dcg-cell:nth-of-type(2)")};var u=this.getMatchingExpModel(BE)||this.getMatchingExpModel(zw)||this.controller.getItemModelByIndex(0);if(!u||u.type!=="expression"){var p=I(".dcg-action-newexpression:visible");return p.length===0?{position:"e",content:'<div class="trip-title">'+this.controller.s("graphing-tours-label-awesome")+"</div>"+this.controller.s("graphing-tours-label-new-item"),sel:I(".dcg-add-expression-btn"),delayBeforeExit:150}:{position:"e",content:this.controller.s("graphing-tours-label-regressions-expression-option"),sel:p,delayBeforeExit:150}}var g=n&&n.type==="expression"&&n.formula,b=g?g.regression:void 0,x=b?b.statistics:void 0,w=b?b.parameters:void 0;if(x&&x.r&&(this.hasCreatedLinearRegression=!0),!this.hasCreatedLinearRegression&&i)return{position:"e",content:this.controller.s("graphing-tours-label-regressions-equation",{equation:"<span class='trip-math'>y_1\\sim mx_1+b</span>"})+"<div class='trip-hint'>"+this.controller.s("graphing-tours-label-regressions-hint-1",{y_1:"<span class='trip-math'>y_1</span>",y1:"<span class='trip-math'>y1</span>"})+"</div><div class='trip-hint'>"+this.controller.s("graphing-tours-label-regressions-hint-2",{twiddle:"<span class='trip-math'>~</span>"})+"</div>",sel:i,delayBeforeExit:150};var E=I(".dcg-residual-suggestion");return E.length?{position:"e",content:"<div class='trip-title'>"+this.controller.s("graphing-tours-label-regressions-check-model")+"</div>"+this.controller.s("graphing-tours-label-regressions-residuals"),sel:E,delayBeforeExit:250}:x&&(x.Rsquared>=.99||x.r>=.99||w&&w.a&&w.k&&w.h)?{type:"final",position:"e",endingMsg:"<div class='trip-title'>"+this.controller.s("graphing-tours-label-regressions-keep-exploring")+"</div>",sel:I(".dcg-exppanel")}:i?{position:"e",content:"<div class='trip-title'>"+this.controller.s("graphing-tours-label-regressions-new-model")+"</div>"+this.controller.s("graphing-tours-label-regressions-better-fit",{equation:"<span class='trip-math'>y_1~a(x_1-h)^2+b</span>"}),sel:i,delayBeforeExit:300}:{type:"do-not-update"}}};function WE(t){return function(e,r){if(e.type!=="expression"||!e.latex)return!1;var i=__dcg_shared_module_exports__['fc'](e.latex);if(!i._expression||i._expression.type!=="List"&&i._expression.type!=="Range"||t.dependent&&t.dependent!==so(e))return!1;var n=i.getConcreteTree();return!(t.minLength&&(n.length===void 0||n.length<t.minLength))}}var iK=WE({}),nK=WE({dependent:"a",minLength:3}),oK=WE({dependent:"b",minLength:5}),sK=WE({dependent:"c",minLength:10});function aK(t,e){return dp(t,e)&&hp("a")(t,e)}function lK(t,e){return dp(t,e)&&hp("b")(t,e)}function cK(t,e){return hp("c")(t,e)&&a0(t,e)}var jE=class extends ss{shouldPopup(){return!!this.getMatchingExpSelector(iK)}update(){if(this.resourcesOpen())return this.requireResourcesNotOpen();if(!this.expressionsVisible())return this.requireExpressionsVisible();if(this.editListMode())return this.requireNotEditListMode();var e=this.getMatchingExpId(nK),r=this.getMatchingExpId(oK),i=this.getMatchingExpId(sK),n=this.getMatchingExpId(aK),o=this.getMatchingExpId(lK),s=this.getMatchingExpSelector(cK);return e?n?r?i?o?s?{type:"final",position:"e",endingMsg:this.controller.s("graphing-tours-label-great-job"),sel:s.find(".dcg-evaluation"),scrollContainer:this.expList()}:{position:"e",content:"<b>"+this.controller.s("graphing-tours-label-last-thing")+"</b> "+this.controller.s("graphing-tours-label-list-computation",{equation:"<span class='trip-math'>total\\left(c\\right)</span>"})+"<div class='trip-hint'>",sel:this.getAvailableExp([e,r,n,i,o]),scrollContainer:this.expList(),delayBeforeExit:600}:{position:"e",content:"<b>"+this.controller.s("graphing-tours-label-lists-graph-points")+"</b> "+this.controller.s("graphing-tours-label-lists-point-equation",{equation:"<span class='trip-math'>\\left(b, sin\\left(b\\right)\\right)</span>"})+"<div class='trip-hint'>"+this.controller.s("graphing-tours-label-lists-hint-plot-points")+"</div>",sel:this.getAvailableExp([e,r,n,i]),scrollContainer:this.expList()}:{position:"e",content:this.controller.s("graphing-tours-label-lists-count-by",{equation:"<span class='trip-math'>c=\\left[10, 15, ..., 95\\right]</span>"}),sel:this.getAvailableExp([e,r,n]),scrollContainer:this.expList(),delayBeforeExit:600}:{position:"e",content:"<b>"+this.controller.s("graphing-tours-label-awesome")+"</b> "+this.controller.s("graphing-tours-label-lists-create-range",{equation:"<span class='trip-math'>b=\\left[0...8\\right]</span>"}),sel:this.getAvailableExp([e,n]),scrollContainer:this.expList(),delayBeforeExit:600}:{position:"e",content:"<b>"+this.controller.s("graphing-tours-label-lists-put-to-work")+"</b> "+this.controller.s("graphing-tours-label-lists-graph-equation",{equation:"<span class='trip-math'>y=x^2+a</span>"})+"<div class='trip-hint'>"+this.controller.s("graphing-tours-label-lists-hint-superscript",{suggestion1:"y=x^2+a",suggestion2:"a<sup>2</sup>"})+"</div>",sel:this.getAvailableExp([e]),scrollContainer:this.expList()}:{position:"e",content:"<b>"+this.controller.s("graphing-tours-label-lists-are-powerful")+"</b><br>"+this.controller.s("graphing-tours-label-lists-begin-equation",{equation:"<span class='trip-math'>a=\\left[1,2,3\\right]</span>"})+"<div class='trip-hint'>"+this.controller.s("graphing-tours-label-lists-hint-abc"),sel:this.getAvailableExp(),scrollContainer:this.expList(),delayBeforeExit:600}}};Oe();var dK=function(t,e){return t.type=="folder"},Rj=function(t,e){return t.type==="expression"&&pl(t)&&!t.folderId},JE=class extends ss{shouldPopup(){return!!this.getMatchingExpSelector(dK)}update(){if(this.resourcesOpen())return this.requireResourcesNotOpen();if(!this.expressionsVisible())return this.requireExpressionsVisible();if(this.editListMode())return this.requireNotEditListMode();var r=this.getMatchingExpId(dK),i=this.getSelectorById(r),n=this.getModelById(r),o=this.getMatchingExpSelector(Rj);if(!n||n.type!=="folder"||!i){var s=I(".dcg-action-newfolder:visible");return s.length===0?{position:"e",content:"<b>"+this.controller.s("graphing-tours-label-folders-start")+"</b><br>"+this.controller.s("graphing-tours-label-new-item"),sel:I(".dcg-add-expression-btn")}:{position:"e",content:this.controller.s("graphing-tours-label-folders-option"),sel:s}}return this.cachedTitle!==n.title&&(this.cachedTitle=n.title,this.lastChange=new Date().getSeconds()),!this.cachedTitle||new Date().getSeconds()-this.lastChange<1e3?{position:"e",content:this.controller.s("graphing-tours-label-folders-name"),sel:i}:n.controller.getNumberOfItemsInFolder(n.id)===0?o?{position:"e",content:this.controller.s("graphing-tours-label-folders-grab")+"<div class='trip-hint'>"+this.controller.s("graphing-tours-label-folders-indicator")+"</div>",scrollContainer:this.expList(),sel:o}:{position:"e",content:"<b>"+this.controller.s("graphing-tours-label-awesome")+"</b> "+this.controller.s("graphing-tours-label-folders-new-equation",{equation:"<span class='trip-math'>x+y=3</span>"}),scrollContainer:this.expList(),sel:this.getAvailableExp(),delayBeforeExit:500}:n.collapsed?n.hidden?{type:"final",position:"e",endingMsg:this.controller.s("graphing-tours-label-great-job"),sel:".dcg-exppanel-container",scrollContainer:this.expList()}:{position:"s",content:"<b>"+this.controller.s("graphing-tours-label-folders-did-you-know")+"</b>"+this.controller.s("graphing-tours-label-folders-hide"),scrollContainer:this.expList(),sel:i.find(".dcg-circular-icon")}:{position:"e",content:"<b>"+this.controller.s("graphing-tours-label-folders-great-start")+"</b> "+this.controller.s("graphing-tours-label-folders-collapse"),scrollContainer:this.expList(),sel:i.find(".dcg-caret-container")}}};var hK=function(t,e){return t.type==="expression"&&t.latex.indexOf("\\frac{d}{dx}")>=0};function pK(t,e){return!(!PE("f")(t,e)||!jm(t,e))}function uK(t,e){return!PE("g")(t,e)||!hp("f")(t,e)||!dp(t,e)?!1:hK(t,e)}function gK(t,e){return!jm(t,e)||hp("f")(t,e)?!1:hK(t,e)}var YE=class extends ss{shouldPopup(){return!1}update(){if(this.resourcesOpen())return this.requireResourcesNotOpen();if(!this.expressionsVisible())return this.requireExpressionsVisible();if(this.editListMode())return this.requireNotEditListMode();var e=this.getMatchingExpId(pK),r=this.getMatchingExpId(uK),i=this.getMatchingExpSelector(gK);return e?r?i?{type:"final",position:"e",endingMsg:this.controller.s("graphing-tours-label-great-job"),sel:i,scrollContainer:this.expList()}:{position:"e",content:this.controller.s("graphing-tours-label-derivative-one-more",{equation:"<span class='trip-math'>\\frac{d}{dx}\\ln \\left(x\\right)</span>"}),sel:this.getAvailableExp([e,r]),scrollContainer:this.expList()}:{position:"e",content:this.controller.s("graphing-tours-label-derivative-graph-derivative",{equation:"<span class='trip-math'>g\\left(x\\right)=\\frac{d}{dx}f\\left(x\\right)</span>"})+"<div class='trip-hint'>"+this.controller.s("graphing-tours-label-derivative-hint-type-derivative")+"</div>",sel:this.getAvailableExp([e]),scrollContainer:this.expList()}:{position:"e",content:"<b>"+this.controller.s("graphing-tours-label-derivative-start-graph")+"</b><br>"+this.controller.s("graphing-tours-label-derivative-start-function",{equation:"<span class='trip-math'>f\\left(x\\right)=x\\sin \\left(x\\right)</span>"}),sel:this.getAvailableExp(),scrollContainer:this.expList()}}};var dh={sliders:{tour:UE,titleKey:"graphing-tours-heading-sliders"},tables:{tour:qE,titleKey:"graphing-tours-heading-tables"},restrictions:{tour:zE,titleKey:"graphing-tours-heading-restrictions"},functiontable:{tour:HE,hideInHelp:!0,titleKey:"graphing-tours-heading-advanced-tables"},regressions:{tour:$E,titleKey:"graphing-tours-heading-regressions"},lists:{tour:jE,titleKey:"graphing-tours-heading-lists",hideInHelp:!0},folders:{tour:JE,titleKey:"graphing-tours-heading-folders",hideInHelp:!0},derivatives:{tour:YE,titleKey:"graphing-tours-heading-derivatives",hideInHelp:!0}};var as=__dcg_shared_module_exports__['i'](Z());var{For:Bj,If:Kj}=as.Components,p0=class extends as.Class{init(){this.controller=this.props.controller(),this.tourController=this.controller.tourController}template(){return as.createElement("a",{class:as.const("dcg-feature"),href:()=>`/calculator?tour=${this.props.name()}`,target:as.const("_blank"),ignoreRealClick:()=>!this.tourController.shouldPopupTour(this.props.name()),onTap:e=>{if(!this.tourController.shouldPopupTour(this.props.name()))return e.originalEvent.preventDefault(),this.controller.dispatch({type:"toggle-menu",payload:"none"}),this.controller.tourController.startTour(this.props.name(),"help")}},as.createElement("span",{class:()=>`dcg-thumb dcg-${this.props.name()}`}),()=>this.controller.s(this.props.titleKey()))}},XE=class extends as.Class{template(){return as.createElement(Bj,{each:()=>__dcg_shared_module_exports__['C'](dh)},as.createElement("div",{class:as.const("dcg-popover-content dcg-tours-content"),role:as.const("group"),"aria-label":as.const("Tours")},e=>as.createElement(Kj,{predicate:()=>!dh[e].hideInHelp},()=>as.createElement(p0,{name:()=>e,titleKey:()=>dh[e]?dh[e].titleKey:"",controller:this.props.controller}))))}};var Yr=__dcg_shared_module_exports__['i'](Z());var Ym=class extends Yr.Class{template(){return Yr.createElement("a",{href:()=>this.props.href(),target:Yr.const("_blank"),class:Yr.const("dcg-resource-link")},Yr.createElement("i",{class:()=>this.props.icon(),"aria-hidden":Yr.const("true")}),Yr.createElement("span",null,()=>this.props.title(),Yr.const(" ")))}},QE=class extends Yr.Class{init(){this.controller=this.props.controller()}template(){return Yr.createElement("div",{class:Yr.const("dcg-popover-content dcg-resources-content"),role:Yr.const("group"),"aria-label":Yr.const("Resources")},Yr.createElement(Ym,{href:Yr.const("https://help.desmos.com/hc/en-us/articles/4406040715149-Getting-Started-Desmos-Graphing-Calculator"),icon:Yr.const("dcg-icon-rocket"),title:()=>this.controller.s("account-shell-link-getting-started")}),Yr.createElement(Ym,{href:Yr.const("https://www.youtube.com/playlist?list=PLfM6zMGnbgOGLZc-_Yj3QVK3Vz_L4Cw59"),icon:Yr.const("dcg-icon-film"),title:()=>this.controller.s("account-shell-link-video-tutorials")}),Yr.createElement(Ym,{href:()=>{let e=this.controller.languageController.getLanguage();return Ra[e]?Ra[e].userGuideURL:Ra.en.userGuideURL},icon:Yr.const("dcg-icon-book"),title:()=>this.controller.s("account-shell-link-user-guide")}),Yr.createElement(Ym,{href:Yr.const("https://help.desmos.com/"),icon:Yr.const("dcg-icon-comments"),title:()=>this.controller.s("account-shell-link-help-center")}),Yr.createElement("div",{class:Yr.const("dcg-resource-link dcg-action-show-hotkeys"),role:Yr.const("link"),tabindex:Yr.const(0),onTap:e=>this.controller.dispatch({type:"show-modal",modal:"hotkeys",device:e.device})},Yr.createElement("i",{class:Yr.const("dcg-icon-keyboard"),"aria-hidden":Yr.const("true")}),Yr.createElement("span",null,()=>this.controller.s("account-shell-link-keyboard-shortcuts"))))}};var go=__dcg_shared_module_exports__['i'](Z());var mK=["i18nKey","title","thumbURL","stateURL","hash","parentHash","recovery","recoveryParentHash","graphData","access","created","example","draft","easterEgg"],Lo=class extends Lr{constructor(r){super();r&&mK.forEach(i=>{r.hasOwnProperty(i)&&this.setProperty(i,r[i])}),this.access&&this.setProperty("access","all"),this.example||this.setProperty("example",!1),this.draft||this.setProperty("draft",!1),this.now=new Date}copy(){return new Lo(this)}getCollectionKey(){var r="";return this.example?r="example-":this.draft&&(r="draft-"),r+this.hash}displayDate(){var r=Date.now(),i=(r-this.created.getTime())/1e3,n=i/60,o=n/60,s=o/24,a=s/7,l=[__dcg_shared_module_exports__['Qa']("account-shell-label-month-jan"),__dcg_shared_module_exports__['Qa']("account-shell-label-month-feb"),__dcg_shared_module_exports__['Qa']("account-shell-label-month-mar"),__dcg_shared_module_exports__['Qa']("account-shell-label-month-apr"),__dcg_shared_module_exports__['Qa']("account-shell-label-month-may"),__dcg_shared_module_exports__['Qa']("account-shell-label-month-jun"),__dcg_shared_module_exports__['Qa']("account-shell-label-month-jul"),__dcg_shared_module_exports__['Qa']("account-shell-label-month-aug"),__dcg_shared_module_exports__['Qa']("account-shell-label-month-sep"),__dcg_shared_module_exports__['Qa']("account-shell-label-month-oct"),__dcg_shared_module_exports__['Qa']("account-shell-label-month-nov"),__dcg_shared_module_exports__['Qa']("account-shell-label-month-dec")];return a>=5?__dcg_shared_module_exports__['Qa']("account-shell-label-created-on-date",{month:l[this.created.getMonth()],day:this.created.getDate(),year:this.created.getFullYear()}):a>=2?__dcg_shared_module_exports__['Qa']("account-shell-label-created-weeks-ago",{number:String(Math.floor(a))}):s>=7?__dcg_shared_module_exports__['Qa']("account-shell-label-created-last-week"):s>=2?__dcg_shared_module_exports__['Qa']("account-shell-label-created-days-ago",{number:String(Math.floor(s))}):o>=24?__dcg_shared_module_exports__['Qa']("account-shell-label-created-yesterday"):o>=2?__dcg_shared_module_exports__['Qa']("account-shell-label-created-hours-ago",{number:String(Math.floor(o))}):n>=60?__dcg_shared_module_exports__['Qa']("account-shell-label-created-one-hour-ago"):n>=2?__dcg_shared_module_exports__['Qa']("account-shell-label-created-minutes-ago",{number:String(Math.floor(n))}):n>=1?__dcg_shared_module_exports__['Qa']("account-shell-label-created-one-minute-ago"):__dcg_shared_module_exports__['Qa']("account-shell-label-created-seconds-ago")}plainObject(){var r={};return mK.forEach(i=>{r[i]=this[i]}),r}getURL(){var r;if(window.location.protocol==="file:"){var i="/calculator";if(!Kf())return i;r=Kf()+i}else{var n="/"+document.location.pathname.split("/")[1];r=window.location.href.split(n)[0]+n}return r+(this.hash&&!this.recovery?"/"+this.hash:"")}static fromAjax(r){return new Lo({i18nKey:r.i18nKey,title:r.title,thumbURL:r.thumbUrl,stateURL:r.stateUrl,graphData:r.state,hash:r.hash,parentHash:r.parent_hash,recoveryParentHash:r.recovery_parent_hash,access:r.access,created:new Date(r.created),example:!!r.example,draft:!!r.draft,easterEgg:r.easterEgg})}static toAjax(r){return{title:r.title,thumbUrl:r.thumbURL,stateUrl:r.stateURL,state:r.graphData,hash:r.hash,parent_hash:r.parentHash,recovery_parent_hash:r.recoveryParentHash,access:r.access,created:r.created.toString()}}static updateFromSync(r,i){r.setProperty("title",i.title),r.setProperty("hash",i.hash),r.setProperty("parentHash",i.parent_hash),r.setProperty("recoveryParentHash",i.recovery_parent_hash),r.setProperty("graphData",r.graphData),r.setProperty("thumbURL",i.thumbUrl),r.setProperty("stateURL",i.stateUrl),r.setProperty("created",new Date(i.created))}};function ZE(t,e){if(!e.hasOwnProperty("myGraphs"))throw new Error("Argument Error: saveGraph options must specify myGraphs");if(!e.hasOwnProperty("isUpdate"))throw new Error("Argument Error: saveGraph options must specify isUpdate");let r={parent_hash:t.parentHash,recovery_parent_hash:t.recoveryParentHash,thumb_data:t.thumbURL,graph_hash:t.hash,my_graphs:e.myGraphs,is_update:e.isUpdate,recovery:e.recovery,title:t.title||void 0,calc_state:t.graphData,lang:e.lang,product:e.product};return Bn("/api/v1/calculator/save",r).then(i=>(Lo.updateFromSync(t,i),t))}function fK(t){return Bn("/api/v1/calculator/email_feedback",t)}function yK(t){return aa("/api/v1/calculator/my_graphs",t)}function bK(t){return aa("/api/v1/calculator/recovery_graphs",t)}function wK(t){return Bn("/api/v1/calculator/my_graphs/remove",t)}function xK(){return Bn("/api/v1/calculator/recovery_graphs/clear")}var Ft=__dcg_shared_module_exports__['i'](Z());Oe();function u0(t){if(t.status===0)return[{message:"Connection failed. Check your internet connection?"}];try{let e=JSON.parse(t.responseText).errors;return __dcg_shared_module_exports__['Tb'](e),e}catch(e){}return[{message:"Unexpected server error. Try again, or e-mail calculator@desmos.com."}]}function ek(t){return u0(t).map(e=>e.message)}var{If:tk,For:Uj,Input:qj,Textarea:Hj}=Ft.Components,rk=class extends Ft.Class{init(){this.controller=this.props.controller(),this.userController=this.controller.userController,this.formErrors=[],this.feedbackInProgress=!1,this.feedbackFromName=this.userController.getEmail(),this.didSendFeedbackEmail=!1}template(){return Ft.createElement("div",{class:Ft.const("dcg-suggestions")},Ft.createElement("div",{class:Ft.const("template-errors")},Ft.createElement(tk,{predicate:()=>!!this.formErrors.length},()=>Ft.createElement(Uj,{each:()=>this.formErrors},Ft.createElement("span",null,e=>Ft.createElement("div",{class:Ft.const("errors")},Ft.createElement("span",null,()=>e)))))),Ft.createElement("form",{didMount:this.bindFn(this.didMountContactForm),class:Ft.const("dcg-action-submit")},Ft.createElement("div",{class:Ft.const("dcg-feedback-message-label")},()=>this.controller.s("account-shell-label-feedback-message")),Ft.createElement(Hj,{placeholder:()=>this.controller.s("account-shell-label-feedback-placeholder"),didMount:this.bindFn(this.didMountTextArea),disabled:()=>!this.shouldAllowSubmission(),class:Ft.const("dcg-shared-input-blue-outline"),name:Ft.const("message"),value:()=>this.controller.getFeedbackMessage(),onInput:e=>{if(this.controller.setFeedbackMessage(e),!this.unmounted)return this.update()}}),Ft.createElement("div",{class:Ft.const("dcg-suggestions-expansion")},Ft.createElement("div",{class:Ft.const("dcg-feedback-email-label")},()=>this.controller.s("account-shell-label-feedback-email")),Ft.createElement(qj,{name:Ft.const("anonymous-email"),class:Ft.const("dcg-anonymous-email dcg-shared-input-blue-outline"),placeholder:()=>this.controller.s("account-shell-label-email-placeholder"),disabled:()=>!this.shouldAllowSubmission(),type:Ft.const("email"),value:()=>this.feedbackFromName,onInput:e=>{if(this.feedbackFromName=e,!this.unmounted)return this.update()}}),Ft.createElement("div",{class:Ft.const("dcg-feedback-action-container")},Ft.createElement(tk,{predicate:()=>this.feedbackInProgress},()=>Ft.createElement("div",{class:Ft.const("dcg-template-processing")},Ft.createElement("span",{class:Ft.const("dcg-spinner")}),()=>this.controller.s("account-shell-label-feedback-sending"))),Ft.createElement(tk,{predicate:()=>this.didSendFeedbackEmail},()=>Ft.createElement("div",{class:Ft.const("dcg-template-sent")},Ft.createElement("i",{class:Ft.const("dcg-icon-check"),"aria-hidden":Ft.const("true")}),()=>this.controller.s("account-shell-text-feedback-sent"))),Ft.createElement(tk,{predicate:this.bindFn(this.shouldAllowSubmission)},()=>Ft.createElement("span",{class:Ft.const("dcg-feedback-btns")},Ft.createElement("a",{role:Ft.const("link"),tabindex:Ft.const("0"),class:Ft.const("dcg-action-closesuggestion"),onTap:this.bindFn(this.onCancel)},()=>this.controller.s("account-shell-button-cancel")),Ft.createElement("button",{class:Ft.const("dcg-shared-btn-blue"),name:Ft.const("submit"),type:Ft.const("submit")},()=>this.controller.s("account-shell-button-contact-us"))))))))}didMountContactForm(e){return I(e).on("submit",r=>(r.preventDefault(),this.submitForm()))}didMountTextArea(e){this.unmounted||e.focus()}didUnmount(){this.unmounted=!0}shouldAllowSubmission(){return!this.feedbackInProgress&&!this.didSendFeedbackEmail}onCancel(){this.controller.setFeedbackMessage(""),this.controller.dispatch({type:"show-contact-form",showForm:!1})}submitForm(){this.didSendFeedbackEmail=!1,this.feedbackInProgress=!0,this.formErrors=[];let e=I.trim(I('textarea[name="message"]').val());if(e.length||(this.formErrors=[this.controller.s("account-shell-error-feedback-empty")]),this.formErrors.length){this.feedbackInProgress=!1,this.unmounted||this.update();return}let r={message:e,state:JSON.stringify(this.controller.api.getState()),userAgent:navigator.userAgent,"anonymous-email":I('input[name="anonymous-email"]').val()};fK(r).done(()=>{this.didSendFeedbackEmail=!0,this.controller.setFeedbackMessage(""),this.feedbackFromName=this.userController.getEmail(),setTimeout(()=>{this.didSendFeedbackEmail=!1,this.unmounted||this.update()},2e3)}).fail(i=>{this.formErrors=ek(i).map(n=>this.controller.raw(n))}).always(()=>{this.feedbackInProgress=!1,this.unmounted||this.update()}),this.unmounted||this.update()}};var{IfElse:zj}=go.Components,ik=class extends go.Class{handleClick(){this.props.controller().dispatch({type:"show-contact-form",showForm:!0})}template(){return go.createElement("div",{class:go.const("dcg-popover-content dcg-hide-on-mobile"),role:go.const("group"),"aria-label":go.const("Feedback")},zj(()=>this.props.controller().requestedContactForm(),{true:()=>go.createElement("div",{class:go.const("dcg-resources-content dcg-feedback-content")},go.createElement(rk,{controller:this.props.controller})),false:()=>go.createElement("div",{class:go.const("dcg-contact-us")},go.createElement("a",{class:go.const("dcg-contact-link"),onTap:this.bindFn(this.handleClick)},go.createElement("i",{class:go.const("dcg-icon-mail"),"aria-hidden":go.const("true")}),go.createElement("span",null,()=>this.props.controller().s("account-shell-link-email-support"))))}))}};var nk=class extends ka.Class{init(){this.controller=this.props.controller()}template(){return ka.createElement(Gl,{title:()=>this.controller.s("account-shell-heading-tours"),type:()=>"help",label:()=>this.controller.s("account-shell-label-help-menu"),controller:this.props.controller},ka.createElement(XE,{controller:this.props.controller}),ka.createElement("div",{class:ka.const("dcg-popover-title"),"aria-hidden":ka.const("true")},()=>this.controller.s("account-shell-heading-resources")),ka.createElement(QE,{controller:this.props.controller}),ka.createElement("div",{class:ka.const("dcg-popover-title dcg-interior-title dcg-hide-on-mobile"),"aria-hidden":ka.const("true")},()=>this.controller.s("account-shell-heading-contact-us")),ka.createElement(ik,{controller:this.props.controller}))}};var Qe=__dcg_shared_module_exports__['i'](Z());Oe();var An=__dcg_shared_module_exports__['i'](Z());Oe();var{Input:$j,Switch:Wj}=An.Components,ok=class extends An.Class{constructor(){super(...arguments),this.unmounted=!1}didUnmount(){this.unmounted=!0}template(){return An.createElement("div",{class:An.const("dcg-selectable-input-container")},An.createElement($j,{class:this.const("dcg-permalink select-all dcg-variable-permalink"),"aria-label":()=>this.props.controller().s("graphing-calculator-narration-share-graph-link"),name:()=>this.props.controller().s("graphing-calculator-text-share-graph-link"),value:this.props.link,didMount:e=>{this.inputEl=e,al||this.inputEl.focus()},onTap:()=>this.inputEl.select(),onInput:()=>{}}),An.createElement("div",{role:An.const("button"),tabindex:An.const(0),class:An.const("dcg-copy-button"),onTap:this.bindFn(this.copyLink)},An.createElement(Wj,{key:()=>this.copyStatus},e=>e=="success"?An.createElement("span",{"aria-label":()=>this.props.controller().s("graphing-calculator-narration-share-graph-link-copied")},An.createElement("i",{class:An.const("dcg-icon-check"),"aria-hidden":An.const("true")})):e=="error"?An.createElement("span",{"aria-label":()=>this.props.controller().s("graphing-calculator-narration-share-graph-link-unable-to-copy")},An.createElement("i",{class:An.const("dcg-icon-error"),"aria-hidden":An.const("true")})):An.createElement("span",{class:An.const("dcg-copy-text")},()=>this.props.controller().s("graphing-calculator-button-share-graph-link-copy")))))}copyLink(){if(this.inputEl){I(this.inputEl).trigger("focus").trigger("select"),this.copyStatus="success";try{document.execCommand("copy")}catch(e){this.copyStatus="error"}this.unmounted||(this.update(),clearTimeout(this.copyStatusTimeout),this.copyStatusTimeout=setTimeout(()=>{this.copyStatus=null,!this.unmounted&&this.update()},2500))}}};function CK(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){let e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}Oe();var jj=50,sk=class{constructor(e,r){this.apiUrl=e;this.staticData=r;this.throttledFlushBatchedLogs=__dcg_shared_module_exports__['A'](()=>{if(this.requestInFlight||this.batchedLogs.length==0)return;let e=this.batchedLogs.splice(0,jj);this.requestInFlight=!0,I.ajax({url:this.apiUrl,type:"POST",contentType:"application/json",data:JSON.stringify({events:e})}).always(()=>{this.requestInFlight=!1,this.throttledFlushBatchedLogs()})},1e3,{leading:!1});this.batchedLogs=[],this.requestInFlight=!1}log(e){this.batchedLogs.push(__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['b']({},this.staticData),e)),this.throttledFlushBatchedLogs()}};var Jj={eventType:"eventType",pageLoadId:window.pageLoadId||CK(),source:"browser",app:"knox",userAgent:navigator.userAgent};var Yj=new sk("/data-events",Jj);function Xj(t){Yj.log(__dcg_shared_module_exports__['b']({url:document.location.href},t))}function Mi(t,e){Xj({eventType:t,payloadJSON:JSON.stringify(e)})}var{If:Xm,Textarea:Qj}=Qe.Components,ak=class extends Qe.Class{init(){this.controller=this.props.controller(),this.graphsController=this.controller.graphsController,this.graph=null,this.shareInProgress=!0,this.didSharingFail=!1,Mi("user-action::open-share-dropdown",{})}template(){return Qe.createElement(Gl,{title:()=>this.controller.s("account-shell-heading-share-graph"),type:Qe.const("share"),label:()=>this.controller.s("account-shell-narration-share-options"),controller:this.props.controller},Qe.createElement("div",{class:Qe.const("dcg-popover-content")},Qe.createElement(Xm,{predicate:()=>this.shareInProgress},()=>Qe.createElement("div",{class:Qe.const("dcg-loading")},Qe.createElement("span",{class:Qe.const("dcg-spinner")}),()=>this.controller.s("account-shell-label-loading"))),Qe.createElement(Xm,{predicate:()=>this.didSharingFail},()=>Qe.createElement("div",{class:Qe.const("dcg-failed")},Qe.createElement("span",{"aria-live":Qe.const("assertive"),"aria-atomic":Qe.const(!0)},()=>this.controller.s("account-shell-error-sharing-link")+" "),Qe.createElement("span",{role:Qe.const("button"),tabindex:Qe.const("0"),class:Qe.const("dcg-action-retry"),onTap:()=>(this.controller.dispatch({type:"toggle-menu",payload:"none"}),this.controller.dispatch({type:"toggle-menu",payload:"share"}))},()=>this.controller.s("account-shell-button-retry-now")),()=>` ${this.controller.s("account-shell-text-or")} `,Qe.createElement("span",{role:Qe.const("button"),tabindex:Qe.const("0"),class:Qe.const("dcg-action-close"),onTap:()=>this.controller.dispatch({type:"toggle-menu",payload:"share"})},()=>this.controller.s("account-shell-button-cancel")),Qe.const("."))),Qe.createElement(Xm,{predicate:()=>!this.shareInProgress&&!this.didSharingFail},()=>Qe.createElement("div",{class:Qe.const("dcg-loaded"),didMount:this.bindFn(this.didMountLoaded)},()=>this.controller.s("account-shell-label-share-link"),Qe.createElement(ok,{controller:this.props.controller,link:()=>this.getGraphPath()}),Qe.createElement(Xm,{predicate:()=>!this.controller.shouldDisablePrintAndExport()},()=>Qe.createElement("div",{class:Qe.const("dcg-share-actions")},Qe.createElement("span",{class:Qe.const("dcg-print-link"),onTap:this.bindFn(this.print),tabindex:Qe.const("0"),role:Qe.const("link")},Qe.createElement("i",{class:Qe.const("dcg-icon-print"),"aria-hidden":Qe.const("true")}),Qe.createElement("span",null,()=>this.controller.s("account-shell-button-print"))),Qe.createElement("span",{class:Qe.const("dcg-export-image-link"),onTap:this.bindFn(this.exportImage),tabindex:Qe.const("0"),role:Qe.const("link")},Qe.createElement("i",{class:Qe.const("dcg-icon-export"),"aria-hidden":Qe.const("true")}),Qe.createElement("span",null,()=>this.controller.s("account-shell-button-export-image"))),Qe.createElement("span",{class:()=>({"dcg-embed-link":!0,"dcg-selected":this.embedVisible}),onTap:this.bindFn(this.toggleEmbedVisible),tabindex:Qe.const("0"),role:Qe.const("button"),"aria-pressed":()=>this.embedVisible},Qe.createElement("i",{class:Qe.const("dcg-icon-embed"),"aria-hidden":Qe.const("true")}),Qe.createElement("span",null,()=>this.controller.s("account-shell-button-embed"))))),Qe.createElement(Xm,{predicate:()=>this.embedVisible},()=>Qe.createElement("div",{class:Qe.const("dcg-embed-div share-div"),didMount:this.bindFn(this.didMountTextarea)},Qe.createElement(Qj,{rows:Qe.const("6"),class:Qe.const("select-all first-input dcg-variable-htmlembedcode"),value:()=>this.getGraphEmbedCode(),onInput:()=>{}}))),Qe.createElement(Xm,{predicate:()=>this.controller.shouldShowArtContestNudge()},()=>Qe.createElement("div",{class:Qe.const("dcg-art-contest-container")},Qe.createElement("span",{class:Qe.const("dcg-trophy-icon")},Qe.const("\u{1F3C6}")),Qe.createElement(un,{i18n:this.const(this.controller),key:this.const("account-shell-text-share-submit-to-contest")},Qe.createElement("span",{class:Qe.const("dcg-contest-submit-message")},Qe.const("Submit this graph to the"),Qe.const(" "),Qe.createElement("span",{class:Qe.const("dcg-bold-text")},Qe.const("Global Math Art Contest!")))),Qe.createElement("div",{class:Qe.const("dcg-enter-btn"),role:Qe.const("button"),tabindex:Qe.const("0"),onTap:e=>(this.controller.state.artContestURLFromShareMenu=this.getGraphPath(),this.controller.dispatch({type:"show-modal",modal:"contest-submission",device:e.device}))},()=>this.controller.s("account-shell-button-submit"))))))))}didMountTextarea(e){I(e).find("textarea").trigger("focus").trigger("select")}toggleEmbedVisible(){this.embedVisible=!this.embedVisible,this.unmounted||this.update()}didMountLoaded(){this.embedVisible=!1}print(){window.print()}exportImage(e){this.controller.dispatch({type:"show-modal",modal:"export-image",device:e.device})}getGraphPath(){return this.graph!=null?this.graph.getURL():void 0}getGraphEmbedCode(){return this.graph?`<iframe src="${`${this.getGraphPath()}?embed`}" width="500" height="500" style="border: 1px solid #ccc" frameborder=0></iframe>`:""}didUnmount(){this.unmounted=!0}didMount(){return this.graphsController.shareGraph().done(e=>{this.graph=e}).fail(()=>{this.didSharingFail=!0}).always(()=>{this.shareInProgress=!1,this.unmounted||this.update()})}};var eo=__dcg_shared_module_exports__['i'](Z());var{If:Zj}=eo.Components,Qm=class extends eo.Class{init(){this.controller=this.props.controller(),this.userController=this.controller.userController}template(){return eo.createElement(Zj,{predicate:()=>this.userController.isLoggedIn()},()=>eo.createElement(Gl,{type:()=>"account",label:()=>this.controller.s("account-shell-label-account-information"),left:this.props.left,arrowLeft:this.props.arrowLeft,controller:this.props.controller},eo.createElement("div",{class:eo.const("user-info")},eo.createElement("span",{class:eo.const("account-name")},()=>this.userController.getFullName()),eo.createElement("span",{class:eo.const("account-email")},()=>this.userController.getEmail()),eo.createElement("a",{class:eo.const("dcg-action-accountsettings"),role:eo.const("link"),tabindex:eo.const(0),onTap:e=>this.controller.dispatch({type:"show-modal",modal:"account-settings",device:e.device})},()=>this.controller.s("account-shell-link-account-settings"))),eo.createElement("a",{class:eo.const("dcg-action-logout"),role:eo.const("link"),tabindex:eo.const(0),onTap:()=>this.logout()},()=>this.controller.s("account-shell-link-sign-out"))))}logout(){this.controller.dispatch({type:"toggle-menu",payload:"none"}),this.userController.logout()}};var Jw=__dcg_shared_module_exports__['i'](Z());var hr=__dcg_shared_module_exports__['i'](Z());var jw=__dcg_shared_module_exports__['i'](Z());Oe();var{If:B1e}=jw.Components;var{For:DK,If:lk,IfDefined:eJ,Switch:tJ}=hr.Components,ck=class extends hr.Class{template(){return hr.createElement(DK,{each:this.props.options,key:e=>`${e.key?e.key:e.title()}${e.disabled?"-disabled":""}`},hr.createElement("div",{role:hr.const("list"),class:()=>({"dcg-shared-options-dropdown":!0,[this.props.class===void 0?"":this.props.class()]:this.props.class!==void 0})},e=>hr.createElement("div",{role:hr.const("listitem"),class:hr.const("dropdown-option-container")},hr.createElement(tJ,{key:()=>e},r=>"href"in r?hr.createElement("a",{"aria-disabled":()=>r.disabled,class:()=>({[r.class||""]:!!r.class,"dropdown-choice":!0,"dropdown-choice-disabled":r.disabled}),onTap:()=>!r.disabled&&this.props.onTap(r),href:()=>r.href,target:()=>r.target!==void 0?r.target:"",rel:()=>r.noreferrer?"noreferrer noopener":""},hr.createElement(lk,{predicate:()=>r.icon!=null},()=>hr.createElement("div",{class:hr.const("option-icon-container")},hr.createElement("i",{"aria-hidden":hr.const("true"),class:()=>`${r.icon} option-icon`}))),r.title):hr.createElement("div",{role:hr.const("link"),tabindex:hr.const(0),"aria-disabled":()=>r.disabled,class:()=>({[r.class||""]:!!r.class,"dropdown-choice":!0,"dropdown-choice-disabled":r.disabled}),onTap:()=>!r.disabled&&this.props.onTap(r)},hr.createElement(lk,{predicate:()=>r.icon!=null},()=>hr.createElement("div",{class:hr.const("option-icon-container")},hr.createElement("i",{"aria-hidden":hr.const("true"),class:()=>`${r.icon} option-icon`}))),hr.createElement("span",{class:hr.const("option-title")},r.title),eJ(()=>r.subtitle&&r.subtitle(),i=>hr.createElement("span",{class:hr.const("option-subtitle")},i)))),hr.createElement(lk,{predicate:()=>!!e.explanations},()=>hr.createElement(DK,{each:()=>e.explanations||[],key:r=>r.flag},hr.createElement("div",{class:hr.const("dropdown-explanations")},r=>hr.createElement("div",{class:hr.const("explanation")},()=>r.explanation,hr.const(" "),hr.createElement(lk,{predicate:()=>!!r.link},()=>hr.createElement("a",{class:hr.const("learn-more"),href:()=>r.link!==void 0?r.link:"",target:hr.const("_blank")},()=>r.linkText?r.linkText:Yo("shared-button-learn-more-capitalized"))))))))))}};Oe();var rJ=28,iJ=10,g0=4,dk=class extends Jw.Class{template(){return Jw.createElement(Gl,{type:this.const("graph-actions"),label:()=>this.props.controller().s("account-shell-label-graph-actions"),controller:this.props.controller,left:()=>this.left,arrowLeft:()=>this.arrowLeft},Jw.createElement(ck,{class:this.const("dcg-graph-actions-list"),options:this.bindFn(this.getOptions),onTap:this.bindFn(this.tapOption)}))}didMount(){var o,s,a,l;let e=I(".dcg-graph-actions-dropdown-anchor"),r=((s=(o=e.offset())==null?void 0:o.left)!=null?s:0)+((a=e.width())!=null?a:0)/2,n=((l=I(".dcg-graph-actions-container").width())!=null?l:0)-rJ/2-iJ;r<=n+g0?(this.left=`${g0}px`,this.arrowLeft=`${r-g0}px`):(this.left=`${r-n}px`,this.arrowLeft=`${n}px`),this.update()}getOptions(){let e=[];return e.push({title:()=>this.props.controller().s("account-shell-button-rename"),icon:"dcg-icon-pencil",class:"blue-link",action:()=>{this.props.controller().dispatch({type:"show-modal",modal:"rename",device:"mouse"})}}),this.props.controller().graphsController.wasCurrentGraphEverSaved()&&e.push({title:()=>this.props.controller().s("account-shell-button-duplicate"),icon:"dcg-icon-duplicate",action:()=>this.props.controller().dispatch({type:"show-modal",modal:"duplicate",device:"mouse"})},{title:()=>this.props.controller().s("account-shell-button-delete"),icon:"dcg-icon-remove",class:"red-link",action:()=>{this.props.controller().dispatch({type:"show-modal",modal:"delete",device:"mouse"})}}),e}tapOption(e){e.action!==void 0&&e.action(),!e.preventClose&&("href"in e?e.isDeepLink&&setTimeout(()=>this.closeMenu()):this.closeMenu())}closeMenu(){this.props.controller().dispatch({type:"toggle-menu",payload:"graph-actions"})}};var{SwitchUnion:nJ}=Qa.Components,hk=class extends Qa.Class{init(){this.controller=this.props.controller()}template(){return Qa.createElement("div",null,Qa.createElement(VE,{controller:this.props.controller}),nJ(()=>this.getMenu(),{language:()=>Qa.createElement(ME,{controller:this.props.controller}),help:()=>Qa.createElement(nk,{controller:this.props.controller}),share:()=>Qa.createElement(ak,{controller:this.props.controller}),account:()=>Qa.createElement(Qm,{controller:this.props.controller}),"graph-actions":()=>Qa.createElement(dk,{controller:this.props.controller}),none:()=>Qa.createElement("span",null)}))}getMenu(){return this.controller.mygraphsController.isMygraphsOpen()?"none":this.controller.getOpenMenu()}};var Ot=__dcg_shared_module_exports__['i'](Z());var di=__dcg_shared_module_exports__['i'](Z());var pk=__dcg_shared_module_exports__['i'](Z()),Vl=class extends pk.Class{template(){return pk.createElement("div",{class:()=>({modal_section:!0,"dcg-hotkeys-dialog":this.props.controller().getOpenModal()==="hotkeys"})},this.children)}};Oe();var{Input:oJ,Checkbox:sJ,If:aJ}=di.Components,Zm=class extends di.Class{init(){this.controller=this.props.controller(),this.graphsController=this.controller.graphsController,this.lastSavedTitle=this.graphsController.getCurrentGraphTitle(),this.controller.getOpenModal()==="duplicate"?this.newSaveTitle=this.controller.s("account-shell-text-copy-of-title",{originalTitle:this.lastSavedTitle}):this.newSaveTitle=this.lastSavedTitle||this.graphsController.getUntitledString(),this.controller.state.saveDialog==null&&(this.controller.state.saveDialog={copyOnSave:!0})}template(){return di.createElement(Vl,{controller:this.props.controller},di.createElement("div",{id:di.const("save-dialog")},di.createElement("h1",null,()=>this.getTitle()),di.createElement("div",{class:di.const("dcg-clear")}),di.createElement("form",{didMount:this.bindFn(this.didMountForm)},di.createElement("label",{class:di.const("input-label")},di.createElement("div",{class:di.const("graph-title-title")},()=>this.controller.s("account-shell-label-graph-title"),di.const("\xA0")),di.createElement(oJ,{class:di.const("title-input dcg-input-blue-outline"),name:di.const("title"),placeholder:()=>this.graphsController.getUntitledString(),value:()=>this.newSaveTitle,maxlength:di.const("140"),onInput:e=>this.newSaveTitle=e,didMount:e=>I(e).trigger("focus").trigger("select")})),di.createElement("div",null,di.createElement("button",{type:di.const("submit"),class:di.const("dcg-btn dcg-btn-primary pull-right dcg-action-save")},()=>this.controller.s("account-shell-button-save")),di.createElement(aJ,{predicate:()=>this.shouldShowDuplicateOption()&&this.graphsController.wasCurrentGraphEverSaved()},()=>di.createElement("label",{class:di.const("dcg-new-copy pull-right")},di.createElement(sJ,{checked:()=>this.controller.state.saveDialog.copyOnSave,onChange:e=>{if(this.controller.state.saveDialog.copyOnSave=e,!this.unmounted)return this.update()}}),di.createElement("span",{class:di.const("duplicate-label")},()=>this.getDuplicateLabel())))))))}didUnmount(){this.unmounted=!0}didMountForm(e){I(e).on("submit",r=>{r.preventDefault(),this.newSaveTitle===""&&(this.newSaveTitle="Untitled Graph");let i;this.shouldShowDuplicateOption()?i=this.controller.state.saveDialog.copyOnSave:i=this.controller.getOpenModal()!=="rename",this.controller.dispatch({type:"save-graph",payload:{title:this.newSaveTitle,saveAs:i},device:"mouse"})})}getTitle(){if(this.controller.product==="geometry")return this.controller.s("account-shell-heading-save-construction");switch(this.controller.getOpenModal()){case"rename":return this.controller.s("account-shell-heading-rename-graph");case"save":return this.controller.s("account-shell-heading-save-graph");case"duplicate":return this.controller.s("account-shell-heading-duplicate-graph");default:return""}}getDuplicateLabel(){return this.controller.product==="geometry"?this.controller.s("account-shell-heading-duplicate-construction"):this.controller.s("account-shell-heading-duplicate-graph")}shouldShowDuplicateOption(){if(this.controller.product==="geometry")return!0;let e=this.controller.getModalState();return!!(e.modal==="save"&&e.fromSaveInProgress)}};var we=__dcg_shared_module_exports__['i'](Z());var hi=__dcg_shared_module_exports__['i'](Z());Oe();Oe();var m0=class{constructor(){this.handlers=[],I(document).on("keydown.delegator",e=>this.handleEvent(e))}push(e){let r=__dcg_shared_module_exports__['L']("delegator_");return this.handlers.push({token:r,handler:e}),()=>this.handlers=__dcg_shared_module_exports__['m'](this.handlers,i=>i.token!=r)}handleEvent(e){if(!e.isDefaultPrevented()&&this.handlers.length){let r=!1,i=()=>r=!0;for(let{handler:n}of this.handlers.slice().reverse())if(n(e,i),r)return}}},SK=new m0;Oe();function lJ(t){return t.find(':input:enabled, [tabindex="0"], a[href]').filter(":visible:not([aria-hidden=true]):not([aria-disabled=true])")}function EK(t){return function(r){if(Te(r)==Oa){let i=I(t),n=lJ(i);if(n.length===0)return;let o=n.first(),s=n.last();r.shiftKey&&o.is(":focus")?(r.preventDefault(),s.trigger("focus")):(!r.shiftKey&&s.is(":focus")||document.activeElement&&!n.is(":focus"))&&(r.preventDefault(),o.trigger("focus"))}}}var{If:kK}=hi.Components,Po=class extends hi.Class{init(){this.i18n=this.props.i18n(),this.isMounted=!1}template(){return hi.createElement("div",{class:()=>({"dcg-shared-modal-container":!0,[this.props.class?this.props.class():""]:!!this.props.class}),didMount:this.bindFn(this.didMount),didUnmount:this.bindFn(this.didUnmount)},hi.createElement("div",{class:()=>({"dcg-shared-modal-cover":!0,"dcg-shared-has-close-button":this.showX(),"dcg-shared-modal-fullscreen":this.props.size()==="fullscreen","dcg-shared-modal-wide":this.props.size()==="wide","dcg-shared-modal-medium":this.props.size()==="medium","dcg-shared-modal-narrow":this.props.size()==="narrow"})},hi.createElement("div",{class:hi.const("dcg-shared-modal-background"),onTap:this.props.onClose}),hi.createElement("div",{class:hi.const("dcg-shared-modal-transition-container")},hi.createElement("div",{class:hi.const("dcg-shared-modal"),role:hi.const("dialog"),"aria-label":()=>{let e="";return this.props.ariaLabel?e=this.props.ariaLabel():this.props.title&&(e=this.props.title()),e}},hi.createElement(kK,{predicate:()=>this.showX()},()=>hi.createElement("div",{class:hi.const("dcg-shared-close-cross-container")},hi.createElement(Pe,{tooltip:()=>this.i18n.s("shared-button-close-dialog")},hi.createElement("div",{role:hi.const("link"),tabindex:hi.const("0"),"aria-label":()=>this.i18n.s("shared-button-close-dialog"),class:hi.const("dcg-shared-close-cross"),onTap:this.props.onClose},hi.createElement("i",{class:hi.const("dcg-icon-remove"),"aria-hidden":hi.const("true")}))))),hi.createElement("div",{class:hi.const("dcg-shared-modal-contents-wrapper")},hi.createElement(kK,{predicate:()=>!!this.props.title&&!!this.props.title()},()=>hi.createElement("h1",{class:()=>({"dcg-shared-modal-title":!0,"dcg-shared-left-align-title":this.leftAlignTitle()})},()=>this.props.title())),hi.createElement("div",{class:hi.const("dcg-shared-modal-scrollable-content")},this.children))))))}showX(){return!!this.props.showX&&this.props.showX()}leftAlignTitle(){return!!this.props.leftAlignTitle&&this.props.leftAlignTitle()}didMount(){if(this.isMounted)return;this.isMounted=!0;let e=EK(".dcg-shared-modal-container:visible");this.unsub=SK.push((r,i)=>{Te(r)==jn&&(this.onClose(),i());let n=r.altKey||r.shiftKey||r.metaKey||r.ctrlKey;this.props.onArrowKey&&Te(r)===Rc&&!n&&this.props.onArrowKey("Left"),this.props.onArrowKey&&Te(r)===Nc&&!n&&this.props.onArrowKey("Right"),e(r)})}didUpdate(){!this.handledCloseFocus&&this.showX()&&this.props.focusCloseLink&&this.props.focusCloseLink()&&I(".dcg-shared-modal-container:visible").find(".dcg-shared-close-cross").trigger("focus"),this.handledCloseFocus=!0}onClose(){this.props.onClose&&this.props.onClose()}didUnmount(){this.isMounted&&(this.isMounted=!1,this.unsub())}};Oe();var mo=__dcg_shared_module_exports__['i'](Z());var vu=class extends mo.Class{template(){return mo.createElement("div",{class:mo.const("dcg-shared-cookie-notice")},mo.createElement(un,{key:this.const("shared-message-cookie-notice"),i18n:this.props.i18n},mo.createElement("b",null,mo.const("Note:")),mo.const(" "),mo.const("Desmos uses cookies to enable persistence when you are signed"),mo.const(" "),mo.const("in. If you do not wish to use cookies, please use Desmos without"),mo.const(" "),mo.const("logging in."),mo.const(" "),mo.createElement("a",{class:mo.const("dcg-shared-cookie-notice-learn-more dcg-shared-dark-gray-link"),href:mo.const("/privacy"),target:mo.const("_blank")},mo.const("Learn More."))))}};var Za=__dcg_shared_module_exports__['i'](Z());var{If:cJ,For:dJ}=Za.Components,Oo=class extends Za.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller}template(){return Za.createElement(cJ,{predicate:()=>!!this.props.errors().length},()=>Za.createElement(dJ,{each:this.props.errors},Za.createElement("span",null,e=>Za.createElement("div",{class:Za.const("dcg-shared-account-modal-errors"),role:Za.const("alert")},Za.createElement("span",null,()=>this.i18n.raw(e))))))}};var{If:Yw,Input:uk,Switch:hJ}=we.Components,gk=0,f0=1,mk=class extends we.Class{template(){return we.createElement("span",{class:we.const("dcg-shared-terms-notice")},we.createElement(un,{key:this.const("shared-message-privacy-notice"),i18n:this.props.i18n},we.const("I have read, understand, and accept the"),we.const(" "),we.createElement("a",{href:we.const("/terms"),target:we.const("_blank"),class:we.const("dcg-shared-blue-link")},we.const("Terms of Service")),we.const(" "),we.const("and"),we.const(" "),we.createElement("a",{href:we.const("/privacy"),target:we.const("_blank"),class:we.const("dcg-shared-blue-link")},we.const("Privacy Policy")),we.const(".")))}},fk=class extends we.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.selectedView=gk,this.givenName="",this.familyName="",this.email="",this.password="",this.consentChecked=!1,this.isSubmittingForm=!1,this.formErrors=[],this.breakPoint=660,this.measureWindow(),this.controller.getModalStartingError()&&this.formErrors.push(this.controller.getModalStartingError())}template(){return we.createElement(Po,{title:()=>this.i18n.s("shared-title-signup"),size:this.const("narrow"),showX:this.const(!0),onClose:()=>this.controller.dispatch({type:"close-modal"}),i18n:this.props.controller},we.createElement("div",{class:()=>({"dcg-shared-signup-dialog":!0,"dcg-shared-account-dialog":!0})},we.createElement("div",{class:we.const("dcg-shared-switch-account-message")},()=>this.i18n.s("shared-prompt-already-have-account"),this.const(this.i18n.raw(" ")),we.createElement("a",{role:we.const("link"),tabindex:we.const("0"),class:we.const("dcg-shared-dark-gray-link"),onTap:e=>this.controller.dispatch({type:"show-modal",modal:"login",device:e.device})},()=>this.i18n.s("shared-button-login")),we.const(".")),we.createElement("div",{class:we.const("dcg-shared-navigation-tabs"),role:we.const("tablist")},we.createElement("div",{role:we.const("tab"),tabindex:we.const("0"),"aria-selected":this.bindFn(this.isGoogleSelected),class:()=>({"dcg-shared-tab-gray-underline":!0,"dcg-shared-tab-always-underline":!0,"dcg-shared-profile-view-button":!0,"dcg-selected":this.isGoogleSelected()}),onTap:()=>this.updateView(gk)},this.bindFn(this.externalTitle)),we.createElement("div",{role:we.const("tab"),tabindex:we.const("0"),"aria-selected":this.bindFn(this.isDesmosSelected),class:()=>({"dcg-shared-tab-gray-underline":!0,"dcg-shared-tab-always-underline":!0,"dcg-shared-password-view-button":!0,"dcg-selected":this.isDesmosSelected()}),onTap:()=>this.updateView(f0)},this.bindFn(this.desmosTitle))),we.createElement("div",{class:we.const("dcg-shared-account-content-container")},we.createElement(hJ,{key:()=>this.selectedView},e=>e===gk?we.createElement("div",{class:we.const("dcg-shared-notice-checkbox-google")},we.createElement(Dt,{checked:()=>this.consentChecked,disabled:this.const(!1),onChange:()=>{if(this.consentChecked=!this.consentChecked,!this.unmounted)return this.update()}},this.bindFn(this.consentText)),we.createElement(Dt,{checked:()=>this.privacyChecked,disabled:this.const(!1),onChange:()=>{if(this.privacyChecked=!this.privacyChecked,!this.unmounted)return this.update()}},we.createElement(mk,{i18n:this.const(this.i18n)})),we.createElement(Yw,{predicate:()=>window.googleAuthConnectionFailed},()=>we.createElement("div",{class:we.const("dcg-shared-google-auth-unavailable")},()=>this.i18n.s("shared-message-google-login-not-available"))),we.createElement(Yw,{predicate:()=>!window.googleAuthConnectionFailed},()=>we.createElement("div",{class:()=>({"dcg-shared-btn-gray-outline":!0,"dcg-shared-google-login":!0,"dcg-disabled":this.hasNotConsented()}),role:we.const("button"),tabindex:()=>this.hasNotConsented()?"-1":"0","aria-disabled":this.bindFn(this.hasNotConsented),onTap:()=>this.googleLogin()},we.createElement("div",{class:we.const("dcg-shared-google-icon dcg-shared-external-login-logo")}),we.createElement("span",null,this.bindFn(this.getGoogleLoginText)))),we.createElement(Yw,{predicate:()=>this.controller.allowSignInWithApple()},()=>we.createElement("div",{class:()=>({"dcg-shared-btn-gray-outline":!0,"dcg-shared-apple-login":!0,"dcg-disabled":this.hasNotConsented()}),role:we.const("button"),tabindex:()=>this.hasNotConsented()?"-1":"0","aria-disabled":this.bindFn(this.hasNotConsented),onTap:()=>this.appleLogin()},we.createElement("div",{class:we.const("dcg-shared-apple-icon dcg-shared-external-login-logo")}),we.createElement("span",null,this.bindFn(this.getAppleLoginText))))):e===f0?we.createElement("div",null,we.createElement(Oo,{controller:this.props.controller,errors:()=>this.formErrors}),we.createElement("form",{class:we.const("dcg-shared-action-submit"),onSubmit:this.bindFn(this.onSubmit),didMount:this.bindFn(this.didMountForm)},we.createElement("div",{class:we.const("dcg-shared-email-form-container")},we.createElement("label",null,we.createElement("span",{class:we.const("dcg-shared-input-title")},()=>this.i18n.s("shared-label-email")),we.createElement(uk,{type:we.const("email"),name:we.const("email"),class:we.const("dcg-shared-input-blue-outline"),required:we.const("true"),"aria-describedby":we.const("email-description"),didMount:r=>{Ul||r.focus()},value:()=>this.email,onInput:r=>{if(this.email=r,!this.unmounted)return this.update()}})),we.createElement("div",{class:we.const("dcg-shared-name-container")},we.createElement("div",{class:we.const("dcg-shared-name-input")},we.createElement("label",null,we.createElement("span",{class:we.const("dcg-shared-input-title")},()=>this.i18n.s("shared-label-given-name-or-nickname")),we.createElement(uk,{type:we.const("text"),name:we.const("given-name"),class:we.const("dcg-shared-input-blue-outline"),required:we.const("true"),"aria-describedby":we.const("given-name-description"),value:()=>this.givenName,onInput:r=>{if(this.givenName=r,!this.unmounted)return this.update()}}))),we.createElement("div",{class:we.const("dcg-shared-name-input")},we.createElement("label",null,we.createElement("span",{class:we.const("dcg-shared-input-title")},()=>this.i18n.s("shared-label-family-name")),we.createElement(uk,{type:we.const("text"),name:we.const("family-name"),class:we.const("dcg-shared-input-blue-outline"),"aria-describedby":we.const("family-name-description"),value:()=>this.familyName,onInput:r=>{if(this.familyName=r,!this.unmounted)return this.update()}})))),we.createElement("label",null,we.createElement("span",null,()=>this.i18n.s("shared-label-password")),we.createElement(uk,{type:we.const("password"),class:we.const("dcg-shared-input-blue-outline"),name:we.const("password"),required:we.const("true"),value:()=>this.password,onInput:r=>{if(this.password=r,!this.unmounted)return this.update()}})),we.createElement("div",{class:we.const("dcg-shared-notice-checkbox-email")},we.createElement(Dt,{checked:()=>this.consentChecked,disabled:this.const(!1),onChange:()=>{if(this.consentChecked=!this.consentChecked,!this.unmounted)return this.update()}},this.bindFn(this.consentText))),we.createElement(Dt,{checked:()=>this.privacyChecked,disabled:this.const(!1),onChange:()=>{if(this.privacyChecked=!this.privacyChecked,!this.unmounted)return this.update()}},we.createElement(mk,{i18n:this.const(this.i18n)})),we.createElement("div",{class:we.const("dcg-shared-sign-in-options")},we.createElement(Yw,{predicate:()=>this.isSubmittingForm},()=>we.createElement("div",{class:we.const("dcg-shared-progress-indicator dcg-shared-create-account-progress")},we.createElement("div",{class:we.const("dcg-shared-spinner")}))),we.createElement(Yw,{predicate:()=>!this.isSubmittingForm},()=>we.createElement("div",{class:we.const("dcg-shared-submit-container")},we.createElement("button",{type:we.const("submit"),class:()=>({"dcg-shared-btn-blue":!0,"dcg-disabled":!this.submitEnabled()}),"aria-disabled":()=>!this.submitEnabled(),tabindex:()=>this.submitEnabled()?"0":"-1"},()=>this.i18n.s("shared-button-create-account")))))))):we.createElement("span",null)),we.createElement(vu,{i18n:this.const(this.i18n)}))))}canSwitchRoles(){return!this.controller.getLimitedSignupRole()}didMountForm(e){this.$form=I(e)}submitEnabled(){if(!this.consentChecked||!this.privacyChecked||!this.$form)return!1;let e=this.$form.find('[name="password"]').val(),r=this.$form.find('[name="email"]').val(),i=this.$form.find('[name="given-name"]').val();return!!(e&&r&&i)}onSubmit(e){e.preventDefault(),this.submitEnabled()&&this.submitForm()}googleLogin(){this.controller.dispatch({type:"close-modal"}),this.controller.userController.googleLogin({fromUI:"create"})}appleLogin(){this.controller.dispatch({type:"close-modal"}),this.controller.userController.appleLogin({fromUI:"create"})}getGoogleLoginText(){return this.consentChecked&&this.privacyChecked?this.i18n.s("shared-prompt-sign-up-with-google"):this.i18n.s("shared-prompt-please-consent-to-sign-up-with-google")}getAppleLoginText(){return this.consentChecked&&this.privacyChecked?this.i18n.s("shared-prompt-sign-up-with-apple"):this.i18n.s("shared-prompt-please-consent-to-sign-up-with-apple")}submitForm(){this.formErrors=[],this.isSubmittingForm=!0,this.unmounted||this.update(),this.controller.userController.createAccount({userProvidedName:{given:this.givenName,family:this.familyName.length?this.familyName:void 0},email:this.email,password:this.password,teacher:!1,lang:this.controller.getLanguage()}).done(()=>{if(!this.unmounted)return this.controller.dispatch({type:"close-modal"})}).fail(e=>{this.formErrors=this.controller.parseJSONErrors(e)}).always(()=>{this.isSubmittingForm=!1,this.unmounted||this.update()})}updateView(e){this.selectedView=e,this.unmounted||this.update()}externalTitle(){return this.controller.allowSignInWithApple()?this.windowWidth>this.breakPoint?this.i18n.s("shared-button-external-account-wide"):this.i18n.s("shared-button-external-account-narrow"):this.windowWidth>this.breakPoint?this.i18n.s("shared-button-google-account-wide"):this.i18n.s("shared-button-google-account-narrow")}desmosTitle(){return this.windowWidth>this.breakPoint?this.i18n.s("shared-button-email-address-wide"):this.i18n.s("shared-button-email-address-narrow")}measureWindow(){return this.windowWidth=I(window).width()}didMount(){I(window).on("resize.create-account",__dcg_shared_module_exports__['A'](()=>{this.measureWindow(),this.update()},200))}didUnmount(){I(window).off("resize.create-account"),this.unmounted=!0}consentText(){return this.i18n.s("shared-message-consent-text")}isGoogleSelected(){return this.selectedView===gk}isDesmosSelected(){return this.selectedView===f0}hasNotConsented(){return!this.consentChecked||!this.privacyChecked}};var He=__dcg_shared_module_exports__['i'](Z());var{If:Xw,Input:GK,IfElse:pJ}=He.Components,yk=class extends He.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.email="",this.password="",this.isSubmittingForm=!1,this.formErrors=[],this.controller.getModalStartingError()&&this.formErrors.push(this.controller.getModalStartingError())}template(){return He.createElement(Po,{title:()=>this.i18n.s("shared-title-login"),size:this.const("narrow"),showX:this.const(!0),onClose:()=>this.controller.dispatch({type:"close-modal"}),i18n:this.props.controller},He.createElement("div",{class:He.const("dcg-shared-login-dialog dcg-shared-account-dialog")},pJ(()=>this.canChooseRole(),{true:()=>He.createElement("div",{class:He.const("dcg-shared-switch-account-message")},He.createElement(un,{key:this.const("shared-prompt-new-to-desmos-teacher-or-student"),i18n:this.props.controller},He.const("New to Desmos?"),He.const(" "),He.createElement("a",{role:He.const("link"),tabindex:He.const("0"),class:He.const("dcg-shared-dark-gray-link"),onTap:e=>this.controller.dispatch({type:"show-modal",modal:"signup",device:e.device})},He.const("Sign up!")))),false:()=>He.createElement("div",{class:He.const("dcg-shared-switch-account-message")},He.createElement(un,{key:this.const("shared-prompt-new-to-desmos-sign-up-here"),i18n:this.props.controller},He.const("New to Desmos?"),He.const(" "),He.createElement("a",{role:He.const("link"),tabindex:He.const("0"),class:He.const("dcg-shared-dark-gray-link"),onTap:e=>this.controller.dispatch({type:"show-modal",modal:"signup",device:e.device})},He.const("Sign up")),He.const(".")))}),He.createElement("div",{class:He.const("dcg-shared-account-content-container")},He.createElement(Xw,{predicate:()=>window.googleAuthConnectionFailed},()=>He.createElement("div",{class:He.const("dcg-shared-google-auth-unavailable")},()=>this.i18n.s("shared-message-google-login-not-available"))),He.createElement(Xw,{predicate:()=>!window.googleAuthConnectionFailed},()=>He.createElement("div",{class:He.const("dcg-shared-btn-gray-outline dcg-shared-google-login"),role:He.const("button"),tabindex:He.const("0"),onTap:()=>this.googleLogin()},He.createElement("div",{class:He.const("dcg-shared-google-icon dcg-shared-external-login-logo")}),He.createElement("span",null,()=>this.i18n.s("shared-button-sign-in-with-google")))),He.createElement(Xw,{predicate:()=>this.controller.allowSignInWithApple()},()=>He.createElement("div",{class:He.const("dcg-shared-btn-gray-outline dcg-shared-apple-login"),role:He.const("button"),tabindex:He.const("0"),onTap:()=>this.appleLogin()},He.createElement("div",{class:He.const("dcg-shared-apple-icon dcg-shared-external-login-logo")}),He.createElement("span",null,()=>this.i18n.s("shared-button-sign-in-with-apple"))))),He.createElement("div",{class:He.const("dcg-shared-bg-line")},He.createElement("span",null,()=>this.i18n.s("shared-message-or-login-with-desmos"))),He.createElement(Oo,{controller:this.props.controller,errors:()=>this.formErrors}),He.createElement("form",{class:He.const("dcg-shared-action-submit"),onSubmit:this.bindFn(this.onSubmit)},He.createElement("div",{class:He.const("dcg-shared-email-form-container")},He.createElement("label",null,He.createElement("span",{class:He.const("dcg-shared-input-title")},()=>this.i18n.s("shared-label-email")),He.createElement(GK,{type:He.const("email"),name:He.const("email"),class:He.const("dcg-shared-input-blue-outline"),"aria-label":()=>this.i18n.s("shared-label-email"),required:He.const("required"),didMount:e=>{Ul||e.focus()},value:()=>this.email,onInput:e=>{this.email=e,this.unmounted||this.update()}})),He.createElement("div",{class:He.const("dcg-shared-password-container")},He.createElement("label",{for:He.const("password")},He.createElement("span",null,()=>this.i18n.s("shared-label-password")),He.createElement(GK,{type:He.const("password"),class:He.const("dcg-shared-input-blue-outline"),"aria-label":()=>this.i18n.s("shared-label-password"),required:He.const("true"),value:()=>this.password,name:this.const("password"),onInput:e=>{if(this.password=e,!this.unmounted)return this.update()}}),He.createElement("span",{class:He.const("dcg-shared-password-recovery-link")},He.createElement("a",{role:He.const("link"),tabindex:He.const(0),class:He.const("dcg-shared-action-password"),onTap:e=>this.controller.dispatch({type:"show-modal",modal:"recover-password",device:e.device})},()=>this.i18n.s("shared-prompt-forgot-your-password"))))),He.createElement("div",{class:He.const("dcg-shared-sign-in-options")},He.createElement(Xw,{predicate:()=>this.isSubmittingForm},()=>He.createElement("div",{class:He.const("dcg-shared-progress-indicator dcg-shared-create-account-progress")},He.createElement("div",{class:He.const("dcg-shared-spinner")}))),He.createElement(Xw,{predicate:()=>!this.isSubmittingForm},()=>He.createElement("div",{class:He.const("dcg-shared-submit-container")},He.createElement("button",{type:He.const("submit"),class:()=>({"dcg-shared-btn-blue":!0,"dcg-disabled":!this.submitEnabled()}),"aria-disabled":()=>!this.submitEnabled(),tabindex:()=>this.submitEnabled()?"0":"-1"},()=>this.i18n.s("shared-button-login-capitalized"))))),He.createElement(vu,{i18n:this.const(this.i18n)})))))}canChooseRole(){return!this.controller.getLimitedSignupRole()}didUnmount(){this.unmounted=!0}onSubmit(e){e.preventDefault(),this.submitForm()}googleLogin(){this.controller.dispatch({type:"close-modal"}),this.controller.userController.googleLogin({fromUI:"login"})}appleLogin(){this.controller.dispatch({type:"close-modal"}),this.controller.userController.appleLogin({fromUI:"login"})}submitEnabled(){return!!(this.email&&this.password)}submitForm(){this.submitEnabled()&&(this.isSubmittingForm=!0,this.formErrors=[],this.controller.userController.checkPendingDeletion({email:this.email,lang:this.controller.getLanguage()}).done(e=>{this._pendingDeletion=e.pendingDeletion}).fail(()=>{this._pendingDeletion=!1}).always(()=>{this.unmounted||(this.unmounted||this.update(),this.controller.userController.desmosLogin({email:this.email,password:this.password,lang:this.controller.getLanguage()}).done(()=>{this.unmounted||(this._pendingDeletion?this.controller.dispatch({type:"show-modal",modal:"account-reenabled",device:"mouse"}):this.controller.dispatch({type:"close-modal"}))}).fail(e=>{this.formErrors=this.controller.parseJSONErrors(e)}).always(()=>{this.unmounted||(this.isSubmittingForm=!1,this.controller.dispatch({type:"render"}))}))}))}};var yr=__dcg_shared_module_exports__['i'](Z());var{If:bk,Input:uJ}=yr.Components,wk=class extends yr.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.email=this.controller.userController.getEmail(),this.formErrors=[],this.isSubmittingForm=!1,this.didSendRecoveryEmail=!1}template(){return yr.createElement(Po,{title:()=>this.i18n.s("shared-title-recover-password"),size:this.const("narrow"),showX:this.const(!0),onClose:()=>this.controller.dispatch({type:"close-modal"}),i18n:this.props.controller},yr.createElement("div",{class:yr.const("dcg-shared-recover-password-dialog dcg-shared-account-dialog")},yr.createElement(Oo,{controller:this.props.controller,errors:()=>this.formErrors}),yr.createElement(bk,{predicate:()=>this.didSendRecoveryEmail},()=>yr.createElement("div",{role:yr.const("alert"),class:yr.const("dcg-shared-account-paragraph")},()=>this.i18n.s("shared-message-check-email-for-password-recovery-link"),yr.const(" "),yr.createElement("a",{href:yr.const("#"),class:yr.const("dcg-shared-blue-link"),onTap:e=>(this.didSendRecoveryEmail=!1,this.controller.dispatch({type:"show-modal",modal:"recover-password",device:e.device}))},()=>this.i18n.s("shared-button-try-again")))),yr.createElement(bk,{predicate:()=>!this.didSendRecoveryEmail},()=>yr.createElement("form",{class:yr.const("dcg-shared-email-form-container"),onSubmit:this.bindFn(this.onSubmit)},yr.createElement("div",{class:yr.const("dcg-shared-account-paragraph")},()=>this.i18n.s("shared-prompt-enter-email-for-password-recovery-link")),yr.createElement("label",null,yr.createElement("span",{class:yr.const("dcg-shared-input-title")},()=>this.i18n.s("shared-label-email")),yr.createElement(uJ,{type:yr.const("email"),name:yr.const("email"),class:yr.const("dcg-shared-input-blue-outline"),"aria-label":()=>this.i18n.s("shared-label-email"),required:yr.const("true"),didMount:e=>{Ul&&e.focus()},value:()=>this.email,onInput:e=>{this.email=e,this.unmounted||this.update()}})),yr.createElement("div",{class:yr.const("dcg-shared-sign-in-options")},yr.createElement(bk,{predicate:()=>this.isSubmittingForm},()=>yr.createElement("div",{class:yr.const("dcg-shared-progress-indicator dcg-shared-create-account-progress")},yr.createElement("div",{class:yr.const("dcg-shared-spinner")}))),yr.createElement(bk,{predicate:()=>!this.isSubmittingForm},()=>yr.createElement("button",{class:()=>({"dcg-shared-btn-blue":!0}),type:yr.const("submit")},()=>this.i18n.s("shared-button-recover-password"))))))))}didUnmount(){this.unmounted=!0}onSubmit(e){e.preventDefault(),this.submitForm()}submitForm(){this.formErrors=[],this.isSubmittingForm=!0,this.controller.userController.recoverPassword({email:this.email,lang:this.controller.getLanguage()}).done(()=>{this.didSendRecoveryEmail=!0}).fail(e=>{this.formErrors=this.controller.parseJSONErrors(e)}).always(()=>{this.isSubmittingForm=!1,this.unmounted||this.update()})}};var Yt=__dcg_shared_module_exports__['i'](Z());Oe();var VK={i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-braille",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-nemeth-mode",standard:"<key>ALT</key> + <key>N</key>",apple:"<key>CTRL</key> + <key>N</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-ueb-mode",standard:"<key>ALT</key> + <key>U</key>",apple:"<key>CTRL</key> + <key>U</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-print-mode",standard:"<key>ALT</key> + <key>Q</key>",apple:"<key>CTRL</key> + <key>Q</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-toggle-braille-typing",standard:"<key>ALT</key> + <key>6</key>",apple:"<key>CTRL</key> + <key>6</key>"}]};var xk=function(t){let e={i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-expression-entry-and-navigation",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-previous-expression",standard:"<key>UP ARROW</key>, <key>SHIFT</key> + <key>Tab</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-next-expression",standard:"<key>DOWN ARROW</key>, <key>Tab</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-remove-empty-expression",standard:"<key>Backspace</key>",apple:"<key>Delete</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-previous-character",standard:"<key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-next-character",standard:"<key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-move-to-numerator",standard:"<key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-move-to-denominator",standard:"<key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-exit-block",standard:"<key>Tab</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-beginning-of-block",standard:"<key>Home</key>",apple:"<key>Fn</key> + <key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-end-of-block",standard:"<key>End</key>",apple:"<key>Fn</key> + <key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-beginning-of-expression",standard:"<key>CTRL</key> + <key>Home</key>",apple:"<key>CTRL</key> + <key>Fn</key> + <key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-end-of-expression",standard:"<key>CTRL</key> + <key>End</key>",apple:"<key>CTRL</key> + <key>Fn</key> + <key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-increase-selection-left",standard:"<key>SHIFT</key> + <key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-increase-selection-right",standard:"<key>SHIFT</key> + <key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-delete-selection",standard:"<key>Backspace</key>",apple:"<key>Delete</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-select-all",standard:"<key>CTRL</key> + <key>A</key>",apple:"<key>COMMAND</key> + <key>A</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-parent-block",standard:"<key>CTRL</key> + <key>ALT</key> + <key>UP ARROW</key>",apple:"<key>CTRL</key> + <key>Option</key> + <key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-focused-block",standard:"<key>CTRL</key> + <key>ALT</key> + <key>DOWN ARROW</key>",apple:"<key>CTRL</key> + <key>Option</key> + <key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-left-adjacent-block",standard:"<key>CTRL</key> + <key>ALT</key> + <key>LEFT ARROW</key>",apple:"<key>CTRL</key> + <key>Option</key> + <key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-right-adjacent-block",standard:"<key>CTRL</key> + <key>ALT</key> + <key>RIGHT ARROW</key>",apple:"<key>CTRL</key> + <key>Option</key> + <key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-selection",standard:"<key>CTRL</key> + <key>ALT</key> + <key>SHIFT</key> + <key>DOWN ARROW</key>",apple:"<key>CTRL</key> + <key>Option</key> + <key>SHIFT</key> + <key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-answer",standard:"<key>CTRL</key> + <key>ALT</key> + <key>=</key>",apple:"<key>CTRL</key> + <key>Option</key> + <key>SHIFT</key> + <key>RIGHT ARROW</key>"}]};return t.decimalToFraction&&e.shortcuts.push({i18nKey:"shared-calculator-text-keyboard-shortcut-show-answer-as-decimal-or-fraction",standard:"<key>ALT</key> + <key>SHIFT</key> + <key>A</key>",apple:"<key>COMMAND</key> + <key>SHIFT</key> + <key>A</key>"}),e};var ud={common:{i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-common-symbols",shortcuts:[{latex:"a^b",standard:"<key>^</key> (<key>SHIFT</key> + <key>6</key>)"},{latex:"a_b",standard:"<key>_</key> (<key>SHIFT</key> + <key>-</key>)"},{latex:"\\le",standard:"<key><</key><key>=</key>"},{latex:"\\ge",standard:"<key>></key><key>=</key>"},{latex:"a'",standard:"<key>'</key>"},{latex:"\\frac{a}{b}",standard:"<key>f</key><key>r</key><key>a</key><key>c</key>"},{latex:"\\sqrt{a}",standard:"<key>s</key><key>q</key><key>r</key><key>t</key>"},{latex:"\\sqrt[3]{a}",standard:"<key>c</key><key>b</key><key>r</key><key>t</key>"},{latex:"\\sqrt[n]{a}",standard:"<key>n</key><key>t</key><key>h</key><key>r</key><key>o</key><key>o</key><key>t</key>"},{latex:"\\sum_{n=a}^b",standard:"<key>s</key><key>u</key><key>m</key>"},{latex:"\\int_a^b",standard:"<key>i</key><key>n</key><key>t</key>"},{latex:"\\prod_{n=a}^b",standard:"<key>p</key><key>r</key><key>o</key><key>d</key>"},{latex:"\\pi",standard:"<key>p</key><key>i</key>"},{latex:"\\theta",standard:"<key>t</key><key>h</key><key>e</key><key>t</key><key>a</key>"},{latex:"\\to",standard:"<key>-</key><key>></key>"}]},tables:{i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-tables",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-table-previous-cell",standard:"<key>SHIFT</key> + <key>TAB</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-table-next-cell",standard:"<key>TAB</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-table-previous-row",standard:"<key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-table-next-row",standard:"<key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-table-previous-column",standard:"<key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-table-next-column",standard:"<key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-table-first-row",standard:"<key>CTRL</key> + <key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-table-last-row",standard:"<key>CTRL</key> + <key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-table-first-column",standard:"<key>CTRL</key> + <key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-table-last-column",standard:"<key>CTRL</key> + <key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-table-speak-column-header",standard:"<key>CTRL</key> + <key>H</key>"}]},sliders:{i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-sliders",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-decrease",standard:"<key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-decrease-larger",standard:"<key>PAGE DOWN</key>",apple:"<key>FN</key> + <key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-increase",standard:"<key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-increase-larger",standard:"<key>PAGE UP</key>",apple:"<key>FN</key> + <key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-minimum",standard:"<key>HOME</key>",apple:"<key>FN</key> + <key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-maximum",standard:"<key>END</key>",apple:"<key>FN</key> + <key>RIGHT ARROW</key>"}]},audiotrace:{i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-audio-tracing",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-toggle-audio-trace",standard:"<key>ALT</key> + <key>T</key>",apple:"<key>OPTION</key> + <key>T</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-summarize-graph",standard:"<key>ALT</key> + <key>S</key>",apple:"<key>OPTION</key> + <key>S</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-describe-axes",standard:"<key>ALT</key> + <key>G</key>",apple:"<key>OPTION</key> + <key>G</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-previous-point",standard:"<key>LEFT ARROW</key>, <key>UP ARROW</key>, <key>J</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-next-point",standard:"<key>RIGHT ARROW</key>, <key>DOWN ARROW</key>, <key>L</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-previous-poi",standard:"<key>PAGE UP</key>, <key>SHIFT</key> + <key>TAB</key>, <key>K</key>",apple:"<key>FN</key> + <key>UP ARROW</key>, <key>SHIFT</key> + <key>TAB</key>, <key>K</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-next-poi",standard:"<key>PAGE DOWN</key>, <key>TAB</key>, <key>I</key>",apple:"<key>FN</key> + <key>DOWN ARROW</key>, <key>TAB</key>, <key>I</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-first-point",standard:"<key>HOME</key>, <key>U</key>",apple:"<key>FN</key> + <key>LEFT ARROW</key>, <key>U</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-last-point",standard:"<key>END</key> <key>N</key>",apple:"<key>FN</key> + <key>RIGHT ARROW</key> <key>N</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-poi-count",standard:"<key>P</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-x",standard:"<key>X</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-y",standard:"<key>Y</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-color",standard:"<key>C</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-branch",standard:"<key>B</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-point-type",standard:"<key>T</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-move-to-origin",standard:"<key>O</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-previous-curve",standard:"<key>ALT</key> + <key>UP ARROW</key>",apple:"<key>OPTION</key> + <key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-next-curve",standard:"<key>ALT</key> + <key>DOWN ARROW</key>",apple:"<key>OPTION</key> + <key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-hear-graph",standard:"<key>H</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-hear-specific-branch",standard:"<key>1</key> - <key>0</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-adjust-playback-speed",standard:"<key>ALT</key> + <key>1</key> - <key>5</key>",apple:"<key>OPTION</key> + <key>1</key> - <key>5</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-increase-volume",standard:"<key>V</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-decrease-volume",standard:"<key>SHIFT</key> + <key>V</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-announce-slider-animations",standard:"<key>A</key>"}]},slidertrace:{i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-slider-trace",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-toggle-slider-trace",standard:"<key>S</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-trace-decrease",standard:"<key>LEFT ARROW</key> <key>J</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-trace-decrease-larger",standard:"<key>PAGE DOWN</key>",apple:"<key>FN</key> + <key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-trace-increase",standard:"<key>RIGHT ARROW</key> <key>L</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-trace-increase-larger",standard:"<key>PAGE UP</key>",apple:"<key>FN</key> + <key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-trace-minimum",standard:"<key>HOME</key> <key>U</key>",apple:"<key>FN</key> + <key>LEFT ARROW</key> <key>U</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-trace-maximum",standard:"<key>END</key> <key>N</key>",apple:"<key>FN</key> + <key>RIGHT ARROW</key> <key>N</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-trace-next-slider",standard:"<key>DOWN ARROW</key>, <key>TAB</key>, <key>K</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-slider-trace-previous-slider",standard:"<key>UP ARROW</key>, <key>SHIFT</key> + <key>TAB</key>, <key>I</key>"}]},interactivepoints:{i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-interactive-points",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-focus-first-interactive-point",standard:"<key>CTRL</key> + <key>ALT</key> + <key>P</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>P</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-next-interactive-point",standard:"<key>TAB</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-previous-interactive-point",standard:"<key>SHIFT</key> + <key>TAB</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-increase-x",standard:"<key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-decrease-x",standard:"<key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-increase-y",standard:"<key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-decrease-y",standard:"<key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-increase-x-larger",standard:"<key>SHIFT</key> + <key>RIGHT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-decrease-x-larger",standard:"<key>SHIFT</key> + <key>LEFT ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-increase-y-larger",standard:"<key>SHIFT</key> + <key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-decrease-y-larger",standard:"<key>SHIFT</key> + <key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-x",standard:"<key>X</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-y",standard:"<key>Y</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-label",standard:"<key>L</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-speak-color",standard:"<key>C</key>"}]},commonactions:gJ({folders:!0,notes:!0,images:!0}),desmoscomonly:{i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-desmos-com-only",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-open-shortcuts-dialog",standard:"<key>CTRL</key> + <key>/</key>",apple:"<key>COMMAND</key> + <key>/</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-open-a-graph",standard:"<key>CTRL</key> + <key>O</key>",apple:"<key>COMMAND</key> + <key>O</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-save-a-graph",standard:"<key>CTRL</key> + <key>S</key>",apple:"<key>COMMAND</key> + <key>S</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-print-a-graph",standard:"<key>CTRL</key> + <key>P</key>",apple:"<key>COMMAND</key> + <key>P</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-toggle-account-menu",standard:"<key>CTRL</key> + <key>ALT</key> + <key>A</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>A</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-toggle-help-menu",standard:"<key>CTRL</key> + <key>ALT</key> + <key>H</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>H</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-toggle-language-menu",standard:"<key>CTRL</key> + <key>ALT</key> + <key>L</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>L</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-toggle-share-menu",standard:"<key>CTRL</key> + <key>ALT</key> + <key>S</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>S</key>"}]},braille:VK,mathquill:xk({decimalToFraction:!0})};function gJ(t){let e={i18nSectionKey:"shared-calculator-heading-keyboard-shortcuts-common-actions",shortcuts:[{i18nKey:"shared-calculator-text-keyboard-shortcut-close-a-dialog",standard:"<key>ESC</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-show-or-hide-expression-list",standard:"<key>SHIFT</key> + <key>ALT</key> + <key>E</key>",apple:"<key>SHIFT</key> + <key>COMMAND</key> + <key>E</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-focus-expression-list",standard:"<key>CTRL</key> + <key>ALT</key> + <key>E</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>E</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-open-expression-options",standard:"<key>CTRL</key> + <key>SHIFT</key> + <key>O</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-delete-expression",standard:"<key>CTRL</key> + <key>SHIFT</key> + <key>D</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-degrees-toggle",standard:"<key>ALT</key> + <key>D</key>",apple:"<key>CTRL</key> + <key>D</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-add-expression",standard:"<key>CTRL</key> + <key>ALT</key> + <key>X</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>X</key>"}]};return t.notes&&e.shortcuts.push({i18nKey:"shared-calculator-text-keyboard-shortcut-add-note",standard:"<key>CTRL</key> + <key>ALT</key> + <key>O</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>O</key>"}),t.folders&&(e.shortcuts=e.shortcuts.concat([{i18nKey:"shared-calculator-text-keyboard-shortcut-add-folder",standard:"<key>CTRL</key> + <key>ALT</key> + <key>F</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>F</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-collapse-folder",standard:"<key>ALT</key> + <key>UP ARROW</key>",apple:"<key>COMMAND</key> + <key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-expand-folder",standard:"<key>ALT</key> + <key>DOWN ARROW</key>",apple:"<key>COMMAND</key> + <key>DOWN ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-collapse-all-folders",standard:"<key>ALT</key> + <key>SHIFT</key> + <key>UP ARROW</key>",apple:"<key>COMMAND</key> + <key>SHIFT</key> + <key>UP ARROW</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-expand-all-folders",standard:"<key>ALT</key> + <key>SHIFT</key> + <key>DOWN ARROW</key>",apple:"<key>COMMAND</key> + <key>SHIFT</key> + <key>DOWN ARROW</key>"}])),t.images&&e.shortcuts.push({i18nKey:"shared-calculator-text-keyboard-shortcut-add-image",standard:"<key>CTRL</key> + <key>ALT</key> + <key>I</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>I</key>"}),e.shortcuts=e.shortcuts.concat([{i18nKey:"shared-calculator-text-keyboard-shortcut-add-table",standard:"<key>CTRL</key> + <key>ALT</key> + <key>T</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>T</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-undo",standard:"<key>CTRL</key> + <key>Z</key>",apple:"<key>COMMAND</key> + <key>Z</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-redo",standard:"<key>CTRL</key> + <key>SHIFT</key> + <key>Z</key>",apple:"<key>COMMAND</key> + <key>SHIFT</key> + <key>Z</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-zoom-in",standard:"<key>ALT</key> + <key>+</key>",apple:"<key>CTRL</key> + <key>+</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-zoom-out",standard:"<key>ALT</key> + <key>-</key>",apple:"<key>CTRL</key> + <key>-</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-zoom-restore-default",standard:"<key>ALT</key> + <key>0</key>",apple:"<key>CTRL</key> + <key>0</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-zoom-fit",standard:"<key>SHIFT</key> + <key>ALT</key> + <key>Z</key>",apple:"<key>SHIFT</key> + <key>OPTION</key> + <key>Z</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-toggle-edit-list-mode",standard:"<key>CTRL</key> + <key>ALT</key> + <key>D</key>",apple:"<key>CTRL</key> + <key>OPTION</key> + <key>D</key>"},{i18nKey:"shared-calculator-text-keyboard-shortcut-toggle-graph-settings-menu",standard:"<key>CTRL</key> + <key>ALT</key> + <key>G</key>",apple:"<key>CTRL</key> + <key>COMMAND</key> + <key>G</key>"}]),e}var ls=__dcg_shared_module_exports__['i'](Z());var{For:y0,If:mJ}=ls.Components,el=class extends ls.Class{template(){return ls.createElement("table",{class:ls.const("dcg-shortcuts-table")},ls.createElement(y0,{each:this.bindFn(this.getCols)},ls.createElement("tr",null,e=>ls.createElement("th",null,()=>this.getHeader(e)))),ls.createElement(y0,{each:()=>__dcg_shared_module_exports__['C'](this.props.section().shortcuts)},ls.createElement("tbody",null,e=>ls.createElement(y0,{each:this.bindFn(this.getCols)},ls.createElement("tr",null,r=>ls.createElement("td",{didMount:i=>this.populateContent(i,e,r)},ls.createElement(mJ,{predicate:()=>!!this.getLatex(e)},()=>ls.createElement(et,{latex:()=>this.getLatex(e),config:this.const({})}))))))))}getLatex(e){return this.props.section().shortcuts[e].latex||""}populateContent(e,r,i){let n=this.props.section().shortcuts[r];switch(i){case"heading":if(n.latex)return;n.i18nKey&&(e.innerHTML=this.props.controller().s(n.i18nKey));return;case"windows":e.innerHTML=this.replaceKey(n.standard);return;case"mac":e.innerHTML=this.replaceKey(n.apple||n.standard);return}}getHeader(e){let r=this.props.controller().s;switch(e){case"heading":return r("shared-calculator-heading-function-table-column-header");case"windows":return r("shared-calculator-heading-windows-chrome-table-column-header");case"mac":return r("shared-calculator-heading-mac-table-column-header")}}getCols(){return this.props.os?this.props.os()==="windows"?["heading","windows"]:["heading","mac"]:["heading","windows","mac"]}replaceKey(e){return e.replace(/\<key\>/g,"<span class='dcg-key-command'>").replace(/\<\/key\>/g,"</span>")}};var vk=class extends Yt.Class{init(){this.controller=this.props.controller(),this.controller.state.hotkeysDialog==null&&(this.controller.state.hotkeysDialog={shortcutOS:Zr?"mac":"windows"})}template(){return Yt.createElement(Vl,{controller:this.props.controller},Yt.createElement("div",{id:Yt.const("dcg-hotkeys-dialog")},Yt.createElement("h1",null,()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts")),Yt.createElement("div",{class:Yt.const("dcg-hotkeys-toggle-container")},Yt.createElement(jr,{staticConfig:this.bindFn(this.getOSOptions),ariaGroupLabel:()=>this.controller.s("shared-calculator-label-os")})),Yt.createElement("div",{class:Yt.const("dcg-hotkey-container")},Yt.createElement("div",{class:Yt.const("dcg-hotkey-section")},Yt.createElement("h2",{class:Yt.const("dcg-hotkey-section-header")},()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-common-actions")),Yt.createElement(el,{controller:this.props.controller,section:this.const(ud.commonactions),os:this.bindFn(this.getShortcutOS)}),Yt.createElement("h2",{class:Yt.const("dcg-hotkey-section-header")},()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-desmos-com-only")),Yt.createElement(el,{controller:this.props.controller,section:this.const(ud.desmoscomonly),os:this.bindFn(this.getShortcutOS)}),Yt.createElement("h2",{class:Yt.const("dcg-hotkey-section-header")},()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-expression-entry-and-navigation")),Yt.createElement(el,{controller:this.props.controller,section:()=>xk({decimalToFraction:this.controller.isDecimalToFractionEnabled()}),os:this.bindFn(this.getShortcutOS)}),Yt.createElement("h2",{class:Yt.const("dcg-hotkey-section-header")},()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-interactive-points")),Yt.createElement(el,{controller:this.props.controller,section:this.const(ud.interactivepoints),os:this.bindFn(this.getShortcutOS)}),Yt.createElement("h2",{class:Yt.const("dcg-hotkey-section-header")},()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-braille")),Yt.createElement(el,{controller:this.props.controller,section:this.const(ud.braille),os:this.bindFn(this.getShortcutOS)})),Yt.createElement("div",{class:Yt.const("dcg-hotkey-section")},Yt.createElement("h2",{class:Yt.const("dcg-hotkey-section-header")},()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-symbols")),Yt.createElement(el,{controller:this.props.controller,section:this.const(ud.common),os:this.bindFn(this.getShortcutOS)}),Yt.createElement("h2",{class:Yt.const("dcg-hotkey-section-header")},()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-audio-tracing")),Yt.createElement(el,{controller:this.props.controller,section:this.const(ud.audiotrace),os:this.bindFn(this.getShortcutOS)}),Yt.createElement("h2",{class:Yt.const("dcg-hotkey-section-header")},()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-slider-trace")),Yt.createElement(el,{controller:this.props.controller,section:this.const(ud.slidertrace),os:this.bindFn(this.getShortcutOS)}),Yt.createElement("h2",{class:Yt.const("dcg-hotkey-section-header tables-section")},()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-sliders")),Yt.createElement(el,{controller:this.props.controller,section:this.const(ud.sliders),os:this.bindFn(this.getShortcutOS)}),Yt.createElement("h2",{class:Yt.const("dcg-hotkey-section-header tables-section")},()=>this.controller.s("shared-calculator-heading-keyboard-shortcuts-tables")),Yt.createElement(el,{controller:this.props.controller,section:this.const(ud.tables),os:this.bindFn(this.getShortcutOS)})))))}getOSOptions(){return[{key:"windows",label:()=>this.controller.s("shared-calculator-button-windows-chrome"),selected:()=>this.getShortcutOS()==="windows",onSelect:()=>this.setShortcutOS("windows")},{key:"mac",label:()=>this.controller.s("shared-calculator-button-mac"),selected:()=>this.getShortcutOS()==="mac",onSelect:()=>this.setShortcutOS("mac")}]}getShortcutOS(){return this.controller.state.hotkeysDialog.shortcutOS}setShortcutOS(e){this.controller.state.hotkeysDialog.shortcutOS=e,this.unmounted||this.update()}didMount(){this.updateVisibleShortcuts()}didUnmount(){this.unmounted=!0}didUpdate(){this.updateVisibleShortcuts()}updateVisibleShortcuts(){let e=this.getShortcutOS(),r=I(".dcg-os-mac"),i=I(".dcg-os-windows");e==="mac"?(r.show(),i.hide()):e==="windows"&&(r.hide(),i.show())}};var Ln=__dcg_shared_module_exports__['i'](Z());var Ck=class extends Ln.Class{init(){this.controller=this.props.controller()}template(){return Ln.createElement(Vl,{controller:this.props.controller},Ln.createElement("div",{id:Ln.const("unsupported-browser")},Ln.createElement("div",{id:Ln.const("unsupported-browser-title"),style:Ln.const("color:black; font-size:150%;")},()=>this.controller.s("account-shell-heading-unsupported-browser")),Ln.createElement("div",{style:Ln.const("padding:20px 0px; color:#666")},()=>this.controller.s("account-shell-text-unsupported-browser-android"),Ln.createElement("br",null),Ln.createElement("br",null),Ln.createElement("a",{href:Ln.const("https://play.google.com/store/apps/details?id=com.android.chrome")},()=>this.controller.s("account-shell-link-download-chrome"),Ln.createElement("br",null),Ln.createElement("br",null)),Ln.createElement("div",{style:Ln.const("text-align: center; margin-top: 25px; margin-bottom:-16px")},Ln.createElement("a",{role:Ln.const("link"),tabindex:Ln.const("0"),class:Ln.const("dcg-btn dcg-action-hide dcg-do-not-blur"),onTap:()=>this.controller.dispatch({type:"close-modal"})},()=>this.controller.s("account-shell-button-hide-browser-warning"))))))}};var Pn=__dcg_shared_module_exports__['i'](Z());var We=__dcg_shared_module_exports__['i'](Z());var $r=__dcg_shared_module_exports__['i'](Z());var Dk=class extends $r.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.formErrors=[]}template(){return $r.createElement("div",{class:$r.const("dcg-shared-delete-account dcg-shared-account-settings-section")},$r.createElement("h1",{class:$r.const("dcg-shared-left-align-title")},()=>this.i18n.s("shared-title-delete-account")),$r.createElement("div",{class:$r.const("dcg-shared-account-paragraph")},$r.createElement(un,{key:this.const("shared-message-delete-account-notice"),i18n:this.props.controller},$r.const("When you delete your account,"),$r.const(" "),$r.createElement("b",null,$r.const("we will retain your data for 30 days.")),$r.const(" "),$r.const("You can reactivate your account at any time during those 30 days by logging back in."),$r.const(" "),$r.const("If there's something about Desmos we can improve, please"),$r.const(" "),$r.createElement("a",{href:$r.const("mailto:support@desmos.com"),class:$r.const("dcg-shared-blue-link")},$r.const("let us know.")))),$r.createElement("div",{class:$r.const("dcg-shared-account-paragraph")},()=>this.i18n.s("shared-message-delete-account-will-send-email",{email:this.i18n.raw(this.controller.userController.getEmail())})),$r.createElement("form",{onSubmit:this.bindFn(this.onSubmit)},$r.createElement(Oo,{controller:this.props.controller,errors:()=>this.formErrors}),$r.createElement("div",{class:$r.const("dcg-shared-modal-actions-container")},$r.createElement("div",{role:$r.const("link"),tabindex:$r.const(0),class:$r.const("dcg-shared-dark-gray-link"),onTap:()=>(this.controller.logJSON("shared-delete-account",{action:"cancel-delete-account"}),this.props.hideForm())},()=>this.i18n.s("shared-button-cancel")),$r.createElement("button",{class:()=>({"dcg-shared-btn-red":!0,"dcg-disabled":this.disabled}),"aria-disabled":()=>this.disabled,tabindex:()=>this.disabled?"-1":"0",type:$r.const("submit")},()=>this.i18n.s("shared-button-send-delete-account-email")))))}onAccountDeleted(){return this.props.submitForm()}onAccountDeletionFailed(){if(this.formErrors=[this.controller.getSomethingWentWrongText()],!this.unmounted)return this.update()}doDeleteAccount(){this.disabled||(this.controller.logJSON("shared-delete-account",{action:"send-delete-account-email"}),this.controller.userController.initiateAccountDeletion({lang:this.controller.getLanguage()}).done(this.bindFn(this.onAccountDeleted)).fail(this.bindFn(this.onAccountDeletionFailed)))}didUnmount(){return this.unmounted=!0}onSubmit(e){e.preventDefault(),this.doDeleteAccount()}};var Ht=__dcg_shared_module_exports__['i'](Z());var{If:b0}=Ht.Components,ef=0,IK=1,fJ=2,MK=3,Sk=class extends Ht.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.formStatus=ef,this.emailDisabled=null}template(){return Ht.createElement("div",{class:Ht.const("dcg-shared-email-field-container")},Ht.createElement(b0,{predicate:()=>this.formStatus===ef},()=>Ht.createElement("div",{class:Ht.const("dcg-shared-email-field")},Ht.createElement("div",{class:Ht.const("dcg-shared-profile-info-container")},Ht.createElement("span",{class:Ht.const("dcg-shared-profile-info-title"),role:Ht.const("heading"),"aria-level":Ht.const("1")},()=>this.i18n.s("shared-title-email-settings")),Ht.createElement("div",{class:Ht.const("dcg-shared-profile-info-content")},()=>this.i18n.raw(this.controller.userController.getEmail()),Ht.createElement("div",{class:Ht.const("dcg-shared-message-container")},Ht.createElement("div",{role:Ht.const("link"),tabindex:Ht.const(0),class:Ht.const("dcg-shared-blue-link"),onTap:()=>this.setFormStatus(IK)},()=>this.i18n.s("shared-button-change-email-address"))))))),Ht.createElement(b0,{predicate:()=>this.formStatus===IK},()=>Ht.createElement("div",{class:Ht.const("dcg-shared-change-email-container")},Ht.createElement("div",{class:Ht.const("dcg-shared-change-email-description")},()=>this.i18n.s("shared-message-email-settings-will-send-email",{emailAddress:this.i18n.raw(this.controller.userController.getEmail())})),Ht.createElement(Oo,{controller:this.props.controller,errors:()=>this.formErrors}),Ht.createElement("div",{class:Ht.const("dcg-shared-modal-actions-container")},Ht.createElement("span",{role:Ht.const("link"),tabindex:Ht.const(0),class:Ht.const("dcg-shared-dark-gray-link"),onTap:()=>this.setFormStatus(ef)},()=>this.i18n.s("shared-button-cancel")),Ht.createElement("button",{class:()=>({"dcg-shared-btn-blue":!0,"dcg-disabled":this.emailDisabled}),"aria-disabled":()=>this.disabled,tabindex:()=>this.disabled?"-1":"0",type:Ht.const("submit"),onTap:()=>this.emailDisabled||this.sendChangeEmail()},()=>this.i18n.s("shared-button-send-email"))))),Ht.createElement(b0,{predicate:()=>this.formStatus===MK},()=>Ht.createElement("div",{"aria-live":Ht.const("assertive"),"aria-atomic":Ht.const("true"),class:Ht.const("dcg-shared-confirmation-message-container")},Ht.createElement("div",{class:Ht.const("dcg-shared-confirmation-message")},Ht.createElement("i",{class:()=>({"dcg-icon-check":!0,"dcg-success-marker":!0}),"aria-hidden":Ht.const("true")}),()=>this.i18n.s("shared-message-email-sent")),Ht.createElement("div",null,()=>this.i18n.s("shared-message-check-email-for-link",{emailAddress:this.i18n.raw(this.controller.userController.getEmail())})))))}didUnmount(){this.unmounted=!0}setToast(e){this.toastMessage||(this.toastMessage=e,this.unmounted||this.update(),setTimeout(()=>{this.toastMessage=null,this.unmounted||this.update()},5e3),this.formStatus===fJ&&setTimeout(()=>{this.setFormStatus(ef),this.unmounted||this.update()},5200))}setFormStatus(e){this.formStatus=e,this.toastMessage=null,this.formErrors=[],this.update()}onEmailSent(){this.formStatus=MK,this.emailDisabled=null,this.unmounted||this.update(),setTimeout(()=>{this.formStatus=ef,this.unmounted||this.update()},5e3),setTimeout(()=>{this.formStatus=ef,this.unmounted||this.update()},5200)}onEmailSendingFailed(){this.formErrors=[this.controller.getSomethingWentWrongText()],this.emailDisabled=null,this.unmounted||this.update()}sendChangeEmail(){this.emailDisabled=!0,this.unmounted||this.update(),this.controller.userController.initiateEmailChange({lang:this.controller.getLanguage()}).done(this.bindFn(this.onEmailSent)).fail(this.bindFn(this.onEmailSendingFailed))}};var{If:AK,Input:v0,Switch:yJ,SwitchUnion:bJ}=We.Components,w0=0,TK=1,x0=2,Ek=class extends We.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.deleteAccount=w0}template(){return We.createElement("div",{class:We.const("dcg-shared-profile-info dcg-shared-account-settings-section")},We.createElement(yJ,{key:()=>this.deleteAccount},e=>{switch(e){case w0:return We.createElement("div",null,We.createElement("div",{class:We.const("dcg-shared-email-form-container")},We.createElement(C0,{controller:this.props.controller})),We.createElement(Sk,{controller:this.props.controller}),We.createElement("div",{role:We.const("link"),tabindex:We.const(0),class:We.const("dcg-shared-dark-gray-link dcg-shared-delete-link"),onTap:()=>this.confirmDeletion()},()=>this.i18n.s("shared-button-delete-account-question")));case TK:return We.createElement(Dk,{hideForm:()=>this.setDeleteAccount(w0),submitForm:()=>this.setDeleteAccount(x0),controller:this.props.controller});case x0:return We.createElement("div",{"aria-live":We.const("assertive"),"aria-atomic":We.const("true"),class:We.const("dcg-shared-confirmation-message-container")},We.createElement("div",{class:We.const("dcg-shared-confirmation-message")},We.createElement("i",{class:()=>({"dcg-icon-check":!0,"dcg-success-marker":!0}),"aria-hidden":We.const("true")}),()=>this.i18n.s("shared-message-email-sent")),We.createElement("div",null,()=>this.i18n.s("shared-message-check-email-for-delete-link",{emailAddress:this.i18n.raw(this.controller.userController.getEmail())})))}}))}didUnmount(){this.unmounted=!0}setDeleteAccount(e){this.deleteAccount=e,e===x0&&setTimeout(()=>{this.controller.userController.logout().done(()=>this.controller.dispatch({type:"close-modal"}))},5e3),this.unmounted||this.update()}confirmDeletion(){this.controller.logJSON("shared-profile-info",{action:"delete-account"}),this.setDeleteAccount(TK),this.unmounted||this.update()}},C0=class extends We.Class{init(){this.controller=this.props.controller();let e=this.controller.userController.getNameDetail();e.source=="legacy"?this.state={state:"legacy",name:e.given,previousName:e.given}:e.source=="parsed"?this.state={state:"name-detail",confirm:!0,given:e.given,family:e.family||"",previousGiven:"",previousFamily:""}:this.state={state:"name-detail",confirm:!1,given:e.given,family:e.family||"",previousGiven:e.given,previousFamily:e.family||""}}template(){return bJ("state",()=>this.state)({legacy:e=>We.createElement(D0,{state:e,controller:this.props.controller,onSaveName:this.bindFn(this.onSaveName),showSavedNotice:()=>this.showSavedNotice,updateState:r=>{this.state.state=="legacy"&&(this.state=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['b']({},this.state),r),this.unmounted||this.update())}}),"name-detail":e=>We.createElement(S0,{state:e,controller:this.props.controller,showSavedNotice:()=>this.showSavedNotice,onSaveName:this.bindFn(this.onSaveName),updateState:r=>{this.state.state=="name-detail"&&(this.state=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['b']({},this.state),r),this.unmounted||this.update())}})})}onSaveName(){switch(this.state.state){case"legacy":this.controller.userController.setNameLegacy({name:this.state.name,lang:this.controller.getLanguage()}).done(this.bindFn(this.onSaved));break;case"name-detail":this.controller.userController.setNameDetail({given:this.state.given,family:this.state.family,lang:this.controller.getLanguage()}).done(this.bindFn(this.onSaved));break}}maybeUpdate(){this.unmounted||this.update()}onSaved(){switch(this.state.state){case"legacy":this.state.previousName=this.state.name;break;case"name-detail":this.state.previousGiven=this.state.given,this.state.previousFamily=this.state.family,this.state.confirm=!1;break}this.showSavedNotice=!0,this.maybeUpdate(),setTimeout(()=>{this.showSavedNotice=!1,this.maybeUpdate()},3e3)}willUnmount(){this.unmounted=!0}didMount(){this.unmounted=!1}},D0=class extends We.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller}template(){return We.createElement("div",{class:We.const("dcg-shared-name-field")},We.createElement("div",{class:We.const("dcg-shared-profile-info-container")},We.createElement("span",{class:We.const("dcg-shared-profile-info-title"),role:We.const("heading"),"aria-level":We.const("1")},()=>this.i18n.s("shared-label-name")),We.createElement(v0,{type:We.const("text"),name:We.const("name"),class:We.const("dcg-shared-input-blue-outline dcg-shared-profile-info-content"),didMount:this.bindFn(this.didMountName),onInput:this.bindFn(this.onNameInput),"aria-label":()=>this.i18n.s("shared-label-name"),value:()=>this.props.state().name,autocomplete:We.const("off")})),We.createElement("div",{class:We.const("dcg-shared-modal-actions-container")},We.createElement(kk,{showSavedNotice:this.props.showSavedNotice,i18n:this.props.controller}),We.createElement("div",{role:We.const("button"),"aria-disabled":this.bindFn(this.nameFieldDisabled),tabindex:()=>this.nameFieldDisabled()?"-1":"0",class:()=>({"dcg-shared-btn-blue":!0,"dcg-disabled":this.nameFieldDisabled()}),onTap:this.bindFn(this.onSaveName)},()=>this.i18n.s("shared-button-save"))))}onNameInput(e){this.props.updateState({name:e})}didMountName(e){Ul||e.focus()}onSaveName(){this.nameFieldDisabled()||this.props.onSaveName()}nameFieldDisabled(){let e=this.props.state();return!e.name||e.name===e.previousName}},S0=class extends We.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller}template(){return We.createElement("div",{class:We.const("dcg-shared-name-field")},We.createElement("div",{class:()=>({"dcg-shared-confirm-name":this.props.state().confirm})},We.createElement(AK,{predicate:()=>this.props.state().confirm},()=>We.createElement("span",null,()=>this.i18n.s("shared-message-please-review-name"))),We.createElement("div",{class:We.const("dcg-shared-profile-info-container")},We.createElement("div",{class:We.const("dcg-shared-name-input")},We.createElement("span",{class:We.const("dcg-shared-profile-info-title"),role:We.const("heading"),"aria-level":We.const("1")},()=>this.i18n.s("shared-label-given-name-or-nickname")),We.createElement(v0,{type:We.const("text"),name:We.const("given-name"),class:We.const("dcg-shared-input-blue-outline dcg-shared-profile-info-content"),didMount:this.bindFn(this.didMountName),onInput:e=>this.props.updateState({given:e}),"aria-label":()=>this.i18n.s("shared-label-given-name-or-nickname"),value:()=>this.props.state().given,autocomplete:We.const("off")})),We.createElement("div",{class:We.const("dcg-shared-name-input")},We.createElement("span",{class:We.const("dcg-shared-profile-info-title"),role:We.const("heading"),"aria-level":We.const("1")},()=>this.i18n.s("shared-label-family-name")),We.createElement(v0,{type:We.const("text"),name:We.const("family-name"),class:We.const("dcg-shared-input-blue-outline dcg-shared-profile-info-content"),onInput:e=>this.props.updateState({family:e}),"aria-label":()=>this.i18n.s("shared-label-family-name"),value:()=>this.props.state().family,autocomplete:We.const("off")}))),We.createElement("div",{class:We.const("dcg-shared-modal-actions-container")},We.createElement(kk,{i18n:this.props.controller,showSavedNotice:this.props.showSavedNotice}),We.createElement("div",{role:We.const("button"),"aria-disabled":()=>!this.canSubmit(),tabindex:()=>this.canSubmit()?"0":"-1",class:()=>({"dcg-shared-btn-blue":!0,"dcg-disabled":!this.canSubmit()}),onTap:this.bindFn(this.onSaveName)},()=>this.props.state().confirm?this.i18n.s("shared-button-confirm-name"):this.i18n.s("shared-button-save")))))}didMountName(e){Ul||e.focus()}onSaveName(){this.canSubmit()&&this.props.onSaveName()}canSubmit(){let e=this.props.state();return e.given?e.confirm?!0:!(e.given===e.previousGiven&&e.family===e.previousFamily):!1}},kk=class extends We.Class{template(){return We.createElement(AK,{predicate:()=>this.props.showSavedNotice()},()=>We.createElement("span",{"aria-live":We.const("assertive"),"aria-atomic":We.const("true"),class:We.const("dcg-shared-confirmation-message")},We.createElement("i",{class:()=>({"dcg-icon-check":!0,"dcg-success-marker":!0}),"aria-hidden":We.const("true")}),()=>this.props.i18n().s("shared-message-information-saved")))}};var qi=__dcg_shared_module_exports__['i'](Z());var{If:LK}=qi.Components,wJ=0,E0=1,PK=2,Gk=class extends qi.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.mode=E0,this.formErrors=[]}template(){return qi.createElement("div",{class:qi.const("dcg-shared-change-password dcg-shared-account-settings-section")},qi.createElement(LK,{predicate:()=>this.mode===E0},()=>qi.createElement("div",{class:qi.const("dcg-shared-reset-by-email")},qi.createElement("div",{class:qi.const("dcg-shared-account-paragraph")},()=>this.i18n.s("shared-message-change-password-email-sent",{emailAddress:this.i18n.raw(this.controller.userController.getEmail())})),qi.createElement(Oo,{controller:this.props.controller,errors:()=>this.formErrors}),qi.createElement("div",{class:qi.const("dcg-shared-modal-actions-container")},qi.createElement("div",{role:qi.const("button"),"aria-disabled":()=>this.emailDisabled,tabindex:()=>this.emailDisabled?"-1":"0",class:()=>({"dcg-shared-btn-blue":!0,"dcg-disabled":this.emailDisabled}),onTap:()=>this.sendResetPasswordEmail()},()=>this.i18n.s("shared-button-send-email"))))),qi.createElement(LK,{predicate:()=>this.mode===PK},()=>qi.createElement("div",{"aria-live":qi.const("assertive"),"aria-atomic":qi.const("true"),class:qi.const("dcg-shared-confirmation-message-container")},qi.createElement("div",{class:qi.const("dcg-shared-confirmation-message")},qi.createElement("i",{class:()=>({"dcg-icon-check":!0,"dcg-success-marker":!0}),"aria-hidden":qi.const("true")}),()=>this.i18n.s("shared-message-email-sent")),qi.createElement("div",null,()=>this.i18n.s("shared-message-check-email-for-password-link",{emailAddress:this.i18n.raw(this.controller.userController.getEmail())})))))}didUnmount(){this.unmounted=!0}onEmailSent(){this.mode=PK,this.unmounted||this.update(),setTimeout(()=>{this.mode=wJ,this.unmounted||this.update()},5e3),setTimeout(()=>{this.mode=E0,this.unmounted||this.update()},5200)}onEmailSendingFailed(){this.formErrors=[this.controller.getSomethingWentWrongText()],this.unmounted||this.update()}sendResetPasswordEmail(){this.controller.userController.recoverPassword({email:this.controller.userController.getEmail(),lang:this.controller.getLanguage()}).done(this.bindFn(this.onEmailSent)).fail(this.bindFn(this.onEmailSendingFailed))}};Oe();var{For:xJ,Switch:vJ}=Pn.Components,Vk="profile-info",k0="change-password",Ik=class extends Pn.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.settingsView=this.props.initialTab&&this.props.initialTab()||Vk,this.breakPoint=660,this.measureWindow()}template(){return Pn.createElement(Po,{title:()=>this.i18n.s("shared-title-account-settings"),size:this.const("wide"),showX:this.const(!0),leftAlignTitle:this.const(!0),onClose:()=>this.controller.dispatch({type:"close-modal"}),i18n:this.props.controller},Pn.createElement("div",{class:Pn.const("dcg-shared-account-settings-dialog dcg-shared-account-dialog")},Pn.createElement(xJ,{each:()=>this.getTabs(),key:e=>""+e.key},Pn.createElement("div",{class:Pn.const("dcg-shared-navigation-tabs"),role:Pn.const("tablist")},e=>Pn.createElement("div",{role:Pn.const("tab"),tabindex:Pn.const("0"),"aria-selected":()=>this.settingsView===e.key,class:()=>({"dcg-shared-tab-gray-underline":!0,[e.class]:!0,"dcg-selected":this.settingsView===e.key}),onTap:()=>this.updateSettingsView(e.key)},e.label))),Pn.createElement("div",{class:Pn.const("dcg-shared-content-container")},Pn.createElement(vJ,{key:()=>this.settingsView},e=>e===Vk?Pn.createElement(Ek,{controller:this.props.controller}):e===k0?Pn.createElement(Gk,{controller:this.props.controller}):this.props.extraTabs?Pn.createElement("div",{class:Pn.const("dcg-shared-profile-info dcg-shared-account-settings-section")},this.props.extraTabs().createView(e)):Pn.createElement("span",null)))))}getTabs(){let e=[{key:Vk,label:this.bindFn(this.profileTitle),class:"profile-view-button"},{key:k0,label:this.bindFn(this.passwordTitle),class:"change-password-view-button"}];return this.props.extraTabs?[...e,...this.props.extraTabs().tabs.map(({key:r,narrowLabel:i,wideLabel:n,class:o})=>({key:r,label:()=>this.windowWidth>this.breakPoint?i():n(),class:`${o}-button`}))]:e}updateSettingsView(e){this.settingsView=e,this.unmounted||this.update()}profileTitle(){return this.windowWidth>this.breakPoint?this.i18n.s("shared-title-profile-information-wide"):this.i18n.s("shared-title-profile-information-narrow")}passwordTitle(){return this.windowWidth>this.breakPoint?this.i18n.s("shared-title-change-password-wide"):this.i18n.s("shared-title-change-password-narrow")}measureWindow(){return this.windowWidth=I(window).width()}didMount(){I(window).on("resize.account-dialog",__dcg_shared_module_exports__['A'](()=>{this.measureWindow(),this.unmounted||this.update()},200))}didUnmount(){I(window).off("resize.account-dialog"),this.unmounted=!0}isProfileSelected(){return this.settingsView===Vk}isChangePasswordSelected(){return this.settingsView===k0}};var ii=__dcg_shared_module_exports__['i'](Z());var{Input:OK}=ii.Components,Mk=class extends ii.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.formErrors=[]}template(){return ii.createElement(Po,{title:()=>this.i18n.s("shared-title-change-email-address"),size:this.const("narrow"),showX:this.const(!0),onClose:()=>this.controller.dispatch({type:"close-modal"}),i18n:this.props.controller},ii.createElement("div",{class:ii.const("dcg-shared-change-email dcg-shared-account-dialog")},ii.createElement("div",{class:ii.const("dcg-shared-account-paragraph")},()=>this.i18n.s("shared-message-set-new-email-address")),ii.createElement("form",{onSubmit:this.bindFn(this.onSubmit),method:ii.const("post"),class:ii.const("dcg-shared-email-form-container")},ii.createElement("label",null,ii.createElement("span",{class:ii.const("dcg-shared-input-title")},()=>this.i18n.s("shared-label-new-email-address")),ii.createElement(OK,{type:ii.const("email"),name:ii.const("newEmail"),class:ii.const("dcg-shared-input-blue-outline"),"aria-label":()=>this.i18n.s("shared-label-new-email-address"),required:ii.const("true"),didMount:e=>{Ul||e.focus()},value:()=>this.newEmail,onInput:e=>{this.newEmail=e,this.unmounted||this.update()}})),ii.createElement("label",{for:ii.const("password")},ii.createElement("span",null,()=>this.i18n.s("shared-label-password")),ii.createElement(OK,{type:ii.const("password"),class:ii.const("dcg-shared-input-blue-outline"),"aria-label":()=>this.i18n.s("shared-label-password"),required:ii.const("true"),value:()=>this.password,name:this.const("password"),onInput:e=>{if(this.password=e,!this.unmounted)return this.update()}})),ii.createElement(Oo,{controller:this.props.controller,errors:()=>this.formErrors}),ii.createElement("div",{class:ii.const("dcg-shared-sign-in-options")},ii.createElement("button",{class:()=>({"dcg-shared-btn-blue":!0,"dcg-disabled":!this.submitEnabled()}),"aria-disabled":()=>!this.submitEnabled(),tabindex:()=>this.submitEnabled()?"0":"-1",type:ii.const("submit")},()=>this.i18n.s("shared-button-change-email-and-password"))))))}submitEnabled(){return!!(this.password&&this.newEmail)}didUnmount(){this.unmounted=!0}onSubmit(e){e.preventDefault(),this.submitEnabled()&&this.controller.userController.setEmail({changeToken:this.getChangeToken(),password:this.password,newEmail:this.newEmail,lang:this.controller.getLanguage()}).done(()=>{this.controller.dispatch({type:"close-modal"}),history.replaceState(null,null,document.location.pathname)}).fail(r=>{r.status===409?this.formErrors=["Sorry, someone has already registered with this email address."]:this.formErrors=[this.controller.getSomethingWentWrongText()],this.unmounted||this.update()})}getChangeToken(){return this.controller.userController.getEmailChangeToken()||""}};var _K=__dcg_shared_module_exports__['i'](Z());var kr=__dcg_shared_module_exports__['i'](Z());var{If:Tk}=kr.Components,pp=class extends kr.Class{template(){return kr.createElement("div",{class:kr.const("dcg-loading-container")},kr.createElement(Tk,{predicate:()=>!this.props.didDataLoadFail()},()=>kr.createElement("div",{class:kr.const("dcg-graph-loading")},kr.createElement("div",{class:kr.const("pulsing-message")},()=>this.props.s("account-shell-text-mygraphs-loading")),kr.createElement("div",{role:kr.const("link"),tabindex:kr.const("0"),class:kr.const("dcg-cancel-while-loading"),onTap:this.props.onCancel},()=>this.props.s("account-shell-button-mygraphs-cancel")))),kr.createElement(Tk,{predicate:()=>this.props.didDataLoadFail()},()=>kr.createElement("div",{class:kr.const("dcg-graph-loading-error"),"aria-live":kr.const("assertive"),"aria-atomic":kr.const("true")},kr.createElement("div",{class:kr.const("dcg-graph-loading-error-title")},()=>this.props.s("account-shell-error-mygraphs-error-loading")),kr.createElement("div",{class:kr.const("dcg-graph-loading-error-subtitle")},()=>this.props.s("account-shell-error-mygraphs-check-connection")),kr.createElement("div",{class:kr.const("dcg-graph-loading-error-options")},kr.createElement("span",{role:kr.const("button"),tabindex:kr.const("0"),class:kr.const("dcg-action-try-again dcg-btn-blue dcg-btn-medium"),onTap:this.props.requestLoadGraphData},()=>this.props.s("account-shell-button-mygraphs-try-again")),kr.createElement(Tk,{predicate:()=>!!this.props.onCancel},()=>kr.createElement("span",null,()=>this.props.s("account-shell-text-mygraphs-or"))),kr.createElement(Tk,{predicate:()=>!!this.props.onCancel},()=>kr.createElement("span",{role:kr.const("button"),tabindex:kr.const("0"),class:kr.const("dcg-action-cancel dcg-btn-light-gray dcg-btn-medium"),onTap:this.props.onCancel},()=>this.props.s("account-shell-button-mygraphs-cancel")))))))}};Oe();function CJ(t,e){var r=document.createElement("div");r.style.zIndex="999999",r.style.position="fixed",r.style.bottom="50px",r.style.left="0",r.style.right="0",document.body.append(r),_K.mountToNode(pp,r,{s:e,didDataLoadFail:function(){return!0},requestLoadGraphData:function(){r.remove(),t()}})}function FK(t,e){var r=I.Deferred();if(t&&t.state)r.resolve(t);else if(t&&typeof t.stateUrl=="string"){var i=!1;let n=()=>{i||(i=!0,I.getJSON(t.stateUrl,Bc).done(function(o){t.state=o,r.resolve(t)}).fail(function(){CJ(n,e)}).always(function(){i=!1}))};n()}else r.resolve();return r}var RK="v1.9";var Ak=class{constructor(e,r){var i=new $l;for(var n in r)i.config.setProperty(n,r[n]);this.controller=new lu(i);var o=new lp(e);this.controller.setEvaluator(o),o.readEvaluatorConfig=()=>({product:this.controller.getGraphSettings().config.product,beta3d:r.beta3d,evaluationMode:this.controller.isGeometry()?"geometry":"graphing",globalRandomSeed:i.randomSeed,degreeMode:i.degreeMode,restrictedFunctions:i.config.restrictedFunctions,distributions:i.config.distributions,pointsOfInterest:i.config.pointsOfInterest,plotSingleVariableImplicitEquations:i.config.plotSingleVariableImplicitEquations,plotImplicits:i.config.plotImplicits,plotInequalities:i.config.plotInequalities,sliders:i.config.sliders,actions:i.config.actions}),o.onEvaluatorResults=a=>{this.controller.dispatch({type:"on-evaluator-changes",changes:a.evaluationStates,timingData:a.timingData,eventUpdates:a.eventUpdates})};var s=new Lr;s.setProperties({pixelCoordinates:{top:0,bottom:0,left:0,right:0,width:0,height:0},mathCoordinates:{top:0,bottom:0,left:0,right:0,width:0,height:0}}),this.graphpaperBounds=s,this.evaluator=o,this.setBlank()}setBlank(e){this.controller.dispatch({type:"set-blank",opts:e})}tick(){this.evaluator.tick()}destroy(){this.evaluator.destroy()}};var tf=class{constructor(e){this._calc=new Ak($m,xE(__dcg_shared_module_exports__['b']({},e))),this.controller=this._calc.controller,this._sharedClockBusToken=lh(()=>{this._calc.tick()})}destroy(){this._calc.destroy(),yu(this._sharedClockBusToken);function e(o){__dcg_shared_module_exports__['M'].warn("You've destroyed this API instance. You can no longer call ."+o+"()")}for(var r={},i=this;i;)Object.getOwnPropertyNames(i).forEach(s=>r[s]=!0),i=Object.getPrototypeOf(i);for(var n in r)typeof this[n]=="function"?this[n]=e.bind(this,n):this.hasOwnProperty(n)&&delete this[n];this.destroy=function(){}}setExpression(e){var r=this.controller,i=r.getItemModel(e.id),n=i&&i.type,o=uE(e,n,this.controller);if(o)if(n)this.controller.dispatch({type:"set-expression-properties-from-api",id:o.id,properties:o});else{if(o.type==="image")return;this.controller.dispatch({type:"add-item-to-end-from-api",state:o})}}setExpressions(e){e.forEach(this.setExpression.bind(this))}removeExpression(e){var r=e.id.toString();this.controller.dispatch({type:"remove-item-by-id",id:r})}removeExpressions(e){e.forEach(this.removeExpression.bind(this))}getState(e){return this.controller.getState(e)}getExpressions(){var e=this.getState({stripDefaults:!1}).expressions.list;return e.map(pE)}setBlank(e){this.controller.dispatch({type:"set-blank",opts:e||{}})}setState(e,r){this.controller.dispatch({type:"set-state",state:e,opts:r||{}})}HelperExpression(e){var r=e&&e.latex||"",i=new Lr;return i.latex=r,this.controller.dispatch({type:"add-helper-expression",state:{type:"helper-expression",id:this.controller.generateId(),latex:r,proxy:i}}),i}resize(){}};var hf=__dcg_shared_module_exports__['i'](Z());var Cu=class{constructor(e){if(this.rootElt=e,this.eventModel=new Lr,!e)throw new Error("must pass an HTMLElement to the API")}setupDomChangeDetector(e){this.autoSize=e,ZD(this.rootElt),this.domChangeDetector=new fu(this.rootElt,r=>{switch(r.type){case"added":this.view=this.onCreateView(),this.onResizeView(r.size);break;case"removed":this.onDestroyView(),this.view=void 0;break;case"resized":this.onResizeView(r.size);break}}),this.autoSize!==!1?this.domChangeDetector.startWatching():this.domChangeDetector.checkForChanges()}detach(){__dcg_shared_module_exports__['M'].warn(".detach() is deprecated. It should no longer be necessary")}destroy(){this.view&&this.onDestroyView(),this.domChangeDetector.destroy();function e(o){__dcg_shared_module_exports__['M'].warn("You've destroyed this API instance. You can no longer call ."+o+"()")}for(var r={},i=this;i;)Object.getOwnPropertyNames(i).forEach(s=>r[s]=!0),i=Object.getPrototypeOf(i);for(var n in r)typeof this[n]=="function"?this[n]=e.bind(this,n):this.hasOwnProperty(n)&&delete this[n];this.destroy=function(){}}resize(){this.domChangeDetector.checkForChanges()}updateView(){this.view&&document.body&&document.body.contains(this.rootElt)&&this.view.update()}triggerEvent(e,r){this.eventModel.triggerEvent(e,r)}observeEvent(e,r){this.eventModel.observeEvent(e,r)}unobserveEvent(e){this.eventModel.unobserveEvent(e)}};var Qw=class{constructor({evaluationMode:e,additionalFunctions:r,functionDefinition:i,replaceRoundWithReciprocal:n,workerPool:o}){this._evaluations={};this._nextObjectId=0;this.store=new pc({expressions:{1:{id:"1",latex:"",braille:"",type:"latex",displayAsFraction:!1}},order:["1"],settings:{degreeMode:!1},ui:{focus:void 0}});this.evaluationMode=e,this.additionalFunctions=r,this.functionDefinition=i,this.replaceRoundWithReciprocal=n,this.workerPool=o,this._setupEvaluator(),this.clear(),this._sharedClockBusToken=lh(()=>{this._evaluator.tick()})}isSingleExpression(){return this.evaluationMode==="singleExpressionScientific"||this.evaluationMode==="singleExpressionFourFunction"}destroy(){yu(this._sharedClockBusToken)}generateObjectId(){return(this._nextObjectId++).toString()}updateNextObjectId(){let e=this.store.getState().order;this._nextObjectId=0;let r=/^[0-9]+$/;for(let i of e)if(r.test(i)){let n=parseInt(i,10);n>=this._nextObjectId&&(this._nextObjectId=n+1)}}clearShouldDebounceUndoRedo(){this._shouldDebounceUndoRedo=!1}markShouldDebounceUndoRedo(){this._shouldDebounceUndoRedo=!0}getShouldDebounceUndoRedo(){return this._shouldDebounceUndoRedo}clearCachedBrailleValues(){for(let e of this.getExpressionOrder())this.store.set(["expressions",e,"braille"],"")}getState(){return this.store.getState()}getPersistedState(){let{expressions:e,order:r,settings:i}=this.getState();return{expressions:{list:r.map(n=>{var o=e[n];return{id:o.id,latex:o.latex,displayAsFraction:o.displayAsFraction}})},settings:i}}setState(e){this.store.set(e),this._updateIndexes(),this.updateNextObjectId()}setStateFromAPI(e){let r=[],i={};e.expressions.list.forEach(n=>{r.push(n.id),i[n.id]={id:n.id,latex:n.latex,braille:"",type:"latex",displayAsFraction:!!n.displayAsFraction}}),this.setState({expressions:i,order:r,settings:e.settings,ui:{focus:void 0}})}canClear(){if(this.getNumberOfExpressions()>1)return!0;let e=this.getExpressionOrder()[0];return this.getExpressionLatex(e)!==""}clear(){this.setState({expressions:{1:{id:"1",type:"latex",latex:"",braille:"",displayAsFraction:!1}},ui:{focus:void 0},order:["1"],settings:this.getState().settings})}getExpressionOrder(){return this.store.getState().order}getNumberOfExpressions(){return this.getExpressionOrder().length}getExpressionById(e){return this.getState().expressions[e]}getExpressionIndex(e){return this._indexes[e]}_getExpressionByIndex(e){let r=this.getExpressionOrder()[e];return this.getExpressionById(r)}_updateIndexes(){this._indexes={};let e=0;for(let r of this.getExpressionOrder())this._indexes[r]=e,e+=1;this._evaluate()}_usesAnsById(e){return this.getExpressionById(e).latex.indexOf("\\operatorname{ans}")!==-1}_getPreviousExpById(e){let r=this.getExpressionIndex(e);return this._getExpressionByIndex(r-1)}createBlankAfterId(e){if(this.isSingleExpression()||!this.getExpressionById(e).latex)return;let r=this.getExpressionIndex(e),i=this.generateObjectId();this.store.shallowMutate("order",n=>{n.splice(r+1,0,i)}),this.store.shallowMutate("expressions",n=>{n[i]={id:i,latex:"",braille:"",type:"latex",displayAsFraction:!1}}),this._updateIndexes(),this.setFocusedById(i,!0)}conditionallyCopyPrevious(e){let r=this._getPreviousExpById(e),i=this.getExpressionById(e);r!=null&&i.latex===""&&this._usesAnsById(r.id)&&this.setLatexById(e,r.latex)}backspaceAtFrontOfId(e){if(this.getExpressionById(e).latex!==""||this.getNumberOfExpressions()===1)return;let i=this.getExpressionIndex(e);this.store.shallowMutate("order",n=>{n.splice(i,1)}),this.store.shallowMutate("expressions",n=>{delete n[e]}),this._updateIndexes(),this._setFocusedByIndex(Math.max(i-1,0),!0)}setLatexById(e,r){this.store.set(["expressions",e,"latex"],r),this.store.set(["expressions",e,"braille"],""),r===""&&this.setFractionEvaluation(e,!1),this._evaluate()}setLatexAndBrailleById(e,r,i){this.store.set(["expressions",e,"latex"],r),this.store.set(["expressions",e,"braille"],i),r===""&&this.setFractionEvaluation(e,!1),this._evaluate()}setFractionEvaluation(e,r){this.store.set(["expressions",e,"displayAsFraction"],r)}setLatexOfFocusedExpression(e){let r=this.getFocusedExpressionId();r&&this.setLatexById(r,e)}isExpressionFocused(e){return this.getFocusedExpressionId()===e}getExpressionLatex(e){return this.getExpressionById(e).latex}getExpressionError(e){let r=this._evaluations[e];return r?r.error:""}getExpressionValue(e){let r=this._evaluations[e];if(r)return r.value}getExpressionAns(e){let r=this._evaluations[e];if(r)return r.ans}getExpressionAnsId(e){let r=this._evaluations[e];if(r)return r.ansId}shouldShowEvaluationForExpression(e){let r=this._evaluations[e];return r?r.showEvaluation:!1}isRationalizableConstant(e){let r=this._evaluations[e];return r?r.isRationalizableConstant:!1}canDisplayEvaluationAsFraction(e){let r=this.getExpressionValue(e);return r?__dcg_shared_module_exports__['Db'](r):!1}_setFocusedByIndex(e,r){let i=this._getExpressionByIndex(e),n=this.store.getState().ui.focus,o=r?{type:"latex-expression",id:i.id}:void 0;if(!__dcg_shared_module_exports__['F'](n,o)){if(n){let s=n.id;this.store.deepMutate("expressions",a=>{var l=a[s];l&&(l.braille="")})}!r&&this.getFocusedExpressionId()!==i.id||this.store.shallowMutate("ui",s=>{s.focus=o})}}setFocusedById(e,r){let i=this.getExpressionIndex(e);this._setFocusedByIndex(i,r)}focusPrevById(e){let r=this.getExpressionIndex(e)-1;r>=0&&this._setFocusedByIndex(r,!0)}focusNextById(e){let r=this.getExpressionIndex(e)+1;r<this.getNumberOfExpressions()?this._setFocusedByIndex(r,!0):this.createAtEnd()}getFocusedExpression(){let e=this.getFocusedExpressionId();if(e)return this.getExpressionById(e)}getFocusedExpressionId(){let e=this.getState().ui.focus;return e&&e.id}clearFocusedExpression(){let e=this.getFocusedExpression();e&&this.setLatexById(e.id,"")}shouldShowClear(){if(this.getNumberOfExpressions()===1)return!1;let e=this.getFocusedExpression();return!!e&&!!e.latex}getLastExpression(){return this._getExpressionByIndex(this.getNumberOfExpressions()-1)}isLastExpressionEmpty(){return!!this.getLastExpression().latex}createAtEnd(){this.createBlankAfterId(this.getLastExpression().id)}focusLastExpression(){this._setFocusedByIndex(this.getNumberOfExpressions()-1,!0)}focusFirstExpression(){this._setFocusedByIndex(0,!0)}getDegreeMode(){return this.getState().settings.degreeMode}setDegreeMode(e){this.store.set(["settings","degreeMode"],!!e),this._evaluate()}_cleanupLatex(e){return e=__dcg_shared_module_exports__['Kb'](e),e.substr(e.length-1)==="="&&(e=e.substr(0,e.length-1)),e}_evaluate(){this._evaluator.clearStatementsAndStartCompleteState(),this.getExpressionOrder().forEach(e=>this._evaluator.addStatement({id:e,index:this.getExpressionIndex(e),latex:this._cleanupLatex(this.getExpressionLatex(e)),shouldGraph:!1,type:"statement"}))}_setupEvaluator(){this._evaluator=new lp(this.workerPool),this._evaluator.readEvaluatorConfig=()=>({degreeMode:this.getDegreeMode(),evaluationMode:this.evaluationMode,additionalFunctions:this.additionalFunctions,functionDefinition:this.functionDefinition,replaceRoundWithReciprocal:this.replaceRoundWithReciprocal,actions:!1}),this._evaluator.onEvaluatorResults=e=>{let r=e.evaluationStates;this._evaluations={};for(let o in r){let s=r[o];if(!this.getExpressionById(o))continue;let l=s.constant_value;l===void 0&&s.zero_values&&s.zero_values.length&&(l=s.zero_values[0].val);let c=s.hasOwnProperty("constant_value")&&__dcg_shared_module_exports__['Db'](s.constant_value),d=!s.is_evaluable&&c,u=!!s.is_evaluable||d||Array.isArray(l);this._evaluations[o]={error:s.error,ans:void 0,ansId:void 0,value:l,showEvaluation:u,isRationalizableConstant:d}}let i,n;for(let o of this.getExpressionOrder()){let s=this._evaluations[o];if(i&&s){let a=i.value;typeof a=="number"?(s.ans=a,s.ansId=n):Array.isArray(a)&&(s.ans="[...]")}i=s,n=o}typeof this.onEvaluationUpdate=="function"&&this.onEvaluationUpdate()}}reloadState(){this.setState(this.getState())}getFunctionDefinition(){return!!this.functionDefinition}enableFunctionDefinition(){this.functionDefinition=!0,this.reloadState()}disableFunctionDefinition(){this.functionDefinition=!1,this.reloadState()}getReplaceRoundWithReciprocal(){return!!this.replaceRoundWithReciprocal}enableReplaceRoundWithReciprocal(){this.replaceRoundWithReciprocal=!0,this.reloadState()}disableReplaceRoundWithReciprocal(){this.replaceRoundWithReciprocal=!1,this.reloadState()}};Wl();ql();var Zw=class{constructor(e,r){this.keyboardMode="main";this.fontSize=16;this.invertedColors=!1;this.backgroundColor="";this.textColor="";this.projectorMode=!1;this.capExpressionSize=!1;this.decimalToFraction=!0;this.settingsMenu=!0;this.settingsMenuOpen=!1;this.language="en";this.brailleMode="none";this.sixKeyInput=!1;this.brailleControls=!0;this.brailleExpressionDownload=!0;this.replaceCommaWith10Exp=!1;this.typingAsteriskWritesTimesSymbol=!1;this.stateStack=new Xd;this.dispatcher=new sd;this.s=zl(()=>this.language);this.dispatch=e=>{Rp("dispatch",{type:e.type}),this.dispatcher.dispatch(e);let r;for(;r=this._queuedCallbacks.shift();)r()};this._queuedCallbacks=[];this.stateStack=new Xd,this.dispatcher=new sd,this.options=e,this.model=new Qw({evaluationMode:this.options.evaluationMode,additionalFunctions:this.options.additionalFunctions,functionDefinition:this.options.functionDefinition,replaceRoundWithReciprocal:this.options.replaceRoundWithReciprocal,workerPool:r.workerPool}),this.model=this.model,this.model.setDegreeMode(e.degreeMode),this.setLanguage(e.language),this.setBrailleMode(e.brailleMode),this.setSixKeyInput(e.sixKeyInput),this.setBrailleControls(e.brailleControls),this.setBrailleExpressionDownload(e.brailleExpressionDownload),this.setReplaceCommaWith10Exp(e.replaceCommaWith10Exp),this.setReplaceRoundWithReciprocal(e.replaceRoundWithReciprocal),this.setTypingAsteriskWritesTimesSymbol(e.typingAsteriskWritesTimesSymbol),this.setProjectorMode(e.projectorMode),this.setCapExpressionSize(e.capExpressionSize),this.setDecimalToFraction(e.decimalToFraction),this.invertedColors=e.invertedColors,this.backgroundColor=e.backgroundColor,this.textColor=e.textColor,this.settingsMenu=e.settingsMenu,this.model.onEvaluationUpdate=()=>this.dispatch({type:"render"}),this.settingsProxy=r.settingsProxy,this.syncPublicSettings(),this.hookUpDispatcher(),this.containerSize={width:0,height:0}}runAfterDispatch(e){this._queuedCallbacks.push(e)}enqueueEvent(e){this.runAfterDispatch(()=>{this.onEventEmitted&&this.onEventEmitted(e)})}getFunctionDefinition(){return this.options.functionDefinition}getSettingsMenu(){return this.settingsMenu}getBrailleMode(){return this.brailleMode}renderAsBraille(){return this.brailleMode!=="none"}setBrailleMode(e){this.brailleMode=e}getSixKeyInput(){return this.sixKeyInput}setSixKeyInput(e){this.sixKeyInput=e}getBrailleControls(){return this.brailleControls}setBrailleControls(e){this.brailleControls=e}getBrailleExpressionDownload(){return this.brailleExpressionDownload}setBrailleExpressionDownload(e){this.brailleExpressionDownload=e}getRestrictedEditing(){return this.options.restrictedEditing}getKeyboardMode(){return this.keyboardMode}getFontSize(){return this.fontSize}getInvertedColors(){return this.invertedColors}hasBackgroundColor(){return this.getBackgroundColor()!=="#ffffff"}getBackgroundColor(){let e=__dcg_shared_module_exports__['P'](this.backgroundColor||"#fff");return this.getInvertedColors()&&e!=="#ffffff"?__dcg_shared_module_exports__['S'](e):e}getTextColor(){let e=__dcg_shared_module_exports__['P'](this.textColor||"#000");return this.getInvertedColors()&&e!=="#000000"?__dcg_shared_module_exports__['S'](e):e}getAdditionalFunctions(){return this.options.additionalFunctions}getTypingSlashWritesDivisionSymbol(){return this.options.typingSlashWritesDivisionSymbol}setTypingAsteriskWritesTimesSymbol(e){this.typingAsteriskWritesTimesSymbol=e}getTypingAsteriskWritesTimesSymbol(){return this.typingAsteriskWritesTimesSymbol}setProjectorMode(e){this.projectorMode=e}isProjectorMode(){return this.projectorMode}getReplaceCommaWith10Exp(){return this.replaceCommaWith10Exp}setReplaceCommaWith10Exp(e){this.replaceCommaWith10Exp=e}getReplaceRoundWithReciprocal(){return this.model.getReplaceRoundWithReciprocal()}setReplaceRoundWithReciprocal(e){e?this.model.enableReplaceRoundWithReciprocal():this.model.disableReplaceRoundWithReciprocal()}setCapExpressionSize(e){this.capExpressionSize=e}getCapExpressionSize(){return this.capExpressionSize}setDecimalToFraction(e){this.decimalToFraction=e}setLanguage(e){e!=="en"&&Desmos.supportedLanguages.indexOf(e)===-1?__dcg_shared_module_exports__['M'].warn(`Translation for '${e}' isn't currently available. Using '${this.language}' instead.`):this.language=e}getLanguage(){return this.language}getDecimalToFraction(){return this.decimalToFraction}isScientificCalc(){let e=this.options.evaluationMode;return e==="scientific"||e==="singleExpressionScientific"}isFourFunctionCalc(){return this.options.evaluationMode==="fourFunction"||this.options.evaluationMode==="singleExpressionFourFunction"}getAllowLinks(){return this.options.links}canUndo(){return this.stateStack.canUndo()}canRedo(){return this.stateStack.canRedo()}undo(e){if(!this.canUndo())return;this.stateStack.undo();let r=this.stateStack.getState();if(!e.restoreFocus){let i={focus:void 0};r=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},r),{ui:i})}this.model.setState(r),this.enqueueEvent("change")}redo(e){if(!this.canRedo())return;this.stateStack.redo();let r=this.stateStack.getState();if(!e.restoreFocus){let i={focus:void 0};r=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},r),{ui:i})}this.model.setState(r),this.enqueueEvent("change")}clearHistory(){this.stateStack.clear()}canBackspace(){let e=this.model.getFocusedExpression();return e&&(e.latex.length>0||this.model.getNumberOfExpressions()>1)}focusLastExpression(){this.model.focusLastExpression()}shouldRender(){return this.containerSize.width>0&&this.containerSize.height>0}canClear(){return this.model.canClear()}shouldShowClear(){return this.model.shouldShowClear()}enableSettingsMenu(){this.settingsMenu=!0}disableSettingsMenu(){this.closeSettingsMenu(),this.settingsMenu=!1}closeSettingsMenu(){this.settingsMenuOpen=!1}toggleSettingsMenu(){this.settingsMenuOpen=!this.settingsMenuOpen}isSettingsMenuOpen(){return this.settingsMenuOpen}isLastExpressionEmpty(){return this.model.isLastExpressionEmpty()}createAtEnd(){this.model.createAtEnd()}clearFocusedExpression(){this.model.clearFocusedExpression()}setLatexById(e,r){this.model.setLatexById(e,r)}setLatexAndBrailleById(e,r,i){this.model.setLatexAndBrailleById(e,r,i)}setLatexOfFocusedExpression(e){this.model.setLatexOfFocusedExpression(e)}toggleFractionEvaluationById(e){this.model.setFractionEvaluation(e,!this.model.getExpressionById(e).displayAsFraction)}conditionallyCopyPrevious(e){this.model.conditionallyCopyPrevious(e)}createBlankAfterId(e){this.model.createBlankAfterId(e)}backspaceAtFrontOfId(e){this.model.backspaceAtFrontOfId(e)}areStatesDifferentEnoughForUndoRedo(e,r){let i={focus:void 0};return __dcg_shared_module_exports__['F'](__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},e),{ui:i}),__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},r),{ui:i}))}commitUndoRedoDebounced(){let e=this.model.getState(),r=this.stateStack.getState();if(this.areStatesDifferentEnoughForUndoRedo(e,r))return;let i=new Date().getTime();i-this._lastDebouncedTime<1e3?this.stateStack.replaceState(e):this.stateStack.addState(e),this._lastDebouncedTime=i,this.enqueueEvent("change")}commitUndoRedoSynchronously(){let e=this.model.getState(),r=this.stateStack.getState();this.areStatesDifferentEnoughForUndoRedo(e,r)||(this._lastDebouncedTime=0,this.stateStack.addState(e),this.enqueueEvent("change"))}updateKeyboardMode(e){this.keyboardMode=e}getFocusedMathquill(){if(this.model.getFocusedExpressionId())return Xe.getFocusedMathquill()}ensureMathquillIsFocusedAndReturnFocusedMathquill(){let e=this.getFocusedMathquill();return e||(this.isLastExpressionEmpty()&&!this.model.isSingleExpression()?this.createAtEnd():this.focusLastExpression(),this.onEventEmitted&&this.onEventEmitted("render"),this.getFocusedMathquill())}typeIntoFocusedMathquill(e){e=e.replace(/\r|\n/g,"");let r=this.ensureMathquillIsFocusedAndReturnFocusedMathquill();r&&Xe.canAcceptText(r,this.getCapExpressionSize(),e)&&(r.typedText(e),this.setLatexOfFocusedExpression(r.latex()),this.model.markShouldDebounceUndoRedo())}pressKeyInFocusedMathquill(e,r){if(this.getBrailleMode()!=="none")return;let i=this.ensureMathquillIsFocusedAndReturnFocusedMathquill();i&&(e==="Up"||e==="Down"||e==="Left"||e==="Right"?Xe.applyArrowKeyAndReturnIfWasAtBounds(i,e,r)&&this.moveFocusInDirection(e):e==="Enter"?(r&&(r.preventDefault(),r.stopPropagation()),this.handleEnter()):e==="Backspace"?this.attemptToMoveFocusWithBackspace()||(i.keystroke(e,r),this.setLatexOfFocusedExpression(i.latex())):e==="Delete"?(i.keystroke(e,r),this.setLatexOfFocusedExpression(i.latex())):(i.keystroke(e,r),this.setLatexOfFocusedExpression(i.latex())))}moveFocusInDirection(e){let r=this.model.getFocusedExpressionId();r&&(e==="Up"?this.model.focusPrevById(r):e==="Down"&&this.model.focusNextById(r))}handleEnter(){if(this.model.isSingleExpression())return;let e=this.model.getFocusedExpressionId();e&&(this.conditionallyCopyPrevious(e),this.createBlankAfterId(e))}attemptToMoveFocusWithBackspace(){let e=this.model.getFocusedExpression();if(!e)return!1;let{latex:r,id:i}=e;return r===""?(this.backspaceAtFrontOfId(i),!0):!1}executeCommandInFocusedMathquill(e){let r=this.ensureMathquillIsFocusedAndReturnFocusedMathquill();r&&(pm(r,e),this.setLatexOfFocusedExpression(r.latex()))}syncPublicSettings(){this.settingsProxy.setProperty("language",this.language),this.settingsProxy.setProperty("fontSize",this.fontSize),this.settingsProxy.setProperty("degreeMode",this.model.getDegreeMode()),this.settingsProxy.setProperty("invertedColors",this.invertedColors),this.settingsProxy.setProperty("backgroundColor",this.backgroundColor),this.settingsProxy.setProperty("textColor",this.textColor),this.settingsProxy.setProperty("brailleMode",this.brailleMode),this.settingsProxy.setProperty("sixKeyInput",this.sixKeyInput),this.settingsProxy.setProperty("brailleControls",this.brailleControls),this.settingsProxy.setProperty("brailleExpressionDownload",this.brailleExpressionDownload),this.settingsProxy.setProperty("projectorMode",this.projectorMode),this.settingsProxy.setProperty("capExpressionSize",this.capExpressionSize),this.settingsProxy.setProperty("decimalToFraction",this.decimalToFraction),this.settingsProxy.setProperty("qwertyKeyboard",this.options.qwertyKeyboard),this.settingsProxy.setProperty("links",this.options.links),this.settingsProxy.setProperty("settingsMenu",this.settingsMenu),this.settingsProxy.setProperty("functionDefinition",this.model.getFunctionDefinition()),this.settingsProxy.setProperty("replaceCommaWith10Exp",this.replaceCommaWith10Exp),this.settingsProxy.setProperty("replaceRoundWithReciprocal",this.model.getReplaceRoundWithReciprocal()),this.settingsProxy.setProperty("typingAsteriskWritesTimesSymbol",this.typingAsteriskWritesTimesSymbol)}hookUpDispatcher(){this.dispatcher.register(e=>{this.enqueueEvent("render");let r=!1,i=this.getRestrictedEditing();switch(e.type){case"update-options":{this.options=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['b']({},this.options),e.options);break}case"keypad/shift":{let a;switch(this.keyboardMode){case"qwerty":a="capitalQwerty";break;case"capitalQwerty":a="qwerty";break;case"letters":a="capitalLetters";break;case"capitalLetters":a="letters";break;default:a="qwerty"}this.updateKeyboardMode(a)}break;case"undo":i||(this.undo({restoreFocus:e.source==="keyboard-shortcut"}),r=!0);break;case"redo":i||(this.redo({restoreFocus:e.source==="keyboard-shortcut"}),r=!0);break;case"clear-history":this.clearHistory();break;case"set-state-from-api":e.opts.allowUndo||this.clearHistory(),this.model.setStateFromAPI(e.state);break;case"main":this.updateKeyboardMode("main");break;case"ABC":this.options.qwertyKeyboard?this.updateKeyboardMode("qwerty"):this.updateKeyboardMode("letters");break;case"functions":this.updateKeyboardMode("functions");break;case"degrees":this.model.setDegreeMode(!this.model.getDegreeMode());break;case"update-degree-mode":this.model.setDegreeMode(!!e.mode);break;case"update-font-size":var n=e.size;if(typeof n!="number"&&(n=parseInt(n,10)),isNaN(n))return;this.fontSize=n;break;case"update-inverted-colors":this.invertedColors=!!e.mode;break;case"update-background-color":this.backgroundColor=e.color;break;case"update-text-color":this.textColor=e.color;break;case"update-projector-mode":this.setProjectorMode(!!e.mode);break;case"update-cap-expression-size":this.setCapExpressionSize(!!e.mode);break;case"update-decimal-to-fraction":this.setDecimalToFraction(!!e.mode);break;case"update-language":this.setLanguage(e.language);break;case"set-blank":e.opts.allowUndo||this.clearHistory(),this.model.clear(),this.focusLastExpression();break;case"clear":this.model.clearFocusedExpression();break;case"set-braille-mode":let o=e.mode;o!=="nemeth"&&o!=="ueb"&&o!=="none"?__dcg_shared_module_exports__['M'].warn(`Valid Braille modes are 'nemeth', 'none', and 'ueb'. You passed '${o}'.`):(this.model.clearCachedBrailleValues(),this.setBrailleMode(e.mode));break;case"set-six-key-input":this.setSixKeyInput(!!e.mode);break;case"set-braille-controls":this.setBrailleControls(!!e.value);break;case"set-braille-expression-download":this.setBrailleExpressionDownload(!!e.mode);break;case"set-replace-comma-with-10-exp":this.setReplaceCommaWith10Exp(!!e.replace);break;case"set-replace-round-with-reciprocal":this.setReplaceRoundWithReciprocal(!!e.replace);break;case"set-typing-asterisk-writes-times-symbol":this.setTypingAsteriskWritesTimesSymbol(!!e.mode);break;case"update-latex":this.model.markShouldDebounceUndoRedo(),this.setLatexById(e.id,e.latex);break;case"update-latex-from-braille":this.model.markShouldDebounceUndoRedo(),this.setLatexAndBrailleById(e.id,e.latex,e.braille);break;case"focusin":this.model.setFocusedById(e.id,!0);break;case"focusout":this.model.setFocusedById(e.id,!1);break;case"focus-first-expression":this.model.focusFirstExpression();break;case"focus-prev-expression":this.moveFocusInDirection("Up");break;case"focus-next-expression":this.moveFocusInDirection("Down");break;case"focus-last-expression":this.model.focusLastExpression();break;case"insert-blank-expression":this.handleEnter();break;case"backspace-from-braille":this.attemptToMoveFocusWithBackspace();break;case"keypad/type-text":this.typeIntoFocusedMathquill(e.text);break;case"keypad/press-key":this.pressKeyInFocusedMathquill(e.key,e.evt);break;case"keypad/custom-command":this.executeCommandInFocusedMathquill(e.command);break;case"keypad/123":case"keypad/abc":case"keypad/audio-trace":break;case"enable-settings-menu":this.enableSettingsMenu();break;case"disable-settings-menu":this.disableSettingsMenu();break;case"toggle-settings-menu":this.toggleSettingsMenu();break;case"close-settings-menu":this.closeSettingsMenu();break;case"render":break;case"ui/container-resized":this.containerSize=e.size;break;case"toggle-fraction-evaluation":this.toggleFractionEvaluationById(e.id);break;default:return e}this.runAfterDispatch(()=>this.syncPublicSettings()),r||(this.model.getShouldDebounceUndoRedo()?(this.commitUndoRedoDebounced(),this.model.clearShouldDebounceUndoRedo()):this.commitUndoRedoSynchronously())})}getMathquillConfig(){let e=this.getAdditionalFunctions(),r=this.isFourFunctionCalc()&&(!e||e.indexOf("fraction")===-1);return{typingAsteriskWritesTimesSymbol:this.getTypingAsteriskWritesTimesSymbol(),typingSlashWritesDivisionSymbol:this.getTypingSlashWritesDivisionSymbol(),disableCopyPaste:this.getRestrictedEditing(),autoCommands:Kc({disallowFrac:r}),autoOperatorNames:da(),logAriaAlerts:!!oo().logAria}}};var br=__dcg_shared_module_exports__['i'](Z());var NK=__dcg_shared_module_exports__['i'](Z()),pr=class extends NK.Class{init(){this.controller=this.props.controller(),this.model=this.controller.model,this.dispatch=this.controller.dispatch,this.s=this.controller.s}};Oe();var nn=__dcg_shared_module_exports__['i'](Z());var Du=__dcg_shared_module_exports__['i'](Z());var tl=class extends sh{template(){return Du.createElement("div",{class:Du.const("dcg-keypad-control-bar dcg-do-not-blur"),role:Du.const("group"),"aria-label":()=>this.controller.s("shared-calculator-narration-keypad-controlbar")},Du.createElement("div",{class:Du.const("dcg-keypad-control-bar-contents")},this.children))}};var rf=__dcg_shared_module_exports__['i'](Z()),ai=class extends rf.Class{template(){return rf.createElement("div",{class:()=>({"dcg-keypad-control-btn":!0,"dcg-disabled":this.isDisabled(),"dcg-selected":!this.isDisabled()&&this.isSelected(),"dcg-selectable-btn":!this.isDisabled()&&this.isSelectable(),"dcg-narrow-control-btn":this.props.narrowButton&&this.props.narrowButton()}),didMount:this.bindFn(this.didMount),role:rf.const("button"),"aria-disabled":()=>this.isDisabled()||void 0,"aria-label":()=>this.getAriaLabel(),"dcg-command":this.props.command,onTap:this.bindFn(this.handleTap),"aria-pressed":()=>!this.hasPopup()&&!this.isDisabled()&&this.isSelectable()?this.isSelected():void 0,"aria-expanded":()=>this.hasPopup()&&!this.isDisabled()?this.isSelected():void 0,tabindex:this.bindFn(this.getTabIndex)},this.children)}getTabIndex(){if(!this.isDisabled())return this.props.ignoreInTabOrder&&this.props.ignoreInTabOrder()?-1:0}handleTap(e){this.isDisabled()||this.props.onTap(e)}getAriaLabel(){return this.props.ariaLabel?this.props.ariaLabel():this.props.command()}hasPopup(){return this.props.ariaPopup?this.props.ariaPopup():!1}isDisabled(){return this.props.disabled?this.props.disabled():!1}isSelected(){return this.props.selected?this.props.selected():!1}isSelectable(){return this.props.selectable?this.props.selectable():!1}didMount(e){this.props.didMount&&this.props.didMount(e)}};var Il=__dcg_shared_module_exports__['i'](Z());var Dr=__dcg_shared_module_exports__['i'](Z());Oe();var gd=__dcg_shared_module_exports__['i'](Z());function DJ(){if(!VL)return!1;let t=navigator.userAgent.match(/Version\/(\d+)/);return!t||!t[1]?!1:parseFloat(t[1])<11}function BK(){return!IL&&!DJ()&&typeof document.createElement("a").download!="undefined"}function Lk(){return BK()||navigator.msSaveBlob!==void 0}var hh=class extends gd.Class{init(){this.supportsDirectDownload=BK()}template(){return gd.createElement("a",{role:gd.const("button"),tabindex:()=>this.props.enabled()?0:-1,"aria-disabled":()=>!this.props.enabled(),class:()=>({"dcg-download-button":!0,"dcg-disabled":!this.props.enabled(),"dcg-braille-equations":this.props.isBraille,"dcg-svg-button":this.props.isSvg}),didMount:this.bindFn(this.didMountDownload),didUnmount:this.bindFn(this.didUnmountDownload),didUpdate:this.bindFn(this.didUpdate),download:()=>this.supportsDirectDownload?this.props.filename():void 0,onTap:e=>{if(this.supportsDirectDownload||!navigator.msSaveOrOpenBlob)return;let r=this.props.data();r&&(navigator.msSaveOrOpenBlob(r,this.props.filename()),e.preventDefault())}},gd.createElement("i",{class:gd.const("dcg-icon-download"),"aria-hidden":gd.const("true")}),gd.createElement("span",null,()=>this.props.text()))}didMountDownload(e){this.downloadLink=e,this.didUpdate()}didUnmountDownload(){this.revokeBlobURL()}didUpdate(){this.updateDownloadURL(),this.cachedObjectURL&&(this.downloadLink.href=this.cachedObjectURL)}updateDownloadURL(){if(this.revokeBlobURL(),!this.supportsDirectDownload)return;let e=this.props.data();e&&(this.cachedObjectURL=URL.createObjectURL(e))}revokeBlobURL(){this.cachedObjectURL&&URL.revokeObjectURL(this.cachedObjectURL)}};var nf=__dcg_shared_module_exports__['i'](ep());function vn(t,e,r=!1){if(r&&(t=t.replace(/ /g,"\\ ")),e==="none")return t;let i=e==="nemeth"?nf.latexToNemeth(t):nf.latexToUeb(t);return i.isError?"":nf.UnicodeBraille.toBrailleAscii(i.value)}function KK(t,e){if(e==="none")return"";let r=[];r.push(vn("Expression List",e,!0)),r.push(""),r.push("");let i="",n=t.getItemCount();for(let o=0;o<n;o++){let s=t.getItemModelByIndex(o);if(s&&!s.secret){i!==""&&s.type!=="folder"&&i!==s.folderId&&(r.push(ex(vn("End Folder",e,!0))),i="");let a="";switch(s.type){case"expression":if(!s.hidden){let c=qK(s.displayIndex,e);a=s.latex;let d=[],u=s.formula;if(u&&!ua(s)){if(t.shouldShowEvaluationForItem(s.id)){let p=u.zero_values&&u.zero_values.length?u.zero_values[0].val:u.constant_value;Array.isArray(p)?a+=`\\ ${p.length}\\ element\\ list`:a+=`=${p}`}else if(zc(s))d.push(vn(`Min=${xy(s)}`,e,!1)),d.push(vn(`Max=${vy(s)}`,e,!1)),Dy(s)&&Cy(s)&&d.push(vn(`CDF=${rC(s)}`,e,!1));else if(Yv(s)){let p=cg(s);p&&(d.push(vn(`<${__dcg_shared_module_exports__['mc'](p.lessThan,5)}`,e,!1)),d.push(vn(`>${__dcg_shared_module_exports__['mc'](p.greaterThan,5)}`,e,!1)),d.push(vn(`\\ne${__dcg_shared_module_exports__['mc'](p.notEqual,5)}`,e,!1)))}else if(u.is_regression&&u.regression){let p=u.regression,g=p.statistics,b=p.parameters;g.hasOwnProperty("Rsquared")&&d.push(vn(`R^2=${Ya(p,"Rsquared")}`,e,!1)),g.hasOwnProperty("rsquared")&&d.push(vn(`r^2=${Ya(p,"rsquared")}`,e,!1)),g.hasOwnProperty("r")&&d.push(vn(`r=${Ya(p,"r")}`,e,!1)),g.hasOwnProperty("RMSE")&&d.push(vn(`\\operatorname{RMSE}=${Ya(p,"RMSE")}`,e,!1));for(let x in b)d.push(vn(`${x}=${nS(p,x)}`,e,!1))}}r.push(`${c}  ${vn(a,e,!1)}`),r.push.apply(r,d)}break;case"text":r.push(vn(s.text,e,!0));break;case"folder":s.collapsed?a=`Collapsed Folder ${s.title}`:(a=`Start Folder ${s.title}`,i=s.id),r.push(ex(vn(a,e,!0)));break;case"image":r.push(vn("Image",e,!1));break;case"table":r.push(ex(vn("Start Table",e,!0)));for(let c=0;c<Us(s);c++){let d=[],u;for(let g=0;g<KC(s);g++)c===0?u=s.columnModels[g].latex||"":u=Ty(s,c-1,g),d.push(vn(u,e));let p=d.join("	");/^\t/.test(p)||r.push(p)}r.push(ex(vn("End Table",e,!0)));break;default:return s}}}return i!==""&&r.push(ex(vn("End Folder",e,!0))),r.join(`
`)}function UK(t,e){if(e==="none")return"";let r=[];r.push(vn("Expression List",e,!0)),r.push(""),r.push("");for(let i of t.getExpressionOrder()){let n=qK(t.getExpressionIndex(i)+1,e),o=t.getExpressionLatex(i),s=t.getExpressionValue(i);s!==void 0&&(o+=`=${s}`),r.push(`${n}  ${vn(o,e,!1)}`)}return r.join(`
`)}function ex(t){let e="--------------------";return`${e}
${t}
${e}`}function qK(t,e){let r=""+t;return e==="nemeth"?`${vn(r,e,!1)}_4`:e==="ueb"?vn(`${r}.`,e,!1):""}var{If:Pk}=Dr.Components,Ok=class extends pr{template(){return Dr.createElement("div",{class:()=>({"dcg-settings-dropdown":!0,"dcg-popover":!0,"dcg-has-background-color":this.controller.hasBackgroundColor(),"dcg-point-left":this.controller.containerSize.height<=420}),role:Dr.const("complementary"),"aria-label":Dr.const("Settings Menu"),didMount:this.bindFn(this.didMountSettingsDropdown),didUnmount:this.bindFn(this.didUnmountSettingsDropdown)},Dr.createElement("div",{class:Dr.const("dcg-popover-interior"),style:()=>({background:this.controller.getBackgroundColor()})},Dr.createElement("div",{class:()=>({"dcg-settings-menu-option":!0,"dcg-displaysize-container":!0})},Dr.createElement(jr,{ariaGroupLabel:()=>this.controller.s("shared-calculator-narration-settings-display-size"),staticConfig:this.bindFn(this.getProjectorModeOptions)})),Dr.createElement(Dt,{onChange:this.bindFn(this.onToggleInvertedColors),checked:()=>this.controller.getInvertedColors(),class:this.const("dcg-settings-menu-option dcg-do-not-blur dcg-reverse-contrast")},Dr.createElement("span",{class:Dr.const("dcg-checkbox-label")},()=>this.controller.s("basic-calculator-label-reverse-contrast"))),Dr.createElement(Pk,{predicate:()=>this.controller.getBrailleControls()},()=>Dr.createElement("div",null,Dr.createElement(Dt,{onChange:this.bindFn(this.onToggleBrailleMode),checked:()=>this.controller.renderAsBraille(),class:this.const("dcg-settings-menu-option dcg-do-not-blur dcg-braille-mode")},Dr.createElement("span",{class:Dr.const("dcg-checkbox-label")},()=>this.controller.s("shared-calculator-narration-braille-mode"))),Dr.createElement(Pk,{predicate:()=>this.controller.renderAsBraille()},()=>Dr.createElement("div",{class:()=>({"dcg-settings-menu-option":!0,"dcg-braille-container":!0})},Dr.createElement(jr,{ariaGroupLabel:()=>this.controller.s("shared-calculator-narration-braille-mode"),staticConfig:this.bindFn(this.getBrailleOptions)}),Dr.createElement("div",{class:Dr.const("dcg-braille-options-container")},Dr.createElement(Dt,{onChange:()=>this.onToggleSixKeyInput(),checked:()=>this.controller.getSixKeyInput(),class:this.const("dcg-settings-menu-option dcg-do-not-blur dcg-six-key-checkbox")},Dr.createElement("span",{class:Dr.const("dcg-checkbox-label")},()=>this.controller.s("basic-calculator-label-six-key-input"))),Dr.createElement("a",{href:Dr.const("https://www.desmos.com/accessibility#braille"),class:Dr.const("dcg-six-key-info"),target:Dr.const("_blank")},Dr.createElement("i",{class:Dr.const("dcg-icon-question-sign"),"aria-hidden":Dr.const("true")})),Dr.createElement(Pk,{predicate:()=>!al&&Lk()&&this.controller.getBrailleExpressionDownload()},()=>Dr.createElement(hh,{data:()=>{let e=UK(this.model,this.controller.getBrailleMode());return new Blob([e],{type:"text/plain"})},enabled:this.const(!0),filename:this.const("desmos-equations.brl"),text:()=>this.controller.s("basic-calculator-link-download-braille-equations"),isBraille:this.const(!0)}))))))),Dr.createElement(Pk,{predicate:()=>!!this.getVersionNumber()},()=>Dr.createElement("div",{class:Dr.const("dcg-version-number")},Dr.const("Version: "),()=>this.getVersionNumber()))))}getBrailleOptions(){return[{key:"nemeth",label:()=>this.controller.s("shared-calculator-button-braille-mode-nemeth"),selected:()=>this.isNemeth(),onSelect:()=>this.setBrailleMode("nemeth")},{key:"ueb",label:()=>this.controller.s("shared-calculator-button-braille-mode-ueb"),selected:()=>!this.isNemeth(),onSelect:()=>this.setBrailleMode("ueb")}]}setBrailleMode(e){this.controller.dispatch({type:"set-braille-mode",mode:e})}getProjectorModeOptions(){return[{key:"default",label:()=>"A",ariaLabel:()=>this.controller.s("shared-calculator-narration-settings-display-size-default"),class:()=>"dcg-displaysize-default",selected:()=>!this.getProjectorMode(),onSelect:()=>this.onSelectProjectorModeOption(!1)},{key:"large",label:()=>"A",ariaLabel:()=>this.controller.s("shared-calculator-narration-settings-display-size-large"),class:()=>"dcg-displaysize-large",selected:()=>this.getProjectorMode(),onSelect:()=>this.onSelectProjectorModeOption(!0)}]}onSelectProjectorModeOption(e){this.controller.dispatch({type:"update-projector-mode",mode:e})}getVersionNumber(){let e=window;if(e&&e.AppBridge)return e.AppBridge.versionNumber}didUnmountSettingsDropdown(){I(document).off(".dcg-settings-view")}didMountSettingsDropdown(e){this.settingsGroupNode=e,I(document).on("dcg-tapstart.dcg-settings-view",r=>{I(r.target).closest(".dcg-basic-settings-container").length===0&&this.controller.dispatch({type:"close-settings-menu"})}),I(document).on("keydown.dcg-settings-view",r=>{if(Te(r)==="Esc"&&(this.controller.dispatch({type:"close-settings-menu"}),this.controller.dispatch({type:"focus-last-expression"})),Te(r)==="Tab"&&!r.altKey&&!r.metaKey&&!r.ctrlKey){let i=document.activeElement,n=I(this.props.settingsButtonNode()),o=I(this.settingsGroupNode).find(".dcg-settings-menu-option:last");!r.shiftKey&&i===o[0]?(n.trigger("focus"),r.preventDefault(),r.stopPropagation()):r.shiftKey&&i===n[0]&&(o.trigger("focus"),r.preventDefault(),r.stopPropagation())}})}onToggleBrailleMode(){this.controller.dispatch({type:"set-braille-mode",mode:this.controller.renderAsBraille()?"none":"nemeth"})}isNemeth(){return this.controller.getBrailleMode()==="nemeth"}isUEB(){return this.controller.getBrailleMode()==="ueb"}isLatex(){return this.controller.getBrailleMode()==="none"}onToggleSixKeyInput(){let e=!this.controller.getSixKeyInput();this.controller.dispatch({type:"set-six-key-input",mode:e})}onToggleInvertedColors(){let e=!this.controller.getInvertedColors();this.controller.dispatch({type:"update-inverted-colors",mode:e})}getProjectorMode(){return this.controller.isProjectorMode()}};var{If:SJ}=Il.Components,of=class extends pr{template(){let t=this.props.controller();return Il.createElement("div",{class:Il.const("dcg-basic-settings-container")},Il.createElement(ai,{didMount:e=>this.settingsButtonNode=e,command:this.const("settings"),ariaLabel:()=>t.s("basic-calculator-narration-controlbar-settings"),onTap:this.bindFn(this.onToggleSettingsMenu),selected:()=>this.controller.isSettingsMenuOpen(),ariaPopup:this.const(!0)},Il.createElement("i",{class:Il.const("dcg-icon-wrench"),"aria-hidden":Il.const("true")})),Il.createElement(SJ,{predicate:()=>this.controller.isSettingsMenuOpen()},()=>Il.createElement(Ok,{controller:this.props.controller,settingsButtonNode:()=>this.settingsButtonNode})))}onToggleSettingsMenu(){this.controller.dispatch({type:"toggle-settings-menu"})}};var{If:tx,IfElse:EJ}=nn.Components,_k=class extends pr{template(){let t=this.props.controller();return nn.createElement(tl,{controller:this.props.controller},nn.createElement(tx,{predicate:()=>!this.controller.getRestrictedEditing()},()=>nn.createElement(ai,{command:this.const("undo"),disabled:()=>!t.canUndo(),ariaLabel:()=>t.s("basic-calculator-narration-controlbar-undo"),onTap:e=>t.dispatch({type:"undo",source:e.device==="keyboard"?"button-keyboard":"button-tap"})},nn.createElement("i",{class:nn.const("dcg-icon-undo"),"aria-hidden":nn.const("true")}))),nn.createElement(tx,{predicate:()=>!this.controller.getRestrictedEditing()},()=>nn.createElement(ai,{command:this.const("redo"),disabled:()=>!t.canRedo(),ariaLabel:()=>t.s("basic-calculator-narration-controlbar-redo"),onTap:e=>t.dispatch({type:"redo",source:e.device==="keyboard"?"button-keyboard":"button-tap"})},nn.createElement("i",{class:nn.const("dcg-icon-redo"),"aria-hidden":nn.const("true")}))),EJ(()=>t.shouldShowClear(),{true:()=>nn.createElement(ai,{command:this.const("clear"),ariaLabel:()=>t.s("basic-calculator-narration-controlbar-clear"),onTap:()=>t.dispatch({type:"clear"})},()=>t.s("basic-calculator-button-controlbar-clear")),false:()=>nn.createElement(ai,{command:this.const("clearall"),disabled:()=>!t.canClear(),ariaLabel:()=>t.s("basic-calculator-narration-controlbar-clear-all"),onTap:()=>t.dispatch({type:"set-blank",opts:{allowUndo:!0}})},()=>t.s("basic-calculator-button-controlbar-clear-all"))}),nn.createElement(tx,{predicate:()=>this.controller.getRestrictedEditing()},()=>nn.createElement("div",{class:nn.const("dcg-spacer-2")})),nn.createElement(tx,{predicate:()=>t.getBrailleMode()==="none"},()=>nn.createElement(ai,{command:this.const("backspace"),ariaLabel:()=>t.s("basic-calculator-narration-controlbar-backspace"),disabled:()=>!t.canBackspace(),onTap:()=>t.dispatch({type:"keypad/press-key",key:"Backspace"})},nn.createElement("i",{class:nn.const("dcg-icon-delete"),"aria-hidden":nn.const("true")}))),nn.createElement(tx,{predicate:()=>this.props.controller().getSettingsMenu()},()=>nn.createElement(of,{controller:this.props.controller})))}onToggleSettingsMenu(){this.controller.dispatch({type:"toggle-settings-menu"})}};var On=__dcg_shared_module_exports__['i'](Z());var{If:Fk}=On.Components,Rk=class extends pr{template(){let t=this.props.controller();return On.createElement(tl,{controller:this.props.controller},On.createElement(Fk,{predicate:()=>!this.controller.getRestrictedEditing()},()=>On.createElement(ai,{command:this.const("undo"),disabled:()=>!t.canUndo(),ariaLabel:()=>t.s("basic-calculator-narration-controlbar-undo"),onTap:e=>t.dispatch({type:"undo",source:e.device==="keyboard"?"button-keyboard":"button-tap"})},On.createElement("i",{class:On.const("dcg-icon-undo"),"aria-hidden":On.const("true")}))),On.createElement(Fk,{predicate:()=>!this.controller.getRestrictedEditing()},()=>On.createElement(ai,{command:this.const("redo"),disabled:()=>!t.canRedo(),ariaLabel:()=>t.s("basic-calculator-narration-controlbar-redo"),onTap:e=>t.dispatch({type:"redo",source:e.device==="keyboard"?"button-keyboard":"button-tap"})},On.createElement("i",{class:On.const("dcg-icon-redo"),"aria-hidden":On.const("true")}))),On.createElement(ai,{command:this.const("clear"),ariaLabel:()=>t.s("basic-calculator-narration-controlbar-clear"),onTap:()=>t.dispatch({type:"clear"})},()=>t.s("basic-calculator-button-controlbar-clear")),On.createElement(Fk,{predicate:()=>this.controller.getRestrictedEditing()},()=>On.createElement("div",{class:On.const("dcg-spacer-2")})),On.createElement(Fk,{predicate:()=>t.getBrailleMode()==="none"},()=>On.createElement(ai,{command:this.const("backspace"),ariaLabel:()=>t.s("basic-calculator-narration-controlbar-backspace"),disabled:()=>!t.canBackspace(),onTap:()=>t.dispatch({type:"keypad/press-key",key:"Backspace"})},On.createElement("i",{class:On.const("dcg-icon-delete"),"aria-hidden":On.const("true")}))))}};var Hn=__dcg_shared_module_exports__['i'](Z());var vc=__dcg_shared_module_exports__['i'](Z());var Su=class extends sh{template(){return vc.createElement("div",{class:()=>({"dcg-keypad-control-toggle":!0,"dcg-toggled":this.props.toggled()}),role:vc.const("button"),tabindex:vc.const("0"),"aria-label":this.bindFn(this.getAriaLabel),onTap:this.bindFn(this.handleTap)},vc.createElement("div",{class:vc.const("dcg-ctrl-toggle-option")},this.props.defaultOption),vc.createElement("div",{class:vc.const("dcg-ctrl-toggle-option")},this.props.toggledOption),vc.createElement("div",{class:vc.const("dcg-ctrl-toggle-cover"),style:()=>({background:__dcg_shared_module_exports__['R'](this.controller.getBackgroundColor(),-.1)})}))}getAriaLabel(){let e={toggled:this.props.toggledAriaLabel(),default:this.props.defaultAriaLabel()};return this.props.toggled()?this.controller.s("shared-calculator-narration-control-toggle-switch-to-default",e):this.controller.s("shared-calculator-narration-control-toggle-switch-to-toggled",e)}handleTap(){this.props.toggled()?me(this.props.defaultAriaLabel()):me(this.props.toggledAriaLabel()),this.props.onTap(this.props.command())}};var{If:G0,IfElse:kJ}=Hn.Components,Nk=class extends pr{template(){let t=this.props.controller();return Hn.createElement(tl,{controller:this.props.controller},Hn.createElement(ai,{command:this.const("main"),selected:()=>t.getKeyboardMode()==="main",disabled:()=>this.controller.renderAsBraille(),ignoreInTabOrder:this.const(!0),selectable:this.const(!0),onTap:()=>t.dispatch({type:"main"}),ariaLabel:()=>t.s("basic-calculator-narration-controlbar-main")},()=>t.s("basic-calculator-button-controlbar-main")),Hn.createElement(ai,{command:this.const("ABC"),selected:()=>["qwerty","capitalQwerty","letters"].indexOf(t.getKeyboardMode())!==-1,disabled:()=>this.controller.renderAsBraille(),ignoreInTabOrder:this.const(!0),selectable:this.const(!0),ariaLabel:()=>t.s("basic-calculator-narration-controlbar-abc"),onTap:()=>t.dispatch({type:"ABC"})},()=>t.s("basic-calculator-button-controlbar-abc")),Hn.createElement(ai,{command:this.const("functions"),selected:()=>["functions","restrictedFunctions"].indexOf(t.getKeyboardMode())!==-1,ariaLabel:()=>t.s("basic-calculator-narration-controlbar-functions"),disabled:()=>this.controller.renderAsBraille(),ignoreInTabOrder:this.const(!0),selectable:this.const(!0),onTap:()=>t.dispatch({type:"functions"})},()=>t.s("basic-calculator-button-controlbar-func")),Hn.createElement(Su,{command:this.const("degrees"),toggled:()=>this.model.getDegreeMode(),defaultOption:()=>t.s("basic-calculator-label-controlbar-rad"),toggledOption:()=>t.s("basic-calculator-label-controlbar-deg"),defaultAriaLabel:()=>t.s("basic-calculator-narration-controlbar-radians"),toggledAriaLabel:()=>t.s("basic-calculator-narration-controlbar-degrees"),onTap:()=>t.dispatch({type:"degrees"}),controller:this.props.controller}),Hn.createElement(G0,{predicate:()=>!this.controller.getRestrictedEditing()},()=>Hn.createElement(ai,{command:this.const("undo"),disabled:()=>!t.canUndo(),ariaLabel:()=>t.s("basic-calculator-narration-controlbar-undo"),onTap:e=>t.dispatch({type:"undo",source:e.device==="keyboard"?"button-keyboard":"button-tap"})},Hn.createElement("i",{class:Hn.const("dcg-icon-undo"),"aria-hidden":Hn.const("true")}))),Hn.createElement(G0,{predicate:()=>!this.controller.getRestrictedEditing()},()=>Hn.createElement(ai,{command:this.const("redo"),disabled:()=>!t.canRedo(),ariaLabel:()=>t.s("basic-calculator-narration-controlbar-redo"),onTap:e=>t.dispatch({type:"redo",source:e.device==="keyboard"?"button-keyboard":"button-tap"})},Hn.createElement("i",{class:Hn.const("dcg-icon-redo"),"aria-hidden":Hn.const("true")}))),kJ(()=>t.shouldShowClear(),{true:()=>Hn.createElement(ai,{command:this.const("clear"),ariaLabel:()=>t.s("basic-calculator-narration-controlbar-clear"),onTap:()=>t.dispatch({type:"clear"})},()=>t.s("basic-calculator-button-controlbar-clear")),false:()=>Hn.createElement(ai,{command:this.const("clearall"),disabled:()=>!t.canClear(),ariaLabel:()=>t.s("basic-calculator-narration-controlbar-clear-all"),onTap:()=>t.dispatch({type:"set-blank",opts:{allowUndo:!0}})},()=>t.s("basic-calculator-button-controlbar-clear-all"))}),Hn.createElement(G0,{predicate:()=>this.props.controller().getSettingsMenu()},()=>Hn.createElement(of,{controller:this.props.controller})))}};var Cn=__dcg_shared_module_exports__['i'](Z());var{If:zK}=Cn.Components,Bk=class extends pr{template(){let t=this.props.controller();return Cn.createElement(tl,{controller:this.props.controller},Cn.createElement(Su,{command:this.const("degrees"),toggled:()=>this.model.getDegreeMode(),defaultOption:()=>t.s("basic-calculator-label-controlbar-rad"),toggledOption:()=>t.s("basic-calculator-label-controlbar-deg"),defaultAriaLabel:()=>t.s("basic-calculator-narration-controlbar-radians"),toggledAriaLabel:()=>t.s("basic-calculator-narration-controlbar-degrees"),onTap:()=>t.dispatch({type:"degrees"}),controller:this.props.controller}),Cn.createElement("div",{class:Cn.const("dcg-spacer")}),Cn.createElement(zK,{predicate:()=>!this.controller.getRestrictedEditing()},()=>Cn.createElement(ai,{command:this.const("undo"),disabled:()=>!t.canUndo(),ariaLabel:()=>t.s("basic-calculator-narration-controlbar-undo"),onTap:e=>t.dispatch({type:"undo",source:e.device==="keyboard"?"button-keyboard":"button-tap"})},Cn.createElement("i",{class:Cn.const("dcg-icon-undo"),"aria-hidden":Cn.const("true")}))),Cn.createElement(zK,{predicate:()=>!this.controller.getRestrictedEditing()},()=>Cn.createElement(ai,{command:this.const("redo"),disabled:()=>!t.canRedo(),ariaLabel:()=>t.s("basic-calculator-narration-controlbar-redo"),onTap:e=>t.dispatch({type:"redo",source:e.device==="keyboard"?"button-keyboard":"button-tap"})},Cn.createElement("i",{class:Cn.const("dcg-icon-redo"),"aria-hidden":Cn.const("true")}))),Cn.createElement("div",{class:Cn.const("dcg-spacer")}),Cn.createElement(ai,{narrowButton:this.const(!0),command:this.const("clear"),ariaLabel:()=>t.s("basic-calculator-narration-controlbar-clear"),onTap:()=>t.dispatch({type:"clear"})},()=>t.s("basic-calculator-button-controlbar-clear")),Cn.createElement(ai,{narrowButton:this.const(!0),command:this.const("backspace"),ariaLabel:()=>t.s("basic-calculator-narration-controlbar-backspace"),onTap:()=>t.dispatch({type:"keypad/press-key",key:"Backspace"})},Cn.createElement("i",{class:Cn.const("dcg-icon-delete"),"aria-hidden":Cn.const("true")})))}};var md=__dcg_shared_module_exports__['i'](Z());var rx=class extends pr{template(){return md.createElement("div",{role:md.const("group"),"aria-label":()=>this.s("basic-calculator-narration-keypad")},md.createElement(sr,{controller:this.props.controller},md.createElement(Re,null,C(this,"(",{colspan:this.parenColspan()}),C(this,")",{colspan:this.parenColspan()}),this.makeAdditionalFunctionKey(0),this.makeAdditionalFunctionKey(1),C(this,"division")),md.createElement(Re,null,C(this,"7",{style:"highlight"}),C(this,"8",{style:"highlight"}),C(this,"9",{style:"highlight"}),C(this,"multiplication")),md.createElement(Re,null,C(this,"4",{style:"highlight"}),C(this,"5",{style:"highlight"}),C(this,"6",{style:"highlight"}),C(this,"-")),md.createElement(Re,null,C(this,"1",{style:"highlight"}),C(this,"2",{style:"highlight"}),C(this,"3",{style:"highlight"}),C(this,"+")),md.createElement(Re,null,C(this,"0",{style:"highlight"}),C(this,".",{style:"highlight"}),C(this,"ans"),C(this,"enter",{style:"blue"}))))}parenColspan(){return this.controller.getAdditionalFunctions().length>1?.5:1}makeAdditionalFunctionKey(e){let r=this.controller.getAdditionalFunctions()[e];return r==="exponent"?C(this,"a^b"):r==="percent"?C(this,"%"):r==="sqrt"?C(this,"sqrt"):r==="fraction"?C(this,"a/b"):void 0}};var fd=__dcg_shared_module_exports__['i'](Z());var ix=class extends pr{template(){return fd.createElement("div",{role:fd.const("group"),"aria-label":()=>this.s("basic-calculator-narration-keypad")},fd.createElement(sr,{controller:this.props.controller},fd.createElement(Re,null,C(this,"(",{colspan:this.parenColspan()}),C(this,")",{colspan:this.parenColspan()}),this.makeAdditionalFunctionKey(1)),fd.createElement(Re,null,C(this,"7",{style:"highlight"}),C(this,"8",{style:"highlight"}),C(this,"9",{style:"highlight"}),C(this,"division")),fd.createElement(Re,null,C(this,"4",{style:"highlight"}),C(this,"5",{style:"highlight"}),C(this,"6",{style:"highlight"}),C(this,"multiplication")),fd.createElement(Re,null,C(this,"1",{style:"highlight"}),C(this,"2",{style:"highlight"}),C(this,"3",{style:"highlight"}),C(this,"-")),fd.createElement(Re,null,C(this,"0",{style:"highlight"}),C(this,".",{style:"highlight",colspan:this.dotColspan()}),this.makeAdditionalFunctionKey(0),C(this,"+"))))}parenColspan(){return this.controller.getAdditionalFunctions().length===2?1.5:2}dotColspan(){return this.controller.getAdditionalFunctions().length?1:2}makeAdditionalFunctionKey(e){let r=this.controller.getAdditionalFunctions()[e];return r==="exponent"?C(this,"a^b"):r==="percent"?C(this,"%"):r==="sqrt"?C(this,"sqrt"):void 0}};var cs=__dcg_shared_module_exports__['i'](Z());var nx=class extends pr{template(){return cs.createElement(sr,{controller:this.props.controller},cs.createElement(Re,null,C(this,"("),C(this,")"),C(this,"x^2"),C(this,"sqrt"),cs.createElement("div",{class:cs.const("dcg-partition-placeholder")}),C(this,"x^3"),C(this,"x^y"),C(this,"ythroot")),cs.createElement(Re,null,C(this,"7",{style:"highlight"}),C(this,"8",{style:"highlight"}),C(this,"9",{style:"highlight"}),C(this,"division"),cs.createElement("div",{class:cs.const("dcg-partition-placeholder")}),C(this,"pi"),C(this,"e^x"),C(this,"!")),cs.createElement(Re,null,C(this,"4",{style:"highlight"}),C(this,"5",{style:"highlight"}),C(this,"6",{style:"highlight"}),C(this,"multiplication"),cs.createElement("div",{class:cs.const("dcg-partition-placeholder")}),C(this,"log"),C(this,"ln"),C(this,"|x|")),cs.createElement(Re,null,C(this,"1",{style:"highlight"}),C(this,"2",{style:"highlight"}),C(this,"3",{style:"highlight"}),C(this,"-"),cs.createElement("div",{class:cs.const("dcg-partition-placeholder")}),C(this,"sin"),C(this,"cos"),C(this,"tan")),cs.createElement(Re,null,C(this,"0",{style:"highlight"}),C(this,".",{style:"highlight"}),C(this,"x/y"),C(this,"+"),cs.createElement("div",{class:cs.const("dcg-partition-placeholder")}),C(this,"arcsin"),C(this,"arccos"),C(this,"arctan")))}};var Ml=__dcg_shared_module_exports__['i'](Z());var Dn=__dcg_shared_module_exports__['i'](Z());var{IfElse:GJ}=Dn.Components,ox=class extends pr{template(){return Dn.createElement(sr,{controller:this.props.controller},Dn.createElement(Re,null,C(this,"a^2"),C(this,"a^b"),C(this,"|a|"),Dn.createElement("div",{class:Dn.const("dcg-partition-placeholder")}),C(this,"7",{style:"highlight"}),C(this,"8",{style:"highlight"}),C(this,"9",{style:"highlight"}),C(this,"division"),Dn.createElement("div",{class:Dn.const("dcg-partition-placeholder")}),C(this,"%"),C(this,"a/b")),Dn.createElement(Re,null,C(this,"sqrt"),C(this,"nthroot"),C(this,"pi"),Dn.createElement("div",{class:Dn.const("dcg-partition-placeholder")}),C(this,"4",{style:"highlight"}),C(this,"5",{style:"highlight"}),C(this,"6",{style:"highlight"}),C(this,"multiplication"),Dn.createElement("div",{class:Dn.const("dcg-partition-placeholder")}),C(this,"left",{style:"highlight"}),C(this,"right",{style:"highlight"})),Dn.createElement(Re,null,C(this,"sin"),C(this,"cos"),C(this,"tan"),Dn.createElement("div",{class:Dn.const("dcg-partition-placeholder")}),C(this,"1",{style:"highlight"}),C(this,"2",{style:"highlight"}),C(this,"3",{style:"highlight"}),C(this,"-"),Dn.createElement("div",{class:Dn.const("dcg-partition-placeholder")}),Vi(.5),C(this,"backspace",{style:"highlight",colspan:1.5})),Dn.createElement(Re,null,C(this,"("),C(this,")"),GJ(()=>this.controller.getReplaceCommaWith10Exp(),{true:()=>C(this,"10^n"),false:()=>C(this,",")}),Dn.createElement("div",{class:Dn.const("dcg-partition-placeholder")}),C(this,"0",{style:"highlight"}),C(this,".",{style:"highlight"}),C(this,"ans"),C(this,"+"),Dn.createElement("div",{class:Dn.const("dcg-partition-placeholder")}),C(this,"enter",{style:"blue",colspan:2})))}};var Cc=__dcg_shared_module_exports__['i'](Z());var sx=class extends pr{template(){return Cc.createElement(sr,{controller:this.props.controller},Cc.createElement(Re,null,C(this,"q"),C(this,"w"),C(this,"e"),C(this,"r"),C(this,"t"),C(this,"y"),C(this,"u"),C(this,"i"),C(this,"o"),C(this,"p")),Cc.createElement(Re,null,Cc.createElement("div",{class:Cc.const("dcg-half-width-placeholder")}),C(this,"a"),C(this,"s"),C(this,"d"),C(this,"f"),C(this,"g"),C(this,"h"),C(this,"j"),C(this,"k"),C(this,"l"),Cc.createElement("div",{class:Cc.const("dcg-half-width-placeholder")})),Cc.createElement(Re,null,C(this,"=",{style:"highlight"}),C(this,"z"),C(this,"x"),C(this,"c"),C(this,"v"),C(this,"b"),C(this,"n"),C(this,"m"),C(this,","),C(this,"backspace",{style:"highlight"})),Cc.createElement(Re,null,C(this,"shift",{style:"highlight",colspan:1.5}),C(this,"("),C(this,")"),C(this,"["),C(this,"]"),C(this,"!"),C(this,"'"),C(this,"pi"),C(this,"enter",{style:"blue",colspan:1.5})))}};var sf=__dcg_shared_module_exports__['i'](Z());var ax=class extends pr{template(){return sf.createElement(sr,{controller:this.props.controller},sf.createElement(Re,null,C(this,"a"),C(this,"b"),C(this,"c"),C(this,"d"),C(this,"e"),C(this,"f"),C(this,"g"),C(this,"h"),C(this,"i"),C(this,"j")),sf.createElement(Re,null,C(this,"k"),C(this,"l"),C(this,"m"),C(this,"n"),C(this,"o"),C(this,"p"),C(this,"q"),C(this,"r"),C(this,"s"),C(this,"t")),sf.createElement(Re,null,C(this,"=",{style:"highlight"}),C(this,","),C(this,"u"),C(this,"v"),C(this,"w"),C(this,"x"),C(this,"y"),C(this,"z"),C(this,"pi"),C(this,"backspace",{style:"highlight"})),sf.createElement(Re,null,C(this,"shift",{style:"highlight",colspan:2}),C(this,"("),C(this,")"),C(this,"["),C(this,"]"),C(this,"!"),C(this,"'"),C(this,"enter",{style:"blue",colspan:2})))}};var Dc=__dcg_shared_module_exports__['i'](Z());var lx=class extends pr{template(){return Dc.createElement(sr,{controller:this.props.controller},Dc.createElement(Re,null,C(this,"Q"),C(this,"W"),C(this,"E"),C(this,"R"),C(this,"T"),C(this,"Y"),C(this,"U"),C(this,"I"),C(this,"O"),C(this,"P")),Dc.createElement(Re,null,Dc.createElement("div",{class:Dc.const("dcg-half-width-placeholder")}),C(this,"A"),C(this,"S"),C(this,"D"),C(this,"F"),C(this,"G"),C(this,"H"),C(this,"J"),C(this,"K"),C(this,"L"),Dc.createElement("div",{class:Dc.const("dcg-half-width-placeholder")})),Dc.createElement(Re,null,C(this,"=",{style:"highlight"}),C(this,"Z"),C(this,"X"),C(this,"C"),C(this,"V"),C(this,"B"),C(this,"N"),C(this,"M"),C(this,","),C(this,"backspace",{style:"highlight"})),Dc.createElement(Re,null,C(this,"shift",{style:"highlight",colspan:1.5}),C(this,"("),C(this,")"),C(this,"["),C(this,"]"),C(this,"!"),C(this,"'"),C(this,"pi"),C(this,"enter",{style:"blue",colspan:1.5})))}};var af=__dcg_shared_module_exports__['i'](Z());var cx=class extends pr{template(){return af.createElement(sr,{controller:this.props.controller},af.createElement(Re,null,C(this,"A"),C(this,"B"),C(this,"C"),C(this,"D"),C(this,"E"),C(this,"F"),C(this,"G"),C(this,"H"),C(this,"I"),C(this,"J")),af.createElement(Re,null,C(this,"K"),C(this,"L"),C(this,"M"),C(this,"N"),C(this,"O"),C(this,"P"),C(this,"Q"),C(this,"R"),C(this,"S"),C(this,"T")),af.createElement(Re,null,C(this,"=",{style:"highlight"}),C(this,","),C(this,"U"),C(this,"V"),C(this,"W"),C(this,"X"),C(this,"Y"),C(this,"Z"),C(this,"pi"),C(this,"backspace",{style:"highlight"})),af.createElement(Re,null,C(this,"shift",{style:"highlight",colspan:2}),C(this,"("),C(this,")"),C(this,"["),C(this,"]"),C(this,"!"),C(this,"'"),C(this,"enter",{style:"blue",colspan:2})))}};var $o=__dcg_shared_module_exports__['i'](Z());var{IfElse:VJ}=$o.Components,dx=class extends pr{template(){return $o.createElement("div",{class:$o.const("dcg-sci-func-keypad")},$o.createElement(sr,{controller:this.props.controller},$o.createElement(Re,null,C(this,"sin"),C(this,"cos"),C(this,"tan"),$o.createElement("div",{class:$o.const("dcg-partition-placeholder")}),C(this,"a^b"),C(this,"sqrt"),C(this,"nthroot")),$o.createElement(Re,null,C(this,"arcsin"),C(this,"arccos"),C(this,"arctan"),$o.createElement("div",{class:$o.const("dcg-partition-placeholder")}),C(this,"e^x"),C(this,"abs"),VJ(()=>this.controller.getReplaceRoundWithReciprocal(),{true:()=>C(this,"a^{-1}"),false:()=>C(this,"round")})),$o.createElement(Re,null,C(this,"mean"),C(this,"stdev"),C(this,"stdevp"),$o.createElement("div",{class:$o.const("dcg-partition-placeholder")}),C(this,"ln"),C(this,"log"),C(this,"backspace",{style:"highlight"})),$o.createElement(Re,null,C(this,"nPr"),C(this,"nCr"),C(this,"!"),$o.createElement("div",{class:$o.const("dcg-partition-placeholder")}),C(this,"e"),C(this,"pi"),C(this,"enter",{style:"blue"}))))}};var{SwitchUnion:IJ}=Ml.Components,hx=class extends pr{template(){return Ml.createElement("div",{role:Ml.const("group"),"aria-label":()=>this.s("basic-calculator-narration-keypad")},IJ(()=>this.controller.getKeyboardMode(),{qwerty:()=>Ml.createElement(sx,{controller:this.props.controller}),letters:()=>Ml.createElement(ax,{controller:this.props.controller}),capitalQwerty:()=>Ml.createElement(lx,{controller:this.props.controller}),capitalLetters:()=>Ml.createElement(cx,{controller:this.props.controller}),functions:()=>Ml.createElement(dx,{controller:this.props.controller}),main:()=>Ml.createElement(ox,{controller:this.props.controller})}))}};var Ti=__dcg_shared_module_exports__['i'](Z());var Qs=__dcg_shared_module_exports__['i'](Z());var cf=__dcg_shared_module_exports__['i'](ep()),{For:MJ}=Qs.Components,lf=class extends Qs.Class{template(){return Qs.createElement("tr",null,Qs.createElement(MJ,{each:()=>this.getBrailleAscii(this.props.latex()),key:e=>e.key},Qs.createElement("td",null,e=>Qs.createElement("span",{class:Qs.const("dcg-key-press")},()=>e.char))),Qs.createElement("td",{class:Qs.const("dcg-braille-font")},()=>this.getBrailleUnicode(this.props.latex())),Qs.createElement("td",null,Qs.createElement(et,{config:this.const({}),latex:()=>this.props.latex()})))}getBrailleAscii(e){let r=cf.UnicodeBraille.toExpandedBrailleAscii(this.getBrailleUnicode(e)),i=[];for(let n=0;n<r.length;n++)i.push({char:r[n],key:n+")"+r[n]});return i}getBrailleUnicode(e){let r;return this.props.brailleMode()==="nemeth"?r=cf.latexToNemeth(e):this.props.brailleMode()==="ueb"&&(r=cf.latexToUeb(e)),r&&r.value?r.value:""}};var Eu=class extends pr{template(){return Ti.createElement("div",{class:()=>({"dcg-braille-io-keypad-container":!0,"dcg-has-background-color":this.controller.hasBackgroundColor()})},Ti.createElement("div",{class:Ti.const("dcg-braille-io-keypad")},Ti.createElement("div",{class:Ti.const("dcg-braille-description")},Ti.createElement("div",{class:Ti.const("dcg-braille-title")},()=>this.controller.s("basic-calculator-text-braille-mode-is-on",{mode:this.brailleType()})),Ti.createElement("div",{class:Ti.const("dcg-braille-info-text")},()=>this.controller.s("basic-calculator-text-how-to-type-braille")),Ti.createElement("div",{class:Ti.const("dcg-btn-primary"),role:Ti.const("button"),tabindex:Ti.const(0),onTap:()=>this.controller.dispatch({type:"set-braille-mode",mode:"none"})},()=>this.controller.s("basic-calculator-button-turn-braille-mode-off",{mode:this.brailleType()}))),Ti.createElement("div",{class:Ti.const("dcg-braille-examples-table-container")},Ti.createElement("table",{class:Ti.const("dcg-braille-examples-table")},Ti.createElement("tr",null,Ti.createElement("th",null,()=>this.controller.s("basic-calculator-heading-braille-table-type-this")),Ti.createElement("th",null,()=>this.brailleType()),Ti.createElement("th",null,()=>this.controller.s("basic-calculator-heading-braille-table-typeset"))),Ti.createElement(lf,{brailleMode:()=>this.controller.getBrailleMode(),latex:this.const("2+2")}),Ti.createElement(lf,{brailleMode:()=>this.controller.getBrailleMode(),latex:this.const("\\frac{1}{2}")}),Ti.createElement(lf,{brailleMode:()=>this.controller.getBrailleMode(),latex:this.const("\\sqrt{4}")})),Ti.createElement("div",{class:Ti.const("dcg-more-examples-link")},Ti.createElement("a",{href:()=>"https://www.desmos.com/braille-examples?"+this.controller.getBrailleMode(),target:Ti.const("_blank")},()=>this.controller.s("basic-calculator-link-view-braille-examples"))))))}brailleType(){return this.controller.getBrailleMode()==="nemeth"?"Nemeth":this.controller.getBrailleMode()==="ueb"?"UEB":""}};var Zs=__dcg_shared_module_exports__['i'](Z());var Bt=__dcg_shared_module_exports__['i'](Z());Oe();var px=__dcg_shared_module_exports__['i'](ep());var up=__dcg_shared_module_exports__['i'](ep());function Kk(t,e){return e==="nemeth"?up.latexToNemeth(t):e==="ueb"?up.latexToUeb(t):{isError:!0,error:"Braille mode should be 'nemeth' or 'ueb'"}}function $K(t,e){return e==="nemeth"?up.nemethToLatex(t):e==="ueb"?up.uebToLatex(t):{isError:!0,error:"Braille mode should be 'nemeth' or 'ueb'"}}var{If:ph,Input:TJ,Textarea:AJ}=Bt.Components,ux=class extends pr{getAriaLabel(){let e=this.getIndex()+1+"";return this.s("shared-calculator-narration-expression-index",{index:e})}didUpdate(){this.renderAnsValue()}didMountMQ(e){this.$mq=I(e)}getExp(){return this.model.getExpressionById(this.props.id())}getAns(){return this.model.getExpressionAns(this.props.id())}getAnsId(){return this.model.getExpressionAnsId(this.props.id())}getLatex(){return this.getExp().latex}getValue(){return this.model.getExpressionValue(this.props.id())}getBraille(){let e=this.getExp().braille;if(e!=="")return e;{let r=Kk(this.getLatex(),this.controller.getBrailleMode());return r.isError?"":px.UnicodeBraille.toExpandedBrailleAscii(r.value)}}getIndex(){return this.model.getExpressionIndex(this.props.id())}getShowEvaluation(){return this.model.shouldShowEvaluationForExpression(this.props.id())}isFractionEvaluation(){return this.getExp().displayAsFraction}canDisplayEvaluationAsFraction(){return this.controller.getDecimalToFraction()&&this.model.canDisplayEvaluationAsFraction(this.props.id())}shouldDisplayEvaluationAsFraction(){return this.canDisplayEvaluationAsFraction()&&this.getExp().displayAsFraction}toggleFractionEvaluation(){this.dispatch({type:"toggle-fraction-evaluation",id:this.props.id()})}getFractionDisplayAriaLabel(){return this.shouldDisplayEvaluationAsFraction()?this.controller.s("basic-calculator-narration-convert-to-decimal"):this.controller.s("basic-calculator-narration-convert-to-fraction")}getError(){let e=this.model.getExpressionError(this.props.id());return e&&this.getLatex().length>0?Ah(e,this.controller.getLanguage()):""}showError(){return!!this.getError()}getFractionMessage(){return this.shouldDisplayEvaluationAsFraction()?this.s("basic-calculator-label-convert-to-decimal"):this.s("basic-calculator-label-convert-to-fraction")}getIsFocused(){return!this.controller.isSettingsMenuOpen()&&this.model.isExpressionFocused(this.props.id())}onFocusedChanged(e){this.getExp()&&(e?this.dispatch({type:"focusin",id:this.props.id()}):this.dispatch({type:"focusout",id:this.props.id()}))}onMQReflow(){this.renderedAnsData=void 0,this.renderAnsValue()}renderAnsValue(){if(!this.$mq)return;let e=this.getAns(),r=!1,i=this.getAnsId();if(i){let n=this.model.getExpressionById(i);r=n&&n.displayAsFraction}this.renderedAnsData&&this.renderedAnsData.value==e&&this.renderedAnsData.displayAsFraction===r||(this.renderedAnsData={value:e,displayAsFraction:r},this.$mq.find(".dcg-mq-ans").each((n,o)=>{let s=I(o),a;typeof e=="number"?a=__dcg_shared_module_exports__['Fb'](e,{digits:this.getEvaluationDigits(),bigCutoff:1e9,displayAsFraction:r}):typeof e=="string"&&(a=e),a?s.removeClass("dcg-invalid").html(a):s.addClass("dcg-invalid").html('<i class="dcg-icon-error" aria-hidden="true"></i>')}))}getEvaluationLatex(){let e=this.getValue();if(e===void 0&&(e=NaN),this.model.isRationalizableConstant(this.props.id())&&!this.shouldDisplayEvaluationAsFraction())return"";let r;if(Array.isArray(e))r=`\\mathrm{${e.length}\\ element\\ list}`;else{var i=__dcg_shared_module_exports__['Gb'](e,{digits:this.getEvaluationDigits(),bigCutoff:1e9,displayAsFraction:this.shouldDisplayEvaluationAsFraction()});return i==="undefined"?"=\\mathrm{undefined}":"="+i}return r}getEvaluationBraille(){let e=this.getEvaluationLatex(),r=Kk(e,this.controller.getBrailleMode());return r.isError?"":px.UnicodeBraille.toExpandedBrailleAscii(r.value)}didMountBrailleInput(e){this.brailleInputNode=e}didUnmountBrailleInput(){this.brailleInputNode=void 0}handleBrailleFocus(e){let r=e.target;r&&setTimeout(()=>{r.setSelectionRange(0,0)})}handleBrailleKeydown(e){!e.altKey&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey&&(Te(e)===Jn?(this.forceModelFocus(),this.dispatch({type:"focus-prev-expression"}),e.preventDefault()):Te(e)===Yn?(this.forceModelFocus(),this.dispatch({type:"focus-next-expression"}),e.preventDefault()):Te(e)===ll?(this.forceModelFocus(),this.dispatch({type:"insert-blank-expression"}),e.preventDefault()):Te(e)===Pa&&document.activeElement===this.brailleInputNode&&this.getBraille()===""&&(this.dispatch({type:"backspace-from-braille"}),e.preventDefault()))}forceModelFocus(){document.activeElement!==this.brailleInputNode&&this.onFocusedChanged(!0)}focusBrailleInput(){this.brailleInputNode&&document.activeElement!==this.brailleInputNode&&this.brailleInputNode.focus()}getPostLabel(){if(this.showError())return this.getError();if(this.getShowEvaluation()){let e=this.getValue();return e===void 0&&(e=NaN),Array.isArray(e)?`${e.length} element list`:"equals "+fs(__dcg_shared_module_exports__['Gb'](e,{digits:this.getEvaluationDigits(),bigCutoff:1e9,displayAsFraction:this.shouldDisplayEvaluationAsFraction()}))}return""}onBrailleInput(e){this.controller.isSettingsMenuOpen()&&this.controller.dispatch({type:"close-settings-menu"});let r=$K(px.UnicodeBraille.coerceToSixDotCells(e),this.controller.getBrailleMode()),i=r.isError?"":r.value;(!this.controller.getCapExpressionSize()||Zg(i)<=em)&&this.controller.dispatch({type:"update-latex-from-braille",latex:i,braille:e,id:this.props.id()})}getIndexSubscript(){return`_{${this.getIndex()+1}}`}getEvaluationDigits(){return this.controller.isScientificCalc()?10:7}onMountContainer(e){this.containerNode=e}onTapContainer(e){e.target===this.containerNode&&!this.getShowEvaluation()&&!this.showError()&&this.forceModelFocus()}template(){return Bt.createElement("div",{class:()=>({"dcg-basic-expression":!0,"dcg-focused":this.getIsFocused(),"dcg-braille-io":this.controller.renderAsBraille()}),onTap:this.bindFn(this.onTapContainer),onMount:this.bindFn(this.onMountContainer)},Bt.createElement(ph,{predicate:()=>this.controller.renderAsBraille()},()=>Bt.createElement("div",{class:Bt.const("dcg-braille-input")},Bt.createElement(au,{ariaLabel:()=>{let e=Kk(`eq${this.getIndexSubscript()}`,this.controller.getBrailleMode());return e.isError?"":px.UnicodeBraille.toExpandedBrailleAscii(e.value)},didMount:this.bindFn(this.didMountBrailleInput),didUnmount:this.bindFn(this.didUnmountBrailleInput),onFocusedChanged:this.bindFn(this.onFocusedChanged),shouldFocus:this.bindFn(this.getIsFocused),onKeydown:this.bindFn(this.handleBrailleKeydown),onInput:this.bindFn(this.onBrailleInput),sixKeyInput:()=>this.controller.getSixKeyInput(),value:()=>this.getBraille(),isStatic:this.const(!1)}))),Bt.createElement(ph,{predicate:()=>this.controller.renderAsBraille()},()=>Bt.createElement("div",{class:Bt.const("dcg-braille-evaluation-container")},Bt.createElement(ph,{predicate:()=>this.getShowEvaluation()},()=>Bt.createElement("div",{class:Bt.const("dcg-braille-evaluation")},Bt.createElement(TJ,{readonly:this.const("true"),class:this.const("dcg-braille-evaluation-inner"),value:()=>this.getEvaluationBraille(),onFocus:this.bindFn(this.handleBrailleFocus),onKeydown:this.bindFn(this.handleBrailleKeydown),onInput:()=>{}}))),Bt.createElement(ph,{predicate:()=>this.showError()},()=>Bt.createElement("div",{class:Bt.const("dcg-braille-error")},Bt.createElement("div",{class:Bt.const("dcg-basic-expression-error")},Bt.createElement("i",{class:Bt.const("dcg-icon-error"),"aria-hidden":Bt.const("true")})),Bt.createElement(AJ,{readonly:this.const("true"),class:this.const("dcg-braille-error-inner"),value:()=>this.getError(),onFocus:this.bindFn(this.handleBrailleFocus),onKeydown:this.bindFn(this.handleBrailleKeydown),onInput:()=>{}}))))),Bt.createElement(ph,{predicate:()=>this.controller.renderAsBraille()},()=>Bt.createElement("div",{class:Bt.const("dcg-exp-mathquill-container"),didMount:this.bindFn(this.didMountMQ),onTap:this.bindFn(this.forceModelFocus)},Bt.createElement(et,{latex:()=>this.getLatex(),config:this.const({}),onReflow:this.bindFn(this.onMQReflow)}))),Bt.createElement(ph,{predicate:()=>!this.controller.renderAsBraille()},()=>Bt.createElement("div",{class:Bt.const("dcg-exp-mathquill-container"),didMount:this.bindFn(this.didMountMQ)},Bt.createElement(Xe,{latex:()=>this.getLatex(),onReflow:this.bindFn(this.onMQReflow),isFocused:this.bindFn(this.getIsFocused),capExpressionSize:()=>this.controller.getCapExpressionSize(),config:this.bindFn(this.getMQConfig),getAriaLabel:()=>this.getAriaLabel(),getAriaPostLabel:()=>this.getPostLabel(),hasError:()=>!1,onUserPressedKey:(e,r)=>{this.controller.isSettingsMenuOpen()&&this.controller.dispatch({type:"close-settings-menu"}),this.dispatch({type:"keypad/press-key",key:e,evt:r})},onUserTypedText:e=>this.dispatch({type:"keypad/type-text",text:e}),onUserChangedLatex:e=>{this.dispatch({type:"update-latex",id:this.props.id(),latex:e})},onFocusedChanged:this.bindFn(this.onFocusedChanged),disableSpace:()=>this.controller.getRestrictedEditing()}))),Bt.createElement("div",{class:Bt.const("dcg-exp-output-container")},Bt.createElement(ph,{predicate:()=>this.showError()&&!this.controller.renderAsBraille()},()=>Bt.createElement(Pe,{tooltip:this.bindFn(this.getError),gravity:this.const("w"),sticky:this.const(!0)},Bt.createElement("div",{class:Bt.const("dcg-basic-expression-error")},Bt.createElement("i",{class:Bt.const("dcg-icon-error"),"aria-hidden":Bt.const("true")})))),Bt.createElement(ph,{predicate:()=>this.getShowEvaluation()},()=>Bt.createElement("div",{class:()=>({"dcg-basic-expression-value":!0,"dcg-basic-evaluation-gray":Array.isArray(this.getValue())})},Bt.createElement(et,{config:this.const({}),latex:()=>this.getEvaluationLatex()}),Bt.createElement(ph,{predicate:this.bindFn(this.canDisplayEvaluationAsFraction)},()=>Bt.createElement(Pe,{tooltip:this.bindFn(this.getFractionMessage),gravity:this.const("sw")},Bt.createElement("span",{role:Bt.const("button"),tabindex:Bt.const("0"),"aria-label":this.bindFn(this.getFractionDisplayAriaLabel),class:()=>({"dcg-basic-fraction-toggle":!0,"dcg-selected":this.isFractionEvaluation()}),onTap:this.bindFn(this.toggleFractionEvaluation)},Bt.createElement("i",{class:Bt.const("dcg-icon-fraction"),"aria-hidden":Bt.const("true")}))))))))}getMQConfig(){return this.controller.getMathquillConfig()}};Oe();var{For:LJ,If:PJ}=Zs.Components,gx=class extends pr{constructor(){super(...arguments),this.didShowAnswerHint=!1,this.didHideAnswerHint=!1}template(){return Zs.createElement("div",{class:Zs.const("dcg-basic-list-container"),role:Zs.const("complementary"),"aria-label":()=>this.controller.s("basic-calculator-narration-expression-list"),didMount:this.bindFn(this.didMountContainer)},Zs.createElement("div",{class:Zs.const("dcg-basic-list-placeholder"),didMount:this.bindFn(this.didMountPlaceholder)},Zs.createElement(PJ,{predicate:this.bindFn(this.showAnswerHint)},()=>Zs.createElement("div",{class:Zs.const("dcg-answer-hint")},()=>this.controller.s("basic-calculator-label-answer-hint")))),Zs.createElement(LJ,{each:()=>this.model.getExpressionOrder()},Zs.createElement("div",{class:()=>({"dcg-basic-list":!0,"dcg-projector-mode":this.controller.isProjectorMode()})},e=>Zs.createElement(ux,{controller:this.props.controller,id:this.const(e)}))))}didMountPlaceholder(e){I(e).on("dcg-tap",ti)}showAnswerHint(){if(this.didHideAnswerHint)return!1;let e=this.model.getExpressionOrder()[0];return this.model.shouldShowEvaluationForExpression(e)||this.didShowAnswerHint?(this.didShowAnswerHint=!0,this.model.getNumberOfExpressions()>1||this.model.getExpressionLatex(e)===""?(this.didHideAnswerHint=!0,!1):!0):!1}didUpdate(){if(!this.$container)return;let e=this.$container.find(".dcg-focused");e.length>0&&Ba(e,this.$container,50)}didMountContainer(e){this.$container=I(e)}};var{If:mx,IfElse:Uk}=br.Components,fx=class extends pr{template(){return br.createElement(mx,{predicate:()=>this.controller.shouldRender()},()=>br.createElement("div",{class:br.const("dcg-calculator-api-container"),style:br.const("width: 100%; height: 100%; position: relative;")},br.createElement("div",{class:()=>({"dcg-calc-basic-main-wrapper":!0,"dcg-narrow":this.controller.containerSize.width<570,"dcg-short":this.controller.containerSize.height<=540,"dcg-scientific-calculator":this.controller.isScientificCalc(),"dcg-four-function-calculator":this.controller.isFourFunctionCalc(),"dcg-container":!0}),onKeydown:this.bindFn(this.handleRootKeydown),didMount:this.bindFn(this.didMountRoot),"x-ms-format-detection":br.const("none")},br.createElement("div",{role:br.const("application"),"aria-label":()=>this.controller.isScientificCalc()?this.controller.s("basic-calculator-narration-calc-description-scientific"):this.controller.isFourFunctionCalc()?this.controller.s("basic-calculator-narration-calc-description-fourfunction"):"",class:()=>({"dcg-calc-basic-main":!0,"dcg-inverted-colors":this.controller.getInvertedColors(),"dcg-projector-mode":this.controller.isProjectorMode(),"dcg-ipad":La,"dcg-has-background-color":this.controller.hasBackgroundColor(),"dcg-no-hyperlinks":!this.controller.getAllowLinks()}),style:()=>({"font-size":`${this.controller.getFontSize()}px`,background:this.controller.getBackgroundColor(),color:this.controller.getTextColor(),filter:this.controller.getInvertedColors()?"invert(100%)":"none"})},br.createElement(gx,{controller:this.props.controller}),br.createElement(mx,{predicate:()=>this.controller.isScientificCalc()&&this.model.isSingleExpression()},()=>br.createElement("div",null,br.createElement(Bk,{controller:this.props.controller}),br.createElement("div",{class:br.const("dcg-basic-keypad-container")},Uk(()=>this.controller.renderAsBraille(),{true:()=>br.createElement(Eu,{controller:this.props.controller}),false:()=>br.createElement(nx,{controller:this.props.controller})})))),br.createElement(mx,{predicate:()=>this.controller.isScientificCalc()&&!this.model.isSingleExpression()},()=>br.createElement("div",null,br.createElement(Nk,{controller:this.props.controller}),br.createElement("div",{class:br.const("dcg-basic-keypad-container")},Uk(()=>this.controller.renderAsBraille(),{true:()=>br.createElement(Eu,{controller:this.props.controller}),false:()=>br.createElement(hx,{controller:this.props.controller})})))),br.createElement(mx,{predicate:()=>this.controller.isFourFunctionCalc()&&this.model.isSingleExpression()},()=>br.createElement("div",null,br.createElement(Rk,{controller:this.props.controller}),br.createElement("div",{class:br.const("dcg-basic-keypad-container")},Uk(()=>this.controller.renderAsBraille(),{true:()=>br.createElement(Eu,{controller:this.props.controller}),false:()=>br.createElement(ix,{controller:this.props.controller})})))),br.createElement(mx,{predicate:()=>this.controller.isFourFunctionCalc()&&!this.model.isSingleExpression()},()=>br.createElement("div",null,br.createElement(_k,{controller:this.props.controller}),br.createElement("div",{class:br.const("dcg-basic-keypad-container")},Uk(()=>this.controller.renderAsBraille(),{true:()=>br.createElement(Eu,{controller:this.props.controller}),false:()=>br.createElement(rx,{controller:this.props.controller})}))))))))}didMountRoot(e){Mh(e)}handleRootKeydown(e){let r=ei(e),i=this.controller.model;if(Lp(e))return this.dispatch({type:"undo",source:"keyboard-shortcut"}),!1;if(Pp(e))return this.dispatch({type:"redo",source:"keyboard-shortcut"}),!1;if(e.altKey!==Zr&&e.metaKey===Zr&&!e.ctrlKey&&e.shiftKey&&r==="A"&&this.controller.getDecimalToFraction()){let n=i.getFocusedExpression();n&&i.canDisplayEvaluationAsFraction(n.id)&&(e.preventDefault(),e.stopPropagation(),this.controller.dispatch({type:"toggle-fraction-evaluation",id:n.id}),this.controller.runAfterDispatch(()=>{i.getFocusedExpression().displayAsFraction?me(this.controller.s("shared-calculator-narration-show-as-fraction")):me(this.controller.s("shared-calculator-narration-show-as-decimal"))}))}else if(!e.metaKey&&!e.shiftKey){if(!e.ctrlKey&&!e.altKey&&Te(e)===Pa){if(!document.activeElement||Ih(I(document.activeElement)))return!1}else if(e.ctrlKey===Zr&&e.altKey===!Zr){if(r==="N")return this.controller.getBrailleControls()?(this.dispatch({type:"set-braille-mode",mode:"nemeth"}),me(this.controller.s("shared-calculator-narration-hotkey-braille-mode-nemeth")),!1):void 0;if(r==="U")return this.controller.getBrailleControls()?(this.dispatch({type:"set-braille-mode",mode:"ueb"}),me(this.controller.s("shared-calculator-narration-hotkey-braille-mode-ueb")),!1):void 0;if(r==="Q"||r==="X")return this.controller.getBrailleControls()?(this.dispatch({type:"set-braille-mode",mode:"none"}),me(this.controller.s("shared-calculator-narration-hotkey-braille-mode-off")),!1):void 0;if(r==="6"){if(!this.controller.getBrailleControls())return;let n=!this.controller.getSixKeyInput();return this.dispatch({type:"set-six-key-input",mode:n}),me(n?this.controller.s("basic-calculator-narration-hotkey-six-key-input-on"):this.controller.s("basic-calculator-narration-hotkey-six-key-input-off")),!1}else if(r==="D")return this.controller.isScientificCalc()?(e.preventDefault(),this.controller.dispatch({type:"degrees"}),me(i.getDegreeMode()?this.controller.s("basic-calculator-narration-controlbar-degrees"):this.controller.s("basic-calculator-narration-controlbar-radians")),!1):void 0}}return!0}};var df=class extends Cu{constructor(r){super(r)}init(r){r=__dcg_shared_module_exports__['N'](r),r.backgroundColor&&!__dcg_shared_module_exports__['Q'](r.backgroundColor)&&(__dcg_shared_module_exports__['M'].warn("Invalid backgroundColor. Background color must be a 3- or 6-character hex color (e.g. #cde or #ffaaaa)"),delete r.backgroundColor),r.textColor&&!__dcg_shared_module_exports__['Q'](r.textColor)&&(__dcg_shared_module_exports__['M'].warn("Invalid textColor. Text color must be a 3- or 6-character hex color (e.g. #000 or #001111)"),delete r.textColor);let i=__dcg_shared_module_exports__['b']({language:"en",qwertyKeyboard:!0,links:!0,degreeMode:!1,settingsMenu:!0,invertedColors:!1,backgroundColor:"#fff",textColor:"#000",brailleMode:"none",sixKeyInput:!1,brailleControls:!0,brailleExpressionDownload:!0,projectorMode:!1,capExpressionSize:!1,functionDefinition:!0,autosize:!0,evaluationMode:"scientific",restrictedEditing:!1,additionalFunctions:["sqrt"],typingSlashWritesDivisionSymbol:!1,typingAsteriskWritesTimesSymbol:!1,decimalToFraction:!0,replaceCommaWith10Exp:!1,replaceRoundWithReciprocal:!1},r);this.settings=new Lr;let n={workerPool:$m,settingsProxy:this.settings};this.controller=new Zw(i,n),this.controller.onEventEmitted=o=>{o==="render"&&this.updateView(),this.triggerEvent(o,void 0)},this.setupDomChangeDetector(i.autosize)}onCreateView(){return hf.mountToNode(fx,this.rootElt,{controller:hf.const(this.controller)})}setState(r,i){i||(i={}),this.controller.dispatch({type:"set-state-from-api",state:r,opts:{allowUndo:!!i.allowUndo}})}getState(){return __dcg_shared_module_exports__['N'](this.controller.model.getPersistedState())}undo(){this.controller.dispatch({type:"undo",source:"api"})}redo(){this.controller.dispatch({type:"redo",source:"api"})}clearHistory(){this.controller.dispatch({type:"clear-history"})}setBlank(r){r||(r={}),this.controller.dispatch({type:"set-blank",opts:{allowUndo:!!r.allowUndo}})}updateSettings(r){if(r!=null)for(let i in r)switch(i){case"fontSize":let n=r[i];if(n===void 0)continue;this.controller.dispatch({type:"update-font-size",size:n});break;case"invertedColors":let o=r[i];if(o===void 0)continue;this.controller.dispatch({type:"update-inverted-colors",mode:o});break;case"backgroundColor":let s=r[i];if(s===void 0||!__dcg_shared_module_exports__['Q'](s)){__dcg_shared_module_exports__['M'].warn("Invalid backgroundColor. Background color must be a 3- or 6-character hex color (e.g. #cde or #ffaaaa)");continue}this.controller.dispatch({type:"update-background-color",color:s});break;case"textColor":let a=r[i];if(a===void 0||!__dcg_shared_module_exports__['Q'](a)){__dcg_shared_module_exports__['M'].warn("Invalid textColor. Text color must be a 3- or 6-character hex color (e.g. #000 or #001111)");continue}this.controller.dispatch({type:"update-text-color",color:a});break;case"degreeMode":let l=r[i];if(l===void 0)continue;this.controller.dispatch({type:"update-degree-mode",mode:l});break;case"brailleMode":let c=r[i];this.controller.dispatch({type:"set-braille-mode",mode:c});break;case"sixKeyInput":let d=r[i];if(d===void 0)continue;this.controller.dispatch({type:"set-six-key-input",mode:d});break;case"brailleControls":{let S=r[i];if(S===void 0)continue;this.controller.dispatch({type:"set-braille-controls",value:S});break}case"brailleExpressionDownload":let u=r[i];if(u===void 0)continue;this.controller.dispatch({type:"set-braille-expression-download",mode:u});break;case"projectorMode":let p=r[i];if(p===void 0)continue;this.controller.dispatch({type:"update-projector-mode",mode:p});break;case"capExpressionSize":let g=r[i];if(g===void 0)continue;this.controller.dispatch({type:"update-cap-expression-size",mode:g});break;case"language":let b=r[i];if(b===void 0)continue;this.controller.dispatch({type:"update-language",language:pd(b)});break;case"settingsMenu":r.settingsMenu?this.controller.dispatch({type:"enable-settings-menu"}):this.controller.dispatch({type:"disable-settings-menu"});break;case"qwertyKeyboard":{this.controller.dispatch({type:"update-options",options:{qwertyKeyboard:!!r.qwertyKeyboard}});let S=this.controller.getKeyboardMode();(S==="qwerty"||S==="letters")&&this.controller.dispatch({type:"ABC"})}break;case"functionDefinition":r.functionDefinition?this.controller.model.enableFunctionDefinition():this.controller.model.disableFunctionDefinition();break;case"links":this.controller.dispatch({type:"update-options",options:{links:!!r.links}});break;case"decimalToFraction":let x=r[i];if(x===void 0)continue;this.controller.dispatch({type:"update-decimal-to-fraction",mode:x});break;case"replaceCommaWith10Exp":let w=r[i];if(w===void 0)continue;this.controller.dispatch({type:"set-replace-comma-with-10-exp",replace:w});break;case"replaceRoundWithReciprocal":let E=r[i];if(E===void 0)continue;this.controller.dispatch({type:"set-replace-round-with-reciprocal",replace:E});break;case"restrictedEditing":{this.controller.dispatch({type:"update-options",options:{restrictedEditing:!!r.restrictedEditing}});break}case"typingAsteriskWritesTimesSymbol":let k=r[i];if(k===void 0)continue;this.controller.dispatch({type:"set-typing-asterisk-writes-times-symbol",mode:k});break}}focusFirstExpression(){this.controller.dispatch({type:"focus-first-expression"})}onResizeView(r){this.controller.dispatch({type:"ui/container-resized",size:r})}onDestroyView(){hf.unmountFromNode(this.rootElt)}destroy(){this.controller.model.destroy(),super.destroy()}};var pf=class extends df{constructor(e,r){super(e),this.init(OJ(r||{}))}};function OJ(t){if(t=__dcg_shared_module_exports__['N'](t),t.hasOwnProperty("typingSlashWritesDivisionSymbol")||(t.typingSlashWritesDivisionSymbol=!0),t.hasOwnProperty("typingAsteriskWritesTimesSymbol")||(t.typingAsteriskWritesTimesSymbol=!0),t.exponentButtonForSquareRoot&&(__dcg_shared_module_exports__['M'].warn(`As of API version 1.0, the 'exponentButtonForSquareRoot' option is deprecated.Use 'additionalFunctions: "exponent"' instead.`),t.additionalFunctions=["exponent"]),t.additionalFunctions){var e=t.additionalFunctions;typeof e=="string"&&(e=[e]),e.length>2&&(__dcg_shared_module_exports__['M'].warn("additionalFunctions can only take up to 2 new functions. Using the first two."),e=e.slice(0,2));let i=!0;for(var r=0;r<e.length;r++)["sqrt","exponent","percent","fraction"].indexOf(e[r])===-1&&(__dcg_shared_module_exports__['M'].warn("Unrecognized value: '"+e[r]+`' for 'additionalFunction'. Valid values are 'sqrt', 'percent', 'exponent', or 'fraction'. Using default ("sqrt")`),i=!1);t.additionalFunctions=i?e:["sqrt"]}return(!t.additionalFunctions||!t.additionalFunctions.length)&&(t.additionalFunctions=["sqrt"]),t.singleExpression?t.evaluationMode="singleExpressionFourFunction":t.evaluationMode="fourFunction",delete t.singleExpression,t.hasOwnProperty("decimalToFraction")||(t.decimalToFraction=!1),t.language&&(t.language=pd(t.language)),t}var uf=class extends df{constructor(e,r){super(e),this.init(_J(r||{}))}};function _J(t){return t=__dcg_shared_module_exports__['N'](t),t.singleExpression?t.evaluationMode="singleExpressionScientific":t.evaluationMode="scientific",delete t.singleExpression,t.language&&(t.language=pd(t.language)),t}var mf=__dcg_shared_module_exports__['i'](Z());var yx=class{constructor(e){this.keypadType="scientific";this.projectorMode="none";this.scientificKeyboardMode="main";this.dispatcher=new sd;this.s=zl(()=>"en");this.dispatch=e=>{this.dispatcher.dispatch(e);let r;for(;r=this._queuedCallbacks.shift();)r()};this._queuedCallbacks=[];var r,i;this.keypadType=(r=e==null?void 0:e.keypadType)!=null?r:"scientific",this.projectorMode=(i=e==null?void 0:e.projectorMode)!=null?i:"none",this.dispatcher=new sd,this.hookUpDispatcher()}getBackgroundColor(){return"does-not-matter"}runAfterDispatch(e){this._queuedCallbacks.push(e)}enqueueEvent(e){this.runAfterDispatch(()=>{this.onEventEmitted&&this.onEventEmitted(e)})}getKeypadType(){return this.keypadType}getProjectorMode(){return this.projectorMode}getScientificKeyboardMode(){return this.scientificKeyboardMode}updateKeyboardMode(e){this.scientificKeyboardMode=e}typeIntoFocusedMathquill(e){e=e.replace(/\r|\n/g,"");let r=this.activeMQ;r&&(r.typedText(e),Xe.simulateUserChangedLatex(r))}pressKeyInFocusedMathquill(e,r){let i=this.activeMQ;if(i){if(e==="Enter"){r&&(r.preventDefault(),r.stopPropagation()),this.enqueueEvent("enter");return}i.keystroke(e,r)}}executeCommandInFocusedMathquill(e){let r=this.activeMQ;r&&pm(r,e)}hookUpDispatcher(){this.dispatcher.register(e=>{switch(this.enqueueEvent("render"),e.type){case"hide-keypad":this.enqueueEvent("hide-keypad");break;case"set-active-mq":this.activeMQ=e.mq;break;case"set-keypad-type":this.keypadType=e.keypadType;break;case"keypad/shift":this.updateKeyboardMode(this.scientificKeyboardMode==="capitalQwerty"?"qwerty":"capitalQwerty");break;case"main":this.updateKeyboardMode("main");break;case"ABC":this.updateKeyboardMode("qwerty");break;case"functions":this.updateKeyboardMode("functions");break;case"keypad/type-text":this.typeIntoFocusedMathquill(e.text);break;case"keypad/press-key":this.pressKeyInFocusedMathquill(e.key,e.evt);break;case"keypad/custom-command":this.executeCommandInFocusedMathquill(e.command);break;case"keypad/123":case"keypad/abc":case"keypad/audio-trace":break;default:return e}})}};var _n=__dcg_shared_module_exports__['i'](Z());var WK=__dcg_shared_module_exports__['i'](Z()),Wo=class extends WK.Class{init(){this.controller=this.props.controller(),this.dispatch=this.controller.dispatch,this.s=this.controller.s}};var zn=__dcg_shared_module_exports__['i'](Z());var qk=class extends Wo{template(){return zn.createElement(sr,{controller:this.props.controller},zn.createElement(Re,null,C(this,"a^2"),C(this,"a^b"),C(this,"|a|"),C(this,"a/b"),zn.createElement("div",{class:zn.const("dcg-partition-placeholder")}),C(this,"7",{style:"highlight"}),C(this,"8",{style:"highlight"}),C(this,"9",{style:"highlight"}),C(this,"/"),zn.createElement("div",{class:zn.const("dcg-partition-placeholder")}),C(this,"x"),C(this,"y")),zn.createElement(Re,null,C(this,"("),C(this,")"),C(this,"<"),C(this,">"),zn.createElement("div",{class:zn.const("dcg-partition-placeholder")}),C(this,"4",{style:"highlight"}),C(this,"5",{style:"highlight"}),C(this,"6",{style:"highlight"}),C(this,"*"),zn.createElement("div",{class:zn.const("dcg-partition-placeholder")}),C(this,"left",{style:"highlight"}),C(this,"right",{style:"highlight"})),zn.createElement(Re,null,C(this,"sqrt"),C(this,","),C(this,"<="),C(this,">="),zn.createElement("div",{class:zn.const("dcg-partition-placeholder")}),C(this,"1",{style:"highlight"}),C(this,"2",{style:"highlight"}),C(this,"3",{style:"highlight"}),C(this,"-"),zn.createElement("div",{class:zn.const("dcg-partition-placeholder")}),Vi(.5),C(this,"backspace",{style:"highlight",colspan:1.5})),zn.createElement(Re,null,C(this,"nthroot"),C(this,"pi"),C(this,"%"),C(this,"a_b"),zn.createElement("div",{class:zn.const("dcg-partition-placeholder")}),C(this,"0",{style:"highlight"}),C(this,".",{style:"highlight"}),C(this,"="),C(this,"+"),zn.createElement("div",{class:zn.const("dcg-partition-placeholder")}),C(this,"enter",{colspan:2,style:"blue"})))}};var Sc=__dcg_shared_module_exports__['i'](Z());var Hk=class extends Wo{template(){return Sc.createElement(sr,{controller:this.props.controller},Sc.createElement(Re,null,C(this,"q"),C(this,"w"),C(this,"e"),C(this,"r"),C(this,"t"),C(this,"y"),C(this,"u"),C(this,"i"),C(this,"o"),C(this,"p")),Sc.createElement(Re,null,Sc.createElement("div",{class:Sc.const("dcg-half-width-placeholder")}),C(this,"a"),C(this,"s"),C(this,"d"),C(this,"f"),C(this,"g"),C(this,"h"),C(this,"j"),C(this,"k"),C(this,"l"),Sc.createElement("div",{class:Sc.const("dcg-half-width-placeholder")})),Sc.createElement(Re,null,C(this,"shift",{style:"highlight"}),C(this,"z"),C(this,"x"),C(this,"c"),C(this,"v"),C(this,"b"),C(this,"n"),C(this,"m"),C(this,":"),C(this,"backspace",{style:"highlight"})),Sc.createElement(Re,null,C(this,"~"),C(this,"{"),C(this,"}"),C(this,"["),C(this,"]"),C(this,"\xB1"),C(this,"'"),C(this,"obelus"),C(this,"enter",{style:"blue"})))}};var Ec=__dcg_shared_module_exports__['i'](Z());var zk=class extends Wo{template(){return Ec.createElement(sr,{controller:this.props.controller},Ec.createElement(Re,null,C(this,"Q"),C(this,"W"),C(this,"E"),C(this,"R"),C(this,"T"),C(this,"Y"),C(this,"U"),C(this,"I"),C(this,"O"),C(this,"P")),Ec.createElement(Re,null,Ec.createElement("div",{class:Ec.const("dcg-half-width-placeholder")}),C(this,"A"),C(this,"S"),C(this,"D"),C(this,"F"),C(this,"G"),C(this,"H"),C(this,"J"),C(this,"K"),C(this,"L"),Ec.createElement("div",{class:Ec.const("dcg-half-width-placeholder")})),Ec.createElement(Re,null,C(this,"shift",{style:"highlight"}),C(this,"Z"),C(this,"X"),C(this,"C"),C(this,"V"),C(this,"B"),C(this,"N"),C(this,"M"),C(this,","),C(this,"backspace",{style:"highlight"})),Ec.createElement(Re,null,C(this,"="),C(this,"("),C(this,")"),C(this,"["),C(this,"]"),C(this,"\xB1"),C(this,"'"),C(this,"obelus"),C(this,"enter",{style:"blue"})))}};var ea=__dcg_shared_module_exports__['i'](Z());var $k=class extends Wo{template(){return ea.createElement(sr,{controller:this.props.controller},ea.createElement(Re,null,C(this,"sin"),C(this,"cos"),C(this,"tan"),ea.createElement("div",{class:ea.const("dcg-partition-placeholder")}),C(this,"ln"),C(this,"log"),C(this,"backspace",{style:"highlight"})),ea.createElement(Re,null,C(this,"arcsin"),C(this,"arccos"),C(this,"arctan"),ea.createElement("div",{class:ea.const("dcg-partition-placeholder")}),C(this,"e^x"),C(this,"abs"),C(this,"round")),ea.createElement(Re,null,C(this,"mean"),C(this,"stdev"),C(this,"stdevp"),ea.createElement("div",{class:ea.const("dcg-partition-placeholder")}),C(this,"a^b"),C(this,"sqrt"),C(this,"nthroot")),ea.createElement(Re,null,C(this,"nPr"),C(this,"nCr"),C(this,"!"),ea.createElement("div",{class:ea.const("dcg-partition-placeholder")}),C(this,"e"),C(this,"%"),C(this,"enter",{style:"blue"})))}};var Fs=__dcg_shared_module_exports__['i'](Z());var Wk=class extends Wo{template(){return Fs.createElement(sr,{controller:this.props.controller},Fs.createElement(Re,null,C(this,"1",{style:"highlight"}),C(this,"2",{style:"highlight"}),C(this,"3",{style:"highlight"}),C(this,"4",{style:"highlight"}),C(this,"5",{style:"highlight"}),C(this,"6",{style:"highlight"}),C(this,"7",{style:"highlight"}),C(this,"8",{style:"highlight"}),C(this,"9",{style:"highlight"}),C(this,"0",{style:"highlight"}),Fs.createElement("div",{class:Fs.const("dcg-partition-placeholder")}),C(this,"left",{style:"highlight"}),C(this,"right",{style:"highlight"}),Fs.createElement("div",{class:Fs.const("dcg-inline-hide-keypad-button"),"dcg-command":Fs.const("hide-keypad"),onTap:()=>this.props.controller().dispatch({type:"hide-keypad"})},Fs.createElement("div",{class:Fs.const("dcg-inline-hide-keypad-button-inner")},Fs.createElement("i",{class:Fs.const("dcg-icon-hide"),"aria-hidden":Fs.const("true")})))),Fs.createElement(Re,null,Vi(2),C(this,"."),C(this,"="),C(this,"+"),C(this,"-"),C(this,"multiplication"),C(this,"obelus"),Vi(3),C(this,"backspace",{style:"highlight",colspan:1.5}),Vi(1)),Fs.createElement(Re,null,Vi(2),C(this,"a/b"),C(this,","),C(this,"("),C(this,")"),C(this,"<"),C(this,">"),Vi(2.5),C(this,"enter",{colspan:2,style:"blue"}),Vi(1)))}};var Tl=__dcg_shared_module_exports__['i'](Z());var jk=class extends Wo{template(){let t=this.props.controller();return Tl.createElement(tl,{controller:this.props.controller},Tl.createElement(ai,{command:this.const("main"),selected:()=>t.getScientificKeyboardMode()==="main",ignoreInTabOrder:this.const(!0),selectable:this.const(!0),onTap:()=>t.dispatch({type:"main"})},()=>t.s("basic-calculator-button-controlbar-main")),Tl.createElement(ai,{command:this.const("ABC"),selected:()=>["qwerty","capitalQwerty"].indexOf(t.getScientificKeyboardMode())!==-1,ignoreInTabOrder:this.const(!0),selectable:this.const(!0),ariaLabel:()=>t.s("basic-calculator-narration-controlbar-abc"),onTap:()=>t.dispatch({type:"ABC"})},()=>t.s("basic-calculator-button-controlbar-abc")),Tl.createElement(ai,{command:this.const("functions"),selected:()=>["functions","restrictedFunctions"].indexOf(t.getScientificKeyboardMode())!==-1,ariaLabel:()=>t.s("basic-calculator-narration-controlbar-functions"),ignoreInTabOrder:this.const(!0),selectable:this.const(!0),onTap:()=>t.dispatch({type:"functions"})},()=>t.s("shared-calculator-button-controlbar-functions")),Tl.createElement("div",{class:Tl.const("dcg-hide-keypad-button"),"dcg-command":Tl.const("hide-keypad"),onTap:()=>t.dispatch({type:"hide-keypad"})},Tl.createElement("i",{class:Tl.const("dcg-icon-hide"),"aria-hidden":Tl.const("true")})))}};var{Switch:FJ,SwitchUnion:RJ}=_n.Components,Jk=class extends Wo{template(){return _n.createElement("div",{class:_n.const("dcg-calculator-api-container"),style:()=>"width: 100%; height: 100%; position: relative;"},_n.createElement("div",{class:_n.const("dcg-do-not-blur dcg-container dcg-api-shared-keypad-root"),didMount:this.bindFn(this.didMountRoot)},this.children))}didMountRoot(e){Mh(e)}},V0=class extends Wo{template(){return _n.createElement(Jk,__dcg_shared_module_exports__['b']({},this.props),_n.createElement("div",{class:()=>({"dcg-fourfunction-keypad-container":!0,"dcg-projector-mode":this.props.controller().getProjectorMode()!=="none","dcg-classroom-large-projector-mode":this.props.controller().getProjectorMode()==="large"}),role:_n.const("group"),"aria-label":()=>this.s("shared-calculator-narration-keypad")},_n.createElement(Wk,{controller:this.props.controller})))}},I0=class extends Wo{template(){return _n.createElement(Jk,__dcg_shared_module_exports__['b']({},this.props),_n.createElement("div",{class:()=>({"dcg-scientific-keypad-container":!0,"dcg-projector-mode":this.props.controller().getProjectorMode()!=="none","dcg-classroom-large-projector-mode":this.props.controller().getProjectorMode()==="large"})},_n.createElement(jk,{controller:this.props.controller}),_n.createElement("div",{role:_n.const("group"),"aria-label":()=>this.s("shared-calculator-narration-keypad")},_n.createElement(FJ,{key:()=>this.controller.getScientificKeyboardMode()},e=>{switch(e){case"qwerty":return _n.createElement(Hk,{controller:this.props.controller});case"capitalQwerty":return _n.createElement(zk,{controller:this.props.controller});case"functions":return _n.createElement($k,{controller:this.props.controller});default:return _n.createElement(qk,{controller:this.props.controller})}}))))}},Yk=class extends Wo{template(){return RJ(()=>this.controller.getKeypadType(),{fourfunction:()=>_n.createElement(V0,__dcg_shared_module_exports__['b']({},this.props)),scientific:()=>_n.createElement(I0,__dcg_shared_module_exports__['b']({},this.props))})}};var gf=class extends Cu{constructor(r,i){super(r);this.init(i)}init(r){this.controller=new yx(r),this.controller.onEventEmitted=i=>{i==="render"&&this.updateView(),this.triggerEvent(i,void 0)},this.setupDomChangeDetector(!0)}setActiveMathquill(r){this.controller.dispatch({type:"set-active-mq",mq:r})}setKeypadType(r){this.controller.dispatch({type:"set-keypad-type",keypadType:r})}onCreateView(){return mf.mountToNode(Yk,this.rootElt,{controller:mf.const(this.controller)})}onResizeView(r){}onDestroyView(){mf.unmountFromNode(this.rootElt)}destroy(){super.destroy()}};var gp=class extends bu{constructor(e,r,i){super(e,__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},r),{product:"geometry-calculator"}),i),this.setState(mm),this.clearHistory()}};var jK=__dcg_shared_module_exports__['i'](ep());var NJ=__dcg_shared_module_exports__['i'](Z());ql();var uh;typeof Desmos!="undefined"?uh=Desmos:(uh={},window.Desmos=uh);var BJ={SMALL:"0.85",MEDIUM:"1",LARGE:"1.35"};function M0(...t){return new Ea(...t)}M0.prototype=Ea.prototype;function JK(...t){return new gp(...t)}JK.prototype=gp.prototype;function T0(...t){return new tf(...t)}T0.prototype=tf.prototype;function YK(...t){return new pf(...t)}YK.prototype=pf.prototype;function XK(...t){return new uf(...t)}XK.prototype=uf.prototype;function QK(...t){return new gf(...t)}QK.prototype=gf.prototype;var ku={version:RK,Colors:{RED:IC,BLUE:MC,GREEN:TC,ORANGE:LC,PURPLE:AC,BLACK:PC},imageFileToDataURL:bE,supportedLanguages:["en"].concat(uh.localeData?Object.keys(uh.localeData):uh.locales?Object.keys(uh.locales):[]),Styles:__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['b']({},YT),JT),ColumnModes:qw,DragModes:XT,AxisArrowModes:__dcg_shared_module_exports__['O'],FontSizes:fE,LabelSizes:BJ,LabelOrientations:QT,GraphingCalculator:M0,Calculator:M0,FourFunctionCalculator:YK,ScientificCalculator:XK,Abraham:jK,Private:{Abraham:jK,Mathtools:FT,Graphtools:{ScalePair:__dcg_shared_module_exports__['Ec'],getClippingGraphType:Py,mapSegmentToCanvas:Nd,computeDrawingCommandsForDOMLabel:pD,drawCommandsToCtx:uD},MathquillConfig:{getAutoCommands:Kc,getAutoOperators:da},Parser:__dcg_shared_module_exports__['Yc'],extractSliderValueFromLatex:Yf,__compareBranches:{getSliderMin:Ka,getSliderMax:Jl},GeometryBeta:JK,HeadlessGraphingCalculator:T0,Fragile:{DCGView:NJ,PromptSliderView:mc,Checkbox:Dt,SegmentedControl:jr,MathquillView:Xe,InlineMathInputView:lr,StaticMathquillView:et,Tooltip:Pe,ExpressionOptionsMenuView:Im,evaluateLatex:yn,Keys:Ar,jQuery,getQueryParams:oo,getReconciledExpressionProps:__dcg_shared_module_exports__['pc'],List:{moveItemsTo:Uh,removeItemById:Og},currentLanguage:MV}},TestInternal:{subscribeToSharedClockBus:t=>lh(t),getCalcConfigAll:()=>uv(),fetchLanguage:t=>og(t),asyncLoadStateAtStartup:FK},MathQuill:dl,PillowKeypad:QK,HeadlessGraphingCalculator:T0};function A0(t){var e=uh.enabledFeatures;return!e||e[t]}function Qk(t){ku[t]=function(){throw new Error("The Desmos "+t+" is not enabled for this API key.")}}A0("GraphingCalculator")||(Qk("GraphingCalculator"),Qk("Calculator"));A0("FourFunctionCalculator")||Qk("FourFunctionCalculator");A0("ScientificCalculator")||Qk("ScientificCalculator");for(Xk in ku)ku.hasOwnProperty(Xk)&&(uh[Xk]=ku[Xk]);var Xk;var Ne=__dcg_shared_module_exports__['i'](Z());Oe();function ZK(t){let e=t.split(","),r=e[0].match(/:(.*?);/),i=r!==null?r[1]:"",n=e[1]!==null?atob(e[1]):"",o=n.length,s=new Uint8Array(o);for(;o--;)s[o]=n.charCodeAt(o);return new Blob([s],{type:i})}function e5(t){if(t.indexOf("xmlns=")===-1)throw new Error('Programming error: <svg> elements require the "xmlns" attribute to render properly');return new Blob([t],{type:"image/xml+svg;charset=utf-8"})}var Or=__dcg_shared_module_exports__['i'](Z());Oe();var{If:KJ}=Or.Components,kc=class extends Or.Class{template(){return Or.createElement("div",{role:Or.const("button"),tabindex:Or.const("0"),"aria-pressed":()=>this.isSelected(),class:()=>({"dcg-option":!0,"dcg-selected":this.isSelected()}),onTap:()=>this.selectSize()},()=>Ga[this.props.size()].name(this.props.controller()))}isSelected(){this.props.selectedSize(),this.props.size()}selectSize(){this.props.onSelectSize(this.props.size())}},bx=class extends Or.Class{init(){this.menuOpen=!1,this.unmounted=!1}template(){return Or.createElement("div",{class:Or.const("dcg-export-image-size-options")},Or.createElement("div",{role:Or.const("button"),tabindex:Or.const("0"),"aria-haspopup":Or.const("true"),"aria-expanded":()=>this.menuOpen,class:Or.const("dcg-selected-option"),didMount:e=>{this.menuElement=e,this.props.controller().getModalDevice()==="keyboard"&&setTimeout(()=>{this.menuElement.focus()},0)},onTap:this.bindFn(this.toggleMenu)},()=>this.selected().name(this.props.controller()),Or.createElement("i",{class:Or.const("dcg-icon-caret-down"),"aria-hidden":Or.const("true")})),Or.createElement(KJ,{predicate:()=>this.menuOpen},()=>Or.createElement("div",{class:Or.const("dcg-options-positioning-container")},Or.createElement("div",{class:Or.const("dcg-options-container"),role:Or.const("group"),"aria-label":()=>this.props.controller().s("account-shell-narration-size-options")},Or.createElement(kc,{controller:this.props.controller,size:this.const("small_square"),selectedSize:this.props.selectedSize,onSelectSize:this.bindFn(this.selectSize)}),Or.createElement(kc,{controller:this.props.controller,size:this.const("medium_square"),selectedSize:this.props.selectedSize,onSelectSize:this.bindFn(this.selectSize)}),Or.createElement(kc,{controller:this.props.controller,size:this.const("large_square"),selectedSize:this.props.selectedSize,onSelectSize:this.bindFn(this.selectSize)}),Or.createElement(kc,{controller:this.props.controller,size:this.const("medium_rectangle"),selectedSize:this.props.selectedSize,onSelectSize:this.bindFn(this.selectSize)}),Or.createElement(kc,{controller:this.props.controller,size:this.const("large_rectangle"),selectedSize:this.props.selectedSize,onSelectSize:this.bindFn(this.selectSize)}),Or.createElement("h3",{class:Or.const("dcg-embosser-title")},()=>this.props.controller().s("account-shell-heading-embossers")),Or.createElement(kc,{controller:this.props.controller,size:this.const("vpmax8"),selectedSize:this.props.selectedSize,onSelectSize:this.bindFn(this.selectSize)}),Or.createElement(kc,{controller:this.props.controller,size:this.const("vpmax11"),selectedSize:this.props.selectedSize,onSelectSize:this.bindFn(this.selectSize)}),Or.createElement(kc,{controller:this.props.controller,size:this.const("etc8"),selectedSize:this.props.selectedSize,onSelectSize:this.bindFn(this.selectSize)}),Or.createElement(kc,{controller:this.props.controller,size:this.const("etc11"),selectedSize:this.props.selectedSize,onSelectSize:this.bindFn(this.selectSize)})))))}closeMenu(){I(document).off(".export-image-size-options"),this.menuOpen=!1,this.unmounted||this.update()}didUnmount(){I(document).off(".export-image-size-options"),this.unmounted=!0}toggleMenu(){if(this.menuOpen){this.closeMenu();return}this.menuOpen=!0,I(document).on("dcg-tap.export-image-size-options",e=>{I(e.target).closest(".dcg-export-image-size-options").length||this.closeMenu()}),this.unmounted||this.update()}selectSize(e){this.menuOpen=!1,this.props.selectSize(e),this.menuElement!==void 0&&this.props.controller().getModalDevice()==="keyboard"&&this.menuElement.focus()}selected(){return Ga[this.props.selectedSize()]}};var{If:Gc,IfElse:UJ}=Ne.Components,Ga={},xx={left:0,top:0,right:0,bottom:0};Ga.small_square={width:160,height:160,margins:xx,name:t=>t.s("account-shell-label-export-size-small-square")};Ga.medium_square={width:400,height:400,margins:xx,name:t=>t.s("account-shell-label-export-size-medium-square")};Ga.large_square={width:1e3,height:1e3,margins:xx,name:t=>t.s("account-shell-label-export-size-large-square")};Ga.medium_rectangle={width:600,height:400,margins:xx,name:t=>t.s("account-shell-label-export-size-medium-rectangle")};Ga.large_rectangle={width:1200,height:800,margins:xx,name:t=>t.s("account-shell-label-export-size-large-rectangle")};Ga=__dcg_shared_module_exports__['b'](__dcg_shared_module_exports__['b']({},Ga),tp);var wx=class extends Ne.Class{init(){this.controller=this.props.controller(),this.thickness="thin",this.size="medium_square";let e=this.controller.api.controller.getBrailleMode();this.brailleMode=e!=="none"?e:"nemeth",this.showDownloadButton=Lk(),this.unmounted=!1,this.svgDropdownOpen=!1,this.markImagesDirty(),this.loaded=!1}template(){return Ne.createElement(Vl,{controller:this.props.controller},Ne.createElement("div",{id:Ne.const("export-image-dialog")},Ne.createElement("h1",null,()=>this.controller.s("account-shell-heading-export-graph")),Ne.createElement("div",{class:Ne.const("dcg-offscreen-calculator"),didMount:this.bindFn(this.didMountOffscreenCalc),willUnmount:this.bindFn(this.willUnmountOffscreenCalc),"aria-hidden":Ne.const("true")}),Ne.createElement("div",{class:Ne.const("dcg-columns")},Ne.createElement("div",{class:Ne.const("dcg-left-column")},Ne.createElement("div",{class:()=>({"dcg-graph-preview":!0,"dcg-preview-loading":this.pngDirty})},Ne.createElement(Gc,{predicate:()=>this.loaded},()=>Ne.createElement("img",{class:Ne.const("dcg-graph-image"),didMount:this.bindFn(this.didMountGraphPreview),src:()=>this.previewDataURL,alt:()=>this.controller.s("account-shell-narration-graph-preview")})),Ne.createElement(Gc,{predicate:()=>this.pngDirty},()=>Ne.createElement("span",{class:Ne.const("dcg-loading-message")},Ne.createElement("span",{class:Ne.const("dcg-spinner")}),()=>this.controller.s("account-shell-label-loading"))),Ne.createElement(Gc,{predicate:()=>!this.pngDirty&&!this.isExportingBraille()},()=>Ne.createElement("span",{class:Ne.const("dcg-zoom-percentage")},this.bindFn(this.getZoom))))),Ne.createElement("div",{class:Ne.const("dcg-right-column")},Ne.createElement("div",{role:Ne.const("heading"),"aria-level":Ne.const("2"),class:Ne.const("dcg-section-title")},()=>this.controller.s("account-shell-heading-export-size")),Ne.createElement(bx,{controller:this.props.controller,selectedSize:()=>this.size,selectSize:this.bindFn(this.selectSize)}),Ne.createElement(Gc,{predicate:()=>!this.isExportingBraille()},()=>Ne.createElement(jr,{staticConfig:this.bindFn(this.getLineThicknessOptions),ariaGroupLabel:()=>this.controller.s("account-shell-heading-line-thickness")})),Ne.createElement(Gc,{predicate:()=>this.isExportingBraille()},()=>Ne.createElement("div",{class:Ne.const("braille-container")},Ne.createElement("div",{role:Ne.const("heading"),"aria-level":Ne.const("2"),class:Ne.const("dcg-section-title")},()=>this.controller.s("shared-calculator-narration-braille-mode")),Ne.createElement(jr,{staticConfig:this.bindFn(this.getBrailleOptions),ariaGroupLabel:()=>this.controller.s("shared-calculator-narration-braille-mode")}),Ne.createElement("div",{class:Ne.const("braille-instructions")},Ne.createElement("div",{role:Ne.const("heading"),"aria-level":Ne.const("2"),class:Ne.const("dcg-section-title")},()=>this.controller.s("account-shell-heading-embossing-instructions")),Ne.createElement(Gc,{predicate:()=>this.size==="vpmax8"||this.size==="vpmax11"},()=>Ne.createElement("ul",null,Ne.createElement("li",null,()=>this.controller.s("account-shell-text-embossing-vpmax-save")),Ne.createElement("li",null,()=>this.controller.s("account-shell-text-embossing-vpmax-print",{size:t5(this.size)})))),Ne.createElement(Gc,{predicate:()=>this.size==="etc8"||this.size==="etc11"},()=>Ne.createElement("ul",null,Ne.createElement("li",null,()=>this.controller.s("account-shell-text-embossing-etc-save")),Ne.createElement("li",null,()=>this.controller.s("account-shell-text-embossing-etc-print",{size:t5(this.size)})))),Ne.createElement("div",{class:Ne.const("dcg-feedback-link")},Ne.createElement(un,{i18n:this.const(this.controller),key:this.const("graphing-calculator-text-export-braille-email-accessibility")},Ne.const("Feedback? Email"),Ne.const(" "),Ne.createElement("a",{class:Ne.const("blue-link"),href:Ne.const("mailto:accessibility@desmos.com")},Ne.const("accessibility@desmos.com")),Ne.const(".")))))),UJ(this.const(this.showDownloadButton),{true:()=>Ne.createElement("div",null,Ne.createElement("div",{role:Ne.const("group"),"aria-label":()=>this.controller.s("account-shell-narration-image-download"),class:()=>({"dcg-download-button-group":!0,"dcg-download-button-group-singleton":this.isExportingBraille()})},Ne.createElement(hh,{data:()=>this.previewBlob,enabled:()=>!this.pngDirty,filename:this.const("desmos-graph.png"),text:()=>this.controller.s("account-shell-button-download-png")}),Ne.createElement(Gc,{predicate:()=>!this.isExportingBraille()},()=>Ne.createElement("div",{role:Ne.const("button"),tabindex:()=>this.svgDirty?-1:0,"aria-disabled":()=>this.svgDirty,"aria-expanded":()=>this.svgDropdownOpen,"aria-label":()=>this.controller.s("account-shell-button-svg-options"),class:()=>({"dcg-svg-dropdown":!0,"dcg-button":!0,"dcg-disabled":this.svgDirty}),onTap:this.bindFn(this.toggleSvgDropdown)},Ne.createElement("i",{class:Ne.const("dcg-icon-caret-down"),"aria-hidden":Ne.const("true")})))),Ne.createElement(Gc,{predicate:()=>this.isExportingBraille()&&!al},()=>Ne.createElement(hh,{data:()=>this.brailleBlob,enabled:()=>!this.pngDirty,filename:this.const("desmos-equations.brl"),text:()=>this.controller.s("account-shell-button-download-braille"),isBraille:this.const(!0)})),Ne.createElement(Gc,{predicate:()=>this.svgDropdownOpen},()=>Ne.createElement("div",{class:Ne.const("dcg-svg-popover dcg-popover dcg-top"),didMount:this.bindFn(this.didMountSvgDropdown),willUnmount:this.bindFn(this.willUnmountSvgDropdown)},Ne.createElement("div",{class:Ne.const("dcg-popover-interior")},Ne.createElement(hh,{data:()=>this.svgBlob,enabled:()=>!this.svgDirty,filename:this.const("desmos-graph.svg"),text:()=>this.controller.s("account-shell-button-download-svg"),isSvg:this.const(!0)}),Ne.createElement("div",{class:Ne.const("dcg-beta-tag")},()=>this.controller.s("account-shell-label-beta"))),Ne.createElement("div",{class:Ne.const("dcg-arrow")})))),false:()=>Ne.createElement(Gc,{predicate:()=>!this.isExportingBraille()},()=>Ne.createElement("div",{class:Ne.const("dcg-download-not-enabled-notice")},Ne.createElement("div",{role:Ne.const("heading"),"aria-level":Ne.const("2"),class:Ne.const("dcg-title")},()=>this.controller.s("account-shell-heading-download-instructions")),()=>this.controller.s("account-shell-text-download-instructions")))})))))}getLineThicknessOptions(){return[{key:"thin",label:()=>this.controller.s("account-shell-button-line-thin"),selected:()=>this.thickness==="thin",onSelect:()=>this.selectThickness("thin")},{key:"medium",label:()=>this.controller.s("account-shell-button-line-medium"),selected:()=>this.thickness==="medium",onSelect:()=>this.selectThickness("medium")},{key:"thick",label:()=>this.controller.s("account-shell-button-line-thick"),selected:()=>this.thickness==="thick",onSelect:()=>this.selectThickness("thick")}]}getBrailleOptions(){return[{key:"nemeth",label:()=>this.controller.s("shared-calculator-button-braille-mode-nemeth"),selected:()=>this.brailleMode==="nemeth",onSelect:()=>this.selectBrailleMode("nemeth")},{key:"ueb",label:()=>this.controller.s("shared-calculator-button-braille-mode-ueb"),selected:()=>this.brailleMode==="ueb",onSelect:()=>this.selectBrailleMode("ueb")}]}didMountSvgDropdown(e){I(document).on("dcg-tap.svg-dropdown",({target:r})=>{let i=I(".dcg-svg-dropdown")[0];!e||!i||!i.contains(r)&&!e.contains(r)&&this.closeSvgDropdown()})}willUnmountSvgDropdown(){I(document).off(".svg-dropdown")}didMountOffscreenCalc(e){let i=this.controller.api.controller.isGeometry()?ku.Private.GeometryBeta:ku.GraphingCalculator;i&&(this.calculator=i(e,{expressions:!1,keypad:!1,branding:!1,border:!1,enableTabindex:!1}),this.calculator._calc.evaluator.notifyWhenSynced(()=>{this.markImagesDirty(),this.updateIfMounted()}),this.calculator.setState(this.controller.api.getState()))}willUnmountOffscreenCalc(){this.calculator&&this.calculator.destroy()}markImagesDirty(){this.pngDirty=!0,this.svgDirty=!0}selectSize(e){this.size=e,this.markImagesDirty(),this.updateIfMounted()}selectBrailleMode(e){this.brailleMode=e,this.markImagesDirty(),this.updateIfMounted()}getZoom(){return this.controller.s("account-shell-label-zoom",{value:Math.min(100,Math.round(100*400/this.getWidth()))})}selectThickness(e){this.thickness=e,this.markImagesDirty(),this.updateIfMounted()}didMountGraphPreview(e){this.previewImg=e}getGridOpacity(){switch(this.thickness){case"thick":return 1;case"medium":return .6;case"thin":return .4;default:return this.thickness}}getAxisWeight(){switch(this.thickness){case"thick":return 2;case"medium":return 2;case"thin":return 1.5;default:return this.thickness}}getGraphThickness(){switch(this.thickness){case"thick":return 5;case"medium":return 3.5;case"thin":return 2.5;default:return this.thickness}}getLabelSize(){if(this.size==="small_square")switch(this.thickness){case"thick":return 14;case"medium":return 12;case"thin":return 10;default:return this.thickness}else switch(this.thickness){case"thick":return 20;case"medium":return 17;case"thin":return 14;default:return this.thickness}}updateViewSettings(){if(this.calculator===void 0||this.calculator._calc===void 0||this.calculator._calc.grapher===void 0||this.calculator._calc.grapher.settings===void 0)return;let e=this.calculator._calc.grapher.settings;this.isExportingBraille()||(e.majorAxisOpacity=this.getGridOpacity(),e.minorAxisOpacity=this.getGridOpacity()/2,e.axisLineOffset=0,e.setProperty("axisLineWidth",this.getAxisWeight()),e.labelSize=this.getLabelSize(),e.graphLineWidth=this.getGraphThickness(),e.pointLineWidth=this.getGraphThickness()*3)}getBackgroundSize(){switch(this.size){case"medium_rectangle":case"large_rectangle":return"contain";case"small_square":return`${Ga.small_square.width}px ${Ga.small_square.height}px`;default:return"cover"}}getHeight(){return Ga[this.size].height}getWidth(){return Ga[this.size].width}didUnmount(){this.unmounted=!0}updateIfMounted(){this.unmounted||this.update()}updateGraphPreview(){if(!this.pngDirty&&!this.svgDirty||this.calculator===void 0||this.calculator._calc===void 0||this.calculator._calc.grapher===void 0||this.calculator._calc.grapher.settings===void 0)return;this.updateViewSettings();let e={width:this.getWidth(),height:this.getHeight(),preserveAxisNumbers:!0,showLabels:!0,targetPixelRatio:2},r={braille:{embosserModel:this.size,brailleMode:this.brailleMode}};if(this.pngDirty){let n=this.isExportingBraille()?r:e;this.calculator.asyncScreenshot(n,o=>{typeof o=="string"&&(this.previewDataURL=o,this.previewBlob=ZK(this.previewDataURL),this.pngDirty=!1,this.loaded=!0,this.updateIfMounted(),this.resizePreviewImg())})}if(this.svgDirty){var i=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},e),{svg:!0});let n=mi("worksheetSVG");n&&(i.targetPixelRatio=1),this.calculator.asyncScreenshot(i,o=>{typeof o=="string"&&(n&&(o=HJ(o)),o!==void 0&&(this.svgBlob=e5(o),this.svgDirty=!1,this.updateIfMounted(),this.resizePreviewImg()))})}}updateBrailleEquations(){if(this.isExportingBraille()){let e=KK(this.controller.api.controller,this.brailleMode);this.brailleBlob=new Blob([e],{type:"text/plain"})}}resizePreviewImg(){if(!this.previewImg)return;let e=1;(this.size==="etc8"||this.size==="etc11")&&(e=2),(this.size==="vpmax8"||this.size==="vpmax11")&&(e=1.5);let r=Math.min(this.getWidth(),400),n=this.getHeight()/this.getWidth()*r;this.previewImg.width=r*e,this.previewImg.height=n*e}willUpdate(){this.updateGraphPreview(),this.updateBrailleEquations()}isExportingBraille(){return qJ(this.size)}closeSvgDropdown(){this.svgDropdownOpen=!1,this.updateIfMounted()}toggleSvgDropdown(){this.svgDropdownOpen=!this.svgDropdownOpen,this.updateIfMounted()}};function qJ(t){return t==="vpmax8"||t==="vpmax11"||t==="etc8"||t==="etc11"}function t5(t){switch(t){case"etc8":return"8.5 x 11.0";case"etc11":return"11.5 x 11.0";case"vpmax8":return"8.5 x 11";case"vpmax11":return"11.5 x 11";default:return t}}function HJ(t){var e=new DOMParser,r=e.parseFromString(t,"text/xml");function i(n,o){r.querySelectorAll(n).forEach(o)}return i(".dcg-svg-region",function(n){n.setAttribute("fill","black")}),i(".dcg-svg-label *",function(n){n.setAttribute("stroke","none"),n.setAttribute("fill","black")}),i(".dcg-svg-axis-value text",function(n){n.getAttribute("stroke")!=="none"?n.parentElement&&n.parentElement.removeChild(n):(n.setAttribute("font-family","Helvetica Neue"),n.setAttribute("font-weight","bold"))}),i(".dcg-svg-offcenter-axis-value",function(n){n.parentElement&&n.parentElement.removeChild(n)}),i(".dcg-svg-curve",function(n){n.setAttribute("stroke","black"),n.setAttribute("stroke-width","5"),n.setAttribute("stroke-opacity","1")}),i(".dcg-svg-point",function(n){n.setAttribute("stroke","black"),n.setAttribute("stroke-width","10"),n.setAttribute("stroke-opacity","1")}),i(".dcg-svg-background",function(n){var o=parseFloat(n.getAttribute("width")),s=parseFloat(n.getAttribute("height")),a=3,l=r.createElementNS("http://www.w3.org/2000/svg","path");l.setAttribute("d",`M${o-a},${a}v${s-2*a}H${a}V${a}H${o-a} M${o},0H0v${s}h${o}V0L${o},0z`),n.parentElement.appendChild(l)}),i(".dcg-svg-axis-line",function(n){n.setAttribute("stroke","black"),n.setAttribute("stroke-width","4"),n.setAttribute("stroke-opacity","1")}),i(".dcg-svg-minor-gridline, .dcg-svg-major-gridline",function(n){n.setAttribute("stroke","black"),n.setAttribute("stroke-width","1"),n.setAttribute("stroke-opacity","1")}),r.firstChild.outerHTML}var _o=__dcg_shared_module_exports__['i'](Z());var Zk=class extends _o.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller,this.openTime=Date.now(),this.formErrors=[],this.controller.logJSON("shared-consent-modal",{action:"show-consent-modal"})}template(){return _o.createElement(Po,{title:()=>this.i18n.s("shared-title-consent"),size:this.const("narrow"),onClose:()=>this.controller.dispatch({type:"close-modal"}),i18n:this.props.controller},_o.createElement("div",{class:_o.const("dcg-shared-consent-modal-container dcg-shared-account-dialog")},_o.createElement("div",{class:_o.const("dcg-shared-consent-contents")},()=>this.i18n.s("shared-message-consent-information")),_o.createElement("div",{class:_o.const("dcg-shared-consent-contents")},()=>this.i18n.s("shared-message-consent-delete-information")),_o.createElement("div",{class:_o.const("dcg-shared-modal-actions-container")},_o.createElement("span",{role:_o.const("button"),tabindex:_o.const("0"),class:_o.const("dcg-shared-dark-gray-link"),onTap:e=>this.openAccountSettings(e.device)},()=>this.i18n.s("shared-button-go-to-account-settings")),_o.createElement("div",{role:_o.const("button"),tabindex:()=>this.isConsentingToCollection()?-1:0,"aria-disabled":()=>this.isConsentingToCollection(),class:()=>({"dcg-shared-btn-blue":!0,"dcg-disabled":this.isConsentingToCollection()}),onTap:this.bindFn(this.consentToCollection)},()=>this.i18n.s("shared-button-accept")),_o.createElement(Oo,{controller:this.props.controller,errors:()=>this.formErrors}))))}willUpdate(){this.formErrors=[],this.controller.userController.didPrivacyConsentFail()&&(this.formErrors=[this.controller.getSomethingWentWrongText()])}isConsentingToCollection(){return this.controller.userController.isConsentingToPrivacy()}didPrivacyConsentFail(){return this.controller.userController.didPrivacyConsentFail()}openAccountSettings(e){this.controller.logJSON("shared-consent-modal",{action:"edit-account",ts:Date.now()-this.openTime}),this.controller.dispatch({type:"show-modal",modal:"account-settings",device:e})}consentToCollection(){this.controller.logJSON("shared-consent-modal",{action:"consent",ts:Date.now()-this.openTime}),this.controller.userController.setPrivacyConsent({lang:this.controller.getLanguage()}),this.controller.dispatch({type:"close-modal"})}};var r5=`[
  "Afganistan",
  "Albania",
  "Algeria",
  "American Samoa",
  "Andorra",
  "Angola",
  "Anguilla",
  "Antigua & Barbuda",
  "Argentina",
  "Armenia",
  "Aruba",
  "Australia",
  "Austria",
  "Azerbaijan",
  "Bahamas",
  "Bahrain",
  "Bangladesh",
  "Barbados",
  "Belarus",
  "Belgium",
  "Belize",
  "Benin",
  "Bermuda",
  "Bhutan",
  "Bolivia",
  "Bonaire",
  "Bosnia & Herzegovina",
  "Botswana",
  "Brazil",
  "British Indian Ocean Ter",
  "Brunei",
  "Bulgaria",
  "Burkina Faso",
  "Burundi",
  "Cambodia",
  "Cameroon",
  "Canada",
  "Canary Islands",
  "Cape Verde",
  "Cayman Islands",
  "Central African Republic",
  "Chad",
  "Channel Islands",
  "Chile",
  "China",
  "Christmas Island",
  "Cocos Island",
  "Colombia",
  "Comoros",
  "Congo",
  "Cook Islands",
  "Costa Rica",
  "Cote DIvoire",
  "Croatia",
  "Cuba",
  "Curaco",
  "Cyprus",
  "Czech Republic",
  "Denmark",
  "Djibouti",
  "Dominica",
  "Dominican Republic",
  "East Timor",
  "Ecuador",
  "Egypt",
  "El Salvador",
  "Equatorial Guinea",
  "Eritrea",
  "Estonia",
  "Ethiopia",
  "Falkland Islands",
  "Faroe Islands",
  "Fiji",
  "Finland",
  "France",
  "French Guiana",
  "French Polynesia",
  "French Southern Ter",
  "Gabon",
  "Gambia",
  "Georgia",
  "Germany",
  "Ghana",
  "Gibraltar",
  "Great Britain",
  "Greece",
  "Greenland",
  "Grenada",
  "Guadeloupe",
  "Guam",
  "Guatemala",
  "Guinea",
  "Guyana",
  "Haiti",
  "Hawaii",
  "Honduras",
  "Hong Kong",
  "Hungary",
  "Iceland",
  "Indonesia",
  "India",
  "Iran",
  "Iraq",
  "Ireland",
  "Isle of Man",
  "Israel",
  "Italy",
  "Jamaica",
  "Japan",
  "Jordan",
  "Kazakhstan",
  "Kenya",
  "Kiribati",
  "Korea North",
  "Korea Sout",
  "Kuwait",
  "Kyrgyzstan",
  "Laos",
  "Latvia",
  "Lebanon",
  "Lesotho",
  "Liberia",
  "Libya",
  "Liechtenstein",
  "Lithuania",
  "Luxembourg",
  "Macau",
  "Macedonia",
  "Madagascar",
  "Malaysia",
  "Malawi",
  "Maldives",
  "Mali",
  "Malta",
  "Marshall Islands",
  "Martinique",
  "Mauritania",
  "Mauritius",
  "Mayotte",
  "Mexico",
  "Midway Islands",
  "Moldova",
  "Monaco",
  "Mongolia",
  "Montserrat",
  "Morocco",
  "Mozambique",
  "Myanmar",
  "Nambia",
  "Nauru",
  "Nepal",
  "Netherland Antilles",
  "Netherlands",
  "Nevis",
  "New Caledonia",
  "New Zealand",
  "Nicaragua",
  "Niger",
  "Nigeria",
  "Niue",
  "Norfolk Island",
  "Norway",
  "Oman",
  "Pakistan",
  "Palau Island",
  "Palestine",
  "Panama",
  "Papua New Guinea",
  "Paraguay",
  "Peru",
  "Phillipines",
  "Pitcairn Island",
  "Poland",
  "Portugal",
  "Puerto Rico",
  "Qatar",
  "Republic of Montenegro",
  "Republic of Serbia",
  "Reunion",
  "Romania",
  "Russia",
  "Rwanda",
  "St Barthelemy",
  "St Eustatius",
  "St Helena",
  "St Kitts-Nevis",
  "St Lucia",
  "St Maarten",
  "St Pierre & Miquelon",
  "St Vincent & Grenadines",
  "Saipan",
  "Samoa",
  "Samoa American",
  "San Marino",
  "Sao Tome & Principe",
  "Saudi Arabia",
  "Senegal",
  "Seychelles",
  "Sierra Leone",
  "Singapore",
  "Slovakia",
  "Slovenia",
  "Solomon Islands",
  "Somalia",
  "South Africa",
  "Spain",
  "Sri Lanka",
  "Sudan",
  "Suriname",
  "Swaziland",
  "Sweden",
  "Switzerland",
  "Syria",
  "Tahiti",
  "Taiwan",
  "Tajikistan",
  "Tanzania",
  "Thailand",
  "Togo",
  "Tokelau",
  "Tonga",
  "Trinidad & Tobago",
  "Tunisia",
  "Turkey",
  "Turkmenistan",
  "Turks & Caicos Is",
  "Tuvalu",
  "Uganda",
  "United Kingdom",
  "Ukraine",
  "United Arab Erimates",
  "United States",
  "Uraguay",
  "Uzbekistan",
  "Vanuatu",
  "Vatican City State",
  "Venezuela",
  "Vietnam",
  "Virgin Islands (Brit)",
  "Virgin Islands (USA)",
  "Wake Island",
  "Wallis & Futana Is",
  "Yemen",
  "Zaire",
  "Zambia",
  "Zimbabwe"
]
`;var Y=__dcg_shared_module_exports__['i'](Z());var li=__dcg_shared_module_exports__['i'](Z());var{If:eG,For:$J,Input:WJ}=li.Components,ff=class extends li.Class{constructor(){super(...arguments),this.filter=void 0,this.focusLocation=void 0,this.lastResultCount=0}template(){return li.createElement("div",{class:li.const("dcg-search-container"),onKeydown:this.bindFn(this.onKeydown)},li.createElement(eG,{predicate:this.props.renderWithInput},()=>li.createElement("div",{role:li.const("search"),class:li.const("dcg-searchable-dropdown")},li.createElement(WJ,{didMount:this.bindFn(this.didMountInput),onInput:this.bindFn(this.onInputChange),value:this.bindFn(this.getFilterString),placeholder:()=>this.props.placeholder(),manageFocus:this.const({shouldBeFocused:this.bindFn(this.shouldFilterBeFocused),onFocusedChanged:this.bindFn(this.onFilterFocusChange)})}),li.createElement(eG,{predicate:()=>this.shouldShowDeleteX()},()=>li.createElement("div",{class:li.const("dcg-remove-x dcg-do-not-blur")},li.createElement("span",{class:li.const("dcg-icon-remove"),onTap:this.bindFn(this.onDeleteXTapped)}))))),li.createElement(eG,{predicate:()=>this.getFilteredOptions().length>0},()=>li.createElement("div",{class:li.const("dcg-searchable-dropdown-list-container")},li.createElement($J,{each:()=>this.getFilteredOptions(),key:e=>e.id+"-"+e.label},li.createElement("div",{class:()=>({"dcg-searchable-dropdown-list":!0,"dcg-do-not-blur":!0,"dcg-no-input":!this.props.renderWithInput()}),role:li.const("listbox"),"aria-label":li.const("Results")},e=>li.createElement("div",{class:li.const("dcg-searchable-dropdown-option"),role:li.const("option"),onTap:r=>this.selectOption(e,r.device==="keyboard"),manageFocus:this.const({shouldBeFocused:()=>this.shouldOptionBeFocused(e),onFocusedChanged:r=>this.onOptionFocusChange(e,r)}),tabindex:li.const(0)},this.const(e.label)))))),li.createElement(eG,{predicate:()=>this.getFilteredOptions().length===0},()=>li.createElement("div",{class:li.const("dcg-searchable-dropdown-list dcg-no-search-results")},li.const("No results."))))}didMountInput(){this.focusFilter()}shouldShowDeleteX(){return!!this.getFilterString()}onDeleteXTapped(){this.filter=void 0,this.focusFilter(),this.update()}shouldFilterBeFocused(){return this.focusLocation&&this.focusLocation.type==="filter"}onFilterFocusChange(e){e?this.focusFilter():(this.filter=void 0,this.focusLocation=void 0,this.update())}shouldOptionBeFocused(e){return this.focusLocation&&this.focusLocation.type==="option"&&this.focusLocation.id===e.id}focusFilter(){this.focusLocation={type:"filter"},this.update()}focusOption(e){this.focusLocation={type:"option",id:e.id},this.update()}getFocusedOptionIndex(){if(!this.focusLocation||this.focusLocation.type!=="option")return-1;for(var e=this.focusLocation.id,r=this.getFilteredOptions(),i=0;i<r.length;i++){var n=r[i];if(n.id===e)return i}return-1}onOptionFocusChange(e,r){r?this.focusOption(e):(this.focusLocation=void 0,this.update())}onKeydown(e){switch(Te(e)){case ll:if(this.shouldFilterBeFocused()){var r=this.getFilteredOptions();r.length===1&&this.selectOption(r[0],!0)}break;case Jn:this.moveFocusInDirection(-1)&&e.preventDefault();break;case Yn:this.moveFocusInDirection(1)&&e.preventDefault();break;case Vh:e.preventDefault(),this.focusFirstOption();break;case Gh:e.preventDefault(),this.focusLastOption();break;case jn:this.props.onCancel();break;case Oa:e.shiftKey?this.moveFocusInDirection(-1)&&e.preventDefault():this.moveFocusInDirection(1)&&e.preventDefault();break}}moveFocusInDirection(e){var r=this.getFilteredOptions(),i=this.getFocusedOptionIndex(),n=i+e;if(n==-1&&this.props.renderWithInput())return this.focusFilter(),!0;var o=r[n];return o?(this.focusOption(o),!0):!1}focusFirstOption(){var e=this.getFilteredOptions();e.length!==0&&this.focusOption(e[0])}focusLastOption(){var e=this.getFilteredOptions();e.length!==0&&this.focusOption(e[e.length-1])}onInputChange(e){this.filter=e,this.update()}getFilterString(){return this.filter||""}selectOption(e,r){this.filter=void 0,this.focusLocation=void 0,this.update(),this.props.onChange({value:e.id,fromKeyboard:r})}getFilteredOptions(){var e=this.props.options(),r=(this.filter||"").toLowerCase().trim();return r&&(e=e.filter(function(i){return i.label.toLowerCase().indexOf(r)!==-1})),e}onUpdate(){let e=this.getFilteredOptions().length;if(this.focusLocation&&this.focusLocation.type==="filter"&&e!==this.lastResultCount)switch(e){case 0:me("No results");break;case 1:me("1 result");break;default:me(`${e} results`)}this.lastResultCount=e}};Oe();function L0(){return Bn("/account/logout_xhr")}function i5(t){let e=function(){return Bn("/account/login_xhr",t)};return L0().then(e,e).then(()=>Gu({lang:t.lang}))}function Gu(t){return aa("/account/user_info",t)}function n5(){let t=I.Deferred();return aa("/account/user_info?no401").then(function(e){e&&e.loggedIn===!1?t.reject(e):t.resolve(e)},function(e){t.reject(e)}),t.promise()}function o5(t){return Bn("/account/check_account_status",t)}function s5(t){return Bn("/account/register_xhr",t).then(()=>Gu({lang:t.lang}))}function a5(t){return Bn("/account/change_name",t).then(()=>Gu({lang:t.lang}))}function l5(t){return Bn("/account/change_name_detail",{lang:t.lang,userProvidedName:{given:t.given,family:t.family}}).then(()=>Gu({lang:t.lang}))}function c5(t){return Bn("/account/recover_xhr",t)}function d5(t){return aa("/account/initiate_delete_account",t)}function h5(t){return aa("/account/initiate_email_change",t)}function p5(t){return Bn("/account/set_email",t).then(()=>Gu({lang:t.lang}))}function u5(t){return KL("/account/update_feature_flags",t).then(()=>Gu({lang:t.lang}))}function g5(t){return Bn("/account/set_privacy_consent",t).then(()=>Gu({lang:t.lang}))}function m5(t){return Bn("/account/submit_art_contest_entry",t)}function f5(){return Bn("/account/check_art_contest_entry",{})}var{If:mp,IfElse:b5,Input:w5,SwitchUnion:jJ,Textarea:JJ}=Y.Components,YJ=JSON.parse(r5).map(function(t){return{id:t,label:t}}),x5=[];for(vx=2020;vx>=1900;vx--)x5.push({id:vx+"",label:vx+""});var vx,XJ={China:14,"Hong Kong":18,India:18,Indonesia:18,Phillipines:18,Russia:18,Austria:14,Belgium:13,Bulgaria:14,Croatia:16,Cyprus:14,"Czech Republic":15,Denmark:13,Estonia:13,Finland:13,France:15,Germany:16,Greece:15,Hungary:16,Ireland:16,Italy:14,Latvia:13,Lithuania:14,Luxembourg:16,Malta:13,Netherlands:16,Norway:13,Poland:16,Portugal:13,Romania:16,Slovakia:16,Slovenia:15,Spain:14,Sweden:13,Switzerland:16,"United Kingdom":13,Canada:13,"United States":13},Cx=class extends Y.Class{didUnmount(){this.unmounted=!0}init(){this.controller=this.props.controller(),this.selectedData={},this.userOwnsGraph=!1,this.isSubmittingEntry=!1,this.isVerifyingEligility=!1,this.controller.state.artContestURLFromShareMenu&&(this.overwriteGraphURL=this.controller.state.artContestURLFromShareMenu,this.controller.state.artContestURLFromShareMenu=void 0),Mi("art-contest::open-modal",{from:this.overwriteGraphURL?"share":"top-bar"}),this.checkForExistingSubmission()}getScreen(){return this.isCheckingSubmission?"checking-submission":this.currentSubmission?"showing-submission":this.shouldShowSaveAnimation()?"saving":this.shouldShowSaveFailed()?"save-failed":this.didSubmissionFail?"submit-failed":this.isSubmittingEntry?"submitting":this.didSubmissionSucceed?"submitted":this.isVerifyingEligility?"form":!this.userOwnsGraph||!this.isLoggedIn()?"ask-intention":"form"}template(){return Y.createElement(Vl,{controller:this.props.controller},Y.createElement("div",{class:Y.const("dcg-contest-submission-dialog")},jJ(()=>this.getScreen(),{"checking-submission":()=>Y.createElement("div",{class:Y.const("dcg-save-animation-container dcg-contest-checking-submission-screen")},Y.createElement("div",{class:Y.const("dcg-saving")},Y.createElement("div",{class:Y.const("dcg-save-animation"),"aria-live":Y.const("polite"),"aria-atomic":Y.const("true")},Y.createElement("span",{class:Y.const("dcg-spinner")}),()=>"Checking submission"))),"check-failed":()=>Y.createElement("div",{class:Y.const("dcg-save-animation-container")},Y.createElement("div",{class:Y.const("dcg-saving")},Y.createElement("div",{class:Y.const("dcg-save-animation"),"aria-live":Y.const("polite"),"aria-atomic":Y.const("true")},()=>"Check failed"))),"showing-submission":()=>Y.createElement("div",{class:Y.const("dcg-art-contest-info-container")},Y.createElement("div",{class:Y.const("dcg-art-contest-world-image dcg-art-contest-submission-thumbnail")},Y.createElement("img",{src:()=>{var e;return(e=this.currentSubmission)==null?void 0:e.thumbURL},alt:()=>this.controller.s("account-shell-label-submission-received")})),Y.createElement("div",{class:Y.const("dcg-contest-about")},Y.createElement("div",{role:Y.const("heading"),"aria-level":Y.const("1"),class:Y.const("dcg-contest-submission-title")},()=>this.controller.s("account-shell-label-submission-already-received")),Y.createElement("div",{class:Y.const("dcg-contest-text")},Y.createElement(un,{i18n:this.const(this.controller),key:this.const("account-shell-text-art-contest-submission-already-received")},Y.createElement("div",null,Y.const("Your previous submission to the Global Math Art Contest was successfully received! You can click the link below to update your submission, any time before January 15th."))),Y.createElement("div",{class:Y.const("dcg-submission-section")},Y.createElement("div",{class:Y.const("dcg-submission-header")},()=>this.controller.s("account-shell-heading-name")),Y.createElement("div",{class:Y.const("dcg-submission-content")},()=>{var e;return(e=this.currentSubmission)==null?void 0:e.name})),Y.createElement("div",{class:Y.const("dcg-submission-section")},Y.createElement("div",{class:Y.const("dcg-submission-header")},()=>this.controller.s("account-shell-heading-email")),Y.createElement("div",{class:Y.const("dcg-submission-content")},()=>{var e;return(e=this.currentSubmission)==null?void 0:e.email})),Y.createElement("div",{class:Y.const("dcg-submission-section")},Y.createElement("div",{class:Y.const("dcg-submission-header")},()=>this.controller.s("account-shell-heading-artist-statement")),Y.createElement("div",{class:Y.const("dcg-submission-content")},()=>{var e;return(e=this.currentSubmission)==null?void 0:e.artistStatement}))),Y.createElement("div",null,Y.createElement("div",{class:Y.const("dcg-resubmit-link"),onTap:this.bindFn(this.submitANewGraph),tabindex:Y.const(0),role:Y.const("button")},()=>this.controller.s("account-shell-button-update-graph"))))),saving:()=>Y.createElement("div",{class:Y.const("dcg-save-animation-container")},Y.createElement("div",{class:Y.const("dcg-saving")},Y.createElement("div",{class:Y.const("dcg-save-animation"),"aria-live":Y.const("polite"),"aria-atomic":Y.const("true")},Y.createElement("span",{class:Y.const("dcg-spinner")}),()=>this.controller.s("account-shell-label-saving-graph")))),"save-failed":()=>Y.createElement("div",{class:Y.const("dcg-save-animation-container")},Y.createElement("div",{class:Y.const("dcg-saving")},Y.createElement("div",{class:Y.const("dcg-save-animation"),"aria-live":Y.const("polite"),"aria-atomic":Y.const("true")},()=>this.controller.s("account-shell-error-save-art-contest")))),submitting:()=>Y.createElement("div",{class:Y.const("dcg-save-animation-container")},Y.createElement("div",{class:Y.const("dcg-saving")},Y.createElement("div",{class:Y.const("dcg-save-animation"),"aria-live":Y.const("polite"),"aria-atomic":Y.const("true")},Y.createElement("span",{class:Y.const("dcg-spinner")}),()=>this.controller.s("account-shell-label-submitting")))),"submit-failed":()=>Y.createElement("div",{class:Y.const("dcg-save-animation-container")},Y.createElement("div",{class:Y.const("dcg-saving")},Y.createElement("div",{class:Y.const("dcg-save-animation"),"aria-live":Y.const("polite"),"aria-atomic":Y.const("true")},()=>this.controller.s("account-shell-error-submitting")))),submitted:()=>Y.createElement("div",{class:Y.const("dcg-save-animation-container")},Y.createElement("div",{class:Y.const("dcg-art-contest-success-image")},Y.createElement("img",{src:Y.const("/assets/img/contest/submitted.jpg"),alt:()=>this.controller.s("account-shell-text-alt-text-success")})),Y.createElement("div",{class:Y.const("dcg-save-success"),"aria-live":Y.const("polite"),"aria-atomic":Y.const("true")},()=>this.controller.s("account-shell-label-submission-received"),Y.createElement("div",{class:Y.const("dcg-save-animation-content")},Y.createElement("div",null,Y.createElement("div",{class:Y.const("dcg-congrats-message")},Y.createElement(un,{i18n:this.const(this.controller),key:this.const("account-shell-text-art-contest-success-paragraph")},Y.const("If you'd like to revise your submission, feel free to resubmit anytime before"),Y.createElement("span",{class:Y.const("bold-text")},Y.const(" January 15th")),Y.const(". We'll only look at the most recent submission."))),Y.createElement("div",{class:Y.const("dcg-congrats-message")},()=>this.controller.s("account-shell-text-art-contest-congratulations")))))),"ask-intention":()=>Y.createElement("div",{class:Y.const("dcg-art-contest-info-container")},Y.createElement("div",{class:Y.const("dcg-art-contest-world-image")},Y.createElement("img",{src:Y.const("/assets/img/contest/globe.png"),alt:()=>this.controller.s("account-shell-text-alt-text-art-contest")})),Y.createElement("div",{class:Y.const("dcg-contest-about")},Y.createElement("div",{role:Y.const("heading"),"aria-level":Y.const("1"),class:Y.const("dcg-contest-submission-title")},()=>this.controller.s("account-shell-heading-math-art-contest")),Y.createElement("div",{class:Y.const("dcg-contest-text")},Y.createElement(un,{i18n:this.const(this.controller),key:this.const("account-shell-text-art-contest-about-paragraph")},Y.const("Want to share your awesome graph with the world? Students ages 13+ can enter the Desmos Global Math Art Contest before"),Y.createElement("span",{class:Y.const("bold-text")},Y.const(" January 15th ")),Y.const("for a chance to be featured on our website and win other prizes!"),Y.const(" "),Y.createElement("a",{class:Y.const("dcg-shared-blue-link"),href:()=>this.getBlogPostURL(),target:Y.const("_blank"),didMount:e=>e.focus()},Y.const("Learn more")))),Y.createElement("div",null,Y.createElement(mp,{predicate:()=>!this.getCannotSubmitReason()},()=>Y.createElement("div",{class:()=>({"dcg-btn-blue":!0,"dcg-submit-this-graph-btn":!0,"dcg-disabled":this.shouldDisableSubmitThisGraph()}),onTap:this.bindFn(this.chooseSubmitThisGraph),tabindex:Y.const(0),role:Y.const("button")},()=>this.controller.s("account-shell-button-submit-graph"))),Y.createElement(mp,{predicate:()=>!!this.getCannotSubmitReason()},()=>Y.createElement("div",{class:Y.const("dcg-cannot-submit-reason")},()=>this.getCannotSubmitReason())),Y.createElement("div",{class:Y.const("age-check-container")},()=>this.controller.s("account-shell-text-contest-under-16"),Y.const(" "),Y.createElement("a",{class:Y.const("dcg-shared-blue-link"),onTap:this.bindFn(this.chooseVerifyEligibility)},()=>this.controller.s("account-shell-text-contest-verify-eligibility")))))),form:()=>Y.createElement("div",null,Y.createElement("div",{role:Y.const("heading"),"aria-level":Y.const("1"),class:Y.const("dcg-contest-submission-title")},()=>this.controller.s("account-shell-heading-submit-graph")),Y.createElement("div",{class:Y.const("dcg-submission-form")},Y.createElement("div",{class:Y.const("dcg-country-and-year")},Y.createElement("div",{class:Y.const("dcg-form-section")},Y.createElement("div",{class:Y.const("dcg-section-title")},()=>this.controller.s("account-shell-heading-country")),Y.createElement(mp,{predicate:()=>!!this.getSelectedCountry()},()=>Y.createElement("span",{class:Y.const("dcg-shared-blue-link dcg-clear-country"),onTap:()=>this.setSelectedCountry(void 0),tabindex:Y.const(0),role:Y.const("button"),"aria-label":()=>this.controller.s("account-shell-narration-clear-selected-country")},()=>this.controller.s("account-shell-button-clear"))),b5(()=>!!this.getSelectedCountry(),{true:()=>Y.createElement("div",{class:Y.const("dcg-your-country-name")},()=>this.getSelectedCountry()),false:()=>Y.createElement(ff,{options:()=>this.getListOfCountries(),onChange:e=>this.setSelectedCountry(e.value),onCancel:()=>this.setSelectedCountry(void 0),renderWithInput:()=>!0,placeholder:()=>this.controller.s("account-shell-label-country-placeholder")})})),Y.createElement(mp,{predicate:()=>this.shouldShowAgeOptions()},()=>Y.createElement("div",{class:Y.const("dcg-form-section")},Y.createElement("div",{class:Y.const("dcg-section-title")},()=>this.controller.s("account-shell-heading-birth-year")),b5(()=>!!this.getSelectedYear(),{true:()=>Y.createElement("div",{class:Y.const("dcg-your-birth-year")},()=>this.getSelectedYear()),false:()=>Y.createElement(ff,{options:()=>this.getListOfYears(),onChange:e=>this.setSelectedYear(e.value),onCancel:()=>this.setSelectedYear(void 0),renderWithInput:()=>!0,placeholder:()=>this.controller.s("account-shell-label-birth-year-placeholder")})})))),Y.createElement(mp,{predicate:()=>this.shouldShowEligible()&&!this.getCannotSubmitReason()},()=>Y.createElement("div",{class:Y.const("dcg-eligible-message dcg-teal-notice")},Y.const("\u{1F389} "),()=>this.controller.s("account-shell-label-you-are-eligible"))),Y.createElement(mp,{predicate:()=>this.shouldShowConsentOptions()},()=>Y.createElement("div",null,Y.createElement("div",{class:Y.const("dcg-form-section-flex")},Y.createElement("div",{class:Y.const("dcg-form-section")},Y.createElement("div",{class:Y.const("dcg-section-title")},()=>this.controller.s("account-shell-heading-name")),Y.createElement("div",{class:Y.const("dcg-section-subtitle")},()=>this.controller.s("account-shell-heading-name-details")),Y.createElement(w5,{class:this.const("dcg-shared-input-blue-outline"),onInput:e=>this.setUserName(e),value:this.bindFn(this.getUserName),placeholder:()=>this.controller.s("account-shell-label-full-name"),disabled:()=>!1})),Y.createElement("div",{class:Y.const("dcg-form-section")},Y.createElement("div",{class:Y.const("dcg-section-title")},()=>this.controller.s("account-shell-heading-email")),Y.createElement("div",{class:Y.const("dcg-section-subtitle")},()=>this.controller.s("account-shell-heading-email-details")),Y.createElement(w5,{class:this.const("dcg-shared-input-blue-outline"),onInput:e=>this.setUserEmail(e),value:this.bindFn(this.getUserEmail),placeholder:()=>this.controller.s("account-shell-label-email-address"),disabled:()=>!1}))),Y.createElement("div",{class:Y.const("dcg-form-section")},Y.createElement("div",{class:Y.const("dcg-section-title")},()=>this.controller.s("account-shell-heading-artist-statement")),Y.createElement("div",{class:Y.const("dcg-section-subtitle")},()=>this.controller.s("account-shell-label-artiist-statement-description")),Y.createElement(JJ,{class:this.const("dcg-shared-input-blue-outline dcg-artist-statement-input"),onInput:e=>this.setArtistStatement(e),value:this.bindFn(this.getArtistStatement),maxlength:this.const(900),placeholder:()=>this.controller.s("account-shell-label-artist-statement-placeholder")})),Y.createElement(Dt,{checked:this.bindFn(this.getConsentTicked),onChange:this.bindFn(this.toggleConsent)},()=>this.controller.s("account-shell-text-art-contest-copyright-agreement")),Y.createElement("div",{class:()=>({"dcg-btn-blue":!0,"dcg-disabled":this.isSubmitButtonDisabled(),"dcg-submit-this-graph-btn":!0}),onTap:this.bindFn(this.submitEntry),tabindex:Y.const(0)},()=>this.controller.s("account-shell-button-submit-graph")),Y.createElement("div",{class:Y.const("dcg-disclaimer")},()=>this.controller.s("account-shell-text-art-contest-legal-disclaimer")))),Y.createElement(mp,{predicate:()=>this.shouldShowEligible()&&!!this.getCannotSubmitReason()},()=>Y.createElement("div",{class:Y.const("dcg-login-notice dcg-teal-notice")},Y.const("\u{1F389} "),()=>this.controller.s("account-shell-label-you-are-eligible"),Y.const(" "),()=>this.getCannotSubmitReason())),Y.createElement(mp,{predicate:()=>this.shouldShowIneligible()},()=>Y.createElement("div",{class:Y.const("dcg-ineligible-container")},Y.createElement("i",{class:Y.const("dcg-icon-error"),"aria-hidden":Y.const("true")}),Y.createElement(un,{i18n:this.const(this.controller),key:this.const("account-shell-text-artcontest-ineligible")},Y.createElement("div",{class:Y.const("dcg-ineligible-text-container")},Y.createElement("div",{class:Y.const("dcg-ineligible-text")},Y.const("Based on your age and location, we aren\u2019t able to accept a graph submission from you this year.")),Y.createElement("div",{class:Y.const("dcg-ineligible-text")},Y.const("Keep up the awesome graphing! There will be new contests every year."))))))))})))}getABActivityURL(){return"https://teacher.desmos.com/activitybuilder/custom/618be410b284c40a2c7b9111"}getBlogPostURL(){return"https://blog.desmos.com/articles/art-contest-launch-2022/"}returnToOpeningScreen(){this.isVerifyingEligility=!1,this.userOwnsGraph=!1,this.selectedData={email:this.selectedData.email,name:this.selectedData.name},this.update()}getGraphURL(){if(this.overwriteGraphURL)return this.overwriteGraphURL;var e=this.controller.graphsController.currentGraph,r=e&&e.hash||"";return"https://www.desmos.com/calculator/"+r}overwriteEntry(){this.selectedData.overwrite=!0,this.submitEntry()}checkForExistingSubmission(){this.isLoggedIn()&&(this.isCheckingSubmission=!0,this.currentSubmission=void 0,Mi("art-contest::checking-submission",{}),f5().done(e=>{e.thumbURL?(this.currentSubmission=e,Mi("art-contest::found-submission",{})):e.notFound?Mi("art-contest::found-no-submission",{}):(Mi("art-contest::check-failed",e),me(this.controller.s("account-shell-error-submitting")))}).fail(e=>{me(this.controller.s("account-shell-error-submitting")),Mi("art-contest::check-failed",e)}).always(()=>{this.isCheckingSubmission=!1,this.unmounted||this.update()}))}submitEntry(){if(this.isSubmitButtonDisabled())return;this.didSubmissionFail=!1,this.isSubmittingEntry=!0;let e={name:this.getUserName(),email:this.getUserEmail(),url:this.getGraphURL(),year:this.getSelectedYear(),ageGroup:this.getSelectedAgeGroup(),country:this.getSelectedCountry(),artistStatement:this.getArtistStatement(),overwrite:!0,lang:this.controller.getLanguage()};this.update(),Mi("art-contest::submit-sending",e),m5(e).done(r=>{r.previousSubmissionURL||(r.success?(this.didSubmissionSucceed=!0,Mi("art-contest::submit-success",{})):(this.didSubmissionFail=!0,Mi("art-contest::submit-failed",{}),me(this.controller.s("account-shell-error-submitting"))))}).fail(()=>{me(this.controller.s("account-shell-error-submitting")),this.didSubmissionFail=!0,Mi("art-contest::submit-failed",{})}).always(()=>{this.isSubmittingEntry=!1,this.unmounted||this.update()})}shouldShowSaveAnimation(){return!!this.saveInProgress}shouldShowSaveFailed(){return!!this.didSaveFail}chooseVerifyEligibility(){this.isVerifyingEligility=!0,this.update()}submitANewGraph(){this.currentSubmission=void 0,this.update()}chooseSubmitThisGraph(){if(!this.shouldDisableSubmitThisGraph()){if(this.isVerifyingEligility=!1,this.overwriteGraphURL||!this.controller.graphsController.hasUnsavedChanges()){this.userOwnsGraph=!0,this.update(),Mi("art-contest::choose-form",{});return}this.saveInProgress=!0,Mi("art-contest::save-sending",{}),this.update(),this.controller.graphsController.shareGraph().done(e=>{this.didSaveFail=!1,this.saveInProgress=!1,this.userOwnsGraph=!0,this.overwriteGraphURL="https://www.desmos.com/calculator/"+e.hash,Mi("art-contest::save-success",{url:this.overwriteGraphURL})}).fail(()=>{this.didSaveFail=!0,Mi("art-contest::save-failed",{})}).always(()=>{this.saveInProgress=!1,this.unmounted||this.update()})}}isLoggedIn(){return this.controller.isLoggedIn()}getCannotSubmitReason(){return this.isLoggedIn()?this.controller.isGraphComplexEnoughForContest()?"":this.controller.s("account-shell-text-art-contest-notice-default"):this.controller.s("account-shell-text-art-contest-notice-login")}shouldDisableSubmitThisGraph(){return!!this.getCannotSubmitReason()}shouldShowSubmissionOptions(){return this.isVerifyingEligility?!1:!this.userOwnsGraph||!this.isLoggedIn()}shouldShowCountryOptions(){return!this.shouldShowSubmissionOptions()}shouldShowAgeOptions(){return!(!this.shouldShowCountryOptions()||!this.getSelectedCountry())}shouldShowIneligible(){return!this.getSelectedCountry()||!this.getSelectedYear()?!1:!this.isSubmissionEligible()}shouldShowEligible(){return this.isVerifyingEligility?this.isSubmissionEligible():!1}setArtistStatement(e){this.selectedData.artistStatement=e,this.update()}setSelectedYear(e){this.selectedData.year!==e&&(this.selectedData.year=e,this.update(),Mi("art-contest::select-year",{year:e}))}setSelectedCountry(e){this.selectedData={country:e,name:this.controller.userController.name,email:this.controller.userController.email},this.update(),Mi("art-contest::select-country",{country:e})}getArtistStatement(){return this.selectedData.artistStatement||""}getSelectedCountry(){return this.selectedData.country}getSelectedYear(){return this.selectedData.year}getUserAgeInYears(){return 2022-parseFloat(this.selectedData.year||"")}getSelectedAgeGroup(){var e=this.getUserAgeInYears();return e>=19?"19+":e>=17?"17-18":e>=15?"15-16":e>=13?"13-14":""}getUserName(){return this.selectedData.name||""}setUserName(e){this.selectedData.name=e,this.update()}getUserEmail(){return this.selectedData.email||""}setUserEmail(e){this.selectedData.email=e,this.update()}getConsentTicked(){return!!this.selectedData.consent}getOverwriteTicked(){return!!this.selectedData.overwrite}toggleConsent(){this.selectedData.consent=!this.selectedData.consent,this.update(),Mi("art-contest::toggle-consent",{consent:this.selectedData.consent})}isSubmitButtonDisabled(){return!!(this.isSubmittingEntry||!this.selectedData.country||!this.selectedData.year||!this.selectedData.email||!this.selectedData.artistStatement||!this.selectedData.name||!this.selectedData.consent)}isSubmissionEligible(){if(!this.selectedData.country||!this.selectedData.year)return!1;var e=XJ[this.selectedData.country]||16,r=this.getUserAgeInYears();return r>=e}shouldShowConsentOptions(){return this.isVerifyingEligility&&this.getCannotSubmitReason()?!1:this.isSubmissionEligible()}getListOfCountries(){return YJ}getListOfYears(){return x5}};var Al=__dcg_shared_module_exports__['i'](Z());var tG=class extends Al.Class{init(){this.controller=this.props.controller(),this.i18n=this.controller}template(){return Al.createElement(Po,{title:()=>this.i18n.s("shared-title-account-reactivated"),size:this.const("narrow"),showX:this.const(!0),onClose:()=>this.controller.dispatch({type:"close-modal"}),i18n:this.props.controller},Al.createElement("div",{class:Al.const("dcg-shared-recover-password-dialog dcg-shared-account-dialog")},Al.createElement("div",{class:Al.const("dcg-shared-account-paragraph")},()=>this.i18n.s("shared-message-account-reactivated")),Al.createElement("div",{class:Al.const("dcg-shared-modal-actions-container")},Al.createElement("button",{class:()=>({"dcg-shared-btn-blue":!0}),onTap:()=>this.controller.dispatch({type:"close-modal"})},()=>this.i18n.s("shared-button-continue-to-desmos")))))}};var Ai=__dcg_shared_module_exports__['i'](Z());Wl();var{IfDefined:QJ,For:ZJ}=Ai.Components,rG={"dcg-actions":{label:"account-shell-label-feature-flag-actions",description:"account-shell-text-feature-flag-actions-description",learnMoreLink:"https://help.desmos.com/hc/en-us/articles/4407725009165"}},iG=class extends Ai.Class{init(){this.formErrors=[]}template(){return Ai.createElement("div",{class:Ai.const("dcg-advanced-settings")},Ai.createElement("div",{class:Ai.const("dcg-shared-account-paragraph")},()=>this.props.controller().s("account-shell-text-advanced-preferences-instructions")),Ai.createElement(ZJ,{each:()=>__dcg_shared_module_exports__['C'](rG)},Ai.createElement("div",{class:Ai.const("dcg-feature-flag-list")},e=>Ai.createElement("div",null,Ai.createElement(Dt,{checked:()=>this.isFeatureFlagEnabled(e),disabled:()=>!!this.updateInFlight,onChange:r=>this.toggleFeatureFlag(e,r)},Ai.createElement("span",{class:Ai.const("dcg-feature-flag-label")},()=>this.label(e))),Ai.createElement("div",{class:Ai.const("dcg-feature-flag-description")},()=>this.description(e),Ai.const(" "),Ai.createElement("a",{href:()=>this.learnMoreLink(e),class:Ai.const("dcg-shared-blue-link"),target:Ai.const("_blank")},()=>this.props.controller().s("graphing-calculator-link-learn-more")))))),Ai.createElement(Oo,{controller:this.props.controller,errors:()=>this.formErrors}),QJ(this.bindFn(this.getSaveProgress),e=>Ai.createElement("span",{"aria-live":Ai.const("assertive"),"aria-atomic":Ai.const("true"),class:Ai.const("dcg-shared-confirmation-message")},Ai.createElement("i",{class:()=>({"dcg-icon-check":!0,"dcg-success-marker":!0,"dcg-saving":e()==="saving"}),"aria-hidden":Ai.const("true")}),()=>e()==="saving"?this.props.controller().s("shared-calculator-label-saving"):this.props.controller().s("shared-message-information-saved"))))}getSaveProgress(){if(this.updateInFlight)return"saving";if(this.showSuccessConfirmation)return"saved"}isFeatureFlagEnabled(e){return this.updateInFlight&&e in this.updateInFlight?this.updateInFlight[e]:this.props.controller().userController.getFeatureFlags().indexOf(e)!==-1}toggleFeatureFlag(e,r){this.updateInFlight={[e]:r},this.props.controller().dispatch({type:"render"}),this.props.controller().userController.updateFeatureFlags({featureFlagsUpdate:this.updateInFlight,lang:this.props.controller().getLanguage()}).then(()=>{this.showSuccessConfirmation=!0,setTimeout(()=>{this.showSuccessConfirmation=!1,this.props.controller().dispatch({type:"render"})},3e3)}).fail(i=>{Co(i),this.formErrors=[this.props.controller().s("account-shell-error-unknown")]}).always(()=>{this.updateInFlight=void 0,this.props.controller().dispatch({type:"render"})})}learnMoreLink(e){return rG[e].learnMoreLink}label(e){return this.props.controller().s(rG[e].label)}description(e){return this.props.controller().s(rG[e].description)}};var fo=__dcg_shared_module_exports__['i'](Z());var{IfDefined:eY}=fo.Components,nG=class extends fo.Class{init(){this.controller=this.props.controller(),this.graphsController=this.controller.graphsController}template(){return fo.createElement(Po,{size:this.const("narrow"),onClose:()=>{this.controller.dispatch({type:"close-modal"})},i18n:this.const(this.controller),title:()=>this.controller.s("account-shell-label-delete-graph-modal-title"),class:this.const("dcg-delete-modal")},fo.createElement("div",{class:fo.const("dcg-delete-modal-contents")},fo.createElement("div",{class:fo.const("dcg-delete-confirmation-message")},this.bindFn(this.getConfirmationMessage)),eY(()=>this.errorMessage,e=>fo.createElement("div",{class:fo.const("dcg-error-message")},e)),fo.createElement("div",{class:fo.const("dcg-action-buttons")},fo.createElement("span",{class:fo.const("dcg-shared-dark-gray-link"),role:fo.const("button"),tabindex:fo.const("0"),"aria-label":()=>this.controller.s("account-shell-button-cancel"),onTap:()=>this.controller.dispatch({type:"close-modal"})},()=>this.controller.s("account-shell-button-cancel")),fo.createElement("div",{class:()=>({"dcg-shared-btn-red dcg-action-delete":!0,"dcg-disabled":!!this.deleteInProgress}),role:fo.const("button"),tabindex:()=>this.deleteInProgress?-1:0,"aria-label":this.bindFn(this.getButtonText),"aria-disabled":()=>!!this.deleteInProgress,onTap:this.bindFn(this.deleteGraph)},this.bindFn(this.getButtonText)))))}deleteGraph(){this.deleteInProgress=!0,this.graphsController._deleteGraph(this.graphsController.currentGraph).done(()=>{this.graphsController.clearGraphByUserAction(),this.controller.dispatch({type:"close-modal"})}).fail(()=>{this.deleteInProgress=!1,this.errorMessage=this.controller.s("account-shell-error-deletion-error"),this.controller.dispatch({type:"render"})})}getConfirmationMessage(){return this.controller.s("account-shell-text-delete-graphs-confirmation",{count:this.getGraphCount(),title:this.getTitle()})}getButtonText(){return this.controller.s("account-shell-button-confirm-delete",{count:this.getGraphCount()})}getGraphCount(){return new ks(1)}getTitle(){return this.graphsController.getCurrentGraphTitle()||this.graphsController.getUntitledString()}};var{If:tY,SwitchUnion:rY}=Ot.Components,oG=class extends Ot.Class{init(){this.controller=this.props.controller()}template(){return rY("modal",()=>this.controller.getModalState())({save:()=>Ot.createElement(fp,{controller:this.props.controller},Ot.createElement(Zm,{controller:this.props.controller})),rename:()=>Ot.createElement(fp,{controller:this.props.controller},Ot.createElement(Zm,{controller:this.props.controller})),duplicate:()=>Ot.createElement(fp,{controller:this.props.controller},Ot.createElement(Zm,{controller:this.props.controller})),"export-image":()=>Ot.createElement(fp,{controller:this.props.controller},Ot.createElement(wx,{controller:this.props.controller})),login:()=>Ot.createElement(yk,{controller:this.props.controller}),signup:()=>Ot.createElement(fk,{controller:this.props.controller}),"recover-password":()=>Ot.createElement(wk,{controller:this.props.controller}),hotkeys:()=>Ot.createElement(fp,{controller:this.props.controller},Ot.createElement(vk,{controller:this.props.controller}),Ot.const(";")),"unsupported-browser":()=>Ot.createElement(fp,{controller:this.props.controller},Ot.createElement(Ck,{controller:this.props.controller})),"account-settings":e=>Ot.createElement(Ik,{controller:this.props.controller,extraTabs:this.bindFn(this.getAccountSettingsExtraTabs),initialTab:()=>e().initialTab}),"change-email":()=>Ot.createElement(Mk,{controller:this.props.controller}),"account-reenabled":()=>Ot.createElement(tG,{controller:this.props.controller}),consent:()=>Ot.createElement(Zk,{controller:this.props.controller}),"contest-submission":()=>Ot.createElement(Po,{title:()=>"",size:this.const("wide"),showX:this.const(!0),onClose:()=>this.controller.dispatch({type:"close-modal"}),i18n:this.props.controller},Ot.createElement(Cx,{controller:this.props.controller})),delete:()=>Ot.createElement(nG,{controller:this.props.controller}),none:()=>Ot.createElement("div",null)})}getAccountSettingsExtraTabs(){return{tabs:[{key:"advanced",wideLabel:()=>this.props.controller().s("account-shell-label-advanced-preferences"),narrowLabel:()=>this.props.controller().s("account-shell-label-advanced-preferences"),class:"advanced"}],createView:e=>e?e=="advanced"?Ot.createElement(iG,{controller:this.props.controller}):e:Ot.createElement("span",null)}}},fp=class extends Ot.Class{init(){this.controller=this.props.controller()}template(){return Ot.createElement("div",{role:Ot.const("dialog"),class:()=>({"dcg-modal-container":!0,"dcg-wide-modal":this.controller.getOpenModal()==="hotkeys","dcg-fixed-width-height":this.shouldBeFixedWidthHeight(),"dcg-export-modal":this.controller.getOpenModal()==="export-image"})},Ot.createElement("div",{class:Ot.const("dcg-modal-background"),onTap:()=>this.controller.dispatch({type:"close-modal"})}),Ot.createElement("div",{class:Ot.const("modal dcg-state-modals")},Ot.createElement(tY,{predicate:()=>this.controller.getOpenModal()!=="consent"},()=>Ot.createElement("span",{role:Ot.const("link"),tabindex:Ot.const(0),"aria-label":Ot.const("Close Dialog"),class:Ot.const("action-close-modal close-modal internal-close"),onTap:()=>this.controller.dispatch({type:"close-modal"}),didMount:e=>{if(this.controller.getOpenModal()==="hotkeys")return e.focus()}},Ot.createElement("i",{class:Ot.const("dcg-icon-remove"),"aria-hidden":Ot.const("true")}))),this.children),Ot.createElement("span",{role:Ot.const("link"),tabindex:Ot.const(0),onTap:()=>this.controller.dispatch({type:"close-modal"}),"aria-label":Ot.const("Close Dialog"),class:Ot.const("action-close-modal close-modal external-close")},Ot.createElement("i",{class:Ot.const("dcg-icon-remove"),"aria-hidden":Ot.const("true")})))}shouldBeFixedWidthHeight(){var e=this.controller.getOpenModal();return e==="export-image"||e==="contest-submission"}};var yG=__dcg_shared_module_exports__['i'](Z());var he=__dcg_shared_module_exports__['i'](Z());Oe();var Tt=__dcg_shared_module_exports__['i'](Z());Oe();var{If:Dx}=Tt.Components,yf=class extends Tt.Class{template(){return Tt.createElement("div",{role:Tt.const("listitem"),class:()=>({"saved-graph":!0,"graph-link-container":!0,"dcg-selected":this.props.isSelected()}),onTap:e=>{e.wasHandled()||this.props.onTap(e)}},Tt.createElement(Dx,{predicate:()=>!this.props.isDeletingGraph()&&!this.props.didDeleteGraphFail()},()=>Tt.createElement("div",{role:Tt.const("link"),tabindex:Tt.const(0),class:()=>({"graph-link":!0,"dcg-action-preview-graph":!0,"example-graph":this.props.isExample()}),didMount:this.bindFn(this.didMount)},Tt.createElement("span",{class:Tt.const("dcg-thumb"),style:this.const({"background-image":`url(${this.props.getThumbURL()})`})}),Tt.createElement("div",{class:Tt.const("dcg-graph-details")},Tt.createElement("div",{class:Tt.const("dcg-title")},this.props.getTitle),Tt.createElement("div",{class:Tt.const("dcg-subtitle dcg-graph-date")},()=>this.props.isExample()?this.props.s("account-shell-label-mygraphs-example"):this.props.getDisplayDate())))),Tt.createElement(Dx,{predicate:this.props.isDeletingGraph},()=>Tt.createElement("div",{"aria-live":Tt.const("assertive"),"aria-atomic":Tt.const("true"),class:Tt.const("deleting"),handleEvent:Tt.const("true"),onTap:()=>{this.props.canCancelDelete()&&this.props.cancelDeleteGraph()}},()=>this.props.s("account-shell-text-mygraphs-deleting"),Tt.createElement(Dx,{predicate:this.props.canCancelDelete},()=>Tt.createElement("div",{role:Tt.const("button"),tabindex:Tt.const(0),class:Tt.const("cancel-delete")},()=>this.props.s("account-shell-button-mygraphs-cancel"))))),Tt.createElement(Dx,{predicate:this.props.didDeleteGraphFail},()=>Tt.createElement("div",{"aria-live":Tt.const("assertive"),"aria-atomic":Tt.const("true"),class:Tt.const("retry-delete"),handleEvent:Tt.const("true")},()=>this.props.s("account-shell-error-mygraphs-error-deleting"),Tt.createElement("a",{role:Tt.const("button"),tabindex:Tt.const(0),class:Tt.const("dcg-action-removegraph"),onTap:this.props.requestDeleteGraph},()=>this.props.s("account-shell-button-mygraphs-try-again")),()=>this.props.s("account-shell-text-mygraphs-or"),Tt.createElement("a",{role:Tt.const("button"),tabindex:Tt.const(0),class:Tt.const("dcg-action-cancelremovegraph"),onTap:this.props.cancelDeleteGraph},()=>this.props.s("account-shell-button-mygraphs-cancel")))),Tt.createElement(Dx,{predicate:()=>!this.props.isExample()&&!this.props.isDeletingGraph()&&!this.props.didDeleteGraphFail()},()=>Tt.createElement("span",{class:Tt.const("actions"),handleEvent:Tt.const("true")},Tt.createElement("span",{role:Tt.const("button"),tabindex:Tt.const(0),"aria-label":()=>this.props.s("account-shell-button-mygraphs-delete-title",{graphTitle:this.props.getTitle()}),class:Tt.const("dcg-action-removegraph"),onTap:this.props.requestDeleteGraph},Tt.createElement(Pe,{tooltip:()=>this.props.s("account-shell-button-mygraphs-delete-graph"),gravity:this.const("e")},Tt.createElement("i",{class:Tt.const("dcg-icon-remove"),"aria-hidden":Tt.const("true")}))))))}didUpdate(){this.props.isSelected()&&this.$node.trigger("focus")}didMount(e){this.$node=I(e),this.$node.on("focus",()=>{this.props.isSelected()||this.props.onFocus()})}};var ds=__dcg_shared_module_exports__['i'](Z());var pi=__dcg_shared_module_exports__['i'](Z());var{If:sG}=pi.Components,aG=class extends pi.Class{shouldShowSaveButton(){return!this.props.isSaving()&&!this.props.didSaveRecentlySucceed()&&!this.props.didSaveRecentlyFail()}template(){return pi.createElement("div",{class:pi.const("save-btn-container")},pi.createElement(sG,{predicate:()=>this.shouldShowSaveButton()},()=>pi.createElement("div",{role:pi.const("button"),onTap:this.props.onTap,class:()=>({"dcg-action-save":!0,"dcg-btn-primary":this.props.enabled(),"dcg-disabled":!this.props.enabled()}),"aria-disabled":()=>!this.props.enabled(),tabindex:()=>this.props.enabled()?0:-1},()=>this.props.s("account-shell-button-mygraphs-save"))),pi.createElement(sG,{predicate:this.props.isSaving},()=>pi.createElement("div",{class:pi.const("save-saving")},pi.createElement("span",{class:pi.const("dcg-spinner-dark")}))),pi.createElement(sG,{predicate:this.props.didSaveRecentlyFail},()=>pi.createElement("div",{class:pi.const("save-error"),"aria-live":pi.const("assertive"),"aria-atomic":pi.const("true")},pi.createElement("i",{class:pi.const("dcg-icon-remove"),"aria-hidden":pi.const("true")}),pi.const(" "),()=>this.props.s("account-shell-text-error"))),pi.createElement(sG,{predicate:this.props.didSaveRecentlySucceed},()=>pi.createElement("div",{class:pi.const("save-success")},pi.createElement("i",{class:pi.const("dcg-icon-check"),"aria-hidden":pi.const("true")}),pi.const(" "),()=>this.props.s("account-shell-text-saved"))))}};var lG=class extends ds.Class{template(){return ds.createElement("div",{class:ds.const("graph-link-container graph-in-progress")},ds.createElement("div",{role:ds.const("link"),"aria-label":()=>this.props.s("account-shell-button-mygraphs-save"),class:ds.const("graph-link dcg-action-preview-graph"),onTap:this.props.openSaveDialog},ds.createElement("span",{class:ds.const("dcg-thumb"),style:()=>({"background-image":`url(${this.props.getThumbnail()})`})}),ds.createElement("div",{class:ds.const("dcg-graph-details")},ds.createElement("div",{class:ds.const("dcg-title")},this.props.getTitle),ds.createElement("div",{class:ds.const("dcg-subtitle dcg-save-status")},()=>this.props.isSaveEnabled()?this.props.wasCurrentGraphEverSaved()?this.props.s("account-shell-label-mygraphs-last-saved",{date:this.props.getDisplayDate()}):this.props.s("account-shell-label-mygraphs-unsaved-graph"):this.props.s("account-shell-label-mygraphs-no-unsaved-changes"))),ds.createElement(aG,{enabled:this.props.isSaveEnabled,isSaving:this.props.isSaving,didSaveRecentlySucceed:this.props.didSaveRecentlySucceed,didSaveRecentlyFail:this.props.didSaveRecentlyFail,onTap:()=>{},s:this.props.s})))}shouldUpdate(){return this.props.isOpen()}};var Xt=__dcg_shared_module_exports__['i'](Z());Oe();var{Input:iY,If:cG}=Xt.Components,v5=4,dG=class extends Xt.Class{willUpdate(){this.props.isSearching()||this.setSearchValue("")}setSearchValue(e){this.searchValue!==e&&(this.searchValue=e,this.props.updateFilter(e))}init(){this.controller=this.props.controller(),this.searchValue=""}template(){return Xt.createElement("div",{class:Xt.const("dcg-user-bar")},Xt.createElement(cG,{predicate:()=>!this.props.isSearching()},()=>Xt.createElement("div",{class:Xt.const("dcg-account-link-container")},Xt.createElement("div",{class:Xt.const("dcg-account-link"),"dcg-menu-button":Xt.const("account"),role:Xt.const("button"),tabindex:Xt.const(0),"aria-haspopup":Xt.const("true"),"aria-expanded":()=>this.controller.getOpenMenu()==="account","aria-label":Xt.const("Account Information"),onTap:e=>{if(this.measureAccountDropdownArrowOffset(),this.props.controller().dispatch({type:"toggle-menu",payload:"account"}),e.device=="keyboard"){let i=this.props.controller().getOpenMenu()==="account"?".dcg-action-accountsettings":".dcg-account-link";I(i).trigger("focus")}}},Xt.createElement("span",{class:Xt.const("dcg-variable-name")},()=>this.controller.userController.getFirstName()),Xt.createElement("i",{class:Xt.const("dcg-icon-caret-down"),"aria-hidden":Xt.const("true")})),Xt.createElement(cG,{predicate:()=>this.controller.getOpenMenu()==="account"&&this.controller.mygraphsController.isMygraphsOpen()},()=>Xt.createElement(Qm,{controller:this.const(this.controller),left:()=>`${v5}px`,arrowLeft:()=>`${this.accountDropdownArrowOffset-v5}px`})))),Xt.createElement(cG,{predicate:()=>!this.props.isSearching()},()=>Xt.createElement("div",{role:Xt.const("link"),tabindex:Xt.const("0"),class:Xt.const("dcg-search-btn"),onTap:e=>{e.preventDefault(),this.props.openSearch(),I(".search-container").find("input").trigger("focus")}},Xt.createElement("i",{class:Xt.const("dcg-icon-search search-icon"),"aria-hidden":Xt.const("true")}),Xt.createElement("span",{class:Xt.const("dcg-menu-title")},()=>this.props.s("account-shell-heading-title-mygraphs-search")))),Xt.createElement(cG,{predicate:()=>this.props.isSearching()},()=>Xt.createElement("div",{role:Xt.const("search"),class:Xt.const("search-container search-open")},Xt.createElement("i",{class:Xt.const("dcg-icon-search search-icon"),"aria-hidden":Xt.const("true")}),Xt.createElement(iY,{placeholder:()=>this.props.s("account-shell-text-mygraphs-search-by-title"),onInput:this.bindFn(this.setSearchValue),onFocus:this.props.openSearch,value:()=>this.searchValue,didMount:this.bindFn(this.didMountSearch)}),Xt.createElement("span",{role:Xt.const("button"),tabindex:Xt.const(0),"aria-label":()=>this.props.s("account-shell-heading-title-mygraphs-search"),class:Xt.const("dcg-icon-remove dcg-action-close-search"),onTap:e=>{e.preventDefault(),this.props.closeSearch()}}))))}didMountDropdown(e){I(e).on("touchstart",r=>r.preventDefault())}didMountSearch(e){I(e).on("blur",()=>{I(e).val()||this.props.closeSearch()})}measureAccountDropdownArrowOffset(){var i,n,o;let e=I(".dcg-user-bar .dcg-account-link i"),r=((n=(i=e.offset())==null?void 0:i.left)!=null?n:0)+((o=e.width())!=null?o:0)/2;this.accountDropdownArrowOffset=r}};var ci=__dcg_shared_module_exports__['i'](Z());Oe();var{If:nY}=ci.Components,hG=class extends ci.Class{didMountGraphPreview(e){return this.$graphPreview=I(e),this.updateGraphPreviewTop()}didMountArrow(e){return this.$arrow=I(e),this.updateArrowTop()}didMountCalc(e){return this.previewCalc=this.props.makeAPI(e),this.updatePreviewCalc()}willUnmountCalc(){this.previewCalc&&this.previewCalc.destroy&&this.previewCalc.destroy()}didUpdate(){return this.updateGraphPreviewTop(),this.updateArrowTop(),this.updatePreviewCalc()}updateGraphPreviewTop(){return this.$graphPreview.css("top",this.getTopOffset()+"px")}updateArrowTop(){this.$arrow.css("top",this.getArrowOffset()+"px")}updatePreviewCalc(){let e=this.props.getGraphData();e!==this.cachedGraphData&&(this.cachedGraphData=e,this.previewCalc.setState(e),this.previewCalc.resize())}getMaxTop(){return I(window).height()-this.$graphPreview.outerHeight()-10}getIdealTop(){let e=this.props.alignToNode();return e==null?null:I(e).offset().top+.5*I(e).outerHeight()-60}getTopOffset(){let e=this.getIdealTop();if(e==null)return 0;let r=this.getMaxTop();return Math.min(e,r)}getArrowOffset(){let e=this.getIdealTop();if(e==null)return 60;let r=this.getTopOffset();return 60+e-r}template(){return ci.createElement("div",{class:ci.const("graph-preview"),didMount:this.bindFn(this.didMountGraphPreview)},ci.createElement("div",{class:ci.const("dcg-graph-preview-info")},ci.createElement("h4",{class:ci.const("dcg-title")},this.props.getTitle),ci.createElement("span",{role:ci.const("button"),tabindex:ci.const("0"),class:ci.const("dcg-action-cancel"),onTap:this.props.onCancel},ci.createElement("i",{class:ci.const("dcg-icon-remove"),"aria-hidden":ci.const("true")}))),ci.createElement("div",{class:ci.const("preview-graph-area")},ci.createElement(nY,{predicate:()=>!this.props.getGraphData()},()=>ci.createElement(pp,{didDataLoadFail:this.props.didDataLoadFail,onCancel:this.props.onCancel,requestLoadGraphData:this.props.requestLoadGraphData,s:this.props.s.bind(this.props)})),ci.createElement("div",{didMount:this.bindFn(this.didMountCalc),willUnmount:this.bindFn(this.willUnmountCalc),class:()=>({"dcg-preview-calculator":!0,"dcg-visible":this.props.getGraphData()})}),ci.createElement("div",{class:()=>({"screenshot-clickjack":!0,"dcg-action-open-graph":!0,"dcg-visible":this.props.getGraphData()})},ci.createElement("span",{role:ci.const("button"),tabindex:ci.const("0"),class:ci.const("dcg-action-open-graph dcg-open-graph-btn dcg-btn-primary"),onTap:this.props.onOpenGraph},this.props.getOpenText))),ci.createElement("div",{class:ci.const("active-arrow"),didMount:this.bindFn(this.didMountArrow)},ci.createElement("div",{class:ci.const("dcg-graphic")})))}};var to=__dcg_shared_module_exports__['i'](Z());var{If:P0}=to.Components,pG=class extends to.Class{template(){return to.createElement("div",{class:()=>({"syncing-status-bar":!0,visible:this.props.isSyncingGraphs()||this.props.didSyncFail()})},to.createElement(P0,{predicate:this.props.isSyncingGraphs},()=>to.createElement("div",{class:to.const("syncing-status-text")},to.createElement("span",{class:to.const("dcg-pulse")},()=>this.props.s("account-shell-text-mygraphs-updating-graphs")))),to.createElement(P0,{predicate:()=>!this.props.isSyncingGraphs()&&!this.props.didSyncFail()},()=>to.createElement("div",{class:to.const("success-status-text")},to.createElement("i",{class:to.const("dcg-icon-check"),"aria-hidden":to.const("true")}),to.const(" "),()=>this.props.s("account-shell-text-mygraphs-synced"))),to.createElement(P0,{predicate:this.props.didSyncFail},()=>to.createElement("div",{class:to.const("error-status-text"),onTap:this.props.requestSyncGraphs},()=>this.props.s("account-shell-button-mygraphs-offline-try-again"))))}};var Cs=__dcg_shared_module_exports__['i'](Z());var uG=class extends Cs.Class{init(){this.controller=this.props.controller()}template(){return Cs.createElement("div",{class:Cs.const("dcg-account-reminder")},Cs.createElement("span",{class:Cs.const("dcg-login")},Cs.createElement("a",{role:Cs.const("link"),tabindex:Cs.const(0),class:Cs.const("dcg-sign-in dcg-action-login dcg-btn-white-outline"),onTap:this.props.onSignIn},()=>this.props.controller().s("account-shell-button-log-in")),()=>this.props.controller().s("account-shell-text-or"),Cs.createElement("a",{role:Cs.const("link"),tabindex:Cs.const(0),class:Cs.const("dcg-create-account dcg-btn dcg-btn-primary dcg-tool-color dcg-action-createaccount"),onTap:this.props.onCreateAccount},()=>this.props.controller().s("account-shell-button-sign-up"))),Cs.createElement("div",null,()=>this.getToSaveYourText()))}getToSaveYourText(){return this.controller.product==="graphing"?this.controller.s("account-shell-text-mygraphs-to-save-graphs"):this.controller.product==="geometry"?this.controller.s("account-shell-text-mygraphs-to-save-constructions"):""}};var yd=__dcg_shared_module_exports__['i'](Z()),Vu=class extends yd.Class{template(){return yd.createElement("div",{class:yd.const("dcg-mygraphs-section-title-container")},yd.createElement("span",{role:yd.const("heading"),"aria-level":yd.const("1"),class:yd.const("dcg-mygraphs-section-title")},()=>this.props.title()))}};var{If:yo,For:O0,IfElse:C5}=he.Components,gG="default",yp="search",oY=50,mG=class extends he.Class{constructor(){super(...arguments),this.state="default"}didUpdate(){this.previewGraph&&Ba(I(this.getSelectedNode()),this.$scrollableNode,60)&&this.update()}didMountScrollable(e){this.$scrollableNode=I(e),this.$scrollableNode.on("focusin",i=>{if(this.previewGraph&&!I(i.target).hasClass("graph-link"))return this.previewItem(void 0)}),I(window).on("keydown",i=>{if(!this.props.isOpen())return!0;switch(Te(i)){case Jn:return this.selectUp(i);case Yn:return this.selectDown(i)}});let r=__dcg_shared_module_exports__['A'](this.hidePreviewIfTooScrolled.bind(this),200);this.$scrollableNode.on("scroll",r),this.debouncedFetchSelectedGraph=__dcg_shared_module_exports__['B'](this.fetchSelectedGraph.bind(this),200)}fetchSelectedGraph(){return this.props.graphsController().loadDataForGraph(this.previewGraph)}hidePreviewIfTooScrolled(){if(!this.previewGraph)return;let e=I(this.getSelectedNode()),r=I(this.findRootNode()).find(".active-arrow"),i=e.offset(),n=e.height(),o=r.offset();if(i===void 0||n===void 0||o===void 0)return;let s=i.top+.5*n,a=o.top;Math.abs(s-a)>10&&this.previewItem(void 0)}openSearch(){this.state=yp,this.previewItem(void 0)}closeSearch(){this.state=gG,this.previewItem(void 0)}updateFilter(e){this.filter=e,this.update()}getMaxGraphs(){return this.maxGraphs||oY}getCountRemaining(){return this.getSavedGraphs().length-this.getMaxGraphs()}showMoreGraphs(e){let r=this.getMaxGraphs();if(this.getCountRemaining()<2*r?this.maxGraphs=1/0:this.maxGraphs=2*r,this.update(),(e!=null?e.device:void 0)==="keyboard"){let i=this.getSavedAndExampleGraphs(),n=i?i[r]:void 0;n&&this.previewItem(n)}}getSelectedNode(){return I(".dcg-mygraphs .graph-link-container.dcg-selected")[0]}selectUp(e){if(!this.previewGraph)return;e.preventDefault();let r=this.getSavedAndExampleGraphs();if(!r.length)return;let i=this.previewGraph?this.previewGraph.hash:void 0,n=__dcg_shared_module_exports__['z'](__dcg_shared_module_exports__['q'](r,"hash"),i),o=r?r[n-1]:void 0;o?o&&this.previewItem(o):this.$newGraph&&this.$newGraph.trigger("focus")}selectDown(e){if(!this.previewGraph)return;let r=this.getSavedAndExampleGraphs();if(!r.length)return;e.preventDefault();let i=this.previewGraph?this.previewGraph.hash:void 0,n=__dcg_shared_module_exports__['z'](__dcg_shared_module_exports__['q'](r,"hash"),i),o=r?r[n+1]:void 0;o&&(!o.example&&n+1>=this.getMaxGraphs()&&this.showMoreGraphs(),this.previewItem(o))}getFilter(){return this.state===yp&&this.filter?this.filter:""}getRecoveryGraphs(){return this.props.graphsController().getRecoveryGraphs()}attemptRecovery(){this.logRecoveryClientEvent("ask"),this.controller.mygraphsController.recoveryAttempted=!0,this.controller.graphsController.fetchRecoveryGraphs(),this.update()}hasAttemptedRecovery(){return this.controller.mygraphsController.hasAttemptedRecovery()&&!this.isAttemptingRecovery()}isAttemptingRecovery(){return this.controller.graphsController.isLoadingRecoveryGraphs}shouldShowAttemptRecoveryText(){return this.graphsController.isRecoveryUIEnabledForProduct()?!this.hasAttemptedRecovery():!1}getSavedGraphs(){return this.props.graphsController().getSavedGraphs()}getExampleGraphs(){return this.props.graphsController().getExampleGraphs()}getSavedAndExampleGraphs(){return this.props.graphsController().getSavedAndExampleGraphs()}filterGraphs(e){let r=this.getFilter().toLowerCase();return r?e.filter(i=>this.sanitizeTitle(i).toLowerCase().indexOf(r)>=0):e}sliceGraphs(e){return e.slice(0,this.getMaxGraphs())}canShowMore(e){return e.length>this.getMaxGraphs()}onFocusGraph(e){this.skipPreview()||this.previewItem(e)}onTapGraph(e,r){this.skipPreview()||r.device==="keyboard"?this.openGraphWithCover(e):this.previewGraph!==e&&this.previewItem(e)}previewItem(e){this.previewGraph&&(this.previewGraph=void 0),e&&(this.previewGraph=e,this.debouncedFetchSelectedGraph()),this.update()}skipPreview(){let e=window.platform;return I("body").width()<650||e==="ios"||e==="android"}onOpenPreviewGraph(){if(!this.previewGraph)return;let{previewGraph:e}=this;this.previewItem(void 0),this.props.onOpenGraph(e)}openGraphWithCover(e){if(this.graphWithCover=e,this.previewItem(void 0),e!==void 0)return setTimeout(()=>{this.props.graphsController().loadGraphImmediately(e).done(()=>{this.graphWithCover&&this.props.openGraphBehindCover(e).then(()=>{this.graphWithCover=void 0,this.update()})}).always(()=>{this.update()})},250)}cancelLoadGraphWithCover(){this.graphWithCover=void 0,this.update()}didDataLoadFail(e){return e?this.props.graphsController().didDataLoadFail(e):!1}willUpdate(){(!this.props.isOpen()||!this.controller.userController.isLoggedIn())&&(this.state=gG)}didMountNewGraph(e){return this.$newGraph=I(e),this.$newGraph.on("keydown",r=>{if(Te(r)!==Yn)return;let i=this.getSavedAndExampleGraphs();return this.previewItem(i[0]),r.preventDefault(),r.stopPropagation()})}sanitizeTitle(e){return e.i18nKey?this.controller.s(e.i18nKey):e.title||this.graphsController.getUntitledString()}init(){this.state=gG,this.controller=this.props.controller(),this.graphsController=this.controller.graphsController}template(){return he.createElement("div",{class:()=>({"dcg-mygraphs":!0,"logged-in":this.controller.userController.isLoggedIn(),"preview-mode":!!this.props.previewMode(),"maintenance-mode":!!this.props.maintenanceMode()})},he.createElement("div",{class:he.const("dcg-resources-container")},he.createElement(yo,{predicate:()=>this.props.accountsEnabled()&&!this.controller.userController.isLoggedIn()&&!this.props.previewMode()&&!this.props.maintenanceMode()},()=>he.createElement(uG,{onCreateAccount:this.props.onCreateAccount,onSignIn:this.props.onSignIn,controller:this.props.controller})),he.createElement(yo,{predicate:()=>this.controller.userController.isLoggedIn()},()=>he.createElement("div",null,he.createElement(yo,{predicate:()=>this.controller.userController.isLoggedIn()&&this.state===gG},()=>he.createElement(pG,{isSyncingGraphs:()=>this.props.graphsController().isSyncing(),didSyncFail:()=>this.props.graphsController().didSyncFail(),requestSyncGraphs:this.props.refreshGraphs,s:this.controller.s})),he.createElement(dG,{controller:this.props.controller,openSearch:this.bindFn(this.openSearch),closeSearch:this.bindFn(this.closeSearch),updateFilter:this.bindFn(this.updateFilter),isSearching:()=>this.state===yp,s:this.controller.s}))),he.createElement("div",{class:he.const("dcg-scrollable"),didMount:this.bindFn(this.didMountScrollable)},he.createElement("div",{class:he.const("dcg-scrollable-interior")},he.createElement(yo,{predicate:this.props.maintenanceMode},()=>he.createElement("div",{class:he.const("maintenance-mode")},()=>this.controller.s("account-shell-text-mygraphs-maintenance-mode"))),he.createElement(yo,{predicate:this.props.previewMode},()=>he.createElement("div",{class:he.const("maintenance-mode")},()=>{var e;return(e=this.props.previewMode())==null?void 0:e.message},he.createElement("br",null),he.createElement("a",{tabindex:he.const("0"),class:he.const("dcg-btn-primary"),href:()=>{var e;return(e=this.props.previewMode())==null?void 0:e.url},target:he.const("_blank")},()=>this.controller.s("account-shell-text-mygraphs-share-thoughts")))),he.createElement(yo,{predicate:()=>this.state!==yp&&this.controller.shouldShowArtContestNudge()},()=>he.createElement("div",{onTap:e=>{this.controller.dispatch({type:"show-modal",modal:"contest-submission",device:e.device})},class:he.const("dcg-sidebar-contest-submit")},he.createElement("span",{class:he.const("dcg-trophy-icon")},he.const("\u{1F3C6}")),he.createElement(un,{i18n:this.const(this.controller),key:this.const("account-shell-text-mygraphs-submit-to-contest")},he.createElement("span",{class:he.const("dcg-contest-submit-message")},he.const("Submit this graph to the"),he.const(" "),he.createElement("span",{class:he.const("dcg-bold-text")},he.const("Global Math Art Contest!")))))),he.createElement(yo,{predicate:()=>this.state!==yp},()=>he.createElement("div",{role:he.const("link"),tabindex:he.const("0"),class:he.const("new-blank-graph dcg-action-newblankgraph"),onTap:()=>(this.previewItem(void 0),this.props.openBlankGraph()),didMount:this.bindFn(this.didMountNewGraph)},he.createElement("div",{class:he.const("new-blank-graph-inner")},he.createElement("span",{class:he.const("dcg-add-blank")},he.createElement("i",{class:he.const("dcg-icon-plus"),"aria-hidden":he.const("true")})),he.createElement("span",{class:he.const("dcg-new-graph-title")},()=>this.props.controller().getProduct()==="geometry"?this.controller.s("account-shell-text-mygraphs-new-construction"):this.controller.s("account-shell-text-mygraphs-new-blank-graph"))))),he.createElement(yo,{predicate:()=>!this.props.maintenanceMode()&&!this.props.previewMode()&&this.controller.userController.isLoggedIn()&&this.state!==yp},()=>he.createElement("div",null,he.createElement(Vu,{title:()=>this.props.controller().getProduct()==="geometry"?this.controller.s("account-shell-text-mygraphs-current-construction"):this.controller.s("account-shell-text-mygraphs-current-graph")}),he.createElement(lG,{getTitle:()=>this.getPreviewTitle(),getDisplayDate:()=>this.controller.unpack(this.props.graphsController().getCurrentDisplayDate()),isOpen:this.props.isOpen,getThumbnail:this.props.getThumbnail,isSaveEnabled:this.props.isSaveEnabled,simpleSave:()=>(this.props.simpleSave(),this.previewItem(void 0)),openSaveDialog:()=>(this.props.openSaveDialog(),this.previewItem(void 0)),wasCurrentGraphEverSaved:()=>this.props.graphsController().wasCurrentGraphEverSaved(),isSaving:()=>this.props.graphsController().isSaving(),didSaveRecentlySucceed:()=>this.props.graphsController().didSaveSucceed(),didSaveRecentlyFail:()=>this.props.graphsController().didSaveFail(),s:this.controller.s}),he.createElement(yo,{predicate:this.bindFn(this.shouldShowAttemptRecoveryText)},()=>he.createElement("div",{class:he.const("dcg-lost-work-link")},C5(()=>this.isAttemptingRecovery(),{true:()=>he.createElement("span",null,he.createElement("span",null,()=>this.controller.s("account-shell-text-mygraphs-attempting-recovery")),he.createElement("span",{class:he.const("dcg-spinner-dark")})),false:()=>he.createElement("span",null,he.createElement("span",null,()=>this.controller.s("account-shell-text-mygraphs-lost-work")+" "),he.createElement("span",{tabIndex:he.const("0"),role:he.const("link"),class:he.const("dcg-attempt-recovery"),onTap:this.bindFn(this.attemptRecovery)},()=>this.controller.s("account-shell-button-mygraphs-attempt-recovery")))}))))),he.createElement(yo,{predicate:()=>!this.props.maintenanceMode()&&!this.props.previewMode()&&this.controller.userController.isLoggedIn()&&this.hasAttemptedRecovery()&&this.state!==yp},()=>he.createElement("div",null,C5(()=>this.getRecoveryGraphs().length>0,{true:()=>he.createElement("div",{class:he.const("dcg-recovery-graphs-list")},he.createElement(Vu,{title:()=>this.controller.s("account-shell-heading-mygraphs-recovered-work")}),he.createElement(O0,{each:()=>this.getRecoveryGraphs(),key:e=>e.getCollectionKey()},he.createElement("div",{role:he.const("list")},e=>he.createElement(yf,{onTap:r=>this.onTapGraph(e,r),onFocus:()=>this.onFocusGraph(e),cancelDeleteGraph:()=>this.props.graphsController().cancelDeleteGraph(e),requestDeleteGraph:()=>(this.logRecoveryClientEvent("delete"),this.previewItem(void 0),this.props.graphsController().requestDeleteGraph(e)),isDeletingGraph:()=>this.props.graphsController().isDeletingGraph(e),canCancelDelete:()=>this.props.graphsController().canCancelDelete(e),didDeleteGraphFail:()=>this.props.graphsController().didDeleteGraphFail(e),isSelected:()=>e===this.previewGraph,isExample:he.const(!1),getDisplayDate:()=>this.controller.unpack(e.displayDate()),getTitle:()=>this.sanitizeTitle(e),getThumbURL:()=>e.thumbURL,s:this.controller.s})))),false:()=>he.createElement("div",{class:he.const("dcg-no-recovery-graphs")},()=>this.controller.s("account-shell-text-mygraphs-no-unsaved-graphs"))}))),he.createElement(yo,{predicate:()=>this.controller.userController.isLoggedIn()},()=>he.createElement(Vu,{title:()=>this.props.controller().getProduct()==="geometry"?this.controller.s("account-shell-heading-mygraphs-saved-constructions"):this.controller.s("account-shell-heading-mygraphs-saved-graphs")})),he.createElement(O0,{each:()=>this.sliceGraphs(this.filterGraphs(this.getSavedGraphs())),key:e=>e.getCollectionKey()},he.createElement("div",{class:he.const("dcg-saved-graphs-list"),role:he.const("list")},e=>he.createElement(yf,{onTap:r=>this.onTapGraph(e,r),onFocus:()=>this.onFocusGraph(e),cancelDeleteGraph:()=>this.props.graphsController().cancelDeleteGraph(e),requestDeleteGraph:()=>(this.previewItem(void 0),this.props.graphsController().requestDeleteGraph(e)),isDeletingGraph:()=>this.props.graphsController().isDeletingGraph(e),canCancelDelete:()=>this.props.graphsController().canCancelDelete(e),didDeleteGraphFail:()=>this.props.graphsController().didDeleteGraphFail(e),isSelected:()=>e===this.previewGraph,isExample:he.const(!1),getDisplayDate:()=>this.controller.unpack(e.displayDate()),getTitle:()=>this.sanitizeTitle(e),getThumbURL:()=>e.thumbURL,s:this.controller.s}))),he.createElement(yo,{predicate:()=>this.controller.userController.isLoggedIn()&&this.filterGraphs(this.getSavedGraphs()).length===0},()=>he.createElement("div",{"aria-live":he.const("assertive"),"aria-atomic":he.const("true"),class:he.const("no-matches")},()=>this.state===yp?this.controller.s("account-shell-text-mygraphs-no-search-results"):this.controller.s("account-shell-text-mygraphs-no-saved-graphs"))),he.createElement(yo,{predicate:()=>this.canShowMore(this.filterGraphs(this.getSavedGraphs()))},()=>he.createElement("div",{class:he.const("dcg-show-more-graphs"),onTap:this.bindFn(this.showMoreGraphs),role:he.const("button"),tabindex:he.const("0")},()=>this.controller.s("account-shell-text-mygraphs-count-more",{count:this.getCountRemaining()}))),he.createElement(yo,{predicate:()=>this.getExampleGraphs().length>0},()=>he.createElement(Vu,{title:()=>this.controller.s("account-shell-heading-mygraphs-examples")})),he.createElement(O0,{each:()=>this.filterGraphs(this.getExampleGraphs()),key:e=>e.getCollectionKey()},he.createElement("div",{role:he.const("list")},e=>he.createElement(yf,{onTap:r=>this.onTapGraph(e,r),onFocus:()=>this.onFocusGraph(e),cancelDeleteGraph:()=>{},requestDeleteGraph:()=>{},isDeletingGraph:he.const(!1),didDeleteGraphFail:he.const(!1),canCancelDelete:he.const(!1),isSelected:()=>e===this.previewGraph,isExample:he.const(!0),getDisplayDate:()=>this.controller.unpack(e.displayDate()),getTitle:()=>this.sanitizeTitle(e),getThumbURL:()=>e.thumbURL,s:this.controller.s}))),he.createElement(yo,{predicate:()=>this.getFilter()?this.filterGraphs(this.getExampleGraphs()).length===0:!1},()=>he.createElement("div",{"aria-live":he.const("assertive"),"aria-atomic":he.const("true"),class:he.const("no-matches")},()=>this.controller.s("account-shell-text-mygraphs-no-examples-match-search"))),he.createElement("div",{class:he.const("dcg-mygraphs-legal")},he.createElement("a",{href:he.const("/terms"),target:he.const("_blank")},()=>this.controller.s("account-shell-link-terms")),he.const("|"),he.createElement("a",{href:he.const("/privacy"),target:he.const("_blank")},()=>this.controller.s("account-shell-link-privacy")),he.createElement(yo,{predicate:()=>!!this.props.versionNumber()},()=>he.createElement("div",{class:he.const("dcg-version")},()=>this.controller.s("account-shell-text-mygraphs-version"),he.const(" "),this.props.versionNumber))))),he.createElement(yo,{predicate:()=>!!this.previewGraph},()=>he.createElement(hG,{alignToNode:()=>this.getSelectedNode(),getTitle:()=>this.previewGraph?this.sanitizeTitle(this.previewGraph):"",getGraphData:()=>this.previewGraph?this.previewGraph.graphData:void 0,onCancel:()=>this.previewItem(void 0),didDataLoadFail:()=>this.didDataLoadFail(this.previewGraph),requestLoadGraphData:this.bindFn(this.fetchSelectedGraph),onOpenGraph:this.bindFn(this.onOpenPreviewGraph),s:this.controller.s,makeAPI:this.props.makeAPI,getOpenText:()=>this.controller.getOpenText()}))),he.createElement(yo,{predicate:this.props.isOpen},()=>he.createElement("div",{role:he.const("link"),tabindex:he.const("0"),class:he.const("dcg-resources-cover dcg-action-close-resources"),style:()=>({opacity:this.previewGraph?.6:0}),onTap:()=>this.previewGraph?this.previewItem(void 0):this.props.closeDrawer(),"aria-label":()=>this.previewGraph?this.controller.s("account-shell-button-mygraphs-close-graph-preview"):this.controller.s("account-shell-button-mygraphs-close-graph-list")})),he.createElement(yo,{predicate:()=>!!this.graphWithCover},()=>he.createElement("div",{class:he.const("dcg-fullscreen-loading-container")},he.createElement(yo,{predicate:()=>{var e;return(e=this.graphWithCover)==null?void 0:e.graphData}},()=>he.createElement("div",{"aria-live":he.const("assertive"),"aria-atomic":he.const("true"),class:he.const("dcg-graph-loading")},he.createElement("div",{class:he.const("pulsing-message")},()=>this.controller.s("account-shell-text-mygraphs-opening")),he.createElement("div",{class:he.const("slow-loading")},()=>this.getSlowLoadingText()))),he.createElement(yo,{predicate:()=>{var e;return(e=this.graphWithCover)==null?void 0:e.graphData}},()=>he.createElement(pp,{didDataLoadFail:()=>this.didDataLoadFail(this.graphWithCover),onCancel:this.bindFn(this.cancelLoadGraphWithCover),requestLoadGraphData:()=>this.openGraphWithCover(this.graphWithCover),s:this.controller.s})))))}getPreviewTitle(){return this.graphsController.getCurrentGraphTitle()||this.graphsController.getUntitledString()}getSlowLoadingText(){return this.graphsController.product==="graphing"?this.controller.s("account-shell-text-mygraphs-slow-big-graphs"):this.graphsController.product==="geometry"?this.controller.s("account-shell-text-mygraphs-slow-big-constructions"):""}logRecoveryClientEvent(e){Mi("recovered-graph",{product:this.controller.graphsController.product,timeSincePageload:Date.now()-this.controller.mygraphsController.pageLoadTime,payloadJSON:{action:e}})}};var fG=class extends yG.Class{init(){this.controller=this.props.controller(),this.graphsController=this.controller.graphsController,this.mygraphsController=this.controller.mygraphsController}template(){return yG.createElement(mG,{isOpen:()=>this.mygraphsController.isMygraphsOpen(),graphsController:()=>this.graphsController,maintenanceMode:()=>this.controller.isInMaintenanceMode(),previewMode:()=>this.controller.getPreviewParams(),accountsEnabled:this.const(!0),controller:()=>this.controller,closeDrawer:()=>this.controller.dispatch({type:"close-mygraphs"}),openBlankGraph:()=>this.mygraphsController.openBlankGraph(),onOpenGraph:e=>this.mygraphsController.onOpenGraph(e),openGraphBehindCover:e=>this.mygraphsController.openGraphBehindCover(e),onLogout:()=>this.controller.userController.logout(),onEditAccount:()=>this.controller.dispatch({type:"show-modal",modal:"account-settings",device:"mouse"}),onCreateAccount:()=>this.controller.dispatch({type:"show-modal",modal:"signup",device:"mouse"}),onSignIn:()=>this.controller.dispatch({type:"show-modal",modal:"login",device:"mouse"}),refreshGraphs:()=>this.graphsController.refreshGraphs(),getThumbnail:()=>this.mygraphsController.getThumbnail(),simpleSave:()=>this.controller.simpleSave(),openSaveDialog:()=>this.controller.openSaveDialog({fromSaveInProgress:!0}),versionNumber:()=>la.versionNumber,isSaveEnabled:()=>this.controller.isSaveEnabled(),makeAPI:this.props.makeAPI})}};Oe();Xp();var bG=class extends Lr{constructor(){super();this.loggedIn=!1;this.logoutFailed=!1;this.loggingOut=!1;this.consentingToPrivacy=!1;this.privacyConsentFailed=!1;this.userId="";this.name="";this.email="";this.teacher=!1;this.featureFlags=[];this.verificationStatus="";this.subscriptions=[];this.privacyConsent=null;I.ajaxSetup({statusCode:{401:()=>this.logout()}})}desmosLogin(r){return i5(r).done(this.completeLogin.bind(this))}googleLogin(r){this.triggerEvent("googleLogin",r)}appleLogin(r){this.triggerEvent("appleLogin",r)}askServerIfLoggedIn(){return n5().then(this.completeLogin.bind(this),this.logout.bind(this))}driveCallback(){return this.askServerIfLoggedIn()}createAccount(r){let i=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},r),{name:r.userProvidedName.given});return i.teacher===!1&&delete i.teacher,s5(i).done(this.completeLogin.bind(this))}checkPendingDeletion(r){return o5(r)}isTeacher(){return!!this.teacher}setNameLegacy(r){return a5(r).done(i=>{this.name=i.name||"",this.triggerEvent("userUpdated",void 0),this.triggerEvent("triggerRender",void 0)})}setNameDetail(r){return l5(r).done(i=>{this.name=i.name||"",this.nameDetail=i.nameDetail,this.triggerEvent("userUpdated",void 0),this.triggerEvent("triggerRender",void 0)})}recoverPassword(r){return c5(r)}completeLogin(r){this.loggedIn=!0,this.userId=r.userId||"",this.name=r.name||"",this.nameDetail=r.nameDetail,this.email=r.email||"",this.featureFlags=r.featureFlags||[],this.subscriptions=r.subscriptions||[],this.verificationStatus=r.verificationStatus||"",this.privacyConsent=r.privacyConsent,this.teacher=!!r.isTeacher,this.triggerEvent("loginChanged",void 0),this.triggerEvent("userUpdated",void 0),this.triggerEvent("triggerRender",void 0)}logout(){return this.loggingOut=!0,this.triggerEvent("logout",void 0),this.triggerEvent("triggerRender",void 0),L0().done(this.completeLogout.bind(this)).fail(this._onLogoutFailure.bind(this)).always(()=>{this.loggingOut=!1,this.triggerEvent("triggerRender",void 0)})}completeLogout(){this.loggedIn=!1,this.logoutFailed=!1,this.userId="",this.email="",this.name="",this.subscriptions=[],this.featureFlags=[],this.verificationStatus="",this.privacyConsent=null,this.teacher=!1,this.triggerEvent("loginChanged",void 0),this.triggerEvent("userUpdated",void 0),this.triggerEvent("triggerRender",void 0)}_onLogoutFailure(){this.logoutFailed=!0,this.triggerEvent("triggerRender",void 0),setTimeout(()=>{this.logoutFailed=!1,this.triggerEvent("triggerRender",void 0)},2e3)}initiateAccountDeletion(r){return d5(r)}getEmailChangeToken(){return Ud(location.search,"changeToken")}initiateEmailChange(r){return h5(r)}setEmail(r){return p5(r).done(()=>{this.email=r.newEmail||"",this.verificationStatus="VERIFYING",this.triggerEvent("userUpdated",void 0),this.triggerEvent("triggerRender",void 0)})}setPrivacyConsent(r){return this.consentingToPrivacy=!0,this.triggerEvent("triggerRender",void 0),g5(r).done(this.completePrivacyConsent.bind(this)).fail(this.onPrivacyConsentFailure.bind(this)).always(()=>{this.consentingToPrivacy=!1,this.triggerEvent("triggerRender",void 0)})}completePrivacyConsent(r){this.privacyConsent=r.privacyConsent,this.triggerEvent("userUpdated",void 0),this.triggerEvent("triggerRender",void 0)}onPrivacyConsentFailure(){this.privacyConsentFailed=!0,this.triggerEvent("triggerRender",void 0),setTimeout(()=>{this.privacyConsentFailed=!1,this.triggerEvent("triggerRender",void 0)},2e3)}updateFeatureFlags(r){return u5(r).then(i=>{this.featureFlags=i.featureFlags,this.triggerEvent("userUpdated",void 0)})}getFeatureFlags(){return this.featureFlags}hasFeatureFlag(r){return this.featureFlags.some(i=>i===r)}didPrivacyConsentFail(){return!!this.privacyConsentFailed}isConsentingToPrivacy(){return!!this.consentingToPrivacy}isLoggedIn(){return!!this.loggedIn}isLoggingOut(){return!!this.loggingOut}didLogoutFail(){return!!this.logoutFailed}getEmail(){return this.email}getFirstName(){return sY(this.name)}getFullName(){return this.name}getNameDetail(){return this.nameDetail||{given:this.name,source:"legacy"}}getUserId(){return this.userId}getSubscriptions(){return this.subscriptions}getVerificationStatus(){return this.verificationStatus}hasConsentedToCollection(){return!!this.privacyConsent}getUserAsJSON(){if(this.isLoggedIn())return{email:this.email,name:this.name,verificationStatus:this.verificationStatus,subscriptions:this.subscriptions,privacyConsent:this.privacyConsent}}};function sY(t){if(!t)return"";if(t.match(/[\d@_&\.\']/))return t;var e=t.split(" ");return e[0].length>=3?e[0]:t}var N0={};__dcg_shared_module_exports__['h'](N0,{init:()=>uY,next:()=>hY,nextSeed:()=>pY});var _0=class{constructor(e){this.bauArc4=new F0(aY(e))}g(e){for(var r=Array(e),i=0;i<e;i++)r[i]=this.bauArc4.g(1);return r}},Sx=256;function bd(t){return t&Sx-1}function aY(t){var e=t+"",r=[],i=0,n;for(n=0;n<e.length;n++)r[bd(n)]=bd((i^=r[bd(n)]*19)+e.charCodeAt(n));return r}var F0=class{constructor(e){this.S=[];this.c=[];this.i=0;this.j=0;this.m=0;var r,i,n=e.length,o=0,s=0;for(n||(e=[n++]);o<Sx;)this.S[o]=o++;for(o=0;o<Sx;o++)r=this.S[o],s=bd(s+r+e[o%n]),i=this.S[s],this.S[o]=i,this.S[s]=r;this.g(Sx)}g(e){var r=this.S,i=bd(this.i+1),n=r[i],o=bd(this.j+n),s=r[o];r[i]=s,r[o]=n;for(var a=r[bd(n+s)];--e;)i=bd(i+1),n=r[i],o=bd(o+n),s=r[o],r[i]=s,r[o]=n,a=a*Sx+r[bd(n+s)];return this.i=i,this.j=o,a}},lY="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",cY=lY.toLowerCase(),dY=62,D5=10,R0=class{constructor(e){if(!e||!e.length||e.length<32)throw new Error("You must supply a seed to RandomHashFactory. It should have at least 128 bits of entropy, but was "+e);this.arc4=new _0(e)}next(){for(var e=Array(D5),r=0,i;r<D5;)i=this.arc4.g(1)[0]>>2,i<dY&&(e[r]=cY[i],r++);return e.join("")}nextSeed(){for(var e=16,r=this.arc4.g(e),i=Array(e),n=0;n<e;n++)i[n]=r[n].toString(16),i[n].length===1&&(i[n]="0"+i[n]);return i.join("")}},Ex;function hY(){if(!Ex)throw"Random Hash Factory not initialized";return Ex.next()}function pY(){if(!Ex)throw"Random Hash Factory not initialized";return Ex.nextSeed()}function uY(t){Ex=new R0(t)}Oe();Wl();function B0(t,e){if(!e.hasOwnProperty("myGraphs"))throw new Error("Argument Error: saveGraph options must specify myGraphs");if(!e.hasOwnProperty("isUpdate"))throw new Error("Argument Error: saveGraph options must specify isUpdate");var r={parent_hash:t.parentHash,thumb_data:t.thumbURL,graph_hash:t.hash,my_graphs:e.myGraphs,is_update:e.isUpdate,title:t.title||void 0};return r.state=t.graphData,Bn("/api/v1/calculator_3d/save",r).then(function(i){return Lo.updateFromSync(t,i),t})}function S5(){return aa("/api/v1/calculator_3d/my_graphs")}function E5(t){return Bn("/api/v1/calculator_3d/my_graphs/remove",{hash:t.hash})}function K0(t,e){if(!e.hasOwnProperty("myConstructions"))throw new Error("Argument Error: saveConstruction options must specify myConstructions");if(!e.hasOwnProperty("isUpdate"))throw new Error("Argument Error: saveConstruction options must specify isUpdate");var r={state:t.graphData,parent_hash:t.parentHash,thumb_data:t.thumbURL,hash:t.hash,my_constructions:e.myConstructions,is_update:e.isUpdate,title:t.title||void 0};return Bn("/api/v1/geometry/save",r).then(function(i){return Lo.updateFromSync(t,i),t})}function k5(){return aa("/api/v1/geometry/my_constructions")}function G5(t){return Bn("/api/v1/geometry/my_constructions/remove",{hash:t.hash})}var wG=class extends Lr{constructor({api:r,s:i,getLanguage:n,examplesJSON:o,randomSeed:s,product:a}){super();this.product=a,this.api=r,this.s=i,this.getLanguage=n,this.previousGraph=void 0,this.recoveryParentHash=void 0,this.randomHash=N0,this._seedRandom(s),this.__savedGraphs=[],this.__recoveryGraphs=[];let l=o.map(Lo.fromAjax);this.__exampleGraphs=__dcg_shared_module_exports__['m'](l,c=>!c.easterEgg),this.__easterEggGraphs=__dcg_shared_module_exports__['m'](l,c=>!!c.easterEgg),this.__graphInfoCache={},this.__exampleGraphs.forEach(c=>{this._addGraphToCache(c)}),this.__easterEggGraphs.forEach(c=>{this._addGraphToCache(c)}),this.lastSync=void 0,this.lastSaveFailureMessage="",this.recentSaveFailure=!1,this.recentSaveSuccess=!1,this.saving=!1,this.syncError=!1,this.isLoadingGraphs=!1,this.currentGraph=new Lo,this._enableLoadingGraphStates(),this.pageLoadTime=Date.now()}_seedRandom(r){if(!r){alert(this.s("account-shell-error-something-went-wrong",{error_num:"77361"}));return}let i=new Date,n=""+r+i.getTime()+i.getMilliseconds();this.randomHash.init(n)}requestDeleteGraph(r){let i=this._getCachedGraphInfo(r);i.canCancelDelete=!0,i.deleteTimeout=setTimeout(this._deleteGraph.bind(this,r),3e3),i.isDeletingGraph=!0,i.didDeleteGraphFail=!1,this.triggerEvent("listChanged",void 0),this.triggerEvent("triggerRender",void 0)}_removeSavedGraphByHash(r){this.__savedGraphs=__dcg_shared_module_exports__['m'](this.__savedGraphs,i=>i.hash!==r)}_removeRecoveryGraphByHash(r){this.__recoveryGraphs=__dcg_shared_module_exports__['m'](this.__recoveryGraphs,i=>i.hash!==r)}_deleteGraph(r){let i=r.hash,n=this._getCachedGraphInfo(r);n.canCancelDelete=!1,this.triggerEvent("listChanged",void 0),this.triggerEvent("triggerRender",void 0);let o;switch(this.product){case"graphing":case"geometry-calculator":{o=wK({hash:i,lang:this.getLanguage()});break}case"graphing-3d":{o=E5(r);break}case"geometry":{o=G5(r);break}}return o.done(()=>{this._removeSavedGraphByHash(i),this._removeRecoveryGraphByHash(i)}).fail(()=>{n.didDeleteGraphFail=!0}).always(()=>{n.isDeletingGraph=!1,this.triggerEvent("listChanged",void 0),this.triggerEvent("triggerRender",void 0)})}cancelDeleteGraph(r){let i=this._getCachedGraphInfo(r);clearTimeout(i.deleteTimeout),i.isDeletingGraph=!1,i.didDeleteGraphFail=!1,i.canCancelDelete=!1,this.triggerEvent("listChanged",void 0),this.triggerEvent("triggerRender",void 0)}millisecondsSinceSync(){return this.lastSync?Date.now()-this.lastSync:1/0}clear(){this.lastSync=void 0,this.setSavedGraphsFromJSON([]),this.setRecoveryGraphsFromJSON([])}dismissSaveError(){this.recentSaveFailure=!1,this.triggerEvent("triggerRender",void 0)}_triggerSaveSuccess(){this.saving=!1,this.recentSaveSuccess=!0,this.lastSaveFailureMessage=void 0,this.triggerEvent("triggerRender",void 0),this.recentSaveTimeout=setTimeout(()=>{this.recentSaveSuccess=!1,this.triggerEvent("triggerRender",void 0)},3e3)}_triggerSaveError(r){let i=r.length&&r[0].message?r[0].message:this.s("account-shell-error-unexpected-error");this.saving=!1,this.recentSaveFailure=!0,this.lastSaveFailureMessage=i,this.triggerEvent("triggerRender",void 0),this.toast(i,{}),this.recentSaveTimeout=setTimeout(this.dismissSaveError.bind(this),3e3)}_updateGraphData(r){let i=JSON.stringify(this.api.getState());r.setProperty("graphData",i),r.setProperty("parentHash",r.hash),r.setProperty("recoveryParentHash",this.recoveryParentHash);let n=this.randomHash.next();r.setProperty("hash",n),this.recoveryParentHash=n;let o=this.api.screenshot({width:200,height:200,targetPixelRatio:2});r.setProperty("thumbURL",o)}_clearSaveTimeout(){this.recentSaveFailure=!1,this.recentSaveSuccess=!1,this.lastSaveFailureMessage=void 0,this.triggerEvent("triggerRender",void 0),clearTimeout(this.recentSaveTimeout)}save(r){let i=r&&r.newTitle,n=!!(r&&r.saveCopy);i&&(this.currentGraph.title=i),this._clearSaveTimeout(),this.saving=!0,this.triggerEvent("triggerRender",void 0);let o=this.currentGraph.copy();o.recovery&&(o.recovery=!1,Mi("recovered-graph",{product:this.product,timeSincePageload:Date.now()-this.pageLoadTime,payloadJSON:{action:"save"}})),this._updateGraphData(o);let s=!n&&this.wasCurrentGraphEverSaved(),a;switch(this.product){case"graphing":case"geometry-calculator":{a=ZE(o,{myGraphs:!0,isUpdate:s,product:this.product,lang:this.getLanguage()});break}case"graphing-3d":{a=B0(o,{myGraphs:!0,isUpdate:s});break}case"geometry":{a=K0(o,{myConstructions:!0,isUpdate:s});break}}a.done(l=>{this.currentGraph=l.copy(),this._onCurrentGraphChanged(),this.triggerEvent("clearUnsavedChanges",void 0),this.triggerEvent("triggerRender",void 0),s&&this._removeSavedGraphByHash(l.parentHash),l.draft&&this._removeRecoveryGraphByHash(l.parentHash),this.__savedGraphs.unshift(l),this._addGraphToCache(l),this.triggerEvent("listChanged",void 0),this.triggerEvent("triggerRender",void 0),this._triggerSaveSuccess()}).fail(l=>{let c=l.status===413?[{message:this.s("account-shell-error-graph-too-large")}]:u0(l);this._triggerSaveError(c)})}shareGraph(){let r=this.currentGraph.copy();this._updateGraphData(r);let i;switch(this.product){case"graphing":case"geometry-calculator":{i=ZE(r,{myGraphs:!1,isUpdate:!1,product:this.product,lang:this.getLanguage()});break}case"graphing-3d":{i=B0(r,{myGraphs:!1,isUpdate:!1});break}case"geometry":{i=K0(r,{myConstructions:!1,isUpdate:!1});break}}return i}saveRecoveryGraph(){switch(this.product){case"graphing":case"geometry-calculator":{let r=this.currentGraph.copy(),i=JSON.stringify(this.api.getState());r.setProperty("graphData",i),r.setProperty("parentHash",r.hash),r.setProperty("recoveryParentHash",this.recoveryParentHash);let n=this.randomHash.next()+this.randomHash.next();r.setProperty("hash",n),this.recoveryParentHash=n;let o=this.api.screenshot({width:200,height:200,targetPixelRatio:2});return r.setProperty("thumbURL",o),ZE(r,{myGraphs:!1,isUpdate:!1,recovery:!0,product:this.product,lang:this.getLanguage()})}case"geometry":case"graphing-3d":throw new Error(`Programming Error: ${this.product} cannot save recovery graphs`)}}isCurrentGraphTitled(){return!!this.currentGraph.title}isCurrentGraphARecoveryGraph(){let r=this.currentGraph;if(!r||!r.hash)return!1;let i=r.hash;return __dcg_shared_module_exports__['o'](this.__recoveryGraphs,n=>n.hash===i)}wasCurrentGraphEverSaved(){let r=this.currentGraph;if(!r||!r.hash)return!1;let i=r.hash;return __dcg_shared_module_exports__['o'](this.__savedGraphs,n=>n.hash===i)}isSaveEnabled(){var r;return this.hasUnsavedChanges()?!0:(r=this.currentGraph)!=null&&r.hash?!this.wasCurrentGraphEverSaved():!1}isRecoveryUIEnabledForProduct(){return this.product==="graphing"||this.product==="geometry-calculator"}fetchRecoveryGraphs(){let i=Date.now(),n;switch(this.isLoadingRecoveryGraphs=!0,clearTimeout(this.fetchDurationTimeout),this.triggerEvent("triggerRender",void 0),this.product){case"graphing":case"geometry-calculator":{n=bK({product:this.product,lang:this.getLanguage()});break}case"graphing-3d":throw new Error("code error: should not fetchRecoveryGraphs for 3d");case"geometry":throw new Error("code error: should not fetchRecoveryGraphs for geometry")}n.done(o=>{this.setRecoveryGraphsFromJSON(o.recoveryGraphs||o.recoveryConstructions)}).fail(()=>{this.triggerEvent("onRecoveryGraphsError",void 0)}).always(()=>{let s=2e3-(Date.now()-i);this.isLoadingRecoveryGraphs=!1,s>0?this.fetchDurationTimeout=setTimeout(()=>{this.triggerEvent("triggerRender",void 0)},s):this.triggerEvent("triggerRender",void 0)})}clearRecoveryGraphsForTests(){return xK()}refreshGraphs(){this.isLoadingGraphs=!0,this.syncError=!1,this.triggerEvent("triggerRender",void 0);let r;switch(this.product){case"graphing":case"geometry-calculator":{r=yK({product:this.product,lang:this.getLanguage()});break}case"graphing-3d":{r=S5();break}case"geometry":{r=k5();break}}r.done(i=>{this.lastSync=Date.now(),this.setSavedGraphsFromJSON(i.myGraphs||i.myConstructions)}).fail(()=>{this.syncError=!0,this.triggerEvent("onSyncError",void 0)}).always(()=>{this.isLoadingGraphs=!1,this.triggerEvent("triggerRender",void 0)})}getRecoveryGraphs(){return this.__recoveryGraphs.slice(0)}getSavedGraphs(){return this.__savedGraphs.slice(0)}getExampleGraphs(){return this.__exampleGraphs.slice(0)}getEasterEggGraphs(r){return __dcg_shared_module_exports__['m'](this.__easterEggGraphs,i=>i.easterEgg===r)}getSavedAndExampleGraphs(){return this.__savedGraphs.concat(this.__exampleGraphs)}setSavedGraphsFromJSON(r){r||(r=[]),this.__savedGraphs=r.map(i=>{let n=Lo.fromAjax(i),o=this._getCachedGraphInfo(n);return o?o.graph:(this._addGraphToCache(n),n)}),this._lazyLoadGraphStates(),this.triggerEvent("listChanged",void 0),this.triggerEvent("triggerRender",void 0)}setRecoveryGraphsFromJSON(r){r||(r=[]),this.__recoveryGraphs=r.map(i=>{let n=Lo.fromAjax(i);n.draft=!0,n.recovery=!0;let o=this._getCachedGraphInfo(n);return o?o.graph:(this._addGraphToCache(n),n)}),this._lazyLoadGraphStates(),this.triggerEvent("listChanged",void 0),this.triggerEvent("triggerRender",void 0)}getSavedGraphsAsJSON(){return this.__savedGraphs.map(Lo.toAjax)}_enableLoadingGraphStates(){clearTimeout(this.__loadNextGraphStateTimeout);let r=()=>{this._loadNextGraphState(),this.__loadNextGraphStateTimeout=setTimeout(r,50)};r()}_disableLoadingGraphStates(){clearTimeout(this.__loadNextGraphStateTimeout)}_loadNextGraphState(){if(this.__currentAjaxRequest)return;let r=this._dequeueGraphInfo();r&&(this.__currentAjaxRequest=this.loadGraphImmediately(r.graph),this.__currentAjaxRequest.always(()=>{this.__currentAjaxRequest=void 0}))}loadGraphImmediately(r){let i=I.Deferred();if(r.graphData)requestAnimationFrame(function(){i.resolve()});else{let n=r.stateURL,o=this._getCachedGraphInfo(r);return o.isDataLoading=!0,I.getJSON(n,Bc).done(s=>{r.graphData=s,o.didDataLoadFail=!1,i.resolve(s)}).fail(s=>{o.didDataLoadFail=!0,i.reject(s)}).always(s=>{o.isDataLoading=!1,this.triggerEvent("listChanged",void 0),this.triggerEvent("triggerRender",void 0)})}return i}_getCachedGraphInfo(r){return r&&this.__graphInfoCache[r.getCollectionKey()]}_addGraphToCache(r){this.__graphInfoCache[r.getCollectionKey()]={graph:r}}_enqueueGraphInfo(r){this.__nextAjaxRequestPriority||(this.__nextAjaxRequestPriority=0),r.ajaxPriority=++this.__nextAjaxRequestPriority}_dequeueGraphInfo(){let r=-1/0,i;for(let n in this.__graphInfoCache){let o=this.__graphInfoCache[n],s=o.ajaxPriority;s!==void 0&&s>r&&(r=s,i=o)}return!__dcg_shared_module_exports__['I'](i)||i===void 0?null:(delete i.ajaxPriority,i)}loadDataForGraph(r){if(!r)return;let i=this._getCachedGraphInfo(r);if(!i)throw new Error('graphsController does not have a reference to graph with hash "'+r.hash+'"');i.graph.graphData||(i.isDataLoading=!0,i.didDataLoadFail=!1,this._enqueueGraphInfo(i),this.triggerEvent("triggerRender",void 0))}_lazyLoadGraphStates(){let i=this.getSavedAndExampleGraphs();for(let n=Math.min(20,i.length)-1;n>=0;n--)this.loadDataForGraph(i[n])}didDataLoadFail(r){let i=this._getCachedGraphInfo(r);return!!(i&&i.didDataLoadFail)}didDeleteGraphFail(r){let i=this._getCachedGraphInfo(r);return!!(i&&i.didDeleteGraphFail)}isDeletingGraph(r){let i=this._getCachedGraphInfo(r);return!!(i&&i.isDeletingGraph)}canCancelDelete(r){let i=this._getCachedGraphInfo(r);return!!(i&&i.canCancelDelete)}loadGraph(r,i){this.previousGraph=this.currentGraph?this.currentGraph.copy():new Lo,this.previousGraph.graphData=JSON.stringify(this.api.getState());let n=r.copy();delete n.example,this.api.setState(n.graphData,{forceExpressionsOpen:!0,forceUnsavedChanges:!!n.recovery,allowUndo:i&&i.allowUndo}),this.currentGraph=n,this._onCurrentGraphChanged(),this.recoveryParentHash=this.currentGraph.hash,(!i||!i.allowUndo)&&this.triggerEvent("clearUndoRedo",void 0),n.recovery||this.triggerEvent("clearUnsavedChanges",void 0),this.triggerEvent("triggerRender",void 0),this.triggerEvent("onLoadGraph",void 0)}restorePreviousGraph(){this.loadGraph(this.previousGraph||new Lo)}clearGraph(r){this.loadGraph(new Lo,r),this.triggerEvent("onClearGraph",void 0)}defaultTitle(){switch(this.product){case"graphing":return this.s("account-shell-heading-graphingcalc-page-title");case"graphing-3d":return this.s("account-shell-heading-3dcalc-page-title");case"geometry-calculator":case"geometry":return this.s("account-shell-heading-geometry-page-title")}}_onCurrentGraphChanged(){let r=this.currentGraph;r.title?document.title=r.title:document.title=this.defaultTitle(),this._replaceState(r)}_replaceState(r){if(!(window.history&&history.replaceState))return;let i=r.getURL();i&&(window.location.search&&(i+=window.location.search),i!==window.location.href&&history.replaceState(r.hash,r.title,i))}toast(r,i){this.triggerEvent("toast",{message:r,opts:i})}clearGraphByUserAction(){let r;if(this.currentGraph.hash){this.clearGraph(),r=this.product==="geometry"?this.s("account-shell-text-new-construction-created"):this.s("account-shell-text-new-graph-created"),this.toast(r,{undoCallback:()=>{this.restorePreviousGraph(),this._replaceState(this.currentGraph)}});return}let i=this.api.getState();this.clearGraph({allowUndo:!0}),r=this.product==="geometry"?this.s("account-shell-text-construction-cleared"):this.s("account-shell-text-graph-cleared"),this.toast(r,{undoCallback:()=>{this.api.setState(i,{forceExpressionsOpen:!0,allowUndo:!0})}})}getSaveFailureMessage(){return this.lastSaveFailureMessage||""}isSaving(){return!!this.saving}didSaveFail(){return!!this.recentSaveFailure}didSaveSucceed(){return!!this.recentSaveSuccess}isSyncing(){return!!this.isLoadingGraphs}didSyncFail(){return!!this.syncError}getCurrentDisplayDate(){return this.currentGraph.displayDate()}getCurrentGraphTitle(){return this.currentGraph.title}getUntitledString(){return this.product==="geometry"?this.s("account-shell-text-untitled"):this.product==="graphing"?this.s("account-shell-text-untitled-graph"):this.product==="graphing-3d"?this.s("account-shell-text-untitled-graph"):(Co("Unknown product: "+this.product),"Untitled")}hasUnsavedChanges(){return this.api.hasUnsavedChanges()}};Xp();var kx=class{constructor(e){this.s=zl(()=>this._language);this._language=$f(),this.Calc=e}raw(e,r){return ca(e,r)}unpack(e){return Ah(e,this._language)}getLanguage(){return this._language}updateUrl(e){if(!(window.history&&history.replaceState))return;let{origin:r,pathname:i,search:n,hash:o}=location,s=nD(n,"lang",e),a=`${r}${i}${s}${o}`;history.replaceState(null,"",a)}setHeaderController(e){this.headerController=e}fetchAndSetLanguage(e){og(e).then(()=>{this._language=e,this.Calc.updateSettings({language:e}),this.updateUrl(e),this.headerController&&this.headerController.triggerRender()})}};Oe();Wl();ql();var V5=5*60*1e3;oo().fastAutoSave&&(V5=5*1e3);var xG=class{constructor(e){this.defaultModalDevice="mouse";this.userControllerState="uninitialized";this.lastIsShowingActionsUI=!1;if(e.graphsController.product!==e.product)throw new Error("Programming error: mismatched product between graphsController and calculator-shell controller");this.userController=e.userController,this.graphsController=e.graphsController,this.tourController=e.tourController,this.languageController=e.languageController,this.mygraphsController=e.mygraphsController,this.api=e.api,this.raw=e.raw,this.s=e.s,this.getLanguage=e.getLanguage,this.unpack=e.unpack,this.product=e.product,this.SOMETHING_WENT_WRONG=this.s("account-shell-error-unknown"),this._openMenu="none",this._requestedContactForm=!1,this._feedbackMessage="",this.state={},this.countryCode=I("body").attr("data-country"),this.languageController&&this.languageController.setHeaderController(this),this.hookupControllers(),this.hookupHotkeys(),this.dispatcher=new sd,this.dispatch=r=>(Rp("dispatch::header-controller",{type:r.type}),this.dispatcher.dispatch(r)),this.dispatcher.register(r=>{switch(r.type){case"save-graph":this.saveGraph(r.device,r.payload);break;case"edit-title":this.launchEditTitle();break;case"close-modal":this.closeModal();break;case"toggle-menu":this.setOpenMenu(r.payload);break;case"open-mygraphs":this.mygraphsController.openMygraphs(r);break;case"close-mygraphs":this.mygraphsController.closeMygraphs();break;case"render":break;case"show-modal":this.showModal(r);break;case"show-contact-form":this._requestedContactForm=r.showForm;break;default:return r}return this.triggerRender()}),this.lastRecoveryState={},this.checkRecoveryState()}triggerRender(){}hookupControllers(){this.mygraphsController.observeEvent("onOpenMygraphs",()=>{if(this.isLoggedIn()&&this.graphsController.millisecondsSinceSync()>2*60*1e3)return this.graphsController.refreshGraphs()}),this.mygraphsController.observeEvent("triggerRender",()=>{this.triggerRender()}),this.userController.observeEvent("loginChanged",()=>{this.userControllerState="initialized",this.mygraphsController.recoveryAttempted=!1,this.isLoggedIn()?this.graphsController.refreshGraphs():this.graphsController.clear(),this.mustConsentToCollection()&&this.showModal({modal:"consent",device:this.defaultModalDevice})}),this.userController.observeEvent("userUpdated",()=>{this.getOpenModal()==="consent"&&this.closeModal(),mi("actions")===void 0&&(this.api instanceof Ea||this.api instanceof gp)&&this.api._calc.setOption("actions",this.isActionsFlagEnabled()?!0:"auto")}),this.userController.observeEvent("triggerRender",()=>{this.triggerRender()}),this.graphsController.observeEvent("triggerRender",()=>{this.triggerRender()}),this.api instanceof Ea&&this.api._calc.controller.subToChanges(()=>this.maybeShowAdvancedFeaturesToast())}hookupHotkeys(){I(document).on("keydown",e=>{let r,{altKey:i,ctrlKey:n,metaKey:o,shiftKey:s}=e;if(Zr?r=!n&&o&&!i&&!s:r=n&&!o&&!i&&!s,r)switch(ei(e)){case"S":return this.simpleSave("keyboard"),!1;case"O":return this.dispatch({type:"open-mygraphs",device:"keyboard"}),!1}})}disablePrintAndExport(){this._disablePrintAndExport=!0}shouldDisablePrintAndExport(){return!!this._disablePrintAndExport}getOpenMenu(){return this._openMenu}getModalState(){return this._openModal||{modal:"none"}}getOpenModal(){var e,r;return(r=(e=this._openModal)==null?void 0:e.modal)!=null?r:"none"}hasOpenModal(){return!!this._openModal}getModalDevice(){var e;return(e=this._openModal)==null?void 0:e.device}getModalStartingError(){var e;return((e=this._openModal)==null?void 0:e.error)||""}closeModal(){this._openModal=this.mustConsentToCollection()?{modal:"consent",device:this.defaultModalDevice}:void 0,this.triggerRender()}closeMenu(){this._openMenu="none",this.maybeResetContactForm()}showModal(e){this.closeMenu(),this._openModal=e,this.defaultModalDevice=e.device}setOpenMenu(e){let r=this.getOpenMenu();this._openMenu=e===r?"none":e,this.maybeResetContactForm()}getFeedbackMessage(){return this._feedbackMessage}setFeedbackMessage(e){this._feedbackMessage=e}maybeResetContactForm(){this.getOpenMenu()!=="help"&&(this.getFeedbackMessage().trim().length||(this.setFeedbackMessage(""),this._requestedContactForm=!1))}getProduct(){return this.product}saveRecoveryState(){var e=I.Deferred();e.reject();var r=e.promise();if(!this.userController.isLoggedIn()||!this.graphsController.hasUnsavedChanges())return r;let i=this.graphsController.api.getState();if(__dcg_shared_module_exports__['F'](i,this.lastRecoveryState))return r;var n=this.graphsController.saveRecoveryGraph();return this.lastRecoveryState=i,n}checkRecoveryState(){this.graphsController.isRecoveryUIEnabledForProduct()&&setTimeout(()=>{this.checkRecoveryState(),this.saveRecoveryState()},V5)}isLoggedIn(){return this.userController.isLoggedIn()}hasConsentedToCollection(){return this.userController.hasConsentedToCollection()}isInMaintenanceMode(){return!!mi("maintenance")}getPreviewParams(){return mi("previewMode")?{url:mi("previewFeedbackUrl"),message:mi("previewMessage")}:null}isDecimalToFractionEnabled(){return!!mi("decimalToFraction")}isSaveEnabled(){return this.graphsController.isSaveEnabled()}saveGraph(e,r){this.isLoggedIn()?(this.graphsController.save({newTitle:r==null?void 0:r.title,saveCopy:!!(r!=null&&r.saveAs)}),this.closeModal(),this.closeMenu()):this.showModal({modal:"signup",device:e})}simpleSave(e=this.defaultModalDevice){this.graphsController.isCurrentGraphTitled()?(this.saveGraph(e||"mouse"),this.dispatch({type:"render"})):this.openSaveDialog({device:e})}openSaveDialog(e={}){this.showModal({modal:"save",device:e.device||this.defaultModalDevice,fromSaveInProgress:e.fromSaveInProgress}),this.dispatch({type:"render"})}launchEditTitle(){this.closeMenu(),!(this.getPreviewParams()!=null||this.isInMaintenanceMode())&&(this.isLoggedIn()?this.product==="geometry"?this.showModal({modal:"save",device:this.defaultModalDevice}):this.showModal({modal:"rename",device:this.defaultModalDevice}):this.showModal({modal:"signup",device:this.defaultModalDevice}))}getOpenText(){switch(this.product){case"graphing":case"geometry-calculator":case"graphing-3d":return this.s("account-shell-button-open-graph");case"geometry":return this.s("account-shell-button-open-construction")}}isConsentingToCollection(){return this.userController.isConsentingToPrivacy()}privacyConsentFailed(){return this.userController.didPrivacyConsentFail()}mustConsentToCollection(){return this.isLoggedIn()&&!this.hasConsentedToCollection()}isArtContestEnabled(){return!1}isGraphComplexEnoughForContest(){if(!(this.api instanceof Ea))return!1;let e=this.api.getState(),{list:r}=e.expressions;return!!(r.length!==1||r[0].type!=="expression"||r[0].latex)}shouldShowArtContestNudge(){return this.isArtContestEnabled()?this.isGraphComplexEnoughForContest()&&this.isLoggedIn():!1}getLimitedSignupRole(){return"student"}wasModalOpenedWithKeyboard(){var e;return((e=this._openModal)==null?void 0:e.device)==="keyboard"}allowSignInWithApple(){return!0}getSomethingWentWrongText(){return this.s("account-shell-error-unknown")}logJSON(e,r){Mi(e,r)}parseJSONErrors(e){return ek(e)}requestedContactForm(){return this._requestedContactForm}isActionsFlagEnabled(){return this.userController.hasFeatureFlag("dcg-actions")}maybeShowAdvancedFeaturesToast(){let e=this.api;if(!(e instanceof Ea))return;let r=e._calc.controller.areActionsEnabled();if(r&&this.userControllerState==="uninitialized"){this.userControllerState="loading",this.userController.askServerIfLoggedIn().then(()=>{this.userControllerState="initialized",this.maybeShowAdvancedFeaturesToast()});return}else if(this.userControllerState==="loading")return;this.isActionsFlagEnabled()||(r&&!this.lastIsShowingActionsUI&&this.userController.isLoggedIn()&&e._calc.controller.runAfterDispatch(()=>{e._calc.controller.dispatch({type:"toast/show",toast:{message:Yo("account-shell-text-graph-uses-advanced-features"),hideAfter:0,learnMoreCallback:()=>{this.dispatch({type:"show-modal",modal:"account-settings",initialTab:"advanced",device:this.defaultModalDevice})}}})}),this.lastIsShowingActionsUI=r)}};Oe();var fY=0,Gx=class{constructor(e,r,i){this.__id=fY++,this.controller=e,this.headerController=r,this.userController=r.userController,this.mygraphsController=r.mygraphsController,this.instanceHotkeys=i,this.startListening()}remove(){this.stopListening()}startListening(){this.isListening||(I(document).on("keydown.dcg-global-keyboard-listener-"+this.__id,e=>this.handleGlobalKeydown(e)),this.isListening=!0)}stopListening(){this.isListening&&(I(document).off("keydown.dcg-global-keyboard-listener-"+this.__id),this.isListening=!1)}handleGlobalKeydown(e){let r=!1;if(Lp(e)||Pp(e)){let i=this.controller.getRootElt();(!i||document.activeElement&&document.activeElement!=document.body&&!I(document.activeElement).closest(i).length)&&(r=!0)}else if(!e.ctrlKey&&!e.altKey&&!e.metaKey&&!e.shiftKey&&Te(e)===jn)r=this.handleEscape(e);else if(mV(e))e.preventDefault(),e.stopPropagation(),r=!0,this.headerController.dispatch({type:"show-modal",modal:"hotkeys",device:"keyboard"});else if(e.ctrlKey&&(e.altKey||e.metaKey)&&!e.shiftKey)if(ei(e)==="A")if(e.preventDefault(),e.stopPropagation(),r=!0,this.userController.isLoggedIn())this.focusElement(I(document).find(".dcg-header .dcg-account-link"),this.controller.s("graphing-calculator-narration-unable-to-activate-account-menu"));else{let i=I(document).find(".dcg-sign-in");this.triggerKeyboardTapEvent(i)}else ei(e)==="L"?(e.preventDefault(),e.stopPropagation(),r=!0,this.focusElement(I(document).find(".dcg-action-language"),this.controller.s("graphing-calculator-narration-unable-to-activate-language-menu"))):ei(e)==="H"?(e.preventDefault(),e.stopPropagation(),r=!0,this.focusElement(I(document).find(".dcg-action-help"),this.controller.s("graphing-calculator-narration-unable-to-activate-help-menu"))):ei(e)==="S"&&(e.preventDefault(),e.stopPropagation(),r=!0,this.focusElement(I(document).find(".dcg-action-share"),this.controller.s("graphing-calculator-narration-unable-to-activate-share-menu")));r||this.instanceHotkeys.handleKeydown(e)}handleEscape(e){let r=!1,i=this.headerController.getModalState().modal!=="none",n=this.headerController.getOpenMenu()!=="none",o=!!I(".graph-preview").length,s=this.mygraphsController.isMygraphsOpen(),a=!1;if(i?(this.headerController.dispatch({type:"close-modal"}),a=!0):n?(this.headerController.dispatch({type:"toggle-menu",payload:"none"}),a=!0):o?(this.triggerKeyboardTapEvent(I(".dcg-action-close-resources:visible")),a=!0):s&&(this.headerController.dispatch({type:"close-mygraphs"}),a=!0),a){if(!al)if(!o&&!(i&&s)){let l=this.controller.getSelectedItem();if(l)this.controller.dispatch({type:"move-focus-to-item",id:l.id});else{let c=this.controller.getItemModelByIndex(0);c&&this.controller.dispatch({type:"move-focus-to-item",id:c.id})}}else i&&s&&I(".new-blank-graph").trigger("focus");e.preventDefault(),e.stopPropagation(),r=!0}return r}triggerKeyboardTapEvent(e){let r=I.Event("dcg-tap");r.device="keyboard",e.trigger(r)}focusElement(e,r){e.length?this.triggerKeyboardTapEvent(e):r&&me(r)}};Xp();Oe();var vG=class{constructor(e){this.tourManager=e._calc.tourManager,this.Calc=e._calc,this.tourManager.closingMsg=(r,i)=>"<b>"+r+"</b><br>"+this.Calc.controller.s("graphing-tours-label-self-destruct",{seconds:i})}shouldPopupTour(e){if(this.Calc.controller.getItemCount()>3)return!0;var r=new dh[e].tour(this.Calc);return r.shouldPopup?r.shouldPopup():!1}startTour(e){if(!(!e||!dh[e])){var r=new dh[e].tour(this.Calc);this.tourManager.currentTour&&this.tourManager.stopTour(),this.tourManager.startTour(r)}}startTourFromUrl(){if(I(".dcg-expressionitem").length<2){setTimeout(this.startTourFromUrl.bind(this),100);return}var e=Ud(location.search,"tour");e&&this.startTour(e)}setCalc(e){this.Calc=e}};Oe();var CG=class extends Lr{constructor(r,i,n){super();this.recoveryAttempted=!1;this.isOpen=!1;this.graphsController=r,this.api=i,this.s=n,this.pageLoadTime=Date.now()}isMygraphsOpen(){return this.isOpen}hasAttemptedRecovery(){return this.recoveryAttempted}openMygraphs(r){this.recoveryAttempted=!1,this.isOpen=!0,I("body").addClass("resources-open"),Mi("user-action::open-my-graphs",{product:this.graphsController.product}),me(this.s("account-shell-narration-mygraphs-open-graph")),ti(),r&&r.device==="keyboard"&&I(".dcg-action-newblankgraph").focus(),this.triggerEvent("onOpenMygraphs",void 0)}closeMygraphs(){this.isOpen=!1,I("body").removeClass("resources-open")}openBlankGraph(){this.closeMygraphs(),this.graphsController.clearGraphByUserAction(),this.triggerEvent("triggerRender",void 0)}onOpenGraph(r){r.example||(r.recovery?Mi("recovered-graph",{product:this.graphsController.product,timeSincePageload:Date.now()-this.pageLoadTime,payloadJSON:{action:"open"}}):Mi("user-action::open-saved",{product:this.graphsController.product,timeSincePageload:Date.now()-this.pageLoadTime}));var i=this.copyGraphWithTranslation(r);this.graphsController.loadGraph(i),this._concludeOpenGraph(i)}toast(r,i){this.triggerEvent("toast",{message:r,opts:i})}_concludeOpenGraph(r){var i=r.title||this.graphsController.getUntitledString(),n=this.s("account-shell-text-mygraphs-opened-graph",{graphTitle:i});this.toast(n,{undoCallback:()=>{this.graphsController.restorePreviousGraph()}}),this.closeMygraphs(),this.triggerEvent("triggerRender",void 0)}copyGraphWithTranslation(r){var i=r.copy();return r.i18nKey&&(i.title=this.s(r.i18nKey)),i}openGraphBehindCover(r){var i=this.copyGraphWithTranslation(r);this.graphsController.loadGraph(i);var n=I.Deferred();return this.graphsController.product==="graphing"||this.graphsController.product==="graphing-3d"||this.graphsController.product==="geometry-calculator"?(this.api._calc.evaluator.notifyWhenSynced(function(){n.resolve()}),setTimeout(function(){n.resolve()},6e3)):this.graphsController.product==="geometry"&&n.resolve(),n.then(()=>{this._concludeOpenGraph(i)}),n.promise()}getThumbnail(){return this.api.screenshot({width:200,height:200,targetPixelRatio:2})}};function I5(t){let e=JSON.parse(t.exampleGraphsRaw),r=t.api,i=new vG(r);window.tourController=i;let n=new kx(r),o=new bG,s=n.s.bind(n),a=n.raw.bind(n),l=n.unpack.bind(n),c=new wG({api:r,s,getLanguage:n.getLanguage.bind(n),examplesJSON:e,randomSeed:t.seed,product:t.product}),d=new CG(c,r,s);c.observeEvent("onClearGraph",function(){r.focusFirstExpression()}),d.observeEvent("toast",function(b,x){if(!x)return;let w={message:x.message};for(let E in x.opts)x.opts.hasOwnProperty(E)&&(w[E]=x.opts[E]);r._calc.controller.dispatch({type:"toast/show",toast:w})}),c.observeEvent("toast",function(b,x){if(!x)return;let w={message:x.message};for(let E in x.opts)x.opts.hasOwnProperty(E)&&(w[E]=x.opts[E]);r._calc.controller.dispatch({type:"toast/show",toast:w})}),c.observeEvent("clearUnsavedChanges",function(){r._calc.controller.dispatch({type:"clear-unsaved-changes"})}),c.observeEvent("clearUndoRedo",function(){r._calc.controller.dispatch({type:"clear-undoredo-history"})});let u=!1;r._calc.controller.subToChanges(function(){let b=r._calc.controller.hasUnsavedChanges();b!==u&&g.triggerRender(),u=b}),r.hasUnsavedChanges=function(){return r._calc.controller.hasUnsavedChanges()};let p;r._calc.controller.triggerEasterEgg=function(b){let x=b==="betchacant"?r._calc.controller.s("account-shell-label-betchacant-loading"):r._calc.controller.s("account-shell-label-loading"),w=c.getEasterEggGraphs(b);w.length!==0&&(p=Math.floor(Math.random()*w.length),r._calc.controller.dispatch({type:"toast/show",toast:{message:x,hideAfter:0,toastStyle:"cover"}}),c.loadGraphImmediately(w[p]).done(function(){d.openGraphBehindCover(w[p])}))},mi("expressions")!==!1&&(r._calc.controller.triggerClearGraph=function(){c.clearGraphByUserAction()},r.observeEvent("openDrawer",function(){g.dispatch({type:"open-mygraphs"})}));let g=new xG({userController:o,graphsController:c,tourController:i,languageController:n,mygraphsController:d,api:r,s,raw:a,unpack:l,getLanguage:n.getLanguage.bind(n),product:t.product});return r._calc.globalHotkeys=new Gx(r._calc.controller,g,r._calc.instanceHotkeys),r._calc.controller.setCanShowKeyboardShortcuts(!0),r.observeEvent("showHotkeysModal",function(){g.dispatch({type:"show-modal",modal:"hotkeys",device:"keyboard"})}),window.userController=o,window.headerController=g,{userController:o,graphsController:c,tourController:i,headerController:g}}var yY=function(){let t=new Uint32Array(4);window.crypto.getRandomValues(t);let e="";e+=t[0];for(let r=1;r<t.length;r++)e+=",",e+=t[r];return e}(),DG=uv();DG.disableScrollFix||dB();DG=__dcg_shared_module_exports__['c'](__dcg_shared_module_exports__['b']({},DG),{border:!1,disableScrollFix:!0,showHamburger:!0,onlyTraceSelected:!0});function bY(t){t.focusFirstExpression(),la.hideLoadingScreen()}var wY=document.getElementById("graph-container"),q0=new Ea(wY,DG,bY),H0=I5({api:q0,seed:yY,exampleGraphsRaw:zL,product:"graphing"});q0.updateSettings({language:$f()});var wd=H0.userController,Vx=H0.graphsController,Iu=H0.headerController;RL("https://www.desmos.com");Vx.clearGraph();wd.observeEvent("logout",function(){la.deleteCookies(),wd.completeLogout()});wd.observeEvent("userUpdated",function(){let t=wd.getUserAsJSON();localStorage.setItem("user",JSON.stringify(t)),la.saveCookies()});var xY=function(){let t=Vx.getSavedGraphsAsJSON();localStorage.setItem("graphs",JSON.stringify(t))};Vx.observeEvent("listChanged",xY);Vx.observeEvent("onSyncError",function(){let t;try{t=JSON.parse(localStorage.getItem("graphs"))}catch(e){t=[]}Vx.setSavedGraphsFromJSON(t)});var U0;try{U0=JSON.parse(localStorage.getItem("user"))}catch(t){}U0&&wd.completeLogin(U0);la.observeEvent("started resumed",function(){wd.askServerIfLoggedIn()});Iu.disablePrintAndExport();Iu.triggerRender=function(){vY.update(),CY.update(),DY.update()};var vY=bf.mountToNode(hk,document.getElementById("dcg-header-container"),{controller:function(){return Iu}}),CY=bf.mountToNode(oG,document.getElementById("dcg-modal-container"),{controller:function(){return Iu}}),DY=bf.mountToNode(fG,document.getElementById("mygraphs-container"),{controller:bf.const(Iu),makeAPI:function(t){return new Ea(t,{settingsMenu:!1,keypad:!1,zoomButtons:!1,branding:!1,border:!1,disableScrollFix:!0,expressions:!1,hideGeoUI:!0})}}),z0;wd.observeEvent("googleLogin",function(t,e){e&&(z0=e.fromUI),la.openGoogleLogin(),I("#google-login-cover").show()});wd.observeEvent("appleLogin",function(t,e){e&&(z0=e.fromUI),la.openAppleLogin(),I("#google-login-cover").show()});I("#google-login-cover").on("dcg-tap",function(){I("#google-login-cover").hide()});var SG=function(t){z0==="create"?Iu.dispatch({type:"show-modal",modal:"signup",device:"mouse",error:t}):Iu.dispatch({type:"show-modal",modal:"login",device:"mouse",error:t})};la.observeEvent("onAppleAuthResult",function(t,e){e?BL(e).then(function(){I("#google-login-cover").hide(),wd.askServerIfLoggedIn()},function(r){I("#google-login-cover").hide(),SG(r)}):(I("#google-login-cover").hide(),SG())});la.observeEvent("onGoogleAuthResult",function(t,e){e.code?NL(e.code).then(function(){I("#google-login-cover").hide(),wd.askServerIfLoggedIn()},function(r){I("#google-login-cover").hide(),SG(r)}):(I("#google-login-cover").hide(),SG())});var M5=q0;Mh(document.body);I(".dcg-loading-div-container").fadeOut();window.Calc=M5;PA();
/*!
 * jQuery JavaScript Library v3.6.0
 * https://jquery.com/
 *
 * Includes Sizzle.js
 * https://sizzlejs.com/
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2021-03-02T17:08Z
 */
/**
 * Minimal Event interface implementation
 *
 * Original implementation by Sven Fuchs: https://gist.github.com/995028
 * Modifications and tests by Christian Johansen.
 *
 * @author Sven Fuchs (svenfuchs@artweb-design.de)
 * @author Christian Johansen (christian@cjohansen.no)
 * @license BSD
 *
 * Copyright (c) 2011 Sven Fuchs, Christian Johansen
 */
/*!!
 *  Canvas 2 Svg v1.0.19
 *  A low level canvas to SVG converter. Uses a mock canvas context to build an SVG document.
 *
 *  Licensed under the MIT license:
 *  http://www.opensource.org/licenses/mit-license.php
 *
 *  Author:
 *  Kerry Liu
 *
 *  Copyright (c) 2014 Gliffy Inc.
 *
 *  Modifications by Desmos:
 *  - wrapped in AMD pattern
 *  - added ctx.ellipse() method
 *  - fixed image opacity bug
 *  - added ability to add classNames to exported svg elements
 *  - added ability to add named groups
 *  - removed dominant-basline attribute. Editors appear to ignore it. Must solve baseline issues using transformations
 */
/*! Copyright (c) 2013 Brandon Aaron (http://brandon.aaron.sh)
 * Licensed under the MIT License (LICENSE.txt).
 *
 * Version: 3.1.9
 *
 * Requires: jQuery 1.2.2+
 */
})()